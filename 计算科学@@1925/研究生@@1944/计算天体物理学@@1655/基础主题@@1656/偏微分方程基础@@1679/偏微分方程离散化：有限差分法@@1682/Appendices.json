{"hands_on_practices": [{"introduction": "如果一个数值解是不稳定的，那么它就是无用的。第一个实践练习通过冯·诺依曼分析方法，探讨了数值稳定性的基本概念。通过分析用于扩散方程的显式时间前向、空间中心 (FTCS) 差分格式，你将从第一性原理出发，推导出著名的 Courant-Friedrichs-Lewy (CFL) 条件，从而深刻理解离散化选择（如 $\\Delta t$ 和 $\\Delta x$）如何影响模拟的稳定性。[@problem_id:3508817]", "problem": "在模拟一个光学厚吸积盘环中的电子热传导时，考虑在一个空间维度上带有周期性边界条件的温度标量扩散。在一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，一种显式前向时间、中心空间 (FTCS) 有限差分法根据以下方程推进节点温度 $u_i^n$：\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;+\\; \\mu \\,\\big(u_{i+1}^n \\;-\\; 2\\,u_i^n \\;+\\; u_{i-1}^n\\big),\n$$\n其中 $\\mu \\equiv \\chi\\,\\Delta t/\\Delta x^2$ 且 $\\chi$ 是热扩散系数。使用从第一性原理出发的 von Neumann (傅里叶) 稳定性分析，确定无量纲扩散数 $\\mu$ 的最大值，使得该格式对于所有空间傅里叶模式都是线性稳定的。请以精确解析数的形式给出你的答案。答案无需四舍五入，且不应包含任何物理单位。", "solution": "用户希望使用 von Neumann 分析方法，为一个给定的有限差分格式找到其稳定性判据。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- **控制过程：** 一维空间中的温度标量扩散，$u_t = \\chi u_{xx}$。\n- **离散化格式：** 显式前向时间、中心空间 (FTCS)。\n- **更新规则：** $u_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$。\n- **变量：** $u_i^n$ 是在空间网格点 $i$ 和时间步长 $n$ 处的温度。\n- **网格：** 均匀空间步长 $\\Delta x$ 和时间步长 $\\Delta t$。\n- **无量纲扩散数：** $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$。\n- **物理常数：** $\\chi$ 是热扩散系数。\n- **边界条件：** 周期性。\n- **方法论：** 从第一性原理出发的 von Neumann (傅里叶) 稳定性分析。\n- **目标：** 确定使该格式对所有空间傅里叶模式保持线性稳定的 $\\mu$ 的最大值。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题是偏微分方程 (PDE) 数值解研究中的一个典型例子，特别是针对热/扩散方程。FTCS 格式是一种标准（尽管是条件稳定）的方法，而 von Neumann 分析是分析其在周期性边界条件下稳定性的合适工具。吸积盘的物理背景是这类模型的有效应用领域。该问题在科学上和数学上都是合理的。\n- **适定性：** 该问题是适定的。它要求使用一个指定的、标准的数学程序来确定一个具体的、唯一可确定的值（$\\mu$ 的稳定性极限）。\n- **客观性：** 该问题以清晰、客观且明确的技术语言陈述。\n- **完整性与一致性：** 该问题提供了所有必要的信息：离散化格式、参数 $\\mu$ 的定义、所需的分析方法以及待确定的特定属性。没有矛盾之处。\n\n**1.3. 结论与行动：**\n该问题是有效的。它是计算物理学中一个标准的、适定的问题。将推导其解。\n\n### 步骤 2：求解推导\n\n分析过程是将 von Neumann 稳定性方法应用于给定的 FTCS 有限差分方程。核心思想是将给定时间步长的数值解分解为其空间傅里叶模式，并确定每个模式的振幅在后续时间步长中不增长的条件。\n\n设网格点 $x_i = i\\Delta x$ 和时间 $t_n = n\\Delta t$ 处的节点温度 $u_i^n$ 由一个单一的通用傅里叶模式表示。由于差分方程的线性性质，一个完整傅里叶级数解的行为由其单个模式的行为决定。一个通用模式具有以下形式：\n$$\nu_i^n = A(k)^n e^{I k x_i} = A^n e^{I k i \\Delta x}\n$$\n其中 $k$ 是空间波数，$I \\equiv \\sqrt{-1}$ 是虚数单位，$A(k)$ 是波数为 $k$ 的模式的增长因子。为简单起见，我们将 $A(k)$ 记为 $A$。在下一个时间步长，会得到一个新的振幅 $A^{n+1}$。为使格式稳定，对于任何波数 $k$，增长因子的模都不能超过1。这就是 von Neumann 稳定性条件：\n$$\n|A| = \\left|\\frac{A^{n+1}}{A^n}\\right| \\le 1 \\quad \\forall k\n$$\n\n我们将傅里叶模式的表达式代入给定的 FTCS 格式中：\n$$\nu_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n将 $u_j^m = A^m e^{I k j \\Delta x}$（其中 $(m,j) \\in \\{(n, i-1), (n, i), (n, i+1), (n+1, i)\\}$）代入：\n$$\nA^{n+1} e^{I k i \\Delta x} = A^n e^{I k i \\Delta x} + \\mu \\left( A^n e^{I k (i+1) \\Delta x} - 2 A^n e^{I k i \\Delta x} + A^n e^{I k (i-1) \\Delta x} \\right)\n$$\n我们可以将整个方程除以非零公因子 $A^n e^{I k i \\Delta x}$ 来求得增长因子 $A = A^{n+1}/A^n$：\n$$\nA = 1 + \\mu \\left( e^{I k \\Delta x} - 2 + e^{-I k \\Delta x} \\right)\n$$\n使用欧拉恒等式 $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$，我们可以简化括号中的项：\n$$\ne^{I k \\Delta x} + e^{-I k \\Delta x} = 2\\cos(k \\Delta x)\n$$\n将此结果代回 $A$ 的表达式中：\n$$\nA = 1 + \\mu \\left( 2\\cos(k \\Delta x) - 2 \\right) = 1 - 2\\mu \\left( 1 - \\cos(k \\Delta x) \\right)\n$$\n为了进一步简化，我们使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nA = 1 - 2\\mu \\left( 2\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right) = 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n增长因子 $A$ 是一个纯实数。因此，稳定性条件 $|A| \\le 1$ 可转化为以下不等式：\n$$\n-1 \\le A \\le 1\n$$\n让我们分别分析这两个不等式。\n\n首先，上界：\n$$\nA \\le 1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n$$\n-4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0\n$$\n由于 $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$ 必须为非负（因为物理扩散系数 $\\chi$、时间步长 $\\Delta t$ 和网格间距 $\\Delta x$ 都是非负的），并且 $\\sin^2(\\cdot)$ 总是非负的，因此不等式 $A \\le 1$ 无条件满足。这对于一个扩散过程是符合预期的，因为它不应放大任何模式。\n\n其次，下界，它施加了关键的约束：\n$$\nA \\ge -1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{1}{2}\n$$\n这个条件必须对网格上可以表示的所有可能的波数 $k$ 都成立。格式的稳定性受到“最坏情况”模式的限制，即最大化 $\\sin^2(k \\Delta x / 2)$ 项的模式，从而使得对 $\\mu$ 的约束最为严格。$\\sin^2$ 函数的值域是 $[0, 1]$。其最大值为 $1$。这个最大值出现在网格上可表示的最高频率（振荡最剧烈）的模式，对应于 $k \\Delta x = \\pi$。这是奈奎斯特频率，其波长为 $2\\Delta x$。\n\n为确保对所有模式都稳定，我们必须满足这种最坏情况下的不等式：\n$$\n\\max\\left[\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right] = 1\n$$\n将此最大值代入稳定性不等式中：\n$$\n\\mu \\cdot 1 \\le \\frac{1}{2}\n$$\n$$\n\\mu \\le \\frac{1}{2}\n$$\n这就是用 FTCS 格式求解一维扩散方程时著名的 Courant-Friedrichs-Lewy (CFL) 条件。该格式是稳定的，当且仅当 $\\mu \\le 1/2$。问题要求的是使格式稳定的 $\\mu$ 的最大值。这对应于条件中的等号。\n\n因此，无量纲扩散数 $\\mu$ 的最大值是 $1/2$。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3508817"}, {"introduction": "在实现了一个稳定的数值格式后，我们如何确定它能产生正确的结果呢？这个实践练习介绍了一种代码验证的基石技术：理查森外推法。利用一组来自泊松方程求解器的模拟数据，你将凭经验确定该格式的精度阶数，并计算出真实连续解的高精度估计值。这项技术是任何计算科学家验证其代码时不可或缺的技能。[@problem_id:3508857]", "problem": "在牛顿自引力理论中，一个密度为 $\\rho$ 的质量分布所产生的引力势 $\\Phi$ 满足泊松方程 $\\nabla^{2} \\Phi = 4 \\pi G \\rho$。考虑一个光滑、中心集中、具有紧支集的球对称密度分布 $\\rho(r)$，该分布被放置在一个边长为 $L$ 的立方计算域内，其狄利克雷边界条件与孤立解一致。采用标准有限差分法，在均匀笛卡尔网格上使用中心差分格式对 $\\nabla^{2}$ 进行离散化，然后求解得到的线性系统，以获得连续解 $\\Phi$ 的数值近似 $\\Phi_{h}$。\n\n定义无量纲诊断量 $U$ 为原点处的归一化势的值，即 $U \\equiv \\Phi(0) / (G M / R)$，其中 $M$ 是总质量，$R$ 是质量分布的特征半径。假设数值格式是一致的，并且解是光滑的，因此在渐进网格细化体系中，依赖于网格的近似值 $U_{h}$ 满足以下形式的展开式：$U_{h} = U^{\\ast} + C h^{p} + \\text{高阶项}$，其中 $C$ 为某个常数，$p  0$ 为渐进阶，$U^{\\ast}$ 为连续极限。\n\n您使用均匀网格间距 $h$、$h/2$ 和 $h/4$ 进行了三次模拟，得到\n$$\nU_{h} = \\frac{17}{16}, \\quad U_{h/2} = \\frac{65}{64}, \\quad U_{h/4} = \\frac{257}{256}.\n$$\n\n仅使用上述针对一致有限差分离散化的基本误差模型和系统性网格细化，进行 Richardson 外推分析，以估计：\n- 渐进收敛阶 $p$，以及\n- 连续极限值 $U^{\\ast}$。\n\n将您的最终答案表示为一个行向量 $\\bigl(U^{\\ast},\\,p\\bigr)$，并使用精确值（不要四舍五入）。诊断量 $U$ 是无量纲的，因此报告的 $U^{\\ast}$ 应为不带单位的纯数。最终答案中不要提供中间计算过程。", "solution": "该问题要求根据通过系统性网格细化获得的一组三个数值解，确定渐进收敛阶 $p$ 和连续极限值 $U^{\\ast}$。所提供的无量纲诊断量 $U_{h}$ 的误差模型由展开式 $U_{h} = U^{\\ast} + C h^{p} + \\text{H.O.T.}$ 给出，其中 $h$ 是网格间距，$C$ 是一个常数，H.O.T. 代表高阶项。在本分析中，我们假设网格间距足够小，以至于领头阶误差项占主导地位，而高阶项可以忽略不计。\n\n我们获得了三个连续减半的网格间距所对应的三个数据点，我们使用网格间距作为下标来表示它们：\n$$ U_{h} = \\frac{17}{16} $$\n$$ U_{h/2} = \\frac{65}{64} $$\n$$ U_{h/4} = \\frac{257}{256} $$\n在 H.O.T. 可以忽略的假设下，我们可以写出以下方程组：\n$$ U_{h} = U^{\\ast} + C h^{p} \\qquad (1) $$\n$$ U_{h/2} = U^{\\ast} + C \\left(\\frac{h}{2}\\right)^{p} = U^{\\ast} + \\frac{C h^{p}}{2^{p}} \\qquad (2) $$\n$$ U_{h/4} = U^{\\ast} + C \\left(\\frac{h}{4}\\right)^{p} = U^{\\ast} + \\frac{C h^{p}}{4^{p}} \\qquad (3) $$\n\n为了求出收敛阶 $p$，我们可以使用连续解之间差值的比率。我们定义差值 $\\Delta_{1} = U_h - U_{h/2}$ 和 $\\Delta_{2} = U_{h/2} - U_{h/4}$。\n从方程 $(1)$ 中减去方程 $(2)$：\n$$ \\Delta_{1} = U_{h} - U_{h/2} = (U^{\\ast} + C h^{p}) - \\left(U^{\\ast} + \\frac{C h^{p}}{2^{p}}\\right) = C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right) $$\n从方程 $(2)$ 中减去方程 $(3)$：\n$$ \\Delta_{2} = U_{h/2} - U_{h/4} = \\left(U^{\\ast} + \\frac{C h^{p}}{2^{p}}\\right) - \\left(U^{\\ast} + \\frac{C h^{p}}{4^{p}}\\right) = \\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right) $$\n这些差值的比率，通常称为收敛因子，为：\n$$ \\frac{\\Delta_{1}}{\\Delta_{2}} = \\frac{C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right)}{\\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right)} = 2^{p} $$\n现在，我们代入给定的数值来计算差值：\n$$ \\Delta_{1} = \\frac{17}{16} - \\frac{65}{64} = \\frac{4 \\times 17}{64} - \\frac{65}{64} = \\frac{68 - 65}{64} = \\frac{3}{64} $$\n$$ \\Delta_{2} = \\frac{65}{64} - \\frac{257}{256} = \\frac{4 \\times 65}{256} - \\frac{257}{256} = \\frac{260 - 257}{256} = \\frac{3}{256} $$\n因此，比率为：\n$$ 2^{p} = \\frac{\\Delta_{1}}{\\Delta_{2}} = \\frac{3/64}{3/256} = \\frac{3}{64} \\cdot \\frac{256}{3} = \\frac{256}{64} = 4 $$\n由 $2^{p} = 4 = 2^2$ 可知，渐进收敛阶为 $p=2$。这与拉普拉斯算子使用标准中心有限差分格式的理论预期相符。\n\n在确定了收敛阶 $p=2$ 后，我们可以继续使用 Richardson 外推法来求解连续极限值 $U^{\\ast}$。基于两个网格尺寸为 $h$ 和 $h/r$ 的解的 Richardson 外推通用公式为 $U^{\\ast} \\approx \\frac{r^{p} U_{h/r} - U_{h}}{r^{p} - 1}$。在我们的例子中，细化因子 $r=2$。我们可以重新整理方程 $(1)$ 和 $(2)$ 来消去误差项 $C h^p$。当 $p=2$ 时：\n$$ U_{h} = U^{\\ast} + C h^{2} $$\n$$ U_{h/2} = U^{\\ast} + \\frac{C h^{2}}{4} $$\n为了消去 $C h^2$ 项，我们将第二个方程乘以 $4$，然后减去第一个方程：\n$$ 4 U_{h/2} - U_{h} = 4\\left(U^{\\ast} + \\frac{C h^{2}}{4}\\right) - (U^{\\ast} + C h^{2}) = (4 U^{\\ast} + C h^{2}) - (U^{\\ast} + C h^{2}) = 3 U^{\\ast} $$\n这给出了 $U^{\\ast}$ 的 Richardson 外推公式：\n$$ U^{\\ast} = \\frac{4 U_{h/2} - U_{h}}{3} $$\n将给定值代入此公式：\n$$ U^{\\ast} = \\frac{4 \\left(\\frac{65}{64}\\right) - \\frac{17}{16}}{3} = \\frac{\\frac{260}{64} - \\frac{4 \\times 17}{64}}{3} = \\frac{\\frac{260 - 68}{64}}{3} = \\frac{192/64}{3} $$\n因为 $192 = 3 \\times 64$，我们有：\n$$ U^{\\ast} = \\frac{3}{3} = 1 $$\n作为一致性检验，我们对 $U_{h/2}$ 和 $U_{h/4}$ 这对解应用相同的外推程序：\n$$ U^{\\ast} = \\frac{4 U_{h/4} - U_{h/2}}{3} = \\frac{4 \\left(\\frac{257}{256}\\right) - \\frac{65}{64}}{3} = \\frac{\\frac{1028}{256} - \\frac{4 \\times 65}{256}}{3} = \\frac{\\frac{1028 - 260}{256}}{3} = \\frac{768/256}{3} $$\n因为 $768 = 3 \\times 256$，我们有：\n$$ U^{\\ast} = \\frac{3}{3} = 1 $$\n结果是一致的。因此，连续极限值为 $U^{\\ast}=1$，渐进收敛阶为 $p=2$。问题要求将答案表示为行向量 $(U^{\\ast}, p)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}\n$$", "id": "3508857"}, {"introduction": "天体物理流体常常由平流主导，这通常由双曲型偏微分方程来描述。虽然高阶格式在精度上具有优势，但它们在急剧变化的梯度（例如激波前沿）附近常常会引入非物理的振荡。这个练习将要求你实现并比较一个带有斜率限制器和不带斜率限制器的二阶格式，从而展示现代的总变差递减 (TVD) 方法如何在有效抑制这些虚假振荡的同时，保持特征的锐利性。[@problem_id:3508820]", "problem": "考虑守恒形式的一维线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n该方程定义在长度为 $L$ 的周期性域上，其中 $a$ 是一个恒定的平流速度。初始条件为一个方波脉冲，其振幅为 $1$，宽度为 $w$，中心位于 $x_0$，定义在一个包含 $N$ 个单元的均匀网格上。在所有时刻，边界条件都是周期性的。您的任务是使用有限差分法对该问题进行离散化，以评估在间断附近的数值过冲。\n\n从该偏微分方程和守恒原理出发，实现一个二阶空间离散方法。该方法基于将单元中心值通过分段线性重构得到左界面状态，并对 $a>0$ 使用迎风数值通量。时间离散采用二阶强稳定性保持(SSP)龙格-库塔积分器。比较两种重构策略：\n- 使用无限制中心斜率的“无限制器”重构。\n- 使用 minmod 斜率限制器的 minmod 限制重构，该方法可以减少伪振荡。\n\n定义库朗-弗里德里希-列维 (CFL) 数 $C$ 为\n$$\nC = \\frac{a \\,\\Delta t}{\\Delta x},\n$$\n并选择时间步长 $\\Delta t$ 以满足 $C \\le C_{\\text{target}}$。为此，将时间步数 $n$ 设为满足 $n \\,\\Delta t \\ge T$ 的最小整数（其中 $\\Delta t \\le C_{\\text{target}} \\Delta x / a$），然后取 $\\Delta t = T/n$。对空间差分和通量使用周期性索引。\n\n对于下方的每个测试用例，将方波脉冲平流一个持续时间 $T$，并测量定义为如下的最大吉布斯过冲幅值\n$$\nA = \\max_i u_i(T) - 1,\n$$\n该值以非负浮点数形式报告（如果 $\\max_i u_i(T)\\le 1$，则取 $A=0$）。对两种重构方法计算 $A$：首先是无限制器的情况，然后是使用 minmod 限制器的情况。从单元中心 $u_i$ 到界面 $x_{i+1/2}$ 处左状态的重构应具有形式 $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$，其中 $\\sigma_i$ 是所选的斜率。对于 minmod 限制器，斜率 $\\sigma_i$ 由后向和前向差分的逐元素 minmod 给出，即，\n$$\n\\operatorname{minmod}(r,s) = \\begin{cases}\n\\operatorname{sign}(r)\\,\\min(|r|,|s|),  \\text{if } r\\,s  0, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n对于 $a>0$，界面 $x_{i+1/2}$ 处的迎风通量为 $F_{i+1/2} = a\\,u_{i+1/2}^L$，单元 $i$ 的半离散算子为\n$$\n\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}.\n$$\n使用两步 SSP 龙格-库塔格式进行演化：\n$$\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n), \\quad\nu^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right).\n$$\n\n所有测试均使用 $a=1$，$L=1$ 和 $x_0=0.25$。将方波脉冲初始化为：当 $x \\in [x_0, x_0+w)$ 模 $L$ 时，$u(x,0)=1$，否则 $u(x,0)=0$。\n\n测试套件参数 $(N, C_{\\text{target}}, w, T)$：\n- 测试 $1$：$(N=256, C_{\\text{target}}=0.45, w=0.25, T=0.5)$。\n- 测试 $2$：$(N=128, C_{\\text{target}}=0.95, w=0.10, T=0.5)$。\n- 测试 $3$：$(N=64, C_{\\text{target}}=0.20, w=0.40, T=0.5)$。\n- 测试 $4$：$(N=128, C_{\\text{target}}=0.70, w=0.02, T=0.2)$。\n\n您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的配对列表，每个配对本身是一个双元素列表 $[A_{\\text{无限制器}}, A_{\\text{minmod}}]$。结果需按上述四个测试的顺序汇总，每个浮点数保留六位小数，且不含空格。例如，一个有效的输出格式为\n$$\n[[a_{11},a_{12}],[a_{21},a_{22}],[a_{31},a_{32}],[a_{41},a_{42}]],\n$$\n其中每个 $a_{ij}$ 是一个四舍五入到小数点后六位的十进制数。", "solution": "用户提供了一个问题陈述，要求对一维线性平流方程进行数值求解。作为一名要求严格的教授，我将首先验证该问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **控制方程**：守恒形式的一维线性平流方程，$\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$。\n- **计算域**：长度为 $L$ 的周期性域。计算网格是均匀的，包含 $N$ 个单元。\n- **物理参数**：$a$ 是一个恒定的平流速度。所有测试均使用 $a=1$ 和 $L=1$。\n- **初始条件**：一个振幅为 $1$、宽度为 $w$ 的方波脉冲，起始于 $x_0=0.25$。具体而言，当 $x \\in [x_0, x_0+w)$ 模 $L$ 时，$u(x,0)=1$，否则 $u(x,0)=0$。\n- **边界条件**：在所有时刻均为周期性。\n- **数值方法**：有限差分法。\n    - **空间离散**：从单元中心值到左界面状态的二阶分段线性重构，并结合 $a0$ 时的迎风数值通量。\n    - **重构策略**：\n        1. 无限制器：一个无限制的中心斜率。\n        2. Minmod 限制器：一个由 `minmod` 函数限制的斜率。\n    - **时间离散**：一个两步强稳定性保持 (SSP) 龙格-库塔格式。\n- **时间步长控制**：库朗-弗里德里希-列维 (CFL) 数为 $C = \\frac{a \\,\\Delta t}{\\Delta x}$。选择时间步长 $\\Delta t$ 以满足 $C \\le C_{\\text{target}}$。时间步数 $n$ 是满足 $n \\,\\Delta t \\ge T$ 的最小整数（其中 $\\Delta t \\le C_{\\text{target}} \\Delta x / a$），然后设置 $\\Delta t = T/n$。\n- **格式公式**：\n    - **重构**：界面 $x_{i+1/2}$ 左侧的状态为 $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$，其中 $\\sigma_i$ 是单元 $i$ 中的斜率。\n    - **Minmod 限制器**：$\\operatorname{minmod}(r,s) = \\begin{cases} \\operatorname{sign}(r)\\,\\min(|r|,|s|),  \\text{if } r\\,s  0, \\\\ 0,  \\text{otherwise}. \\end{cases}$ 斜率是以后向和前向差分为参数计算的。\n    - **迎风通量**：对于 $a0$，界面 $x_{i+1/2}$ 处的通量为 $F_{i+1/2} = a\\,u_{i+1/2}^L$。\n    - **半离散算子**：$\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}$。\n    - **SSP-RK2 积分器**：\n        $$u^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n)$$\n        $$u^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right)$$\n- **输出度量**：最大吉布斯过冲幅值，$A = \\max_i u_i(T) - 1$，以非负数形式报告。\n- **测试用例**：\n    - 测试 1：$(N=256, C_{\\text{target}}=0.45, w=0.25, T=0.5)$。\n    - 测试 2：$(N=128, C_{\\text{target}}=0.95, w=0.10, T=0.5)$。\n    - 测试 3：$(N=64, C_{\\text{target}}=0.20, w=0.40, T=0.5)$。\n    - 测试 4：$(N=128, C_{\\text{target}}=0.70, w=0.02, T=0.2)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是计算流体力学中的一个经典练习，特别是关于双曲守恒律数值方法的研究。\n- **科学/事实合理性**：该问题在科学上是合理的。线性平流方程、有限差分法、分段线性重构、斜率限制器 (minmod) 和 SSP-RK 时间积分都是数值分析和计算物理学中标准且成熟的概念。\n- **适定性**：该问题是适定的。在给定的初始和边界条件下，控制偏微分方程具有唯一、稳定的解。所提供的数值格式也定义明确，并且在指定约束（CFL 条件、SSP 积分器、minmod 限制器）下，预计会产生稳定的数值解。“无限制中心斜率”在上下文中被理解为标准的二阶中心差分近似，这也是一个明确定义的选择（尽管已知它是非单调的）。使用后向和前向差分作为 minmod 限制器的指令也是标准的，它们被解释为 $u_i-u_{i-1}$ 和 $u_{i+1}-u_i$。\n- **完整性和一致性**：该问题提供了所有必要的参数、方程和算法步骤。初始条件的描述在“中心位于 $x_0$”和“对于 $x \\in [x_0, x_0+w)$”之间存在轻微的矛盾，但后者是一个精确的数学定义，它消除了前者描述性短语中的任何歧义。所有其他定义都是清晰和一致的。\n- **客观性**：该问题以客观、数学的术语陈述，没有主观性语言。\n\n### 步骤 3：结论和行动\n该问题是**有效的**。它是一个定义明确、自成体系且具有科学依据的计算任务。我现在将继续进行求解。\n\n### 求解推导\n\n该问题要求我们求解线性平流方程（双曲守恒律的原型），以分析数值格式在间断点附近的行为。\n\n**1. 离散化框架**\n我们首先定义离散域。长度为 $L=1$ 的空间域被划分为 $N$ 个均匀单元，每个单元的宽度为 $\\Delta x = L/N$。单元中心位于 $x_i = (i+0.5)\\Delta x$，其中 $i = 0, 1, \\dots, N-1$。单元界面位于 $x_{i+1/2} = (i+1)\\Delta x$。时刻 $t$ 的离散解由一个单元平均值向量表示，$u(t) = \\{u_0(t), u_1(t), \\dots, u_{N-1}(t)\\}$。\n\n初始条件是一个方波脉冲，我们通过为单元中心赋值来进行离散化。对于每个单元 $i$，如果其中心 $x_i$ 落在区间 $[x_0, x_0+w)$ 内，则我们设置 $u_i(0)=1$，否则设置 $u_i(0)=0$。鉴于周期性域，该区间按模 $L$ 处理。\n\n时间步长 $\\Delta t$ 由目标 CFL 数 $C_{\\text{target}}$ 确定。为保证稳定性，最大允许时间步长为 $\\Delta t_{\\text{max}} = C_{\\text{target}} \\Delta x / a$。为确保模拟在时刻 $T$ 准确结束，我们将步数 $n$ 计算为满足 $n \\ge T/\\Delta t_{\\text{max}}$ 的最小整数。这可以计算为 $n = \\lceil T/\\Delta t_{\\text{max}} \\rceil$。然后，实际使用的时间步长为 $\\Delta t = T/n$。这保证了 $n$ 个大小为 $\\Delta t$ 的时间步覆盖了总时长 $T$，并且满足 CFL 条件 $C = a \\Delta t / \\Delta x \\le C_{\\text{target}}$。\n\n**2. 数值格式：矩量法**\n我们使用矩量法，该方法首先对空间导数进行离散化，从而获得一个常微分方程组 (ODE)，每个单元 $i$ 对应一个方程：\n$$\n\\frac{du_i}{dt} = \\mathcal{L}(u)_i\n$$\n算子 $\\mathcal{L}(u)_i$ 是在单元中心 $x_i$ 处对 $-a \\frac{\\partial u}{\\partial x}$ 的近似。利用守恒形式，我们将其表示为单元界面处数值通量的散度：\n$$\n\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}\n$$\n这里，$F_{i+1/2}$ 是穿过界面 $x_{i+1/2}$ 的数值通量。\n\n**3. 迎风通量与分段线性重构**\n对于 $a0$ 的线性平流方程，信息从左向右流动。因此，迎风通量格式使用界面迎风侧（左侧）的状态来计算通量。界面 $x_{i+1/2}$ 处的通量由 $F_{i+1/2} = a u_{i+1/2}^L$ 给出，其中 $u_{i+1/2}^L$ 是解在界面左侧的重构值。\n\n为达到二阶空间精度，我们使用分段线性重构。在每个单元 $i$ 内，我们将解建模为一个线性函数 $u(x) = u_i + s_i(x-x_i)$，其中 $s_i$ 是斜率。问题使用 $\\sigma_i = s_i \\Delta x$ 定义重构值，即 $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$。该公式在单元 $i$ 的右边界 $x_{i+1/2} = x_i + \\Delta x/2$ 处计算其线性剖面。\n\n任务的核心是比较计算斜率代表值 $\\sigma_i$ 的两种方法：\n- **无限制器（无限制中心斜率）**：在单元 $i$ 处，一个标准的二阶精度斜率选择是基于相邻单元 $i-1$ 和 $i+1$ 的值。相应的斜率代表值为 $\\sigma_i = \\frac{1}{2}(u_{i+1} - u_{i-1})$。虽然该格式是二阶的，但它不保证单调性，并且通常在间断附近引入伪振荡（吉布斯过冲和下冲）。\n- **Minmod 限制器**：为了抑制这些振荡，我们采用一个斜率限制器。斜率被保守地选择。问题指定使用后向差分 $\\Delta u_{i-1/2} = u_i - u_{i-1}$ 和前向差分 $\\Delta u_{i+1/2} = u_{i+1} - u_i$。然后，minmod 限制的斜率代表值为 $\\sigma_i = \\operatorname{minmod}(\\Delta u_{i-1/2}, \\Delta u_{i+1/2})$。如果两个参数符号相同，minmod 函数返回绝对值较小的那个参数，否则返回零。这种选择确保了重构不会引入新的局部极值，这一性质被称为总变差递减 (TVD)，从而防止过冲。\n\n在所有情况下，通过对索引使用模运算来强制执行周期性边界条件（例如，单元索引 $-1$ 对应于 $N-1$，索引 $N$ 对应于 $0$）。\n\n**4. 时间积分**\n得到的常微分方程组 $\\frac{du}{dt} = \\mathcal{L}(u)$ 使用提供的两步 SSP 龙格-库塔 (SSP-RK2) 方法进行时间积分：\n$$\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n)\n$$\n$$\nu^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right)\n$$\n选择该积分器是因为在适当的 CFL 约束下，它能保持空间离散的稳定性（如 TVD 性质），而我们的时间步长选择满足该约束。\n\n**5. 最终测量**\n将解从 $t=0$ 演化到 $t=T$ 后，对无限制和 minmod 限制两种格式计算最大吉布斯过冲幅值。度量标准为 $A = \\max(\\max_i u_i(T) - 1, 0)$，以确保其非负。对测试套件中的每组参数重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (256, 0.45, 0.25, 0.5),  # Test 1\n        (128, 0.95, 0.10, 0.5),  # Test 2\n        (64, 0.20, 0.40, 0.5),   # Test 3\n        (128, 0.70, 0.02, 0.2),   # Test 4\n    ]\n\n    all_results = []\n    for params in test_cases:\n        N, C_target, w, T = params\n        a = 1.0\n        L = 1.0\n        x0 = 0.25\n\n        # Run simulation for the 'no limiter' case\n        A_nolimiter = run_simulation(N, C_target, w, T, a, L, x0, limiter='none')\n        # Run simulation for the 'minmod limiter' case\n        A_minmod = run_simulation(N, C_target, w, T, a, L, x0, limiter='minmod')\n        \n        all_results.append([A_nolimiter, A_minmod])\n\n    # Format the output string as specified\n    result_str = \",\".join([f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results])\n    print(f\"[{result_str}]\")\n\ndef run_simulation(N, C_target, w, T, a, L, x0, limiter):\n    \"\"\"\n    Performs a single simulation run for a given set of parameters and limiter type.\n    \"\"\"\n    # 1. Spatial and Temporal Grid Setup\n    dx = L / N\n    x = np.linspace(dx / 2.0, L - dx / 2.0, N)\n\n    # Time step calculation\n    dt_max = C_target * dx / a\n    n_steps = int(np.ceil(T / dt_max))\n    dt = T / n_steps\n\n    # 2. Initial Condition\n    u0 = np.zeros(N)\n    x_start = x0\n    x_end = x0 + w\n    # Handle periodic wrap-around for the pulse interval\n    if x_end  L:\n        mask = (x = x_start) | (x  (x_end - L))\n    else:\n        mask = (x = x_start)  (x  x_end)\n    u0[mask] = 1.0\n    \n    u = u0.copy()\n\n    # 3. Time Evolution\n    for _ in range(n_steps):\n        # SSP-RK2 Scheme\n        Lu_n = calculate_L(u, N, dx, a, limiter)\n        u1 = u + dt * Lu_n\n        Lu_1 = calculate_L(u1, N, dx, a, limiter)\n        u = 0.5 * u + 0.5 * (u1 + dt * Lu_1)\n\n    # 4. Measure Overshoot\n    overshoot = np.max(u) - 1.0\n    return max(0.0, overshoot)\n\ndef minmod_vec(r, s):\n    \"\"\"\n    Vectorized minmod function.\n    \"\"\"\n    sign_r = np.sign(r)\n    min_abs = np.minimum(np.abs(r), np.abs(s))\n    result = sign_r * min_abs\n    \n    # Condition: r*s  0. If not, the result is 0.\n    mask = (r * s) = 0\n    result[mask] = 0.0\n    return result\n\ndef calculate_L(u, N, dx, a, limiter):\n    \"\"\"\n    Calculates the semi-discrete operator L(u).\n    \"\"\"\n    # Periodic boundary conditions are handled using np.roll\n    u_im1 = np.roll(u, 1)  # u_{i-1}\n    u_ip1 = np.roll(u, -1) # u_{i+1}\n\n    # Calculate slope representative sigma\n    if limiter == 'none':\n        # Unlimited centered slope\n        sigma = 0.5 * (u_ip1 - u_im1)\n    elif limiter == 'minmod':\n        # Minmod-limited slope\n        bwd_diff = u - u_im1\n        fwd_diff = u_ip1 - u\n        sigma = minmod_vec(bwd_diff, fwd_diff)\n    else:\n        raise ValueError(\"Unknown limiter type\")\n\n    # Reconstruct left state at interface x_{i+1/2}\n    u_L_at_ip12 = u + 0.5 * sigma\n\n    # Calculate upwind flux (since a  0)\n    F_ip12 = a * u_L_at_ip12\n\n    # Flux at interface x_{i-1/2} is the rolled F_ip12\n    F_im12 = np.roll(F_ip12, 1)\n\n    # Compute the semi-discrete operator\n    Lu = -(F_ip12 - F_im12) / dx\n    return Lu\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3508820"}]}