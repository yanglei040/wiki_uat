{"hands_on_practices": [{"introduction": "为了理解隐式方法为何对求解刚性方程至关重要，我们必须首先深入探究单个时间步的“引擎盖之下”。本练习 [@problem_id:3535957] 将指导您对一个高阶隐式龙格-库塔（Runge-Kutta）方法进行手动计算。通过求解典型的刚性测试问题的内部阶段方程，您将计算出该方法的放大因子，这是决定其在大步长下稳定性的关键量。", "problem": "在模拟与爆发性天体物理环境相关的核反应网络中嵌入的单一反应物种快速达到平衡的过程中，一个常见的线性化刚性模式由标量常微分方程 (ODE) $y'(t) = \\lambda\\, y(t)$（其中 $\\lambda \\ll 0$）表示。考虑使用IIA型两级拉道隐式龙格-库塔(IRK)方法（这是一种在右拉道点上的配置法）将此模式推进一个时间步长。该方法由布彻系数指定\n$$\nA \\;=\\; \\begin{pmatrix}\n\\frac{5}{12}  -\\frac{1}{12} \\\\\n\\frac{3}{4}  \\frac{1}{4}\n\\end{pmatrix}, \n\\quad\n\\boldsymbol{b} \\;=\\; \\begin{pmatrix}\n\\frac{3}{4} \\\\ \\frac{1}{4}\n\\end{pmatrix}, \n\\quad\n\\boldsymbol{c} \\;=\\; \\begin{pmatrix}\n\\frac{1}{3} \\\\ 1\n\\end{pmatrix}.\n$$\n从标准初值表述出发，对于一般的自治系统 $y'(t) = f(y)$，IRK 的级方程由下式给出\n$$\n\\boldsymbol{Y} \\;=\\; y_n \\boldsymbol{e} \\;+\\; h\\, A\\, \\boldsymbol{f}(\\boldsymbol{Y}),\n$$\n其中 $y_n$ 是当前解值，$h$ 是时间步长，$\\boldsymbol{e}$ 是全1向量，$\\boldsymbol{f}(\\boldsymbol{Y})$ 是级导数向量。对于线性刚性测试问题 $f(y) = \\lambda y$，级系统变为关于级向量 $\\boldsymbol{Y}$ 的一个线性 $2 \\times 2$ 系统。\n\n仅使用这些定义和给定的布彻系数，对标量ODE $y'(t) = \\lambda y(t)$（其中 $\\lambda = -10^{4}$，步长 $h = 10^{-2}$）执行一个拉道IIA步。精确求解该 $2 \\times 2$ 级系统，并确定由 $y_{n+1} = R(z)\\, y_n$ 定义的放大因子 $R(z)$，其中 $z = h \\lambda$。将最终的放大因子表示为一个精确的有理数（无舍入）。", "solution": "该问题在常微分方程数值分析领域是适定的且有科学依据的。所有必要信息均已提供，且布彻表正确地表示了2级拉道IIA方法。该问题有效。\n\n对于自治ODE $y'(t) = f(y(t))$，隐式龙格-库塔 (IRK) 方法由级方程和解的更新定义。级方程由下式给出：\n$$\n\\boldsymbol{Y} = y_n \\boldsymbol{e} + h A \\boldsymbol{f}(\\boldsymbol{Y})\n$$\n其中 $\\boldsymbol{Y} = (Y_1, Y_2)^T$ 是级值向量，$y_n$ 是在时间 $t_n$ 的解，$\\boldsymbol{e}=(1, 1)^T$ 是全1向量，$h$ 是时间步长，$A$ 是布彻系数矩阵。然后通过以下方式更新解：\n$$\ny_{n+1} = y_n + h \\boldsymbol{b}^T \\boldsymbol{f}(\\boldsymbol{Y})\n$$\n其中 $\\boldsymbol{b}$ 是布彻系数向量。\n\n对于线性标量测试问题 $y'(t) = \\lambda y(t)$，函数为 $f(y) = \\lambda y$。级方程变为关于级向量 $\\boldsymbol{Y}$ 的线性系统：\n$$\n\\boldsymbol{Y} = y_n \\boldsymbol{e} + h A (\\lambda \\boldsymbol{Y}) = y_n \\boldsymbol{e} + (h \\lambda) A \\boldsymbol{Y}\n$$\n令 $z = h\\lambda$。方程为：\n$$\n\\boldsymbol{Y} = y_n \\boldsymbol{e} + z A \\boldsymbol{Y}\n$$\n重新整理以求解 $\\boldsymbol{Y}$，我们得到：\n$$\n(\\boldsymbol{I} - zA) \\boldsymbol{Y} = y_n \\boldsymbol{e}\n$$\n这就是要解的 $2 \\times 2$ 级系统。使用给定的矩阵 $A$：\n$$\nA = \\begin{pmatrix} \\frac{5}{12}  -\\frac{1}{12} \\\\ \\frac{3}{4}  \\frac{1}{4} \\end{pmatrix}\n$$\n该系统矩阵为：\n$$\n\\boldsymbol{I} - zA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - z \\begin{pmatrix} \\frac{5}{12}  -\\frac{1}{12} \\\\ \\frac{3}{4}  \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{5z}{12}  \\frac{z}{12} \\\\ -\\frac{3z}{4}  1 - \\frac{z}{4} \\end{pmatrix}\n$$\n为了求解 $\\boldsymbol{Y}$，我们求该矩阵的逆。首先，我们计算其行列式：\n$$\n\\det(\\boldsymbol{I} - zA) = \\left(1 - \\frac{5z}{12}\\right)\\left(1 - \\frac{z}{4}\\right) - \\left(\\frac{z}{12}\\right)\\left(-\\frac{3z}{4}\\right)\n$$\n$$\n\\det(\\boldsymbol{I} - zA) = 1 - \\frac{z}{4} - \\frac{5z}{12} + \\frac{5z^2}{48} + \\frac{3z^2}{48} = 1 - \\frac{3z+5z}{12} + \\frac{8z^2}{48} = 1 - \\frac{8z}{12} + \\frac{z^2}{6}\n$$\n$$\n\\det(\\boldsymbol{I} - zA) = 1 - \\frac{2z}{3} + \\frac{z^2}{6}\n$$\n级向量的解为 $\\boldsymbol{Y} = (\\boldsymbol{I} - zA)^{-1} y_n \\boldsymbol{e}$。逆矩阵为：\n$$\n(\\boldsymbol{I} - zA)^{-1} = \\frac{1}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} 1 - \\frac{z}{4}  -\\frac{z}{12} \\\\ \\frac{3z}{4}  1 - \\frac{5z}{12} \\end{pmatrix}\n$$\n乘以 $y_n \\boldsymbol{e}$：\n$$\n\\boldsymbol{Y} = \\frac{y_n}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} 1 - \\frac{z}{4}  -\\frac{z}{12} \\\\ \\frac{3z}{4}  1 - \\frac{5z}{12} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{y_n}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} 1 - \\frac{z}{4} - \\frac{z}{12} \\\\ \\frac{3z}{4} + 1 - \\frac{5z}{12} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{Y} = \\frac{y_n}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} 1 - \\frac{4z}{12} \\\\ 1 + \\frac{4z}{12} \\end{pmatrix} = \\frac{y_n}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} 1 - \\frac{z}{3} \\\\ 1 + \\frac{z}{3} \\end{pmatrix}\n$$\n现在我们计算更新后的解 $y_{n+1}$：\n$$\ny_{n+1} = y_n + h \\boldsymbol{b}^T (\\lambda \\boldsymbol{Y}) = y_n + z \\boldsymbol{b}^T \\boldsymbol{Y}\n$$\n放大因子为 $R(z) = y_{n+1}/y_n$：\n$$\nR(z) = 1 + z \\boldsymbol{b}^T \\frac{\\boldsymbol{Y}}{y_n} = 1 + \\frac{z}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} \\begin{pmatrix} \\frac{3}{4}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 1 - \\frac{z}{3} \\\\ 1 + \\frac{z}{3} \\end{pmatrix}\n$$\n内积为：\n$$\n\\frac{3}{4}\\left(1 - \\frac{z}{3}\\right) + \\frac{1}{4}\\left(1 + \\frac{z}{3}\\right) = \\frac{3}{4} - \\frac{3z}{12} + \\frac{1}{4} + \\frac{z}{12} = 1 - \\frac{2z}{12} = 1 - \\frac{z}{6}\n$$\n将此代回 $R(z)$ 的表达式中：\n$$\nR(z) = 1 + \\frac{z(1 - z/6)}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} = \\frac{(1 - \\frac{2z}{3} + \\frac{z^2}{6}) + (z - \\frac{z^2}{6})}{1 - \\frac{2z}{3} + \\frac{z^2}{6}}\n$$\n$$\nR(z) = \\frac{1 - \\frac{2z}{3} + z}{1 - \\frac{2z}{3} + \\frac{z^2}{6}} = \\frac{1 + \\frac{z}{3}}{1 - \\frac{2z}{3} + \\frac{z^2}{6}}\n$$\n给定 $\\lambda = -10^4$ 和 $h=10^{-2}$。因此：\n$$\nz = h\\lambda = (10^{-2})(-10^4) = -100\n$$\n我们将此值代入 $R(z)$ 的表达式中：\n$$\nR(-100) = \\frac{1 + \\frac{-100}{3}}{1 - \\frac{2(-100)}{3} + \\frac{(-100)^2}{6}} = \\frac{1 - \\frac{100}{3}}{1 + \\frac{200}{3} + \\frac{10000}{6}}\n$$\n分子是：\n$$\n1 - \\frac{100}{3} = \\frac{3}{3} - \\frac{100}{3} = -\\frac{97}{3}\n$$\n分母是：\n$$\n1 + \\frac{200}{3} + \\frac{5000}{3} = \\frac{3}{3} + \\frac{200}{3} + \\frac{5000}{3} = \\frac{3+200+5000}{3} = \\frac{5203}{3}\n$$\n因此，放大因子为：\n$$\nR(-100) = \\frac{-\\frac{97}{3}}{\\frac{5203}{3}} = -\\frac{97}{5203}\n$$\n数字 $97$ 是素数。快速检查表明 $5203$ 不能被 $97$ 整除（$5203 = 53 \\times 97 + 62$），所以该分数为最简形式。", "answer": "$$\n\\boxed{-\\frac{97}{5203}}\n$$", "id": "3535957"}, {"introduction": "虽然龙格-库塔方法功能强大，但像后向差分公式（BDF）这样的多步法是求解刚性问题的主力。本练习 [@problem_id:3535986] 从第一性原理出发，要求您从多项式插值中推导出广受欢迎的 BDF2 方法。接着，您会将其应用于一个刚性线性系统，并计算其放大矩阵，从而将稳定性概念从标量问题推广到向量值常微分方程组。", "problem": "在计算天体物理学中，当多个物理过程在相差悬殊的时间尺度上弛豫时，会出现刚性常微分方程。考虑一个双变量弛豫模型在平衡态附近的简化、无量纲化的线性形式，其状态向量 $y(t) \\in \\mathbb{R}^{2}$ 由自治系统 $y'(t) = J y(t) + b$ 控制，其中 $J \\in \\mathbb{R}^{2 \\times 2}$ 为常数矩阵，$b \\in \\mathbb{R}^{2}$ 为常数向量。假设时间步长 $h  0$ 为常数，网格是均匀的 $t_{n} = t_{0} + n h$。二阶后向差分格式 (BDF2) 的定义为：对穿过解轨道上三个点 $\\{(t_{n-1}, y_{n-1}), (t_{n}, y_{n}), (t_{n+1}, y_{n+1})\\}$ 的唯一二次插值多项式在 $t_{n+1}$ 处求导，并将此导数等同于右端项 $f(t_{n+1}, y_{n+1}) = J y_{n+1} + b$。\n\n从该定义以及多项式插值和微分的基本知识出发，推导对于常数步长 $h$ 连接 $y_{n+1}$、$y_{n}$ 和 $y_{n-1}$ 的 BDF2 步进关系。然后，对于具有以下参数的特定刚性线性系统\n$$\nJ = \\begin{pmatrix}\n-6  2 \\\\\n-3  -12\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n3 \\\\\n-1\n\\end{pmatrix}, \\quad\nh = \\frac{1}{6},\n$$\n将 BDF2 步进表示为用 $y_{n}$ 和 $y_{n-1}$ 求解 $y_{n+1}$ 的线性求解问题，并显式计算当 $b$ 置零时，将增广状态 $\\begin{pmatrix} y_{n} \\\\ y_{n-1} \\end{pmatrix}$ 映射到 $\\begin{pmatrix} y_{n+1} \\\\ y_{n} \\end{pmatrix}$ 的 $4 \\times 4$ 放大矩阵 $G$。您必须从第一性原理出发，展示获得 BDF2 关系系数的所有步骤，然后执行所需的矩阵代数运算，以闭式形式表示放大矩阵。提供放大矩阵，不进行数值舍入。", "solution": "本问题要求从第一性原理推导二阶后向差分格式 (BDF2)，将其应用于一个特定的常微分方程 (ODEs) 线性系统，并计算相应的放大矩阵。\n\n首先，我们推导 BDF2 公式。该方法通过一个唯一的二次多项式 $P(t)$ 的导数来近似导数 $y'(t_{n+1})$，该多项式在三个点 $(t_{n-1}, y_{n-1})$、$(t_{n}, y_{n})$ 和 $(t_{n+1}, y_{n+1})$ 上对数值解进行插值。时间步长是均匀的，因此对于常数步长 $h  0$，有 $t_k = t_0 + k h$。\n\n为简化推导，我们引入一个局部的无量纲时间坐标 $\\tau = (t - t_{n+1})/h$。在此坐标系中，插值点为 $(\\tau, y) = (-2, y_{n-1})$、$(-1, y_n)$ 和 $(0, y_{n+1})$。\n设二次插值多项式为 $P(\\tau) = a\\tau^2 + b\\tau + c$。我们通过施加插值条件来求解系数 $a$、$b$ 和 $c$：\n$P(0) = c = y_{n+1}$\n$P(-1) = a - b + c = y_n$\n$P(-2) = 4a - 2b + c = y_{n-1}$\n\n从第一个方程，我们将 $c = y_{n+1}$ 代入其他方程：\n$a - b = y_n - y_{n+1}$\n$4a - 2b = y_{n-1} - y_{n+1} \\implies 2a - b = \\frac{1}{2}(y_{n-1} - y_{n+1})$\n\n从第二个新方程中减去第一个，得到系数 $a$：\n$(2a - b) - (a - b) = a = \\frac{1}{2}(y_{n-1} - y_{n+1}) - (y_n - y_{n+1}) = \\frac{1}{2}y_{n-1} - y_n + \\frac{1}{2}y_{n+1}$\n\n现在我们求解 $b$：\n$b = a - (y_n - y_{n+1}) = \\left(\\frac{1}{2}y_{n-1} - y_n + \\frac{1}{2}y_{n+1}\\right) - (y_n - y_{n+1}) = \\frac{1}{2}y_{n-1} - 2y_n + \\frac{3}{2}y_{n+1}$\n\n解 $y(t)$ 的导数由插值多项式 $P(t)$ 的导数近似。使用链式法则，$y'(t) = \\frac{d P}{d\\tau} \\frac{d\\tau}{dt}$。\n我们有 $\\frac{d\\tau}{dt} = \\frac{1}{h}$ 和 $\\frac{dP}{d\\tau} = 2a\\tau + b$。\n$t_{n+1}$ 处的导数对应于 $\\tau = 0$：\n$y'(t_{n+1}) \\approx \\left.\\frac{dP}{dt}\\right|_{t=t_{n+1}} = \\frac{1}{h} (2a(0) + b) = \\frac{b}{h}$\n代入 $b$ 的表达式：\n$y'(t_{n+1}) \\approx \\frac{1}{h} \\left(\\frac{1}{2}y_{n-1} - 2y_n + \\frac{3}{2}y_{n+1}\\right) = \\frac{3y_{n+1} - 4y_n + y_{n-1}}{2h}$\n\nBDF2 方法将此导数近似值等同于常微分方程的右端项 $f(t_{n+1}, y_{n+1}) = J y_{n+1} + b$：\n$$\n\\frac{3y_{n+1} - 4y_n + y_{n-1}}{2h} = J y_{n+1} + b\n$$\n整理各项以分离出 $y_{n+1}$，我们得到该线性系统的 BDF2 步进关系：\n$$\n\\left(\\frac{3}{2h}I - J\\right) y_{n+1} = \\frac{4y_n - y_{n-1}}{2h} + b\n$$\n两边乘以 $2h$：\n$$\n(3I - 2hJ) y_{n+1} = 4y_n - y_{n-1} + 2hb\n$$\n这可以写成关于 $y_{n+1}$ 的线性求解形式：\n$$\ny_{n+1} = (3I - 2hJ)^{-1} (4y_n - y_{n-1} + 2hb)\n$$\n\n接下来，题目要求我们求解齐次系统（即 $b = 0$）的 $4 \\times 4$ 放大矩阵 $G$。齐次递推关系为：\n$$\ny_{n+1} = (3I - 2hJ)^{-1} (4y_n - y_{n-1})\n$$\n我们定义矩阵 $A = (3I - 2hJ)^{-1}$。该关系变为：\n$$\ny_{n+1} = 4A y_n - A y_{n-1}\n$$\n问题定义了增广状态向量 $\\begin{pmatrix} y_{n} \\\\ y_{n-1} \\end{pmatrix}$。此增广状态的演化由 $Z_{n+1} = G Z_n$ 给出，其中 $Z_k = \\begin{pmatrix} y_k \\\\ y_{k-1} \\end{pmatrix}$。\n$$\nZ_{n+1} = \\begin{pmatrix} y_{n+1} \\\\ y_n \\end{pmatrix} = \\begin{pmatrix} 4A y_n - A y_{n-1} \\\\ I y_n + 0 y_{n-1} \\end{pmatrix}\n$$\n这可以写成分块矩阵形式：\n$$\n\\begin{pmatrix} y_{n+1} \\\\ y_n \\end{pmatrix} = \\begin{pmatrix} 4A  -A \\\\ I_{2}  0_{2} \\end{pmatrix} \\begin{pmatrix} y_n \\\\ y_{n-1} \\end{pmatrix}\n$$\n其中 $I_2$ 和 $0_2$ 分别是 $2 \\times 2$ 的单位矩阵和零矩阵。\n因此，放大矩阵 $G$ 为：\n$$\nG = \\begin{pmatrix} 4A  -A \\\\ I_{2}  0_{2} \\end{pmatrix} = \\begin{pmatrix} 4(3I - 2hJ)^{-1}  -(3I - 2hJ)^{-1} \\\\ I_{2}  0_{2} \\end{pmatrix}\n$$\n\n现在我们代入给定值：\n$J = \\begin{pmatrix} -6  2 \\\\ -3  -12 \\end{pmatrix}$ 和 $h = \\frac{1}{6}$。\n首先，我们计算待求逆的矩阵，记为 $M = 3I - 2hJ$：\n$2h = 2(\\frac{1}{6}) = \\frac{1}{3}$\n$$\nM = 3\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{3}\\begin{pmatrix} -6  2 \\\\ -3  -12 \\end{pmatrix} = \\begin{pmatrix} 3  0 \\\\ 0  3 \\end{pmatrix} - \\begin{pmatrix} -2  2/3 \\\\ -1  -4 \\end{pmatrix} = \\begin{pmatrix} 3 - (-2)  0 - 2/3 \\\\ 0 - (-1)  3 - (-4) \\end{pmatrix} = \\begin{pmatrix} 5  -2/3 \\\\ 1  7 \\end{pmatrix}\n$$\n我们求 $M$ 的逆矩阵。其行列式为：\n$\\det(M) = (5)(7) - (-\\frac{2}{3})(1) = 35 + \\frac{2}{3} = \\frac{105+2}{3} = \\frac{107}{3}$\n逆矩阵为 $A = M^{-1}$：\n$$\nA = M^{-1} = \\frac{1}{\\det(M)} \\begin{pmatrix} 7  2/3 \\\\ -1  5 \\end{pmatrix} = \\frac{3}{107} \\begin{pmatrix} 7  2/3 \\\\ -1  5 \\end{pmatrix} = \\frac{1}{107} \\begin{pmatrix} 21  2 \\\\ -3  15 \\end{pmatrix}\n$$\n现在我们计算 $G$ 的分块：\n分块 (1,1) 是 $4A$：\n$$\n4A = \\frac{4}{107} \\begin{pmatrix} 21  2 \\\\ -3  15 \\end{pmatrix} = \\frac{1}{107} \\begin{pmatrix} 84  8 \\\\ -12  60 \\end{pmatrix}\n$$\n分块 (1,2) 是 $-A$：\n$$\n-A = -\\frac{1}{107} \\begin{pmatrix} 21  2 \\\\ -3  15 \\end{pmatrix} = \\frac{1}{107} \\begin{pmatrix} -21  -2 \\\\ 3  -15 \\end{pmatrix}\n$$\n分块 (2,1) 是 $I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n分块 (2,2) 是 $0_2 = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$。\n\n组装 $4 \\times 4$ 放大矩阵 $G$：\n$$\nG = \\begin{pmatrix} \\frac{84}{107}  \\frac{8}{107}  \\frac{-21}{107}  \\frac{-2}{107} \\\\ \\frac{-12}{107}  \\frac{60}{107}  \\frac{3}{107}  \\frac{-15}{107} \\\\ 1  0  0  0 \\\\ 0  1  0  0 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{84}{107}  \\frac{8}{107}  -\\frac{21}{107}  -\\frac{2}{107} \\\\\n-\\frac{12}{107}  \\frac{60}{107}  \\frac{3}{107}  -\\frac{15}{107} \\\\\n1  0  0  0 \\\\\n0  1  0  0\n\\end{pmatrix}\n}\n$$", "id": "3535986"}, {"introduction": "我们的最终目标是求解天体物理学中出现的复杂的、通常是非线性的刚性常微分方程。最后的这个练习 [@problem_id:3535987] 将从纸笔计算转向计算验证，使用一个幂律冷却模型作为基准。您将使用一个专业级的 BDF 求解器来积分该常微分方程，并将其与精确解进行比较，从而能够凭经验测量求解器的收敛速度，并研究在非常刚性的情况下阶数降低这一重要现象。", "problem": "考虑一个幂律辐射冷却的无量纲初值问题，该问题由常微分方程 (ODE) $dT/dt=-\\Lambda_{0} T^{\\alpha}$ 和初值条件 $T(0)=T_{0}$ 建模，其中 $T$ 是无量纲温度，$t$ 是无量纲时间，$\\Lambda_{0}0$ 是无量纲冷却系数，$\\alpha \\ge 1$ 是无量纲幂律指数，当 $\\alpha$ 较大时会引发刚性。您的任务是为此 ODE 构建一个半解析基准，用它来验证一个隐式刚性求解器的准确性，并评估当刚性增加时可能出现的阶数退化。\n\n从导数 $dT/dt$ 的基本定义和分离变量法出发，推导适用于此类右端项的闭式解 $T(t)$（不要引入任何未经检验的公式）。使用该解作为参考，量化刚性求解器在指定最终时间的全局误差。使用向后差分公式 (BDF) 方法（向后差分公式 (BDF) 是一族广泛用于刚性问题的隐式线性多步法），并提供用户指定的解析雅可比矩阵，来对该 ODE 进行积分，以获得在一系列严格的相对容差下的 $T(t_{\\mathrm{f}})$。对于每个测试用例，通过对三个容差水平下的最终时间误差的对数与相对容差的对数进行最小二乘拟合，计算观测到的收敛率。将拟合的斜率解释为有效阶数的经验指标，并评估在 $\\alpha$ 较大时的阶数退化情况。\n\n所有变量和参数都是无量纲的，因此不需要物理单位。不涉及角度。\n\n实现一个程序，为每个测试用例执行以下操作：\n- 使用 BDF 求解器和提供的解析雅可比矩阵 $\\partial f/\\partial T$，对 ODE 从 $t=0$ 积分到 $t=t_{\\mathrm{f}}$。\n- 使用三个相对容差 $10^{-3}$、$10^{-5}$ 和 $10^{-7}$，以及一个固定的绝对容差 $10^{-12}$。\n- 对于每个容差，计算在 $t=t_{\\mathrm{f}}$ 时相对于通过分离变量法推导出的精确解的绝对误差。\n- 对三个容差水平下的 $(\\log(\\mathrm{rtol}), \\log(\\mathrm{error}))$ 数据点拟合一条直线，并报告该测试用例的拟合斜率的绝对值，结果为单个浮点数。\n\n测试套件：\n- 用例 A（基线线性、非刚性参考）：$\\Lambda_{0}=1, \\alpha=1, T_{0}=2, t_{\\mathrm{f}}=1$。\n- 用例 B（中等刚性）：$\\Lambda_{0}=1, \\alpha=4, T_{0}=2, t_{\\mathrm{f}}=1$。\n- 用例 C（极刚性瞬态）：$\\Lambda_{0}=1, \\alpha=20, T_{0}=2, t_{\\mathrm{f}}=1$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，并用方括号括起来。该列表必须按顺序包含用例 A、B 和 C 的三个拟合斜率，表示为十进制数。例如：$[s_{A},s_{B},s_{C}]$。\n\n因此，最终输出必须是严格符合格式 $[s_{A},s_{B},s_{C}]$ 的单行文本，其中每个 $s$ 是一个按上述规定计算的浮点数。", "solution": "该问题提出了一个源于计算天体物理学的适定初值问题 (IVP)，适合进行严格的数值分析。它具有科学依据，使用了标准的幂律模型来描述辐射冷却，并且在方法论上是可靠的，提出了一种评估刚性 ODE 求解器收敛性和阶数的标准技术。问题陈述完整且无歧义，可以直接求解并验证。\n\n问题的核心是关于温度 $T$ 作为时间 $t$ 的函数的无量纲 ODE：\n$$\n\\frac{dT}{dt} = -\\Lambda_{0} T^{\\alpha}\n$$\n其初值条件为 $T(0)=T_{0}$。参数为冷却系数 $\\Lambda_{0}  0$ 和幂律指数 $\\alpha \\ge 1$。\n\n第一步是推导精确的解析解 $T(t)$，它将作为评估数值求解器准确性的基准真相。该 ODE 是可分离的，可以按如下方式积分：\n$$\n\\int_{T_{0}}^{T(t)} T'^{-\\alpha} dT' = \\int_{0}^{t} -\\Lambda_{0} dt'\n$$\n解取决于指数 $\\alpha$ 的值。\n\n对于 $\\alpha = 1$ 的情况，该 ODE 是线性的：\n$$\n\\int_{T_{0}}^{T(t)} \\frac{1}{T'} dT' = [\\ln T']_{T_{0}}^{T(t)} = \\ln\\left(\\frac{T(t)}{T_{0}}\\right)\n$$\n右边积分为 $-\\Lambda_{0} t$。令两边相等并求解 $T(t)$，得到指数衰减解：\n$$\nT(t) = T_{0} e^{-\\Lambda_{0} t} \\quad (\\text{对于 } \\alpha=1)\n$$\n\n对于 $\\alpha  1$ 的情况，积分得到：\n$$\n\\int_{T_{0}}^{T(t)} T'^{-\\alpha} dT' = \\left[\\frac{T'^{1-\\alpha}}{1-\\alpha}\\right]_{T_{0}}^{T(t)} = \\frac{T(t)^{1-\\alpha} - T_{0}^{1-\\alpha}}{1-\\alpha}\n$$\n令其等于 $-\\Lambda_{0} t$ 并整理以求解 $T(t)$，得到：\n$$\nT(t)^{1-\\alpha} = T_{0}^{1-\\alpha} - (1-\\alpha)\\Lambda_{0} t = T_{0}^{1-\\alpha} + (\\alpha-1)\\Lambda_{0} t\n$$\n$$\nT(t) = \\left[ T_{0}^{1-\\alpha} + (\\alpha-1)\\Lambda_{0} t \\right]^{\\frac{1}{1-\\alpha}} \\quad (\\text{对于 } \\alpha1)\n$$\n这些闭式解为分析提供了所需的精确基准。\n\n数值解将使用向后差分公式 (BDF) 方法获得，该方法专为刚性 ODE 设计。我们将使用 `scipy.integrate.solve_ivp` 提供的实现，并设置 `method='BDF'`。对于非线性刚性问题，提供右端项函数的解析雅可比矩阵能显著提高求解器的效率和稳健性。对于函数 $f(t, T) = -\\Lambda_{0} T^{\\alpha}$，雅可比矩阵 $J$ 是关于 $T$ 的标量导数：\n$$\nJ = \\frac{\\partial f}{\\partial T} = -\\Lambda_{0} \\alpha T^{\\alpha-1}\n$$\n\n对求解器性能的分析基于对其收敛率的测量。对于一个性能良好的自适应求解器，在最终时间 $t_{\\mathrm{f}}$ 的全局误差 $\\epsilon$ 预期与所要求的相对容差 `rtol` 成正比。这意味着存在关系 $\\epsilon \\approx C \\cdot (\\text{rtol})$，其中容差的指数为 $1$。对该关系取对数，我们得到 $\\log(\\epsilon) \\approx \\log(\\mathrm{rtol}) + \\log(C)$，这描述了一条斜率为 $1$ 的直线。通过对经验数据点 $(\\log(\\mathrm{rtol}), \\log(\\epsilon))$ 进行线性拟合，我们可以测量有效收敛阶数。斜率偏离 $1$ 表明非理想行为。\n\nODE 的刚性由雅可比矩阵的模 $|\\lambda| = |J| = \\Lambda_{0} \\alpha T^{\\alpha-1}$ 来表征。\n-   对于用例 A ($\\alpha=1$)，$\\lambda$ 是常数，问题是非刚性的。我们预期测得的斜率会接近 $1$。\n-   对于用例 B ($\\alpha=4$) 和用例 C ($\\alpha=20$)，在 $t=0$ 时 $|\\lambda|$ 的初值很大，表明存在快速的刚性瞬态过程。\n-   对于极度刚性的用例 C，预计会发生称为*阶数退化*的现象。当高阶隐式方法在非常刚性的问题上无法达到其理论收敛阶数时，就会发生这种情况，导致测得的斜率显著小于 $1$。\n\n每个测试用例的算法如下：\n$1$. 设置参数 $\\Lambda_{0}$、$\\alpha$、$T_{0}$ 和 $t_{\\mathrm{f}}$。\n$2$. 对于集合 $\\{10^{-3}, 10^{-5}, 10^{-7}\\}$ 中的每个相对容差，使用 BDF 求解器、解析雅可比矩阵和固定的绝对容差 $10^{-12}$，将 ODE 从 $t=0$ 积分到 $t=t_{\\mathrm{f}}$。\n$3$. 在 $t=t_{\\mathrm{f}}$ 时，计算数值解与精确解析解之间的绝对误差。\n$4$. 对三个数据点 $(\\log(\\mathrm{rtol}), \\log(\\mathrm{error}))$ 进行线性最小二乘拟合。\n$5$. 该拟合的斜率的绝对值即为该测试用例的结果。\n对所有三个测试用例重复此过程以生成最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the empirical convergence rate for a stiff ODE solver\n    on a power-law cooling problem across three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Lambda0, alpha, T0, t_final)\n    test_cases = [\n        (1.0, 1.0, 2.0, 1.0),  # Case A: Non-stiff\n        (1.0, 4.0, 2.0, 1.0),  # Case B: Moderately stiff\n        (1.0, 20.0, 2.0, 1.0) # Case C: Very stiff\n    ]\n\n    # Define the set of relative tolerances for the convergence study.\n    rtols = np.array([1e-3, 1e-5, 1e-7])\n    # Define the fixed absolute tolerance.\n    atol = 1e-12\n\n    results = []\n    for case in test_cases:\n        Lambda0, alpha, T0, tf = case\n\n        # Define the ODE function, f(t, y), where y is a vector.\n        # The problem is scalar, so we use y[0].\n        def ode_func(t, y):\n            return [-Lambda0 * y[0]**alpha]\n\n        # Define the analytical Jacobian of the ODE function, df/dy.\n        # For a scalar problem, this is a 1x1 matrix.\n        def jac_func(t, y):\n            return [[-Lambda0 * alpha * y[0]**(alpha - 1.0)]]\n\n        # Define the exact analytical solution T(t).\n        def analytic_solution(t):\n            if np.isclose(alpha, 1.0):\n                # Solution for alpha = 1\n                return T0 * np.exp(-Lambda0 * t)\n            else:\n                # Solution for alpha > 1\n                # The exponent (1.0 - alpha) is negative, so this is well-defined.\n                base = T0**(1.0 - alpha) + (alpha - 1.0) * Lambda0 * t\n                return base**(1.0 / (1.0 - alpha))\n\n        # Calculate the exact solution at the final time for error computation.\n        T_exact_f = analytic_solution(tf)\n\n        errors = []\n        for rtol in rtols:\n            # Integrate the ODE using the BDF method with the supplied Jacobian.\n            # We only need the solution at the final time t_f.\n            sol = solve_ivp(\n                fun=ode_func,\n                t_span=[0, tf],\n                y0=[T0],\n                method='BDF',\n                jac=jac_func,\n                rtol=rtol,\n                atol=atol,\n                t_eval=[tf]\n            )\n            \n            # Extract the numerical solution at t_f.\n            T_num_f = sol.y[0, -1]\n            \n            # Compute the absolute error against the exact solution.\n            error = np.abs(T_num_f - T_exact_f)\n            errors.append(error)\n        \n        # To find the convergence rate, we fit a line to log(error) vs. log(rtol).\n        # The slope of this line is the empirical order of convergence.\n        log_rtols = np.log(rtols)\n        log_errors = np.log(np.array(errors))\n        \n        # Perform a linear least-squares fit (degree 1 polynomial).\n        # np.polyfit returns coefficients [slope, intercept].\n        slope, _ = np.polyfit(log_rtols, log_errors, 1)\n        \n        # The problem asks for the absolute value of the slope.\n        results.append(abs(slope))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3535987"}]}