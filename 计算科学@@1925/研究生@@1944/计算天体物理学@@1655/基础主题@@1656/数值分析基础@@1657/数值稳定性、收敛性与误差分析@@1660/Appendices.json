{"hands_on_practices": [{"introduction": "在数值积分中，步长的选择是一门微妙的艺术。本练习将引导你探索一个根本性的权衡：一方面，减小步长可以降低离散化带来的截断误差；另一方面，过小的步长会增加计算步骤，累积更多的浮点舍入误差。通过分析一个简单的常微分方程，你将学习如何推导总误差的表达式，并找到一个能使截断误差和舍入误差达到最佳平衡的最优步长[@problem_id:3527095]，这对于理解数值计算的精度极限至关重要。", "problem": "考虑一个计算天体物理学背景下的线性常微分方程 (ODE)，它描述了耗散等离子体中模振幅的指数弛豫，方程为 $\\,\\frac{dx}{dt}=-\\lambda x\\,$，其中衰减率为常数 $\\,\\lambda=10^{4}\\,\\mathrm{s}^{-1}\\,$，初始条件为 $\\,x(0)=1\\,$。您将使用时间步长为 $\\,\\Delta t\\,$ 的显式欧拉法，在长度为 $\\,T=10^{-3}\\,\\mathrm{s}\\,$ 的固定区间上对该 ODE 进行积分。假设算术运算在电子电气工程师协会 (IEEE) 754 双精度浮点格式下进行，舍入方式为向最邻近值舍入，值距两端相等时取偶数，单位舍入误差为 $\\,u=2^{-53}\\,$。假设每次显式欧拉更新产生的每步相对舍入误差的幅值以 $\\,\\gamma u\\,$ 为界，其中 $\\,\\gamma=3\\,$，并且不会发生上溢或下溢。\n\n从 $\\,\\frac{dx}{dt}=-\\lambda x\\,$ 的精确解和显式欧拉更新法则的基本定义出发，推导在时刻 $\\,T\\,$ 的总绝对误差关于 $\\,\\Delta t\\,$ 的前导阶渐近表达式。该总绝对误差定义为在所述模型下，显式欧拉法的全局截断误差与累积浮点舍入误差之和。使用您推导的表达式：\n\n1. 对于给定的时间步长 $\\,\\Delta t=10^{-6}\\,\\mathrm{s}\\,$，计算在 $\\,T=10^{-3}\\,\\mathrm{s}\\,$ 时的总绝对误差。\n2. 在满足 $\\,\\frac{dx}{dt}=-\\lambda x\\,$ 的显式欧拉线性稳定性条件的约束下，确定在固定区间 $\\,T\\,$ 上使前导阶总绝对误差最小的时间步长 $\\,\\Delta t\\,$。\n\n将您的数值答案四舍五入至四位有效数字。以秒为单位表示时间步长。以无量纲振幅表示总绝对误差。", "solution": "该问题要求推导在使用显式欧拉法对常微分方程 (ODE) $\\frac{dx}{dt}=-\\lambda x$ 进行积分时，总绝对误差的前导阶表达式，然后使用此表达式计算特定时间步长的误差，并找到使该误差最小化的时间步长。\n\n经验证，该问题具有科学依据、提法恰当且客观。所有必要的参数均已提供，且无矛盾之处。我们可以开始求解。\n\n给定的常微分方程为：\n$$ \\frac{dx}{dt} = -\\lambda x $$\n初始条件为 $x(0)=1$。衰减率为 $\\lambda=10^{4}\\,\\mathrm{s}^{-1}$，积分区间长度为 $T=10^{-3}\\,\\mathrm{s}$。\n\n首先，我们确定该常微分方程的精确解。这是一个可分离的一阶线性常微分方程。\n$$ \\int_{x(0)}^{x(t)} \\frac{dx}{x} = \\int_0^t -\\lambda \\, d\\tau $$\n$$ \\ln|x(t)| - \\ln|x(0)| = -\\lambda t $$\n给定 $x(0)=1$，精确解为：\n$$ x(t) = \\exp(-\\lambda t) $$\n在最终时刻 $T$，精确解为 $x(T) = \\exp(-\\lambda T)$。\n\n接下来，我们使用显式欧拉法分析数值解。对于 $\\frac{dx}{dt} = f(t,x)$，更新法则是 $x_{n+1} = x_n + \\Delta t f(t_n, x_n)$。对于我们的问题，$f(t,x) = -\\lambda x$，因此更新法则是：\n$$ x_{n+1} = x_n - \\lambda \\Delta t x_n = (1 - \\lambda \\Delta t) x_n $$\n从 $x_0 = x(0) = 1$ 开始，经过 $N$ 步（其中 $N = T/\\Delta t$），在时刻 $T = N\\Delta t$ 的数值解为：\n$$ x_N = (1 - \\lambda \\Delta t)^N x_0 = (1 - \\lambda \\Delta t)^{T/\\Delta t} $$\n\n在时刻 $T$ 的总绝对误差是精确解 $x(T)$ 与计算得到的浮点解 $\\tilde{x}_N$ 之差的绝对值。此误差是两个分量的和：全局截断误差 (GTE) 和累积舍入误差。\n$$ E_{\\text{total}} = |x(T) - \\tilde{x}_N| \\le |x(T) - x_N| + |x_N - \\tilde{x}_N| = E_{\\text{trunc}} + E_{\\text{round}} $$\n我们现在推导这两个误差项的前导阶渐近表达式。\n\n1.  **全局截断误差 (GTE)**\n    GTE 是精确解 $x(T)$ 与精确算术数值解 $x_N$ 之间的差。\n    $$ E_{\\text{trunc}} = |x(T) - x_N| = |\\exp(-\\lambda T) - (1 - \\lambda \\Delta t)^{T/\\Delta t}| $$\n    为了找到对于小 $\\Delta t$ 的前导阶项，我们分析 $(1 - \\lambda \\Delta t)^{T/\\Delta t}$ 这一项。令 $z = \\lambda \\Delta t$。\n    $$ \\ln((1 - z)^{T/(\\lambda^{-1}z)}) = \\frac{T\\lambda}{z} \\ln(1 - z) $$\n    使用泰勒级数 $\\ln(1-z) = -z - \\frac{z^2}{2} - O(z^3)$：\n    $$ \\frac{T\\lambda}{z} \\left(-z - \\frac{z^2}{2} - O(z^3)\\right) = -T\\lambda - \\frac{T\\lambda z}{2} - O(z^2) $$\n    将 $z = \\lambda \\Delta t$ 代回：\n    $$ \\ln(x_N) = -\\lambda T - \\frac{\\lambda^2 T \\Delta t}{2} - O(\\Delta t^2) $$\n    对两边取指数：\n    $$ x_N = \\exp\\left(-\\lambda T - \\frac{\\lambda^2 T \\Delta t}{2} - O(\\Delta t^2)\\right) = \\exp(-\\lambda T) \\exp\\left(-\\frac{\\lambda^2 T \\Delta t}{2}\\right) (1-O(\\Delta t^2)) $$\n    对于小的 $w$，使用近似 $\\exp(-w) \\approx 1-w$：\n    $$ x_N \\approx \\exp(-\\lambda T) \\left(1 - \\frac{\\lambda^2 T \\Delta t}{2}\\right) $$\n    因此，GTE 为：\n    $$ E_{\\text{trunc}} = |x(T) - x_N| \\approx \\left|\\exp(-\\lambda T) - \\exp(-\\lambda T)\\left(1 - \\frac{\\lambda^2 T \\Delta t}{2}\\right)\\right| = \\left|\\exp(-\\lambda T) \\frac{\\lambda^2 T \\Delta t}{2}\\right| $$\n    由于 $\\lambda, T, \\Delta t > 0$，前导阶 GTE 为：\n    $$ E_{\\text{trunc}}(\\Delta t) = \\frac{\\lambda^2 T}{2} \\exp(-\\lambda T) \\Delta t $$\n\n2.  **累积舍入误差**\n    令 $\\tilde{x}_n$ 为使用浮点算术计算的数值解。问题陈述，每一步都会产生一个相对舍入误差 $\\delta_n$，其界限为 $|\\delta_n| \\le \\gamma u$，其中 $\\gamma=3$ 且 $u=2^{-53}$。浮点更新为：\n    $$ \\tilde{x}_{n+1} = \\tilde{x}_n(1 - \\lambda \\Delta t)(1 + \\delta_n) $$\n    令 $r_n = \\tilde{x}_n - x_n$ 为第 $n$ 步的舍入误差。我们有 $r_0=0$。\n    $$ r_{n+1} = \\tilde{x}_{n+1} - x_{n+1} = (\\tilde{x}_n)(1 - \\lambda \\Delta t)(1 + \\delta_n) - x_n(1-\\lambda\\Delta t) $$\n    $$ r_{n+1} = (x_n + r_n)(1 - \\lambda \\Delta t)(1 + \\delta_n) - x_{n+1} $$\n    $$ r_{n+1} = (x_{n+1} + r_n(1 - \\lambda \\Delta t))(1 + \\delta_n) - x_{n+1} \\approx x_{n+1}\\delta_n + r_n(1 - \\lambda \\Delta t) $$\n    $r_n$ 的这个递推关系可以展开为：\n    $$ r_N = \\sum_{n=0}^{N-1} (1-\\lambda\\Delta t)^{N-1-n} (x_{n+1}\\delta_n) $$\n    由于 $x_{n+1} = x_0(1-\\lambda\\Delta t)^{n+1}$ 且 $x_0=1$，我们得到：\n    $$ r_N = \\sum_{n=0}^{N-1} (1-\\lambda\\Delta t)^{N-1-n} (1-\\lambda\\Delta t)^{n+1} \\delta_n = (1-\\lambda\\Delta t)^N \\sum_{n=0}^{N-1} \\delta_n = x_N \\sum_{n=0}^{N-1} \\delta_n $$\n    为了得到最坏情况下的界，我们假设所有的 $\\delta_n$ 都具有相同的符号和最大幅值 $\\gamma u$：\n    $$ E_{\\text{round}} = |r_N| \\le |x_N| \\sum_{n=0}^{N-1} |\\delta_n| \\le |x_N| N \\gamma u = |x_N| \\frac{T}{\\Delta t} \\gamma u $$\n    对于前导阶表达式，我们将 $|x_N|=|(1-\\lambda\\Delta t)^{T/\\Delta t}|$ 替换为其极限 $\\exp(-\\lambda T)$：\n    $$ E_{\\text{round}}(\\Delta t) \\approx \\exp(-\\lambda T) \\frac{T\\gamma u}{\\Delta t} $$\n\n3.  **总误差与最优化**\n    总误差是截断误差和舍入误差之和：\n    $$ E_{\\text{total}}(\\Delta t) \\approx \\frac{\\lambda^2 T}{2} \\exp(-\\lambda T) \\Delta t + \\frac{T\\gamma u}{\\Delta t} \\exp(-\\lambda T) $$\n    $$ E_{\\text{total}}(\\Delta t) \\approx T \\exp(-\\lambda T) \\left( \\frac{\\lambda^2}{2} \\Delta t + \\frac{\\gamma u}{\\Delta t} \\right) $$\n\n**第1部分：计算 $\\Delta t = 10^{-6}\\,\\mathrm{s}$ 时的总误差**\n我们代入给定值：\n$T = 10^{-3}\\,\\mathrm{s}$\n$\\lambda = 10^{4}\\,\\mathrm{s}^{-1}$\n$\\Delta t = 10^{-6}\\,\\mathrm{s}$\n$\\gamma = 3$\n$u = 2^{-53}$\n首先，我们计算常数项：\n$\\lambda T = 10^4 \\cdot 10^{-3} = 10$\n$\\lambda^2/2 = (10^4)^2/2 = 5 \\times 10^7$\n$E_{\\text{total}}(10^{-6}) \\approx 10^{-3} \\exp(-10) \\left( (5 \\times 10^7)(10^{-6}) + \\frac{3 \\cdot 2^{-53}}{10^{-6}} \\right)$\n$E_{\\text{total}}(10^{-6}) \\approx 10^{-3} \\exp(-10) \\left( 50 + 3 \\times 10^6 \\cdot 2^{-53} \\right)$\n使用数值 $ \\exp(-10) \\approx 4.53999 \\times 10^{-5} $ 和 $u=2^{-53} \\approx 1.11022 \\times 10^{-16}$：\n$3 \\times 10^6 \\cdot 2^{-53} \\approx 3 \\times 10^6 \\cdot 1.11022 \\times 10^{-16} = 3.33066 \\times 10^{-10}$\n括号中的第二项与 $50$ 相比可以忽略不计。\n$E_{\\text{total}}(10^{-6}) \\approx 10^{-3} \\exp(-10) \\cdot 50 = 5 \\times 10^{-2} \\exp(-10)$\n$E_{\\text{total}}(10^{-6}) \\approx 5 \\times 10^{-2} \\times (4.53999 \\times 10^{-5}) \\approx 2.269995 \\times 10^{-6}$\n四舍五入到四位有效数字，总绝对误差为 $2.270 \\times 10^{-6}$。\n\n**第2部分：确定最优时间步长 $\\Delta t$**\n为了找到使 $E_{\\text{total}}(\\Delta t)$ 最小化的时间步长 $\\Delta t_{\\text{opt}}$，我们将总误差表达式对 $\\Delta t$ 求导，并令导数为零。令 $C_1 = T \\exp(-\\lambda T) \\frac{\\lambda^2}{2}$ 及 $C_2 = T \\exp(-\\lambda T) \\gamma u$。\n$$ E_{\\text{total}}(\\Delta t) \\approx C_1 \\Delta t + \\frac{C_2}{\\Delta t} $$\n$$ \\frac{d E_{\\text{total}}}{d \\Delta t} = C_1 - \\frac{C_2}{(\\Delta t)^2} = 0 $$\n$$ (\\Delta t_{\\text{opt}})^2 = \\frac{C_2}{C_1} = \\frac{T \\exp(-\\lambda T) \\gamma u}{T \\exp(-\\lambda T) \\frac{\\lambda^2}{2}} = \\frac{2\\gamma u}{\\lambda^2} $$\n$$ \\Delta t_{\\text{opt}} = \\sqrt{\\frac{2\\gamma u}{\\lambda^2}} = \\frac{\\sqrt{2\\gamma u}}{\\lambda} $$\n我们现在根据该问题上显式欧拉法的线性稳定性条件来检查这个结果，该条件为 $|1 - \\lambda \\Delta t| \\le 1$。这意味着 $-1 \\le 1 - \\lambda \\Delta t \\le 1$，可简化为 $0 \\le \\lambda \\Delta t \\le 2$，或 $\\Delta t \\le 2/\\lambda$。\n稳定性极限是 $\\Delta t_{\\text{stab}} = 2/\\lambda = 2/10^4 = 2 \\times 10^{-4}\\,\\mathrm{s}$。\n现在我们计算 $\\Delta t_{\\text{opt}}$：\n$$ \\Delta t_{\\text{opt}} = \\frac{\\sqrt{2 \\cdot 3 \\cdot 2^{-53}}}{10^4} = \\frac{\\sqrt{6 \\cdot 2^{-53}}}{10^4} $$\n使用 $u=2^{-53} \\approx 1.110223 \\times 10^{-16}$：\n$$ \\Delta t_{\\text{opt}} \\approx \\frac{\\sqrt{6 \\times 1.110223 \\times 10^{-16}}}{10^4} = \\frac{\\sqrt{6.661338 \\times 10^{-16}}}{10^4} = \\frac{2.580957 \\times 10^{-8}}{10^4} = 2.580957 \\times 10^{-12}\\,\\mathrm{s} $$\n由于 $\\Delta t_{\\text{opt}} \\approx 2.581 \\times 10^{-12}\\,\\mathrm{s}$ 远小于 $\\Delta t_{\\text{stab}} = 2 \\times 10^{-4}\\,\\mathrm{s}$，因此最优时间步长位于稳定区域内。\n四舍五入到四位有效数字，最优时间步长为 $2.581 \\times 10^{-12}\\,\\mathrm{s}$。\n\n最终答案是：\n1. 当 $\\Delta t = 10^{-6}\\,\\mathrm{s}$ 时的总绝对误差：$2.270 \\times 10^{-6}$。\n2. 最优时间步长 $\\Delta t_{\\text{opt}}$：$2.581 \\times 10^{-12}\\,\\mathrm{s}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 2.270 \\times 10^{-6}  2.581 \\times 10^{-12} \\end{pmatrix} } $$", "id": "3527095"}, {"introduction": "许多天体物理系统，如恒星内部的化学反应网络或等离子体中的热弛豫，涉及在悬殊的时间尺度上发生的多种过程，这导致了所谓的“刚性”方程组。本练习将通过一个典型的双模态弛豫模型，揭示为何标准显式方法（如龙格-库塔法）因其严苛的稳定性条件而变得不切实际[@problem_id:3527094]。通过对比显式方法和隐式欧拉法在计算成本上的巨大差异，你将深刻理解在处理刚性问题时，选择合适的数值方法是何等重要。", "problem": "考虑一个与计算天体物理学相关的双模态热弛豫的线性自治常微分方程（ODE）模型，其状态向量 $\\mathbf{y}(t) = (y_1(t), y_2(t))^{\\top}$ 的演化遵循以下方程\n$$\n\\frac{d\\mathbf{y}}{dt} = -\\Lambda \\mathbf{y}, \\quad \\Lambda = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix}, \\quad \\lambda_1 = 1, \\ \\lambda_2 = 10^{6},\n$$\n在有限时间区间 $t \\in [0,1]$ 上。假设初始数据为 $\\mathbf{y}(0) = (1,1)^{\\top}$，并测量慢分量 $y_1(t)$ 的绝对误差。\n\n你需要分析两种数值方法：使用均匀时间步长 $h_{\\mathrm{RK4}}$ 的显式经典四阶龙格-库塔方法（显式RK4），以及使用均匀时间步长 $h_{\\mathrm{IE}}$ 的隐式欧拉法（也称后向欧拉法）。\n\n任务：\n1. 应用于标量测试方程 $\\frac{dy}{dt} = -\\lambda y$ 的单步法的线性稳定性要求，推导对于给定的 $\\lambda_1$ 和 $\\lambda_2$，为保证显式RK4方法的稳定性所需的步长 $h_{\\mathrm{RK4}}$ 的限制。你的推导应基于这样一个事实：对于每个特征值，稳定性要求 $|R(-h \\lambda)| \\leq 1$，其中 $R(z)$ 是该方法的标量稳定性函数。\n2. 对于隐式欧拉法，在 $h_{\\mathrm{IE}}$ 很小的极限下，推导保证绝对误差 $|y_1(1) - \\exp(-1)|$ 至多为目标容差 $\\varepsilon = 10^{-6}$ 的关于 $h_{\\mathrm{IE}}$ 的主阶渐近条件。\n3. 在这些条件下，令 $N_{\\mathrm{RK4}} = 1/h_{\\mathrm{RK4}}$ 和 $N_{\\mathrm{IE}} = 1/h_{\\mathrm{IE}}$ 分别表示两种方法在 $[0,1]$ 区间上的均匀步数。定义计算成本比为 $C = N_{\\mathrm{RK4}}/N_{\\mathrm{IE}}$。使用在第1部分和第2部分中推导出的最紧凑的步长限制来计算 $C$。\n\n将你的 $C$ 的最终值四舍五入到三位有效数字。$C$ 不需要单位。", "solution": "该问题经过验证。\n\n### 第1步：提取已知条件\n- **常微分方程组**：$\\frac{d\\mathbf{y}}{dt} = -\\Lambda \\mathbf{y}$\n- **状态向量**：$\\mathbf{y}(t) = (y_1(t), y_2(t))^{\\top}$\n- **矩阵 $\\Lambda$**：$\\Lambda = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix}$\n- **特征值**：$\\lambda_1 = 1$, $\\lambda_2 = 10^{6}$\n- **时间区间**：$t \\in [0,1]$\n- **初始条件**：$\\mathbf{y}(0) = (1,1)^{\\top}$\n- **方法**：显式经典四阶龙格-库塔（显式RK4）和隐式欧拉。\n- **时间步长**：均匀步长 $h_{\\mathrm{RK4}}$ 和 $h_{\\mathrm{IE}}$。\n- **任务1（RK4稳定性）**：基于稳定性函数 $R(z)$ 的要求 $|R(-h \\lambda)| \\leq 1$，推导为保证稳定性所需的步长 $h_{\\mathrm{RK4}}$ 的限制。\n- **任务2（隐式欧拉精度）**：推导使得绝对误差 $|y_1(1) - \\exp(-1)| \\leq \\varepsilon$ 的关于 $h_{\\mathrm{IE}}$ 的渐近条件，其中容差 $\\varepsilon = 10^{-6}$。\n- **任务3（成本比）**：计算 $C = N_{\\mathrm{RK4}}/N_{\\mathrm{IE}}$，其中 $N = 1/h$。$C$ 的最终值必须四舍五入到三位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题模拟了一个刚性常微分方程组，这是包括天体物理学在内的计算科学中的一个基本且现实的挑战。数值稳定性（RK4）和精度（隐式欧拉）的分析是数值分析中标准且成熟的程序。\n- **适定性**：该问题是适定的。该系统是线性的且解耦的，可以直接求出解析解以供比较。任务有足够的数据和明确的目标：推导稳定性限制的步长、精度限制的步长及其比率。存在唯一且有意义的解。\n- **客观性**：该问题使用精确、客观的数学语言陈述，没有任何主观性或模糊性。\n\n### 第3步：结论与行动\n该问题是有效的，因为它是科学合理的、适定的和客观的。将提供完整的解答。\n\n***\n\n给定的常微分方程组为 $\\frac{d\\mathbf{y}}{dt} = -\\Lambda \\mathbf{y}$。由于矩阵 $\\Lambda$ 是对角矩阵，该系统代表两个解耦的标量常微分方程：\n$$\n\\frac{dy_1}{dt} = -\\lambda_1 y_1 = -y_1\n$$\n$$\n\\frac{dy_2}{dt} = -\\lambda_2 y_2 = -10^6 y_2\n$$\n在初始条件 $\\mathbf{y}(0) = (1,1)^{\\top}$ 下，精确解为：\n$$\ny_1(t) = \\exp(-\\lambda_1 t) = \\exp(-t)\n$$\n$$\ny_2(t) = \\exp(-\\lambda_2 t) = \\exp(-10^6 t)\n$$\n该系统是刚性的，因为特征值 $\\lambda_1$ 和 $\\lambda_2$ 相差多个数量级（$\\lambda_2/\\lambda_1 = 10^6$）。分量 $y_2(t)$ 代表一个快速衰减的瞬态，而 $y_1(t)$ 代表一个缓慢衰减的模态。\n\n### 任务1：显式RK4的稳定性\n对于一个线性系统，如果数值解对于任何模态都不增长，则该数值方法是稳定的。这要求对于系统雅可比矩阵的每个特征值 $\\lambda$，步长 $h$ 必须满足 $|R(-h\\lambda)| \\leq 1$，其中 $R(z)$ 是该方法的稳定性函数。对于给定的系统，雅可比矩阵 $-\\Lambda$ 的特征值为 $-\\lambda_1 = -1$ 和 $-\\lambda_2 = -10^6$。\n\n显式RK4方法的稳定性函数是指数函数的四阶泰勒多项式：\n$$\nR(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\n该条件必须对两个特征值都成立。我们来分析稳定性函数的自变量 $z = -h\\lambda$。\n对于 $\\lambda_1 = 1$，条件是 $|R(-h_{\\mathrm{RK4}})| \\le 1$。\n对于 $\\lambda_2 = 10^6$，条件是 $|R(-h_{\\mathrm{RK4}} \\cdot 10^6)| \\le 1$。\n\n由于 $\\lambda_2 \\gg \\lambda_1$，方法的稳定性受到与 $\\lambda_2$ 相关的快速模态的限制。自变量 $-h_{\\mathrm{RK4}}\\lambda_2$ 必须位于RK4方法的绝对稳定区域内。对于负实数自变量 $z \\in \\mathbb{R}^{-}$，该区域是区间 $[-S_{\\mathrm{RK4}}, 0]$，其中 $S_{\\mathrm{RK4}} \\approx 2.785$ 是 $|R(-S)|=1$ 的解。\n因此，稳定性的条件是：\n$$\nh_{\\mathrm{RK4}} \\lambda_2 \\leq S_{\\mathrm{RK4}}\n$$\n为了找到最紧凑的步长限制，我们使用能确保稳定性的最大可能步长：\n$$\nh_{\\mathrm{RK4}} = \\frac{S_{\\mathrm{RK4}}}{\\lambda_2} = \\frac{2.785}{10^6} = 2.785 \\times 10^{-6}\n$$\n\n### 任务2：隐式欧拉法的精度\n隐式欧拉法是A-稳定的，这意味着其绝对稳定区域覆盖整个左半复平面。因此，对于任何 $h > 0$ 和 $\\lambda > 0$，都有 $|R(-h\\lambda)| = |1/(1+h\\lambda)|  1$。稳定性对步长 $h_{\\mathrm{IE}}$ 没有施加任何限制。步长仅受慢分量 $y_1(t)$ 的精度要求的限制。\n\n对于第一个分量 $y_1'(t) = -\\lambda_1 y_1(t)$ 的隐式欧拉格式为：\n$$\n\\frac{y_{1,n+1} - y_{1,n}}{h_{\\mathrm{IE}}} = -\\lambda_1 y_{1,n+1} \\implies y_{1,n+1} = \\frac{y_{1,n}}{1 + h_{\\mathrm{IE}}\\lambda_1}\n$$\n经过 $N$ 步到达时间 $t = N h_{\\mathrm{IE}}$ 后，数值解为 $y_{1,N} = y_{1,0} (1 + h_{\\mathrm{IE}}\\lambda_1)^{-N}$。对于区间 $[0,1]$，我们有 $N = 1/h_{\\mathrm{IE}}$，$y_{1,0}=1$ 和 $\\lambda_1=1$。在 $t=1$ 时的数值解为：\n$$\ny_{1, \\text{num}}(1) = (1 + h_{\\mathrm{IE}})^{-1/h_{\\mathrm{IE}}}\n$$\n精确解为 $y_1(1) = \\exp(-1)$。绝对误差为 $|y_{1, \\text{num}}(1) - y_1(1)|$。对于小的 $h_{\\mathrm{IE}}$，我们可以分析此误差的主阶项。\n我们使用 $\\ln(1+x)$ 在 $x=0$ 附近的泰勒级数展开：$\\ln(1+x) = x - \\frac{x^2}{2} + O(x^3)$。\n\\begin{align*}\ny_{1, \\text{num}}(1) = (1 + h_{\\mathrm{IE}})^{-1/h_{\\mathrm{IE}}} = \\exp\\left(-\\frac{1}{h_{\\mathrm{IE}}} \\ln(1 + h_{\\mathrm{IE}})\\right) \\\\\n= \\exp\\left(-\\frac{1}{h_{\\mathrm{IE}}} \\left(h_{\\mathrm{IE}} - \\frac{h_{\\mathrm{IE}}^2}{2} + O(h_{\\mathrm{IE}}^3)\\right)\\right) \\\\\n= \\exp\\left(-1 + \\frac{h_{\\mathrm{IE}}}{2} + O(h_{\\mathrm{IE}}^2)\\right) \\\\\n= \\exp(-1) \\exp\\left(\\frac{h_{\\mathrm{IE}}}{2} + O(h_{\\mathrm{IE}}^2)\\right)\n\\end{align*}\n对于小的 $x$，使用展开式 $\\exp(x) = 1+x+O(x^2)$：\n$$\ny_{1, \\text{num}}(1) \\approx \\exp(-1) \\left(1 + \\frac{h_{\\mathrm{IE}}}{2}\\right)\n$$\n因此，在 $t=1$ 处的主阶全局误差为：\n$$\nE(h_{\\mathrm{IE}}) = y_{1, \\text{num}}(1) - \\exp(-1) \\approx \\frac{h_{\\mathrm{IE}}}{2} \\exp(-1)\n$$\n我们要求 $|E(h_{\\mathrm{IE}})| \\leq \\varepsilon = 10^{-6}$。\n$$\n\\frac{h_{\\mathrm{IE}}}{2} \\exp(-1) \\leq 10^{-6}\n$$\n求解最紧凑的限制（允许的最大步长）：\n$$\nh_{\\mathrm{IE}} = \\frac{2 \\times 10^{-6}}{\\exp(-1)} = 2e \\times 10^{-6}\n$$\n\n### 任务3：计算成本比\n每种方法在区间 $[0,1]$ 上积分所需的步数为 $N = 1/h$。\n$$\nN_{\\mathrm{RK4}} = \\frac{1}{h_{\\mathrm{RK4}}} = \\frac{1}{2.785 \\times 10^{-6}}\n$$\n$$\nN_{\\mathrm{IE}} = \\frac{1}{h_{\\mathrm{IE}}} = \\frac{1}{2e \\times 10^{-6}}\n$$\n计算成本比 $C$ 定义为 $C = N_{\\mathrm{RK4}}/N_{\\mathrm{IE}}$。\n$$\nC = \\frac{N_{\\mathrm{RK4}}}{N_{\\mathrm{IE}}} = \\frac{1/h_{\\mathrm{RK4}}}{1/h_{\\mathrm{IE}}} = \\frac{h_{\\mathrm{IE}}}{h_{\\mathrm{RK4}}}\n$$\n代入推导出的步长：\n$$\nC = \\frac{2e \\times 10^{-6}}{2.785 \\times 10^{-6}} = \\frac{2e}{2.785}\n$$\n使用 $e \\approx 2.71828$ 的值：\n$$\nC \\approx \\frac{2 \\times 2.71828}{2.785} \\approx \\frac{5.43656}{2.785} \\approx 1.952086...\n$$\n四舍五入到三位有效数字，我们得到 $C \\approx 1.95$。这个结果表明，对于给定的精度要求，由于刚性分量施加的严格稳定性约束，显式RK4方法所需的步数大约是隐式欧拉法的两倍。", "answer": "$$\n\\boxed{1.95}\n$$", "id": "3527094"}, {"introduction": "理论分析之后，我们转向一个更接近真实研究的实践：通过编写代码来模拟物理波的传播。本练习将指导你使用有限体积法和Lax-Friedrichs通量来模拟一维线性阿尔芬波[@problem_id:3527099]。通过在不同分辨率的网格上进行模拟，你将亲手测量并量化数值格式的固有误差如何表现为非物理效应——振幅衰减（数值耗散）和相位滞后（数值色散），从而直观地理解数值解的收敛性。", "problem": "您需要实现一个独立的程序，使用一阶有限体积法，在 Courant–Friedrichs–Lewy (CFL) 数为 $0.8$ 的条件下，通过 Lax–Friedrichs (Rusanov) 数值通量来数值模拟一维线性 Alfvén 波。目的是量化数值耗散（振幅衰减）和数值色散（相位滞后）作为空间分辨率的函数。\n\n物理模型是理想磁流体力学（MHD, Magnetohydrodynamics）的线性化 Alfvén 子系统，采用无量纲单位，真空磁导率设为1。设 $x \\in [0,L)$，采用周期性边界条件。在背景密度 $\\rho_0$ 和背景磁场 $B_0$ 恒定且沿 $x$ 轴方向的情况下，针对横向扰动 $(v_y,B_y)$ 的解耦线性 Alfvén 子系统可以写成守恒形式\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0,\\quad \\mathbf{U} =\n\\begin{bmatrix}\nv_y \\\\\nB_y\n\\end{bmatrix},\\quad\n\\mathbf{F}(\\mathbf{U}) =\n\\begin{bmatrix}\n- (B_0/\\rho_0)\\, B_y \\\\\n- B_0\\, v_y\n\\end{bmatrix}.\n$$\n特征速度为 $\\lambda = \\pm v_A$，其中 Alfvén 速度为 $v_A = B_0/\\sqrt{\\rho_0}$。\n\n通过选择以下方式初始化一个波数为 $k = 2\\pi/L$ 的右行单色模式：\n$$\nv_y(x,0) = A \\sin(k x),\\quad B_y(x,0) = -\\sqrt{\\rho_0}\\, v_y(x,0),\n$$\n这对应于右行 Alfvén 本征模。精确解保持振幅不变且传播无畸变：\n$$\nv_y(x,t) = A \\sin(k (x - v_A t)),\\quad B_y(x,t) = -\\sqrt{\\rho_0}\\, v_y(x,t).\n$$\n\n数值方法和参数：\n- 使用一个包含 $N$ 个单元的均匀网格，单元中心为 $x_i = (i+1/2)\\,\\Delta x$, $i=0,\\dots,N-1$, $\\Delta x = L/N$。\n- 使用一阶有限体积更新\n$$\n\\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\hat{\\mathbf{F}}_{i+1/2}^n - \\hat{\\mathbf{F}}_{i-1/2}^n\\right),\n$$\n采用周期性边界条件，其中 Lax–Friedrichs (Rusanov) 界面通量为\n$$\n\\hat{\\mathbf{F}}_{i+1/2} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_i) + \\mathbf{F}(\\mathbf{U}_{i+1})\\right) - \\frac{\\alpha}{2}\\left(\\mathbf{U}_{i+1} - \\mathbf{U}_i\\right),\n$$\n且 $\\alpha = \\max|\\lambda| = v_A$。\n- 通过 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/\\alpha$ 对所有完整时间步强制施加 $0.8$ 的 Courant–Friedrichs–Lewy (CFL) 数。如果经过整数个完整步长后未精确达到最终时间 $T$，则执行最后一个步长 $\\Delta t_\\mathrm{final} \\le \\mathrm{CFL}\\,\\Delta x/\\alpha$ 以精确达到 $T$。\n- 使用定义域长度 $L = 1$，背景参数 $\\rho_0 = 1$, $B_0 = 1$ (因此 $v_A = 1$)，振幅 $A = 10^{-3}$，以及最终时间 $T = 0.7$（无量纲单位）。\n\n测量与输出：\n- 设 $k = 2\\pi/L$。在推进到时间 $T$ 后，通过在单元中心上使用离散内积，将 $v_y(x,T)$ 投影到基 $\\{\\sin(k x), \\cos(k x)\\}$ 上，以计算数值振幅和相位。定义\n$$\na_s = \\frac{\\sum_{i=0}^{N-1} v_y(x_i,T)\\,\\sin(k x_i)}{\\sum_{i=0}^{N-1} \\sin^2(k x_i)},\\quad\na_c = \\frac{\\sum_{i=0}^{N-1} v_y(x_i,T)\\,\\cos(k x_i)}{\\sum_{i=0}^{N-1} \\cos^2(k x_i)}.\n$$\n则数值振幅和相位为\n$$\nA_\\mathrm{num} = \\sqrt{a_s^2 + a_c^2},\\quad \\phi_\\mathrm{num} = \\mathrm{atan2}(a_c, a_s).\n$$\n精确相位为 $\\phi_\\mathrm{exact} = -k v_A T$。定义振幅比和相位误差为\n$$\nR = \\frac{A_\\mathrm{num}}{A},\\quad \\Delta\\phi = \\mathrm{wrap}_{(-\\pi,\\pi]}\\left(\\phi_\\mathrm{num} - \\phi_\\mathrm{exact}\\right),\n$$\n其中 $\\mathrm{wrap}_{(-\\pi,\\pi]}(\\cdot)$ 将角度包装到 $(-\\pi,\\pi]$ 区间内。以弧度报告 $\\Delta\\phi$。\n\n测试套件：\n- 针对以下网格分辨率 $N \\in \\{32, 64, 128, 256\\}$，模拟并报告 $(R,\\Delta\\phi)$。\n- 使用固定参数 $L = 1$, $\\rho_0 = 1$, $B_0 = 1$, $A = 10^{-3}$, $T = 0.7$, $\\mathrm{CFL} = 0.8$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由四个双元素列表组成的列表，每个内部列表为对应一个 $N$ 的 $[R,\\Delta\\phi]$，顺序为 $N=32$, $N=64$, $N=128$, $N=256$。\n- 单行输出必须格式化为逗号分隔的列表，不含空格，并用方括号括起来。例如：“[[R32,phi32],[R64,phi64],[R128,phi128],[R256,phi256]]”。\n- $R$ 和 $\\Delta\\phi$ 必须是浮点数。以弧度（无量纲）报告 $\\Delta\\phi$，$R$ 作为无量纲比率报告。\n\n本问题中的所有量均为无量纲；无需物理单位。角度必须以弧度为单位。", "solution": "我们考虑理想磁流体力学（MHD, Magnetohydrodynamics）中关于密度为 $\\rho_0$、磁场 $B_0$ 沿 $x$ 方向的均匀态的一维线性化 Alfvén 子系统。在横向变量 $\\mathbf{U} = [v_y, B_y]^T$ 中，该系统为\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0,\\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix}\n- (B_0/\\rho_0) B_y \\\\\n- B_0 v_y\n\\end{bmatrix}\n$$\n具有常系数雅可比矩阵 $\\mathbf{A} = \\partial \\mathbf{F}/\\partial \\mathbf{U} = \\begin{bmatrix} 0  -B_0/\\rho_0 \\\\ -B_0  0 \\end{bmatrix}$，其特征值为 $\\lambda = \\pm v_A$，其中 Alfvén 速度为 $v_A = B_0/\\sqrt{\\rho_0}$。右行特征向量满足 $B_y = -\\sqrt{\\rho_0}\\, v_y$，左行特征向量满足 $B_y = +\\sqrt{\\rho_0}\\, v_y$。\n\n我们按如下方式初始化一个波数为 $k = 2\\pi/L$ 的右行单傅里叶模式：\n$$\nv_y(x,0) = A \\sin(k x),\\quad B_y(x,0) = -\\sqrt{\\rho_0}\\, v_y(x,0),\n$$\n这是该系统的一个本征模。精确解保持振幅不变并以速度 $v_A$ 平移：\n$$\nv_y(x,t) = A \\sin(k (x - v_A t)),\\quad B_y(x,t) = -\\sqrt{\\rho_0}\\, v_y(x,t).\n$$\n\n我们在空间上对一个包含 $N$ 个单元的均匀网格进行离散化，单元中心为 $x_i = (i+1/2)\\,\\Delta x$, $i=0,\\dots,N-1$, $\\Delta x = L/N$。一阶有限体积法通过以下方式更新单元平均值：\n$$\n\\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\hat{\\mathbf{F}}_{i+1/2}^n - \\hat{\\mathbf{F}}_{i-1/2}^n\\right),\n$$\n其中强制施加周期性边界条件，$\\hat{\\mathbf{F}}_{i+1/2}$ 是 Lax–Friedrichs (Rusanov) 数值通量\n$$\n\\hat{\\mathbf{F}}_{i+1/2} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_i) + \\mathbf{F}(\\mathbf{U}_{i+1})\\right) - \\frac{\\alpha}{2}\\left(\\mathbf{U}_{i+1} - \\mathbf{U}_i\\right),\\quad \\alpha = \\max|\\lambda| = v_A.\n$$\n时间步进使用 Courant–Friedrichs–Lewy (CFL) 数 $\\mathrm{CFL} = 0.8$，即对所有完整步长使用 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/\\alpha$，如果需要，再加上一个最终的较短步长以精确达到 $T$。\n\n由于初始条件是单个右行本征模，当投影到右特征向量上时，系统有效地简化为以速度 $a = v_A$ 平流一个标量波。对于标量线性平流方程 $u_t + a u_x = 0$，使用常数 $\\alpha = |a|$ 的 Lax–Friedrichs (Rusanov) 更新可以写为\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\alpha \\Delta t}{2\\Delta x}(u_{j+1}^n - 2 u_j^n + u_{j-1}^n).\n$$\n通过对 $u_{j\\pm 1}^n$ 和 $u_j^{n+1}$ 进行泰勒展开得到的修正方程分析表明，在 $\\Delta x$ 的主导阶上，\n$$\nu_t + a u_x = D\\, u_{xx} + \\mathcal{O}(\\Delta x^2),\\quad D = \\frac{1}{2}\\left(\\alpha \\Delta x - a^2 \\Delta t\\right).\n$$\n当 $\\alpha = |a|$ 且 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/\\alpha$ 时，这简化为\n$$\nD = \\frac{|a|\\,\\Delta x}{2}\\left(1 - \\mathrm{CFL}\\right).\n$$\n因此，对于单个傅里叶模式 $u \\propto \\sin(k x)$，振幅近似按 $\\exp(- D k^2 t)$ 衰减，这揭示了由 $1 - \\mathrm{CFL}$ 控制的、与 $\\Delta x$ 呈线性的耗散误差。此外，修正方程中的高阶项在左侧包含一个形式为 $(a/6)\\,\\Delta x^2\\, u_{xxx}$ 的色散项，这意味着有效的数值相速度为\n$$\nc_\\mathrm{num} \\approx a\\left(1 - \\frac{(k \\Delta x)^2}{6}\\right)\n$$\n对于小的 $k \\Delta x$。因此，在时间 $T$ 之后，相位误差表现为\n$$\n\\Delta \\phi \\equiv (\\phi_\\mathrm{num} - \\phi_\\mathrm{exact}) \\approx \\left(c_\\mathrm{num} - a\\right) k T \\approx -\\frac{a}{6}\\, k^3\\, \\Delta x^2\\, T,\n$$\n对于固定的 $k$ 和 $T$，这是关于 $\\Delta x$ 的二阶精度。\n\n在我们的具体设置中，我们选择 $L = 1$, $\\rho_0 = 1$, $B_0 = 1$，因此 $v_A = 1$，且 $k = 2\\pi/L = 2\\pi$。我们设置 $A = 10^{-3}$ 和 $T = 0.7$。对于每个 $N \\in \\{32, 64, 128, 256\\}$，算法按以下步骤进行：\n1. 计算 $\\Delta x = L/N$ 和 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/\\alpha$，其中 $\\mathrm{CFL} = 0.8$, $\\alpha = v_A = 1$。\n2. 在单元中心 $x_i = (i+1/2)\\,\\Delta x$ 处，使用 $v_y(x,0) = A \\sin(k x)$ 和 $B_y(x,0) = -\\sqrt{\\rho_0}\\, v_y(x,0)$ 初始化 $\\mathbf{U}_i^0$。\n3. 通过重复应用使用 Lax–Friedrichs 通量的有限体积更新来推进时间，并使用一个最终的较短步长，以使累积时间精确等于 $T$。\n4. 使用投影测量 $v_y(x,T)$ 的数值振幅和相位\n$$\na_s = \\frac{\\sum_i v_y(x_i,T)\\,\\sin(k x_i)}{\\sum_i \\sin^2(k x_i)},\\quad\na_c = \\frac{\\sum_i v_y(x_i,T)\\,\\cos(k x_i)}{\\sum_i \\cos^2(k x_i)},\n$$\n然后计算\n$$\nA_\\mathrm{num} = \\sqrt{a_s^2 + a_c^2},\\quad \\phi_\\mathrm{num} = \\mathrm{atan2}(a_c,a_s).\n$$\n5. 计算精确相位 $\\phi_\\mathrm{exact} = -k v_A T$ 并定义振幅比和相位误差\n$$\nR = \\frac{A_\\mathrm{num}}{A},\\quad \\Delta\\phi = \\mathrm{wrap}_{(-\\pi,\\pi]}\\left(\\phi_\\mathrm{num} - \\phi_\\mathrm{exact}\\right).\n$$\n\n解释：\n- 耗散：Lax–Friedrichs 格式引入了一个主导阶的扩散系数 $D = \\frac{1}{2} v_A \\Delta x (1 - \\mathrm{CFL})$。对于我们的 $\\mathrm{CFL} = 0.8$ 和 $v_A = 1$，有 $D = 0.1\\,\\Delta x$。因此，振幅比应近似遵循 $R \\approx \\exp(- D k^2 T) = \\exp(-0.1\\, k^2\\, \\Delta x\\, T)$，当 $\\Delta x \\to 0$ 时，该值线性趋近于 $1$。\n- 色散：相速度误差为 $\\mathcal{O}(\\Delta x^2)$ 阶，这意味着对于右行模式 $a = v_A = 1$，有 $\\Delta \\phi \\sim -\\frac{1}{6} k^3 \\Delta x^2 T$。因此，将分辨率加倍（即 $\\Delta x$ 减半）应使 $\\Delta \\phi$ 的量级大约减小 4 倍。\n\n该程序实现了这个求解器，并为指定的 $N$ 值输出一个单行格式的四个 $[R,\\Delta\\phi]$（弧度）对的列表，不含空格，从而实现自动验证。报告的量是无量纲的，角度以弧度为单位。\n```python\nimport numpy as np\n\ndef rusanov_flux(U, F, alpha):\n    \"\"\"\n    Compute Rusanov (Lax–Friedrichs) numerical flux at all interfaces for a 1D periodic grid.\n    U: array shape (m, N), conservative variables in each cell.\n    F: array shape (m, N), physical flux in each cell.\n    alpha: scalar, maximum wavespeed (constant).\n    Returns: array shape (m, N), numerical flux at interfaces i+1/2 stored at index i.\n    \"\"\"\n    U_right = np.roll(U, -1, axis=1)\n    F_right = np.roll(F, -1, axis=1)\n    return 0.5 * (F + F_right) - 0.5 * alpha * (U_right - U)\n\ndef simulate_linear_alfven(N, L=1.0, rho0=1.0, B0=1.0, A=1e-3, T=0.7, CFL=0.8):\n    \"\"\"\n    Simulate the linear Alfvén subsystem with Rusanov flux on N cells and measure amplitude ratio and phase error.\n    Returns: (R, dphi) where R = A_num/A and dphi is the wrapped phase error in radians.\n    \"\"\"\n    # Constants and grid\n    vA = B0 / np.sqrt(rho0)\n    alpha = vA\n    dx = L / N\n    k = 2.0 * np.pi / L\n\n    # Cell centers\n    i = np.arange(N)\n    x = (i + 0.5) * dx\n\n    # Initial condition: right-going eigenmode (By = -sqrt(rho0) * vy)\n    vy0 = A * np.sin(k * x)\n    By0 = -np.sqrt(rho0) * vy0\n\n    # State vector U = [vy, By]\n    U = np.vstack([vy0, By0])\n\n    # Time step control\n    dt_full = CFL * dx / alpha\n    t = 0.0\n\n    # Advance in time\n    while t + dt_full  T - 1e-15:\n        # Physical flux F(U) = [-(B0/rho0) * By, -B0 * vy]\n        F = np.vstack([-(B0 / rho0) * U[1], -B0 * U[0]])\n        # Numerical flux at interfaces\n        F_half = rusanov_flux(U, F, alpha)\n        # Update U\n        U = U - (dt_full / dx) * (F_half - np.roll(F_half, 1, axis=1))\n        t += dt_full\n\n    # Final partial step to hit exactly T\n    dt_last = T - t\n    if dt_last  1e-15:\n        F = np.vstack([-(B0 / rho0) * U[1], -B0 * U[0]])\n        F_half = rusanov_flux(U, F, alpha)\n        U = U - (dt_last / dx) * (F_half - np.roll(F_half, 1, axis=1))\n        t += dt_last\n\n    # Sanity: ensure we reached T\n    # Measure amplitude and phase using projection onto sin(kx), cos(kx)\n    vy = U[0]\n    s = np.sin(k * x)\n    c = np.cos(k * x)\n    s_norm = np.dot(s, s)\n    c_norm = np.dot(c, c)\n\n    # Avoid division by zero (should not happen for N = 2)\n    a_s = float(np.dot(vy, s) / s_norm) if s_norm  0 else 0.0\n    a_c = float(np.dot(vy, c) / c_norm) if c_norm  0 else 0.0\n\n    A_num = np.hypot(a_s, a_c)\n    phi_num = np.arctan2(a_c, a_s)\n\n    # Exact phase at time T\n    phi_exact = -k * vA * T\n\n    # Wrap phase error into (-pi, pi]\n    dphi = phi_num - phi_exact\n    dphi = (dphi + np.pi) % (2.0 * np.pi) - np.pi\n\n    R = A_num / A\n    return R, dphi\n\ndef solve():\n    # Define the test cases: resolutions N\n    test_cases = [32, 64, 128, 256]\n\n    results = []\n    for N in test_cases:\n        R, dphi = simulate_linear_alfven(N=N, L=1.0, rho0=1.0, B0=1.0, A=1e-3, T=0.7, CFL=0.8)\n        results.append((R, dphi))\n\n    # Format output: list of [R, dphi] with no spaces\n    def fmt_float(x):\n        # 12 significant digits is a reasonable compromise\n        return f\"{x:.12g}\"\n\n    inner = \",\".join(f\"[{fmt_float(r)},{fmt_float(p)}]\" for r, p in results)\n    print(f\"[{inner}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "answer": "[[0.749033320295,-0.0435860551065],[0.865942475095,-0.0107297920195],[0.930960570188,-0.00266938927953],[0.964923838276,-0.000666635203024]]", "id": "3527099"}]}