{"hands_on_practices": [{"introduction": "我们从一项基本技能开始：执行 LU 分解。这项练习将通过 Doolittle 方法，展示如何将一个矩阵 $A$ 系统地分解为下三角矩阵 ($L$) 和上三角矩阵 ($U$) [@problem_id:3507926]。掌握这个过程是理解和实现计算天体物理学中线性系统直接解法的第一步。", "problem": "在为分层天体物理盘的自引力平衡建模时，需要求解引力势的泊松方程 $\\nabla^{2} \\Phi = 4 \\pi G \\rho$，其中 $G$ 是引力常数，$\\rho$ 是质量密度。在局部均匀网格上进行标准的有限差分法离散化，会得到一个关于势的修正系数 $\\mathbf{x}$ 的稀疏线性系统 $A \\mathbf{x} = \\mathbf{b}$。在使用带有局域块更新的牛顿法进行非线性求解时，考虑一个从雅可比矩阵中提取的三点子问题，它产生如下的 $3 \\times 3$ 系数矩阵\n$$\nA = \\begin{pmatrix}\n2  & 1  & 1 \\\\\n4  & -6  & 0 \\\\\n-2  & 7  & 2\n\\end{pmatrix}.\n$$\n在这样的小块上采用直接法来提供稳健的局域更新和预条件子。从高斯消元法的原理出发，对 $A$ 进行 LU 分解（下三角-上三角分解），使用 Doolittle 约定（下三角因子对角线元素为1）且不进行主元选择，以获得矩阵 $L$ 和 $U$，使得 $A = L U$。利用你的分解推导出该块可逆性的一个标量诊断量：$A$ 的行列式。将行列式作为你的最终答案。如果你选择近似计算，请将最终数值四舍五入到四位有效数字。否则，请提供精确值。行列式不需要物理单位。", "solution": "该问题被评估为有效。它在计算天体物理学和数值线性代数的背景下具有科学依据，是适定的，提供了充分且一致的信息，并以客观、正式的语言表述。我们可以开始解题。\n\n任务是对给定的 $3 \\times 3$ 矩阵 $A$ 进行 LU 分解，然后利用这个分解计算其行列式。指定的分解是 Doolittle 形式，即 $A = L U$，其中 $L$ 是一个对角线元素为1的下三角矩阵，$U$ 是一个上三角矩阵。\n\n给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n2  & 1  & 1 \\\\\n4  & -6  & 0 \\\\\n-2  & 7  & 2\n\\end{pmatrix}\n$$\n\n我们寻求形式如下的矩阵 $L$ 和 $U$：\n$$\nL = \\begin{pmatrix}\n1  & 0  & 0 \\\\\nl_{21}  & 1  & 0 \\\\\nl_{31}  & l_{32}  & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\nu_{11}  & u_{12}  & u_{13} \\\\\n0  & u_{22}  & u_{23} \\\\\n0  & 0  & u_{33}\n\\end{pmatrix}\n$$\n\n分解 $A=LU$ 可以写为：\n$$\n\\begin{pmatrix}\n2  & 1  & 1 \\\\\n4  & -6  & 0 \\\\\n-2  & 7  & 2\n\\end{pmatrix} = \\begin{pmatrix}\n1  & 0  & 0 \\\\\nl_{21}  & 1  & 0 \\\\\nl_{31}  & l_{32}  & 1\n\\end{pmatrix} \\begin{pmatrix}\nu_{11}  & u_{12}  & u_{13} \\\\\n0  & u_{22}  & u_{23} \\\\\n0  & 0  & u_{33}\n\\end{pmatrix}\n$$\n\n展开右侧的矩阵乘积得到：\n$$\nLU = \\begin{pmatrix}\nu_{11}  & u_{12}  & u_{13} \\\\\nl_{21}u_{11}  & l_{21}u_{12} + u_{22}  & l_{21}u_{13} + u_{23} \\\\\nl_{31}u_{11}  & l_{31}u_{12} + l_{32}u_{22}  & l_{31}u_{13} + l_{32}u_{23} + u_{33}\n\\end{pmatrix}\n$$\n\n我们可以通过将此乘积的元素与矩阵 $A$ 的相应元素相等来确定 $L$ 和 $U$ 的未知元素。这个过程等同于对 $A$ 执行高斯消元以得到 $U$。\n\n1.  从 $A=LU$ 的第一行：\n    $u_{11} = a_{11} = 2$\n    $u_{12} = a_{12} = 1$\n    $u_{13} = a_{13} = 1$\n\n2.  从 $A=LU$ 的第一列：\n    $l_{21}u_{11} = a_{21} \\implies l_{21}(2) = 4 \\implies l_{21} = 2$\n    $l_{31}u_{11} = a_{31} \\implies l_{31}(2) = -2 \\implies l_{31} = -1$\n\n3.  从 $A=LU$ 的第二行：\n    $l_{21}u_{12} + u_{22} = a_{22} \\implies (2)(1) + u_{22} = -6 \\implies u_{22} = -6 - 2 = -8$\n    $l_{21}u_{13} + u_{23} = a_{23} \\implies (2)(1) + u_{23} = 0 \\implies u_{23} = -2$\n\n4.  从 $A=LU$ 的第二列：\n    $l_{31}u_{12} + l_{32}u_{22} = a_{32} \\implies (-1)(1) + l_{32}(-8) = 7 \\implies -1 - 8l_{32} = 7 \\implies -8l_{32} = 8 \\implies l_{32} = -1$\n\n5.  从 $A=LU$ 的第三行：\n    $l_{31}u_{13} + l_{32}u_{23} + u_{33} = a_{33} \\implies (-1)(1) + (-1)(-2) + u_{33} = 2 \\implies -1 + 2 + u_{33} = 2 \\implies 1 + u_{33} = 2 \\implies u_{33} = 1$\n\n找到了所有未知元素后，我们可以构造矩阵 $L$ 和 $U$：\n$$\nL = \\begin{pmatrix}\n1  & 0  & 0 \\\\\n2  & 1  & 0 \\\\\n-1  & -1  & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2  & 1  & 1 \\\\\n0  & -8  & -2 \\\\\n0  & 0  & 1\n\\end{pmatrix}\n$$\n问题要求使用此分解来求 $A$ 的行列式。行列式的一个基本性质是，对于任意两个相同大小的方阵 $B$ 和 $C$，有 $\\det(BC) = \\det(B)\\det(C)$。将此性质应用于我们的分解 $A=LU$：\n$$\n\\det(A) = \\det(L U) = \\det(L) \\det(U)\n$$\n三角矩阵的行列式是其对角线元素的乘积。\n对于矩阵 $L$：\n$$\n\\det(L) = l_{11} \\cdot l_{22} \\cdot l_{33} = 1 \\cdot 1 \\cdot 1 = 1\n$$\n这是 Doolittle 分解的一个普遍性质，即 $\\det(L)$ 总是为 $1$。\n对于矩阵 $U$：\n$$\n\\det(U) = u_{11} \\cdot u_{22} \\cdot u_{33} = (2)(-8)(1) = -16\n$$\n因此，$A$ 的行列式为：\n$$\n\\det(A) = \\det(L) \\det(U) = 1 \\cdot (-16) = -16\n$$\n行列式是一个非零标量，$\\det(A) = -16 \\neq 0$，这证实了矩阵 $A$ 是可逆的。这与不进行主元选择的 LU 分解能够成功执行的事实是一致的，该过程要求 $A$ 的所有顺序主子式都非零。\n顺序主子式为：\n$M_1 = 2$\n$M_2 = \\det \\begin{pmatrix} 2  & 1 \\\\ 4  & -6 \\end{pmatrix} = (2)(-6) - (1)(4) = -12 - 4 = -16$\n$M_3 = \\det(A) = -16$\n所有主子式都非零，从而验证了该过程的有效性。所要求的标量诊断量就是行列式。", "answer": "$$\n\\boxed{-16}\n$$", "id": "3507926"}, {"introduction": "虽然直接分解功能强大，但对于一些看似简单的矩阵也可能失败。本练习探讨了一个对角线上出现零（即零主元）导致标准 LU 算法中断的情况，从而展示了行置换的必要性 [@problem_id:3507917]。你将学习如何应用置换矩阵 $P$ 来稳定分解过程，得到更稳健且普遍适用的 $PA=LU$ 分解形式。", "problem": "在计算天体物理学的自引力流体模型中，引力势 $\\Phi$ 遵循泊松方程 $\\nabla^{2}\\Phi = 4 \\pi G \\rho$，其中 $G$ 是引力常数，$\\rho$ 是质量密度。在具有混合边界条件的一维网格上进行标准的二阶有限差分格式离散化，会产生一个稀疏线性系统 $A \\boldsymbol{\\Phi} = \\boldsymbol{b}$，其中 $A$ 编码了相邻网格点之间 $\\Phi$ 的局部耦合关系。在实践中，这个离散系统通常通过直接分解法求解，使用LU分解（下三角-上三角分解），即 $A = L U$，其中 $L$ 是单位对角线的下三角矩阵，$U$ 是上三角矩阵。\n\n考虑从这种离散化中，经过一种将边界条件对应的行放在首位的特定变量排序后，提取出的一个局部 $3 \\times 3$ 块。得到的具体系数矩阵为\n$$\nA = \\begin{pmatrix}\n0  & -1  & 2 \\\\\n1  & 3  & -1 \\\\\n2  & -1  & 3\n\\end{pmatrix}.\n$$\n该矩阵是非奇异的，但在主元位置 $(1,1)$ 处有一个零，因此在不进行主元选择的情况下，直接计算 $A = L U$ 的尝试会因主元为零而立即失败。然而，通过特定的置换来重排方程可以得到一个有效的分解。\n\n任务：\n- 从LU分解的定义和高斯消元法的结构出发，精确解释为什么对于给定的矩阵 $A$，在不进行任何行置换的情况下尝试进行 $A=LU$ 分解会失败。\n- 构造交换第一行和第二行的置换矩阵 $P$，并明确写出 $PA$。然后对 $PA$ 进行高斯消元，以得到满足 $PA = L U$ 的单位对角线下三角矩阵 $L$ 和上三角矩阵 $U$。\n- 仅使用分解过程中确立的三角矩阵的性质，计算 $U$ 的对角线元素的乘积。\n\n将 $U$ 的对角线元素的乘积作为一个实数作为你的最终答案。无需四舍五入。", "solution": "这个问题是适定的，并且在数值线性代数领域，特别是在求解线性系统的直接法方面，具有坚实的科学基础。所提供的矩阵是说明LU分解中主元选择必要性的一个典范例子。我们将按顺序完成每个任务来给出解答。\n\n第一个任务是解释为什么在没有行置换的情况下，对给定矩阵 $A$ 进行LU分解会失败。LU分解旨在找到一个单位对角线的下三角矩阵 $L$ 和一个上三角矩阵 $U$，使得 $A = LU$。\n设给定矩阵为\n$$\nA = \\begin{pmatrix}\n0  & -1  & 2 \\\\\n1  & 3  & -1 \\\\\n2  & -1  & 3\n\\end{pmatrix}\n$$\n设一个 $3 \\times 3$ 系统的 $L$ 和 $U$ 的一般形式为\n$$\nL = \\begin{pmatrix}\n1  & 0  & 0 \\\\\nl_{21}  & 1  & 0 \\\\\nl_{31}  & l_{32}  & 1\n\\end{pmatrix}, \\quad U = \\begin{pmatrix}\nu_{11}  & u_{12}  & u_{13} \\\\\n0  & u_{22}  & u_{23} \\\\\n0  & 0  & u_{33}\n\\end{pmatrix}\n$$\n乘积 $LU$ 为\n$$\nLU = \\begin{pmatrix}\nu_{11}  & u_{12}  & u_{13} \\\\\nl_{21}u_{11}  & l_{21}u_{12} + u_{22}  & l_{21}u_{13} + u_{23} \\\\\nl_{31}u_{11}  & l_{31}u_{12} + l_{32}u_{22}  & l_{31}u_{13} + l_{32}u_{23} + u_{33}\n\\end{pmatrix}\n$$\n通过逐行或逐列地令 $A$ 和 $LU$ 的元素相等，我们可以求解 $L$ 和 $U$ 中的未知元素。从 $A=LU$ 的第一列可得：\n$a_{11} = u_{11}$\n$a_{21} = l_{21}u_{11}$\n$a_{31} = l_{31}u_{11}$\n\n对于给定的矩阵 $A$，我们有 $a_{11} = 0$, $a_{21} = 1$ 和 $a_{31} = 2$。\n将 $a_{11} = 0$ 代入第一个方程得到 $u_{11} = 0$。\n将此结果代入第二个方程得到 $a_{21} = 1 = l_{21} \\cdot 0$。这意味着 $1=0$，这是一个矛盾。\n在高斯消元的背景下，第一个主元是 $a_{11} = 0$。为了在主元下方的第一列中制造零，需要计算乘子 $m_{21} = \\frac{a_{21}}{a_{11}}$ 和 $m_{31} = \\frac{a_{31}}{a_{11}}$。对于给定的矩阵，这将需要计算 $m_{21} = \\frac{1}{0}$，这是一个未定义的除零操作。因此，该过程失败。\n\n第二个任务是应用行置换以使分解能够进行。我们构造交换第一行和第二行的置换矩阵 $P$。该矩阵通过交换 $3 \\times 3$ 单位矩阵的第一行和第二行得到：\n$$\nP = \\begin{pmatrix}\n0  & 1  & 0 \\\\\n1  & 0  & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix}\n$$\n接下来，我们计算乘积 $PA$：\n$$\nPA = \\begin{pmatrix}\n0  & 1  & 0 \\\\\n1  & 0  & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0  & -1  & 2 \\\\\n1  & 3  & -1 \\\\\n2  & -1  & 3\n\\end{pmatrix} = \\begin{pmatrix}\n1  & 3  & -1 \\\\\n0  & -1  & 2 \\\\\n2  & -1  & 3\n\\endpmatrix}\n$$\n现在我们对 $A' = PA$ 进行高斯消元，以找到满足 $PA=LU$ 的 $L$ 和 $U$。\n初始矩阵为 $A^{(0)} = PA = \\begin{pmatrix}\n1  & 3  & -1 \\\\\n0  & -1  & 2 \\\\\n2  & -1  & 3\n\\end{pmatrix}$。\n第一个主元是 $a'_{11} = 1$。\n元素 $a'_{21}$ 已经是 $0$，所以乘子 $l_{21} = \\frac{a'_{21}}{a'_{11}} = \\frac{0}{1} = 0$。第2行保持不变。\n为了消去 $a'_{31} = 2$，我们计算乘子 $l_{31} = \\frac{a'_{31}}{a'_{11}} = \\frac{2}{1} = 2$。我们执行行操作 $R_3 \\leftarrow R_3 - 2R_1$：\n$$\n(2, -1, 3) - 2 \\cdot (1, 3, -1) = (2-2, -1-6, 3-(-2)) = (0, -7, 5)\n$$\n第一步消元后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n1  & 3  & -1 \\\\\n0  & -1  & 2 \\\\\n0  & -7  & 5\n\\end{pmatrix}\n$$\n第二个主元是 $a^{(1)}_{22} = -1$。\n为了消去主元下方的元素 $a^{(1)}_{32} = -7$，我们计算乘子 $l_{32} = \\frac{a^{(1)}_{32}}{a^{(1)}_{22}} = \\frac{-7}{-1} = 7$。我们执行行操作 $R_3 \\leftarrow R_3 - 7R_2$：\n$$\n(0, -7, 5) - 7 \\cdot (0, -1, 2) = (0, -7-(-7), 5-14) = (0, 0, -9)\n$$\n消元过程现已完成。得到的上三角矩阵是 $U$：\n$$\nU = \\begin{pmatrix}\n1  & 3  & -1 \\\\\n0  & -1  & 2 \\\\\n0  & 0  & -9\n\\end{pmatrix}\n$$\n单位对角线的下三角矩阵 $L$ 是用我们计算出的乘子构造的：\n$$\nL = \\begin{pmatrix}\n1  & 0  & 0 \\\\\nl_{21}  & 1  & 0 \\\\\nl_{31}  & l_{32}  & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1  & 0  & 0 \\\\\n0  & 1  & 0 \\\\\n2  & 7  & 1\n\\end{pmatrix}\n$$\n第三个任务是计算 $U$ 的对角线元素的乘积。$U$ 的对角线元素是 $u_{11} = 1$，$u_{22} = -1$ 和 $u_{33} = -9$。其乘积是：\n$$\n\\text{Product} = u_{11} \\cdot u_{22} \\cdot u_{33} = (1) \\cdot (-1) \\cdot (-9) = 9\n$$\n这个乘积也等于 $U$ 的行列式 $\\det(U)$。从关系式 $PA=LU$ 可得 $\\det(P)\\det(A)=\\det(L)\\det(U)$。由于 $\\det(P)=-1$（对于单次行交换）且 $\\det(L)=1$（对于单位三角矩阵），我们有 $-\\det(A) = \\det(U)$。原始矩阵 $A$ 的行列式是 $0 - (-1)(3 - (-2)) + 2(-1-6) = 5 - 14 = -9$。因此，$\\det(U) = -(-9) = 9$，这验证了我们的结果。", "answer": "$$\n\\boxed{9}\n$$", "id": "3507917"}, {"introduction": "既然能够将矩阵分解为 $L$ 和 $U$，最后一步就是利用这些因子求解线性系统。本练习的核心是高效的两步求解过程：首先通过前向替换解出 $Ly=b$，然后通过后向替换解出 $Ux=y$ [@problem_id:3507995]。这充分体现了 LU 分解的计算优势，因为求解两个三角系统远比直接对原始矩阵 $A$ 求逆要快得多。", "problem": "考虑一个牛顿极限下的平面平行自引力板，其引力势 $\\Phi$ 满足泊松方程 $ \\nabla^{2} \\Phi = 4 \\pi G \\rho $。在具有狄利克雷边界条件的一维均匀间隔网格上，对拉普拉斯算子进行二阶中心有限差分格式离散化，得到一个关于无量纲化势 $x$ 的内部节点值的线性系统 $A x = b$。其中，势 $x$ 已通过特征尺度进行了无量纲化，使其成为一个无量纲量。直接解法通过计算矩阵 $A$ 的 LU 分解（下三角-上三角分解）$A = L U$，然后进行三角求解。\n\n已知该离散算子的分解和相应的源向量如下：\n$$\nL = \\begin{pmatrix}\n1  & 0  & 0 \\\\\n2  & 1  & 0 \\\\\n-1  & 3  & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n4  & 2  & 0 \\\\\n0  & -3  & 1 \\\\\n0  & 0  & 5\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n3 \\\\\n0 \\\\\n7\n\\end{pmatrix}.\n$$\n使用前向代入法求解 $L y = b$，并使用回代法求解 $U x = y$，以确定对应于三个内部节点离散势的向量 $x$。请用精确的分数形式表示 $x$；无需四舍五入。由于所选的无量纲化方法，$x$ 的分量是无量纲的。", "solution": "该问题是适定的，并具有科学依据。它提出了一个由物理学中的基本方程——泊松方程的有限差分离散化产生的标准数值线性代数问题。已知条件包括系统矩阵 $ A $ 的 LU（下三角-上三角）分解和源向量 $ b $。任务是求解线性系统 $ A x = b $，以得到未知向量 $ x $。\n\n求解策略包括两个步骤，利用已知的 $ L U $ 分解。原始系统 $ A x = b $ 被重写为 $ L U x = b $。我们引入一个中间向量 $ y $，定义为 $ y = U x $。这将问题解耦为两个涉及三角矩阵的更简单的系统：\n1. 一个下三角系统 $ L y = b $，使用前向代入法求解 $ y $。\n2. 一个上三角系统 $ U x = y $，使用回代法求解 $ x $。\n\n向量 $x$、$y$ 和 $b$ 的分量用下标表示，例如 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。\n\n**步骤 1：使用前向代入法求解 $ L y = b $**\n\n第一个系统为：\n$$\n\\begin{pmatrix}\n1  & 0  & 0 \\\\\n2  & 1  & 0 \\\\\n-1  & 3  & 1\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\\ny_2 \\\\\ny_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3 \\\\\n0 \\\\\n7\n\\end{pmatrix}\n$$\n\n该矩阵方程对应于以下线性方程组：\n$1) \\quad 1 \\cdot y_1 = 3$\n$2) \\quad 2 \\cdot y_1 + 1 \\cdot y_2 = 0$\n$3) \\quad -1 \\cdot y_1 + 3 \\cdot y_2 + 1 \\cdot y_3 = 7$\n\n我们从 $y_1$ 到 $y_3$ 依次求解 $y$ 的各个分量。\n\n根据方程（$1$）：\n$$\ny_1 = 3\n$$\n\n将 $y_1$ 的值代入方程（$2$）：\n$$\n2(3) + y_2 = 0 \\implies 6 + y_2 = 0 \\implies y_2 = -6\n$$\n\n将 $y_1$ 和 $y_2$ 的值代入方程（$3$）：\n$$\n-1(3) + 3(-6) + y_3 = 7 \\implies -3 - 18 + y_3 = 7 \\implies -21 + y_3 = 7 \\implies y_3 = 28\n$$\n\n因此，中间向量为 $ y = \\begin{pmatrix} 3 \\\\ -6 \\\\ 28 \\end{pmatrix} $。\n\n**步骤 2：使用回代法求解 $ U x = y $**\n\n第二个系统为：\n$$\n\\begin{pmatrix}\n4  & 2  & 0 \\\\\n0  & -3  & 1 \\\\\n0  & 0  & 5\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3 \\\\\n-6 \\\\\n28\n\\end{pmatrix}\n$$\n\n该矩阵方程对应于以下线性方程组：\n$1) \\quad 4 \\cdot x_1 + 2 \\cdot x_2 = 3$\n$2) \\quad -3 \\cdot x_2 + 1 \\cdot x_3 = -6$\n$3) \\quad 5 \\cdot x_3 = 28$\n\n我们以相反的顺序，从 $x_3$ 到 $x_1$ 依次求解 $x$ 的各个分量。\n\n根据方程（$3$）：\n$$\n5 x_3 = 28 \\implies x_3 = \\frac{28}{5}\n$$\n\n将 $x_3$ 的值代入方程（$2$）：\n$$\n-3 x_2 + \\frac{28}{5} = -6\n$$\n$$\n-3 x_2 = -6 - \\frac{28}{5} = -\\frac{30}{5} - \\frac{28}{5} = -\\frac{58}{5}\n$$\n$$\nx_2 = \\frac{-58}{5} \\cdot \\left(-\\frac{1}{3}\\right) = \\frac{58}{15}\n$$\n\n将 $x_2$ 的值代入方程（$1$）：\n$$\n4 x_1 + 2 \\left(\\frac{58}{15}\\right) = 3\n$$\n$$\n4 x_1 + \\frac{116}{15} = 3\n$$\n$$\n4 x_1 = 3 - \\frac{116}{15} = \\frac{45}{15} - \\frac{116}{15} = -\\frac{71}{15}\n$$\n$$\nx_1 = -\\frac{71}{15} \\cdot \\frac{1}{4} = -\\frac{71}{60}\n$$\n\n因此，代表内部节点处离散势的解向量为：\n$$\nx = \\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{71}{60} \\\\\n\\frac{58}{15} \\\\\n\\frac{28}{5}\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{71}{60} \\\\ \\frac{58}{15} \\\\ \\frac{28}{5} \\end{pmatrix}}\n$$", "id": "3507995"}]}