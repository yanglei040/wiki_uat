{"hands_on_practices": [{"introduction": "掌握 Barnes-Hut 算法的第一步是理解其核心数据结构——八叉树的构建过程。本练习通过一个具体的例子，引导您手动模拟粒子逐个插入时空间如何进行层次化分割。通过这种方式，您可以深入理解树的动态生长、节点细分以及粒子分配的规则，为后续学习力计算和误差分析打下坚实的基础。", "problem": "考虑在三维空间中为 Barnes–Hut (BH) 算法构建一个八叉树。该八叉树构建于一个固定的根域上，即轴对齐立方体 $[0,8)\\times[0,8)\\times[0,8)$。每个节点存储一个轴对齐包围盒 (AABB)，细分总是将节点的盒体沿每个笛卡尔轴在其中心点处对半分割。每个节点最多可包含 $n_{\\max}=1$ 个粒子；当向一个叶节点插入第二个粒子时，该节点将被细分为其 $8$ 个子节点，并且先前存储的粒子会被重新插入到相应的子节点中。子节点的分配使用半开区间规则：对于一个边界为 $[x_{0},x_{1})\\times[y_{0},y_{1})\\times[z_{0},z_{1})$、中点为 $m_{x}=(x_{0}+x_{1})/2$, $m_{y}=(y_{0}+y_{1})/2$, $m_{z}=(z_{0}+z_{1})/2$ 的节点，一个坐标为 $(x,y,z)$ 的粒子，若其某轴向坐标小于中点 $m$，则沿该轴被分到“低”侧；若大于等于 $m$，则被分到“高”侧。\n\n现给定五个粒子，按顺序 $\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3},\\mathbf{x}_{4},\\mathbf{x}_{5}$ 插入，其坐标分别为\n$\\mathbf{x}_{1}=(1,1,1)$, $\\mathbf{x}_{2}=(2,2,2)$, $\\mathbf{x}_{3}=(6,3,1)$, $\\mathbf{x}_{4}=(7,3,1)$, $\\mathbf{x}_{5}=(6,6,6)$。\n\n任务：\n- 仅使用上述定义和空间划分概念，概述插入的序列以及发生的相应细分。对于在此过程中创建的每个内部节点（即每个进行细分的节点），确定其轴对齐包围盒。\n- 令 $\\mathcal{I}$ 表示插入序列结束时创建的所有内部节点的集合。对于每个 $u\\in\\mathcal{I}$，令 $V_{u}$ 为其包围盒的体积，令 $V_{\\mathrm{root}}$ 为根域的体积。计算无量纲和\n$$\nS \\;=\\; \\sum_{u\\in\\mathcal{I}} \\frac{V_{u}}{V_{\\mathrm{root}}}.\n$$\n\n将 $S$ 以一个精确数的形式报告。最终的数值答案中不要包含任何单位。", "solution": "本题要求我们针对一个包含 $5$ 个粒子的特定序列，根据 Barnes-Hut 算法模拟八叉树的构建过程，然后根据得到的内部节点的体积计算一个总和。该过程是确定性的，由所提供的细分和粒子分配规则决定。\n\n八叉树的根域是由轴对齐包围盒 (AABB) $[0,8)\\times[0,8)\\times[0,8)$ 定义的立方体。此根域的体积为 $V_{\\mathrm{root}} = (8-0)^3 = 8^3 = 512$。每个叶节点的最大容量为 $n_{\\max}=1$ 个粒子。\n\n我们将按指定顺序追踪每个粒子的插入过程。每当一个包含粒子的叶节点为容纳第二个粒子而必须被细分时，就会创建一个内部节点。集合 $\\mathcal{I}$ 将是整个插入过程中所有变为内部节点的节点的集合。\n\n**初始状态：**\n八叉树由一个单一的根节点组成，我们称之为 $u_0$。它是一个叶节点，是空的，其 AABB 为 $\\mathrm{Box}(u_0) = [0,8)\\times[0,8)\\times[0,8)$。\n\n**1. 插入 $\\mathbf{x}_{1}=(1,1,1)$**\n根节点 $u_0$ 是空的。粒子 $\\mathbf{x}_{1}$ 被存储在 $u_0$ 中。此时树由一个包含一个粒子的单一叶节点组成。没有发生细分。\n\n**2. 插入 $\\mathbf{x}_{2}=(2,2,2)$**\n粒子 $\\mathbf{x}_{2}$ 将被插入根节点 $u_0$。然而，$u_0$ 已包含 $\\mathbf{x}_{1}$，因此其 $n_{\\max}=1$ 的容量被超出。\n- 节点 $u_0$ 被细分为 $8$ 个子节点，并成为一个 **内部节点**。因此，$u_0 \\in \\mathcal{I}$。其 AABB 为 $\\mathrm{Box}(u_0) = [0,8)\\times[0,8)\\times[0,8)$。用于细分的中点是 $(m_x, m_y, m_z) = (4,4,4)$。\n- 先前存储的粒子 $\\mathbf{x}_{1}=(1,1,1)$ 必须被重新插入到 $u_0$ 的相应子节点中。由于其坐标满足 $1  4$、$1  4$ 和 $1  4$，它被放入 AABB 为 $[0,4)\\times[0,4)\\times[0,4)$ 的子节点。我们称这个节点为 $u_1$。\n- 现在，新粒子 $\\mathbf{x}_{2}=(2,2,2)$ 从根节点 $u_0$ 开始插入。由于其坐标同样满足 $2  4$、$2  4$ 和 $2  4$，它被导向到同一个子节点 $u_1$。\n- 节点 $u_1$ 当前包含 $\\mathbf{x}_{1}$。尝试插入 $\\mathbf{x}_{2}$ 的操作超出了其容量。\n- 节点 $u_1$ 被细分并成为一个 **内部节点**。因此，$u_1 \\in \\mathcal{I}$。其 AABB 为 $\\mathrm{Box}(u_1) = [0,4)\\times[0,4)\\times[0,4)$。用于细分的中点是 $(m_x, m_y, m_z) = (2,2,2)$。\n- 旧粒子 $\\mathbf{x}_{1}=(1,1,1)$ 被重新插入到 $u_1$ 的一个子节点中。由于 $1  2$、$1  2$ 和 $1  2$，它被放入 AABB 为 $[0,2)\\times[0,2)\\times[0,2)$ 的叶节点中。\n- 新粒子 $\\mathbf{x}_{2}=(2,2,2)$ 从 $u_1$ 开始插入。对于坐标 $c$ 和中点 $m$ 的分配规则是：对于“低”侧是 $c  m$，对于“高”侧是 $c \\ge m$。这里，$2 \\ge 2$、$2 \\ge 2$ 和 $2 \\ge 2$。因此，$\\mathbf{x}_{2}$ 被放入 AABB 为 $[2,4)\\times[2,4)\\times[2,4)$ 的叶节点中。\n\n**3. 插入 $\\mathbf{x}_{3}=(6,3,1)$**\n- 插入从根节点 $u_0$（一个中点为 $(4,4,4)$ 的内部节点）开始。对于 $\\mathbf{x}_{3}=(6,3,1)$，我们有 $6 \\ge 4$、$3  4$ 和 $1  4$。这将粒子导向 AABB 为 $[4,8)\\times[0,4)\\times[0,4)$ 的子节点。我们称这个节点为 $u_2$。\n- 节点 $u_2$ 是在 $u_0$ 细分时作为空叶节点创建的。它是空的，所以 $\\mathbf{x}_{3}$ 被存储在 $u_2$ 中。没有新的细分发生。\n\n**4. 插入 $\\mathbf{x}_{4}=(7,3,1)$**\n- 插入从根节点 $u_0$ 开始。对于 $\\mathbf{x}_{4}=(7,3,1)$，我们有 $7 \\ge 4$、$3  4$ 和 $1  4$。这再次将粒子导向节点 $u_2$，其 AABB 为 $[4,8)\\times[0,4)\\times[0,4)$。\n- 节点 $u_2$ 已包含 $\\mathbf{x}_{3}$，因此其容量被超出。\n- 节点 $u_2$ 被细分并成为一个 **内部节点**。因此，$u_2 \\in \\mathcal{I}$。其 AABB 为 $\\mathrm{Box}(u_2) = [4,8)\\times[0,4)\\times[0,4)$。中点是 $(m_x, m_y, m_z) = (6,2,2)$。\n- 旧粒子 $\\mathbf{x}_{3}=(6,3,1)$ 被重新插入到 $u_2$ 的一个子节点中。由于 $6 \\ge 6$、$3 \\ge 2$ 和 $1  2$，它被放入 AABB 为 $[6,8)\\times[2,4)\\times[0,2)$ 的子节点中。我们称这个节点为 $u_3$。\n- 新粒子 $\\mathbf{x}_{4}=(7,3,1)$ 从 $u_2$ 开始插入。由于 $7 \\ge 6$、$3 \\ge 2$ 和 $1  2$，它被导向同一个子节点 $u_3$。\n- 节点 $u_3$ 现在包含 $\\mathbf{x}_{3}$。尝试插入 $\\mathbf{x}_{4}$ 的操作超出了其容量。\n- 节点 $u_3$ 被细分并成为一个 **内部节点**。因此，$u_3 \\in \\mathcal{I}$。其 AABB 为 $\\mathrm{Box}(u_3) = [6,8)\\times[2,4)\\times[0,2)$。中点是 $(m_x, m_y, m_z) = (7,3,1)$。\n- 旧粒子 $\\mathbf{x}_{3}=(6,3,1)$ 被重新插入到 $u_3$ 的一个子节点中。由于 $6  7$、$3 \\ge 3$ 和 $1 \\ge 1$，它被放入 AABB 为 $[6,7)\\times[3,4)\\times[1,2)$ 的叶节点中。\n- 新粒子 $\\mathbf{x}_{4}=(7,3,1)$ 从 $u_3$ 开始插入。由于 $7 \\ge 7$、$3 \\ge 3$ 和 $1 \\ge 1$，它被放入 AABB 为 $[7,8)\\times[3,4)\\times[1,2)$ 的叶节点中。\n\n**5. 插入 $\\mathbf{x}_{5}=(6,6,6)$**\n- 插入从根节点 $u_0$（中点为 $(4,4,4)$）开始。对于 $\\mathbf{x}_{5}=(6,6,6)$，我们有 $6 \\ge 4$、$6 \\ge 4$ 和 $6 \\ge 4$。这将粒子导向 AABB 为 $[4,8)\\times[4,8)\\times[4,8)$ 的子节点。\n- 这个节点是一个空的叶节点。粒子 $\\mathbf{x}_{5}$ 被存储在此处。没有新的细分发生。\n\n**计算总和 $S$**\n到插入序列结束时，所有创建的内部节点的集合为 $\\mathcal{I} = \\{u_0, u_1, u_2, u_3\\}$。我们现在计算每个节点 $u \\in \\mathcal{I}$ 的体积 $V_u$。\n1.  节点 $u_0$：根节点，其 $\\mathrm{Box}(u_0) = [0,8)\\times[0,8)\\times[0,8)$。其边长为 $8$。\n    $V_{u_0} = 8^3 = 512$。\n2.  节点 $u_1$：$u_0$ 的一个子节点，其 $\\mathrm{Box}(u_1) = [0,4)\\times[0,4)\\times[0,4)$。其边长为 $4$。\n    $V_{u_1} = 4^3 = 64$。\n3.  节点 $u_2$：$u_0$ 的一个子节点，其 $\\mathrm{Box}(u_2) = [4,8)\\times[0,4)\\times[0,4)$。其边长为 $4$。\n    $V_{u_2} = 4^3 = 64$。\n4.  节点 $u_3$：$u_2$ 的一个子节点，其 $\\mathrm{Box}(u_3) = [6,8)\\times[2,4)\\times[0,2)$。其边长为 $2$。\n    $V_{u_3} = 2^3 = 8$。\n\n根域的体积为 $V_{\\mathrm{root}} = V_{u_0} = 512$。\n\n我们计算无量纲和 $S$：\n$$\nS \\;=\\; \\sum_{u\\in\\mathcal{I}} \\frac{V_{u}}{V_{\\mathrm{root}}} \\;=\\; \\frac{V_{u_0}}{V_{\\mathrm{root}}} + \\frac{V_{u_1}}{V_{\\mathrm{root}}} + \\frac{V_{u_2}}{V_{\\mathrm{root}}} + \\frac{V_{u_3}}{V_{\\mathrm{root}}}\n$$\n代入体积值：\n$$\nS \\;=\\; \\frac{512}{512} + \\frac{64}{512} + \\frac{64}{512} + \\frac{8}{512}\n$$\n化简分数：\n$$\nS \\;=\\; 1 + \\frac{1}{8} + \\frac{1}{8} + \\frac{1}{64}\n$$\n$$\nS \\;=\\; 1 + \\frac{2}{8} + \\frac{1}{64} \\;=\\; 1 + \\frac{1}{4} + \\frac{1}{64}\n$$\n为了对分数求和，我们找到公分母 $64$：\n$$\nS \\;=\\; \\frac{64}{64} + \\frac{16}{64} + \\frac{1}{64} \\;=\\; \\frac{64+16+1}{64} \\;=\\; \\frac{81}{64}\n$$\n总和 $S$ 是精确数 $\\frac{81}{64}$。", "answer": "$$\\boxed{\\frac{81}{64}}$$", "id": "3514300"}, {"introduction": "Barnes-Hut 算法的主要优势在于其卓越的计算效率，其时间复杂度可扩展至 $O(N \\ln N)$。本练习旨在连接抽象的复杂度理论与实际的性能表现，要求您从基本操作出发，构建一个实用的运行时模型。通过将该模型与给定的计时数据进行拟合，您将学会如何量化和验证算法在真实世界中的性能特征。", "problem": "在一个使用 Barnes–Hut (BH) 算法的三维自引力 $N$ 体模拟中，通过遍历一个八叉树来计算每个粒子上的引力加速度，并应用多极近似，其中一个张角判据决定是接受一个单元的多极矩还是深入到其子节点。考虑一个单位立方体内的均匀粒子分布，总粒子数为 $N$，张角参数为 $\\theta$（以弧度为单位），叶节点容量为 $n_{\\ell}$ 个粒子。每个粒子的计算成本可以由两个部分建模：对内部节点的访问（单元多极矩相互作用）和近场叶节点或粒子相互作用。假设有以下基本事实和定义：\n- 每个粒子的树遍历从根节点开始，在每一层，对于固定的 $\\theta$ 和均匀分布，接受的单元数量近似有界且与 $N$ 无关。树的层数以 $\\ln N$ 的速度增长，因为八叉树会不断细分，直到叶节点的粒子数达到由 $n_{\\ell}$ 设定的 $O(1)$。\n- 因此，每个粒子接受的内部节点平均数量按 $c_{1} \\ln N + c_{2}$ 的规律变化，其中 $c_{1}$ 和 $c_{2}$ 是依赖于几何形状和 $\\theta$ 但不依赖于 $N$ 的常数。\n- 在均匀分布下，对于固定的 $\\theta$ 和 $n_{\\ell}$，每个粒子的近场粒子级相互作用的平均数量近似为常数 $c_{3}$，因为只有 $O(1)$ 个相邻的叶节点贡献直接相互作用。\n\n假设对代码的详细操作审计在一个固定的单线程平台上给出了以下单位事件成本的测量值：\n- 一次接受的内部节点“访问”（包括张角测试、多极矩评估和累加）的实测壁钟时间为每次访问 $t_{v}$ 秒。\n- 一次直接的近场粒子-粒子相互作用的实测壁钟时间为每次相互作用 $t_{p}$ 秒。\n\n推导一个形式为 $T(N) = a N \\ln N + b N$ 的实用运行时间模型，其中 $a$ 和 $b$ 用 $t_{v}$、$t_{p}$、$c_{1}$、$c_{2}$ 和 $c_{3}$ 表示。你可以假定对数为自然对数。然后，使用在相同平台和代码配置下获得的两个样本计时测量值，\n- $T(10^{5}) = 0.04154$ 秒，\n- $T(10^{6}) = 0.4845$ 秒，\n仅根据这些数据拟合 $T(N) = a N \\ln N + b N$ 中的系数 $a$ 和 $b$。报告 $a$ 和 $b$ 的值，单位为秒，并四舍五入到四位有效数字。使用科学记数法 $a \\times 10^{b}$ 表示 $a$ 和 $b$ 的最终数值。", "solution": "问题要求完成两个任务：首先，根据给定的标度关系和单位事件成本，为 Barnes-Hut 算法推导一个理论运行时间模型；其次，使用两个实验计时测量值来拟合该模型的系数。\n\n第一部分：运行时间模型的推导\n\n$N$ 体模拟的总运行时间 $T(N)$ 是粒子总数 $N$ 乘以每个粒子的平均计算成本。每个粒子的成本由两部分组成：与内部节点（单元多极矩）相互作用的成本，以及直接的近场粒子-粒子相互作用的成本。\n\n让我们定义每个粒子的平均成本为 $T_{\\text{particle}}(N)$。\n问题陈述，每个粒子接受的内部节点“访问”的平均数量按 $c_{1} \\ln N + c_{2}$ 的规律变化。每次此类访问的实测壁钟时间为 $t_{v}$。因此，每个粒子在内部节点相互作用上花费的时间是：\n$$ T_{\\text{visits/particle}}(N) = (c_{1} \\ln N + c_{2}) t_{v} $$\n\n问题还陈述，每个粒子的近场粒子-粒子相互作用的平均数量是一个常数 $c_{3}$。每次直接相互作用的实测壁钟时间为 $t_{p}$。因此，每个粒子在近场相互作用上花费的时间是：\n$$ T_{\\text{particles/particle}} = c_{3} t_{p} $$\n\n每个粒子的总平均时间成本是这两个部分之和：\n$$ T_{\\text{particle}}(N) = T_{\\text{visits/particle}}(N) + T_{\\text{particles/particle}} = (c_{1} \\ln N + c_{2}) t_{v} + c_{3} t_{p} $$\n\n所有 $N$ 个粒子的总运行时间 $T(N)$ 是 $N$ 乘以每个粒子的平均成本：\n$$ T(N) = N \\cdot T_{\\text{particle}}(N) = N \\left[ (c_{1} \\ln N + c_{2}) t_{v} + c_{3} t_{p} \\right] $$\n\n为了匹配指定的形式 $T(N) = a N \\ln N + b N$，我们展开各项：\n$$ T(N) = N (c_{1} t_{v} \\ln N + c_{2} t_{v} + c_{3} t_{p}) $$\n$$ T(N) = (c_{1} t_{v}) N \\ln N + (c_{2} t_{v} + c_{3} t_{p}) N $$\n\n通过将此表达式与模型 $T(N) = a N \\ln N + b N$ 进行比较，我们可以用给定的参数来确定系数 $a$ 和 $b$：\n$$ a = c_{1} t_{v} $$\n$$ b = c_{2} t_{v} + c_{3} t_{p} $$\n这就完成了模型系数的推导。\n\n第二部分：从数据拟合系数\n\n我们已知模型 $T(N) = a N \\ln N + b N$ 和两个数据点：\n1. $N_{1} = 10^{5}$，$T(N_{1}) = 0.04154$ 秒。\n2. $N_{2} = 10^{6}$，$T(N_{2}) = 0.4845$ 秒。\n\n为了求出系数 $a$ 和 $b$，我们可以建立一个二元一次方程组。首先将模型方程两边同时除以 $N$ 会很方便：\n$$ \\frac{T(N)}{N} = a \\ln N + b $$\n\n将两个数据点代入此形式可得：\n对于 $(N_{1}, T(N_{1}))$:\n$$ \\frac{0.04154}{10^{5}} = a \\ln(10^{5}) + b $$\n$$ 4.154 \\times 10^{-7} = a (5 \\ln 10) + b \\quad (1) $$\n\n对于 $(N_{2}, T(N_{2}))$:\n$$ \\frac{0.4845}{10^{6}} = a \\ln(10^{6}) + b $$\n$$ 4.845 \\times 10^{-7} = a (6 \\ln 10) + b \\quad (2) $$\n\n现在我们求解这个关于 $a$ 和 $b$ 的二元一次方程组。用方程(2)减去方程(1)可以消去 $b$：\n$$ (4.845 \\times 10^{-7}) - (4.154 \\times 10^{-7}) = (a (6 \\ln 10) + b) - (a (5 \\ln 10) + b) $$\n$$ 0.691 \\times 10^{-7} = a (6 \\ln 10 - 5 \\ln 10) $$\n$$ 0.691 \\times 10^{-7} = a \\ln 10 $$\n\n解出 $a$：\n$$ a = \\frac{0.691 \\times 10^{-7}}{\\ln 10} = \\frac{6.91 \\times 10^{-8}}{\\ln 10} $$\n\n现在，我们将 $a$ 的这个表达式代回方程(1)来求解 $b$：\n$$ b = 4.154 \\times 10^{-7} - a (5 \\ln 10) $$\n$$ b = 4.154 \\times 10^{-7} - \\left(\\frac{6.91 \\times 10^{-8}}{\\ln 10}\\right) (5 \\ln 10) $$\n$$ b = 4.154 \\times 10^{-7} - 5 \\times (6.91 \\times 10^{-8}) $$\n$$ b = 4.154 \\times 10^{-7} - 3.455 \\times 10^{-7} $$\n$$ b = (4.154 - 3.455) \\times 10^{-7} = 0.699 \\times 10^{-7} = 6.99 \\times 10^{-8} $$\n\n问题要求 $a$ 和 $b$ 的最终数值，四舍五入到四位有效数字并用科学记数法表示。我们使用 $\\ln 10 \\approx 2.30258509$。\n\n对于 $a$：\n$$ a = \\frac{6.91 \\times 10^{-8}}{2.30258509} \\approx 2.9990306 \\times 10^{-8} $$\n四舍五入到四位有效数字，我们得到：\n$$ a \\approx 2.999 \\times 10^{-8} $$\n\n对于 $b$：\n$$ b = 6.99 \\times 10^{-8} $$\n为了用四位有效数字表示这个值，我们补一个零：\n$$ b = 6.990 \\times 10^{-8} $$\n\n$a$ 和 $b$ 的单位是秒，因为它们是从时间测量中得出的。\n拟合后的模型是 $T(N) \\approx (2.999 \\times 10^{-8}) N \\ln N + (6.990 \\times 10^{-8}) N$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 2.999 \\times 10^{-8}  6.990 \\times 10^{-8} \\end{pmatrix} } $$", "id": "3514370"}, {"introduction": "Barnes-Hut 算法的效率是通过近似计算实现的，因此误差分析是理解和应用该算法的关键。本练习将带您深入探讨这种近似的核心，要求您从第一性原理出发，为特定几何形状的节点严格推导其引力计算的相对误差。这个过程不仅能揭示误差如何依赖于节点的几何形状和距离，还能让您深刻体会到算法中速度与精度之间的权衡。", "problem": "考虑牛顿引力，其引力势 $\\Phi(\\mathbf{r})$ 由质量密度 $\\rho(\\mathbf{r}')$ 通过以下公式产生：\n$$\n\\Phi(\\mathbf{r}) \\;=\\; -\\,G \\int \\frac{\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^3\\mathbf{r}'\\,,\n$$\n引力为 $\\mathbf{F}(\\mathbf{r}) \\;=\\; -\\,\\nabla \\Phi(\\mathbf{r})$。在 Barnes–Hut 算法中，远处的一组源可以通过围绕其质心的截断多极展开来近似。设单个树节点为一个密度均匀的立方体，边长为 $s$，总质量为 $M$，以原点为中心且与坐标轴对齐。将一个测试粒子放置在 z 轴正半轴上的 $\\mathbf{r}=(0,0,d)$ 处，其中 $d \\gg s$。\n\n定义截断的相对力误差为\n$$\n\\varepsilon \\;\\equiv\\; \\frac{\\left\\|\\mathbf{F}_{\\text{exact}}-\\mathbf{F}_{\\text{approx}}\\right\\|}{\\left\\|\\mathbf{F}_{\\text{exact}}\\right\\|}\\,.\n$$\n仅从上述势积分和在 $|\\mathbf{r}'| \\ll |\\mathbf{r}|$ 时有效的 $|\\mathbf{r}-\\mathbf{r}'|^{-1}$ 的标准远场展开出发，执行以下操作：\n\n1) 使用单极近似（仅保留质心处的总质量），推导当 $s/d \\to 0$ 时，此均匀立方体的相对力误差 $\\varepsilon_{\\text{mono}}$ 的领头阶渐近形式，并确定\n$$\n\\varepsilon_{\\text{mono}} \\;=\\; C_{\\text{mono}}\\left(\\frac{s}{d}\\right)^{p} \\;+\\; \\mathcal{O}\\!\\left(\\left(\\frac{s}{d}\\right)^{p+2}\\right),\n$$\n中的精确常数 $C_{\\text{mono}}$，包括指数 $p$ 和常数 $C_{\\text{mono}}$。\n\n2) 使用四极截断（保留围绕质心的单极矩和四极矩），重复此推导，以获得领头阶渐近形式 $\\varepsilon_{\\text{quad}}$ 和\n$\n\\varepsilon_{\\text{quad}} \\;=\\; C_{\\text{quad}}\\left(\\frac{s}{d}\\right)^{q} \\;+\\; \\mathcal{O}\\!\\left(\\left(\\frac{s}{d}\\right)^{q+2}\\right),\n$\n中的精确常数 $C_{\\text{quad}}$，包括指数 $q$ 和常数 $C_{\\text{quad}}$。\n\n计算时请明确使用密度均匀的立方体 $\\rho = M/s^3$ 以及指定的面法线轴上的观测点。将你的最终答案表示为一个包含两个精确常数 $C_{\\text{mono}}$ 和 $C_{\\text{quad}}$ 的单行矩阵。无需四舍五入。最终答案是无量纲的。请勿包含单位。", "solution": "该问题要求计算一个均匀立方体引力场的单极和四极近似的领头阶相对力误差。测试粒子位于一根穿过立方体中心且垂直于其一个面的轴上。\n\n首先，我们验证问题陈述的有效性。\n该问题在牛顿引力的框架下设定，并使用多极展开的标准数学技巧。对象是一个具有均匀密度的、明确定义的几何形状。任务是执行一个特定的、形式化的推导。所有组成部分都有科学依据、是适定且客观的。没有矛盾、缺失信息或伪科学论断。该问题是有效的。\n\n我们首先计算位于 $\\mathbf{r}=(0,0,d)$ 的测试粒子所受到的引力势 $\\Phi(\\mathbf{r})$，该引力势由一个以原点为中心、质量为 $M$、边长为 $s$ 的均匀立方体产生。对于 $\\mathbf{r}'=(x',y',z') \\in [-s/2, s/2]^3$，其密度为 $\\rho = M/s^3$。\n引力势由以下积分给出：\n$$\n\\Phi(\\mathbf{r}) = -G \\int_{V'} \\frac{\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}'\n$$\n对于 $\\mathbf{r}=(0,0,d)$ 和一个源点 $\\mathbf{r}'=(x',y',z')$，距离为 $|\\mathbf{r}-\\mathbf{r}'| = \\sqrt{(x')^2 + (y')^2 + (d-z')^2}$。\n对于一个远处的粒子（$d \\gg s \\ge |\\mathbf{r}'|$），我们使用关于勒让德多项式 $P_l(u)$ 的多极展开来展开 $|\\mathbf{r}-\\mathbf{r}'|^{-1}$ 项：\n$$\n\\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} = \\frac{1}{|\\mathbf{r}|} \\sum_{l=0}^{\\infty} \\left(\\frac{|\\mathbf{r}'|}{|\\mathbf{r}|}\\right)^l P_l(\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}')\n$$\n此处， $|\\mathbf{r}| = d$，$\\hat{\\mathbf{r}} = \\hat{\\mathbf{z}}$，所以 $\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}' = z'/|\\mathbf{r}'|$。引力势变为：\n$$\n\\Phi(d) = -G \\sum_{l=0}^{\\infty} \\frac{1}{d^{l+1}} \\int_{V'} \\rho(\\mathbf{r}') |\\mathbf{r}'|^l P_l(z'/|\\mathbf{r}'|) d^3\\mathbf{r}'\n$$\n我们计算这个级数的前几项，它们分别对应于单极矩（$l=0$）、偶极矩（$l=1$）、四极矩（$l=2$）、八极矩（$l=3$）和十六极矩（$l=4$）。\n\n质量分布关于平面 $x'=0$，$y'=0$ 和 $z'=0$ 的反射是对称的。这意味着，任何在 $x'$, $y'$ 或 $z'$ 上为奇函数的函数在立方体体积上的积分都将为零。\n\n$l=0$：单极项。$P_0(u)=1$。\n$$\n\\Phi_0 = -\\frac{G}{d} \\int_{V'} \\rho(\\mathbf{r}') d^3\\mathbf{r}' = -\\frac{GM}{d}\n$$\n\n$l=1$：偶极项。$P_1(u)=u$。\n$$\n\\Phi_1 = -\\frac{G}{d^2} \\int_{V'} \\rho(\\mathbf{r}') |\\mathbf{r}'| \\left(\\frac{z'}{|\\mathbf{r}'|}\\right) d^3\\mathbf{r}' = -\\frac{G}{d^2} \\int_{V'} \\rho(\\mathbf{r}') z' d^3\\mathbf{r}' = 0\n$$\n由于被积函数是关于 $z'$ 的奇函数，该积分为零。这是预料之中的，因为质心在原点。\n\n$l=2$：四极项。$P_2(u) = \\frac{1}{2}(3u^2-1)$。\n$$\n\\Phi_2 = -\\frac{G}{d^3} \\int_{V'} \\rho |\\mathbf{r}'|^2 \\frac{1}{2}\\left(3\\frac{(z')^2}{|\\mathbf{r}'|^2}-1\\right) d^3\\mathbf{r}' = -\\frac{G}{2d^3} \\int_{V'} \\rho (3(z')^2 - |\\mathbf{r}'|^2) d^3\\mathbf{r}'\n$$\n积分为 $\\int \\rho (3(z')^2 - ((x')^2+(y')^2+(z')^2)) d^3\\mathbf{r}' = \\int \\rho (2(z')^2 - (x')^2 - (y')^2) d^3\\mathbf{r}'$。\n由于质量分布的立方对称性，有 $\\int \\rho (x')^2 dV = \\int \\rho (y')^2 dV = \\int \\rho (z')^2 dV$。因此积分为零。$\\Phi_2=0$。\n\n$l=3$：八极项。$P_3(u) = \\frac{1}{2}(5u^3-3u)$。\n$$\n\\Phi_3 = -\\frac{G}{2d^4} \\int_{V'} \\rho (5(z')^3 - 3z'|\\mathbf{r}'|^2) d^3\\mathbf{r}'\n$$\n被积函数是关于 $z'$ 的奇函数项之和，因此积分因对称性而为零。$\\Phi_3=0$。\n\n$l=4$：十六极项。$P_4(u) = \\frac{1}{8}(35u^4 - 30u^2 + 3)$。这是单极项之后的第一个非零项。\n$$\n\\Phi_4 = -\\frac{G}{8d^5} \\int_{V'} \\rho (35(z')^4 - 30(z')^2|\\mathbf{r}'|^2 + 3|\\mathbf{r}'|^4) d^3\\mathbf{r}'\n$$\n让我们来计算所需的矩积分。设 $\\rho = M/s^3$。\n$$\n\\int_{V'} (z')^4 \\rho dV = \\frac{M}{s^3} \\int_{-s/2}^{s/2} s^2 (z')^4 dz' = \\frac{M}{s} \\left[\\frac{(z')^5}{5}\\right]_{-s/2}^{s/2} = \\frac{M}{s} \\frac{2(s/2)^5}{5} = \\frac{Ms^4}{80}\n$$\n根据对称性，$\\int \\rho (x')^4 dV = \\int \\rho (y')^4 dV = \\int \\rho (z')^4 dV = \\frac{Ms^4}{80}$。\n$$\n\\int_{V'} (z')^2(x')^2 \\rho dV = \\frac{M}{s^3} \\left(\\int_{-s/2}^{s/2} (x')^2 dx'\\right) \\left(\\int_{-s/2}^{s/2} dy' \\right) \\left(\\int_{-s/2}^{s/2} (z')^2 dz'\\right) = \\frac{M}{s^3} \\left(\\frac{s^3}{12}\\right) \\left(s\\right) \\left(\\frac{s^3}{12}\\right) = \\frac{Ms^4}{144}\n$$\n设 $I_{klm} = \\int \\rho (x')^k (y')^l (z')^m dV$。根据对称性， $I_{400}=I_{040}=I_{004}=\\frac{Ms^4}{80}$ 且 $I_{220}=I_{202}=I_{022}=\\frac{Ms^4}{144}$。\n$\\Phi_4$ 的积分，我们称之为 $I_4$，是：\n$I_4 = \\int \\rho [35(z')^4 - 30(z')^2((x')^2+(y')^2+(z')^2) + 3((x')^2+(y')^2+(z')^2)^2] dV$\n$I_4 = 35 I_{004} - 30(I_{202}+I_{022}+I_{004}) + 3(I_{400}+I_{040}+I_{004} + 2(I_{220}+I_{022}+I_{202}))$\n代入数值并利用对称性：\n$I_4 = (35-30+3)I_{004} + (-30-30+6)I_{202} + 3(I_{400}+I_{040}) + 6I_{220}$\n$I_4 = 14 I_{004} - 42 I_{202} = 14 \\frac{Ms^4}{80} - 42 \\frac{Ms^4}{144} = \\frac{7}{40}Ms^4 - \\frac{7}{24}Ms^4 = Ms^4 \\left(\\frac{21-35}{120}\\right) = -\\frac{14Ms^4}{120} = -\\frac{7Ms^4}{60}$。\n将此结果代回 $\\Phi_4$ 的表达式中：\n$$\n\\Phi_4 = -\\frac{G}{8d^5}\\left(-\\frac{7Ms^4}{60}\\right) = \\frac{7GMs^4}{480d^5}\n$$\n总势为 $\\Phi_{\\text{exact}}(d) = -\\frac{GM}{d} + \\frac{7GMs^4}{480d^5} + \\mathcal{O}(d^{-7})$。\n由于对称性，引力纯粹在 z 方向上：$\\mathbf{F} = F_z \\hat{\\mathbf{z}}$，其中 $F_z = -\\frac{\\partial\\Phi}{\\partial d}$。\n$$\nF_{z, \\text{exact}} = -\\frac{\\partial}{\\partial d} \\left(-\\frac{GM}{d} + \\frac{7GMs^4}{480d^5} + \\dots\\right) = -\\frac{GM}{d^2} - \\frac{7GMs^4}{480}(-5d^{-6}) + \\dots\n$$\n$$\nF_{z, \\text{exact}} = -\\frac{GM}{d^2} + \\frac{35GMs^4}{480d^6} + \\mathcal{O}(d^{-8}) = -\\frac{GM}{d^2} + \\frac{7GMs^4}{96d^6} + \\mathcal{O}(d^{-8})\n$$\n力矢量为 $\\mathbf{F}_{\\text{exact}} = \\left(-\\frac{GM}{d^2} + \\frac{7GMs^4}{96d^6} + \\dots\\right)\\hat{\\mathbf{z}}$。\n\n1) 单极近似\n单极近似只保留 $l=0$ 项。\n$\\Phi_{\\text{mono}}(d) = -\\frac{GM}{d}$。\n$F_{z, \\text{mono}} = -\\frac{\\partial \\Phi_{\\text{mono}}}{\\partial d} = -\\frac{GM}{d^2}$。\n$\\mathbf{F}_{\\text{mono}} = -\\frac{GM}{d^2}\\hat{\\mathbf{z}}$。\n力误差为：\n$$\n\\mathbf{F}_{\\text{exact}} - \\mathbf{F}_{\\text{mono}} = \\left(\\frac{7GMs^4}{96d^6} + \\mathcal{O}(d^{-8})\\right)\\hat{\\mathbf{z}}\n$$\n相对误差 $\\varepsilon_{\\text{mono}}$ 为：\n$$\n\\varepsilon_{\\text{mono}} = \\frac{\\|\\mathbf{F}_{\\text{exact}} - \\mathbf{F}_{\\text{mono}}\\|}{\\|\\mathbf{F}_{\\text{exact}}\\|} = \\frac{\\left|\\frac{7GMs^4}{96d^6} + \\mathcal{O}(d^{-8})\\right|}{\\left|-\\frac{GM}{d^2} + \\frac{7GMs^4}{96d^6} + \\mathcal{O}(d^{-8})\\right|}\n$$\n对于小的 $s/d$，取领头项：\n$$\n\\varepsilon_{\\text{mono}} = \\frac{\\frac{7GMs^4}{96d^6}}{\\frac{GM}{d^2}} \\left(1 + \\mathcal{O}\\left(\\frac{s^2}{d^2}\\right)\\right) = \\frac{7s^4}{96d^4} + \\mathcal{O}\\left(\\frac{s^6}{d^6}\\right)\n$$\n其形式为 $C_{\\text{mono}}(s/d)^p + \\mathcal{O}((s/d)^{p+2})$，其中 $p=4$。常数为 $C_{\\text{mono}} = \\frac{7}{96}$。\n\n2) 四极近似\n四极截断包括到 $l=2$ 为止的矩。\n$\\Phi_{\\text{quad}}(d) = \\Phi_0 + \\Phi_1 + \\Phi_2$。\n正如我们已经证明的，对于这个特定的几何形状，$\\Phi_1 = 0$ 且 $\\Phi_2 = 0$。\n因此，$\\Phi_{\\text{quad}}(d) = \\Phi_0 = -\\frac{GM}{d}$。\n这意味着势的四极近似与单极近似相同。\n因此，近似力也相同：\n$\\mathbf{F}_{\\text{quad}} = -\\nabla \\Phi_{\\text{quad}} = -\\nabla \\Phi_{\\text{mono}} = \\mathbf{F}_{\\text{mono}}$。\n因此，四极近似的误差与单极近似的误差相同：\n$$\n\\mathbf{F}_{\\text{exact}} - \\mathbf{F}_{\\text{quad}} = \\mathbf{F}_{\\text{exact}} - \\mathbf{F}_{\\text{mono}}\n$$\n因此，相对误差 $\\varepsilon_{\\text{quad}}$ 为：\n$$\n\\varepsilon_{\\text{quad}} = \\frac{\\|\\mathbf{F}_{\\text{exact}} - \\mathbf{F}_{\\text{quad}}\\|}{\\|\\mathbf{F}_{\\text{exact}}\\|} = \\varepsilon_{\\text{mono}} = \\frac{7}{96}\\left(\\frac{s}{d}\\right)^4 + \\mathcal{O}\\left(\\left(\\frac{s}{d}\\right)^6\\right)\n$$\n其形式为 $C_{\\text{quad}}(s/d)^q + \\mathcal{O}((s/d)^{q+2})$，其中 $q=4$。常数为 $C_{\\text{quad}} = \\frac{7}{96}$。\n\n该问题突显了多极展开的一个关键特征：源分布中的对称性可能导致几个低阶多极矩为零，从而使得近似误差比同样大小的一般分布更小。对于沿对称轴观察均匀立方体的特定情况，偶极、四极和八极对轴上势的贡献均为零。对单极项的第一个修正来自十六极矩（$l=4$）。结果，单极近似和四极近似都得到相同的近似力，并且它们的误差由相同的领头阶项主导。\n\n这两个常数是 $C_{\\text{mono}} = \\frac{7}{96}$ 和 $C_{\\text{quad}} = \\frac{7}{96}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{7}{96}  \\frac{7}{96}\n\\end{pmatrix}\n}\n$$", "id": "3514331"}]}