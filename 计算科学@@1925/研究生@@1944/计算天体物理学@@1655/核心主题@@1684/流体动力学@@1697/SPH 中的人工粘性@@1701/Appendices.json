{"hands_on_practices": [{"introduction": "标准的SPH人工粘性公式包含一个线性项（与$\\alpha$成正比）和一个二次项（与$\\beta$成正比）。这并非一个随意的数学构造，而是植根于激波的物理本质。本练习将引导你从物理第一性原理出发，通过分析激波前后的动量通量平衡，来论证为何在处理高马赫数激波时，一个与速度二次方成正比的耗散项是不可或缺的。通过这个练习，你将深入理解人工粘性公式背后的物理动机。[@problem_id:3465341]", "problem": "在用光滑粒子流体动力学 (SPH) 模拟的气体动力学中进行宇宙学激波捕捉时，可压缩欧拉方程\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0, \\qquad\n\\frac{\\partial (\\rho \\mathbf{v})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}\\mathbf{v} + P \\mathbf{I}) = 0,\n$$\n缺乏物理粘性，因此不能耗散激波处的动能通量。为了稳定激波并防止粒子相互穿透，引入了一种人工粘性，用于阻尼相互靠近的运动。考虑一对等质量的SPH粒子，其分离矢量为 $\\mathbf{r}_{ij}$，径向接近速度为 $v_{r} \\equiv -\\mathbf{v}_{ij} \\cdot \\hat{\\mathbf{r}}_{ij}  0$（其中 $\\hat{\\mathbf{r}}_{ij} \\equiv \\mathbf{r}_{ij}/r_{ij}$）。该人工粘性由一个无量纲的接近量度\n$$\n\\mu_{ij} \\equiv \\frac{h v_{r}}{r_{ij}},\n$$\n构建而成，其中 $h$ 是局部光滑长度。它还包含两个贡献项，通常称为带有系数 $\\alpha$ 和 $\\beta$ 的线性项和二次项。设特征声速为 $c_{s}$，马赫数为 $\\mathcal{M} \\equiv v_{r}/c_{s}$。\n\n以可压缩欧拉方程为基本依据，从跨越激波的动量通量平衡出发，论证为何在高马赫数下需要一个速度的二次方耗散项来防止粒子相互穿透，并推导马赫数阈值 $\\mathcal{M}_{\\star}$。当马赫数高于此阈值时，二次项贡献（与 $\\beta \\mu_{ij}^{2}$ 成正比）将超过线性项贡献（与 $\\alpha c_{s} \\mu_{ij}$ 成正比）。假设 $v_{r}  0$ 且忽略任何小的正则化项，用 $\\alpha$、$\\beta$ 和 $h/r_{ij}$ 来表示 $\\mathcal{M}_{\\star}$。\n\n然后，对于典型的宇宙学SPH配置（其中相邻粒子的间距与光滑长度相当），取 $\\alpha = 1$，$\\beta = 2$ 和 $h/r_{ij} = 1$ 来估计 $\\mathcal{M}_{\\star}$ 的数值。将您的最终答案表示为一个纯数（无量纲），并将其估计值四舍五入到三位有效数字。", "solution": "该问题陈述具有科学依据，提法恰当，并包含了完整解答所需的所有信息。它准确地描述了光滑粒子流体动力学（SPH）中人工粘性的物理动机和数学表述，这是计算天体物理学中的一项标准技术。所提出的问题是精确的，并能导出一个唯一的、可推导的答案。\n\n该问题需要进行两部分分析：首先，为高马赫数激波中的二次粘性项提供物理上的论证；其次，推导该项开始占主导地位的马赫数阈值，然后进行数值估计。\n\n首先，我们来论证为何需要一个速度的二次方耗散项。可压缩欧拉方程描述了理想、无粘性流体的动力学。像欧拉方程这样的双曲守恒律的一个关键特征是，从初始光滑条件可以形成不连续面，即激波。在物理激波前沿，密度、压力和温度会急剧增加，同时速度会迅速下降。这个过程本质上是耗散的，将动能转化为内能（热能）。欧拉方程缺乏物理粘性项（如纳维-斯托克斯方程中存在的项），因此无法模拟这种耗散。在像SPH这样的将流体离散为粒子的数值格式中，这种耗散的缺失会导致激波处的非物理行为：粒子可能越过激波前沿并相互穿透，导致数值不稳定性和不正确的激波结构。\n\n标准的补救方法是引入人工粘性，它起到一个压力项的作用，并且仅在强压缩区域（如激波）才显著。这个人工压力，我们称之为 $P_{\\text{visc}}$，必须提供必要的动量耗散。为了理解 $P_{\\text{visc}}$ 所需的形式，我们考虑跨越激波的动量平衡，这由朗金-雨贡纽跳跃条件所描述。在一维激波的静止参考系中，动量通量守恒由下式给出：\n$$\n\\rho_{1} v_{1}^{2} + P_{1} = \\rho_{2} v_{2}^{2} + P_{2}\n$$\n其中下标1和2分别表示激波前和激波后的状态。对于强激波，来流是高超音速的，意味着马赫数 $\\mathcal{M}_{1} = v_{1}/c_{s,1} \\gg 1$。在此极限下，流的动能远大于其内能，因此冲压 $\\rho_{1} v_{1}^{2}$ 远大于热压 $P_{1}$。阻止流动所需的压力跃升 $\\Delta P = P_{2} - P_{1}$ 必须与来流冲压同量级：\n$$\n\\Delta P \\approx \\rho_{1} v_{1}^{2}\n$$\n一个有效的人工粘性必须能产生一个具有类似标度关系的压力 $P_{\\text{visc}}$。SPH人工粘性由两个分量构成：一个线性项和一个二次项。问题陈述了它们对无量纲接近量度 $\\mu_{ij} \\equiv \\frac{h v_{r}}{r_{ij}}$ 的依赖关系，其中 $v_{r}$ 是一对粒子的径向接近速度。\n\n粘性压力的线性贡献与 $\\alpha c_{s} \\mu_{ij}$ 成正比：\n$$\nP_{\\text{visc, lin}} \\propto \\alpha c_{s} \\left( \\frac{h v_{r}}{r_{ij}} \\right) \\propto v_{r}\n$$\n该项提供了一个与接近速度成线性关系的耗散压力。\n\n二次项贡献与 $\\beta \\mu_{ij}^{2}$ 成正比：\n$$\nP_{\\text{visc, quad}} \\propto \\beta \\left( \\frac{h v_{r}}{r_{ij}} \\right)^{2} \\propto v_{r}^{2}\n$$\n该项提供了一个与接近速度成二次关系的耗散压力。\n\n将这些标度关系与激波压力必须与冲压 ($P_{\\text{shock}} \\sim \\rho v_{r}^{2}$) 成比例的物理要求进行比较，可以清楚地看到，二次项 $P_{\\text{visc, quad}}$ 具有处理强激波所需的速度函数依赖关系。线性项仅与 $v_{r}$ 成比例，除非其系数 $\\alpha$ 大到不合物理，否则不足以在高马赫数下防止粒子相互穿透。因此，二次项对于提供必要的体粘性以正确捕捉强、高马赫数激波的物理过程至关重要。\n\n接下来，我们推导二次项贡献开始超过线性项贡献的马赫数阈值 $\\mathcal{M}_{\\star}$。这个阈值出现在两项的量值相等时。我们令线性项和二次项的表达式相等：\n$$\n\\beta \\mu_{ij}^{2} = \\alpha c_{s} \\mu_{ij}\n$$\n问题指明粒子正在相互靠近，所以 $v_{r}  0$，这意味着 $\\mu_{ij}  0$。因此，我们可以不失一般性地将两边同除以 $\\mu_{ij}$：\n$$\n\\beta \\mu_{ij} = \\alpha c_{s}\n$$\n现在，我们将 $\\mu_{ij} = \\frac{h v_{r}}{r_{ij}}$ 的定义代入方程：\n$$\n\\beta \\left( \\frac{h v_{r}}{r_{ij}} \\right) = \\alpha c_{s}\n$$\n马赫数的定义为 $\\mathcal{M} \\equiv v_{r}/c_{s}$。我们寻求在阈值处该比率的值，记为 $\\mathcal{M}_{\\star}$。我们重排方程以求解 $v_{r}/c_{s}$：\n$$\n\\frac{v_{r}}{c_{s}} = \\frac{\\alpha}{\\beta} \\frac{r_{ij}}{h}\n$$\n因此，阈值马赫数 $\\mathcal{M}_{\\star}$ 由下式给出：\n$$\n\\mathcal{M}_{\\star} = \\frac{\\alpha}{\\beta} \\left( \\frac{h}{r_{ij}} \\right)^{-1}\n$$\n该表达式按要求用参数 $\\alpha$、$\\beta$ 和比率 $h/r_{ij}$ 给出了阈值。对于马赫数 $\\mathcal{M}  \\mathcal{M}_{\\star}$，二次项将占主导地位。\n\n最后，我们使用所给出的典型宇宙学SPH值来估计 $\\mathcal{M}_{\\star}$ 的数值：$\\alpha = 1$，$\\beta = 2$ 和 $h/r_{ij} = 1$。将这些值代入我们推导的表达式：\n$$\n\\mathcal{M}_{\\star} = \\frac{1}{2} \\left( 1 \\right)^{-1} = \\frac{1}{2} = 0.5\n$$\n问题要求将此估计值四舍五入到三位有效数字。因此，数值为 $0.500$。", "answer": "$$\\boxed{0.500}$$", "id": "3465341"}, {"introduction": "虽然人工粘性是捕捉激波的利器，但它在纯剪切流或涡旋等非压缩区域会引入不必要的数值耗散，从而“污染”流场的物理演化。为了使人工粘性更加“智能”，研究者们引入了各种“开关”函数，使其仅在需要的地方起作用。本练习将挑战你基于流场的运动学不变量（如速度散度和旋度），从基本物理和量纲原则出发，构建一个有效的人工粘性开关，这在现代SPH代码中是一项标准技术。[@problem_id:3465306]", "problem": "在宇宙学平滑粒子流体动力学 (SPH) 中，引入人工粘性是为了捕捉激波，同时避免在涡旋或剪切主导的流场中产生虚假耗散。一种常见的策略是通过一个开关因子来调制人工粘性系数，该开关因子在涡度主导压缩的区域抑制粘性。考虑一个开关函数 $f$，它与基础人工粘性系数 $\\alpha$ 相乘，从而得到有效系数 $f \\alpha$。开关 $f$ 应满足以下从第一性原理和量纲分析中导出的原则：\n\n- 它仅依赖于能够区分压缩和旋转的运动学不变量，即散度大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n- 它是无量纲的，界于0和1之间，在固定的 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 单调增加，在固定的 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 单调减少。\n- 通过引入一个由局部信号速度 $c$ 和平滑长度 $h$ 构建，并与一个小的无量纲参数 $\\epsilon0$ 组合而成的正则化项，它在静止流场中保持良定义，该组合项的量纲与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 相同。\n\n(a) 使用这些要求，构建一个由可接受不变量的非负线性贡献组成，且满足所述单调性、有界性和量纲约束的 $f$ 的最简可接受形式。\n\n(b) 对于一个宇宙学SPH计算中的局部涡旋流，其中 $\\left|\\nabla \\cdot \\mathbf{v}\\right|=0.01$, $\\left|\\nabla \\times \\mathbf{v}\\right|=10$, $c=1$, $h=0.05$, $\\epsilon=0.1$，且基础系数 $\\alpha=1$，计算开关 $f$ 和有效人工粘性系数 $f\\alpha$。\n\n将 $f$ 和 $f\\alpha$ 的数值结果四舍五入到四位有效数字。将你的最终答案以 $\\left(f, f\\alpha\\right)$ 的顺序报告为两个不带单位的数字。", "solution": "用户提供了一个问题，要求基于一系列物理原则，在平滑粒子流体动力学（SPH）中推导一个用于人工粘性的开关函数，并进行数值计算。\n\n### 第1步：问题验证\n\n首先，我必须验证问题陈述。\n\n#### 1.1. 提取已知条件\n\n- **背景**：宇宙学SPH中的人工粘性。\n- **目标**：用开关函数 $f$ 调制基础人工粘性系数 $\\alpha$，得到有效系数 $f\\alpha$。\n- **构建 $f$ 的原则**：\n    1.  $f$ 仅依赖于散度大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n    2.  $f$ 是无量纲且有界的，使得 $0 \\le f \\le 1$。\n    3.  $f$ 表现出特定的单调性：在固定的 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 增加，在固定的 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 减少。\n    4.  $f$ 经过正则化，以在静止流场中保持良定义。正则化项由局部信号速度 $c$、平滑长度 $h$ 和一个小的无量纲参数 $\\epsilon  0$ 构建。该项必须具有与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 相同的量纲。\n    5. $f$ 的形式应是由可接受不变量的非负线性贡献构成的“最简可接受形式”。\n- **(a)部分任务**：构建 $f$ 的数学形式。\n- **(b)部分任务**：使用以下数值计算 $f$ 和 $f\\alpha$：\n    - $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n    - $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n    - $c = 1$\n    - $h = 0.05$\n    - $\\epsilon = 0.1$\n    - $\\alpha = 1$\n- **输出要求**：将数值结果四舍五入到四位有效数字，并以有序对 $(f, f\\alpha)$ 的形式报告。\n\n#### 1.2. 对照标准进行验证\n\n- **科学性**：该问题在计算流体动力学和天体物理学领域有充分的依据。人工粘性的使用，特别是基于散度与涡度之比来抑制剪切流中粘性的开关，是SPH中一种标准且有据可查的技术（例如，Balsara 开关）。所述原则在物理和数学上都是合理的。\n- **适定性**：该问题是适定的。(a)部分要求基于一组清晰的约束推导函数形式。“最简形式”是此类推导中的标准启发式方法，并导出一个特定的常用函数。(b)部分是使用推导出的公式进行的直接数值计算。存在唯一解。\n- **客观性**：该问题以精确、客观的语言陈述，没有模糊性或主观论断。\n- **缺陷检查**：该问题没有违反任何不合格的缺陷。它并非科学上不合理，是可形式化的，是完整的，提出了一个现实可行的任务，结构良好，并且不是琐碎或同义反复的。\n\n#### 1.3. 结论\n\n问题是有效的。我现在将着手解决。\n\n### 第2步：求解推导\n\n#### (a)部分：开关函数 $f$ 的构建\n\n令散度大小为 $D = \\left|\\nabla \\cdot \\mathbf{v}\\right|$，涡度大小为 $W = \\left|\\nabla \\times \\mathbf{v}\\right|$。在流体动力学中，$D$ 和 $W$ 的量纲都是时间倒数，即 $[T^{-1}]$。\n\n1.  **量纲性**：函数 $f$ 必须是无量纲的。这要求它是一个输入量无量纲组合的函数。从 $D$ 和 $W$ 构造无量纲量的最简单方法是取它们的比值，或者取具有相同量纲的表达式的比值。\n\n2.  **单调性**：函数 $f$ 必须随 $D$ 增加而增加，随 $W$ 增加而减少。这表明 $D$ 应在分子中，$W$ 应在分母中。让我们考虑一个通用形式 $f = g\\left(\\frac{D}{W}\\right)$，其中 $g$ 是某个函数。为了满足单调性，$g$ 必须是其自变量的增函数。\n\n3.  **简单性和有界性**：问题要求“由非负线性贡献构成的最简可接受形式”。这表明它是一个有理函数，其中分子和分母是可用项的线性和。我们提出以下形式：\n    $$f = \\frac{k_1 D}{k_2 D + k_3 W}$$\n    其中 $k_1, k_2, k_3$ 是正常数无量纲常数。此形式是无量纲的。\n    - 为了满足有界性条件 $f \\le 1$，我们需要 $k_1 D \\le k_2 D + k_3 W$。整理后得到 $(k_1 - k_2)D \\le k_3 W$。为了使此式对所有非负的 $D$ 和 $W$ 都成立，最简单的选择是令 $k_1 = k_2$。\n    - “最简”形式和“非负线性贡献”的要求意味着我们应该选择尽可能简单的常数，例如 $1$。令 $k_1 = k_2 = k_3 = 1$ 得到以下形式：\n    $$f = \\frac{D}{D+W} = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right|}$$\n    对于非负的 $D$ 和 $W$，此形式界于0和1之间，并满足单调性要求。\n\n4.  **正则化**：如果 $D$ 和 $W$ 均为零，则上述形式未定义。问题要求一个正则化项来防止这种情况。这个项，我们称之为 $R$，必须具有与 $D$ 和 $W$ 相同的量纲，即 $[T^{-1}]$。它由信号速度 $c$（量纲 $[L T^{-1}]$）、平滑长度 $h$（量纲 $[L]$）和无量纲参数 $\\epsilon  0$ 构建。唯一能产生 $[T^{-1}]$ 量纲的 $c$ 和 $h$ 的组合是 $c/h$。因此，正则化项与此成正比，例如 $R = \\epsilon \\frac{c}{h}$。\n    为了将此正则化项整合到我们的“最简线性贡献”形式中，我们将其添加到分母中以防止除以零。这保持了函数的结构及其无量纲性质。\n\n综合这些原则，开关函数 $f$ 的最简可接受形式为：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + \\epsilon \\frac{c}{h}}$$\n该形式满足所有陈述的条件：它依赖于正确的不变量，是无量纲的，界于0和1之间，具有正确的单调行为，并在静止流场中进行了正则化。\n\n#### (b)部分：数值计算\n\n给定以下数值：\n- $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n- $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n- $c = 1$\n- $h = 0.05$\n- $\\epsilon = 0.1$\n- $\\alpha = 1$\n\n首先，计算正则化项 $R = \\epsilon \\frac{c}{h}$：\n$$R = (0.1) \\frac{1}{0.05} = 0.1 \\times 20 = 2$$\n\n现在，将这些值代入推导出的开关函数 $f$ 的表达式中：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + R} = \\frac{0.01}{0.01 + 10 + 2} = \\frac{0.01}{12.01}$$\n$$f \\approx 0.000832639467...$$\n四舍五入到四位有效数字，我们得到：\n$$f \\approx 0.0008326$$\n\n接下来，我们计算有效人工粘性系数 $f\\alpha$。由于基础系数 $\\alpha = 1$，有效系数在数值上等于 $f$：\n$$f\\alpha = (0.0008326) \\times 1 = 0.0008326$$\n\n问题要求两个数 $(f, f\\alpha)$。这些值为 $(0.0008326, 0.0008326)$。开关函数的这个极低的值是预料之中的，因为与压缩（$\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$）相比，流场强烈地由涡度（$\\left|\\nabla \\times \\mathbf{v}\\right| = 10$）主导，而这正是应该抑制人工粘性的情况。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0008326  0.0008326 \\end{pmatrix} } $$", "id": "3465306"}, {"introduction": "在宇宙学模拟中，天体物理学家经常会遇到马赫数极高的极端激波。在这种情况下，标准的人工粘性参数可能不足以抑制数值不稳定性，特别是灾难性的粒子穿透现象。这项高级练习将让你扮演代码开发者的角色，推导一个用于防止粒子穿透的鲁棒稳定性判据，并据此计算所需的最小二次粘性系数$\\beta_{\\min}$。这个过程完美融合了物理洞察、数学推导和程序实现，是计算天体物理研究的核心实践。[@problem_id:3465348]", "problem": "您将编写一个程序，该程序针对数值宇宙学中的光滑粒子流体动力学（SPH）中的超强激波，计算在固定光滑长度下能防止粒子相互穿透的最小二次人工粘性系数。您的任务是，从第一性原理出发，推导二次项系数的稳定性判据，然后对一组给定的测试套件进行数值评估。最终的数值答案是无量纲的。\n\n请考虑以下经过充分检验的出发点和核心定义：\n- 在光滑粒子流体动力学（SPH）中，受人工粘性影响的粒子 $i$ 的动量方程为\n$$\n\\frac{d \\mathbf{v}_i}{d t} = - \\sum_j m_j \\left( \\frac{P_i}{\\rho_i^2} + \\frac{P_j}{\\rho_j^2} + \\Pi_{ij} \\right) \\nabla_i W_{ij},\n$$\n其中 $m_j$ 是邻近粒子 $j$ 的质量，$P$ 是热压强，$\\rho$ 是质量密度，$W_{ij}$ 是光滑核，$\\Pi_{ij}$ 是人工粘性。\n- 对于宇宙学 SPH 中使用的 Monaghan-Gingold 形式的人工粘性，具有相对速度 $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$ 和间距 $\\mathbf{r}_{ij}$ 的粒子 $i$ 和 $j$ 之间的粘性定义为\n$$\n\\Pi_{ij} = \n\\begin{cases}\n\\frac{- \\alpha \\bar{c}_{ij} \\mu_{ij} + \\beta \\mu_{ij}^2}{\\bar{\\rho}_{ij}},  \\text{if } \\mathbf{v}_{ij} \\cdot \\mathbf{r}_{ij}  0, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中 $\\bar{c}_{ij}$ 和 $\\bar{\\rho}_{ij}$ 是粒子对平均声速和密度，$\\alpha$ 和 $\\beta$ 是无量纲系数，并且\n$$\n\\mu_{ij} = \\frac{h \\, \\mathbf{v}_{ij} \\cdot \\mathbf{r}_{ij}}{|\\mathbf{r}_{ij}|^2 + \\eta^2 h^2}.\n$$\n此处，$h$ 是光滑长度，$\\eta$ 是一个小的无量纲正则化参数。\n- 使用三维三次样条（Monaghan-M4）核，其形式为\n$$\nW(r, h) = \\frac{\\sigma}{h^3} w(q), \\quad q = \\frac{r}{h}, \\quad \\sigma = \\frac{1}{\\pi},\n$$\n以及\n$$\nw(q) = \n\\begin{cases}\n1 - \\frac{3}{2} q^2 + \\frac{3}{4} q^3,  0 \\le q  1, \\\\\n\\frac{1}{4} (2 - q)^3,  1 \\le q  2, \\\\\n0,  q \\ge 2.\n\\end{cases}\n$$\n\n目标情景与稳定性概念：\n- 重点关注马赫数 $M \\gtrsim 100$ 的超强激波，因此二次粘性在激波捕获中占主导地位。在推导保守的最小二次系数时，您可以通过设置 $\\alpha = 0$ 来忽略线性项。\n- 可以通过确保在收缩流中，人工粘性正应力主导冲压，并且在与光滑长度相当的停止距离上所做的粘性功足以消除相对动能，来抑制粒子相互穿透。\n- 使用基于 SPH 动量方程、$\\Pi_{ij}$ 的定义以及核函数性质的纯数学推理；对于最坏情况，假设粒子沿其连线方向做正向相对运动。\n\n推导与定量实现要求：\n- 推导最小二次粘性系数 $\\beta_{\\min}$ 的一个下界，使其同时满足以下两个约束条件：\n  1. 一个应力主导条件，该条件将收缩流中的人工粘性正应力与冲压进行比较。\n  2. 一个能量耗散条件，该条件要求在距离 $\\chi h$（对于某个无量纲 $\\chi  0$）上积分的粘性功至少等于初始的单位质量相对动能。\n- 在您的推导中，通过无量纲因子\n$$\n\\tilde{\\kappa} = \\left|\\frac{\\mu_{ij}}{v_{\\mathrm{rel}}}\\right| \\Bigg|_{q=1} = \\frac{1}{1 + \\eta^2},\n$$\n来参数化运动学，该因子通过在 $q = 1$ 处评估粒子对的接近过程得到，此处三次样条核的梯度幅值接近其最大值，且 $v_{\\mathrm{rel}}$ 是沿分离矢量的相对速率。\n- 对于能量耗散条件，使用连续介质近似，其中强激波附近由人工粘性贡献的加速度大小被建模为\n$$\n|a| \\simeq |\\Pi| \\, \\rho \\, \\int |\\nabla W| \\, dV \\equiv |\\Pi| \\, \\rho \\, \\frac{C_d}{h},\n$$\n并从积分式\n$$\nC_d = \\sigma 4 \\pi \\int_0^2 q^2 \\left(- w'(q)\\right) \\, dq,\n$$\n推导三维三次样条核的无量纲常数 $C_d$，其中 $\\sigma = 1/\\pi$ 且 $w'(q)$ 是 $w(q)$ 对 $q$ 的导数。\n\n程序规格：\n- 实现一个函数，在给定 $(M, h, \\eta, \\chi)$（其中 $M \\ge 100$）的情况下，计算满足上述推导的应力主导和能量耗散两个约束条件的最小 $\\beta_{\\min}$。假设使用三维三次样条核，并按规定在 $q = 1$ 处评估 $\\tilde{\\kappa}$。将 $\\beta_{\\min}$ 视为无量纲量。\n- 使用以下参数值测试套件 $(M, h, \\eta, \\chi)$：\n  - 测试 1：$(M, h, \\eta, \\chi) = (100, 1.0, 0.1, 1.0)$。\n  - 测试 2：$(M, h, \\eta, \\chi) = (1000, 0.5, 0.5, 1.0)$。\n  - 测试 3：$(M, h, \\eta, \\chi) = (100, 1.0, 0.1, 0.05)$。\n  - 测试 4：$(M, h, \\eta, \\chi) = (300, 10.0, 0.01, 1.0)$。\n  - 测试 5：$(M, h, \\eta, \\chi) = (120, 1.0, 0.2, 0.25)$。\n- 您的程序必须生成单行输出，其中包含与上述顺序相同的五个测试的最小系数计算结果列表。格式必须是方括号括起来的逗号分隔的十进制数列表，例如 $[x_1,x_2,x_3,x_4,x_5]$。每个条目必须是浮点数。这些值是无量纲的。", "solution": "用户提供的问题已经过评估，并被确定为有效。它在科学上基于光滑粒子流体动力学（SPH）的原理，在数学上是适定的，并且陈述客观。推导所需的所有公式和参数均已提供，问题内部一致。因此，我们可以进行完整求解。\n\n中心任务是推导二次人工粘性系数 $\\beta_{\\min}$ 的一个下界，该下界满足两个旨在防止强激波中粒子相互穿透的独立物理约束。推导将基于所提供的方程和假设。\n\n**1. 准备工作和设定**\n\n问题指定了粒子对 $i$ 和 $j$ 之间的 Monaghan-Gingold 形式的人工粘性 $\\Pi_{ij}$。对于超强激波，我们通过设置 $\\alpha=0$ 来忽略线性粘性项。对于收缩流（$\\mathbf{v}_{ij} \\cdot \\mathbf{r}_{ij}  0$），粘性项为：\n$$ \\Pi_{ij} = \\frac{\\beta \\mu_{ij}^2}{\\bar{\\rho}_{ij}} $$\n其中 $\\beta$ 是无量纲二次系数，$\\bar{\\rho}_{ij}$ 是粒子对平均密度，$\\mu_{ij}$ 定义为：\n$$ \\mu_{ij} = \\frac{h \\, \\mathbf{v}_{ij} \\cdot \\mathbf{r}_{ij}}{|\\mathbf{r}_{ij}|^2 + \\eta^2 h^2} $$\n此处，$h$ 是光滑长度，$\\eta$ 是正则化参数。对于正向接近的最坏情况，相对速度 $\\mathbf{v}_{ij}$ 与分离矢量 $\\mathbf{r}_{ij}$ 反平行。我们可以写成 $\\mathbf{v}_{ij} \\cdot \\mathbf{r}_{ij} = -v_{\\text{rel}} r_{ij}$，其中 $v_{\\text{rel}} = |\\mathbf{v}_{ij}|$ 且 $r_{ij} = |\\mathbf{r}_{ij}|$。将此代入 $\\mu_{ij}$ 的表达式得到：\n$$ \\mu_{ij} = -\\frac{h v_{\\text{rel}} r_{ij}}{r_{ij}^2 + \\eta^2 h^2} $$\n问题指导我们在分离距离 $r_{ij} = h$ 处评估运动学行为，这对应于无量纲距离 $q=r_{ij}/h=1$。在此距离处，$\\mu_{ij}$ 的大小为：\n$$ |\\mu_{ij}|_{r_{ij}=h} = \\frac{h v_{\\text{rel}} h}{h^2 + \\eta^2 h^2} = \\frac{v_{\\text{rel}} h^2}{h^2(1+\\eta^2)} = \\frac{v_{\\text{rel}}}{1+\\eta^2} $$\n这与问题中使用 $\\tilde{\\kappa}$ 的参数化一致：\n$$ \\tilde{\\kappa} = \\left|\\frac{\\mu_{ij}}{v_{\\mathrm{rel}}}\\right| \\Bigg|_{q=1} = \\frac{1}{1 + \\eta^2} $$\n因此，在特征相互作用距离 $r_{ij}=h$ 处，我们可以将 $\\mu_{ij}$ 的大小表示为 $|\\mu_{ij}| = v_{\\text{rel}} \\tilde{\\kappa}$。这将用于建立稳定性条件。\n\n**2. 条件 1：应力主导**\n\n第一个条件要求人工粘性应力主导收缩流的冲压。量 $\\bar{\\rho}_{ij} \\Pi_{ij}$ 具有压强（或应力）的单位。根据 $\\Pi_{ij}$ 的定义（$\\alpha=0$），粘性应力为 $\\tau_{\\text{visc}} = \\bar{\\rho}_{ij} \\Pi_{ij} = \\beta \\mu_{ij}^2$。冲压是流的动量通量，其量级为 $P_{\\text{ram}} \\sim \\bar{\\rho}_{ij} v_{\\text{rel}}^2$。\n\n为防止粒子塌陷，粘性排斥压力必须至少与驱动粒子聚集的冲压相当。比较比能（单位质量的能量）是等效的，并且在量纲上是合理的。与粘性应力相关的比能是 $\\beta \\mu_{ij}^2$，而相对运动的比动能的量级为 $v_{\\text{rel}}^2$。条件是：\n$$ \\beta \\mu_{ij}^2 \\gtrsim v_{\\text{rel}}^2 $$\n在特征距离 $r_{ij}=h$ 处评估此式，此时 $\\mu_{ij}^2 = (v_{\\text{rel}} \\tilde{\\kappa})^2$：\n$$ \\beta (v_{\\text{rel}} \\tilde{\\kappa})^2 \\ge v_{\\text{rel}}^2 $$\n$$ \\beta \\tilde{\\kappa}^2 \\ge 1 $$\n这给出了 $\\beta$ 的第一个下界：\n$$ \\beta_{\\text{stress}} = \\frac{1}{\\tilde{\\kappa}^2} = (1+\\eta^2)^2 $$\n\n**3. 条件 2：能量耗散**\n\n第二个条件要求人工粘性力在“停止距离” $\\Delta s = \\chi h$ 上所做的功足以耗散初始的相对动能。单位质量所做的功由 $\\int |a_{\\text{visc}}| ds$ 给出。\n\n问题为粘性加速度的大小提供了一个模型：\n$$ |a_{\\text{visc}}| \\simeq |\\Pi_{ij}| \\bar{\\rho}_{ij} \\frac{C_d}{h} $$\n代入 $\\Pi_{ij}$ 的表达式：\n$$ |a_{\\text{visc}}| \\simeq \\left(\\frac{\\beta \\mu_{ij}^2}{\\bar{\\rho}_{ij}}\\right) \\bar{\\rho}_{ij} \\frac{C_d}{h} = \\frac{\\beta \\mu_{ij}^2 C_d}{h} $$\n假设在停止距离上加速度大致恒定，则单位质量所做的功为：\n$$ \\frac{W_{\\text{visc}}}{m} = |a_{\\text{visc}}| \\Delta s \\simeq \\left( \\frac{\\beta \\mu_{ij}^2 C_d}{h} \\right) (\\chi h) = \\beta \\chi C_d \\mu_{ij}^2 $$\n在 $r_{ij}=h$ 处使用 $\\mu_{ij}^2 = (v_{\\text{rel}} \\tilde{\\kappa})^2$ 对此进行评估：\n$$ \\frac{W_{\\text{visc}}}{m} \\simeq \\beta \\chi C_d (v_{\\text{rel}} \\tilde{\\kappa})^2 $$\n这个功必须至少等于折合二体系统的初始单位质量相对动能，即 $\\frac{1}{2} v_{\\text{rel}}^2$。\n$$ \\beta \\chi C_d v_{\\text{rel}}^2 \\tilde{\\kappa}^2 \\ge \\frac{1}{2} v_{\\text{rel}}^2 $$\n这产生了 $\\beta$ 的第二个下界：\n$$ \\beta_{\\text{energy}} = \\frac{1}{2 \\chi C_d \\tilde{\\kappa}^2} = \\frac{(1+\\eta^2)^2}{2 \\chi C_d} $$\n要使用此公式，我们必须计算无量纲核常数 $C_d$：\n$$ C_d = \\sigma 4 \\pi \\int_0^2 q^2 \\left(- w'(q)\\right) \\, dq $$\n当 $\\sigma = 1/\\pi$ 时，此式简化为 $C_d = 4 \\int_0^2 q^2 (-w'(q)) dq$。对于 M4 三次样条核，导数 $w'(q)$ 为：\n$$ w'(q) = \\begin{cases} -3q + \\frac{9}{4} q^2,  0 \\le q  1 \\\\ -\\frac{3}{4} (2-q)^2,  1 \\le q  2 \\end{cases} $$\n积分分为两部分：\n$$ \\int_0^1 q^2 (-w'(q)) dq = \\int_0^1 q^2(3q - \\frac{9}{4}q^2)dq = \\left[\\frac{3}{4}q^4 - \\frac{9}{20}q^5\\right]_0^1 = \\frac{3}{4} - \\frac{9}{20} = \\frac{6}{20} = \\frac{3}{10} $$\n$$ \\int_1^2 q^2 (-w'(q)) dq = \\int_1^2 q^2 \\frac{3}{4}(2-q)^2 dq = \\frac{3}{4} \\int_1^2 (4q^2-4q^3+q^4)dq = \\frac{3}{4}\\left[\\frac{4}{3}q^3-q^4+\\frac{1}{5}q^5\\right]_1^2 = \\frac{3}{4}\\left(\\frac{16}{15}-\\frac{8}{15}\\right) = \\frac{2}{5} $$\n将两部分求和并乘以 $4$：\n$$ C_d = 4 \\left( \\frac{3}{10} + \\frac{2}{5} \\right) = 4 \\left( \\frac{7}{10} \\right) = 2.8 $$\n将 $C_d = 2.8$ 代入 $\\beta_{\\text{energy}}$ 的表达式中：\n$$ \\beta_{\\text{energy}} = \\frac{(1+\\eta^2)^2}{2 \\chi (2.8)} = \\frac{(1+\\eta^2)^2}{5.6 \\chi} $$\n\n**4. $\\beta_{\\min}$ 的最终表达式**\n\n最小系数 $\\beta_{\\min}$ 必须同时满足应力主导和能量耗散两个条件。因此，它必须是两个推导出的下界中的最大值：\n$$ \\beta_{\\min} = \\max(\\beta_{\\text{stress}}, \\beta_{\\text{energy}}) = \\max\\left( (1+\\eta^2)^2, \\frac{(1+\\eta^2)^2}{5.6 \\chi} \\right) $$\n该表达式可以因式分解，得到用于实现的最终公式：\n$$ \\beta_{\\min} = (1+\\eta^2)^2 \\cdot \\max\\left(1, \\frac{1}{5.6 \\chi}\\right) $$\n值得注意的是，无量纲系数 $\\beta_{\\min}$ 的结果与马赫数 $M$ 和光滑长度 $h$ 无关，因为在给定的假设下，这些参数在推导过程中被消去了。计算仅依赖于粘性正则化参数 $\\eta$ 和无量纲停止距离 $\\chi$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimal quadratic artificial viscosity coefficient for SPH shocks.\n    \"\"\"\n\n    # The problem provides a test suite of parameter values (M, h, eta, chi).\n    # M = Mach number, h = smoothing length, eta = regularization parameter,\n    # chi = dimensionless stopping distance.\n    test_cases = [\n        (100, 1.0, 0.1, 1.0),\n        (1000, 0.5, 0.5, 1.0),\n        (100, 1.0, 0.1, 0.05),\n        (300, 10.0, 0.01, 1.0),\n        (120, 1.0, 0.2, 0.25),\n    ]\n\n    def compute_beta_min(M, h, eta, chi):\n        \"\"\"\n        Calculates the minimal beta based on the derived stability criteria.\n\n        The derived formula is:\n        beta_min = (1 + eta^2)^2 * max(1, 1 / (5.6 * chi))\n\n        Note that M and h do not appear in the final formula for the dimensionless\n        coefficient beta_min, as they cancel out in the derivation based on the\n        problem's assumptions. They are included as arguments for formal\n        completeness as per the problem specification.\n        \"\"\"\n        # The dimensionless constant C_d for the M4 cubic spline kernel was derived\n        # to be 2.8. The factor in the energy dissipation term is 2 * C_d = 5.6.\n        C_d_factor = 5.6\n\n        # Calculate the common factor related to the eta parameter.\n        # This term (1+eta^2)^2 comes from (1/kappa_tilde)^2 from the derivation.\n        eta_term = (1 + eta**2)**2\n\n        # The final value is determined by the maximum of two conditions:\n        # 1. Stress-dominance condition, which gives a lower bound of eta_term.\n        # 2. Energy-dissipation condition, which gives a lower bound of\n        #    eta_term / (C_d_factor * chi).\n        # This is equivalent to taking eta_term * max(1, 1/(C_d_factor*chi)).\n        max_factor = max(1.0, 1.0 / (C_d_factor * chi))\n\n        beta_min = eta_term * max_factor\n        return beta_min\n\n    results = []\n    for case in test_cases:\n        M, h, eta, chi = case\n        result = compute_beta_min(M, h, eta, chi)\n        results.append(result)\n\n    # The final print statement must produce only the single-line format\n    # specified in the problem statement.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3465348"}]}