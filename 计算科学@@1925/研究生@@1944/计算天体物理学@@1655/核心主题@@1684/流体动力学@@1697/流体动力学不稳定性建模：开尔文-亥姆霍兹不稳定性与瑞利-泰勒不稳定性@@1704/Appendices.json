{"hands_on_practices": [{"introduction": "在开始复杂的数值模拟之前，首先建立对不稳定性的物理阈值的基本理解至关重要。这项练习通过平衡开尔文-亥姆霍兹不稳定性的驱动力与粘性耗散，来揭示其核心物理原理。通过估算临界雷诺数，您将对这一关键阈值获得切实的理解，为后续更复杂的模拟研究奠定坚实的物理基础。[@problem_id:3519377]", "problem": "考虑一个由两种半无限、不可压缩、等密度流体形成的平面天体物理剪切层，其速度剖面为 $U(y) = \\frac{\\Delta U}{2} \\tanh\\!\\left(\\frac{y}{a}\\right)$，其中 $\\Delta U$ 是跨越剪切层的速度差，$a$ 是特征剪切厚度。假设流动是等温的，密度是均匀的，其动力学由具有运动粘度 $\\nu$ 的不可压缩纳维-斯托克斯方程控制。一个波数为 $k$ 的小振幅二维扰动，在无粘开尔文-亥姆霍兹不稳定性 (KHI) 和粘性扩散的共同作用下演化。对于双曲正切剪切层，线性稳定性理论的一个经过充分检验的结果是，在无粘极限下，最不稳定模式的 $k a \\approx \\alpha$，其中 $\\alpha \\approx 0.44$，对于等密度情况，相应的无粘增长率为 $\\gamma_{\\text{inv}} \\approx C \\frac{\\Delta U}{a}$，其中 $C \\approx 0.19$。另一个经过充分检验的事实是，粘性扩散以指数率 $\\gamma_{\\nu} \\approx \\nu k^{2}$ 阻尼一个傅里叶模式。\n\n将雷诺数定义为 $\\mathrm{Re} = \\frac{\\Delta U\\, a}{\\nu}$。对于增长最快模式的近无粘 KHI 增长，估算使得无粘增长不被粘性抑制的最小雷诺数 $\\mathrm{Re}$。使用阈值发生的判据，即无粘增长率等于增长最快模式的粘性阻尼率。计算得出的最小雷诺数，并将最终答案四舍五入到三位有效数字。将最终答案表示为一个无单位的纯数。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定且客观的。这是一个关于剪切层稳定性的流体动力学标准问题。\n\n目标是确定开尔文-亥姆霍兹不稳定性 (KHI) 增长所需的最小雷诺数 $\\mathrm{Re}$。雷诺数定义为：\n$$\n\\mathrm{Re} = \\frac{\\Delta U\\, a}{\\nu}\n$$\n其中 $\\Delta U$ 是速度差，$a$ 是特征剪切厚度，$\\nu$ 是运动粘度。\n\n扰动的增长由净增长率决定，净增长率是无粘增长率 $\\gamma_{\\text{inv}}$ 和粘性阻尼率（为负值）$-\\gamma_{\\nu}$ 的和。当净增长率大于零时，即 $\\gamma_{\\text{inv}} - \\gamma_{\\nu}  0$ 时，发生不稳定性。因此，不稳定性的阈值（对应于增长所需的最小雷诺数）由无粘增长率与粘性阻尼率完全平衡的条件定义：\n$$\n\\gamma_{\\text{inv}} = \\gamma_{\\nu}\n$$\n问题指定该判据应应用于增长最快的无粘模式。\n\n根据问题陈述，增长最快模式的无粘增长率由下式给出：\n$$\n\\gamma_{\\text{inv}} \\approx C \\frac{\\Delta U}{a}\n$$\n其中常数 $C \\approx 0.19$。\n\n波数为 $k$ 的模式的粘性阻尼率由下式给出：\n$$\n\\gamma_{\\nu} \\approx \\nu k^{2}\n$$\n问题指出，增长最快的无粘模式具有满足以下条件的无量纲波数 $ka$：\n$$\nka \\approx \\alpha\n$$\n其中常数 $\\alpha \\approx 0.44$。从这个关系中，我们可以将该模式的波数 $k$ 表示为：\n$$\nk \\approx \\frac{\\alpha}{a}\n$$\n将 $k$ 的这个表达式代入粘性阻尼率方程，得到增长最快模式的阻尼率：\n$$\n\\gamma_{\\nu} \\approx \\nu \\left(\\frac{\\alpha}{a}\\right)^2 = \\nu \\frac{\\alpha^2}{a^2}\n$$\n现在，我们通过令无粘增长率等于粘性阻尼率来应用阈值判据：\n$$\nC \\frac{\\Delta U}{a} = \\nu \\frac{\\alpha^2}{a^2}\n$$\n为了求出雷诺数，我们重排这个方程以分离出项 $\\frac{\\Delta U a}{\\nu}$。首先，我们可以从两边消去一个因子 $a^{-1}$，或者等价地，两边都乘以 $a^2$：\n$$\nC (\\Delta U) a = \\nu \\alpha^2\n$$\n接下来，我们将两边同时除以 $\\nu$ 和 $C$，以求解对应于雷诺数的表达式：\n$$\n\\frac{\\Delta U a}{\\nu} = \\frac{\\alpha^2}{C}\n$$\n由于 $\\mathrm{Re} = \\frac{\\Delta U a}{\\nu}$，不稳定性所需的最小雷诺数为：\n$$\n\\mathrm{Re} = \\frac{\\alpha^2}{C}\n$$\n我们已知常数 $\\alpha$ 和 $C$ 的近似值：\n$$\n\\alpha \\approx 0.44\n$$\n$$\nC \\approx 0.19\n$$\n将这些值代入 $\\mathrm{Re}$ 的表达式：\n$$\n\\mathrm{Re} \\approx \\frac{(0.44)^2}{0.19} = \\frac{0.1936}{0.19} \\approx 1.018947...\n$$\n问题要求最终答案四舍五入到三位有效数字。前三位有效数字是 $1.01$。第四位数字是 $8$，所以我们将第三位有效数字向上取整。\n$$\n\\mathrm{Re} \\approx 1.02\n$$\n这个临界雷诺数代表了一个阈值，低于此值，对于给定的剪切层剖面，粘性力将足够强以完全抑制 KHI。", "answer": "$$\\boxed{1.02}$$", "id": "3519377"}, {"introduction": "将物理理论付诸实践时，我们必须面对计算模拟带来的挑战，其中最关键的便是数值耗散可能人为地抑制真实的物理不稳定性。本练习通过建立一个理论模型，将物理增长率与等效的数值粘性进行对比，旨在让您学会如何量化网格分辨率等模拟参数对结果保真度的影响。这是一项解读任何模拟结果都不可或缺的核心技能。[@problem_id:3519421]", "problem": "您需要形式化和量化在Kelvin–Helmholtz不稳定性的数值模拟中，剪切层厚度与网格间距之比如何控制数值耗散以及网格尺度次级不稳定性的倾向。您将在一个一维表示法下处理基本剪切层，该剪切层具有双曲正切速度剖面，并考虑沿流向呈周期性的扰动。您的目标是推导并实现一个定量模型，该模型将无粘Kelvin–Helmholtz增长与由有限体积通量离散化引起的有效数值粘性联系起来。然后，您必须在一组给定的参数测试套件上评估该模型，并以单一标准化的输出格式报告特定指标。\n\n从以下基本出发点开始：\n- 在无粘性极限下的质量和动量守恒。将基态视为两个密度相等的半无限流体，由一个名义厚度为 $\\delta$ 的剪切层隔开，该剪切层由 $U(z) \\approx \\frac{\\Delta U}{2} \\tanh(z/\\delta)$ 表示，其中 $\\Delta U$ 是跨越该层的速度差。\n- 对密度相等的涡片进行的经典无粘Kelvin–Helmholtz正规模态分析表明，流向波数为 $k$ 的扰动会以与剪切成正比的速率呈指数级放大，并且当 $\\delta \\to 0$ 时，接近涡片极限。\n- 对于采用类黎曼求解器通量分裂的守恒型有限体积格式，其数值耗散的线性标量模型在网格间距 $\\Delta x$ 的主导阶上，可以近似为一个等效的对流-扩散方程，其有效数值粘性 $\\nu_{\\mathrm{num}}$ 与特征信号速度和网格间距成线性关系。为解决此问题，将有效数值粘性建模为 $\\nu_{\\mathrm{num}} = \\chi \\, a \\, \\Delta x$，其中 $a$ 是该方法的特征速度，$\\chi$ 是一个在区间 $(0,1]$ 内的无量纲、与格式相关的系数。\n\n您的任务：\n1. 从第一性原理出发，为分隔两个密度相等的流体（速度差为 $\\Delta U$）的平面涡片，推导其无粘Kelvin–Helmholtz指数增长率 $\\gamma_{\\mathrm{KH}}(k)$ 的公式。不要假设任何先验公式；使用线性化方程和适当的界面条件。\n2. 使用von Neumann分析法分析由守恒单调通量离散化的线性对流，推导作用于波数为 $k$ 的傅里叶模态的等效扩散的主导阶形式，并证明对于小的 $\\Delta x$，由数值耗散引起的衰减率为 $\\sigma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{num}} k^{2}$，其中 $\\nu_{\\mathrm{num}}$ 按上述方式建模。\n3. 将两个结果合并为一个净增长率模型 $\\gamma_{\\mathrm{eff}}(k) = \\gamma_{\\mathrm{KH}}(k) - \\nu_{\\mathrm{num}} k^{2}$，该模型捕捉了无粘剪切放大与数值耗散之间的竞争。使用此模型定义以下诊断指标：\n   - 在基本扰动波数 $k_{\\mathrm{p}} = 2\\pi/L$（其中 $L$ 是给定的域长度）下的主模态净增长率：$\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}})$，以 $\\mathrm{s}^{-1}$ 为单位表示。\n   - 无量纲的伪扩散-增长比 $\\mathcal{S} = \\dfrac{\\nu_{\\mathrm{num}} \\, \\delta^{-2}}{\\gamma_{\\mathrm{KH}}(k_{\\mathrm{p}})}$，定义为在特征波数 $k \\sim \\delta^{-1}$ 下的数值耗散阻尼率与在 $k_{\\mathrm{p}}$ 下的无粘主Kelvin–Helmholtz增长率之比。该指标衡量剪切层是否在主模态增长之前被人为平滑。将 $\\mathcal{S}$ 报告为无量纲浮点数。\n   - 网格尺度次级不稳定性倾向的二元指标，通过评估在奈奎斯特波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$ 下的 $\\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})$ 的符号来定义。如果 $\\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})  0$，则返回 $1$（不稳定网格尺度）；否则返回 $0$（稳定网格尺度）。\n\n使用以下参数集测试套件，每个参数集以6元组 $(\\delta, \\Delta x, \\Delta U, L, a, \\chi)$ 的形式给出，单位已指定：\n- 案例1： $(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (8\\times 10^{-3}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例2： $(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (2\\times 10^{-3}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例3： $(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (5\\times 10^{-4}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例4： $(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (5\\times 10^{-4}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.05)$。\n\n对于每个案例，计算并报告三元组 $[\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}}), \\mathcal{S}, I_{\\mathrm{N}}]$，其中 $\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}})$ 必须以 $\\mathrm{s}^{-1}$ 为单位表示并四舍五入到小数点后六位，$\\mathcal{S}$ 必须四舍五入到小数点后六位，而 $I_{\\mathrm{N}} \\in \\{0,1\\}$ 是上面定义的整数指标。\n\n您的程序应生成单行输出，其中包含所有案例的结果，形式为一个由方括号括起来的逗号分隔列表，并按顺序连接各个三元组。例如，对于两个结果为 $(x_{1},y_{1},z_{1})$ 和 $(x_{2},y_{2},z_{2})$ 的案例，输出格式必须严格为 $[x_{1},y_{1},z_{1},x_{2},y_{2},z_{2}]$。\n\n所有物理量必须使用上述指定的单位。所有角度（如有）必须以弧度为单位。百分比必须表示为小数或分数，不得使用百分号。通过使用推导出的表达式和给定的有效数值粘性模型，确保科学真实性，除 $\\chi$ 外，不得引入额外的经验拟合因子。", "solution": "该问题要求建立并应用一个模型，用以量化计算模拟中物理Kelvin-Helmholtz (KH) 不稳定性与数值耗散之间的相互作用。该方法包括推导无粘增长率，将数值耗散建模为有效粘性，将它们组合成净增长率，并针对一组给定的物理和数值参数评估特定的诊断指标。\n\n第一项任务是推导涡片的无粘增长率 $\\gamma_{\\mathrm{KH}}(k)$。涡片是剪切层厚度 $\\delta \\to 0$ 时的极限情况。我们考虑密度均为常数 $\\rho$ 的两个半无限、无粘、不可压缩流体。在平均速度为零的参考系中，上层流体 ($z0$) 以速度 $U_1 = \\Delta U/2$ 运动，下层流体 ($z0$) 以速度 $U_2 = -\\Delta U/2$ 运动，两者均沿 $x$ 方向。\n\n我们通过引入小扰动来分析界面在 $z=0$ 处的稳定性。流动是无旋的，因此速度扰动可以表示为势的梯度，$\\mathbf{u}' = \\nabla\\phi$。不可压缩性条件 $\\nabla \\cdot \\mathbf{u} = 0$ 意味着扰动势满足拉普拉斯方程 $\\nabla^2\\phi = 0$。我们寻找形如 $\\phi(x,z,t) = \\hat{\\phi}(z) e^{i(kx - \\omega t)}$ 的正规模态解以及界面垂直位移 $\\eta(x,t) = \\hat{\\eta} e^{i(kx - \\omega t)}$。不稳定性的增长率由复频率的虚部给出，$\\gamma = \\mathrm{Im}(\\omega)$。\n\n将正规模态形式代入拉普拉斯方程，得到 $\\frac{d^2\\hat{\\phi}}{dz^2} - k^2\\hat{\\phi} = 0$。在远离界面（$z \\to \\pm\\infty$）时保持有界的解是：\n$$\n\\hat{\\phi}_1(z) = A_1 e^{-|k|z} \\quad \\text{for } z0 \\\\\n\\hat{\\phi}_2(z) = A_2 e^{|k|z} \\quad \\text{for } z0\n$$\n这里我们不失一般性地假设 $k0$，因此写作 $|k|=k$。\n\n在扰动界面 $z=\\eta$ 处应用两个边界条件：\n1. 运动学边界条件指出，界面上的流体质点会一直停留在界面上。一阶近似下，这表示为 $w' = \\frac{\\partial\\eta}{\\partial t} + U \\frac{\\partial\\eta}{\\partial x}$。由于 $w' = \\frac{\\partial\\phi}{\\partial z}$，我们在 $z=0$ 处有：\n    $$\n    \\frac{\\partial\\phi_1}{\\partial z} \\Big|_{z=0} = (-i\\omega + ikU_1)\\eta \\implies -kA_1 = i(kU_1 - \\omega)\\hat{\\eta}\n    $$\n    $$\n    \\frac{\\partial\\phi_2}{\\partial z} \\Big|_{z=0} = (-i\\omega + ikU_2)\\eta \\implies kA_2 = i(kU_2 - \\omega)\\hat{\\eta}\n    $$\n\n2. 动力学边界条件要求压力跨界面连续（忽略表面张力）。压力扰动 $p'$ 由线性化的伯努利方程给出：$p' = -\\rho(\\frac{\\partial\\phi}{\\partial t} + U\\frac{\\partial\\phi}{\\partial x})$。令 $z=0$ 处的压力相等：\n    $$\n    -\\rho(-i\\omega + ikU_1)\\hat{\\phi}_1(0) = -\\rho(-i\\omega + ikU_2)\\hat{\\phi}_2(0)\n    $$\n    $$\n    (kU_1 - \\omega)A_1 = (kU_2 - \\omega)A_2\n    $$\n\n我们现在得到了一个关于 $A_1$、$A_2$ 和 $\\hat{\\eta}$ 的三个线性齐次方程组。为使非平凡解存在，系数矩阵的行列式必须为零。或者，我们可以利用运动学条件来替换动力学条件中的 $A_1$ 和 $A_2$：\n$$\nA_1 = -\\frac{i\\hat{\\eta}}{k}(kU_1 - \\omega)\n$$\n$$\nA_2 = \\frac{i\\hat{\\eta}}{k}(kU_2 - \\omega)\n$$\n将这些代入动力学条件得到：\n$$\n(kU_1 - \\omega)\\left(-\\frac{i\\hat{\\eta}}{k}(kU_1 - \\omega)\\right) = (kU_2 - \\omega)\\left(\\frac{i\\hat{\\eta}}{k}(kU_2 - \\omega)\\right)\n$$\n假设扰动非平凡（$\\hat{\\eta} \\neq 0$），这可以简化为色散关系：\n$$\n(kU_1 - \\omega)^2 + (kU_2 - \\omega)^2 = 0\n$$\n展开并求解关于 $\\omega$ 的二次方程：\n$$\n2\\omega^2 - 2k(U_1+U_2)\\omega + k^2(U_1^2+U_2^2) = 0\n$$\n$$\n\\omega = \\frac{2k(U_1+U_2) \\pm \\sqrt{4k^2(U_1+U_2)^2 - 8k^2(U_1^2+U_2^2)}}{4}\n$$\n$$\n\\omega = k\\frac{U_1+U_2}{2} \\pm \\frac{k}{2}\\sqrt{(U_1+U_2)^2 - 2(U_1^2+U_2^2)} = k\\frac{U_1+U_2}{2} \\pm \\frac{k}{2}\\sqrt{-U_1^2+2U_1U_2-U_2^2}\n$$\n$$\n\\omega = k\\frac{U_1+U_2}{2} \\pm i \\frac{k}{2}\\sqrt{(U_1-U_2)^2} = k\\frac{U_1+U_2}{2} \\pm i \\frac{k}{2}|U_1-U_2|\n$$\n不稳定性增长率 $\\gamma = \\mathrm{Im}(\\omega)$ 是正虚部：\n$$\n\\gamma_{\\mathrm{KH}}(k) = \\frac{k}{2}|U_1-U_2|\n$$\n当 $U_1=\\Delta U/2$ 和 $U_2=-\\Delta U/2$ 时，我们有 $|U_1-U_2| = |\\Delta U|$。因此，无粘增长率的最终表达式为：\n$$\n\\gamma_{\\mathrm{KH}}(k) = \\frac{k |\\Delta U|}{2}\n$$\n\n第二项任务是为数值耗散的影响建模。我们考虑一维线性对流方程 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$，在间距为 $\\Delta x$ 的均匀网格上离散化。一个守恒型有限体积更新为 $\\frac{du_j}{dt} = -\\frac{1}{\\Delta x}(F_{j+1/2} - F_{j-1/2})$。对于 $a0$，一阶迎风格式通量为 $F_{j+1/2} = a u_j$，这得到半离散格式：\n$$\n\\frac{du_j}{dt} = -\\frac{a}{\\Delta x}(u_j - u_{j-1})\n$$\n我们通过代入傅里叶模态 $u_j(t) = \\hat{u}(t)e^{ikj\\Delta x}$ 来进行von Neumann分析：\n$$\n\\frac{d\\hat{u}}{dt}e^{ikj\\Delta x} = -\\frac{a}{\\Delta x}(\\hat{u}e^{ikj\\Delta x} - \\hat{u}e^{ik(j-1)\\Delta x})\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{a}{\\Delta x}(1 - e^{-ik\\Delta x})\\hat{u} = \\hat{\\omega}(k)\\hat{u}\n$$\n数值格式的复频率 $\\hat{\\omega}(k)$ 为：\n$$\n\\hat{\\omega}(k) = -\\frac{a}{\\Delta x}(1 - \\cos(k\\Delta x) + i\\sin(k\\Delta x))\n$$\n$\\hat{\\omega}(k)$ 的实部控制模态振幅的衰减或增长。对于小的 $k\\Delta x$，我们展开三角函数：$\\cos(z) \\approx 1-z^2/2$ 和 $\\sin(z) \\approx z$。\n$$\n\\hat{\\omega}(k) \\approx -\\frac{a}{\\Delta x}\\left(\\frac{(k\\Delta x)^2}{2} + ik\\Delta x\\right) = -ik a - \\frac{a\\Delta x}{2}k^2\n$$\n虚部 $-ika$ 对应于速度为 $a$ 的对流。实部 $-\\frac{a\\Delta x}{2}k^2$ 代表一种耗散衰减。衰减率为 $\\sigma(k) = -\\mathrm{Re}(\\hat{\\omega}(k))$。这类似于物理扩散过程 $\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}$，它对于模态 $e^{ikx}$ 给出 $\\nu k^2$ 的衰减率。通过比较，该数值格式具有有效数值粘性 $\\nu_{\\mathrm{num}} = \\frac{a\\Delta x}{2}$。问题提供了一个广义模型 $\\nu_{\\mathrm{num}} = \\chi a \\Delta x$，它通过系数 $\\chi$ 来考虑不同的数值格式。因此，由数值耗散引起的衰减率为：\n$$\n\\sigma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{num}}k^2 = (\\chi a \\Delta x)k^2\n$$\n\n第三项任务是组合这些效应。净增长率 $\\gamma_{\\mathrm{eff}}(k)$ 是无粘增长率减去数值衰减率：\n$$\n\\gamma_{\\mathrm{eff}}(k) = \\gamma_{\\mathrm{KH}}(k) - \\sigma_{\\mathrm{num}}(k) = \\frac{k|\\Delta U|}{2} - (\\chi a \\Delta x)k^2\n$$\n使用此模型，我们定义所需的诊断指标：\n1.  主模态净增长率在域的基本波数 $k_{\\mathrm{p}} = 2\\pi/L$ 处评估：\n    $$\n    \\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}}) = \\frac{k_{\\mathrm{p}}|\\Delta U|}{2} - \\chi a \\Delta x k_{\\mathrm{p}}^2\n    $$\n2.  伪扩散-增长比 $\\mathcal{S}$ 比较了剪切层厚度尺度（即波数 $k \\sim \\delta^{-1}$）下的数值耗散率与主模态的无粘增长率：\n    $$\n    \\mathcal{S} = \\frac{\\nu_{\\mathrm{num}}\\delta^{-2}}{\\gamma_{\\mathrm{KH}}(k_{\\mathrm{p}})} = \\frac{\\chi a \\Delta x / \\delta^2}{k_{\\mathrm{p}}|\\Delta U|/2}\n    $$\n3.  网格尺度次级不稳定性倾向 $I_{\\mathrm{N}}$ 由奈奎斯特波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$（代表网格可分辨的最高频率）处的净增长率的符号确定：\n    $$\n    I_{\\mathrm{N}} = \\begin{cases} 1  \\text{if } \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})  0 \\\\ 0  \\text{if } \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}}) \\le 0 \\end{cases} \\quad \\text{where} \\quad \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}}) = \\frac{k_{\\mathrm{N}}|\\Delta U|}{2} - \\chi a \\Delta x k_{\\mathrm{N}}^2\n    $$\n\n现在将这些推导出的公式应用于提供的参数测试套件，以计算指定的物理和数值指标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes diagnostics for Kelvin-Helmholtz instability in the presence of \n    numerical diffusion for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta, dx, dU, L, a, chi)\n    test_cases = [\n        (8e-3, 1e-3, 100.0, 0.1, 50.0, 0.5),   # Case 1\n        (2e-3, 1e-3, 100.0, 0.1, 50.0, 0.5),   # Case 2\n        (5e-4, 1e-3, 100.0, 0.1, 50.0, 0.5),   # Case 3\n        (5e-4, 1e-3, 100.0, 0.1, 50.0, 0.05),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, dx, dU, L, a, chi = case\n        \n        # Calculate wavenumbers\n        # Primary mode wavenumber\n        k_p = 2 * np.pi / L\n        # Nyquist wavenumber\n        k_N = np.pi / dx\n        \n        # Calculate numerical viscosity\n        nu_num = chi * a * dx\n        \n        # TASK 1: Calculate primary-mode net growth rate gamma_eff(k_p)\n        # Inviscid KH growth rate at k_p\n        gamma_kh_p = 0.5 * k_p * dU\n        # Numerical diffusion decay rate at k_p\n        sigma_num_p = nu_num * k_p**2\n        # Net growth rate at k_p\n        gamma_eff_p = gamma_kh_p - sigma_num_p\n        \n        # TASK 2: Calculate spurious-diffusion-to-growth ratio S\n        # Numerator: diffusion rate at shear layer scale\n        numerator_S = nu_num / delta**2\n        # Denominator: primary mode inviscid growth rate\n        denominator_S = gamma_kh_p\n        # Ratio S\n        S = numerator_S / denominator_S if denominator_S != 0 else float('inf')\n        \n        # TASK 3: Calculate grid-scale secondary instability propensity I_N\n        # Inviscid KH growth rate at k_N\n        gamma_kh_N = 0.5 * k_N * dU\n        # Numerical diffusion decay rate at k_N\n        sigma_num_N = nu_num * k_N**2\n        # Net growth rate at k_N\n        gamma_eff_N = gamma_kh_N - sigma_num_N\n        # Binary indicator I_N\n        I_N = 1 if gamma_eff_N > 0 else 0\n        \n        # Format results as specified\n        gamma_eff_p_rounded = f\"{gamma_eff_p:.6f}\"\n        S_rounded = f\"{S:.6f}\"\n        \n        results.extend([gamma_eff_p_rounded, S_rounded, I_N])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3519421"}, {"introduction": "理解了不稳定性增长的条件和模拟它的挑战之后，最后一步便是分析其产生的结果。这项练习聚焦于如何对模拟数据进行后处理，以量化由流体动力学不稳定性驱动的混合过程，这是评估其天体物理学意义的关键。您将亲手实现标量方差和湍动能等诊断量，从而学习如何将原始的模拟输出转化为有意义的物理测量值。[@problem_id:3519383]", "problem": "给定与开尔文-亥姆霍兹 (KH) 和瑞利-泰勒 (RT) 流相关的理想可压缩流体动力学模拟的快照。每个快照都在一个均匀网格上表示，由网格中心密度 $\\rho_i$（单位为 $\\mathrm{kg\\,m^{-3}}$）、速度分量 $u_{x,i}$ 和 $u_{y,i}$（单位为 $\\mathrm{m\\,s^{-1}}$）以及标记其中一种流体的被动标量质量分数 $Y_i$（无量纲）的数组表示。网格是均匀的，因此所有网格单元的体积相等。请考虑以下三个全局混合度量，并根据这些场计算它们：\n\n- 域上被动标量质量分数的质量加权标量方差，使用密度加权 (Favre) 平均定义。\n- 质量加权混合分数，定义为被动标量值严格介于指定容差 $\\delta$ 和 $1-\\delta$ 之间的网格单元所占的总质量分数。\n- 单位质量的湍动能 (TKE)，使用速度场的密度加权分解来定义。\n\n从质量守恒和可压缩流的密度加权平均的定义出发，结合脉动定义为与适当平均值的偏差。利用这些推导出仅依赖于 $\\rho_i$、$u_{x,i}$、$u_{y,i}$、$Y_i$ 以及用户指定的 $\\delta$ 的表达式。在推导过程中，请明确区分任何域平均、质量加权平均和脉动场。假设网格是均匀的，因此体积加权可简化为简单求和，并且在需要质量加权平均时使用密度加权。将单位质量的湍动能以 $\\mathrm{m^2\\,s^{-2}}$ 为单位表示，并四舍五入到六位小数。其他两个度量是无量纲的，也必须四舍五入到六位小数。\n\n您的程序必须实现推导出的表达式，并在以下由包含 $4$ 个网格单元的数组指定的测试用例集上进行评估：\n\n- 案例 1 (未混合，均匀速度):\n  - $\\rho = (1.0, 1.0, 1.0, 1.0)$ in $\\mathrm{kg\\,m^{-3}}$\n  - $u_x = (1.0, 1.0, 1.0, 1.0)$ and $u_y = (0.0, 0.0, 0.0, 0.0)$ in $\\mathrm{m\\,s^{-1}}$\n  - $Y = (0.0, 0.0, 1.0, 1.0)$ (dimensionless)\n  - $\\delta = 0.01$\n- 案例 2 (标量完全混合，密度可变且速度相反):\n  - $\\rho = (1.0, 2.0, 1.0, 2.0)$ in $\\mathrm{kg\\,m^{-3}}$\n  - $u_x = (1.0, -1.0, 1.0, -1.0)$ and $u_y = (0.0, 0.0, 0.0, 0.0)$ in $\\mathrm{m\\,s^{-1}}$\n  - $Y = (0.5, 0.5, 0.5, 0.5)$ (dimensionless)\n  - $\\delta = 0.01$\n- 案例 3 (部分混合界面，密度分层，剪切):\n  - $\\rho = (3.0, 3.0, 1.0, 1.0)$ in $\\mathrm{kg\\,m^{-3}}$\n  - $u_x = (0.5, 0.5, -0.5, -0.5)$ and $u_y = (0.0, 0.0, 0.0, 0.0)$ in $\\mathrm{m\\,s^{-1}}$\n  - $Y = (0.98, 0.9, 0.1, 0.02)$ (dimensionless)\n  - $\\delta = 0.05$\n\n覆盖性设计：\n- 案例 1 探究了均匀流场下具有平凡湍流度量的未混合状态。\n- 案例 2 探究了密度加权下的完全标量混合和非平凡湍动能。\n- 案例 3 探究了部分混合、非平凡标量方差以及类似 RT 初始条件下的密度分层剪切。\n\n您的程序应生成单行输出，其中包含结果，形式为以逗号分隔的各案例三元组列表，每个三元组按 $[\\text{scalar\\_variance}, \\text{mixing\\_fraction}, \\text{tke}]$ 的顺序排列。总输出必须是包含三个案例列表的单个列表，例如：\n\"[[v1,m1,k1],[v2,m2,k2],[v3,m3,k3]]\"\n所有值都必须四舍五入到六位小数，其中 TKE 的单位为 $\\mathrm{m^2\\,s^{-2}}$，其他两个为无量纲。", "solution": "该问题要求从离散的网格中心数据中，推导并计算可压缩流体动力学流动的三个诊断度量。这些度量分别是质量加权标量方差、质量加权混合分数和单位质量的湍动能。推导将从均匀网格上离散数据的密度加权 (Favre) 平均的基本定义开始。\n\n设计算域由 $N$ 个网格单元组成，索引为 $i = 1, \\dots, N$。为每个网格单元提供的量是密度 $\\rho_i$、速度分量 $u_{x,i}$ 和 $u_{y,i}$，以及被动标量质量分数 $Y_i$。由于网格是均匀的，每个网格单元具有相同的体积 $V$。网格单元 $i$ 中的质量为 $m_i = \\rho_i V$。\n\n域上的总质量为 $M_{tot} = \\sum_{i=1}^{N} m_i = \\sum_{i=1}^{N} \\rho_i V = V \\sum_{i=1}^{N} \\rho_i$。\n\n任意物理量 $\\phi$ 的质量加权平均或 Favre 平均定义为 $\\rho \\phi$ 在整个域上的积分除以总质量。对于离散网格，这变为：\n$$ \\widetilde{\\phi} = \\frac{\\sum_{i=1}^{N} \\phi_i m_i}{\\sum_{i=1}^{N} m_i} = \\frac{\\sum_{i=1}^{N} \\phi_i \\rho_i V}{\\sum_{i=1}^{N} \\rho_i V} = \\frac{\\sum_{i=1}^{N} \\rho_i \\phi_i}{\\sum_{i=1}^{N} \\rho_i} $$\n网格单元体积 $V$ 被约去，简化了表达式。此定义将用于所有必需的平均计算。\n\n### 度量 1：质量加权标量方差\n标量方差衡量标量场 $Y$ 的不均匀程度。对于可压缩流，它是使用 Favre 平均量定义的。网格单元 $i$ 中标量的脉动是局部值与 Favre 平均值之间的差：$Y_i'' = Y_i - \\widetilde{Y}$。\n\n标量 $Y$ 的 Favre 平均为：\n$$ \\widetilde{Y} = \\frac{\\sum_{i=1}^{N} \\rho_i Y_i}{\\sum_{i=1}^{N} \\rho_i} $$\n质量加权方差 $\\sigma_Y^2$ 是脉动平方 $(Y'')^2$ 的 Favre 平均：\n$$ \\sigma_Y^2 = \\widetilde{(Y'')^2} = \\widetilde{(Y - \\widetilde{Y})^2} $$\n代入 Favre 平均的定义：\n$$ \\sigma_Y^2 = \\frac{\\sum_{i=1}^{N} \\rho_i (Y_i - \\widetilde{Y})^2}{\\sum_{i=1}^{N} \\rho_i} $$\n为了计算目的，使用通过展开平方推导出的替代形式通常更稳定和高效：$\\widetilde{(Y - \\widetilde{Y})^2} = \\widetilde{Y^2 - 2Y\\widetilde{Y} + \\widetilde{Y}^2}$。根据平均算子的线性性质，这等于 $\\widetilde{Y^2} - 2\\widetilde{Y}\\widetilde{Y} + \\widetilde{Y}^2 = \\widetilde{Y^2} - (\\widetilde{Y})^2$。\n质量加权标量方差的最终离散表达式为：\n$$ \\sigma_Y^2 = \\frac{\\sum_{i=1}^{N} \\rho_i Y_i^2}{\\sum_{i=1}^{N} \\rho_i} - \\left( \\frac{\\sum_{i=1}^{N} \\rho_i Y_i}{\\sum_{i=1}^{N} \\rho_i} \\right)^2 $$\n由于 $Y_i$ 是一个无量纲的质量分数，因此该量是无量纲的。\n\n### 度量 2：质量加权混合分数\n该度量 $M_\\delta$ 量化了处于“混合”状态的总质量分数。如果一个网格单元 $i$ 的标量质量分数 $Y_i$ 严格介于容差 $\\delta$ 和 $1-\\delta$ 之间，即 $\\delta  Y_i  1 - \\delta$，则认为该网格单元是混合的。\n\n混合流体的总质量 $M_{mixed}$ 是满足此条件的所有网格单元的质量之和。\n$$ M_{mixed} = \\sum_{i \\text{ s.t. } \\delta  Y_i  1-\\delta} m_i = \\sum_{i=1}^{N} m_i \\cdot I(\\delta  Y_i  1-\\delta) $$\n其中 $I(\\cdot)$ 是指示函数，如果条件为真，则为 $1$，否则为 $0$。代入 $m_i = \\rho_i V$：\n$$ M_{mixed} = V \\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta) $$\n混合分数是混合质量与总质量之比，$M_\\delta = M_{mixed} / M_{tot}$。\n$$ M_\\delta = \\frac{V \\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta)}{V \\sum_{i=1}^{N} \\rho_i} = \\frac{\\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta)}{\\sum_{i=1}^{N} \\rho_i} $$\n该度量是一个无量纲的质量比。\n\n### 度量 3：单位质量的湍动能\n单位质量的湍动能 (TKE) $k$ 是与速度脉动相关的动能。速度场 $\\mathbf{u}$ 被分解为其 Favre 平均部分 $\\widetilde{\\mathbf{u}}$ 和其脉动部分 $\\mathbf{u}''$：$\\mathbf{u}_i = \\widetilde{\\mathbf{u}} + \\mathbf{u}_i''$。\n\nFavre 平均速度分量为：\n$$ \\widetilde{u_x} = \\frac{\\sum_{i=1}^{N} \\rho_i u_{x,i}}{\\sum_{i=1}^{N} \\rho_i} \\quad \\text{and} \\quad \\widetilde{u_y} = \\frac{\\sum_{i=1}^{N} \\rho_i u_{y,i}}{\\sum_{i=1}^{N} \\rho_i} $$\n单位质量的 TKE 定义为速度脉动大小平方的 Favre 平均值的一半：\n$$ k = \\frac{1}{2}\\widetilde{|\\mathbf{u}''|^2} = \\frac{1}{2}\\widetilde{(u_x''^2 + u_y''^2)} = \\frac{1}{2}\\left( \\widetilde{(u_x - \\widetilde{u_x})^2} + \\widetilde{(u_y - \\widetilde{u_y})^2} \\right) $$\n使用与标量相同的方差恒等式 $\\widetilde{(\\phi - \\widetilde{\\phi})^2} = \\widetilde{\\phi^2} - (\\widetilde{\\phi})^2$，我们可以将 $k$ 写为：\n$$ k = \\frac{1}{2} \\left[ \\left( \\widetilde{u_x^2} - (\\widetilde{u_x})^2 \\right) + \\left( \\widetilde{u_y^2} - (\\widetilde{u_y})^2 \\right) \\right] $$\n代入 Favre 平均的离散定义，得到最终表达式：\n$$ k = \\frac{1}{2} \\left[ \\left( \\frac{\\sum \\rho_i u_{x,i}^2}{\\sum \\rho_i} - \\left(\\frac{\\sum \\rho_i u_{x,i}}{\\sum \\rho_i}\\right)^2 \\right) + \\left( \\frac{\\sum \\rho_i u_{y,i}^2}{\\sum \\rho_i} - \\left(\\frac{\\sum \\rho_i u_{y,i}}{\\sum \\rho_i}\\right)^2 \\right) \\right] $$\n$k$ 的单位是速度的平方，即 $\\mathrm{m^2\\,s^{-2}}$。\n\n现在可以实现这些推导出的表达式，以计算给定测试用例所需的度量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes three global mix metrics for several test cases from ideal\n    compressible hydrodynamics simulations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (unmixed, uniform velocity)\n        {\n            \"rho\": np.array([1.0, 1.0, 1.0, 1.0]),\n            \"ux\": np.array([1.0, 1.0, 1.0, 1.0]),\n            \"uy\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"Y\": np.array([0.0, 0.0, 1.0, 1.0]),\n            \"delta\": 0.01\n        },\n        # Case 2 (fully mixed scalar, variable density and opposing velocities)\n        {\n            \"rho\": np.array([1.0, 2.0, 1.0, 2.0]),\n            \"ux\": np.array([1.0, -1.0, 1.0, -1.0]),\n            \"uy\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"Y\": np.array([0.5, 0.5, 0.5, 0.5]),\n            \"delta\": 0.01\n        },\n        # Case 3 (partially mixed interface, stratified density, shear)\n        {\n            \"rho\": np.array([3.0, 3.0, 1.0, 1.0]),\n            \"ux\": np.array([0.5, 0.5, -0.5, -0.5]),\n            \"uy\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"Y\": np.array([0.98, 0.9, 0.1, 0.02]),\n            \"delta\": 0.05\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        rho = case[\"rho\"]\n        ux = case[\"ux\"]\n        uy = case[\"uy\"]\n        Y = case[\"Y\"]\n        delta = case[\"delta\"]\n\n        sum_rho = np.sum(rho)\n\n        # Metric 1: Mass-weighted scalar variance\n        favre_Y = np.sum(rho * Y) / sum_rho\n        favre_Y_sq = np.sum(rho * Y**2) / sum_rho\n        scalar_variance = favre_Y_sq - favre_Y**2\n\n        # Metric 2: Mass-weighted mixing fraction\n        mixed_mask = (Y > delta)  (Y  1 - delta)\n        mixed_mass = np.sum(rho[mixed_mask])\n        mixing_fraction = mixed_mass / sum_rho if sum_rho > 0 else 0.0\n\n        # Metric 3: Turbulent Kinetic Energy per unit mass\n        favre_ux = np.sum(rho * ux) / sum_rho\n        favre_uy = np.sum(rho * uy) / sum_rho\n        favre_ux_sq = np.sum(rho * ux**2) / sum_rho\n        favre_uy_sq = np.sum(rho * uy**2) / sum_rho\n        \n        tke = 0.5 * ((favre_ux_sq - favre_ux**2) + (favre_uy_sq - favre_uy**2))\n\n        # Append results for the case\n        case_results = [\n            round(scalar_variance, 6),\n            round(mixing_fraction, 6),\n            round(tke, 6)\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "3519383"}]}