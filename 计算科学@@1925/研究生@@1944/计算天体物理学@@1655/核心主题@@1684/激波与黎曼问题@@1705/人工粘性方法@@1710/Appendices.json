{"hands_on_practices": [{"introduction": "本练习是理解人工粘性方法背后数学原理的基石。它将人工粘性这一抽象概念与总变差递减（TVD）等具体的数值稳定性要求联系起来。通过这个实践，您将为一个简单但基础的平流格式建立坚实的数学基础，理解为何需要特定量值的粘性来防止非物理振荡的产生 [@problem_id:3504913]。", "problem": "考虑一维线性平流方程，它在计算天体物理学中用作被动标量输运的模型，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\n$$\n该方程增加了一个人工粘性项以稳定陡峭梯度附近的数值振荡，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = \\epsilon\\,\\partial_{xx} u(x,t).\n$$\n假设使用间距为 $\\Delta x$ 的均匀网格和时间步长为 $\\Delta t$ 的显式单步时间积分器。考虑以下守恒型有限差分格式，其中时间推进采用前向欧拉法，平流项通量采用中心差分，粘性项通量采用二阶差分：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\n引入无量纲参数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 和 $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$。从第一性原理出发，完成以下任务：\n\n- 通过泰勒展开推导该格式的相容性（精度）条件，并以 $\\Delta t$、$\\Delta x$、$a$ 和 $\\epsilon$ 的形式确定局部截断误差中的主阶项。\n- 使用 Lax–Richtmyer 等价定理（LRET），阐明该线性常系数格式为保证在网格加密下收敛所需的稳定性要求。\n- 将总变差递减（TVD）要求映射到该线性更新的单调性约束上，并推导出对所有网格点强制施加 TVD 的关于 $\\lambda$ 和 $\\mu$ 的不等式。\n- 从这些不等式中，确定在保持相容性的前提下，保证给定离散化格式具有 TVD 行为的最小人工粘性 $\\epsilon(\\Delta x,\\Delta t)$。\n\n以 $a$ 和 $\\Delta x$ 的形式，给出一个关于最小人工粘性 $\\epsilon$ 的单一闭式表达式，不要进行任何数值代入。如果进行数值计算，$\\epsilon$ 的单位应为平方米/秒，但最终表达式中不包含单位。无需四舍五入。", "solution": "该问题陈述是有效的，因为它提出了一个计算流体力学中的标准、适定的问题，涉及对平流-扩散方程的有限差分格式进行数值分析。该问题具有科学依据，是客观且自洽的。我将按要求进行四个部分的推导。\n\n控制偏微分方程（PDE）是一维线性平流-扩散方程：\n$$\n\\partial_{t} u + a\\,\\partial_{x} u = \\epsilon\\,\\partial_{xx} u\n$$\n所给的有限差分格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n使用无量纲参数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 和 $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$，该格式可以写为：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\lambda}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\mu\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n\n首先，为了推导相容性条件和局部截断误差，我们对格式中的每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开。我们将格式重新排列为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} - \\epsilon\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = 0\n$$\n我们展开每一项，其中 $u$ 及其导数均在 $(x_j, t_n)$ 点取值：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{(u + \\Delta t\\,\\partial_t u + \\frac{\\Delta t^2}{2}\\partial_{tt} u + \\dots) - u}{\\Delta t} = \\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + O(\\Delta t^2)\n$$\n$$\n\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots) - (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u - \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots)}{2\\,\\Delta x} = \\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u + O(\\Delta x^4)\n$$\n$$\n\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots) - 2u + (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots)}{\\Delta x^2} = \\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta x^4)\n$$\n将这些展开式代入重新排列的格式中，得到截断误差 $T_j^n$：\n$$\nT_j^n = \\left(\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u\\right) + a\\left(\\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u\\right) - \\epsilon\\left(\\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u\\right) + \\dots\n$$\n$$\nT_j^n = (\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u) + \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta t^2, \\Delta x^4)\n$$\n对于 PDE 的精确解，第一项 $(\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u)$ 为零。因此，局部截断误差为：\n$$\nT_j^n = \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + \\dots\n$$\n该格式是相容的，因为当 $\\Delta t \\to 0$ 且 $\\Delta x \\to 0$ 时，$T_j^n \\to 0$。主阶误差项为 $O(\\Delta t)$ 和 $O(\\Delta x^2)$，因此该格式是时间上一阶精度，空间上二阶精度。\n\n其次，根据 Lax–Richtmyer 等价定理，对于应用于适定线性初值问题的相容格式，收敛性等价于稳定性。我们使用 von Neumann 方法分析稳定性。我们寻求形式为 $u_j^n = g^n e^{ikx_j}$ 的解，其中 $g$ 是放大因子，$k$ 是波数。将其代入格式中：\n$$\ng = 1 - \\frac{\\lambda}{2}(e^{ik\\Delta x} - e^{-ik\\Delta x}) + \\mu(e^{ik\\Delta x} - 2 + e^{-ik\\Delta x})\n$$\n使用 Euler 公式，并令 $\\theta = k\\Delta x$，我们有 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$。\n$$\ng(\\theta) = 1 - i\\lambda\\sin\\theta - 4\\mu\\sin^2(\\frac{\\theta}{2})\n$$\n稳定性条件为对所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|g| \\le 1$。\n$$\n|g|^2 = \\left(1 - 4\\mu\\sin^2(\\frac{\\theta}{2})\\right)^2 + (-\\lambda\\sin\\theta)^2 \\le 1\n$$\n$$\n1 - 8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + \\lambda^2\\sin^2\\theta \\le 1\n$$\n使用 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$，我们得到：\n$$\n-8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + 4\\lambda^2\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\n对于 $\\theta \\neq 0$，我们可以除以 $4\\sin^2(\\theta/2)  0$：\n$$\n-2\\mu + 4\\mu^2\\sin^2(\\frac{\\theta}{2}) + \\lambda^2\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\n由于 $\\cos^2(\\theta/2) = 1 - \\sin^2(\\theta/2)$，不等式变为：\n$$\n\\lambda^2 - 2\\mu + (4\\mu^2 - \\lambda^2)\\sin^2(\\frac{\\theta}{2}) \\le 0\n$$\n该不等式必须对所有 $\\sin^2(\\theta/2) \\in [0, 1]$ 成立。我们检查端点。\n在 $\\sin^2(\\theta/2) = 0$（即 $\\theta=0$）时：$\\lambda^2 - 2\\mu \\le 0 \\implies \\lambda^2 \\le 2\\mu$。\n在 $\\sin^2(\\theta/2) = 1$（即 $\\theta=\\pi$）时：$\\lambda^2 - 2\\mu + 4\\mu^2 - \\lambda^2 \\le 0 \\implies 4\\mu^2 - 2\\mu \\le 0 \\implies 2\\mu(2\\mu - 1) \\le 0$。由于 $\\mu = \\epsilon\\Delta t/\\Delta x^2 \\ge 0$，这意味着 $2\\mu - 1 \\le 0$，即 $\\mu \\le 1/2$。\n因此，稳定性要求为 $\\lambda^2 \\le 2\\mu$ 和 $\\mu \\le 1/2$。\n\n第三，我们将总变差递减（TVD）要求映射到单调性约束上。线性格式是 TVD 的一个充分条件是它是单调的，这意味着其显式更新形式中的所有系数都是非负的。我们重写格式以识别这些系数：\n$$\nu_{j}^{n+1} = \\left(\\mu - \\frac{\\lambda}{2}\\right)u_{j+1}^{n} + (1 - 2\\mu)u_{j}^{n} + \\left(\\mu + \\frac{\\lambda}{2}\\right)u_{j-1}^{n}\n$$\n系数为 $C_{j+1} = \\mu - \\lambda/2$，$C_j = 1 - 2\\mu$ 和 $C_{j-1} = \\mu + \\lambda/2$。为保证单调性，所有系数必须为非负。\n1. $C_j = 1 - 2\\mu \\ge 0 \\implies \\mu \\le 1/2$。\n2. 另外两个系数取决于 $\\lambda = a\\Delta t/\\Delta x$ 的符号。\n   情况 $a \\ge 0$ ($\\lambda \\ge 0$)：\n   $C_{j-1} = \\mu + \\lambda/2 \\ge 0$ 总是成立，因为 $\\mu, \\lambda \\ge 0$。\n   $C_{j+1} = \\mu - \\lambda/2 \\ge 0 \\implies \\lambda \\le 2\\mu$。\n   情况 $a  0$ ($\\lambda  0$)：\n   $C_{j+1} = \\mu - \\lambda/2 = \\mu + |\\lambda|/2 \\ge 0$ 总是成立。\n   $C_{j-1} = \\mu + \\lambda/2 \\ge 0 \\implies \\mu \\ge -\\lambda/2 \\implies \\mu \\ge |\\lambda|/2 \\implies |\\lambda| \\le 2\\mu$。\n在两种情况下，单调性（并因此是 TVD）的条件均为：\n$$\n|\\lambda| \\le 2\\mu \\quad \\text{和} \\quad \\mu \\le \\frac{1}{2}\n$$\n请注意，TVD 条件 $|\\lambda| \\le 2\\mu$ 比稳定性条件 $\\lambda^2 \\le 2\\mu$ 更严格，因为对前者平方得到 $\\lambda^2 \\le 4\\mu^2$，并且由于 $\\mu \\le 1/2$，有 $4\\mu^2 = 2\\mu(2\\mu) \\le 2\\mu(1) = 2\\mu$。\n\n第四，我们从这些 TVD 不等式中确定最小人工粘性 $\\epsilon$。第一个不等式是 $|\\lambda| \\le 2\\mu$。代入 $\\lambda$ 和 $\\mu$ 的定义：\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 2\\left(\\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\right)\n$$\n假设 $\\Delta t  0$ 且 $\\Delta x  0$，我们可以简化为：\n$$\n\\frac{|a|}{\\Delta x} \\le \\frac{2\\epsilon}{\\Delta x^2} \\implies |a|\\Delta x \\le 2\\epsilon\n$$\n这给出了人工粘性系数的下界：\n$$\n\\epsilon \\ge \\frac{|a|\\Delta x}{2}\n$$\n因此，能满足此条件的最小人工粘性为 $\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}$。为了使该选择能保证 TVD，第二个条件 $\\mu \\le 1/2$ 也必须可以满足。代入 $\\epsilon = \\epsilon_{\\min}$：\n$$\n\\mu = \\frac{\\epsilon_{\\min}\\Delta t}{\\Delta x^2} = \\frac{(|a|\\Delta x/2)\\Delta t}{\\Delta x^2} = \\frac{|a|\\Delta t}{2\\Delta x} = \\frac{|\\lambda|}{2}\n$$\n条件 $\\mu \\le 1/2$ 变为 $|\\lambda|/2 \\le 1/2$，简化后为 $|\\lambda| \\le 1$。这是平流格式的标准 Courant-Friedrichs-Lewy (CFL) 条件。因此，只有当选择的时间步长满足 $|\\lambda| = |a|\\Delta t / \\Delta x \\le 1$ 时，TVD 格式才可能实现。假设该格式在此条件下运行，强制实现 TVD 行为所需的最小人工粘性由第一个条件中的等式给出。在网格加密的极限下，这个 $\\epsilon$ 的选择与原始平流方程是一致的，因为 $\\epsilon \\propto \\Delta x$ 意味着当 $\\Delta x \\to 0$ 时 $\\epsilon \\to 0$。\n\n因此，最小人工粘性 $\\epsilon$ 用 $a$ 和 $\\Delta x$ 表示为：\n$$\n\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}\n$$", "answer": "$$\n\\boxed{\\frac{|a|\\Delta x}{2}}\n$$", "id": "3504913"}, {"introduction": "在掌握了基本理论之后，本练习将探讨一个关键的权衡问题。虽然人工粘性对于数值稳定性至关重要，但它也可能抑制真实的物理不稳定性。本练习以经典的开尔文-亥姆霍兹不稳定性为例，量化分析人工粘性如何阻尼物理增长，从而促使我们思考如何在数值稳健性与物理保真度之间取得平衡 [@problem_id:3504882]。", "problem": "考虑一个二维平面剪切流，该流在 $x$ 方向上是均匀的，在 $y$ 方向上是分段常数的，在 $y = 0$ 的界面两侧具有相等的质量密度 $ \\rho $。基本流为 $ \\mathbf{u}_0(y) = (U_0(y), 0) $，其中对于 $ y > 0 $，$ U_0(y) = +\\Delta U/2 $，对于 $ y  0 $，$ U_0(y) = -\\Delta U/2 $，其中 $ \\Delta U > 0 $ 是跨界面的速度跳跃。热力学压力 $ p $ 是均匀的，声速 $ c_s $ 是恒定的。为了稳定激波和控制数值振荡，通常会添加程序层级的人工粘性（AV），我们在这里将其理想化为一个具有恒定系数 $ \\nu_{\\mathrm{av}} $ 的运动扩散算子，它在动量方程中贡献一个项 $ \\rho \\nu_{\\mathrm{av}} \\nabla^2 \\mathbf{u} $。\n\n从增加了人工粘性的可压缩欧拉方程出发，\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0,\n$$\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}\\mathbf{u}) + \\nabla p = \\nabla \\cdot \\boldsymbol{\\tau}_{\\mathrm{av}},\n$$\n其中\n$$\n\\boldsymbol{\\tau}_{\\mathrm{av}} \\approx \\rho \\nu_{\\mathrm{av}} \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} \\right),\n$$\n考虑一个与 $x$ 轴对齐、波数为 $k$、时间依赖性为 $ \\propto e^{\\gamma t} $ 的小振幅界面扰动，其中 $ \\gamma $ 是扰动振幅的复时间增长率。在两个等密度流的无粘性极限下，开尔文-亥姆霍兹不稳定性（KHI）色散关系为涡面界面产生了一个纯增长模式，其增长率为\n$$\n\\gamma_{\\mathrm{inv}}(k) = \\frac{|\\Delta U|}{2} \\, k,\n$$\n对于 $ k > 0 $。当存在人工粘性并将其视为一个恒定的运动粘性 $ \\nu_{\\mathrm{av}} $ 时，对于傅里叶模式 $ \\propto e^{i k x} $ 的线性化动量方程引入了一个扩散阻尼贡献，其尺度与 $ \\nu_{\\mathrm{av}} k^2 $ 相当。在小马赫数和等密度的假设下，围绕基态的第一性原理线性化导出了一个形式如下的振幅方程\n$$\n\\frac{dA}{dt} = \\gamma(k, \\nu_{\\mathrm{av}}) \\, A,\n$$\n其净增长率为\n$$\n\\gamma(k, \\nu_{\\mathrm{av}}) = \\gamma_{\\mathrm{inv}}(k) - \\nu_{\\mathrm{av}} k^2,\n$$\n并有闭式解\n$$\nA(t) = A_0 \\, \\exp\\left( \\gamma(k, \\nu_{\\mathrm{av}}) \\, t \\right),\n$$\n其中 $ A_0 $ 是时间 $ t = 0 $ 时的初始振幅。中和增长（临界稳定性）的人工粘性值由 $ \\gamma(k, \\nu_{\\mathrm{crit}}) = 0 $ 定义，这给出了临界系数\n$$\n\\nu_{\\mathrm{crit}}(k) = \\frac{\\gamma_{\\mathrm{inv}}(k)}{k^2} = \\frac{|\\Delta U|}{2 k}.\n$$\n\n您的任务是为指定的物理上合理的参数集测试套件，对这些关系进行数值实现，以评估开尔文-亥姆霍兹不稳定性增长与人工粘性阻尼之间的平衡。\n\n要求：\n- 如上所述，从线性化控制方程推导出振幅演化方程，明确识别出剪切引起的增长贡献和人工粘性引起的阻尼贡献，并获得 $ \\gamma(k, \\nu_{\\mathrm{av}}) $ 和 $ A(t) $。\n- 实现一个程序，对于每个测试用例，计算：\n    $ \\gamma(k, \\nu_{\\mathrm{av}}) $、$ A(t_{\\mathrm{end}}) $ 和 $ \\nu_{\\mathrm{crit}}(k) $。\n- 最终输出格式必须是单行文本，包含一个逗号分隔的扁平列表，其值按 $ [\\gamma_1, A_1, \\nu_{\\mathrm{crit},1}, \\gamma_2, A_2, \\nu_{\\mathrm{crit},2}, \\ldots] $ 的顺序排列，并用方括号括起来。\n\n单位与角度约定：\n- 使用国际单位制：$ \\Delta U $ 单位为 $ \\mathrm{m/s} $，$ k $ 单位为 $ \\mathrm{m}^{-1} $，$ \\nu_{\\mathrm{av}} $ 单位为 $ \\mathrm{m}^2/\\mathrm{s} $，$ t $ 单位为 $ \\mathrm{s} $。\n- 振幅 $ A $ 是无量纲的。\n- 不涉及角度。\n\n测试套件：\n- 用例 $ 1 $ (理想情况，净增长): $ \\Delta U = 1000 \\, \\mathrm{m/s} $, $ k = 6.0 \\times 10^{-6} \\, \\mathrm{m}^{-1} $, $ \\nu_{\\mathrm{av}} = 1.0 \\times 10^{7} \\, \\mathrm{m}^2/\\mathrm{s} $, $ t_{\\mathrm{end}} = 1000 \\, \\mathrm{s} $, $ A_0 = 1.0 \\times 10^{-3} $。\n- 用例 $ 2 $ (边界情况，临界稳定): $ \\Delta U = 500 \\, \\mathrm{m/s} $, $ k = 1.0 \\times 10^{-5} \\, \\mathrm{m}^{-1} $, $ \\nu_{\\mathrm{av}} = 2.5 \\times 10^{7} \\, \\mathrm{m}^2/\\mathrm{s} $, $ t_{\\mathrm{end}} = 2000 \\, \\mathrm{s} $, $ A_0 = 1.0 \\times 10^{-4} $。\n- 用例 $ 3 $ (边缘情况，强阻尼): $ \\Delta U = 300 \\, \\mathrm{m/s} $, $ k = 2.0 \\times 10^{-5} \\, \\mathrm{m}^{-1} $, $ \\nu_{\\mathrm{av}} = 5.0 \\times 10^{8} \\, \\mathrm{m}^2/\\mathrm{s} $, $ t_{\\mathrm{end}} = 500 \\, \\mathrm{s} $, $ A_0 = 1.0 \\times 10^{-2} $。\n- 用例 $ 4 $ (边缘情况，波数极小且时间长): $ \\Delta U = 1000 \\, \\mathrm{m/s} $, $ k = 1.0 \\times 10^{-8} \\, \\mathrm{m}^{-1} $, $ \\nu_{\\mathrm{av}} = 1.0 \\times 10^{8} \\, \\mathrm{m}^2/\\mathrm{s} $, $ t_{\\mathrm{end}} = 1.0 \\times 10^{6} \\, \\mathrm{s} $, $ A_0 = 1.0 \\times 10^{-6} $。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，结果按 $ [\\gamma_1, A_1, \\nu_{\\mathrm{crit},1}, \\gamma_2, A_2, \\nu_{\\mathrm{crit},2}, \\gamma_3, A_3, \\nu_{\\mathrm{crit},3}, \\gamma_4, A_4, \\nu_{\\mathrm{crit},4}] $ 的顺序用方括号括起来。", "solution": "本问题要求分析剪切界面上的开尔文-亥姆霍兹不稳定性（KHI），包括人工粘性项的稳定效应。我们必须首先从控制方程中正式推导出给定的增长率和振幅演化方程，然后实现这些关系以计算给定测试用例集的结果。\n\n出发点是增加了人工粘性应力张量 $\\boldsymbol{\\tau}_{\\mathrm{av}}$ 的可压缩欧拉方程组。控制方程是质量守恒和动量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n$$\n\\frac{\\partial (\\rho \\mathbf{u})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}\\mathbf{u}) + \\nabla p = \\nabla \\cdot \\boldsymbol{\\tau}_{\\mathrm{av}}\n$$\n其中 $\\rho$ 是质量密度，$\\mathbf{u}$ 是流体速度，$p$ 是热力学压力。人工粘性应力张量由 $\\boldsymbol{\\tau}_{\\mathrm{av}} \\approx \\rho \\nu_{\\mathrm{av}} ( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} )$ 给出，其中 $\\nu_{\\mathrm{av}}$ 是人工粘性的恒定运动系数。\n\n我们通过将流场变量分解为稳态基态（下标 $0$）和小扰动（前缀 $\\delta$）来进行线性稳定性分析：\n$\\rho = \\rho_0 + \\delta\\rho$，$\\mathbf{u} = \\mathbf{u}_0 + \\delta\\mathbf{u}$，以及 $p = p_0 + \\delta p$。基态由恒定密度 $\\rho_0$、恒定压力 $p_0$ 和剪切流 $\\mathbf{u}_0(y) = (U_0(y), 0)$ 定义，其中 $U_0(y) = \\mathrm{sgn}(y) \\frac{\\Delta U}{2}$。\n\n将这些分解代入动量方程，并仅保留扰动的一次项，我们得到线性化的动量方程。对于恒定的 $\\rho_0$：\n$$\n\\rho_0 \\left( \\frac{\\partial \\delta\\mathbf{u}}{\\partial t} + (\\mathbf{u}_0 \\cdot \\nabla) \\delta\\mathbf{u} + (\\delta\\mathbf{u} \\cdot \\nabla) \\mathbf{u}_0 \\right) + \\nabla \\delta p = \\nabla \\cdot \\boldsymbol{\\tau}_{\\mathrm{av}, \\text{lin}}\n$$\n线性化的人工粘性应力张量是 $\\boldsymbol{\\tau}_{\\mathrm{av}, \\text{lin}} = \\rho_0 \\nu_{\\mathrm{av}} ( \\nabla \\delta\\mathbf{u} + (\\nabla \\delta\\mathbf{u})^{\\top} )$。该张量的散度给出粘性力。如问题中所述，此项通常理想化为 $\\rho_0 \\nu_{\\mathrm{av}} \\nabla^2 \\mathbf{u}$。对于扰动，这变为 $\\rho_0 \\nu_{\\mathrm{av}} \\nabla^2 \\delta\\mathbf{u}$。\n\n我们考虑扰动的单个傅里叶模式，与 $e^{\\gamma t + i k x}$ 成正比，其中 $\\gamma$ 是复增长率，$k$ 是 $x$ 方向的波数。通过这种假设，偏导数变换为 $\\frac{\\partial}{\\partial t} \\to \\gamma$ 和 $\\frac{\\partial}{\\partial x} \\to ik$。粘性项 $\\nu_{\\mathrm{av}} \\nabla^2 \\delta\\mathbf{u} = \\nu_{\\mathrm{av}} (\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}) \\delta\\mathbf{u}$ 包含来自 $x$ 导数的贡献：$\\nu_{\\mathrm{av}} (ik)^2 \\delta\\mathbf{u} = -\\nu_{\\mathrm{av}} k^2 \\delta\\mathbf{u}$。在薄界面（涡面）近似中，$y$ 导数的贡献可能次于波数 $k$ 处的主要阻尼效应。应用傅里叶分解后，线性化方程变为关于扰动振幅的 $y$ 的常微分方程组。\n\n问题通过提供关键结果简化了完整的推导过程，我们现在将其与物理联系起来。扰动振幅 $A$ 的演化由以下形式的方程控制：\n$$\n\\frac{dA}{dt} = \\gamma(k, \\nu_{\\mathrm{av}}) A\n$$\n净增长率 $\\gamma$ 是 competing effects 的总和：\n1. KHI增长驱动，$\\gamma_{\\mathrm{inv}}(k)$，它来自 $(\\mathbf{u}_0 \\cdot \\nabla) \\delta\\mathbf{u}$、$(\\delta\\mathbf{u} \\cdot \\nabla) \\mathbf{u}_0$ 和 $\\nabla \\delta p$ 项。对于密度相等的涡面，完整的稳定性分析得出 $\\gamma_{\\mathrm{inv}}(k) = \\frac{|\\Delta U|}{2} k$。该项代表由速度剪切驱动的不稳定增长。\n2. 粘性阻尼，它来自人工粘性项。如上所示，算子 $\\nu_{\\mathrm{av}} \\nabla^2$ 对增长率贡献一个与 $-\\nu_{\\mathrm{av}} k^2$ 成比例的项。\n\n结合这两种效应，净增长率由线性叠加给出：\n$$\n\\gamma(k, \\nu_{\\mathrm{av}}) = \\gamma_{\\mathrm{inv}}(k) - \\nu_{\\mathrm{av}} k^2 = \\frac{|\\Delta U|}{2} k - \\nu_{\\mathrm{av}} k^2\n$$\n该方程明确地分开了剪切引起的增长贡献（第一项）和人工粘性引起的阻尼贡献（第二项）。\n\n振幅演化方程是一阶线性常微分方程。对于 $t=0$ 时的初始振幅 $A_0$，我们可以直接积分：\n$$\n\\int_{A_0}^{A(t)} \\frac{dA}{A} = \\int_0^t \\gamma(k, \\nu_{\\mathrm{av}}) dt'\n$$\n$$\n\\ln\\left(\\frac{A(t)}{A_0}\\right) = \\gamma(k, \\nu_{\\mathrm{av}}) t\n$$\n求解 $A(t)$ 得到扰动振幅随时间演化的闭式解：\n$$\nA(t) = A_0 \\exp\\left( \\gamma(k, \\nu_{\\mathrm{av}}) t \\right)\n$$\n\n最后，我们确定临界稳定性的条件，此时不稳定性的增长与粘性阻尼完全平衡。这发生在净增长率为零时，即 $\\gamma(k, \\nu_{\\mathrm{crit}}) = 0$。实现这一点的的人工粘性系数值表示为 $\\nu_{\\mathrm{crit}}(k)$。\n$$\n\\frac{|\\Delta U|}{2} k - \\nu_{\\mathrm{crit}}(k) k^2 = 0\n$$\n对于 $k  0$，求解 $\\nu_{\\mathrm{crit}}(k)$：\n$$\n\\nu_{\\mathrm{crit}}(k) = \\frac{|\\Delta U| k}{2 k^2} = \\frac{|\\Delta U|}{2 k}\n$$\n这个临界系数表示在给定波数 $k$ 下完全抑制 KHI 所需的最小人工粘性量。\n\n我们现在将这些公式应用于指定的测试用例。\n\n用例 $1$：$\\Delta U = 1000 \\, \\mathrm{m/s}$，$k = 6.0 \\times 10^{-6} \\, \\mathrm{m}^{-1}$，$\\nu_{\\mathrm{av}} = 1.0 \\times 10^{7} \\, \\mathrm{m}^2/\\mathrm{s}$，$t_{\\mathrm{end}} = 1000 \\, \\mathrm{s}$，$A_0 = 1.0 \\times 10^{-3}$。\n- $\\gamma = \\frac{1000}{2}(6 \\times 10^{-6}) - (1 \\times 10^7)(6 \\times 10^{-6})^2 = 0.003 - 0.00036 = 2.64 \\times 10^{-3} \\, \\mathrm{s}^{-1}$。\n- $A(1000) = 10^{-3} \\exp(2.64 \\times 10^{-3} \\times 1000) = 10^{-3} \\exp(2.64) \\approx 0.013997$。\n- $\\nu_{\\mathrm{crit}} = \\frac{1000}{2(6 \\times 10^{-6})} \\approx 8.333 \\times 10^7 \\, \\mathrm{m}^2/\\mathrm{s}$。\n\n用例 $2$：$\\Delta U = 500 \\, \\mathrm{m/s}$，$k = 1.0 \\times 10^{-5} \\, \\mathrm{m}^{-1}$，$\\nu_{\\mathrm{av}} = 2.5 \\times 10^{7} \\, \\mathrm{m}^2/\\mathrm{s}$，$t_{\\mathrm{end}} = 2000 \\, \\mathrm{s}$，$A_0 = 1.0 \\times 10^{-4}$。\n- $\\gamma = \\frac{500}{2}(10^{-5}) - (2.5 \\times 10^7)(10^{-5})^2 = 0.0025 - 0.0025 = 0 \\, \\mathrm{s}^{-1}$。\n- $A(2000) = 10^{-4} \\exp(0 \\times 2000) = 10^{-4}$。\n- $\\nu_{\\mathrm{crit}} = \\frac{500}{2(10^{-5})} = 2.5 \\times 10^7 \\, \\mathrm{m}^2/\\mathrm{s}$。\n\n用例 $3$：$\\Delta U = 300 \\, \\mathrm{m/s}$，$k = 2.0 \\times 10^{-5} \\, \\mathrm{m}^{-1}$，$\\nu_{\\mathrm{av}} = 5.0 \\times 10^{8} \\, \\mathrm{m}^2/\\mathrm{s}$，$t_{\\mathrm{end}} = 500 \\, \\mathrm{s}$，$A_0 = 1.0 \\times 10^{-2}$。\n- $\\gamma = \\frac{300}{2}(2 \\times 10^{-5}) - (5 \\times 10^8)(2 \\times 10^{-5})^2 = 0.003 - 0.2 = -0.197 \\, \\mathrm{s}^{-1}$。\n- $A(500) = 10^{-2} \\exp(-0.197 \\times 500) = 10^{-2} \\exp(-98.5) \\approx 2.505 \\times 10^{-45}$。\n- $\\nu_{\\mathrm{crit}} = \\frac{300}{2(2 \\times 10^{-5})} = 7.5 \\times 10^6 \\, \\mathrm{m}^2/\\mathrm{s}$。\n\n用例 $4$：$\\Delta U = 1000 \\, \\mathrm{m/s}$，$k = 1.0 \\times 10^{-8} \\, \\mathrm{m}^{-1}$，$\\nu_{\\mathrm{av}} = 1.0 \\times 10^{8} \\, \\mathrm{m}^2/\\mathrm{s}$，$t_{\\mathrm{end}} = 1.0 \\times 10^{6} \\, \\mathrm{s}$，$A_0 = 1.0 \\times 10^{-6}$。\n- $\\gamma = \\frac{1000}{2}(10^{-8}) - (10^8)(10^{-8})^2 = 5 \\times 10^{-6} - 10^{-8} = 4.99 \\times 10^{-6} \\, \\mathrm{s}^{-1}$。\n- $A(10^6) = 10^{-6} \\exp(4.99 \\times 10^{-6} \\times 10^6) = 10^{-6} \\exp(4.99) \\approx 1.469 \\times 10^{-4}$。\n- $\\nu_{\\mathrm{crit}} = \\frac{1000}{2(10^{-8})} = 5 \\times 10^{10} \\, \\mathrm{m}^2/\\mathrm{s}$。\n\n现在将以编程方式实现这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the KHI growth rate, final amplitude, and critical viscosity\n    for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_U, k, nu_av, t_end, A_0)\n    # Units are SI: m/s, m^-1, m^2/s, s. A_0 is dimensionless.\n    test_cases = [\n        # Case 1 (happy path, net growth)\n        (1000.0, 6.0e-6, 1.0e7, 1000.0, 1.0e-3),\n        # Case 2 (boundary, marginal stability)\n        (500.0, 1.0e-5, 2.5e7, 2000.0, 1.0e-4),\n        # Case 3 (edge, strong damping)\n        (300.0, 2.0e-5, 5.0e8, 500.0, 1.0e-2),\n        # Case 4 (edge, very small wavenumber with long time)\n        (1000.0, 1.0e-8, 1.0e8, 1.0e6, 1.0e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_U, k, nu_av, t_end, A_0 = case\n\n        # Calculate the inviscid growth rate (Kelvin-Helmholtz instability drive)\n        # gamma_inv = (|Delta U| / 2) * k\n        gamma_inv = (abs(delta_U) / 2.0) * k\n\n        # Calculate the damping from artificial viscosity\n        # damping_rate = nu_av * k^2\n        damping_rate = nu_av * k**2\n\n        # Calculate the net growth rate\n        # gamma = gamma_inv - damping_rate\n        gamma = gamma_inv - damping_rate\n\n        # Calculate the amplitude at time t_end\n        # A(t) = A_0 * exp(gamma * t)\n        A_t_end = A_0 * np.exp(gamma * t_end)\n\n        # Calculate the critical viscosity for marginal stability (gamma = 0)\n        # nu_crit = |Delta U| / (2 * k)\n        nu_crit = abs(delta_U) / (2.0 * k)\n        \n        # Append the results for this case to the main list\n        results.extend([gamma, A_t_end, nu_crit])\n\n    # Final print statement in the exact required format.\n    # The format is a single line: [val1,val2,val3,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3504882"}]}