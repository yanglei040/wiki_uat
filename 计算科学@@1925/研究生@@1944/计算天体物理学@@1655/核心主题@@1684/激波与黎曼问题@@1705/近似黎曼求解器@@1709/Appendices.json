{"hands_on_practices": [{"introduction": "在为欧拉方程等双曲系统构建黎曼求解器时，首要任务是理解信息的传播方式，这由系统的特征波速所决定。本练习 [@problem_id:3504120] 将引导您推导和计算这些基础速度。掌握这些速度不仅是揭示黎曼问题解结构的关键，也是通过 Courant–Friedrichs–Lewy (CFL) 条件估算稳定时间步长的必要前提。", "problem": "考虑无粘、可压缩理想气体的一维欧拉方程，\n$$\n\\partial_t U + \\partial_x F(U) = 0,\n$$\n其中守恒变量为 $U = (\\rho, \\rho u, E)^{\\top}$，通量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$，并通过理想气体状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 闭合。该系统是双曲型的，关于常态的微小扰动会沿着特征场传播。根据该双曲结构和理想气体的热力学，推导出一维欧拉系统的特征波速，用原始变量 $(\\rho, u, p)$ 和绝热指数 $\\gamma$ 表示，然后为给定的左右初始状态计算这些速度\n$$\nU_L = (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0), \\quad U_R = (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1),\n$$\n其中 $\\gamma = 1.4$。利用这些结果，确定在 $t = 0$ 时刻用于 Courant–Friedrichs–Lewy (CFL) 时间步长估计的最大信号速度，该速度定义为初始存在于域中的所有特征速度的最大绝对值。在与给定状态一致的无量纲单位下进行计算。将所有数值结果四舍五入至六位有效数字。最终答案必须依次列出左状态的三个特征速度、右状态的三个特征速度以及最大信号速度，并以单行矩阵的形式给出。最终方框内的答案不应包含任何物理单位。", "solution": "该问题提法恰当，具有科学依据，并包含了获得唯一解所需的所有信息。无粘理想气体的一维欧拉方程是流体动力学中的一个标准模型。任务要求从基本方程组推导出特征波速，然后将此结果应用于给定的初始条件。因此，该问题是有效的。\n\n一维欧拉方程以守恒律形式给出：\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\n其中 $U = (\\rho, \\rho u, E)^{\\top}$ 是守恒变量（密度、动量、总能量）的向量，而 $F(U) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$ 是通量向量。该系统通过理想气体状态方程 $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$ 闭合。\n\n这个双曲系统的特征速度是雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 的特征值。为了求出这些特征值，更方便的做法是首先用原始变量 $W = (\\rho, u, p)^{\\top}$ 来表示欧拉方程。得到的准线性系统是 $\\partial_t W + \\tilde{A}(W) \\partial_x W = 0$，其中矩阵 $\\tilde{A}(W)$ 与 $A(U)$ 具有相同的特征值。\n\n欧拉方程的原始变量形式推导如下：\n1.  **连续性方程**：\n    从 $\\partial_t \\rho + \\partial_x(\\rho u) = 0$ 开始，我们应用乘法法则：\n    $$\n    \\partial_t \\rho + u \\partial_x \\rho + \\rho \\partial_x u = 0\n    $$\n\n2.  **动量方程**：\n    从 $\\partial_t(\\rho u) + \\partial_x(\\rho u^2 + p) = 0$ 开始，我们得到：\n    $$\n    \\rho(\\partial_t u + u \\partial_x u) + \\partial_x p = 0\n    $$\n\n3.  **能量方程**：\n    对于经历绝热过程的理想气体，物理量 $p/\\rho^\\gamma$ 沿着流体流线是守恒的。这导出了方程：\n    $$\n    \\partial_t p + u \\partial_x p + \\gamma p \\partial_x u = 0\n    $$\n\n这三个方程可以写成矩阵形式：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nu  \\rho  0 \\\\\n0  u  1/\\rho \\\\\n0  \\gamma p  u\n\\end{pmatrix}\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n特征波速 $\\lambda$ 是矩阵 $\\tilde{A}(W)$ 的特征值：\n$$\n\\tilde{A}(W) = \\begin{pmatrix}\nu  \\rho  0 \\\\\n0  u  1/\\rho \\\\\n0  \\gamma p  u\n\\end{pmatrix}\n$$\n我们求解特征方程 $\\det(\\tilde{A} - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix}\nu - \\lambda  \\rho  0 \\\\\n0  u - \\lambda  1/\\rho \\\\\n0  \\gamma p  u - \\lambda\n\\end{pmatrix} = (u - \\lambda) \\left[ (u - \\lambda)^2 - (\\gamma p)(1/\\rho) \\right] = 0\n$$\n该方程产生三个特征值：\n$$\n\\lambda_1 = u, \\quad (u - \\lambda)^2 = \\frac{\\gamma p}{\\rho}\n$$\n第二部分给出 $u - \\lambda = \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n项 $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$ 是绝热声速。\n因此，三个特征波速为：\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\n\n现在，我们为给定的左 ($L$) 和右 ($R$) 初始状态计算这些速度，其中 $\\gamma = 1.4$。\n\n**对于左状态：** $U_L \\implies (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0)$。\n左状态的声速为：\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.1832159566\n$$\n四舍五入至六位有效数字，$c_L \\approx 1.18322$。\n左状态的特征速度为：\n$$\n\\lambda_{1,L} = u_L - c_L = 0.0 - 1.18322 = -1.18322\n$$\n$$\n\\lambda_{2,L} = u_L = 0.0\n$$\n$$\n\\lambda_{3,L} = u_L + c_L = 0.0 + 1.18322 = 1.18322\n$$\n\n**对于右状态：** $U_R \\implies (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1)$。\n右状态的声速为：\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(0.1)}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12} \\approx 1.0583005244\n$$\n四舍五入至六位有效数字，$c_R \\approx 1.05830$。\n右状态的特征速度为：\n$$\n\\lambda_{1,R} = u_R - c_R = 0.0 - 1.05830 = -1.05830\n$$\n$$\n\\lambda_{2,R} = u_R = 0.0\n$$\n$$\n\\lambda_{3,R} = u_R + c_R = 0.0 + 1.05830 = 1.05830\n$$\n\n**最大信号速度：**\n用于CFL条件的最大信号速度 $S_{\\text{max}}$ 是初始存在的所有特征速度中的最大绝对值。\n$$\nS_{\\text{max}} = \\max(|\\lambda_{1,L}|, |\\lambda_{2,L}|, |\\lambda_{3,L}|, |\\lambda_{1,R}|, |\\lambda_{2,R}|, |\\lambda_{3,R}|)\n$$\n这些速度的绝对值集合是 $\\{|-1.18322|, |0.0|, |1.18322|, |-1.05830|, |0.0|, |1.05830|\\}$，即 $\\{1.18322, 0.0, 1.05830\\}$。\n这些值的最大值为：\n$$\nS_{\\text{max}} = 1.18322\n$$\n这对应于最快波的速率，即声波在左侧静止流体中传播的速度。\n\n最终答案要求一个行矩阵，其中包含左状态的三个速度、右状态的三个速度以及最大信号速度，所有数值均四舍五入至六位有效数字。\n这些值为：\n-   左侧速度：$-1.18322, 0.0, 1.18322$\n-   右侧速度：$-1.05830, 0.0, 1.05830$\n-   最大信号速度：$1.18322$", "answer": "$$\n\\boxed{\\begin{pmatrix} -1.18322  0.0  1.18322  -1.05830  0.0  1.05830  1.18322 \\end{pmatrix}}\n$$", "id": "3504120"}, {"introduction": "在确定了特征波速后，我们便可以着手构建一个近似黎曼求解器。Rusanov 求解器 [@problem_id:3504119] 提供了一种简单而稳健的方案：它对左右两边的物理通量进行平均，并引入一个与最大信号速度成正比的数值耗散项。这项练习揭示了许多近似求解器的核心思想，即如何依据物理波速引入数值粘性以确保方案的稳定性。", "problem": "考虑守恒形式的一维理想气体欧拉方程，其状态向量为 $U = (\\rho, m, E)$，其中 $\\rho$ 是质量密度，$m = \\rho u$ 是动量密度，$E$ 是总能量密度。相应的通量函数为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$，其中 $p$ 是气体压力，$u$ 是流体速度。理想气体的状态方程为 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$，绝热声速为 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。在 Rusanov（局部 Lax–Friedrichs）近似黎曼求解器中，界面上的数值通量是通过对左右状态的物理通量进行平均，并增加一个与最大特征速度成正比的耗散项来构建的。\n\n您正在模拟一个绝热指数为 $\\gamma = \\frac{5}{3}$ 的可压缩天体物理流。在某个单元界面处，左、右原始状态（密度、速度、压力）由 $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$ 和 $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = \\left(0.5, -1, 0.5\\right)$ 给出。将这些元组视为原始变量，并在必要时将其转换为守恒形式。使用 Rusanov 近似黎曼求解器的标准定义，计算界面处的数值通量，并报告通量向量的三个分量（质量通量、动量通量和能量通量）。请将最终答案表示为包含这三个分量的单个行向量。结果请以精确解析形式给出，不要四舍五入。无需单位。", "solution": "用户提供了一个来自计算天体物理学的问题，涉及使用 Rusanov 近似黎曼求解器计算数值通量。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **系统：** 守恒形式的一维欧拉方程。\n- **状态向量：** $U = (\\rho, m, E)$，其中 $\\rho$ 是质量密度，$m = \\rho u$ 是动量密度，$E$ 是总能量密度。\n- **通量函数：** $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$，其中 $u$ 是速度，$p$ 是压力。\n- **状态方程（理想气体）：** $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$。\n- **绝热声速：** $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n- **数值方法：** Rusanov（局部 Lax–Friedrichs）近似黎曼求解器。数值通量 $F^*$ 定义为 $F^* = \\frac{1}{2}[F(U_L) + F(U_R)] - \\frac{1}{2}S_{\\text{max}}[U_R - U_L]$，其中 $S_{\\text{max}}$ 是最大特征速度。\n- **绝热指数：** $\\gamma = \\frac{5}{3}$。\n- **左侧原始状态：** $(\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$。\n- **右侧原始状态：** $(\\rho_{R}, u_{R}, p_{R}) = (0.5, -1, 0.5)$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础：** 该问题基于气体动力学的欧拉方程、理想气体定律和 Rusanov 通量格式，这些都是计算流体动力学和计算天体物理学中标准且成熟的概念。这在科学上是合理的。\n- **适定性：** 问题提供了所有必要的信息：控制方程、状态方程、具体的数值格式、绝热指数以及初始的左右状态。这些输入足以计算出唯一、稳定且有意义的数值通量向量。\n- **客观性：** 问题陈述完全由清晰、精确、客观的数学和物理定义及数据构成。没有主观或模糊的术语。\n- **缺陷清单：**\n    1.  **科学上不合理：** 无。\n    2.  **非形式化/不相关：** 该问题是近似黎曼求解器主题下的一个形式化、典型的例子。\n    3.  **不完整/矛盾：** 所有必要的数据都已提供且自洽。\n    4.  **不切实际/不可行：** 在归一化的情况下，状态的数值在物理上是合理的。\n    5.  **不适定/结构不良：** 该问题是适定的。\n    6.  **琐碎/同义反复：** 计算虽然直接，但涉及多个非平凡的步骤，需要对底层物理和数值方法有扎实的理解。\n    7.  **外部可验证性：** 结果在数学上是可验证的。\n\n**第3步：结论与行动**\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解答\n\n在左状态 $U_L$ 和右状态 $U_R$ 之间的界面上，Rusanov 数值通量 $F^*$ 由以下公式给出：\n$$F^*(U_L, U_R) = \\frac{1}{2} [F(U_L) + F(U_R)] - \\frac{1}{2} S_{\\text{max}} [U_R - U_L]$$\n其中 $F(U)$ 是物理通量，$U$ 是守恒变量向量，$S_{\\text{max}}$ 是界面处的最大信号速度。计算过程分为四个步骤。\n\n**1. 将原始变量转换为守恒变量**\n守恒变量向量为 $U = (\\rho, m, E) = (\\rho, \\rho u, E)$。总能量密度 $E$ 通过状态方程与原始变量相关联：\n$$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$$\n已知 $\\gamma = \\frac{5}{3}$，则 $\\gamma-1 = \\frac{2}{3}$。\n\n对于左状态 $U_L$，其 $(\\rho_L, u_L, p_L) = (1, 2, 1)$：\n- 质量密度: $\\rho_L = 1$。\n- 动量密度: $m_L = \\rho_L u_L = (1)(2) = 2$。\n- 总能量密度: $E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{\\frac{2}{3}} + \\frac{1}{2}(1)(2^2) = \\frac{3}{2} + 2 = \\frac{7}{2}$。\n因此，左状态的守恒向量是 $U_L = (1, 2, \\frac{7}{2})$。\n\n对于右状态 $U_R$，其 $(\\rho_R, u_R, p_R) = (0.5, -1, 0.5) = (\\frac{1}{2}, -1, \\frac{1}{2})$：\n- 质量密度: $\\rho_R = \\frac{1}{2}$。\n- 动量密度: $m_R = \\rho_R u_R = (\\frac{1}{2})(-1) = -\\frac{1}{2}$。\n- 总能量密度: $E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{\\frac{1}{2}}{\\frac{2}{3}} + \\frac{1}{2}(\\frac{1}{2})(-1)^2 = \\frac{3}{4} + \\frac{1}{4} = 1$。\n因此，右状态的守恒向量是 $U_R = (\\frac{1}{2}, -\\frac{1}{2}, 1)$。\n\n**2. 计算物理通量**\n物理通量向量是 $F(U) = (\\rho u, \\rho u^2+p, u(E+p))$。\n\n对于左状态 $F(U_L)$：\n- 质量通量: $\\rho_L u_L = 2$。\n- 动量通量: $\\rho_L u_L^2 + p_L = (1)(2^2) + 1 = 5$。\n- 能量通量: $u_L (E_L + p_L) = 2(\\frac{7}{2} + 1) = 2(\\frac{9}{2}) = 9$。\n因此，左状态的通量向量是 $F(U_L) = (2, 5, 9)$。\n\n对于右状态 $F(U_R)$：\n- 质量通量: $\\rho_R u_R = -\\frac{1}{2}$。\n- 动量通量: $\\rho_R u_R^2 + p_R = (\\frac{1}{2})(-1)^2 + \\frac{1}{2} = \\frac{1}{2} + \\frac{1}{2} = 1$。\n- 能量通量: $u_R(E_R + p_R) = (-1)(1 + \\frac{1}{2}) = -\\frac{3}{2}$。\n因此，右状态的通量向量是 $F(U_R) = (-\\frac{1}{2}, 1, -\\frac{3}{2})$。\n\n**3. 计算最大信号速度**\n一维欧拉方程的特征速度（特征值）为 $u-a$、$u$ 和 $u+a$。Rusanov 通量的最大信号速度通常取为 $S_{\\text{max}} = \\max(|u_L| + a_L, |u_R| + a_R)$。声速 $a$ 由 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$ 给出。\n\n对于左状态：\n- $a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(\\frac{5}{3})(1)}{1}} = \\sqrt{\\frac{5}{3}}$。\n- $|u_L| + a_L = |2| + \\sqrt{\\frac{5}{3}} = 2 + \\sqrt{\\frac{5}{3}}$。\n\n对于右状态：\n- $a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(\\frac{5}{3})(\\frac{1}{2})}{\\frac{1}{2}}} = \\sqrt{\\frac{5}{3}}$。\n- $|u_R| + a_R = |-1| + \\sqrt{\\frac{5}{3}} = 1 + \\sqrt{\\frac{5}{3}}$。\n\n比较两者，我们得到最大信号速度：\n$$S_{\\text{max}} = \\max\\left(2 + \\sqrt{\\frac{5}{3}}, 1 + \\sqrt{\\frac{5}{3}}\\right) = 2 + \\sqrt{\\frac{5}{3}} = 2 + \\frac{\\sqrt{15}}{3}$$\n\n**4. 组装 Rusanov 通量**\n我们现在将各分量组合到 Rusanov 通量公式中。\n\n首先，计算平均通量项：\n$$\\frac{1}{2}[F(U_L) + F(U_R)] = \\frac{1}{2}\\left( (2, 5, 9) + (-\\frac{1}{2}, 1, -\\frac{3}{2}) \\right) = \\frac{1}{2}\\left(\\frac{3}{2}, 6, \\frac{15}{2}\\right) = \\left(\\frac{3}{4}, 3, \\frac{15}{4}\\right)$$\n\n接下来，计算耗散项 $-\\frac{1}{2} S_{\\text{max}} [U_R - U_L]$。\n守恒状态的差为：\n$$U_R - U_L = \\left(\\frac{1}{2}, -\\frac{1}{2}, 1\\right) - \\left(1, 2, \\frac{7}{2}\\right) = \\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right)$$\n耗散系数为：\n$$\\frac{1}{2} S_{\\text{max}} = \\frac{1}{2}\\left(2 + \\frac{\\sqrt{15}}{3}\\right) = 1 + \\frac{\\sqrt{15}}{6}$$\n耗散向量为：\n$$-\\frac{1}{2} S_{\\text{max}} [U_R - U_L] = -\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right) = \\left(\\frac{1}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\right)$$\n$$= \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right)$$\n\n最后，将平均通量和耗散向量相加得到 $F^*$：\n- 质量通量 $F_1^*$：\n$$F_1^* = \\frac{3}{4} + \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}\\right) = \\frac{3}{4} + \\frac{2}{4} + \\frac{\\sqrt{15}}{12} = \\frac{5}{4} + \\frac{\\sqrt{15}}{12} = \\frac{15}{12} + \\frac{\\sqrt{15}}{12} = \\frac{15 + \\sqrt{15}}{12}$$\n- 动量通量 $F_2^*$：\n$$F_2^* = 3 + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{6}{2} + \\frac{5}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{11}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{66}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{66 + 5\\sqrt{15}}{12}$$\n- 能量通量 $F_3^*$：\n$$F_3^* = \\frac{15}{4} + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{15}{4} + \\frac{10}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{25}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{75}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{75 + 5\\sqrt{15}}{12}$$\n\n得到的数值通量向量为 $F^* = \\left(\\frac{15 + \\sqrt{15}}{12}, \\frac{66 + 5\\sqrt{15}}{12}, \\frac{75 + 5\\sqrt{15}}{12}\\right)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{15 + \\sqrt{15}}{12}  \\frac{66 + 5\\sqrt{15}}{12}  \\frac{75 + 5\\sqrt{15}}{12} \\end{pmatrix} } $$", "id": "3504119"}, {"introduction": "尽管 Rusanov 求解器很简洁，但其数值耗散往往过大。为了追求更高的精度，HLL 和 HLLC 等更精密的求解器通过捕捉黎曼问题更丰富的波结构来实现这一目标。这项高级练习 [@problem_id:3504126] 旨在深入探讨这些求解器的构造细节，通过比较不同的波速估计算法以及是否显式处理接触间断（HLLC 的特点），来揭示它们如何影响最终的数值通量。这有助于我们理解在设计现代流体动力学数值格式时所面临的各种权衡。", "problem": "考虑理想气体的一维欧拉方程，其形式为质量、动量和总能量的守恒形式。在一个平面界面上给定一个黎曼问题，其左侧原始状态为 $U_{L}=(\\rho_{L},u_{L},p_{L})=(1,3,1)$，右侧原始状态为 $U_{R}=(\\rho_{R},u_{R},p_{R})=(2,-1,2)$，比热比为 $\\gamma=1.4$。从控制方程和理想气体的特征信号速度定义出发，使用 Harten–Lax–van Leer (HLL) 方法结合 Davis 的估计，以及 Harten–Lax–van Leer–Contact (HLLC) 方法结合 Toro 的压力-速度黎曼求解器 (PVRS) 的估计，推导左行和右行边界波的近似波速估计值。基于这些估计，构建由以下方法预测的相应界面数值通量：\n- 使用 Davis 速度的 HLL 求解器，以及\n- 使用 Toro 速度的 HLLC 求解器，确保通过在接触面上强制压力和法向速度连续来一致地确定接触波速。\n\n使用理想气体状态方程以及由欧拉方程所隐含的守恒变量和物理通量的定义。明确计算声速、Davis 和 Toro 两种方法的波速估计值 $S_{L}$ 和 $S_{R}$，以及在每种情况下适用于 HLLC 构造的接触波速 $S_{M}$。然后，确定此问题中由 Davis–HLL 求解器和 Toro–HLLC 求解器预测的界面质量通量（数值通量矢量的第一个分量）。\n\n最后，以计算天体物理学测试问题中典型的无量纲单位，给出一个单一的闭式解析表达式，表示 Toro–HLLC 求解器预测的界面质量通量与 Davis–HLL 求解器预测的界面质量通量之差。将最终的差值表示为使用根式的精确表达式；不要四舍五入。", "solution": "用户希望我解决一个关于计算天体物理学中近似黎曼求解器的问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   **提取已知条件：** 我将列出所有提供的数据：左右状态的原始变量、比热比以及要执行的具体任务。\n    *   **验证：** 我将检查问题是否具有科学依据、是否适定以及是否客观。\n        *   **科学依据：** 该问题描述了理想气体的一维欧拉方程，这是流体动力学和天体物理学中的标准模型。HLL 和 HLLC 求解器是成熟的近似黎曼求解器。Davis 和 Toro 的估计也是标准方法。这在科学上是合理的。\n        *   **适定性：** 该问题提供了计算波速和通量所需的所有信息（左状态、右状态、gamma）。步骤清晰明了。存在唯一、稳定且有意义的解。\n        *   **客观性：** 语言精确且专业。没有主观看法。\n    *   **结论：** 该问题有效。\n\n2.  **解决问题：**\n    *   **步骤 1：定义系统**\n        *   写下守恒形式的一维欧拉方程：$\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = 0$。\n        *   定义守恒变量矢量 $\\mathbf{Q} = [\\rho, \\rho u, E]^T$。\n        *   定义通量矢量 $\\mathbf{F}(\\mathbf{Q}) = [\\rho u, \\rho u^2 + p, (E+p)u]^T$。\n        *   定义原始变量 $(\\rho, u, p)$ 和守恒变量 $(\\rho, m, E)$ 之间的关系，其中 $m = \\rho u$ 且 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$。\n\n    *   **步骤 2：列出给定状态**\n        *   左状态（原始）：$U_L = (\\rho_L, u_L, p_L) = (1, 3, 1)$。\n        *   右状态（原始）：$U_R = (\\rho_R, u_R, p_R) = (2, -1, 2)$。\n        *   比热比：$\\gamma = 1.4$。\n\n    *   **步骤 3：计算左右状态的导出量**\n        *   计算左右状态的声速：$a = \\sqrt{\\gamma p / \\rho}$。\n            *   $a_L = \\sqrt{\\gamma p_L / \\rho_L} = \\sqrt{1.4 \\times 1 / 1} = \\sqrt{1.4}$。\n            *   $a_R = \\sqrt{\\gamma p_R / \\rho_R} = \\sqrt{1.4 \\times 2 / 2} = \\sqrt{1.4}$。\n        *   将两个状态的原始变量转换为守恒变量。\n            *   $\\mathbf{Q}_L = [\\rho_L, \\rho_L u_L, E_L]^T$。\n                *   $\\rho_L = 1$。\n                *   $(\\rho u)_L = 1 \\times 3 = 3$。\n                *   $E_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{1.4-1} + \\frac{1}{2}(1)(3^2) = \\frac{1}{0.4} + \\frac{9}{2} = 2.5 + 4.5 = 7$。\n                *   $\\mathbf{Q}_L = [1, 3, 7]^T$。\n            *   $\\mathbf{Q}_R = [\\rho_R, \\rho_R u_R, E_R]^T$。\n                *   $\\rho_R = 2$。\n                *   $(\\rho u)_R = 2 \\times (-1) = -2$。\n                *   $E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{2}{1.4-1} + \\frac{1}{2}(2)(-1)^2 = \\frac{2}{0.4} + 1 = 5 + 1 = 6$。\n                *   $\\mathbf{Q}_R = [2, -2, 6]^T$。\n        *   计算两个状态的通量。\n            *   $\\mathbf{F}_L = [\\rho_L u_L, \\rho_L u_L^2 + p_L, (E_L+p_L)u_L]^T$。\n                *   $(\\rho u)_L = 3$。\n                *   $(\\rho u^2 + p)_L = 1 \\times 3^2 + 1 = 9 + 1 = 10$。\n                *   $((E+p)u)_L = (7+1) \\times 3 = 8 \\times 3 = 24$。\n                *   $\\mathbf{F}_L = [3, 10, 24]^T$。\n            *   $\\mathbf{F}_R = [\\rho_R u_R, \\rho_R u_R^2 + p_R, (E_R+p_R)u_R]^T$。\n                *   $(\\rho u)_R = -2$。\n                *   $(\\rho u^2 + p)_R = 2 \\times (-1)^2 + 2 = 2 + 2 = 4$。\n                *   $((E+p)u)_R = (6+2) \\times (-1) = 8 \\times (-1) = -8$。\n                *   $\\mathbf{F}_R = [-2, 4, -8]^T$。\n\n    *   **步骤 4：用于 HLL 的 Davis 波速估计**\n        *   特征速度为 $\\lambda_1 = u-a$, $\\lambda_2 = u$, $\\lambda_3 = u+a$。\n        *   Davis 对最外层波速 $S_L$ 和 $S_R$ 的估计为：\n            *   $S_L = \\min(u_L - a_L, u_R - a_R)$。\n            *   $S_R = \\max(u_L + a_L, u_R + a_R)$。\n        *   计算这些值：\n            *   $u_L - a_L = 3 - \\sqrt{1.4}$。\n            *   $u_R - a_R = -1 - \\sqrt{1.4}$。\n            *   $u_L + a_L = 3 + \\sqrt{1.4}$。\n            *   $u_R + a_R = -1 + \\sqrt{1.4}$。\n        *   由于 $\\sqrt{1.4}  0$：\n            *   $S_L^{\\text{Davis}} = \\min(3 - \\sqrt{1.4}, -1 - \\sqrt{1.4}) = -1 - \\sqrt{1.4}$。\n            *   $S_R^{\\text{Davis}} = \\max(3 + \\sqrt{1.4}, -1 + \\sqrt{1.4}) = 3 + \\sqrt{1.4}$。\n\n    *   **步骤 5：HLL 界面通量 (Davis)**\n        *   HLL 通量由下式给出：\n            $$ \\mathbf{F}^{\\text{HLL}} = \\begin{cases} \\mathbf{F}_L  \\text{if } S_L \\ge 0 \\\\ \\frac{S_R \\mathbf{F}_L - S_L \\mathbf{F}_R + S_L S_R (\\mathbf{Q}_R - \\mathbf{Q}_L)}{S_R - S_L}  \\text{if } S_L  0  S_R \\\\ \\mathbf{F}_R  \\text{if } S_R \\le 0 \\end{cases} $$\n        *   检查速度条件：$S_L^{\\text{Davis}} = -1 - \\sqrt{1.4}  0$ 且 $S_R^{\\text{Davis}} = 3 + \\sqrt{1.4}  0$。适用中间情况。我们计算质量通量（第一个分量），记为 $F_1$。\n            $$ F^{\\text{HLL}}_1 = \\frac{S_R F_{1,L} - S_L F_{1,R} + S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L} $$\n        *   代入已知值：$F_{1,L} = 3$, $F_{1,R} = -2$, $\\rho_L=1$, $\\rho_R=2$。令 $\\gamma=1.4=7/5$。则 $a_L=a_R=\\sqrt{7/5}$。\n        *   $S_L = -1 - \\sqrt{7/5}$, $S_R = 3 + \\sqrt{7/5}$。\n        *   $S_R - S_L = (3 + \\sqrt{7/5}) - (-1 - \\sqrt{7/5}) = 4 + 2\\sqrt{7/5}$。\n        *   分子是 $S_R F_{1,L} - S_L F_{1,R} + S_L S_R (\\rho_R - \\rho_L)$：\n            $$ (3 + \\sqrt{7/5})(3) - (-1 - \\sqrt{7/5})(-2) + ((-1 - \\sqrt{7/5})(3 + \\sqrt{7/5}))(2 - 1) $$\n            $$ = (9 + 3\\sqrt{7/5}) - (2 + 2\\sqrt{7/5}) + (-3 - 4\\sqrt{7/5} - 7/5) $$\n            $$ = (9 - 2 - 3 - 7/5) + (3 - 2 - 4)\\sqrt{7/5} $$\n            $$ = (4 - 7/5) - 3\\sqrt{7/5} = 13/5 - 3\\sqrt{7/5} $$\n        *   所以，Davis-HLL 质量通量为：\n            $$ F^{\\text{Davis-HLL}}_1 = \\frac{13/5 - 3\\sqrt{7/5}}{4 + 2\\sqrt{7/5}} = \\frac{13 - 15\\sqrt{7/5}}{20 + 10\\sqrt{7/5}} = \\frac{13 - 3\\sqrt{35}}{20 + 2\\sqrt{35}} $$\n\n    *   **步骤 6：用于 HLLC 的 Toro 波速估计**\n        *   Toro 的 PVRS 基于声学近似，为星区内的压力 $p^*$ 和速度 $u^*$ 提供了一个估计。\n        *   $p^* = \\frac{p_L + p_R}{2} + \\frac{1}{2}(u_L - u_R) \\frac{\\rho_L a_L + \\rho_R a_R}{2}$。\n        *   代入数值：\n            $$ p^* = \\frac{1 + 2}{2} + \\frac{1}{2}(3 - (-1)) \\frac{1\\sqrt{1.4} + 2\\sqrt{1.4}}{2} = \\frac{3}{2} + \\frac{1}{2}(4)\\frac{3\\sqrt{1.4}}{2} = \\frac{3}{2} + 3\\sqrt{1.4} = \\frac{3}{2} + 3\\sqrt{\\frac{7}{5}} $$\n        *   接触波速 $S_M$ 就是星区速度 $u^*$：\n            $$ S_M = u^* = \\frac{u_L+u_R}{2} + \\frac{p_L-p_R}{\\rho_L a_L + \\rho_R a_R} = \\frac{3-1}{2} + \\frac{1-2}{1\\sqrt{1.4} + 2\\sqrt{1.4}} = 1 - \\frac{1}{3\\sqrt{1.4}} = 1 - \\frac{1}{3\\sqrt{7/5}} $$\n        *   由于 $p^* \\approx 1.5 + 3(1.18) \\approx 5.04  p_R=2  p_L=1$，两个外波都是激波。信号速度 $S_L$ 和 $S_R$ 使用激波关系式进行估计。\n            $$ S_L = u_L - a_L \\sqrt{1 + \\frac{\\gamma+1}{2\\gamma}\\left(\\frac{p^*}{p_L} - 1\\right)} \\quad \\text{and} \\quad S_R = u_R + a_R \\sqrt{1 + \\frac{\\gamma+1}{2\\gamma}\\left(\\frac{p^*}{p_R} - 1\\right)} $$\n            注意 $\\frac{\\gamma+1}{2\\gamma} = \\frac{1.4+1}{2(1.4)} = \\frac{2.4}{2.8} = \\frac{6}{7}$。\n\n    *   **步骤 7：HLLC 界面通量 (Toro)**\n        *   界面 $x/t=0$ 处的 HLLC 通量取决于 $S_L$、$S_M$ 和 $S_R$ 的符号。我们需要评估 $S_L^{\\text{Toro}}$ 的符号。\n            $$ S_L^{\\text{Toro}} = 3 - \\sqrt{\\frac{7}{5}} \\sqrt{1 + \\frac{6}{7}\\left(\\left(\\frac{3}{2} + 3\\sqrt{\\frac{7}{5}}\\right) - 1\\right)} = 3 - \\sqrt{\\frac{7}{5}} \\sqrt{1 + \\frac{6}{7}\\left(\\frac{1}{2} + 3\\sqrt{\\frac{7}{5}}\\right)} $$\n            $$ S_L^{\\text{Toro}} = 3 - \\sqrt{\\frac{7}{5}\\left(\\frac{10}{7} + \\frac{18}{7}\\sqrt{\\frac{7}{5}}\\right)} = 3 - \\sqrt{2 + \\frac{18}{5}\\sqrt{\\frac{7}{5}}} = 3 - \\sqrt{2 + \\frac{18\\sqrt{35}}{25}} $$\n        *   为了确定符号，我们检查是否 $3  \\sqrt{2 + \\frac{18\\sqrt{35}}{25}}$。这等价于检查是否 $9  2 + \\frac{18\\sqrt{35}}{25}}$，或 $7  \\frac{18\\sqrt{35}}{25}}$，或 $175  18\\sqrt{35}$。\n        *   对两个正边进行平方：$175^2  18^2 \\times 35$。\n        *   $175^2 = 30625$。\n        *   $18^2 \\times 35 = 324 \\times 35 = 11340$。\n        *   由于 $30625  11340$，该不等式成立，因此 $S_L^{\\text{Toro}}  0$。\n        *   HLLC 通量函数为：\n            $$ \\mathbf{F}^{\\text{HLLC}} = \\begin{cases} \\mathbf{F}_L  \\text{if } 0 \\le S_L \\\\ \\mathbf{F}^*_L  \\text{if } S_L  0 \\le S_M \\\\ \\mathbf{F}^*_R  \\text{if } S_M  0  S_R \\\\ \\mathbf{F}_R  \\text{if } S_R \\le 0 \\end{cases} $$\n        *   由于 $S_L^{\\text{Toro}}  0$，界面处的状态为左状态。通量为 $\\mathbf{F}^{\\text{Toro-HLLC}} = \\mathbf{F}_L$。\n        *   质量通量分量为 $F^{\\text{Toro-HLLC}}_1 = F_{1,L} = (\\rho u)_L = 3$。\n\n    *   **步骤 8：最终差值计算**\n        *   问题要求计算差值 $\\Delta F_1 = F^{\\text{Toro-HLLC}}_1 - F^{\\text{Davis-HLL}}_1$。\n            $$ \\Delta F_1 = 3 - \\left( \\frac{13 - 3\\sqrt{35}}{20 + 2\\sqrt{35}} \\right) $$\n        *   为了合并这些项，我们将它们通分：\n            $$ \\Delta F_1 = \\frac{3(20 + 2\\sqrt{35}) - (13 - 3\\sqrt{35})}{20 + 2\\sqrt{35}} $$\n            $$ \\Delta F_1 = \\frac{60 + 6\\sqrt{35} - 13 + 3\\sqrt{35}}{20 + 2\\sqrt{35}} = \\frac{47 + 9\\sqrt{35}}{20 + 2\\sqrt{35}} $$\n        *   为了简化，我们通过乘以其共轭式来使分母有理化：\n            $$ \\Delta F_1 = \\frac{47 + 9\\sqrt{35}}{20 + 2\\sqrt{35}} \\times \\frac{20 - 2\\sqrt{35}}{20 - 2\\sqrt{35}} = \\frac{(47)(20) - (47)(2\\sqrt{35}) + (9\\sqrt{35})(20) - (9\\sqrt{35})(2\\sqrt{35})}{20^2 - (2\\sqrt{35})^2} $$\n        *   分子：\n            $$ 940 - 94\\sqrt{35} + 180\\sqrt{35} - 18(35) = 940 - 630 + (180 - 94)\\sqrt{35} = 310 + 86\\sqrt{35} $$\n        *   分母：\n            $$ 400 - 4(35) = 400 - 140 = 260 $$\n        *   合并并简化分数：\n            $$ \\Delta F_1 = \\frac{310 + 86\\sqrt{35}}{260} = \\frac{155 + 43\\sqrt{35}}{130} $$", "answer": "$$\\boxed{\\frac{155 + 43\\sqrt{35}}{130}}$$", "id": "3504126"}]}