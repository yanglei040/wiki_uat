{"hands_on_practices": [{"introduction": "在有限的计算域中，边界条件的选择对于获得物理上可靠的结果至关重要，因为它决定了波和流体如何与模拟区域的边缘相互作用。不恰当的边界条件可能会引入非物理反射，从而污染整个解。本练习 [@problem_id:3520091] 探讨了各种标准数值边界条件对MHD波传播的物理后果，从而加深您对如何将物理问题与数值伪影分离开的理解。", "problem": "考虑理想磁流体动力学（MHD）方程组：质量守恒、包含洛伦兹力的动量守恒、理想极限下的（无电阻率的）感应方程，以及磁场的无散约束。在笛卡尔坐标系中，设速度为 $\\mathbf{u}$，磁场为 $\\mathbf{B}$，密度为 $\\rho$，压强为 $p$，总能量密度为 $E$，则其控制方程分别为：连续性方程 $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$；动量方程 $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$；感应方程 $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$ 及 $\\nabla \\cdot \\mathbf{B} = 0$；以及一个热力学闭合关系，例如关于 $p$ 的理想气体定律。在一个具有均匀网格的一维区域 $x \\in [0,L]$ 中，围绕一个均匀、静态的背景场（常数密度 $\\rho_0$、常数压强 $p_0$、常数磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$、无平均流 $\\mathbf{u}_0 = \\mathbf{0}$）将这些方程线性化。重点关注沿背景场方向传播的小振幅线性 Alfvén 波：横向扰动 $u_y(x,t)$ 和 $B_y(x,t)$，其 Alfvén 速率为 $c_a = B_0/\\sqrt{4\\pi \\rho_0}$，相位关系为 $B_y = \\pm \\sqrt{4\\pi \\rho_0}\\, u_y$（取决于传播方向）。\n\n一个频率为 $\\omega$、波数为 $k$ 的平面 Alfvén 波从内部（$x>0$）靠近边界 $x=0$，因此对于一个群速度为 $-c_a$ 的向左传播的波，其入射扰动具有 $\\exp\\{i(\\omega t - k x)\\}$ 的形式；如果存在反射，反射扰动则具有 $\\exp\\{i(\\omega t + k x)\\}$ 的形式。那么在 $x$ 处的总横向速度为 $u_y(x,t) = \\Re\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\}$，对于向左传播的 Alfvén 分支，横向磁场为 $B_y(x,t) = \\Re\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\}$，其中 $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$，$R$ 是复反射系数。\n\n在 $x=0$ 处，考虑计算天体物理磁流体动力学中五种常见的数值边界处理方法：\n\n- 周期性边界条件：将 $x=0$ 与 $x=L$ 等同，使得所有场都满足周期性，在 $x=0$ 处离开的波会在 $x=L$ 处重新进入，且在均匀介质中不做任何改变。\n\n- 反射性、理想导电壁：在 $x=0$ 处施加与理想磁流体动力学一致的运动学反射和理想导体约束，对于小振幅、沿场向的 Alfvén 波，这导致 $u_y(0,t) = 0$ 且切向电场 $E_y(0,t) = 0$ 为零。\n\n- 流入边界：在 $x=0$ 处指定固定的原始变量 $\\rho$、$p$、$\\mathbf{u}$ 和 $\\mathbf{B}$，对应一个不随时间变化的稳态流入状态。\n\n- 流出边界：在 $x=0$ 处对原始变量施加零法向梯度，例如 $\\partial_x (\\rho,p,u_y,B_y) = 0$。\n\n- 基于特征线的边界：将线性化的 MHD 系统分解为特征变量，仅在 $x=0$ 处对入射特征波的振幅施加约束，使其等于稳态背景值，而出射特征波则不受约束，从而在线性极限下构建无反射边界条件。\n\n在此设置下，关于入射 Alfvén 波在 $x=0$ 处反射的下列陈述中，哪些是正确的？选择所有正确的选项。\n\nA. 在具有均匀背景场和相同网格的周期性区域中，一个在 $x=L$ 处向右离开的波会在 $x=0$ 处重新进入，且没有任何反射；在 $x=0$ 处，入射 Alfvén 波的反射系数为 $R = 0$。\n\nB. 在 $x=0$ 处的反射性、理想导电壁对沿场向的 Alfvén 波的横向速度扰动强制施加 $u_y(0,t) = 0$，产生一个大小为单位、相位反转（$R = -1$）的反射波，因此能量被困住，扰动被反射。\n\nC. 在 $x=0$ 处的简单零梯度流出边界，对于所有线性 MHD 模式，在波矢和磁场之间的任何角度下都是严格无反射的，无论流动是亚临界的还是超临界的。\n\nD. 一个将入射 Alfvén 特征波设定为稳态背景值、而出射特征波则不受约束的基于特征线的边界，可以消除均匀介质中出射的线性扰动的一阶反射；对于此处的 Alfvén 波，可以得到 $R = 0$。\n\nE. 在 $x=0$ 处使用固定原始变量的指定流入边界，通常会导致靠近边界的出射线性波发生强反射；只有当净特征通量指向区域内部时（即波是进入而不是离开），这种边界才是合适的（并且从内部看是无反射的）。", "solution": "用户提供了一个关于一维理想磁流体动力学（MHD）设置中，线性 Alfvén 波在不同数值边界条件下反射的问题。\n\n### 步骤1：问题验证\n\n**已知条件提取：**\n-   **控制方程：** 理想 MHD 方程，描述密度 $\\rho$、速度 $\\mathbf{u}$、压强 $p$ 和磁场 $\\mathbf{B}$。\n    -   $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$\n    -   $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$\n    -   $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$\n    -   $\\nabla \\cdot \\mathbf{B} = 0$\n-   **坐标与区域：** 笛卡尔坐标系，$x \\in [0,L]$。\n-   **背景状态：** 均匀且静态：$\\rho_0 = \\text{常数}$，$p_0 = \\text{常数}$，$\\mathbf{u}_0 = \\mathbf{0}$，$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$。\n-   **波的性质：**\n    -   一个沿 $\\mathbf{B}_0$ 传播的平面、小振幅、线性 Alfvén 波。\n    -   扰动是横向的：$u_y(x,t)$，$B_y(x,t)$。\n    -   Alfvén 速率：$c_a = B_0/\\sqrt{4\\pi \\rho_0}$。\n    -   入射波：从 $x>0$ 处靠近 $x=0$，具有 $\\exp\\{i(\\omega t - k x)\\}$ 的形式，被描述为“群速度为 $-c_a$ 的向左传播的波”。这意味着一个不寻常但自洽的符号选择，其中对于 $\\omega>0$，波数 $k$ 为负。\n    -   反射波：具有 $\\exp\\{i(\\omega t + k x)\\}$ 的形式。当 $k0$ 时，这对应于向右传播。\n    -   总横向速度：$u_y(x,t) = \\Re\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\}$\n    -   总横向磁场：$B_y(x,t) = \\Re\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\}$\n    -   振幅关系：$\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$。$u_y$ 和 $B_y$ 之间的相对符号取决于传播方向。提供的总 $B_y$ 表达式正确地考虑了这一点：入射波的 $B_{y,I}$ 和 $u_{y,I}$ 同相（对于沿 $\\mathbf{B}_0$ 向左传播），而反射波的 $B_{y,R}$ 和 $u_{y,R}$ 反相（对于向右传播）。\n-   **$x=0$ 处的边界条件**：描述了五种类型：周期性、反射性（理想导电壁）、流入、流出（零梯度）和基于特征线的。\n\n**验证结论：**\n该问题陈述具有科学依据、适定且客观。它描述了一个在计算天体物理学中用于验证 MHD 程序中边界条件实现的标准测试问题。控制方程、波的性质以及对边界条件的描述都是标准的。所选波的函数形式虽然可能令人困惑，但内部是自洽的。问题定义明确，并包含足够的信息来确定所给出的每种情况下的反射系数 $R$。该问题是有效的。\n\n### 步骤2：推导与选项分析\n\n我们分析入射 Alfvén 波在边界 $x=0$ 处的反射。在任意点 $x$ 处，总横向速度和磁场的复振幅由以下公式给出：\n$$ u_y(x) = \\hat{u} \\left(e^{-ikx} + R\\,e^{ikx}\\right) $$\n$$ B_y(x) = \\hat{b} \\left(e^{-ikx} - R\\,e^{ikx}\\right) $$\n其中 $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$。我们在 $x=0$ 处应用指定的边界条件来确定反射系数 $R$。在 $x=0$ 处，这些表达式简化为：\n$$ u_y(0) = \\hat{u} (1+R) $$\n$$ B_y(0) = \\hat{b} (1-R) $$\n\n**A. 周期性边界条件**\n周期性边界条件连接了区域的边缘，因此 $x=0$ 与 $x=L$ 等同。在均匀介质中，这种拓扑结构意味着在 $x=0$ 或 $x=L$ 处没有能引起反射的物理界面。一个从内部（即向左传播的波）朝 $x=0$ 传播的波包将无缝地通过 $x=0$ 并重新出现在 $x=L$ 处，继续其传播。由于不存在会散射波的物理不连续性或施加的约束，因此不会产生反射波。反射波的振幅为零，对应的反射系数为 $R=0$。该陈述的文本正确地得出 $R=0$ 的结论。虽然关于“向右离开的波”的描述性子句描述的是另一种情景，但关于给定入射波的核心论点是正确的。\n**结论：正确。**\n\n**B. 反射性、理想导电壁**\n理想导电壁不能维持切向电场。在理想 MHD 中，电场为 $\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B}$。对于给定的波，有 $\\mathbf{u} = u_y \\hat{\\mathbf{y}}$ 和 $\\mathbf{B} \\approx B_0 \\hat{\\mathbf{x}}$，电场为 $\\mathbf{E} \\approx - (u_y \\hat{\\mathbf{y}}) \\times (B_0 \\hat{\\mathbf{x}}) = u_y B_0 \\hat{\\mathbf{z}}$。在墙壁 $x=0$ 处，$\\mathbf{E}$ 的切向分量是 $E_y$ 和 $E_z$。对于这个波，$E_y=0$ 是自然成立的。条件 $E_z(0,t) = 0$ 意味着 $u_y(0,t) B_0 = 0$。由于 $B_0 \\neq 0$，物理边界条件是 $u_y(0,t) = 0$。\n将此条件应用于 $x=0$ 处的总速度：\n$$ u_y(0) = \\hat{u} (1+R) = 0 $$\n对于一个非平凡的入射波（$\\hat{u} \\neq 0$），这要求 $1+R = 0$，从而得出 $R=-1$。\n这意味着反射波与入射波振幅相同但相位反转。反射是全反射（$|R|^2=1$），所以所有入射能量都被反射，能量被困在区域内。该陈述完全准确。\n**结论：正确。**\n\n**C. 简单零梯度流出边界**\n该边界条件要求原始变量的法向导数为零。对于扰动 $u_y$ 和 $B_y$，这意味着在 $x=0$ 处 $\\partial_x u_y = 0$ 和 $\\partial_x B_y = 0$。\n首先，我们计算空间导数：\n$$ \\frac{\\partial u_y}{\\partial x} = \\hat{u} \\left(-ik e^{-ikx} + ikR e^{ikx}\\right) = ik\\hat{u}\\left(-e^{-ikx} + R e^{ikx}\\right) $$\n$$ \\frac{\\partial B_y}{\\partial x} = \\hat{b} \\left(-ik e^{-ikx} - ikR e^{ikx}\\right) = -ik\\hat{b}\\left(e^{-ikx} + R e^{ikx}\\right) $$\n在 $x=0$ 处应用这些条件：\n$$ \\frac{\\partial u_y}{\\partial x}\\bigg|_{x=0} = ik\\hat{u}(-1 + R) = 0 \\implies R=1 $$\n$$ \\frac{\\partial B_y}{\\partial x}\\bigg|_{x=0} = -ik\\hat{b}(1 + R) = 0 \\implies R=-1 $$\n条件 $\\partial_x u_y = 0$ 和 $\\partial_x B_y = 0$ 对反射系数 $R$ 提出了相互矛盾的要求（$R=1$ 和 $R=-1$）。这意味着没有一个简单的反射波形式的解能同时满足这些边界条件。问题是过约束的，并且众所周知，这种边界条件在亚临界状态下对 MHD 波是高度反射的。陈述中说它是“严格无反射的”是错误的。\n**结论：不正确。**\n\n**D. 基于特征线的边界**\n这些边界条件是专门设计为无反射的。它们的原理是将 MHD 波模式分解为进入区域的波（入射特征波）和离开区域的波（出射特征波）。对于 $x=0$ 的边界和 $x>0$ 的区域，出射波具有负的传播速度。本问题中的入射 Alfvén 波以速度 $-c_a$ 向左传播，因此在 $x=0$ 边界处它是一个出射特征波。无反射边界条件的实现方式是，指定入射特征波的振幅（例如，使其与稳定的外部状态匹配），同时使用外插或其他数值技术，让出射特征波不受阻碍地离开区域。根据其设计，这可以防止边界产生虚假的反射波。在理想的线性极限下，对于出射波，这将导致反射系数 $R=0$。该陈述准确地描述了这一原理及其结果。\n**结论：正确。**\n\n**E. 指定的流入边界**\n该边界条件将边界处的原始变量固定，对于涉及扰动的问题，通常是固定为它们的背景值。对于给定的设置，这意味着所有扰动在 $x=0$ 处必须为零。特别是，$u_y(0,t)=0$ 和 $B_y(0,t)=0$。\n应用这些条件：\n1.  $u_y(0) = \\hat{u} (1+R) = 0 \\implies R=-1$\n2.  $B_y(0) = \\hat{b} (1-R) = 0 \\implies R=1$\n与零梯度条件一样，我们发现对 $R$ 的要求是矛盾的。从物理上讲，这意味着对于一个出射波，边界条件是过度指定的，无法满足。在数值模拟中，结果是强烈的虚假反射。该陈述的第一部分“通常会导致靠近边界的出射线性波发生强反射”因此是正确的。第二部分解释了这种边界适用的情景：当信息流指向区域内部时（即对于入射波）。在这种情况下，边界条件用于指定入射流的属性，并且从内部看没有“反射”。这是一个正确和完整的物理描述。\n**结论：正确。**", "answer": "$$\\boxed{ABDE}$$", "id": "3520091"}, {"introduction": "一个能够运行的程序并不等同于一个正确的程序；验证是科学计算的基石，它确保代码准确地求解了控制方程。本练习 [@problem_id:3520099] 要求您超越单一计算，进行更高层次的战略性思考，设计一个全面的验证计划。您将学习如何组合利用一系列标准测试问题，以系统地评估一个MHD代码在光滑解上的准确性、在强间断下的鲁棒性，以及其维持诸如磁场无散度（$ \\nabla \\cdot \\mathbf{B} = 0 $）等物理约束的能力。", "problem": "考虑理想磁流体动力学（MHD）的方程组，其守恒形式包括质量守恒、动量守恒、感应方程和总能量方程，以及无散约束。使用原始变量密度$\\,\\rho\\,$、速度$\\,\\mathbf{v}\\,$、磁场$\\,\\mathbf{B}\\,$、气体压力$\\,p\\,$和绝热指数$\\,\\gamma\\,$，该系统可总结为：\n$$\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0,$$\n$$\\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0,$$\n$$\\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0,$$\n$$\\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0,$$\n服从无散条件\n$$\\nabla \\cdot \\mathbf{B} = 0,$$\n其中总能量为$\\,E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2.$\n\n一个计算天体物理学程序声称对于光滑流具有高阶精度，对于间断具有鲁棒性，并且能够控制磁场的散度误差。您需要选择一个验证方案，该方案结合使用线性波传播、Brio–Wu激波管、磁转子和Orszag–Tang涡，以分别评估：\n(i) 光滑解的精度，\n(ii) 当强间断和旋转结构形成时的鲁棒性，\n(iii) 磁散度误差的控制，即维持约束$\\,\\nabla\\cdot\\mathbf{B}=0\\,$并减轻在$\\,\\nabla\\cdot\\mathbf{B}\\neq 0\\,$时出现的伪磁单极子力。\n\n该方案应定义科学上一致的初始和边界条件，指定与上述系统第一性原理相关的诊断量，并避免混淆目标。选择正确区分各目标并为每个测试使用适当诊断量的选项。\n\nA. 精度通过在周期性立方体$[0,1]^3$上使用小振幅线性磁流体波进行评估：初始化三个波族（阿尔芬波、慢磁声波、快磁声波），振幅为$\\,A = 10^{-6}\\,$，归一化波矢$\\,\\mathbf{k} \\propto (1,2,3)\\,$以避免网格对齐。在一个周期$\\,T = 2\\pi/\\omega_{\\text{mode}}\\,$后，计算$\\,(\\rho,\\mathbf{v},\\mathbf{B},p)\\,$的误差，与相应的线性解进行比较，并测量作为分辨率$\\,N = 64, 128, 256\\,$函数的$\\,L_1\\,$, $\\,L_2\\,$和$\\,L_\\infty\\,$范数，以确认光滑解的预期阶数。对间断的鲁棒性通过一维Brio–Wu激波管（在$[0,1]$上，使用出流（非反射）边界和标准左/右状态$\\,(\\rho_L,p_L,\\mathbf{v}_L,\\mathbf{B}_L)=(1,1,(0,0,0),(0.75,1,0))\\,$，$\\,(\\rho_R,p_R,\\mathbf{v}_R,\\mathbf{B}_R)=(0.125,0.1,(0,0,0),(0.75,-1,0))\\,$）以及二维磁转子（在$[0,1]^2$上，周期性）进行评估，后者在区域中心使用一个半径为$\\,r_0=0.1\\,$的高密度旋转盘，其中$\\,\\rho_{\\text{in}}=10\\,$, $\\,\\rho_{\\text{out}}=1\\,$, $\\,p=1\\,$, 角速度$\\,\\omega=20\\,$, 并施加均匀背景磁场$\\,\\mathbf{B}_0=(5,0,0)\\,$；诊断量包括激波/稀疏波位置、与高分辨率参考解相比的$\\,L_1\\,$误差，以及角动量和峰值涡度的保持情况。散度误差的控制通过Orszag–Tang涡（在$[0,1]^2$上，周期性）进行评估，其中$\\,\\gamma=5/3\\,$, $\\,\\rho=1\\,$, $\\,p=5/3\\,$, $\\,\\mathbf{v} = (-\\sin(2\\pi y), \\sin(2\\pi x), 0)\\,$, $\\,\\mathbf{B} = (-\\sin(2\\pi y), \\sin(4\\pi x), 0)\\,$；记录两种算法变体下$\\,\\|\\nabla\\cdot\\mathbf{B}\\|_2/\\|\\mathbf{B}\\|_2\\,$和最大值$\\,|\\nabla\\cdot\\mathbf{B}|\\,$随时间的变化：约束输运（CT）和广义拉格朗日乘子（GLM）清理，外加一个禁用清理的对照运行，以展示散度增长及其对动量/能量残差的影响。\n\nB. 精度通过在一维中使用振幅为$\\,A=0.1\\,$的大振幅阿尔芬波进行评估，采用入流/出流边界，在单一分辨率$\\,N=128\\,$下比较$\\,t=1\\,$时的总能量。对间断的鲁棒性通过使用Orszag–Tang涡作为激波管的代理并计算激波宽度来评估，而散度控制则通过总能量的近似恒定间接推断，而没有显式监测$\\,\\nabla\\cdot\\mathbf{B}\\,$；不使用周期性边界以避免人为约束。\n\nC. 精度仅在单一分辨率$\\,N=128\\,$下，通过网格对齐的一维阿尔芬波（周期性边界，振幅$\\,A=10^{-6}\\,$）使用$\\,L_1\\,$误差进行评估。对间断的鲁棒性通过使用反射边界的转子测试进行评估，而散度控制则被并入转子测试中，通过检查$\\,\\nabla\\cdot\\mathbf{v}\\,$而非$\\,\\nabla\\cdot\\mathbf{B}\\,$来评估，并辅以一个不跟踪散度范数或比较不同散度控制算法的Orszag–Tang运行。\n\nD. 精度通过Brio–Wu激波管在$\\,t=0.2\\,$时测量随$\\,N\\,$增加的激波宽度来评估，假设光滑收敛性可延伸至间断；对间断的鲁棒性通过在$[0,1]^3$上使用振幅为$\\,A=10^{-6}\\,$的线性波进行评估；散度控制通过监测$\\,\\nabla\\cdot\\mathbf{v}\\,$以及要求在带有出流边界的Orszag–Tang涡上平均磁场$\\,\\langle \\mathbf{B} \\rangle\\,$保持恒定来评估。\n\n哪个选项提供了一个科学上合理的方案，该方案正确地分开了光滑解的精度、对间断的鲁棒性以及对散度误差的控制，并为每个测试配备了恰当的初始/边界条件和源于控制方程的诊断量？", "solution": "任务是为设计用于求解理想磁流体动力学（MHD）方程的计算天体物理学程序选择最科学合理的验证方案。该方案必须分别评估三个关键能力：(i) 光滑解的精度，(ii) 在强间断存在下的鲁棒性，以及 (iii) 对磁场散度误差的控制。\n\n首先，我们必须确认问题陈述的有效性。问题给出了理想MHD方程的标准守恒形式：\n$$ \\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0 $$\n$$ \\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0 $$\n总能量定义为 $E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2$，并且该系统服从无散约束 $\\nabla \\cdot \\mathbf{B} = 0$。这些方程是理想MHD的基本且正确的依据。指定的一系列测试问题——线性波传播、Brio–Wu激波管、磁转子和Orszag–Tang涡——是计算MHD领域的经典基准测试。这三个验证目标是截然不同且对鉴定一个现代MHD程序至关重要的。因此，该问题是科学上可靠、适定、客观且内部一致的。我们可以着手评估所提出的方案。\n\n一个合理的验证方案必须针对每个目标采用专门的测试，并配备适当的初始条件、边界条件和诊断量。\n\n1.  **目标 (i)：光滑解的精度。** 这需要一个具有已知、光滑的解析解或半解析解的测试问题。测量数值解随网格分辨率（$N$）增加而收敛于真实解的情况。对于一个 $m$ 阶格式，误差应按 $N^{-m}$ 的速率减小。\n    -   **方法论**：小振幅线性波的传播是理想的测试。振幅必须很小（例如，$A \\sim 10^{-6}$），以确保系统保持在线性区域，防止波变陡和激波形成。为避免人为的有利结果，波矢 $\\mathbf{k}$ 不应与网格轴对齐。必须进行跨越多个分辨率的收敛性研究，以测量精度阶。\n\n2.  **目标 (ii)：对间断的鲁棒性。** 这测试了程序处理激波、稀疏波和接触间断的能力，而不会产生致命错误或过度的、不符合物理的振荡。这是在高度非线性状态下的稳定性和定性正确性的测试。\n    -   **方法论**：标准的激波管问题，如Brio–Wu测试，旨在生成一个复杂的一维间断扇。更高维度的问题，如磁转子或Orszag–Tang涡，测试强激波、剪切流和涡旋的相互作用。形式精度不是主要的诊断指标；相反，人们将解的结构与高分辨率参考解进行比较，并检查物理原理（例如，守恒律）的保持情况。\n\n3.  **目标 (iii)：磁散度误差的控制。** 这验证了数值算法在维持 $\\nabla \\cdot \\mathbf{B} = 0$ 约束方面的有效性。如果做不到这一点，会引入一个与 $\\nabla \\cdot \\mathbf{B}$ 成正比的非物理力，这可能破坏解并导致不稳定。\n    -   **方法论**：一个具有复杂、演化的磁场结构的问题，如Orszag–Tang涡，是理想的选择。初始状态满足 $\\nabla \\cdot \\mathbf{B} = 0$，但数值误差可能导致其增长。主要的诊断量是直接测量整个网格上 $\\nabla \\cdot \\mathbf{B}$ 的离散版本，通常通过其 $L_2$ 或 $L_\\infty$ 范数进行监测，并比较不同的散度控制策略（例如，约束输运、Powell源项、投影或GLM清理）。\n\n我们现在根据这些原则评估每个选项。\n\n**选项 A：**\n-   **精度**：该方案正确地使用小振幅（$A = 10^{-6}$）线性MHD波。选择一个不与网格对齐的波矢 $\\mathbf{k} \\propto (1,2,3)$ 对于严格测试至关重要。它适当地指定了在多个分辨率（$N = 64, 128, 256$）下使用标准误差范数（$L_1, L_2, L_\\infty$）进行收敛性研究。这构成了一个用于验证形式精度阶的教科书式程序。\n-   **鲁棒性**：它同时使用一维Brio–Wu激波管和二维磁转子。这些是针对间断和复杂流动的标准且具有挑战性的测试。指定的初始和边界条件是标准的。诊断量——激波位置、与参考解相比的 $L_1$ 误差以及守恒律——适合此目标。\n-   **散度控制**：它正确地采用了Orszag–Tang涡，这是一个用于此目的的经典问题。诊断量是直接且定量的：监测 $\\nabla \\cdot \\mathbf{B}$ 的范数随时间的变化。关键是，它提议将专用的散度控制算法（CT, GLM）与无清理的运行进行比较，这是展示问题存在性及解决方案有效性的权威方法。\n-   **结论**：该选项正确地分开了三个目标，并为每个目标分配了适当的测试、边界条件和诊断量。它代表了一个先进的验证方案。**正确**。\n\n**选项 B：**\n-   **精度**：使用大振幅（$A=0.1$）波。这是不正确的，因为非线性效应将占主导地位，使其不适用于一个干净的精度测试。它还缺少收敛性研究（单一分辨率 $N=128$），使其无法确定精度阶。\n-   **鲁棒性**：使用Orszag–Tang作为“激波管的代理”，这是一个不精确的框架。\n-   **散度控制**：依赖于从能量守恒的“间接”推断。这是不可靠且不可接受的；必须直接测量 $\\mathbf{B}$ 的散度。\n-   **结论**：该方案由于使用了不正确的方法论和诊断量而存在根本性缺陷。**错误**。\n\n**选项 C：**\n-   **精度**：使用网格对齐的一维波和单一分辨率。这是一个薄弱、不严格的测试，可能会掩盖错误且无法测量收敛性。\n-   **鲁棒性**：对转子测试使用反射边界，这是非标准的，并且会因边界相互作用而使物理过程复杂化，使得与既有结果的比较变得困难。\n-   **散度控制**：提议检查 $\\nabla \\cdot \\mathbf{v}$ 而非 $\\nabla \\cdot \\mathbf{B}$。这是一个荒谬的替代，因为无散约束适用于磁场，而不是速度场（在可压缩MHD中，速度场不是无散的）。\n-   **结论**：该方案显示了对物理和验证目标的关键性误解。**错误**。\n\n**选项 D：**\n-   **精度**：通过使用激波管（Brio–Wu）评估精度来混淆目标。激波捕捉格式在间断处不具备高阶精度，因此该测试无法测量光滑流的形式精度。\n-   **鲁棒性**：使用小振幅线性波来评估鲁棒性。这是不正确的。线性波是光滑的，不能测试程序在激波或强非线性情况下的行为。\n-   **散度控制**：提议监测 $\\nabla \\cdot \\mathbf{v}$（如C所述，不正确）和平均磁场 $\\langle \\mathbf{B} \\rangle$。在周期性域上 $\\langle \\mathbf{B} \\rangle$ 的守恒是平凡的，并且不提供任何关于局部散度误差的信息，而局部散度误差是非物理力的来源。\n-   **结论**：该方案完全颠倒了精度和鲁棒性测试的角色，并为散度控制使用了不相关的诊断量。**错误**。\n\n基于这一严谨的分析，选项A是唯一一个科学上合理、方法上正确，并且没有混淆验证目标的方案。它为每个目标采用了正确的测试、正确的参数和正确的诊断量。", "answer": "$$\\boxed{A}$$", "id": "3520099"}]}