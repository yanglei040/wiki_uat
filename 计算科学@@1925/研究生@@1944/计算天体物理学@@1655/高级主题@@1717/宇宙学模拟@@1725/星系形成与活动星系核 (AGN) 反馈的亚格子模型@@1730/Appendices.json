{"hands_on_practices": [{"introduction": "活动星系核（AGN）和星暴反馈通常被认为是“动量驱动的”。本练习探讨了中心源光度与其传递给周围气体的动量之间的基本联系，特别是光子在光学厚介质中的多次散射如何显著增强动量输出。通过这项计算[@problem_id:3537605]，您将获得估算星系外流终端速度的实践经验，这是反馈过程的一个关键可观测特征。", "problem": "在一个用于星系形成和活动星系核（AGN）反馈的次网格辐射压反馈模型中，含尘气体将紫外辐射再处理成红外辐射，从而导致与红外光深成正比的动量增益。假设全波段光度为 $L$ 的辐射以一定速率将动量赋予气体，该速率由红外波段中光深为 $\\tau_{\\mathrm{IR}}$ 的多次散射产生的有效动量通量所表征。质量流出率通过质量加载因子 $\\eta$ 与恒星形成物质库相关联，关系式为 $\\dot{M}_{\\mathrm{out}} = \\eta \\,\\dot{M}_{\\star}$，其中 $\\dot{M}_{\\star}$ 是恒星形成率（SFR）。在稳态、动量驱动极限下，假设启动尺度上的引力可忽略不计且耦合是各向同性的，可以通过令辐射驱动的动量通量等于星风动量通量来估计星风的终端速度 $v_{\\infty}$。\n\n从基本的辐射动量转移和动量守恒原理出发，在以下条件下，计算辐射驱动的动量通量并估算星风终端速度：$\\tau_{\\mathrm{IR}} = 5$，$L = 10^{46}\\,\\mathrm{erg\\,s^{-1}}$，$\\eta = 1$，以及 $\\dot{M}_{\\star} = 50\\,M_{\\odot}\\,\\mathrm{yr^{-1}}$。使用光速 $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$，太阳质量 $M_{\\odot} = 1.98847 \\times 10^{33}\\,\\mathrm{g}$，以及 $1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$。将你的答案四舍五入到4位有效数字。将动量通量以达因（dyne）表示，终端速度以 $\\mathrm{km\\,s^{-1}}$ 表示。解决方案必须从第一性原理出发来证明所用公式的合理性，不得援引超出所述假设的经验拟合函数或未解析的参数化方法。", "solution": "**1. 问题验证**\n\n*   **第1步：提取给定条件**\n    *   模型：次网格辐射压反馈，动量增益与红外光深 $\\tau_{\\mathrm{IR}}$ 成正比。\n    *   光度：$L = 10^{46}\\,\\mathrm{erg\\,s^{-1}}$\n    *   红外光深：$\\tau_{\\mathrm{IR}} = 5$\n    *   质量加载因子：$\\eta = 1$\n    *   恒星形成率：$\\dot{M}_{\\star} = 50\\,M_{\\odot}\\,\\mathrm{yr^{-1}}$\n    *   质量流出率：$\\dot{M}_{\\mathrm{out}} = \\eta \\,\\dot{M}_{\\star}$\n    *   假设：稳态、动量驱动极限，启动尺度引力可忽略，各向同性耦合。\n    *   目标：计算辐射驱动的动量通量和星风终端速度 $v_{\\infty}$。\n    *   常数：$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$，$M_{\\odot} = 1.98847 \\times 10^{33}\\,\\mathrm{g}$，$1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$。\n    *   输出要求：四舍五入至4位有效数字；动量通量单位为达因；速度单位为 $\\mathrm{km\\,s^{-1}}$。\n\n*   **第2步：使用提取的已知条件进行验证**\n    *   **科学依据**：该问题描述了一个标准的简化模型，即由 AGN 或星暴的辐射压驱动的“动量驱动”星系风，这是理论天体物理学中一个成熟的概念。\n    *   **良态问题**：该问题提供了所有必要的参数和一个清晰的物理模型，可以唯一地确定所求的量。简化假设（稳态、零引力）使其可解。\n    *   **客观性**：语言是技术性的，没有主观性。\n    *   **缺陷检查清单**：该问题没有违反任何指定的无效标准。物理学是合理的（在模型的框架内），设置是完整和一致的，数值对于类星体/ULIRG环境是合理的，并且问题结构逻辑清晰。这是物理原理在天体物理场景中的标准应用。\n\n*   **第3步：结论与行动**\n    *   **结论**：问题有效。\n    *   **行动**：进行完整解答。\n\n**2. 解题推导**\n\n问题将分两部分解决：首先，计算辐射动量通量；其次，估算星风终端速度。\n\n**第1部分：辐射驱动的动量通量**\n\n基本原理是辐射场向物质的动量转移。根据相对论，能量为 $E$ 的光子携带的动量为 $p = E/c$，其中 $c$ 是光速。中心源的能量发射率是其全波段光度 $L = dE/dt$。因此，辐射场带走动量的速率，即光子的动量通量，是 $\\dot{p}_{\\gamma} = d p/dt = (1/c) dE/dt = L/c$。\n\n在这个问题的情境中，辐射与含尘气体相互作用。赋予气体的总动量是两种效应的总和：\n1.  对高能（紫外/光学）光子的初始吸收。如果所有光子都被吸收，这将以 $\\dot{p}_{\\mathrm{abs}} = L/c$ 的速率转移动量。\n2.  被加热的尘埃在红外波段对该能量的再辐射，以及这些红外光子在光学厚介质内的后续多次散射。问题指出，这会导致与红外光深 $\\tau_{\\mathrm{IR}}$ 成正比的“动量增益”。在一个标准的光学厚、辐射压支撑的介质中，一个光子在逃逸前会进行随机行走，并在此过程中传递其动量大约 $\\tau_{\\mathrm{IR}}$ 次。这提供了一个额外的动量通量 $\\dot{p}_{\\mathrm{scatter}} \\approx \\tau_{\\mathrm{IR}} (L/c)$。\n\n赋予气体的总辐射动量通量 $\\dot{p}_{\\mathrm{rad}}$ 是初始吸收和后续多次散射动量的总和。\n$$\n\\dot{p}_{\\mathrm{rad}} = \\dot{p}_{\\mathrm{abs}} + \\dot{p}_{\\mathrm{scatter}} = \\frac{L}{c} + \\tau_{\\mathrm{IR}} \\frac{L}{c} = (1 + \\tau_{\\mathrm{IR}}) \\frac{L}{c}\n$$\n该公式是在模型的简化假设下，从辐射转移的第一性原理推导出来的，而不是一个任意的经验函数。给定值为 $L = 10^{46}\\,\\mathrm{erg\\,s^{-1}}$，$\\tau_{\\mathrm{IR}} = 5$，以及 $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$。代入这些值：\n$$\n\\dot{p}_{\\mathrm{rad}} = (1 + 5) \\frac{10^{46}\\,\\mathrm{erg\\,s^{-1}}}{2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}}\n$$\n$$\n\\dot{p}_{\\mathrm{rad}} = \\frac{6 \\times 10^{46}}{2.99792458 \\times 10^{10}}\\,\\mathrm{erg\\,cm^{-1}}\n$$\n单位 $\\mathrm{erg\\,cm^{-1}}$ 等价于 $\\mathrm{g\\,cm^{2}\\,s^{-2} / cm} = \\mathrm{g\\,cm\\,s^{-2}}$，这是CGS制中的力的单位，即达因（dyne）。\n$$\n\\dot{p}_{\\mathrm{rad}} \\approx 2.0013856 \\times 10^{36}\\,\\mathrm{dyne}\n$$\n四舍五入到4位有效数字，辐射驱动的动量通量为 $2.001 \\times 10^{36}\\,\\mathrm{dyne}$。\n\n**第2部分：星风终端速度**\n\n问题要求通过使辐射驱动的动量通量等于星风的动量通量来估算星风的终端速度 $v_{\\infty}$。这是一个稳态、动量驱动流出的条件，其中辐射力与流出物质的动量增益率相平衡。\n\n星风的动量通量 $\\dot{p}_{\\mathrm{wind}}$ 是质量流出率 $\\dot{M}_{\\mathrm{out}}$ 与星风终端速度 $v_{\\infty}$ 的乘积。\n$$\n\\dot{p}_{\\mathrm{wind}} = \\dot{M}_{\\mathrm{out}} v_{\\infty}\n$$\n问题指明，质量流出率通过质量加载因子 $\\eta$ 与恒星形成率 $\\dot{M}_{\\star}$ 相关：\n$$\n\\dot{M}_{\\mathrm{out}} = \\eta \\dot{M}_{\\star}\n$$\n因此，星风动量通量为：\n$$\n\\dot{p}_{\\mathrm{wind}} = \\eta \\dot{M}_{\\star} v_{\\infty}\n$$\n令辐射动量通量与星风动量通量相等，$\\dot{p}_{\\mathrm{rad}} = \\dot{p}_{\\mathrm{wind}}$：\n$$\n(1 + \\tau_{\\mathrm{IR}}) \\frac{L}{c} = \\eta \\dot{M}_{\\star} v_{\\infty}\n$$\n我们现在可以解出终端速度 $v_{\\infty}$：\n$$\nv_{\\infty} = \\frac{(1 + \\tau_{\\mathrm{IR}}) L}{\\eta \\dot{M}_{\\star} c}\n$$\n为了计算数值，我们首先需要将恒星形成率 $\\dot{M}_{\\star}$ 转换为 CGS 单位（$\\mathrm{g\\,s^{-1}}$）。给定 $\\dot{M}_{\\star} = 50\\,M_{\\odot}\\,\\mathrm{yr^{-1}}$，$M_{\\odot} = 1.98847 \\times 10^{33}\\,\\mathrm{g}$，以及 $1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$。\n$$\n\\dot{M}_{\\star} = 50 \\frac{M_{\\odot}}{\\mathrm{yr}} = 50 \\times \\frac{1.98847 \\times 10^{33}\\,\\mathrm{g}}{3.15576 \\times 10^{7}\\,\\mathrm{s}}\n$$\n$$\n\\dot{M}_{\\star} \\approx 3.150495 \\times 10^{27}\\,\\mathrm{g\\,s^{-1}}\n$$\n现在我们将 $\\eta=1$、$\\dot{M}_{\\star}$ 以及先前计算出的 $\\dot{p}_{\\mathrm{rad}}$ 的值代入 $v_{\\infty}$ 的表达式中。\n$$\nv_{\\infty} = \\frac{\\dot{p}_{\\mathrm{rad}}}{\\eta \\dot{M}_{\\star}} = \\frac{2.0013856 \\times 10^{36}\\,\\mathrm{g\\,cm\\,s^{-2}}}{1 \\times (3.150495 \\times 10^{27}\\,\\mathrm{g\\,s^{-1}})}\n$$\n$$\nv_{\\infty} \\approx 6.35260 \\times 10^{8}\\,\\mathrm{cm\\,s^{-1}}\n$$\n问题要求答案以 $\\mathrm{km\\,s^{-1}}$ 为单位。我们使用换算关系 $1\\,\\mathrm{km} = 10^{5}\\,\\mathrm{cm}$。\n$$\nv_{\\infty} \\approx \\frac{6.35260 \\times 10^{8}\\,\\mathrm{cm\\,s^{-1}}}{10^{5}\\,\\mathrm{cm\\,km^{-1}}} \\approx 6352.60\\,\\mathrm{km\\,s^{-1}}\n$$\n四舍五入到4位有效数字，星风终端速度为 $6353\\,\\mathrm{km\\,s^{-1}}$。\n\n最终计算出的值为动量通量 $2.001 \\times 10^{36}\\,\\mathrm{dyne}$ 和终端速度 $6353\\,\\mathrm{km\\,s^{-1}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2.001 \\times 10^{36} & 6.353 \\times 10^{3} \\end{pmatrix}}\n$$", "id": "3537605"}, {"introduction": "除了热能和辐射，宇宙射线（CRs）是反馈的一个关键组成部分，但它们的输运过程很复杂。本练习侧重于宇宙射线的两种主要输运机制：随气体流动的平流和穿过磁场的扩散。一个强大的分析技术是通过比较它们的特征时间尺度来判断哪种过程占主导地位。通过这种量纲分析[@problem_id:3537587]，您将学会计算佩克莱数（Péclet number），这是一个无量纲数，能立即告诉您宇宙射线是被锁定在气体中还是能够独立地流出。", "problem": "在一个包含亚网格宇宙射线（CRs）输运和活动星系核（AGN）反馈的大涡星系形成模拟中，假设宇宙射线（CR）的扩散系数 $\\,\\kappa\\,$ 是各向同性的，并且存在一个可在网格上解析的特征宇宙射线梯度长度尺度 $\\,L\\,$。速度为 $\\,v\\,$ 的稳定星系风平流输运宇宙射线。从标准的宇宙射线输运方程的扩散-平流形式出发，并利用扩散和对流算符的量纲分析来定义特征时间尺度，推导出在长度尺度 $\\,L\\,$ 上，扩散时间尺度与平流时间尺度的无量纲比值 $\\,R\\,$。然后，对于 $\\,\\kappa = 3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}$，$\\,L = 1\\,\\mathrm{kpc}$，以及 $\\,v = 300\\,\\mathrm{km\\,s^{-1}}$，计算 $\\,R\\,$ 的值。使用厘米-克-秒（cgs）单位制，其中 $\\,1\\,\\mathrm{kpc} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}\\,$ 且 $\\,1\\,\\mathrm{km\\,s^{-1}} = 10^{5}\\,\\mathrm{cm\\,s^{-1}}$。报告 $\\,R\\,$ 的单个数值（无单位）。将你的答案四舍五入到四位有效数字。", "solution": "该问题陈述经评估有效。其科学基础是已确立的宇宙射线输运物理学，问题表述清晰，信息充足，可得到唯一解，并以客观、精确的语言表达。在计算天体物理学的背景下，所有提供的数据和条件都是一致且物理上合理的。\n\n任务是推导星系风中宇宙射线（CRs）的扩散时间尺度与平流时间尺度之间的无量纲比值 $R$，然后数值计算这个比值。\n\n我们从输运宇宙射线能量密度（记为 $e_{cr}$）的标准扩散-平流方程开始。在没有源项和汇项的情况下，方程为：\n$$\n\\frac{\\partial e_{cr}}{\\partial t} + \\nabla \\cdot \\mathbf{F}_{cr} = 0\n$$\n其中 $\\mathbf{F}_{cr}$ 是宇宙射线通量。该通量由气体整体运动（星系风）引起的平流分量和宇宙射线与磁场不规则性散射引起的扩散分量组成。通量的表达式为：\n$$\n\\mathbf{F}_{cr} = \\mathbf{v} e_{cr} - \\kappa \\nabla e_{cr}\n$$\n此处，$\\mathbf{v}$ 是风速，$\\kappa$ 是各向同性的宇宙射线扩散系数。将通量代入输运方程得到：\n$$\n\\frac{\\partial e_{cr}}{\\partial t} = -\\nabla \\cdot (\\mathbf{v} e_{cr}) + \\nabla \\cdot (\\kappa \\nabla e_{cr})\n$$\n右边的第一项代表平流，第二项代表扩散。我们可以通过量纲分析确定每个过程的特征时间尺度。设 $L$ 为宇宙射线能量密度 $e_{cr}$ 发生显著变化的特征长度尺度。\n\n平流项为 $\\mathcal{A} = -\\nabla \\cdot (\\mathbf{v} e_{cr})$。假设风速 $\\mathbf{v}$ 为大小是 $v$ 的常数，其量级可以估计为：\n$$\n|\\mathcal{A}| \\sim v |\\nabla e_{cr}| \\sim v \\frac{e_{cr}}{L}\n$$\n平流过程在时间尺度 $\\tau_{adv}$ 上改变宇宙射线能量密度，使得变化率近似为 $\\frac{e_{cr}}{\\tau_{adv}}$。将其与平流算符的量级相等，得到：\n$$\n\\frac{e_{cr}}{\\tau_{adv}} \\sim v \\frac{e_{cr}}{L} \\implies \\tau_{adv} \\sim \\frac{L}{v}\n$$\n这是风将宇宙射线输运过长度尺度 $L$ 所需的时间。\n\n扩散项为 $\\mathcal{D} = \\nabla \\cdot (\\kappa \\nabla e_{cr})$。假设扩散系数 $\\kappa$ 为常数，其量级可以估计为：\n$$\n|\\mathcal{D}| \\sim \\kappa |\\nabla^2 e_{cr}| \\sim \\kappa \\frac{e_{cr}}{L^2}\n$$\n扩散过程在时间尺度 $\\tau_{diff}$ 上改变宇宙射线能量密度，使得变化率近似为 $\\frac{e_{cr}}{\\tau_{diff}}$。将其与扩散算符的量级相等，得到：\n$$\n\\frac{e_{cr}}{\\tau_{diff}} \\sim \\kappa \\frac{e_{cr}}{L^2} \\implies \\tau_{diff} \\sim \\frac{L^2}{\\kappa}\n$$\n这是宇宙射线扩散过长度尺度 $L$ 的特征时间。\n\n问题要求扩散时间尺度与平流时间尺度的无量纲比值 $R$。\n$$\nR = \\frac{\\tau_{diff}}{\\tau_{adv}}\n$$\n代入推导出的时间尺度表达式：\n$$\nR = \\frac{L^2 / \\kappa}{L / v} = \\frac{L^2}{\\kappa} \\frac{v}{L} = \\frac{vL}{\\kappa}\n$$\n这个比值也称为佩克莱特数（Péclet number），它比较了平流输运和扩散输运的相对重要性。\n\n接下来，我们使用给定的数值计算 $R$。我们必须首先将所有量转换到厘米-克-秒（cgs）单位制。\n给定的值为：\n$\\kappa = 3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}$\n$L = 1\\,\\mathrm{kpc}$\n$v = 300\\,\\mathrm{km\\,s^{-1}}$\n\n转换因子为：\n$1\\,\\mathrm{kpc} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}$\n$1\\,\\mathrm{km\\,s^{-1}} = 10^{5}\\,\\mathrm{cm\\,s^{-1}}$\n\n转换长度尺度 $L$：\n$$\nL = 1\\,\\mathrm{kpc} \\times \\frac{3.085677581 \\times 10^{21}\\,\\mathrm{cm}}{1\\,\\mathrm{kpc}} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}\n$$\n转换风速 $v$：\n$$\nv = 300\\,\\mathrm{km\\,s^{-1}} \\times \\frac{10^{5}\\,\\mathrm{cm\\,s^{-1}}}{1\\,\\mathrm{km\\,s^{-1}}} = 3 \\times 10^2 \\times 10^5\\,\\mathrm{cm\\,s^{-1}} = 3 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}\n$$\n现在，我们将这些 cgs 单位制的值代入 $R$ 的表达式中：\n$$\nR = \\frac{vL}{\\kappa} = \\frac{(3 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}) \\times (3.085677581 \\times 10^{21}\\,\\mathrm{cm})}{3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}}\n$$\n单位如预期一样抵消了：$(\\mathrm{cm\\,s^{-1}} \\cdot \\mathrm{cm}) / (\\mathrm{cm^{2}\\,s^{-1}}) = 1$。\n$$\nR = \\frac{3 \\times 3.085677581 \\times 10^{7+21}}{3 \\times 10^{28}} = \\frac{3.085677581 \\times 10^{28}}{10^{28}} = 3.085677581\n$$\n问题要求答案四舍五入到四位有效数字。前五位有效数字是 $3.0856$。由于第五位数字（$6$）大于或等于 $5$，我们将第四位数字向上取整。\n$$\nR \\approx 3.086\n$$", "answer": "$$\n\\boxed{3.086}\n$$", "id": "3537587"}, {"introduction": "星系形成模拟必须正确模拟为恒星形成和黑洞增长提供燃料的稠密气体，但在这些尺度上解析所有物理过程是不可能的。这项计算实验[@problem_id:3537584]旨在解决一个常见的数值问题，即“人工碎裂”，其中未解析的湍流会导致虚假的引力坍缩。您将设计并测试一个“压力下限”次网格模型，该模型通过增加非热压力支持来防止这种情况发生。这项高级练习挑战您像模拟开发者一样思考，权衡数值稳定性的需求与引入物理结果（如黑洞吸积率）偏差的风险。", "problem": "要求您设计并实现一个计算实验，以评估形式为 $P_{\\mathrm{floor}} = K \\,\\rho^{\\gamma_{\\mathrm{eff}}}$ 的次网格压力下限，是否能够在不使黑洞吸积历史产生偏差的同时，防止受活动星系核（AGN）影响的星系核区出现人为碎裂。评估必须纯粹基于第一性原理和经过充分检验的公式，并且您的程序必须为一组测试用例做出判断。\n\n从以下基本依据开始：\n- 正压流体中的金斯不稳定性判据，其中瞬时有效声速为 $c_s^2 = \\mathrm{d}P/\\mathrm{d}\\rho$，金斯长度为\n$$\n\\lambda_J = \\sqrt{\\frac{\\pi\\, c_s^2}{G\\,\\rho}}.\n$$\n- 质量为 $M_{\\mathrm{BH}}$ 的黑洞在密度为 $\\rho$、声速为 $c_s$、相对速度为 $v$ 的气体中的邦迪吸积率（稳态、球对称），\n$$\n\\dot{M}_{\\mathrm{Bondi}} \\propto \\frac{\\rho\\, G^2 M_{\\mathrm{BH}}^2}{\\left(c_s^2 + v^2\\right)^{3/2}},\n$$\n该公式仅用于比例计算，因此在比较分析中所有比例常数都会被抵消。\n\n您必须：\n1. 在次网格压力下限 $P_{\\mathrm{floor}} = K\\,\\rho^{\\gamma_{\\mathrm{eff}}}$ 的作用下，将气体视为正压的，因此有 $c_{s,\\mathrm{eff}}^2 = \\mathrm{d}P_{\\mathrm{floor}}/\\mathrm{d}\\rho$。\n2. 选择系数 $K$，使得金斯长度要求 $\\lambda_J \\ge N_J \\Delta x$ 对AGN核区密度范围 $\\rho \\in [\\rho_{\\min}, \\rho_{\\max}]$ 内的所有密度都成立。为实现此目的，请根据所选 $\\gamma_{\\mathrm{eff}}$ 决定的 $\\lambda_J(\\rho)$ 的单调性，确定该范围内约束性最强的参考密度 $\\rho_{\\mathrm{ref}}$，并通过强制 $\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x$ 来设定 $K$。您必须从上述基本依据中推导所需的表达式；不要假设或引入任何其他闭式解。\n3. 通过在每个密度下比较施加和未施加压力下限时评估的邦迪吸积率，来量化吸积偏差。采用一个热学基线，其气体温度为 $T_0$，绝热指数为 $\\gamma_{\\mathrm{ad}}$，从而得到基线热声速 $c_{s,0}^2 = \\gamma_{\\mathrm{ad}} k_B T_0 / (\\mu m_p)$。当压力下限生效时，使用 $c_{s,\\mathrm{use}}^2(\\rho) = \\max\\left(c_{s,0}^2,\\; c_{s,\\mathrm{eff}}^2(\\rho)\\right)$。对于每个密度，定义瞬时比率\n$$\n\\mathcal{R}(\\rho) \\equiv \\frac{\\dot{M}_{\\mathrm{Bondi, floor}}(\\rho)}{\\dot{M}_{\\mathrm{Bondi, base}}(\\rho)} = \\left(\\frac{c_{s,0}^2 + v^2}{c_{s,\\mathrm{use}}^2(\\rho) + v^2}\\right)^{3/2}.\n$$\n在一个包含 $N_{\\mathrm{dens}}$ 个密度点、范围从 $n_{\\mathrm{H},\\min}$ 到 $n_{\\mathrm{H},\\max}$ 的固定对数间隔网格上，使用与 $\\rho$ 成正比的质量加权进行密度范围的聚合，其中 $\\rho = \\mu m_p n_{\\mathrm{H}}$。定义质量加权平均比率\n$$\n\\overline{\\mathcal{R}} = \\frac{\\sum_i \\rho_i \\,\\mathcal{R}(\\rho_i)}{\\sum_i \\rho_i}.\n$$\n对于指定的容差 $\\tau$，如果满足 $|\\overline{\\mathcal{R}} - 1| \\le \\tau$，则声明该次网格压力下限是“无偏差的”。\n4. 如果在使用压力下限 $P_{\\mathrm{floor}}$ 及其对应的 $c_{s,\\mathrm{eff}}(\\rho)$ 进行评估时，网格中的所有密度都满足金斯判据，即 $\\lambda_J(\\rho) \\ge N_J \\Delta x$，则声明该压力下限“防止了人为碎裂”。\n5. 对每个测试用例，输出一个布尔值。当且仅当该模型同时满足以下两个条件时，该布尔值为真：根据上述判据，它防止了人为碎裂且是无偏差的。\n\n常数、单位和固定选项：\n- 全程使用厘米-克-秒（CGS）单位制。引力常数 $G$ 的单位为 $\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$，玻尔兹曼常数 $k_B$ 的单位为 $\\mathrm{erg\\,K^{-1}}$，质子质量 $m_p$ 的单位为 $\\mathrm{g}$，太阳质量 $M_\\odot$ 的单位为 $\\mathrm{g}$，秒差距的单位为 $\\mathrm{cm}$。\n- 使用平均分子量 $\\mu = 0.62$，绝热指数 $\\gamma_{\\mathrm{ad}} = 5/3$，基线温度 $T_0 = 10^{4}\\,\\mathrm{K}$。\n- 使用一个对数间隔的密度网格，包含 $N_{\\mathrm{dens}} = 64$ 个从 $n_{\\mathrm{H},\\min} = 10^{2}\\,\\mathrm{cm^{-3}}$ 到 $n_{\\mathrm{H},\\max} = 10^{5}\\,\\mathrm{cm^{-3}}$ 的样本。通过 $\\rho = \\mu m_p n_{\\mathrm{H}}$ 转换为质量密度。\n- 使用容差 $\\tau = 0.25$ （即，质量加权平均比率中高达四分之一的偏差是可接受的）。\n- 邦迪吸积中的质量 $M_{\\mathrm{BH}}$ 以太阳质量为单位给出，但在比率计算中会被抵消；为完整性和科学真实性起见，仍将其包含在参数中。\n\n待评估的参数集测试套件：\n- 情况A（理想路径）：$\\Delta x = 5\\,\\mathrm{pc}$，$N_J = 4$，$\\gamma_{\\mathrm{eff}} = 4/3$，$M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$，$v = 50\\,\\mathrm{km\\,s^{-1}}$。\n- 情况B（粗分辨率下易产生偏差的等温下限）：$\\Delta x = 20\\,\\mathrm{pc}$，$N_J = 4$，$\\gamma_{\\mathrm{eff}} = 1.0$，$M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$，$v = 10\\,\\mathrm{km\\,s^{-1}}$。\n- 情况C（低相对速度下的硬压力下限）：$\\Delta x = 5\\,\\mathrm{pc}$，$N_J = 4$，$\\gamma_{\\mathrm{eff}} = 2.0$，$M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$，$v = 10\\,\\mathrm{km\\,s^{-1}}$。\n- 情况D（硬压力下限但相对速度高）：$\\Delta x = 5\\,\\mathrm{pc}$，$N_J = 4$，$\\gamma_{\\mathrm{eff}} = 2.0$，$M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$，$v = 300\\,\\mathrm{km\\,s^{-1}}$。\n- 情况E（高分辨率下的多方压力下限）：$\\Delta x = 0.5\\,\\mathrm{pc}$，$N_J = 4$，$\\gamma_{\\mathrm{eff}} = 4/3$，$M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$，$v = 10\\,\\mathrm{km\\,s^{-1}}$。\n\n实现要求：\n- 对每种情况，通过在 $[\\rho_{\\min}, \\rho_{\\max}]$ 内约束性最强的密度 $\\rho_{\\mathrm{ref}}$ 处强制施加 $\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x$ 来计算系数 $K$。该密度由 $\\gamma_{\\mathrm{eff}}$ 所决定的 $\\mathrm{d}\\ln \\lambda_J / \\mathrm{d}\\ln \\rho$ 的符号确定。然后，在整个密度网格上评估上述两个判据，并将它们合并为最终的布尔值。\n- 角度单位不适用。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，[result_1,result_2,...]），其中每个条目是与A、B、C、D、E案例顺序对应的布尔值。\n\n所有数值输入均已在上方给出；请确保所有内部计算都使用指定的单位。最终输出是布尔值，因此无单位。", "solution": "该问题要求我们设计并实现一个计算实验，以评估次网格压力下限模型 $P_{\\mathrm{floor}} = K \\rho^{\\gamma_{\\mathrm{eff}}}$ 在防止模拟中出现人为碎裂，同时不使黑洞吸积率产生偏差的能力。我们必须基于第一性原理开发一个算法，以针对几种情景进行测试。解决方案遵循以下几个逻辑步骤。\n\n**1. 有效声速与金斯长度**\n压力下限由一个正压状态方程给出，$P_{\\mathrm{floor}} = K \\rho^{\\gamma_{\\mathrm{eff}}}$。相应的有效声速的平方 $c_{s,\\mathrm{eff}}^2$ 是压力对密度的导数：\n$$\nc_{s,\\mathrm{eff}}^2 = \\frac{\\mathrm{d}P_{\\mathrm{floor}}}{\\mathrm{d}\\rho} = \\frac{\\mathrm{d}}{\\mathrm{d}\\rho}\\left(K \\rho^{\\gamma_{\\mathrm{eff}}}\\right) = K \\gamma_{\\mathrm{eff}} \\rho^{\\gamma_{\\mathrm{eff}}-1}\n$$\n金斯长度 $\\lambda_J$ 是引力不稳定性的一个临界尺度。使用压力下限的有效声速，其表达式为：\n$$\n\\lambda_J(\\rho) = \\sqrt{\\frac{\\pi c_{s,\\mathrm{eff}}^2}{G \\rho}} = \\sqrt{\\frac{\\pi (K \\gamma_{\\mathrm{eff}} \\rho^{\\gamma_{\\mathrm{eff}}-1})}{G \\rho}} = \\sqrt{\\frac{\\pi K \\gamma_{\\mathrm{eff}}}{G}} \\rho^{\\frac{\\gamma_{\\mathrm{eff}}-2}{2}}\n$$\n其中 $G$ 是引力常数。\n\n**2. 确定系数 $K$**\n压力下限必须防止人为碎裂，这通过确保金斯长度总是能被最小数量的网格单元 $N_J$ 解析来实现。这是Truelove-Bate-Couchman判据的一种形式：对于相关范围 $[\\rho_{\\min}, \\rho_{\\max}]$ 内的所有密度 $\\rho$，$\\lambda_J(\\rho) \\ge N_J \\Delta x$。为确保此条件成立，我们必须在 $\\lambda_J(\\rho)$ 在该范围内达到其最小值的密度 $\\rho_{\\mathrm{ref}}$ 处强制执行此条件。\n\n$\\lambda_J(\\rho)$ 的单调性取决于 $\\rho$ 的指数符号，即 $(\\gamma_{\\mathrm{eff}}-2)/2$。\n- 如果 $\\gamma_{\\mathrm{eff}} < 2$，指数为负，因此 $\\lambda_J(\\rho)$ 是 $\\rho$ 的减函数。最小值出现在 $\\rho_{\\mathrm{ref}} = \\rho_{\\max}$ 处。\n- 如果 $\\gamma_{\\mathrm{eff}} > 2$，指数为正，因此 $\\lambda_J(\\rho)$ 是 $\\rho$ 的增函数。最小值出现在 $\\rho_{\\mathrm{ref}} = \\rho_{\\min}$ 处。\n- 如果 $\\gamma_{\\mathrm{eff}} = 2$，指数为零，$\\lambda_J(\\rho)$ 是常数。任何密度都可以选作 $\\rho_{\\mathrm{ref}}$；为保持一致性，我们可以选择其中一个边界，例如 $\\rho_{\\mathrm{ref}} = \\rho_{\\min}$。\n\n通过在这个约束性最强的密度处将金斯长度设置为所需的最小值，我们就能满足整个密度范围内的判据。\n$$\n\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x\n$$\n两边平方并代入 $\\lambda_J(\\rho)$ 的表达式：\n$$\n(N_J \\Delta x)^2 = \\frac{\\pi K \\gamma_{\\mathrm{eff}}}{G} \\rho_{\\mathrm{ref}}^{\\gamma_{\\mathrm{eff}}-2}\n$$\n解出系数 $K$：\n$$\nK = \\frac{(N_J \\Delta x)^2 G}{\\pi \\gamma_{\\mathrm{eff}}} \\rho_{\\mathrm{ref}}^{2-\\gamma_{\\mathrm{eff}}}\n$$\n该公式为每个测试用例定义了 $K$ 的值。\n\n**3. 碎裂防止条件**\n成功的模型的第一个条件是它能防止人为碎裂。根据题目要求，如果在我们的测试网格上所有密度都满足 $\\lambda_J(\\rho) \\ge N_J \\Delta x$，则该条件为真。根据我们对 $K$ 的构造，我们已在连续范围的 $\\lambda_J(\\rho)$ 最小值处设定了等式，因此该条件保证对 $\\rho \\in [\\rho_{\\min}, \\rho_{\\max}]$ 内的所有密度成立，从而也对其中的所有离散点成立。此条件的标志位 `prevents_fragmentation` 将通过对离散密度网格上的所有点进行显式检查来确定。\n\n**4. 吸积偏差条件**\n第二个条件是压力下限不会对由邦迪吸积率 $\\dot{M}_{\\mathrm{Bondi}}$ 建模的黑洞吸积率产生不当偏差。我们将施加压力下限时的吸积率与一个基线热学情况进行比较。\n\n基线情况假设气体具有恒定温度 $T_0$ 和绝热指数 $\\gamma_{\\mathrm{ad}}$。基线声速的平方为：\n$$\nc_{s,0}^2 = \\frac{\\gamma_{\\mathrm{ad}} k_B T_0}{\\mu m_p}\n$$\n其中 $k_B$ 是玻尔兹曼常数，$\\mu$ 是平均分子量，$m_p$ 是质子质量。\n\n当压力下限实验生效时，模拟中使用的声速应为基线热声速与压力下限的有效声速之间的最大值：\n$$\nc_{s,\\mathrm{use}}^2(\\rho) = \\max\\left(c_{s,0}^2, c_{s,\\mathrm{eff}}^2(\\rho)\\right)\n$$\n邦迪吸积率与 $(c_s^2 + v^2)^{-3/2}$ 成正比，其中 $v$ 是黑洞与气体之间的相对速度。吸积偏差通过比率 $\\mathcal{R}(\\rho)$ 进行量化：\n$$\n\\mathcal{R}(\\rho) = \\frac{\\dot{M}_{\\mathrm{Bondi, floor}}}{\\dot{M}_{\\mathrm{Bondi, base}}} = \\frac{\\left(c_{s,\\mathrm{use}}^2(\\rho) + v^2\\right)^{-3/2}}{\\left(c_{s,0}^2 + v^2\\right)^{-3/2}} = \\left(\\frac{c_{s,0}^2 + v^2}{c_{s,\\mathrm{use}}^2(\\rho) + v^2}\\right)^{3/2}\n$$\n注意，邦迪公式中的所有其他项（$\\rho$、$G$、$M_{\\mathrm{BH}}$）都相互抵消了。\n\n为了得到一个单一的偏差度量，我们在一个从 $n_{\\mathrm{H},\\min}$ 到 $n_{\\mathrm{H},\\max}$ 的包含 $N_{\\mathrm{dens}}$ 个气体数密度的对数网格上，计算 $\\mathcal{R}(\\rho)$ 的质量加权平均值。质量密度为 $\\rho_i = \\mu m_p n_{\\mathrm{H},i}$。\n$$\n\\overline{\\mathcal{R}} = \\frac{\\sum_{i=1}^{N_{\\mathrm{dens}}} \\rho_i \\mathcal{R}(\\rho_i)}{\\sum_{i=1}^{N_{\\mathrm{dens}}} \\rho_i}\n$$\n如果平均比率接近于1，特别是如果 $|\\overline{\\mathcal{R}} - 1| \\le \\tau$（其中 $\\tau$ 是给定的容差），则认为该压力下限是“无偏差的”。\n\n**5. 算法摘要**\n对于每个测试用例 $(\\Delta x, N_J, \\gamma_{\\mathrm{eff}}, M_{\\mathrm{BH}}, v)$：\n1. 定义常数并将所有输入转换为一致的CGS单位制。\n2. 创建一个从 $n_{\\mathrm{H},\\min}$ 到 $n_{\\mathrm{H},\\max}$ 的包含 $N_{\\mathrm{dens}}$ 个点的对数间隔数密度网格 $n_{\\mathrm{H},i}$，并将其转换为质量密度网格 $\\rho_i$。\n3. 通过比较 $\\gamma_{\\mathrm{eff}}$ 与 $2$ 来确定参考密度 $\\rho_{\\mathrm{ref}}$。如果 $\\gamma_{\\mathrm{eff}} < 2$，则 $\\rho_{\\mathrm{ref}} = \\rho_{\\max}$；否则，$\\rho_{\\mathrm{ref}} = \\rho_{\\min}$。\n4. 使用 $\\rho_{\\mathrm{ref}}$ 和测试用例参数计算系数 $K$。\n5. 计算网格上每个密度的 $c_{s,\\mathrm{eff}}^2(\\rho_i)$。\n6. 验证碎裂条件：检查是否对所有 $i$ 都有 $\\sqrt{\\pi c_{s,\\mathrm{eff}}^2(\\rho_i) / (G \\rho_i)} \\ge N_J \\Delta x$。\n7. 计算基线声速的平方 $c_{s,0}^2$。\n8. 计算所有 $i$ 的 $c_{s,\\mathrm{use}}^2(\\rho_i) = \\max(c_{s,0}^2, c_{s,\\mathrm{eff}}^2(\\rho_i))$。\n9. 计算所有 $i$ 的 $\\mathcal{R}(\\rho_i)$。\n10. 计算质量加权平均值 $\\overline{\\mathcal{R}}$。\n11. 验证无偏差条件：检查是否 $|\\overline{\\mathcal{R}} - 1| \\le \\tau$。\n12. 测试用例的最终结果是防止碎裂和无偏差两个布尔结果的逻辑与。```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating a sub-grid pressure floor for AGN simulations.\n    This function sets up constants and test cases, then iterates through them,\n    calling a helper function to evaluate each case. Finally, it prints the\n    results in the specified format.\n    \"\"\"\n\n    # --- Constants in CGS units ---\n    G_CGS = 6.67430e-8    # cm^3 g^-1 s^-2\n    KB_CGS = 1.380649e-16   # erg K^-1 (g cm^2 s^-2 K^-1)\n    MP_CGS = 1.6726219e-24  # g\n    M_SUN_CGS = 1.98847e33    # g\n    PC_CGS = 3.08567758e18  # cm\n    KMS_TO_CMS = 1e5        # Factor to convert km/s to cm/s\n\n    # --- Fixed problem parameters ---\n    MU = 0.62               # Mean molecular weight\n    GAMMA_AD = 5.0 / 3.0    # Adiabatic index\n    T0 = 1e4                # K, Baseline gas temperature\n    N_DENS = 64             # Number of density samples\n    N_H_MIN = 1e2           # cm^-3, Min number density\n    N_H_MAX = 1e5           # cm^-3, Max number density\n    TAU = 0.25              # Tolerance for accretion bias\n\n    # --- Test suite of parameter sets ---\n    # (delta_x_pc, N_J, gamma_eff, M_BH_Msun, v_kms)\n    test_cases = [\n        (5.0, 4, 4.0/3.0, 1e8, 50.0),   # Case A\n        (20.0, 4, 1.0, 1e8, 10.0),    # Case B\n        (5.0, 4, 2.0, 1e8, 10.0),     # Case C\n        (5.0, 4, 2.0, 1e8, 300.0),    # Case D\n        (0.5, 4, 4.0/3.0, 1e8, 10.0),   # Case E\n    ]\n    \n    # --- Density grid setup ---\n    # Create a logarithmically spaced grid of number densities\n    n_h_grid = np.geomspace(N_H_MIN, N_H_MAX, N_DENS)\n    # Convert to mass density grid\n    rho_grid = MU * MP_CGS * n_h_grid\n    rho_min = rho_grid[0]\n    rho_max = rho_grid[-1]\n\n    # --- Baseline sound speed ---\n    cs0_sq = (GAMMA_AD * KB_CGS * T0) / (MU * MP_CGS)\n\n    results = []\n    for case in test_cases:\n        delta_x_pc, N_J, gamma_eff, M_BH_Msun, v_kms = case\n\n        # --- Unit conversions ---\n        delta_x = delta_x_pc * PC_CGS\n        v = v_kms * KMS_TO_CMS\n        \n        # --- Step 1: Determine K ---\n        # Determine the reference density rho_ref where Jeans length is minimal\n        if gamma_eff  2.0:\n            rho_ref = rho_max\n        else: # gamma_eff = 2.0\n            rho_ref = rho_min\n        \n        # Calculate the pressure floor coefficient K\n        # K = ( (N_J*dx)^2 * G / (pi*gamma_eff) ) * rho_ref^(2-gamma_eff)\n        K_coeff = ((N_J * delta_x)**2 * G_CGS) / (np.pi * gamma_eff)\n        K_coeff *= rho_ref**(2.0 - gamma_eff)\n\n        # --- Step 2: Evaluate fragmentation prevention condition ---\n        # c_s,eff^2 = K * gamma_eff * rho^(gamma_eff-1)\n        cs_eff_sq_grid = K_coeff * gamma_eff * rho_grid**(gamma_eff - 1.0)\n        \n        # lambda_J = sqrt(pi * c_s,eff^2 / (G * rho))\n        lambda_J_sq_grid = (np.pi * cs_eff_sq_grid) / (G_CGS * rho_grid)\n        lambda_J_grid = np.sqrt(lambda_J_sq_grid)\n\n        # Check if Jeans length is resolved at all densities in the grid.\n        # Use a small tolerance for floating point comparisons.\n        prevents_fragmentation = np.all(lambda_J_grid >= N_J * delta_x * (1.0 - 1e-9))\n\n        # --- Step 3: Evaluate accretion bias condition ---\n        # c_s,use^2 = max(c_s,0^2, c_s,eff^2)\n        cs_use_sq_grid = np.maximum(cs0_sq, cs_eff_sq_grid)\n\n        # R(rho) = ( (cs0^2 + v^2) / (cs_use^2 + v^2) )^(3/2)\n        numerator = cs0_sq + v**2\n        denominator = cs_use_sq_grid + v**2\n        R_grid = (numerator / denominator)**(1.5)\n\n        # Calculate mass-weighted mean of R\n        # np.average with weights=rho_grid does sum(R*rho)/sum(rho)\n        R_bar = np.average(R_grid, weights=rho_grid)\n\n        # Check if the bias is within tolerance\n        is_non_biasing = np.abs(R_bar - 1.0) = TAU\n\n        # --- Step 4: Final verdict for the case ---\n        # The model is valid if it prevents fragmentation AND is non-biasing.\n        final_verdict = prevents_fragmentation and is_non_biasing\n        results.append(final_verdict)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).capitalize(), results))}]\")\n\nsolve()\n\n```", "answer": "$$\n\\boxed{\\text{[True,False,False,True,False]}}\n$$", "id": "3537584"}]}