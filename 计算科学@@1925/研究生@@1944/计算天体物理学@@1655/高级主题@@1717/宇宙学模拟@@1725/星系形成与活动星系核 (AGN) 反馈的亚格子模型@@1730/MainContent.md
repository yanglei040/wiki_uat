## 引言
在广袤的宇宙中，[星系的形成与演化](@entry_id:160862)是一个横跨巨大尺度范围的复杂物理剧目。从单个恒星在致密[分子云](@entry_id:160702)中的诞生，到[超大质量黑洞](@entry_id:157796)驱动的横扫整个星系的巨大外流，这些关键过程发生在的尺度远小于[现代宇宙学](@entry_id:752086)[数值模拟](@entry_id:137087)所能企及的极限。这种尺度上的鸿沟构成了[计算天体物理学](@entry_id:145768)领域的核心挑战之一。为了架起这座连接微观物理现实与宏观模拟世界的桥梁，科学家们开发了“[次网格模型](@entry_id:755601)”（sub-grid models）。这些模型并非简单的数值技巧，而是基于物理定律的[有效理论](@entry_id:155490)，旨在捕捉那些无法被直接解析的过程对其可解析环境的集体效应。

本文将系统性地深入探讨[次网格模型](@entry_id:755601)。在“原理与机制”一章中，我们将揭示这些模型背后的基本概念，重点阐述[恒星形成](@entry_id:159940)、[黑洞](@entry_id:158571)生长与反馈等核心过程是如何被参数化的。随后，在“应用与跨学科联系”一章中，我们将展示这些模型如何被用来连接理论与观测，例如重现宇宙学标度律，并探讨其与[控制论](@entry_id:262536)等其他学科的深刻联系。最后，在“动手实践”部分，读者将有机会通过具体的计算问题，亲身体验和应用这些理论知识。通过这一系列的学习，您将全面掌握[次网格模型](@entry_id:755601)在现代星系形成理论中的基础性作用及其在前沿研究中的应用。

## 原理与机制

在宇宙学尺度上对[星系形成](@entry_id:160121)进行建模，本质上是一个多尺度物理问题。星系内部的关键过程，如单个恒星的诞生、超新星爆发的能量注入、以及超大质量黑洞吸积盘的物理学，都发生在远小于当前[宇宙学模拟](@entry_id:747928)所能解析的尺度上。因此，直接从第一性原理模拟这些过程是不现实的。为了克服这一挑战，[计算天体物理学](@entry_id:145768)家开发了**[次网格模型](@entry_id:755601) (sub-grid models)**。这些模型旨在捕捉那些无法解析的物理过程对其所在更大尺度（即模拟的解析尺度，或称“网格尺度”）环境的净效应。本章将深入探讨这些模型背后的核心原理与关键机制，阐明它们在现代星系形成理论中的基础性作用。

### [次网格模型](@entry_id:755601)的概念基础

要理解[次网格模型](@entry_id:755601)，首先必须将其与纯粹的**数值正则化 (numerical regularization)** 机制区分开来。数值正则化，例如用于激波捕捉的**人工粘性 (artificial viscosity)**，是离散化方案自身的数学工具，旨在确保数值解的稳定性并抑制非物理性的网格尺度[振荡](@entry_id:267781)。这些项的形式和幅度由[数值算法](@entry_id:752770)决定，理想情况下，随着分辨率的提高，它们的影响会趋于零。

相比之下，[次网格模型](@entry_id:755601)是具有物理动机的[参数化](@entry_id:272587)方案。它们源于对[流体动力学](@entry_id:136788)连续介质方程进行**滤波 (filtering)**（如在[大涡模拟](@entry_id:153702)，Large Eddy Simulation, LES中）或**平均 (averaging)**（如在[雷诺平均纳维-斯托克斯](@entry_id:173045)，Reynolds-Averaged Navier-Stokes, [RANS方程](@entry_id:275032)中）的必然结果。当我们对控制方程（如[动量守恒](@entry_id:149964)方程）应用一个[空间滤波](@entry_id:202429)器时，[非线性](@entry_id:637147)项（如[平流](@entry_id:270026)项 $\rho \mathbf{u} \mathbf{u}$）会产生无法仅用已解析（滤波后）的量表达的新项。例如，在[可压缩流体](@entry_id:164617)动力学中，通过密度加权（Favre）滤波[动量方程](@entry_id:197225)后，会出现一个称为**次网格[应力张量](@entry_id:148973) (sub-grid stress tensor)** 的项 $\tau_{ij} \equiv \overline{\rho u_i u_j} - \bar{\rho}\tilde{u}_i \tilde{u}_j$。该项代表了未解析的速度场涨落对已解析动量场的贡献。

[次网格模型](@entry_id:755601)的根本任务就是为这些因滤波或平均而产生的未闭合项提供**闭合关系 (closures)**。它将这些未解析项的效应，用已解析的量（如滤波后的密度 $\bar{\rho}$、速度 $\tilde{\mathbf{u}}$）和一组可校准的参数来表示。除了像[湍流](@entry_id:151300)应力这样的项之外，[次网格模型](@entry_id:755601)还包括了描述未解析物理过程的**[源项](@entry_id:269111) (source terms)**，例如[恒星形成](@entry_id:159940)、[恒星风](@entry_id:161386)、[超新星](@entry_id:161773)以及[活动星系核](@entry_id:158029)（AGN）反馈。这些源项代表了在次网格尺度上发生的质量、动量和能量的转换与注入。因此，一个[次网格模型](@entry_id:755601)本质上是对未解析物理的有效理论描述，其形式由物理定律决定，而非数值算法的需求 [@problem_id:3537578]。

### 核心次网格过程

星系的演化主要由两大引擎驱动：恒星的形成与演化，以及中心超大质量黑洞的生长与反馈。这两者都深刻地依赖于[次网格模型](@entry_id:755601)。

#### 恒星形成

在模拟中，单个[分子云](@entry_id:160702)的引力坍缩和碎裂过程是无法解析的。因此，[恒星形成](@entry_id:159940)被建模为一个基于局部气体性质的概率性过程。

##### 局域体积密度定律

一个被广泛采用的物理模型假设，在足够致密的气体中，[恒星形成](@entry_id:159940)速率正比于局部气体密度 $\rho$，反比于其[引力](@entry_id:175476)**自由落体时标 (free-fall time)** $t_{\mathrm{ff}}$。自由落体时标是在没有压力支撑的情况下，一个均匀球体因自身[引力](@entry_id:175476)而坍缩所需的时间，其表达式为 $t_{\mathrm{ff}} = \sqrt{3\pi / (32G\rho)}$。因此，单位体积的恒星形成率 $\dot{\rho}_\star$ 可以写为：

$$
\dot{\rho}_\star = \epsilon_{\mathrm{ff}} \frac{\rho}{t_{\mathrm{ff}}}
$$

其中，$\epsilon_{\mathrm{ff}}$ 是一个无量纲的**效率参数**，表示每个自由落体时标内转化为恒星的气体[质量分数](@entry_id:161575)。由于 $t_{\mathrm{ff}} \propto \rho^{-1/2}$，这个局域体积定律预测了恒星形成率密度与气体密度的非线性关系：$\dot{\rho}_\star \propto \rho^{3/2}$。

在实践中，为了防止在弥散、热的非恒星形成气体中产生不切实际的恒星，模拟通常会施加一个**密度阈值 ($n_{\mathrm{H,th}}$)**。只有当气体密度超过这个阈值时，上述[恒星形成](@entry_id:159940)定律才会被激活。这个阈值不仅是一个物理开关，也是一个关键的校准参数，它有效地控制了星系中可用于形成恒星的气体总量 [@problem_id:3537567]。

##### 与Schmidt–Kennicutt关系对比

值得注意的是，这个局域的、基于三维体积密度的次网格定律，与观测上的**Schmidt–Kennicutt (SK) 关系**在概念上是不同的。SK关系是一个经验定律，它关联的是在千秒差距（kpc）尺度上平均的[恒星形成](@entry_id:159940)率**[面密度](@entry_id:161889) ($\Sigma_{\mathrm{SFR}}$)** 和气体**[面密度](@entry_id:161889) ($\Sigma_{\mathrm{gas}}$)**，通常形式为 $\Sigma_{\mathrm{SFR}} \propto \Sigma_{\mathrm{gas}}^{N}$，其中 $N \approx 1.4$。在成功的[星系形成](@entry_id:160121)模拟中，局域的 $\rho^{3/2}$ 定律应该能在千秒差距尺度上自洽地“涌现”出观测到的SK关系。密度阈值 $n_{\mathrm{H,th}}$ 的选择在这里起着至关重要的作用，因为它决定了在给定的 $\Sigma_{\mathrm{gas}}$ 下，有多少气体能够达到足够高的体积密度来参与[恒星形成](@entry_id:159940)，从而调节了涌现出的SK关系的正规化系数。

#### [超大质量黑洞](@entry_id:157796)的生长与反馈

[活动星系核](@entry_id:158029)（AGN）反馈被认为是塑造大质量星系（尤其是抑制其[恒星形成](@entry_id:159940)）的关键机制。对其进行建模涉及三个阶段：播种、生长和反馈。

##### 1. [黑洞](@entry_id:158571)播种 (Seeding)

模拟必须首先在星系中引入“种子”[黑洞](@entry_id:158571)，这些种子随后才能通过吸积成长为超大质量黑洞（SMBH）。由于种子[黑洞](@entry_id:158571)的形成机制（如[第一代恒星](@entry_id:158491)的遗迹或稠密星团的直接坍缩）发生在远低于模拟分辨率的尺度，因此必须通过次网格方案来[植入](@entry_id:177559)。两种常见的方法是：

*   **基于[暗物质晕](@entry_id:147523)质量阈值的播种 (Halo-mass-threshold seeding)**：此方法较为唯象。当一个暗物质晕的总质量首次超过一个预设的阈值（例如，$M_{\mathrm{h,seed}} \sim 10^{10} M_\odot$）并且其中尚无[黑洞](@entry_id:158571)时，一个质量为 $M_{\mathrm{seed}}$（例如，$10^5 M_\odot$）的种子[黑洞](@entry_id:158571)就会被放置在该晕的引力势最深处。这种方法的[数值鲁棒性](@entry_id:188030)很好，因为它依赖于由大量暗物[质粒](@entry_id:263777)子良好解析的晕结构，且通过设计确保了每个晕只播种一次。然而，它与具体的[黑洞形成](@entry_id:159005)物理过程联系较弱。

*   **基于气体坍缩的播种 (Gas-collapse seeding)**：此方法更具物理动机，试图捕捉**直接坍缩[黑洞](@entry_id:158571) (Direct Collapse Black Hole, DCBH)** 形成的条件。它会在满足特定局部条件的单个气体单元中[植入](@entry_id:177559)种子[黑洞](@entry_id:158571)。这些条件通常包括：气体密度超过某个高阈值、温度处于[原子冷却](@entry_id:150586)线（$\sim 10^4$ K）、金属丰度极低（以抑制碎裂）、以及气体在[引力](@entry_id:175476)上不稳定（例如，冷却时标短于自由落体时标）。这种方法虽然物理上更合理，但在数值上却非常脆弱。它的触发严重依赖于模拟是否能解析[引力](@entry_id:175476)不稳定的物理尺度，即**[金斯长度](@entry_id:157888) (Jeans length)** $\lambda_J$。如果[金斯长度](@entry_id:157888)小于模拟的[引力软化](@entry_id:146273)长度 $\epsilon$，那么引力坍缩将被数值效应人为地压制，导致播种被延迟甚至完全抑制。此外，若无额外约束，多个邻近的气体单元可能同时满足坍缩条件，导致在一个物理区域内产生多个虚假的种子[黑洞](@entry_id:158571) [@problem_id:3537634]。

##### 2. [黑洞吸积](@entry_id:159859) (Accretion)

一旦种子[黑洞](@entry_id:158571)被植入，其生长速率 $\dot{M}_{\bullet}$ 就由周围气体的供应决定。同样，由于模拟无法解析到[黑洞](@entry_id:158571)的[史瓦西半径](@entry_id:263997)，吸积过程也必须通过[次网格模型](@entry_id:755601)来估算。关键的区别在于如何处理气体的角动量。

*   **Bondi–Hoyle–Lyttleton (BHL) 吸积**：该模型适用于描述来自一个均匀、低角动量气体的[准球](@entry_id:169696)对称吸积。吸积率由[黑洞](@entry_id:158571)的[引力](@entry_id:175476)捕获决定，其大小取决于[黑洞质量](@entry_id:160874) $M_{\bullet}$ 以及气体相对于[黑洞](@entry_id:158571)的密度 $\rho_\infty$、声速 $c_s$ 和体速度 $v_\infty$。其标准形式为：
    $$
    \dot{M}_{\mathrm{BHL}} = \alpha \frac{4\pi G^2 M_{\bullet}^2 \rho_\infty}{(c_s^2 + v_\infty^2)^{3/2}}
    $$
    其中 $\alpha$ 是一个量级为1的数值因子。BHL模型的核心假设是气体角动量可以忽略不计，因此它最适用于描述从星系尺度弥散介质中进行的缓慢吸积。

*   **转矩限制吸积 (Torque-limited accretion)**：在真实的星系中心，气体通常具有显著的角动量，无法直接落入[黑洞](@entry_id:158571)，而是会形成一个旋转支撑的**[吸积盘](@entry_id:159973) (accretion disk)**。在这种情况下，吸积率不再由[引力](@entry_id:175476)捕获决定，而是由[角动量输运](@entry_id:160167)的效率决定。气体必须通过某种机制失去角动量才能向内迁移。在星系尺度上，这种机制通常是**[引力](@entry_id:175476)转矩 (gravitational torques)**，由恒星棒、旋臂或气体盘自身[引力不稳定性](@entry_id:160721)（团块）等非[轴对称](@entry_id:173333)结构产生。因此，转矩限制模型将吸积率与这些转矩的强度联系起来。在这种模型中，[气体热力学](@entry_id:151144)通过影响盘的[引力](@entry_id:175476)稳定性（例如通过Toomre $Q$参数）来间接控制吸积，而非像BHL模型那样直接通过声速设定吸积率 [@problem_id:3537573]。

##### 3. AGN反馈 (Feedback)

[黑洞吸积](@entry_id:159859)释放的巨大能量会以多种形式反馈到周围环境中，深刻影响宿主星系的演化。次网格反馈模型通常采用一个双模[范式](@entry_id:161181)，其模式取决于吸积率相对于**[爱丁顿极限](@entry_id:159921) (Eddington limit)** 的比值，即**爱丁顿比 ($\lambda \equiv \dot{M}_{\bullet}/\dot{M}_{\mathrm{Edd}}$)**。

*   **[类星体](@entry_id:159221)模式 (Quasar Mode)**：当吸积率很高时（例如，$\lambda \gtrsim 0.01$），[黑洞](@entry_id:158571)周围会形成一个几何薄、光学厚、[辐射效率](@entry_id:260651)高的标准吸积盘。这种模式下的反馈能量主要以**热能 (thermal energy)** 和**[辐射压力](@entry_id:165366) (radiation pressure)** 的形式，近似各向同性地注入到周围的冷密气体中。这通常发生在气体丰富的环境中，如[星暴星系](@entry_id:159138)或星系[并合](@entry_id:147963)的中心。

*   **射电模式 (Radio Mode)**：当吸积率很低时（例如，$\lambda \lesssim 0.01$），吸积流被认为会转变为一个几何厚、光学薄、[辐射效率](@entry_id:260651)低的结构（如**[平流主导吸积流](@entry_id:160011), Advection-Dominated Accretion Flow, ADAF**）。这种模式能够有效地产生强大的、准直的**喷流 (jets)**。反馈能量主要以**动能 (kinetic energy)** 的形式，通过喷流注入到周围环境，吹出巨大的“气泡”，加热星系晕中广阔的热、稀薄气体。这通常发生在大质量星系的“维持模式”中，用于抑制冷却流和后续的恒星形成。

一个具体的例子可以很好地说明这一点：考虑一个 $10^9 M_\odot$ 的[黑洞](@entry_id:158571)。如果它位于一个冷密（$\rho \sim 10^{-22} \text{g cm}^{-3}, c_s \sim 10 \text{ km/s}$）的核盘中，极高的气体密度和低声速会导致非常高的BHL吸积率，使得 $\lambda \gg 0.01$，从而触发类星体模式的热反馈。相反，如果它位于一个热稀薄（$\rho \sim 10^{-26} \text{g cm}^{-3}, c_s \sim 500 \text{ km/s}$）的星系团核心，极低的气体密度和高声速会导致非常低的BHL吸积率，使得 $\lambda \ll 0.01$，从而触发射电模式的喷流反馈 [@problem_id:3537579]。

##### 反馈渠道

除了上述的热/动能双模框架，[次网格模型](@entry_id:755601)还实现了更多具体的能量和动量注入渠道。

*   **[辐射压力](@entry_id:165366) (Radiation Pressure)**：来自年轻恒星或AGN的强烈辐射场会对尘埃颗粒施加压力，从而将[动量传递](@entry_id:147714)给气体。在一个光学薄的环境中，每次[光子](@entry_id:145192)吸收或散射最多传递 $L/c$ 的动量（$L$为光度，$c$为光速）。然而，在一个对红外辐射光学厚（$\tau_{\mathrm{IR}} \gt 1$）的稠密环境中，紫外（UV）[光子](@entry_id:145192)被吸收并被尘埃重新辐射为红外[光子](@entry_id:145192)。这些红外[光子](@entry_id:145192)在逃逸前会被多次吸收和再辐射，每次都传递动量。这种“多重散射”效应会将总动量注入放大一个大约为 $\tau_{\mathrm{IR}}$ 的因子。一个综合的[次网格模型](@entry_id:755601)会考虑这两个极限，其[总动量](@entry_id:173071)注入率 $\dot{p}$ 可近似写为：
    $$
    \dot{p} \approx \left(1 - e^{-\tau_{\mathrm{UV}}}\right)\frac{L}{c} + \tau_{\mathrm{IR}}\frac{L}{c}
    $$
    在对UV辐射光学厚（$\tau_{\mathrm{UV}} \gg 1$）的常见情况下，这简化为 $\dot{p} \approx (1 + \tau_{\mathrm{IR}}) L/c$ [@problem_id:3537564]。

*   **宇宙射线 (Cosmic Rays, CRs)**：AGN也被认为是宇宙射线（高能[带电粒子](@entry_id:160311)）的强[大加速](@entry_id:198882)器。CRs可以作为一种独立的反馈渠道。在[次网格模型](@entry_id:755601)中，AGN反馈总能量的一部分（由参数 $f_{\mathrm{CR}}$ 控制）被注入为CR能量。与热能不同，CRs构成了一个相对论性流体，其压力 $P_{\mathrm{CR}}$ 可以为气体提供额外的非[热压力](@entry_id:202761)支持。CRs的[输运性质](@entry_id:203130)也与热能截然不同，它们主要沿着磁力线**[扩散](@entry_id:141445) (diffuse)** 和**漂流 (stream)**。CRs的漂流会与背景等离子体发生相互作用，激发[阿尔芬波](@entry_id:261195)，并将CRs的[能量耗散](@entry_id:147406)为气体的热能，这个过程称为**漂流加热 (streaming heating)**。因此，CR反馈的作用是双重的：它既可以通过压力梯度做功来提供动力学支持，也可以在远离AGN中心的更大范围内加热气体 [@problem_id:3537575]。

### 数值实现与验证

[次网格模型](@entry_id:755601)的实现和应用充满了微妙的数值挑战和验证难题。

#### [能量守恒](@entry_id:140514)与“双重计算”

在一些模拟中，为了稳定稠密的、[恒星形成](@entry_id:159940)区的气体，防止其过早地发生[引力坍缩](@entry_id:161275)，会采用一种**有效状态方程 (effective equation of state, EOS)**。这种EOS通过引入一个依赖于密度的额外压力项 $u_{\mathrm{EOS}}$ 来模拟未解析的多相介质的压力支持，即 $P = (\gamma - 1)\rho(u + u_{\mathrm{EOS}})$，其中 $u$ 是已解析的比内能。

当在这种框架下注入显式的反馈能量 $E_{\mathrm{fb}}$ 时，必须非常小心以避免**双重计算 (double counting)**。如果一个反馈事件同时增加了已解析的内能 $u$ 和用于计算压力的次网格参数 $u_{\mathrm{EOS}}$，那么这个事件的能量就被计入了两次。为了维持总[能量守恒](@entry_id:140514)，任何因反馈而导致的 $u_{\mathrm{EOS}}$ 的增加（能量为 $m \Delta u_{\mathrm{EOS}}$），都必须从注入到已解析能量场中的能量中减去。也就是说，注入到已解析内能中的净能量应为 $E_{\mathrm{fb}}^{\mathrm{net}} = E_{\mathrm{fb}} - m \Delta u_{\mathrm{EOS}}$ [@problem_id:3537574]。

#### 收敛性与参数[重整化](@entry_id:143501)

一个理想的数值模拟应该在分辨率提高时收敛到一个唯一的解。然而，对于包含[次网格模型](@entry_id:755601)的模拟，收敛性的概念变得更加复杂。

*   **强收敛 (Strong convergence)**：指对于一组*固定*的次网格参数，当分辨率提高（例如，网格间距 $h \to 0$）时，模拟产生的可观测结果（如[恒星质量](@entry_id:157648)函数）收敛到一个确定的极限。

*   **[弱收敛](@entry_id:146650) (Weak convergence)**：指允许次网格参数随分辨率变化（即**重整化, renormalization**），使得模拟结果收敛。也就是说，存在一个参数到分辨率的映射 $\mathbf{p}(h)$，使得可观测量 $O_h(\mathbf{p}(h))$ 收敛。

由于许多[次网格模型](@entry_id:755601)的定义本身就与分辨率尺度（如单个气体单元的质量 $m_{\mathrm{gas}}$）纠缠在一起，强收敛在[星系形成](@entry_id:160121)模拟中是极难实现的奢望。因此，[弱收敛](@entry_id:146650)成为了一个更现实且可接受的目标。实现[弱收敛](@entry_id:146650)的策略是设计参数的[重整化方案](@entry_id:154662)，以保持某个关键物理效应在不同分辨率下不变。例如，在一个热反馈模型中，能量 $E_{\mathrm{feed}}$ 被注入到 $N_{\mathrm{ngb}}$ 个邻近气体单元中，总质量为 $M_{\mathrm{heat}} \propto N_{\mathrm{ngb}} m_{\mathrm{gas}}$。产生的温度跃升 $\Delta T \propto E_{\mathrm{feed}} / M_{\mathrm{heat}}$。如果反馈能量与耦合效率 $\epsilon_{\mathrm{f}}$ 成正比，那么 $\Delta T \propto \epsilon_{\mathrm{f}} / m_{\mathrm{gas}}$。为了在改变分辨率（即改变 $m_{\mathrm{gas}}$）时保持 $\Delta T$ 不变，就必须要求耦合效率参数进行重整化，使其满足 $\epsilon_{\mathrm{f}} \propto m_{\mathrm{gas}}$ [@problem_id:3537623]。

#### [模型校准](@entry_id:146456)与参数约束

[次网格模型](@entry_id:755601)包含自由参数（如 $\epsilon_{\mathrm{ff}}$, $\epsilon_{\mathrm{f}}$），这些参数的取值无法从第一性原理推导，必须通过将模拟结果与一系列关键的**观测约束 (observational constraints)** 进行比较来**校准 (calibrate)**。关键的校准目标包括：

*   **[恒星质量](@entry_id:157648)-暈质量关系 ($M_\star - M_{\mathrm{halo}}$)**：主要[约束控制](@entry_id:263479)恒星形成和外流的[恒星反馈](@entry_id:755431)效率（如质量加载因子 $\eta_\star$）。
*   **[黑洞质量](@entry_id:160874)-星系 bulge 速度弥散关系 ($M_\bullet - \sigma$)**：主要[约束控制](@entry_id:263479)[黑洞](@entry_id:158571)生长的 AGN 反馈参数（如耦合效率 $\epsilon_f$ 和吸积增强因子 $\beta$）。
*   **星系团冷却核的熵[分布](@entry_id:182848)**：对大质量星系晕中的 AGN 反馈（特别是射电模式）如何加热气体提供了强有力的约束。

这些参数之间通常存在**简并性 (degeneracy)**，即改变一个参数的效果可以在一定程度上被另一个参数的改变所抵消。例如，增加[黑洞吸积](@entry_id:159859)率（更高的 $\beta$）和增加反馈耦合效率（更高的 $\epsilon_f$）可能对某些[可观测量](@entry_id:267133)产生相似的影响。因此，必须同时使用多个、物理上[相互独立](@entry_id:273670)的观测数据，才能打破这种简并性，从而对模型的自由参数进行有意义的约束 [@problem_id:3537555]。

总之，[次网格模型](@entry_id:755601)是连接微观物理过程与宏观[宇宙学模拟](@entry_id:747928)的关键桥梁。它们的设计、实现和验证是一个涉及物理洞察、数值技巧和与观测数据进行严格比较的复杂但至关重要的过程。