## 引言
星系的[化学动力学模拟](@entry_id:747318)是现代[计算天体物理学](@entry_id:145768)的基石，它为我们提供了一个无与伦比的虚拟实验室，用以探索从我们所在的银河系到遥远宇宙中各类星系是如何形成并演化至今的。然而，星系是一个极其复杂的生态系统，其中[引力](@entry_id:175476)、[流体动力学](@entry_id:136788)、[恒星形成](@entry_id:159940)与[化学演化](@entry_id:144713)等过程在横跨数十个[数量级](@entry_id:264888)的时空尺度上紧密耦合。单纯依靠观测难以完全解开这些过程之间错综复杂的因果链条，而这正是[化学动力学模拟](@entry_id:747318)旨在填补的知识鸿沟。

本文旨在全面系统地介绍这一强大的研究工具。我们将从“原理与机制”一章开始，深入探讨驱动模拟的底层物理方程和核心数值算法；接着，在“应用与交叉学科联系”一章中，我们将展示这些模拟如何被用于解决星系结构、化学丰度以及星系与宇宙环境相互作用等前沿问题；最后，通过“动手实践”一章中的具体问题，读者将有机会将理论知识应用于实践。为了构建并理解这些复杂的宇宙模型，我们必须首先牢固掌握其背后的基本定律。下面，我们将进入“原理与机制”的学习，解构这些模拟赖以建立的物理与数值基础。

## 原理与机制

### [星系动力学](@entry_id:162072)的控制方程

[化学动力学模拟](@entry_id:747318)的核心在于精确求解描述星系中不同物质组分（恒星、暗物质和星际气体）如何在外力作用下运动和演化的物理方程。这些组分具有根本不同的物理性质，因此需要用不同的数学框架来描述。

#### 无碰撞组分：恒星与暗物质

在星系尺度上，恒星和暗物[质粒](@entry_id:263777)子之间的直接[引力](@entry_id:175476)碰撞（即双体弛豫）的特征时标远超宇宙年龄。因此，它们被视为**无碰撞 (collisionless)** 系统。在此近似下，每个粒子只感受到由所有其他[粒子产生](@entry_id:158755)的平滑、平均的[引力场](@entry_id:169425)。描述这样一个系统的最基本工具是六维相空间中的**分布函数 (phase-space distribution function)** $f(\mathbf{x}, \mathbf{v}, t)$。

根据定义，$f(\mathbf{x}, \mathbf{v}, t) \, \mathrm{d}^3\mathbf{x} \, \mathrm{d}^3\mathbf{v}$ 给出了在时间 $t$、位于相空间坐标 $(\mathbf{x}, \mathbf{v})$ 附近的无穷小[体积元](@entry_id:267802) $\mathrm{d}^3\mathbf{x} \, \mathrm{d}^3\mathbf{v}$ 内，预期找到的恒星（或暗物[质粒](@entry_id:263777)子）数量。该函数在无碰撞、无源（即不考虑恒星形成与死亡）的极限下，其演化由**[无碰撞玻尔兹曼方程](@entry_id:157523) (Collisionless Boltzmann Equation, CBE)**（在等离子体物理中也称为 Vlasov 方程）描述：

$$
\frac{\partial f}{\partial t} + \mathbf{v} \cdot \nabla_{\mathbf{x}} f - \nabla_{\mathbf{x}}\Phi \cdot \nabla_{\mathbf{v}} f = 0
$$

该方程表达了[相空间密度](@entry_id:150180)守恒的深刻物理原理（刘维尔定理的应用）：相空间中的“流体”是不可压缩的。方程中的 $\Phi(\mathbf{x}, t)$ 是[引力势](@entry_id:160378)，它由包括恒星、暗物质和气体在内的所有物质的总质量密度 $\rho_{\text{tot}}$ 通过**[泊松方程](@entry_id:143763) (Poisson's equation)** 自洽地决定：

$$
\nabla^2 \Phi = 4\pi G \rho_{\text{tot}}(\mathbf{x}, t)
$$

其中，恒星组分的质量密度可以通过[对分布函数](@entry_id:145441)在[速度空间](@entry_id:181216)积分得到：$\rho_{\star}(\mathbf{x}, t) = m_{\star} \int f(\mathbf{x}, \mathbf{v}, t) \, \mathrm{d}^3\mathbf{v}$，这里 $m_{\star}$ 是单个恒星的质量。CBE-[泊松方程](@entry_id:143763)组构成了描述无碰撞[自引力系统](@entry_id:155831)动力学的一个封闭、完整的理论框架 [@problem_id:3505139]。

值得注意的是，通过对 CBE 取速度矩，可以推导出一套流体式的方程，即**[矩方程](@entry_id:149666)层级 (hierarchy of moment equations)**，其中最著名的是[金斯方程](@entry_id:161874) (Jeans equations)。然而，这个层级存在固有的**闭合问题 (closure problem)**：$k$ 阶矩的[演化方程](@entry_id:268137)总是依赖于 $(k+1)$ 阶矩。例如，零阶矩（[连续性方程](@entry_id:195013)）的演化依赖于一阶矩（[平均速度](@entry_id:267649)），而一阶矩（[动量方程](@entry_id:197225)）的演化又依赖于二阶矩（速度弥散张量或压强张量）。为了求解，必须在某阶进行截断，并引入一个**闭合关系**来近似更高阶的矩。这种闭合假设（例如，假设速度弥散是各向同性的）在碰撞流体中通常是合理的，因为频繁的碰撞会驱动系统趋向[局部热力学平衡](@entry_id:139579)。但在无碰撞的恒星系统中，这种假设缺乏物理基础，可能导致对系统动力学的描述不准确 [@problem_id:3505139]。

#### 碰撞组分：星际气体

与恒星不同，星际气体中的原子和离子通过[电磁力](@entry_id:196024)相互作用，其[平均自由程](@entry_id:139563)远小于星系尺度。因此，气体可以被极好地近似为一种**碰撞流体 (collisional fluid)**，其宏观行为由[流体力学](@entry_id:136788)方程描述。在星系[化学动力学模拟](@entry_id:747318)中，核心方程是加入了天体物理源项的**[可压缩欧拉方程](@entry_id:747588) (compressible Euler equations)**。这些方程以[守恒形式](@entry_id:747710)书写，以确保在数值求解中精确地守恒质量、动量和能量，尤其是在存在激波等不连续性的情况下。

一个完整的[方程组](@entry_id:193238)包括 [@problem_id:3505135]：
1.  **质量守恒（[连续性方程](@entry_id:195013)）**:
    $$
    \frac{\partial \rho}{\partial t} + \nabla \cdot \left(\rho\,\mathbf{v}\right) = S_{\rho}^{\mathrm{fb}}
    $$
    这里 $\rho$ 是气体质量密度，$\rho\,\mathbf{v}$ 是动量密度（即单位体积的动量），代表了气体的整体运动、[湍流](@entry_id:151300)和旋转。右侧的 $S_{\rho}^{\mathrm{fb}}$ 是源项，代表了[恒星反馈](@entry_id:755431)（如[恒星风](@entry_id:161386)和超新星爆发）注入的质量。

2.  **动量守恒**:
    $$
    \frac{\partial \left(\rho\,\mathbf{v}\right)}{\partial t} + \nabla \cdot \left(\rho\,\mathbf{v}\,\mathbf{v} + P\,\mathbf{I}\right) = \rho\,\mathbf{g} + \mathbf{S}_{\mathrm{mom}}^{\mathrm{fb}}
    $$
    方程左侧是[动量密度](@entry_id:271360)的变化率和[动量通量](@entry_id:199796)的散度。动量通量 $\rho\,\mathbf{v}\,\mathbf{v} + P\,\mathbf{I}$ 包括动量的[平流](@entry_id:270026)输运项（张量 $\rho\,\mathbf{v}\,\mathbf{v}$）和由压强 $P$ 产生的各向同性力（$P\,\mathbf{I}$，其中 $\mathbf{I}$ 是单位张量）。右侧是作用在气体上的体积力[源项](@entry_id:269111)，包括[引力](@entry_id:175476) $\rho\,\mathbf{g}$（其中 $\mathbf{g} = -\nabla\Phi$）和[恒星反馈](@entry_id:755431)注入的动量 $\mathbf{S}_{\mathrm{mom}}^{\mathrm{fb}}$。

3.  **总[能量守恒](@entry_id:140514)**:
    $$
    \frac{\partial E}{\partial t} + \nabla \cdot \left[\left(E + P\right)\,\mathbf{v}\right] = \rho\,\mathbf{v}\cdot \mathbf{g} - \mathcal{C}(\rho, T, Z) + S_{E}^{\mathrm{fb}}
    $$
    这里 $E = \rho\,\epsilon + \frac{1}{2}\,\rho\,|\mathbf{v}|^{2}$ 是总能量密度，即单位体积的内能（$\rho\,\epsilon$）和动能之和。压强由[理想气体状态方程](@entry_id:137803) $P = (\gamma - 1)\rho\epsilon$ 给出。[能量通量](@entry_id:266056) $(E + P)\,\mathbf{v}$ 包括总能量的[平流](@entry_id:270026)输运和压强力所做的功。右侧的[源项](@entry_id:269111)包括[引力](@entry_id:175476)做功率 $\rho\,\mathbf{v}\cdot \mathbf{g}$、[辐射冷却](@entry_id:754014)导致的[能量损失](@entry_id:159152) $-\mathcal{C}(\rho, T, Z)$，以及[恒星反馈](@entry_id:755431)注入的能量 $S_{E}^{\mathrm{fb}}$。

4.  **化学元素守恒（以金属为例）**:
    $$
    \frac{\partial \left(\rho\,Z\right)}{\partial t} + \nabla \cdot \left(\rho\,Z\,\mathbf{v}\right) = S_{Z}^{\mathrm{fb}}
    $$
    金属（比氦重的元素）的质量分数 $Z$ 被当作**[被动标量](@entry_id:191726) (passive scalar)** 处理。[守恒量](@entry_id:150267)是金属质量密度 $\rho Z$。它随着[流体速度](@entry_id:267320) $\mathbf{v}$ 被平流输运，其[源项](@entry_id:269111) $S_{Z}^{\mathrm{fb}}$ 代表了恒星演化[末期](@entry_id:169480)（如超新星）向[星际介质](@entry_id:150031)抛射的金属。

### [数值离散化](@entry_id:752782)策略

将上述连续的[偏微分方程](@entry_id:141332)转化为计算机可解的代数方程，需要采用[数值离散化](@entry_id:752782)方法。由于恒星/暗物质和气体的物理性质截然不同，它们通常采用不同的数值方案。

#### 无[碰撞动力学](@entry_id:171588)的 N 体方法

直接求解六维相空间的 CBE 在计算上是极为昂贵的。因此，实践中采用 **N 体方法 (N-body methods)**，它通过 $N$ 个离散的“超级粒子”来采样[相空间分布](@entry_id:151304)函数 $f$。每个粒子代表了一大群具有相似[轨道](@entry_id:137151)属性的真实恒星或暗物[质粒](@entry_id:263777)子。这些粒子只在由所有粒子共同产生的平滑[引力场](@entry_id:169425)中运动 [@problem_id:3505149]。

为了控制由离散采样带来的数值噪声，特别是避免因两个粒子过于靠近而产生巨大的、非物理的[引力](@entry_id:175476)，计算中会引入**[引力软化](@entry_id:146273) (gravitational softening)**。这相当于将[牛顿引力](@entry_id:159796)中的点质量替换为一个有微小尺寸的[质量分布](@entry_id:158451)，其特征尺度为[软化长度](@entry_id:755011) $\epsilon$。这可以防止数值弛豫，即由粒子间近距离遭遇导致的虚假[轨道](@entry_id:137151)偏转，在 $N$ 远小于真实星系中恒星数量的模拟中，这种效应会被严重放大 [@problem_id:3505149]。

#### 气体动力学的水动力学方法

对于气体组分，主要有两类数值方法：[拉格朗日方法](@entry_id:142825)和欧拉方法。

**平滑粒子[流体动力学](@entry_id:136788) (Smoothed Particle Hydrodynamics, SPH)** 是一种[拉格朗日方法](@entry_id:142825)。它将流体离散为一组粒子，每个粒子携带质量、内能等物理量。[流体力学](@entry_id:136788)方程中的空间导数（如压强梯度）通过一个**[平滑核](@entry_id:195877)函数 (smoothing kernel)** 在邻近粒子上进行加权平均来计算。SPH 的一个主要优点是其拉格朗日性质：粒子跟随流体运动，因此可以自然地适应密度变化，且没有固定的网格，保证了伽利略不变性。其公式推导通常保证了动量和角动量的精确守恒。然而，传统 SPH 在处理接触[不连续面](@entry_id:180188)和流体混合方面存在困难，可能导致金属等[被动标量](@entry_id:191726)的数值混合不足。此外，其[人工粘性](@entry_id:142854)项如果调节不当，可能导致冷气体盘中不真实的角动量损失 [@problem_id:3505149] [@problem_id:3505149]。

**基于网格的戈杜诺夫类格式 (Mesh-based Godunov-type Schemes)** 是一种欧拉方法。它将空间划分为固定的或自适应的网格（单元），并在每个单元内存储守恒量（质量、动量、能量）的平均值。单元间的通量是通过求解每个交界面上的**[黎曼问题](@entry_id:171440) (Riemann problem)** 来计算的。[黎曼问题](@entry_id:171440)是一个具有分段常数[初始条件](@entry_id:152863)（即界面两侧的状态）的初值问题，其[自相似解](@entry_id:164839)由一系列激波、[稀疏波](@entry_id:168428)和接触[不连续面](@entry_id:180188)构成 [@problem_id:3505218]。

在实践中，为了避免求解精确黎曼问题的巨大开销，通常采用**[近似黎曼求解器](@entry_id:267136) (approximate Riemann solvers)**，例如 HLLC (Harten-Lax-van Leer-Contact) 格式。这些求解器能够高效地计算出与郎金-雨贡纽[跳跃条件](@entry_id:750965)相容的通量，从而精确地捕捉激波并保证守恒性。这类方法的优点是激波捕捉能力强，对[流体不稳定性](@entry_id:188786)有很好的处理。其内在的[数值耗散](@entry_id:168584)有助于稳定计算，同时也促进了[被动标量](@entry_id:191726)（如金属）的数值混合。缺点是，在固定网格上，对于高速的整体流动可能会引入较大的平流误差，破坏伽利略[不变性](@entry_id:140168) [@problem_id:3505149] [@problem_id:3505218]。

#### 化学元素的输运

金属丰度 $Z$ 作为[被动标量](@entry_id:191726)，其输运方程从根本上是守恒方程 $\partial_t(\rho Z) + \nabla \cdot (\rho Z \mathbf{v}) = S_Z$ 的一种形式。在数值上，其处理方式与所用的水动力学方法紧密相关。

在戈杜诺夫类格式中，金属密度 $\rho Z$ 的通量必须与质量通量协同计算，以保证物理上的一致性。这意味着金属通量的计算需要使用从水动力学黎曼解中得到的确切的界面速度 $u^\star$ 和波结构。最终的[通量形式](@entry_id:273811)如 $(\rho Z)^\star u^\star$，其中 $(\rho Z)^\star$ 是根据界面两侧的[状态和](@entry_id:193625)[波速](@entry_id:186208)确定的上风（upwind）值。这种耦合处理确保了金属质量的守恒，并使其与气体质量的运动保持一致 [@problem_id:3505218]。

除了平流输运，模拟中还可以包含物理的**[湍流](@entry_id:151300)[扩散](@entry_id:141445) (turbulent diffusion)** 项。这通常通过一个类比于[菲克定律](@entry_id:155177)的[扩散通量](@entry_id:748422)来建模，形式为 $\mathbf{F}_{\text{diff}} = -\rho \kappa_t \nabla Z$，其中 $\kappa_t$ 是[湍流扩散系数](@entry_id:196515)。完整的[被动标量](@entry_id:191726)[输运方程](@entry_id:756133)（在[平流](@entry_id:270026)[坐标系](@entry_id:156346)下）因此变为 [@problem_id:3505176]：

$$
\frac{\partial Z}{\partial t} + \mathbf{v} \cdot \nabla Z = \frac{1}{\rho} \nabla \cdot (\rho \kappa_t \nabla Z) + \frac{S_Z}{\rho}
$$

### [次网格物理](@entry_id:755602)：[星系演化](@entry_id:158840)的引擎

许多驱动[星系演化](@entry_id:158840)的关键物理过程（如[恒星形成](@entry_id:159940)、[恒星反馈](@entry_id:755431)）发生的尺度远小于典型[星系模拟](@entry_id:749694)的分辨率。这些过程必须通过所谓的**[次网格模型](@entry_id:755601) (subgrid models)** 来近似描述。

#### [气体热力学](@entry_id:151144)：冷却与加热

气体的温度由加热和冷却过程的平衡决定，这些过程是能量方程中的重要源项。

**[辐射冷却](@entry_id:754014) (Radiative Cooling)** 在[天体物理等离子体](@entry_id:267820)中主要来自双体碰撞过程。例如，电子与离子碰撞，使后者激发到一个更高能级，随后离子通过辐射[光子](@entry_id:145192)退激发，[光子](@entry_id:145192)逃逸带走能量。因此，单位体积的冷却率 $\mathcal{C}$ 正比于碰撞物种的[数密度](@entry_id:268986)乘积，通常表示为 $C = n_e n_H \Lambda(T,Z)$。其中 $n_e$ 和 $n_H$ 分别是电子和氢的数密度，而**冷却函数 (cooling function)** $\Lambda(T,Z)$ 封装了所有微观物理过程（如[碰撞激发](@entry_id:159854)、[碰撞电离](@entry_id:271278)、复合辐射、韧致辐射等）对温度 $T$ 和金属丰度 $Z$ 的复杂依赖性 [@problem_id:3505173]。

金属丰度 $Z$ 对冷却至关重要。重元素拥有复杂的[电子结构](@entry_id:145158)，提供了丰富的能级，使得它们在 $10^4 \, \text{K} \lesssim T \lesssim 10^7 \, \text{K}$ 的温度范围内成为极其高效的冷却剂。在这个温度区间，纯氢氦气体的冷却效率很低。因此，增加金属丰度会显著提高 $\Lambda(T,Z)$ 的值，从而加速气体的冷却 [@problem_id:3505173]。

**[光致加热](@entry_id:753413) (Photoheating)** 主要来自气体对高能（主要是紫外）[光子](@entry_id:145192)的吸收。在光学薄的极限下，单位体积的加热率 $H$ 正比于吸收体的[数密度](@entry_id:268986)（主要是中性氢），可表示为 $H = n_H \Gamma$。其中**加热率 (heating rate)** $\Gamma$ 描述了单位时间内单个氢原子从外部[辐射场](@entry_id:164265)中获得的能量，它依赖于辐射场的强度和谱形 [@problem_id:3505173]。

#### [恒星形成](@entry_id:159940)

恒星在[巨分子云](@entry_id:157602)的核心中形成，其尺度通常为 $\sim 1 \, \text{pc}$ 或更小，这在星系尺度模拟中是无法解析的。因此，恒星形成必须通过[次网格模型](@entry_id:755601)来处理，这些模型基于一系列物理判据来决定模拟中的哪些气体单元可以转化为恒星粒子。常见的判据包括 [@problem_id:3505148]：

1.  **密度阈值**: 要求气体[数密度](@entry_id:268986)超过一个阈值 $n_{\text{th}}$（例如 $10-100 \, \text{cm}^{-3}$）。其物理动机是，只有足够致密的气体，其[自引力](@entry_id:271015)才能克服各种支撑，且其自由落体时标足够短，可以有效形成恒星。

2.  **[引力](@entry_id:175476)束缚条件**: 要求气体云是[引力](@entry_id:175476)束缚的。这通常通过**维里参数 (virial parameter)** $\alpha = 2E_K / |E_P|$ 来判断，其中 $E_K$ 是[湍动能](@entry_id:262712)，$E_P$ 是[引力势能](@entry_id:269038)。只有当 $\alpha$ 小于某个临界值（通常为 1 或 2）时，气体云的自引力才能克服内部的[湍流](@entry_id:151300)运动支撑。

3.  **[引力不稳定性](@entry_id:160721)**: 对于旋转盘中的气体，可以使用**土木俊 Q 参数 (Toomre Q parameter)** 来判断其大尺度[轴对称](@entry_id:173333)[引力不稳定性](@entry_id:160721)。$Q_g = \frac{\sigma_g \kappa}{\pi G \Sigma_g} < 1$ 是气体盘发生碎裂的条件，其中 $\sigma_g$ 是速度弥散，$\kappa$ 是[周转频率](@entry_id:197520)，$\Sigma_g$ 是[表面密度](@entry_id:161889)。

4.  **分子气体条件**: 观测表明，恒星主要在分子气体中形成。因此，一些模型要求气体中的氢[分子质量](@entry_id:152926)分数 $f_{\text{H_2}}$ 超过一个阈值。$f_{\text{H_2}}$ 的平衡值取决于气体密度、金属丰度（影响尘埃含量，而尘埃是 $\text{H}_2$ 形成的主要催化剂）和外部[辐射场](@entry_id:164265)（[光解离](@entry_id:266459) $\text{H}_2$）。这个判据引入了化学与动力学的直接耦合 [@problem_id:3505148]。

这些判据各有其物理动机和局限性。例如，一个全局的 Q 参数判据可能无法描述在全局稳定盘中发生的局部[引力坍缩](@entry_id:161275) [@problem_id:3505148]。

#### 化学增丰

宇宙中的金属元素是在[恒星内部](@entry_id:158197)合成，并通过恒星演化[末期](@entry_id:169480)的物质抛射返回到[星际介质](@entry_id:150031)中。这个过程被称为**化学增丰 (chemical enrichment)**。为了模拟它，我们需要三个关键要素 [@problem_id:3505145]：

1.  **初始[质量函数](@entry_id:158970) (Initial Mass Function, IMF)**, $\phi(M)$：描述了一个新形成的星族中，[恒星质量](@entry_id:157648)的[分布](@entry_id:182848)。通常被归一化，例如[质量归一化](@entry_id:178966) $\int M \phi(M) dM = 1$。它决定了大质量（短寿命、高产额）和小质量（长寿命、低产额）恒星的相对数量。

2.  **恒星产额 (Stellar Yield)**, $y_k(M)$：定义为一颗初始质量为 $M$ 的恒星在其一生中合成并抛射出的元素 $k$ 的总质量。

3.  **[恒星寿命](@entry_id:160470) (Stellar Lifetime)**, $\tau(M)$：恒星在[主序带](@entry_id:162036)及后续阶段停留的时间，它是质量的强减函数。

在考虑[恒星寿命](@entry_id:160470)的**时延增丰 (time-delayed enrichment)** 模型中，在时间 $t$ 返回到气体的元素 $k$ 的总速率 $S_k(t)$ 是对所有在 $t$ 时刻死亡的恒星的贡献积分。这些恒星形成于更早的时刻 $t-\tau(M)$。其返回的物质包括新合成的产额 $y_k(M)$ 和未被处理的、继承自其诞生时气体云的旧元素。因此，源项的完整形式是 [@problem_id:3505145]：

$$
S_k(t) = \int_{M_{\ell}}^{M_{u}} \psi(t-\tau(M))\,\phi(M)\,\Big[y_k(M) + Z_k(t-\tau(M))\,\big(M - M_{\mathrm{r}}(M)\big)\Big]\,H(t-\tau(M))\,dM
$$

其中 $\psi$ 是[恒星形成](@entry_id:159940)率，$M_r(M)$ 是恒星遗迹质量，$Z_k(t-\tau(M))$ 是恒星诞生时的气体丰度，$H$ 是赫维赛德[阶跃函数](@entry_id:159192)。一个简化的模型是**瞬时再循环近似 (Instantaneous Recycling Approximation, IRA)**，它假设所有恒星（或至少是大质量恒星）的寿命为零，所有抛射物瞬时返回。这在研究长时标演化时是一种有用的简化 [@problem_id:3505145]。

#### [恒星反馈](@entry_id:755431)与[过冷问题](@entry_id:753036)

[恒星形成](@entry_id:159940)后，它们会通过[恒星风](@entry_id:161386)、辐射和最终的超[新星爆发](@entry_id:160050)向周围环境注入大量的能量和动量。这种**[恒星反馈](@entry_id:755431) (stellar feedback)** 对于调节星系的恒星形成至关重要。没有反馈，气体将不受控制地冷却和坍缩，导致远超观测的[恒星形成](@entry_id:159940)率。

然而，在[数值模拟](@entry_id:137087)中有效地实现反馈是一个巨大的挑战，这源于所谓的**[过冷问题](@entry_id:753036) (overcooling problem)**。问题在于，当能量以纯热能形式注入到分辨率有限的致密气体单元时，该单元的温度会升高。但如果这个温度恰好落入冷却曲线的峰值附近（如 $T \sim 10^{5.5} \, \text{K}$），其[辐射冷却](@entry_id:754014)时标 $t_{\text{cool}}$ 会变得极短。在典型的模拟分辨率下，$t_{\text{cool}}$ 往往远小于气体单元的动力学时标（如声波穿越时间 $t_{\text{cross}} = \Delta x / c_s$）。结果，注入的能量在能够膨胀并对周围环境做机械功之前，就几乎全部被辐射掉了，导致反馈失效 [@problem_id:3505167]。

为了克服这个问题，发展了不同的反馈耦合方案 [@problem_id:3505167]：
- **热能反馈 (Thermal coupling)**: 直接将能量作为内能注入。如上所述，这种方法在分辨率不足时极易受到[过冷问题](@entry_id:753036)的影响。
- **动能反馈 (Kinetic coupling)**: 将一部分或全部反馈能量以动量形式注入，即给邻近的气体粒子一个速度“踢”。动量不会被辐射掉，其能量必须先通过激波等[流体动力学](@entry_id:136788)过程转化为热能才能被辐射，这提供了一个延迟机制，使得反馈更有效。
- **机械反馈 (Mechanical coupling)**: 这是一种更复杂的方案，旨在确保无论模拟的分辨率如何，都能注入正确的总动量。其逻辑是：如果模拟能够解析[超新星遗迹](@entry_id:267906)的[能量守恒](@entry_id:140514)（Sedov-Taylor）阶段，就注入能量让流体自行演化；如果不能，就直接注入由高分辨率模型或解析理论预先算好的、遗迹演化到[动量守恒](@entry_id:149964)阶段时应有的“终端动量” $p_t$。这种方法通过在不同分辨率下切换模式，实现了近似分辨率无关的反馈效果。

### [数值验证](@entry_id:156090)的基础

#### 定义分辨率

理解模拟结果的前提是清晰地定义其分辨率 [@problem_id:3505203]。
- **空间分辨率 (Spatial resolution)**: 模拟能够明确解析的最小水动力学长度尺度。在 AMR 中是最小单元尺寸 $\Delta x_{\text{min}}$，在 SPH 中是最小平滑长度 $h_{\text{min}}$。
- **[质量分辨率](@entry_id:197946) (Mass resolution)**: 模拟中最小的质量单元。在[拉格朗日方法](@entry_id:142825)（如 SPH 或 N 体）中，是单个粒子的质量 $m_p$。它决定了能够无统计噪声地追踪的最小质量结构。
- **[时间分辨率](@entry_id:194281) (Temporal resolution)**: 模拟中用于推进系统状态的[积分时间步长](@entry_id:162921) $\Delta t$。它不是用户任意选择的，而是由稳定性条件严格限制的。对于显式水动力学方案，它必须满足**库朗-弗里德里希斯-列维 ([Courant-Friedrichs-Lewy](@entry_id:175598), CFL)** 条件，$\Delta t \le C_{\text{CFL}} \Delta x / (c_s + |\mathbf{v}|)$。此外，其他快速物理过程（如冷却）可能要求更小的时间步。

#### [次网格模型](@entry_id:755601)下的收敛性

在存在[次网格模型](@entry_id:755601)的情况下，评估模拟的收敛性变得复杂。
- **强收敛 (Strong convergence)**: 指的是当模拟分辨率提高时，其宏观预测结果（如总[恒星形成](@entry_id:159940)率）趋向一个稳定解，而**无需**重新调整[次网格模型](@entry_id:755601)的参数。这是理想情况，但极为罕见。
- **[弱收敛](@entry_id:146650) (Weak convergence)**: 指的是在提高分辨率的同时，**允许**对[次网格模型](@entry_id:755601)的参数进行重新校准，以使得宏观预测结果与观测或其他目标保持一致。这是[星系形成](@entry_id:160121)模拟领域的通行做法，它承认了[次网格模型](@entry_id:755601)是与特定分辨率绑定的“有效理论” [@problem_id:3505203]。