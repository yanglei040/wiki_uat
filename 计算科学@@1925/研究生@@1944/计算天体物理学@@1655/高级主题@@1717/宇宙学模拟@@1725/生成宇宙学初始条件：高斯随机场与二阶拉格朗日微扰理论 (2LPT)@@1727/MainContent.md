## 引言
[宇宙学N体模拟](@entry_id:747920)是理解宇宙大尺度结构形成与演化的核心工具，而所有模拟的成败都始于其第一步：生成精确的[初始条件](@entry_id:152863)。这些[初始条件](@entry_id:152863)必须准确地反映我们通过宇宙微波背景辐射等观测所推断出的[早期宇宙](@entry_id:160168)的统计特性。然而，将一个描述密度涨落的连续[随机场](@entry_id:177952)理论，转化为一个包含数以百万计离散粒子位置和速度的具体数据集，是一项充满挑战的计算任务。简单的近似方法虽然直观，但往往会引入非物理的效应，污染模拟结果的准确性。本文旨在系统性地解决这一问题。

在接下来的章节中，我们将踏上一段从理论到实践的旅程。第一章，“原理和机制”，将深入剖析作为[初始条件](@entry_id:152863)理论基石的[高斯随机场](@entry_id:749757)，并详细阐述如何利用一阶和[二阶拉格朗日微扰理论](@entry_id:754600)（2LPT）将密度场转化为粒子位移场，重点解释为何2LPT对于生成高精度[初始条件](@entry_id:152863)至关重要。第二章，“应用与[交叉](@entry_id:147634)学科联系”，将展示这些理论如何在实际模拟中被应用，如何处理多组分物理，以及如何与其他学术领域（如信号处理和观测宇宙学）产生联系。最后，在“动手实践”部分，您将有机会通过具体的编程练习，亲手实现并验证这些强大的算法。通过本文的学习，您将掌握构建高质量[宇宙学初始条件](@entry_id:747919)的核心技术，为开展前沿的[计算宇宙学](@entry_id:747605)研究打下坚实的基础。

## 原理和机制

本章深入探讨了为[宇宙学模拟](@entry_id:747928)生成初始条件的基本原理和数值机制。在宇宙学标准模型（例如 $\Lambda$CDM 模型）的框架内，我们假定宇宙中的结构源于早期宇宙中微小的初始密度涨落，这些涨落随后在[引力](@entry_id:175476)的作用下不断增长。本章的目标是系统地阐述如何从统计理论出发，构建一个精确描述这些初始涨落的数学模型，并将其转化为可用于[数值模拟](@entry_id:137087)的[粒子分布](@entry_id:158657)。我们将首先定义作为宇宙[初始条件](@entry_id:152863)核心的[高斯随机场](@entry_id:749757)及其统计描述符——功率谱。随后，我们将详细阐述如何利用[拉格朗日微扰理论](@entry_id:751116)（Lagrangian Perturbation Theory, LPT），特别是到二阶（2LPT），来计算粒子从其初始[均匀分布](@entry_id:194597)位置的位移和速度。最后，我们将讨论一些对生成高质量初始条件至关重要的高级主题和实践考量。

### 宇宙[初始条件](@entry_id:152863)：[高斯随机场](@entry_id:749757)

现代宇宙学的一个核心假设是，早期宇宙中的初始密度涨落构成了一个统计上均匀且各向同性的**[高斯随机场](@entry_id:749757)**。让我们来精确地阐述这一概念。

考虑宇宙中的[物质密度](@entry_id:263043)场 $\rho(\mathbf{x})$，其中 $\mathbf{x}$ 是[共动坐标](@entry_id:271238)。我们可以定义一个无量纲的**物质过密度场**（或密度差）$\delta(\mathbf{x})$，它表示了任意点密度相对于宇宙平均密度 $\bar{\rho}$ 的涨落：
$$
\delta(\mathbf{x}) \equiv \frac{\rho(\mathbf{x}) - \bar{\rho}}{\bar{\rho}}
$$
在初始时刻，该场的平均值为零，即 $\langle \delta(\mathbf{x}) \rangle = 0$。[@problem_id:3512384]

一个[随机场](@entry_id:177952)是“高斯的”，意味着其所有统计性质完全由其均值和[两点相关函数](@entry_id:185074)所决定。对于一个均值为零的场，这表示我们只需要知道它的协[方差](@entry_id:200758)。由于[统计均匀性](@entry_id:136481)（在空间中任意平移下统计性质不变）和各向同性（在任意旋转下统计性质不变），[两点相关函数](@entry_id:185074) $\xi(\mathbf{x}_1, \mathbf{x}_2) = \langle \delta(\mathbf{x}_1) \delta(\mathbf{x}_2) \rangle$ 只依赖于两点间的距离 $r = |\mathbf{x}_1 - \mathbf{x}_2|$。

在傅里叶空间中分析更为便捷。场的[傅里叶变换](@entry_id:142120)为 $\delta(\mathbf{k})$。[统计均匀性](@entry_id:136481)意味着不同傅里叶模式是不相关的。[统计均匀性](@entry_id:136481)和各向同性共同决定了[两点相关函数](@entry_id:185074)在傅里叶空间中的形式，它定义了**[功率谱](@entry_id:159996)** $P(k)$：
$$
\langle \delta(\mathbf{k}) \delta(\mathbf{k}') \rangle = (2\pi)^3 \delta_{\mathrm{D}}(\mathbf{k}+\mathbf{k}') P(k)
$$
其中 $\delta_{\mathrm{D}}$ 是狄拉克 delta 函数，它强制要求动量守恒（即[波矢](@entry_id:178620)之和为零），$k = |\mathbf{k}|$ 是波矢的模。[功率谱](@entry_id:159996) $P(k)$ 的量纲是体积，它量化了在尺度 $\sim 1/k$ 上[密度涨落](@entry_id:143540)的[方差](@entry_id:200758)。

[高斯随机场](@entry_id:749757)的关键特性是，所有高于二阶的**连通相关函数**（或[累积量](@entry_id:152982)）均为零。例如，三点连通[相关函数](@entry_id:146839) $\langle \delta(\mathbf{x}_1) \delta(\mathbf{x}_2) \delta(\mathbf{x}_3) \rangle_c$ 为零。这意味着初始密度场不存在本征的非高斯性。然而，这并不意味着所有高阶相关函数都为零。例如，四点全相关函数可以通过维克定理（Wick's theorem）分解为两点函数的乘积之和，因此通常不为零。[@problem_id:3512380]

[引力](@entry_id:175476)演化是[非线性](@entry_id:637147)的，它会从初始的高斯场中催生出非高斯性。例如，即使初始的三点函数为零，经过[引力](@entry_id:175476)演化后，它也会增长。这个演化后的三点函数在傅里叶空间中通常用**等分谱**（bispectrum）$B(\mathbf{k}_1, \mathbf{k}_2, \mathbf{k}_3)$ 来描述：
$$
\langle \delta(\mathbf{k}_1) \delta(\mathbf{k}_2) \delta(\mathbf{k}_3) \rangle = (2\pi)^3 \delta_{\mathrm{D}}(\mathbf{k}_1+\mathbf{k}_2+\mathbf{k}_3) B(\mathbf{k}_1, \mathbf{k}_2, \mathbf{k}_3)
$$
正如我们将在后面看到的，[二阶拉格朗日微扰理论](@entry_id:754600)（2LPT）恰恰是为了捕捉这种由[引力](@entry_id:175476)诱导的、最低阶的非高斯性。[@problem_id:3512380]

### [物质功率谱](@entry_id:161407)：从[原初涨落](@entry_id:158466)到晚期结构

既然功率谱 $P(k)$ 完全定义了初始的[随机场](@entry_id:177952)，那么它的具体形式是什么？现代宇宙学理论提供了一个从[原初涨落](@entry_id:158466)到特定宇宙时刻[物质功率谱](@entry_id:161407)的完整构建方案。

这个构建过程始于宇宙极早期，例如[暴胀时期](@entry_id:161642)。[暴胀](@entry_id:161204)理论预言，[量子真空涨落](@entry_id:141582)被拉伸到宏观尺度，形成了一个近乎[尺度不变的](@entry_id:178566)**原初曲率微扰**[功率谱](@entry_id:159996)。这个谱通常被[参数化](@entry_id:272587)为一个[幂律](@entry_id:143404)形式，由振幅 $A_s$ 和[谱指数](@entry_id:159172) $n_s$ 描述。

这些[原初涨落](@entry_id:158466)并非直接演化为我们今天看到的物质[分布](@entry_id:182848)。在它们演化的过程中，它们会受到各种与尺度相关的物理过程的影响。例如，在[辐射主导时期](@entry_id:261886)，进入视界的模式其增长会受到抑制（Mészáros 效应）；在复合之前，重子和[光子](@entry_id:145192)之间的紧密耦合会产生声波[振荡](@entry_id:267781)，在功率谱上留下印记，即**[重子声学振荡](@entry_id:158848)**（Baryon Acoustic Oscillations, BAO）。所有这些线性物理过程的综合效应被编码在一个无量纲的**[转移函数](@entry_id:273897)** $T(k)$ 中。按照惯例，$T(k)$ 被归一化，使得在非常大的尺度上（$k \to 0$），$T(k) \to 1$，因为这些尺度上的模式演化不受微观物理的影响。

最后，一旦物质主导宇宙，所有尺度的扰动都会在[引力不稳定性](@entry_id:160721)下以相同的方式增长。这种整体性的增长由**[线性增长因子](@entry_id:751309)** $D(a)$ 描述，它只依赖于宇宙标度因子 $a$。

综合以上所有要素，我们可以在任意标度因子 $a$ 时刻，构建出线性的[物质功率谱](@entry_id:161407) $P_\delta(k, a)$。它与原初曲率功率谱 $P_{\mathcal{R}}(k)$ 的关系如下：
$$
P_\delta(k,a) = \left[ \frac{2}{5} \frac{k^2 T(k) D(a)}{\Omega_m H_0^2} \right]^2 P_{\mathcal{R}}(k)
$$
其中 $\Omega_m$ 是当今的[物质密度](@entry_id:263043)参数，$H_0$ 是哈勃常数。这个公式精确地展示了各个部分的作用：$P_{\mathcal{R}}(k)$ 提供了原初的振幅和倾斜（由 $A_s$ 和 $n_s$ 决定），$T(k)$ 塑造了谱的形状，而 $D(a)$ 则描述了整体振幅随时间的增长。因此，[转移函数](@entry_id:273897) $T(k)$ 是一个形状函数，而[功率谱](@entry_id:159996) $P(k, a)$ 是一个包含振幅、形状和增长历史的、具有物理量纲的完整统计量。[@problem_id:3512384] 这个 $P(k, a)$ 就是我们生成初始条件时需要使用的理论输入。

### 在离散网格上生成高斯场

为了在计算机上实现这一过程，我们必须将连续的理论描述离散化。我们考虑一个边长为 $L$ 的周期性立方体盒子，并将其划分为 $N^3$ 个网格点。

场 $\delta(\mathbf{x})$ 的[傅里叶表示](@entry_id:749544)现在变成一个离散的[傅里叶级数](@entry_id:139455)。我们的目标是为每个离散的[波矢](@entry_id:178620) $\mathbf{k}$ 生成一个傅里叶振幅 $\delta_{\mathbf{k}}$，使其统计性质与理论功率谱 $P(k)$ 相符。

具体的采样过程如下：
1.  **模式的[方差](@entry_id:200758)**：在有限体积 $V=L^3$ 的盒子中，对于定义为 $\delta_{\mathbf{k}} = \frac{1}{V} \int_V d^3x e^{-i\mathbf{k}\cdot\mathbf{x}} \delta(\mathbf{x})$ 的离散傅里叶模式，其[方差](@entry_id:200758)与功率谱的关系为 $\langle |\delta_{\mathbf{k}}|^2 \rangle = P(k)/V$。我们的采样必须重现这个[方差](@entry_id:200758)。

2.  **高斯采样**：由于 $\delta(\mathbf{x})$ 是一个[高斯随机场](@entry_id:749757)，它的[傅里叶系数](@entry_id:144886) $\delta_{\mathbf{k}}$ 必须是复高斯[随机变量](@entry_id:195330)。这意味着 $\delta_{\mathbf{k}}$ 的实部和虚部都是独立的高斯[随机变量](@entry_id:195330)。

3.  **实数场约束**：物理的密度场 $\delta(\mathbf{x})$ 是一个实数场。这对它的[傅里叶变换](@entry_id:142120)施加了一个关键的对称性要求，即**[厄米对称性](@entry_id:266311)**（Hermitian symmetry）：$\delta_{-\mathbf{k}} = \delta_{\mathbf{k}}^*$。这意味着如果我们知道了 $\delta_{\mathbf{k}}$，那么 $\delta_{-\mathbf{k}}$ 就被完全确定了。这个约束将独立的傅里叶模式数量减少了大约一半。[@problem_id:3512396] [@problem_id:3512395]

4.  **均值约束**：为了确保盒子里的平均密度与宇宙平均密度一致，我们需要强制要求平均过密度为零，即 $\int_V \delta(\mathbf{x}) d^3x = 0$。这等价于要求 $\mathbf{k}=0$ 的傅里叶模式（即[直流分量](@entry_id:272384)）为零：$\delta_{\mathbf{k}=0} = 0$。

综合这些要点，一个标准的采样算法如下 [@problem_id:3512396]：
-   首先，将 $\delta_{\mathbf{k}=0}$ 设置为 0。
-   对于“一般”的[波矢](@entry_id:178620) $\mathbf{k}$（即在离散网格上 $\mathbf{k} \neq -\mathbf{k}$），我们只对其中一半进行独立采样。对每一个这样的 $\mathbf{k}$，我们从均值为零、[方差](@entry_id:200758)为 $\frac{1}{2} \frac{P(k)}{V}$ 的高斯分布中独立抽取其实部 $\mathrm{Re}\,\delta_{\mathbf{k}}$ 和虚部 $\mathrm{Im}\,\delta_{\mathbf{k}}$。然后，我们利用[厄米对称性](@entry_id:266311)设置其共轭伙伴：$\delta_{-\mathbf{k}} = \mathrm{Re}\,\delta_{\mathbf{k}} - i\,\mathrm{Im}\,\delta_{\mathbf{k}}$。
-   对于“自共轭”的特殊[波矢](@entry_id:178620) $\mathbf{k}$（即 $\mathbf{k} \neq \mathbf{0}$ 但在网格上 $\mathbf{k} = -\mathbf{k}$，例如在奈奎斯特频率上的模式），[厄米对称性](@entry_id:266311) $\delta_{\mathbf{k}} = \delta_{\mathbf{k}}^*$ 要求其虚部必须为零。因此，对于这些模式，我们设置 $\mathrm{Im}\,\delta_{\mathbf{k}} = 0$，并从均值为零、[方差](@entry_id:200758)为 $\frac{P(k)}{V}$ 的[高斯分布](@entry_id:154414)中抽取其实部。

这个过程确保了我们生成的离散场 $\delta_{\mathbf{k}}$ 在[傅里叶变换](@entry_id:142120)回实空间后，会得到一个具有正确功率谱、均值为零的实数[高斯随机场](@entry_id:749757) $\delta(\mathbf{x})$。

### 从密度到位移：[拉格朗日微扰理论](@entry_id:751116)

我们已经生成了一个描述初始[密度涨落](@entry_id:143540)的场，但 $N$-体模拟需要的是粒子的位置和速度。**[拉格朗日微扰理论](@entry_id:751116)（LPT）** 提供了一个将连续的密度场转化为离散粒子位移的框架。

在拉格朗日图像中，我们跟踪每个流[体元](@entry_id:267802)素（最终成为模拟中的粒子）的轨迹。一个最初位于拉格朗日坐标 $\mathbf{q}$ 的粒子，在时间 $t$ 会移动到欧拉坐标 $\mathbf{x}(\mathbf{q}, t)$。这个过程由**位移场** $\mathbf{\Psi}(\mathbf{q}, t)$ 描述：
$$
\mathbf{x}(\mathbf{q}, t) = \mathbf{q} + \mathbf{\Psi}(\mathbf{q}, t)
$$

#### 一阶LPT：[泽尔多维奇近似](@entry_id:139227)

LPT 的[一阶近似](@entry_id:147559)，即**[泽尔多维奇近似](@entry_id:139227)**（Zel'dovich Approximation, ZA），提供了一个极其优雅且有洞察力的初始位移模型。ZA 的核心结果是，一阶位移场可以分解为一个仅依赖于时间的增长因子和一个仅依赖于空间的矢量场的乘积：
$$
\mathbf{\Psi}^{(1)}(\mathbf{q}, t) = D_1(t) \mathbf{S}(\mathbf{q})
$$
这个时空可分离性意味着，每个粒子从其初始位置 $\mathbf{q}$ 的位移方向是固定的，由向量 $\mathbf{S}(\mathbf{q})$ 决定，而位移的大小则随着时间由增长因子 $D_1(t)$ 统一缩放。因此，在[共动坐标系](@entry_id:266800)中，每个粒子的轨迹都是一条直线。[@problem_id:3512390]

如何从我们的密度场构建这个位移场呢？线性理论中的质量守恒定律给出了答案。对于无[旋流](@entry_id:153202)，一阶[位移场](@entry_id:141476)可以写成一个标量势 $\phi^{(1)}$ 的梯度：$\mathbf{\Psi}^{(1)} = -\nabla_q \phi^{(1)}$。这个位移势与线性密度场之间有一个简单的泊松型关系：$\nabla_q^2 \phi^{(1)} = \delta^{(1)}$。在傅里叶空间中，这使得计算变得异常简单：
$$
\mathbf{\Psi}^{(1)}(\mathbf{k}) = -i\mathbf{k} \phi^{(1)}(\mathbf{k}) = \frac{i\mathbf{k}}{k^2} \delta^{(1)}(\mathbf{k})
$$
这样，我们就把生成的密度场 $\delta^{(1)}$ 转换成了粒子[位移场](@entry_id:141476) $\mathbf{\Psi}^{(1)}$。粒子的速度则与位移平行，其大小由增长因子的时间导数决定。

#### 二阶LPT的必要性：抑制暂现效应

尽管[泽尔多维奇近似](@entry_id:139227)在描述大尺度结构上非常成功，但它在生成高精度的[初始条件](@entry_id:152863)方面存在一个系统性的缺陷。动力学演化的真实解包含了一系列增长模式和衰减模式。一个理想的[初始条件](@entry_id:152863)应该只包含纯粹的增长模式。ZA 只在扰动的一阶上匹配了这个纯增长解。

当我们只使用 ZA 来设置[初始条件](@entry_id:152863)时，我们实际上在二阶及更高阶上引入了一个与真实增长解的偏差。这个偏差在随后的 $N$-体模拟中必须通过激发相应的**衰减模式**来“放松”掉。这些非物理的衰减模式被称为**暂现效应**（transients）。它们是初始条件不够精确的标志，会污染模拟的早期演化，直到它们衰减掉为止。[@problem_id:3512397]

为了克服这个问题，我们需要一个更精确的初始条件，即**[二阶拉格朗日微扰理论](@entry_id:754600)（2LPT）**。通过在初始设置中就包含位移场的二阶增长模式解 $\mathbf{\Psi}^{(2)}$, 2LPT 极大地抑制了这些暂现效应，使得模拟从一开始就更接近真实的物理演化。这对于研究结构的[非线性](@entry_id:637147)演化至关重要。

### [二阶拉格朗日微扰理论](@entry_id:754600)（2LPT）的机制

2LPT 的目标是计算[位移场](@entry_id:141476)的[二阶修正](@entry_id:199233)项 $\mathbf{\Psi}^{(2)}$。这个修正项源于[流体方程](@entry_id:195729)中的[非线性](@entry_id:637147)项，它描述了一阶扰动之间的相互作用。

这个[二阶修正](@entry_id:199233)项同样可以从一个二阶位移势 $\phi^{(2)}$ 导出：$\mathbf{\Psi}^{(2)} = -\nabla_q \phi^{(2)}$。与一阶不同，$\phi^{(2)}$ 的[源项](@entry_id:269111)不是线性密度场，而是由一阶位移势 $\phi^{(1)}$ 的[二阶导数](@entry_id:144508)（即[潮汐张量](@entry_id:755970)）的二次组合构成。在一个爱因斯坦-德西特（EdS）宇宙中，这个源方程的具体形式为：
$$
\nabla_q^2 \phi^{(2)} = \sum_{i>j} \left[ (\phi^{(1)}_{,ii})(\phi^{(1)}_{,jj}) - (\phi^{(1)}_{,ij})^2 \right]
$$
其中 $\phi^{(1)}_{,ij} \equiv \partial^2\phi^{(1)}/\partial q_i \partial q_j$ 是一阶势的黑塞矩阵（Hessian matrix）的元素。[@problem_id:3512394] 这个方程揭示了2LPT的核心物理：一阶扰动产生的潮汐场作为源，驱动了二阶位移。正是这个二阶位移项 $\mathbf{\Psi}^{(2)}$ 的方向通常与一阶位移 $\mathbf{\Psi}^{(1)}$ 的方向不同，从而使粒子的总轨迹弯曲，脱离了[泽尔多维奇近似](@entry_id:139227)的直线路径。[@problem_id:3512390]

在数值上，计算 $\mathbf{\Psi}^{(2)}$ 通常采用**[伪谱法](@entry_id:753853)**（pseudo-spectral method），它利用快速傅里叶变换（FFT）高效地进行[微分](@entry_id:158718)和求解[泊松方程](@entry_id:143763)。一个稳健的算法流程如下 [@problem_id:3512417]：
1.  **计算[潮汐张量](@entry_id:755970)**：从傅里叶空间的一阶势 $\phi^{(1)}(\mathbf{k})$ 开始，通过乘以 $-k_i k_j$ 得到[潮汐张量](@entry_id:755970)各分量 $T_{ij}(\mathbf{k}) = -k_i k_j \phi^{(1)}(\mathbf{k})$。然后通过逆 FFT 将其转换到实空间 $T_{ij}(\mathbf{q})$。
2.  **处理混淆**：在计算 $T_{ij}(\mathbf{q})$ 的逆 FFT 之前，必须对[高频模式](@entry_id:750297)进行滤波（例如，采用“三分之二规则”），以防止在下一步计算二次乘积时产生**混淆**（aliasing）误差。这是一个保证[数值精度](@entry_id:173145)的关键步骤。
3.  **构建[源项](@entry_id:269111)**：在[实空间](@entry_id:754128)中，根据上述方程计算二次型源项 $S_2(\mathbf{q})$。
4.  **求解[泊松方程](@entry_id:143763)**：将[源项](@entry_id:269111) $S_2(\mathbf{q})$ 通过 FFT 转换回傅里叶空间 $S_2(\mathbf{k})$。然后通过代数运算求解 $\phi^{(2)}$：$\phi^{(2)}(\mathbf{k}) = -S_2(\mathbf{k})/k^2$（对于所有 $\mathbf{k}\neq\mathbf{0}$）。$\mathbf{k}=\mathbf{0}$ 模式需要特殊处理，通常设为零。
5.  **计算二阶位移**：在傅里叶空间中，通过乘以 $-i\mathbf{k}$ 得到二阶[位移场](@entry_id:141476)：$\mathbf{\Psi}^{(2)}(\mathbf{k}) = -i\mathbf{k}\phi^{(2)}(\mathbf{k})$。
6.  **最终结果**：对 $\mathbf{\Psi}^{(2)}(\mathbf{k})$ 进行逆 FFT，得到[实空间](@entry_id:754128)中的二阶[位移场](@entry_id:141476) $\mathbf{\Psi}^{(2)}(\mathbf{q})$。

总位移场（到二阶）就是 $\mathbf{\Psi} \approx \mathbf{\Psi}^{(1)} + \mathbf{\Psi}^{(2)}$，它将被应用于初始的[粒子分布](@entry_id:158657)上。

### 高级主题和实践考量

为了生成最高质量的初始条件，还有一些重要的实践细节需要考虑。

#### 未扰动[粒子[分](@entry_id:158657)布](@entry_id:182848)：网格 vs. “玻璃”

在应用 LPT 位移之前，我们需要一个代表均匀宇宙的初始[粒子分布](@entry_id:158657) $\mathbf{q}$。最简单的选择是一个规则的立方体**网格**。然而，网格具有内禀的各向异性——它有特定的优选方向（[晶格](@entry_id:196752)轴），其[傅里叶变换](@entry_id:142120)由位于倒易点阵上的尖锐布拉格峰构成。这种各向异性会在后续的力计算中引入非物理的人为效应，破坏模拟的统计完整性。

一个更优越的选择是使用所谓的“**玻璃**”（glass）构型。玻璃是一种非晶态的、无序的类固态结构，它在统计上是均匀且各向同性的。它的生成方法如下 [@problem_id:3512386]：
1.  从一个随机的泊松点[分布](@entry_id:182848)开始。
2.  让粒子在一种**排斥性**的（反向）[引力](@entry_id:175476)作用下演化，同时加入一个强大的速度阻尼项。这个过程相当于在[排斥势能](@entry_id:185622)面上进行[梯度下降](@entry_id:145942)。
3.  系统最终会弛豫到一个稳定的低能态。在这个状态下，每个粒子都与其他粒子保持一定距离，导致小尺度上的[两点相关函数](@entry_id:185074)为负（$\xi(r)  0$），并且大尺度上的结构因子被强烈抑制（$S(k) \to 0$ as $k \to 0$）。

由于玻璃构型是统计各向同性的，并且没有布拉格峰，它为 LPT 位移提供了一个“安静”且无偏的背景，从而显著减少了[数值模拟](@entry_id:137087)中的人为各向异性。

#### 直流模式和分离宇宙

在有限的模拟盒子中，密度场的平均值 $\delta_{\text{box}}$（即 $\mathbf{k}=0$ 的直流模式）不一定严格为零。这个非零的均值并非数值错误，而是具有深刻的物理意义，它代表了尺度远大于模拟盒子的“超视界”模式的影响。

**分离宇宙**（separate universe）框架为我们理解这一效应提供了有力的工具。在这个框架下，整个模拟盒子被看作一个嵌入在全局宇宙中的、具有略微不同背景密度的微型 FLRW 宇宙。[@problem_id:3512457]
-   一个正的 $\delta_{\text{box}}  0$ 意味着盒子内的平均密度高于宇宙平均值。这会导致更强的[引力](@entry_id:175476)，从而减缓盒子的局部膨胀。
-   反直觉的是，虽然膨胀变慢，但盒内结构的增长实际上被**增强**了。这是因为减弱的哈勃摩擦和增强的[引力不稳定性](@entry_id:160721)都促进了扰动的增长。因此，局部的[线性增长因子](@entry_id:751309) $D_{1,W}$ 会大于全局的 $D_1$。
-   这种对增长历史的改变同样会影响二阶增长因子 $D_{2,W}$。

因此，为了达到最高的精度，在计算 2LPT 位移和速度时，所使用的增长因子 $D_1$ 和 $D_2$ 应该根据每个具体实现中的 $\delta_{\text{box}}$ 值进行相应的修正。这确保了盒内的小尺度演化能够正确地耦合到大尺度环境的影响。