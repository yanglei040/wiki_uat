{"hands_on_practices": [{"introduction": "在将复杂的核反应网络集成到恒星代码中之前，验证输入物理数据的内部一致性是至关重要的一步。本练习将指导您完成一个基本但核心的任务：利用核质量数据计算反应的$Q$值，并验证其可加性，从而加深对质能等价原理与恒星能量产生之间联系的理解。[@problem_id:3525259]", "problem": "构建数值上自洽的恒星核反应网络的一个核心要求是，原子核质量、热激发的激发态（编码在原子核配分函数中）和列表的反应能量学共同满足能量守恒和细致平衡。考虑通过两个辐射俘获过程进行的氦燃烧：3α过程和随后在碳上的α俘获，最终形成氧。要求您验证原子核质量数据的内部一致性，并计算比能量产生率。\n\n从质能等效原理和原子核配分函数的定义出发。假设一个均匀区域，其温度 $T = 2.0 \\times 10^{8}\\ \\mathrm{K}$，密度 $\\rho = 1.00 \\times 10^{5}\\ \\mathrm{g\\,cm^{-3}}$。该网络将四个α粒子转化为一个氧核的复合反应的净体积反应进度以摩尔形式报告为 $r_{\\mathrm{mol}} = 1.000 \\times 10^{-5}\\ \\mathrm{mol\\,cm^{-3}\\,s^{-1}}$。在此温度下，原子核配分函数为 $G(^{4}\\mathrm{He}) = 1.0000$，$G(^{12}\\mathrm{C}) = 1.0003$ 和 $G(^{16}\\mathrm{O}) = 1.0002$。原子质量（以统一原子质量单位计）为 $m(^{4}\\mathrm{He}) = 4.00260325413\\ \\mathrm{u}$，$m(^{12}\\mathrm{C}) = 12.00000000000\\ \\mathrm{u}$ 和 $m(^{16}\\mathrm{O}) = 15.99491461957\\ \\mathrm{u}$。使用阿伏伽德罗常数 $N_{\\!A} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$，转换关系 $1\\ \\mathrm{u}\\,c^{2} = 931.49410242\\ \\mathrm{MeV}$，以及 $1\\ \\mathrm{MeV} = 1.602176634 \\times 10^{-6}\\ \\mathrm{erg}$。\n\n任务：\n1) 仅使用原子质量和质能等效性，计算两步氦燃烧序列的能量释放并验证其可加性。具体来说，计算反应 $3\\,^{4}\\mathrm{He} \\rightarrow\\, ^{12}\\mathrm{C} + \\gamma$ 和 $^{12}\\mathrm{C} +\\, ^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$ 的能量释放，并证明它们的和在舍入误差范围内等于直接净反应 $4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$ 的能量释放。除了基本原理外，不要假设任何给定的简化公式。\n\n2) 从第一性原理出发，论证在温度 $T$ 下，所提供的原子核配分函数是否会改变每次反应事件释放的能量，并解释它们是如何参与正向和反向反应速率之间的细致平衡的。\n\n3) 使用您为 $4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$ 推导出的净能量释放和报告的摩尔体积反应进度 $r_{\\mathrm{mol}}$，通过阿伏伽德罗常数 (N_A) 将摩尔进度转换为单位体积单位时间内的反应事件数，然后除以质量密度 $\\rho$，计算比能量产生率 $\\epsilon$。\n\n将您计算的 $\\epsilon$ 最终答案四舍五入至四位有效数字。最终结果以 $\\mathrm{erg\\,g^{-1}\\,s^{-1}}$ 为单位表示。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 问题验证\n\n#### 步骤1：提取给定条件\n- **恒星条件**：均匀区域，温度 $T = 2.0 \\times 10^{8}\\ \\mathrm{K}$，密度 $\\rho = 1.00 \\times 10^{5}\\ \\mathrm{g\\,cm^{-3}}$。\n- **核反应**：\n  - 3α过程：$3\\,^{4}\\mathrm{He} \\rightarrow\\, ^{12}\\mathrm{C} + \\gamma$\n  - α俘获：$^{12}\\mathrm{C} +\\, ^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$\n  - 净反应：$4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$\n- **反应进度**：复合反应 $4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O}$ 的净摩尔体积反应进度为 $r_{\\mathrm{mol}} = 1.000 \\times 10^{-5}\\ \\mathrm{mol\\,cm^{-3}\\,s^{-1}}$。\n- **原子核配分函数**：在给定温度下，$G(^{4}\\mathrm{He}) = 1.0000$，$G(^{12}\\mathrm{C}) = 1.0003$，$G(^{16}\\mathrm{O}) = 1.0002$。\n- **原子质量 (u)**：\n  - $m(^{4}\\mathrm{He}) = 4.00260325413\\ \\mathrm{u}$\n  - $m(^{12}\\mathrm{C}) = 12.00000000000\\ \\mathrm{u}$\n  - $m(^{16}\\mathrm{O}) = 15.99491461957\\ \\mathrm{u}$\n- **物理常数和转换关系**：\n  - 阿伏伽德罗常数：$N_{\\!A} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n  - 质能转换：$1\\ \\mathrm{u}\\,c^{2} = 931.49410242\\ \\mathrm{MeV}$\n  - 能量转换：$1\\ \\mathrm{MeV} = 1.602176634 \\times 10^{-6}\\ \\mathrm{erg}$\n\n#### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，处于核天体物理学的标准框架内。它涉及通过质能等效性计算核反应的能量释放，以及随后确定恒星能量产生率，这些都是计算天体物理学的核心课题。所提供的物理常数和原子核质量与现代高精度值一致。该问题提法明确，为所要求的计算提供了所有必要数据，并且没有矛盾、歧义或主观论断。它构成了一个标准的、可验证的物理问题。\n\n#### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 解答\n\n解答分为三部分，对应问题陈述中列出的任务。\n\n#### 1) 能量释放与可加性验证\n核反应中的能量释放，称为Q值，源自质能等效原理 $E=mc^2$。它是反应物的总静止质量与产物的总静止质量之差，再乘以光速的平方。发射的伽马光子（$\\gamma$）的质量为零。\n\n对于一个通用反应 $\\sum_i \\nu_i A_i \\rightarrow \\sum_j \\nu_j B_j$，其Q值由下式给出：\n$$\nQ = \\left( \\sum_i \\nu_i m(A_i) - \\sum_j \\nu_j m(B_j) \\right) c^2\n$$\n我们使用给定的原子质量和转换因子计算这三个反应的Q值。\n\n对于3α反应，$3\\,^{4}\\mathrm{He} \\rightarrow\\, ^{12}\\mathrm{C} + \\gamma$：\n质量差为：\n$$\n\\Delta m_1 = 3 \\times m(^{4}\\mathrm{He}) - m(^{12}\\mathrm{C})\n$$\n$$\n\\Delta m_1 = 3 \\times (4.00260325413\\ \\mathrm{u}) - 12.00000000000\\ \\mathrm{u}\n$$\n$$\n\\Delta m_1 = 12.00780976239\\ \\mathrm{u} - 12.00000000000\\ \\mathrm{u} = 0.00780976239\\ \\mathrm{u}\n$$\n释放的能量为：\n$$\nQ_1 = \\Delta m_1 c^2 = 0.00780976239\\ \\mathrm{u} \\times c^2 \\times \\frac{931.49410242\\ \\mathrm{MeV}}{1\\ \\mathrm{u}\\,c^{2}}\n$$\n$$\nQ_1 \\approx 7.2739988\\ \\mathrm{MeV}\n$$\n\n对于碳上的α俘获反应，$^{12}\\mathrm{C} +\\, ^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$：\n质量差为：\n$$\n\\Delta m_2 = m(^{12}\\mathrm{C}) + m(^{4}\\mathrm{He}) - m(^{16}\\mathrm{O})\n$$\n$$\n\\Delta m_2 = 12.00000000000\\ \\mathrm{u} + 4.00260325413\\ \\mathrm{u} - 15.99491461957\\ \\mathrm{u}\n$$\n$$\n\\Delta m_2 = 16.00260325413\\ \\mathrm{u} - 15.99491461957\\ \\mathrm{u} = 0.00768863456\\ \\mathrm{u}\n$$\n释放的能量为：\n$$\nQ_2 = \\Delta m_2 c^2 = 0.00768863456\\ \\mathrm{u} \\times c^2 \\times \\frac{931.49410242\\ \\mathrm{MeV}}{1\\ \\mathrm{u}\\,c^{2}}\n$$\n$$\nQ_2 \\approx 7.1612476\\ \\mathrm{MeV}\n$$\n\n对于净反应，$4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O} + \\gamma$：\n质量差为：\n$$\n\\Delta m_{\\text{net}} = 4 \\times m(^{4}\\mathrm{He}) - m(^{16}\\mathrm{O})\n$$\n$$\n\\Delta m_{\\text{net}} = 4 \\times (4.00260325413\\ \\mathrm{u}) - 15.99491461957\\ \\mathrm{u}\n$$\n$$\n\\Delta m_{\\text{net}} = 16.01041301652\\ \\mathrm{u} - 15.99491461957\\ \\mathrm{u} = 0.01549839695\\ \\mathrm{u}\n$$\n释放的能量为：\n$$\nQ_{\\text{net}} = \\Delta m_{\\text{net}} c^2 = 0.01549839695\\ \\mathrm{u} \\times c^2 \\times \\frac{931.49410242\\ \\mathrm{MeV}}{1\\ \\mathrm{u}\\,c^{2}}\n$$\n$$\nQ_{\\text{net}} \\approx 14.4352464\\ \\mathrm{MeV}\n$$\n\n为验证可加性，我们将两个连续步骤的能量释放相加，并与净反应的能量释放进行比较：\n$$\nQ_1 + Q_2 = 7.2739988\\ \\mathrm{MeV} + 7.1612476\\ \\mathrm{MeV} = 14.4352464\\ \\mathrm{MeV}\n$$\n这个和与计算出的 $Q_{\\text{net}}$ 完全相同。计算证实了能量释放是一个可加的状态函数，这符合能量守恒的预期。从4个α粒子到1个氧核的路径，无论是否经过中间的 $^{12}\\mathrm{C}$ 步骤，释放的总能量是相同的。\n\n#### 2) 原子核配分函数的作用\n每次反应事件释放的能量，即Q值，完全由反应物和产物原子核基态之间的静止质量差决定。对于给定的反应，这个值是一个自然常数，并且与温度等热力学条件无关。因此，所提供的原子核配分函数 $G(T)$ 不会改变Q值。\n\n原子核配分函数的作用出现在处于或接近热平衡状态的等离子体的统计力学背景中。原子核k的配分函数 $G_k(T)$ 定义为其所有能级 $E_i$（自旋为 $J_i$）的总和：\n$$\nG_k(T) = \\sum_i (2J_i+1) \\exp\\left(-\\frac{E_i}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数。$G_k(T)$ 通过考虑其激发态的热占据来量化原子核的统计权重。如果只有基态（能量 $E_0=0$，自旋 $J_0$）被占据，则 $G_k(T) \\approx 2J_0+1$。随着温度升高，更高能级的状态变得可及，$G_k(T)$ 也随之增加。所提供的值 $G(^{4}\\mathrm{He}) = 1.0000$，$G(^{12}\\mathrm{C}) = 1.0003$ 和 $G(^{16}\\mathrm{O}) = 1.0002$ 都略大于1，这与这些偶偶核的基态自旋为 $J=0$ 以及在 $T = 2.0 \\times 10^{8}\\ \\mathrm{K}$ 时激发态有微小但非零的占据数是一致的。\n\n配分函数的主要作用是建立正向和反向反应速率之间的细致平衡。对于一个反应 $A+B \\leftrightarrow C+D$，正向热核反应速率 $\\langle \\sigma v \\rangle_{AB \\to CD}$ 与反向反应速率 $\\langle \\sigma v \\rangle_{CD \\to AB}$ 的比值由一个类萨哈方程（Saha-type equation）决定：\n$$\n\\frac{\\langle \\sigma v \\rangle_{AB \\to CD}}{\\langle \\sigma v \\rangle_{CD \\to AB}} = \\frac{G_C G_D}{G_A G_B} \\left(\\frac{m_C m_D}{m_A m_B}\\right)^{3/2} \\left(\\frac{2\\pi k_B T}{h^2}\\right)^{-3/2} \\propto \\frac{G_C G_D}{G_A G_B} \\exp\\left(\\frac{Q}{k_B T}\\right)\n$$\n（根据反应类型进行适当修改）。配分函数比率正确地解释了反应物和产物的统计权重，确保反应速率驱动系统趋向于统计力学所描述的正确平衡丰度。因此，它们对于模拟恒星等离子体中的逆反应（光致蜕变）至关重要。\n\n#### 3) 比能量产生率\n比能量产生率 $\\epsilon$ 是单位质量单位时间内释放的能量。其单位是 $\\mathrm{erg\\,g^{-1}\\,s^{-1}}$。\n\n首先，我们将每次反应的净能量释放 $Q_{\\text{net}}$ 从 $\\mathrm{MeV}$ 转换为 $\\mathrm{erg}$：\n$$\nQ_{\\text{net, erg}} = Q_{\\text{net}} \\times (1.602176634 \\times 10^{-6}\\ \\mathrm{erg\\,MeV^{-1}})\n$$\n$$\nQ_{\\text{net, erg}} = 14.4352464\\ \\mathrm{MeV} \\times (1.602176634 \\times 10^{-6}\\ \\mathrm{erg\\,MeV^{-1}}) \\approx 2.3127814 \\times 10^{-5}\\ \\mathrm{erg}\n$$\n\n接下来，我们使用阿伏伽德罗常数 $N_A$ 将摩尔体积反应进度 $r_{\\mathrm{mol}}$ 转换为单位体积内的反应事件速率 $R$：\n$$\nR = r_{\\mathrm{mol}} \\times N_A\n$$\n$$\nR = (1.000 \\times 10^{-5}\\ \\mathrm{mol\\,cm^{-3}\\,s^{-1}}) \\times (6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}})\n$$\n$$\nR = 6.02214076 \\times 10^{18}\\ \\mathrm{cm^{-3}\\,s^{-1}}\n$$\n这个值 $R$ 表示每立方厘米每秒发生的净 $4\\,^{4}\\mathrm{He} \\rightarrow\\, ^{16}\\mathrm{O}$ 反应的次数。\n\n体积能量产生率 $\\dot{q}$ 是每次反应的能量与单位体积反应速率的乘积：\n$$\n\\dot{q} = Q_{\\text{net, erg}} \\times R\n$$\n$$\n\\dot{q} = (2.3127814 \\times 10^{-5}\\ \\mathrm{erg}) \\times (6.02214076 \\times 10^{18}\\ \\mathrm{cm^{-3}\\,s^{-1}})\n$$\n$$\n\\dot{q} \\approx 1.392900 \\times 10^{14}\\ \\mathrm{erg\\,cm^{-3}\\,s^{-1}}\n$$\n\n最后，通过将体积能量产生率 $\\dot{q}$ 除以质量密度 $\\rho$ 得到比能量产生率 $\\epsilon$：\n$$\n\\epsilon = \\frac{\\dot{q}}{\\rho}\n$$\n$$\n\\epsilon = \\frac{1.392900 \\times 10^{14}\\ \\mathrm{erg\\,cm^{-3}\\,s^{-1}}}{1.00 \\times 10^{5}\\ \\mathrm{g\\,cm^{-3}}}\n$$\n$$\n\\epsilon = 1.392900 \\times 10^{9}\\ \\mathrm{erg\\,g^{-1}\\,s^{-1}}\n$$\n\n按要求将结果四舍五入到四位有效数字：\n$$\n\\epsilon \\approx 1.393 \\times 10^{9}\\ \\mathrm{erg\\,g^{-1}\\,s^{-1}}\n$$", "answer": "$$\\boxed{1.393 \\times 10^{9}}$$", "id": "3525259"}, {"introduction": "核反应速率是网络演化的核心，但通常以离散的表格形式提供。本练习旨在解决在这些表格数据点之间进行精确且物理上合理的插值这一关键任务，特别是使用保单调性的方法来避免非物理的振荡。掌握这项技能对于保证恒星演化模拟的准确性和数值稳定性至关重要。[@problem_id:3525292]", "problem": "您正在实现一个模块，用于插值恒星演化和爆炸模拟中使用的列表形式的核反应率。这些表格以温度 $T$（以及可选的密度 $\\rho$）的函数形式给出，您必须使用一种保持物理单调性和正性的单调三次埃尔米特方案。您的任务是使用分段三次埃尔米特插值多项式（PCHIP）实现插值，量化相对于参考物理模型的插值误差，并报告无量纲的误差度量。本问题中的所有量在计算天体物理学的背景下都是自洽且合理的。\n\n从以下基本基础和定义开始。\n\n1. 设参考的一维单位粒子对反应率由一个解析的、非共振的带电粒子聚变形式建模\n$$\nr_0(T) \\;=\\; C \\; T_9^{-2/3} \\;\\exp\\!\\big(-b \\, T_9^{-1/3}\\big),\n$$\n其中 $T_9 \\equiv T / 10^9\\,\\mathrm{K}$，$C = 4.27\\times 10^{-15}$，$b = 3.38$。此函数形式捕捉了在 $T \\in [10^7, 10^9]\\,\\mathrm{K}$ 范围内非共振反应的伽莫夫峰隧穿物理，并且在此区间上是严格为正且单调递增的。相应的对数敏感度为\n$$\n\\frac{d\\ln r_0}{d\\ln T} \\;=\\; -\\frac{2}{3} \\;+\\; \\frac{b}{3}\\,T_9^{-1/3}.\n$$\n\n2. 在一个可分离的二维模型中包含库仑屏蔽\n$$\nr(T,\\rho) \\;=\\; r_0(T)\\;\\times\\; f_{\\mathrm{screen}}(T,\\rho),\\qquad\nf_{\\mathrm{screen}}(T,\\rho) \\;=\\; \\exp\\!\\Big(A \\,\\rho_5^{1/2}\\, T_9^{-3/2}\\Big),\n$$\n其中 $\\rho_5 \\equiv \\rho / 10^5\\,\\mathrm{g\\,cm^{-3}}$，$A = 0.05$。二维对数温度敏感度为\n$$\n\\frac{d\\ln r}{d\\ln T} \\;=\\; \\left(-\\frac{2}{3} \\;+\\; \\frac{b}{3}\\,T_9^{-1/3}\\right) \\;-\\; \\frac{3}{2}\\,A\\,\\rho_5^{1/2}\\,T_9^{-3/2}.\n$$\n\n3. 定义一个特征核燃烧时间尺度（不考虑组分因子）为\n$$\n\\tau(T,\\rho) \\;\\equiv\\; \\frac{1}{\\rho\\,r(T,\\rho)}.\n$$\n为了误差量化的特殊目的，您将报告在指定热力学状态下 $\\tau$ 的相对误差。\n\n您将获得从上述参考模型中采样的列表值，并且必须使用单调三次埃尔米特方案在列表节点之间进行插值。您不得使用任何可能引入过冲的非单调样条。您应该通过将插值结果与用于生成表格的精确解析模型进行比较来计算误差。\n\n插值要求。\n\n- 沿任何一维轴使用分段三次埃尔米特插值多项式（PCHIP）。对于在 $(T,\\rho)$ 的张量积网格上的二维插值，执行一维PCHIP操作的组合：首先在固定的 $\\rho$ 下沿 $T$ 轴进行，然后沿 $\\rho$ 轴组合这些结果。为了获得网格以外某点关于 $T$ 的导数，从第一个PCHIP阶段携带 $T$ 导数，然后使用PCHIP沿 $\\rho$ 轴对该导数进行插值。\n\n- 对于在 $(T,\\rho)$ 的任何评估，计算插值 $r_{\\mathrm{interp}}(T,\\rho)$ 和插值的对数温度敏感度\n$$\n\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{interp}} \\;=\\; \\frac{T}{r_{\\mathrm{interp}}}\\,\\left(\\frac{\\partial r}{\\partial T}\\right)_{\\mathrm{interp}}.\n$$\n\n- 在任何已知精确参考值的点上量化两个误差度量：(i) 相对反应率误差\n$$\n\\varepsilon_r \\;=\\; \\left|\\frac{r_{\\mathrm{interp}} - r_{\\mathrm{exact}}}{r_{\\mathrm{exact}}}\\right|,\n$$\n以及 (ii) 归一化对数斜率误差\n$$\n\\varepsilon_s \\;=\\; \\frac{\\left|\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{interp}} - \\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{exact}}\\right|}{\\left|\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{exact}}\\right| + 10^{-12}},\n$$\n其中小的加数 $10^{-12}$ 用于正则化接近零的分母，并且不影响在给定域上的准确性。\n\n表格、网格和测试套件。\n\n- 仅含 $T$ 的一维表：\n  - 温度网格（单位：开尔文）: $T_{\\mathrm{grid}} = \\{\\,10^7,\\;2\\times 10^7,\\;5\\times 10^7,\\;10^8,\\;2\\times 10^8,\\;5\\times 10^8,\\;10^9\\,\\}$。\n  - 列表值：在 $T\\in T_{\\mathrm{grid}}$ 处精确计算的 $r_0(T)$。\n  - 查询集：从 $10^7$ 到 $10^9\\,\\mathrm{K}$（含端点）对数均匀分布的50个温度。\n  - 报告此查询集上 $\\varepsilon_r$ 和 $\\varepsilon_s$ 的最大值。\n\n- 含 $(T,\\rho)$ 的二维表：\n  - 温度网格（单位：开尔文）：与上述 $T_{\\mathrm{grid}}$ 相同。\n  - 密度网格（单位：$\\mathrm{g\\,cm^{-3}}$）: $\\rho_{\\mathrm{grid}} = \\{\\,1,\\;10,\\;100,\\;10^3\\,\\}$。\n  - 列表值：在两个网格的张量积上精确计算的 $r(T,\\rho)$。\n  - 查询集：以下集合的笛卡尔积\n    - 温度（单位：开尔文）: $T_{\\mathrm{q}} = \\{\\,1.5\\times 10^7,\\;3\\times 10^7,\\;8\\times 10^7,\\;3\\times 10^8,\\;8\\times 10^8\\,\\}$，\n    - 密度（单位：$\\mathrm{g\\,cm^{-3}}$）: $\\rho_{\\mathrm{q}} = \\{\\,5,\\;50,\\;500\\,\\}$。\n  - 报告此二维查询集上 $\\varepsilon_r$ 和 $\\varepsilon_s$ 的最大值。\n\n- 类太阳核心状态下的核时间尺度误差：\n  - 单一状态：$T_\\star = 1.57\\times 10^7\\,\\mathrm{K}$，$\\rho_\\star = 150\\,\\mathrm{g\\,cm^{-3}}$。\n  - 使用二维插值器计算 $\\tau_{\\mathrm{interp}}(T_\\star,\\rho_\\star)$，并与使用精确 $r(T,\\rho)$ 定义的 $\\tau_{\\mathrm{exact}}(T_\\star,\\rho_\\star)$ 进行比较。报告相对误差\n  $$\n  \\varepsilon_\\tau \\;=\\; \\left|\\frac{\\tau_{\\mathrm{interp}} - \\tau_{\\mathrm{exact}}}{\\tau_{\\mathrm{exact}}}\\right|.\n  $$\n\n实现和输出要求。\n\n- 使用PCHIP作为单调三次埃尔米特方法实现插值。对于二维插值，在每个 $\\rho$ 处沿 $T$ 应用PCHIP以获得插值和 $\\partial r/\\partial T$，然后沿 $\\rho$ 使用PCHIP以在目标 $\\rho$ 处获得 $r_{\\mathrm{interp}}$ 和 $(\\partial r/\\partial T)_{\\mathrm{interp}}$。\n\n- 您必须通过与上述指定的精确参考函数进行比较来计算误差。不要使用精确函数在列表节点之间进行插值。\n\n- 本问题中不出现角度。所有报告的误差度量都是无量纲的，并且必须以十进制数表示。\n\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，内含以下五个浮点数结果，每个结果均以科学记数法四舍五入至六位有效数字：$[\\max \\varepsilon_r \\text{ (一维)},\\;\\max \\varepsilon_s \\text{ (一维)},\\;\\max \\varepsilon_r \\text{ (二维)},\\;\\max \\varepsilon_s \\text{ (二维)},\\;\\varepsilon_\\tau \\text{ at } (T_\\star,\\rho_\\star)]$。例如，一个语法上有效的输出看起来像 $[1.234567\\mathrm{e}{-06},2.345678\\mathrm{e}{-05},\\dots]$。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。它提出了计算天体物理学中一个标准的、非平凡的任务：插值列表形式的核反应率并量化相关误差。所有提供的模型、常数和程序要求都是一致且物理上合理的。因此，我们可以着手解决问题。\n\n问题的核心是为温度 $T$ 和密度 $\\rho$ 的函数实现一种保形插值方案，并根据已知的解析形式评估其准确性。所选方法是分段三次埃尔米特插值多项式（PCHIP），它保证了如果基础数据是单调的，那么插值结果也将是单调的。这个属性对于像反应率这样的物理量至关重要，这些量在相关的热力学范围内通常表现出单调行为，从而防止引入可能困扰其他高阶插值方法（如标准三次样条）的非物理振荡。\n\n首先，我们定义精确的参考模型，这些模型既用于生成离散数据表，也用作误差计算的基准真相。\n\n一维、非共振的单位粒子对反应率 $r_0(T)$ 由下式给出：\n$$\nr_0(T) = C \\, T_9^{-2/3} \\exp(-b \\, T_9^{-1/3})\n$$\n其中 $T_9 \\equiv T / (10^9\\,\\mathrm{K})$，$C = 4.27 \\times 10^{-15}$，$b = 3.38$。该反应率关于温度的对数敏感度为：\n$$\n\\left(\\frac{d\\ln r_0}{d\\ln T}\\right)_{\\mathrm{exact}} = -\\frac{2}{3} + \\frac{b}{3} T_9^{-1/3}\n$$\n\n二维模型 $r(T, \\rho)$ 包含一个库仑屏蔽因子 $f_{\\mathrm{screen}}(T, \\rho)$：\n$$\nr(T,\\rho) = r_0(T) \\, f_{\\mathrm{screen}}(T,\\rho) \\quad \\text{其中} \\quad f_{\\mathrm{screen}}(T,\\rho) = \\exp\\left(A \\,\\rho_5^{1/2}\\, T_9^{-3/2}\\right)\n$$\n此处，$\\rho_5 \\equiv \\rho / (10^5\\,\\mathrm{g\\,cm^{-3}})$ 且 $A = 0.05$。相应的二维对数温度敏感度为：\n$$\n\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{exact}} = \\left(-\\frac{2}{3} + \\frac{b}{3}\\,T_9^{-1/3}\\right) - \\frac{3}{2}\\,A\\,\\rho_5^{1/2}\\,T_9^{-3/2}\n$$\n\n插值精度由两个误差度量来量化。相对反应率误差 $\\varepsilon_r$ 定义为：\n$$\n\\varepsilon_r = \\left|\\frac{r_{\\mathrm{interp}} - r_{\\mathrm{exact}}}{r_{\\mathrm{exact}}}\\right|\n$$\n归一化对数斜率误差 $\\varepsilon_s$ 定义为：\n$$\n\\varepsilon_s = \\frac{\\left|\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{interp}} - \\left(\\fracd\\ln r}{d\\ln T}\\right)_{\\mathrm{exact}}\\right|}{\\left|\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{exact}}\\right| + 10^{-12}}\n$$\n其中，插值对数斜率由插值率 $r_{\\mathrm{interp}}$ 及其导数 $(\\partial r/\\partial T)_{\\mathrm{interp}}$ 计算得出：\n$$\n\\left(\\frac{d\\ln r}{d\\ln T}\\right)_{\\mathrm{interp}} = \\frac{T}{r_{\\mathrm{interp}}} \\left(\\frac{\\partial r}{\\partial T}\\right)_{\\mathrm{interp}}\n$$\n此外，在单一点 $(T_\\star, \\rho_\\star)$ 处计算一个特定的时间尺度误差 $\\varepsilon_\\tau$。时间尺度 $\\tau$ 定义为 $\\tau(T,\\rho) = 1/(\\rho r(T,\\rho))$。误差为：\n$$\n\\varepsilon_\\tau = \\left|\\frac{\\tau_{\\mathrm{interp}} - \\tau_{\\mathrm{exact}}}{\\tau_{\\mathrm{exact}}}\\right| = \\left|\\frac{1/(\\rho_\\star r_{\\mathrm{interp}}) - 1/(\\rho_\\star r_{\\mathrm{exact}})}{1/(\\rho_\\star r_{\\mathrm{exact}})}\\right| = \\left|\\frac{r_{\\mathrm{exact}} - r_{\\mathrm{interp}}}{r_{\\mathrm{interp}}}\\right|\n$$\n值得注意的是，这是相对于插值的反应率的相对误差，与 $\\varepsilon_r$ 的定义略有不同。\n\n解决方案分三个阶段进行：\n\n**第1部分：一维插值**\n通过在给定的温度网格 $T_{\\mathrm{grid}}$ 上评估精确函数 $r_0(T)$，创建一个离散数据点表 $(T_i, r_0(T_i))$。根据这些点构建一个PCHIP插值器。然后，在50个查询温度中的每一个上评估此插值器及其导数。对于每个查询点，我们计算 $r_{\\mathrm{interp}}$、$(\\partial r/\\partial T)_{\\mathrm{interp}}$、$(\\frac{d\\ln r}{d\\ln T})_{\\mathrm{interp}}$，并将它们与精确值进行比较以计算 $\\varepsilon_r$ 和 $\\varepsilon_s$。记录整个查询集上这两个误差度量的最大值。\n\n**第2部分：二维插值**\n在 $T_{\\mathrm{grid}}$ 和 $\\rho_{\\mathrm{grid}}$ 的张量积上创建一个二维数据点表 $(T_i, \\rho_j, r(T_i, \\rho_j))$。为了在查询点 $(T_q, \\rho_q)$ 处找到插值和导数，我们遵循指定的两步过程：\n1.  **T轴插值**：对于网格 $\\rho_{\\mathrm{grid}}$ 中的每个密度 $\\rho_j$，我们沿着网格 $T_{\\mathrm{grid}}$ 为作为温度函数的反应率 $r(T, \\rho_j)$ 构建一个一维PCHIP插值器。我们在查询温度 $T_q$ 处评估此插值器及其导数。这为每个网格密度 $\\rho_j$ 产生了一组中间值 $r_{\\mathrm{interp}}(T_q, \\rho_j)$ 和 $(\\partial r/\\partial T)_{\\mathrm{interp}}(T_q, \\rho_j)$。\n2.  **ρ轴插值**：我们构建两个新的一维PCHIP插值器。第一个沿着 $\\rho_{\\mathrm{grid}}$ 插值中间反应率 $r_{\\mathrm{interp}}(T_q, \\rho_j)$。第二个也沿着 $\\rho_{\\mathrm{grid}}$ 插值中间导数 $(\\partial r/\\partial T)_{\\mathrm{interp}}(T_q, \\rho_j)$。在查询密度 $\\rho_q$ 处评估这两个插值器，得到最终的 $r_{\\mathrm{interp}}(T_q, \\rho_q)$ 和 $(\\partial r/\\partial T)_{\\mathrm{interp}}(T_q, \\rho_q)$。\n对二维集中的每个查询点重复此过程。在每个点上计算误差 $\\varepsilon_r$ 和 $\\varepsilon_s$，并记录它们的最大值。\n\n**第3部分：核时间尺度误差**\n对于特定状态 $(T_\\star, \\rho_\\star) = (1.57\\times 10^7\\,\\mathrm{K}, 150\\,\\mathrm{g\\,cm^{-3}})$ 再次应用二维插值过程，以找到 $r_{\\mathrm{interp}}(T_\\star,\\rho_\\star)$。利用这个值，我们计算 $\\tau_{\\mathrm{interp}}(T_\\star, \\rho_\\star) = 1/(\\rho_\\star r_{\\mathrm{interp}})$。精确值 $\\tau_{\\mathrm{exact}}(T_\\star, \\rho_\\star)$ 也被计算出来。然后根据其定义确定相对误差 $\\varepsilon_\\tau$。\n\n最终输出将包含五个计算出的误差度量，并按要求格式化。", "answer": "[1.71360e-02,3.32766e-01,2.02967e-02,3.46914e-01,2.06206e-03]", "id": "3525292"}, {"introduction": "在实现了物理模型和数据处理之后，我们如何确信我们的时间积分求解器本身是正确无误的？“人造解方法”（Method of Manufactured Solutions, MMS）是验证代码是否达到其理论收敛阶数的黄金标准。本练习将通过为一个简化的反应网络实现MMS，让您掌握这一在科学计算中普遍适用且功能强大的代码验证技术。[@problem_id:3525233]", "problem": "考虑一个包含三个物种的无量纲核反应网络，其状态向量是丰度向量 $\\mathbf{Y}(t) = \\big(Y_{\\mathrm{A}}(t), Y_{\\mathrm{B}}(t), Y_{\\mathrm{C}}(t)\\big)^{\\top}$。该网络包含两个具有恒定有效速率的反应：(i) $\\mathrm{A} \\to \\mathrm{B}$，速率参数为 $\\lambda$；(ii) $\\mathrm{B} \\to \\mathrm{C}$，速率参数为 $\\mu$。根据质量作用定律和化学计量关系，无强迫项的常微分方程（ODE）系统为\n$$\n\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) \\equiv \n\\begin{bmatrix}\n-\\lambda Y_{\\mathrm{A}} \\\\\n\\lambda Y_{\\mathrm{A}} - \\mu Y_{\\mathrm{B}} \\\\\n\\mu Y_{\\mathrm{B}}\n\\end{bmatrix}.\n$$\n您将采用“人造解方法”（Method of Manufactured Solutions, MMS）来验证用于恒星反应网络求解器的两种时间积分格式的精度阶。MMS 过程规定一个光滑的精确解 $\\mathbf{Y}_{\\mathrm{exact}}(t)$，并构造一个随时间变化的强迫项 $\\mathbf{Q}(t)$，使得强迫 ODE\n$$\n\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) + \\mathbf{Q}(t)\n$$\n对于积分区间内的所有 $t$ 都具有精确解 $\\mathbf{Y}(t) \\equiv \\mathbf{Y}_{\\mathrm{exact}}(t)$。\n\n1. 人造解与强迫项。\n   - 令精确解为\n     $$\n     \\begin{aligned}\n     Y_{\\mathrm{A,exact}}(t) = 0.5 + 0.1\\cos(2\\pi t),\\\\\n     Y_{\\mathrm{B,exact}}(t) = 0.3 + 0.05\\sin(2\\pi t),\\\\\n     Y_{\\mathrm{C,exact}}(t) = 1 - Y_{\\mathrm{A,exact}}(t) - Y_{\\mathrm{B,exact}}(t).\n     \\end{aligned}\n     $$\n     这一选择确保了对于所有 $t$，$Y_{\\mathrm{A,exact}}(t) > 0$、$Y_{\\mathrm{B,exact}}(t) > 0$、$Y_{\\mathrm{C,exact}}(t) > 0$ 且 $Y_{\\mathrm{A,exact}}(t) + Y_{\\mathrm{B,exact}}(t) + Y_{\\mathrm{C,exact}}(t) \\equiv 1$。\n   - 从基本定义 $\\mathbf{Q}(t) \\equiv \\frac{d\\mathbf{Y}_{\\mathrm{exact}}}{dt} - \\mathbf{F}(\\mathbf{Y}_{\\mathrm{exact}}(t))$ 出发，显式推导 $\\mathbf{Q}(t)$，并用它来定义用于数值时间积分的右端项 $\\mathbf{G}(t,\\mathbf{Y}) \\equiv \\mathbf{F}(\\mathbf{Y}) + \\mathbf{Q}(t)$。\n\n2. 待验证的时间积分方法。\n   - 实现 $p=1$ 阶的前向（显式）Euler 方法：给定步长 $\\Delta t$，更新 $\\mathbf{Y}_{n+1} = \\mathbf{Y}_{n} + \\Delta t\\, \\mathbf{G}(t_n,\\mathbf{Y}_n)$。\n   - 实现 $p=4$ 阶的经典 Runge–Kutta 方法：以 $\\mathbf{G}(t,\\mathbf{Y})$ 为右端项，使用标准的 $4$ 级格式，各级的时间点为 $t_n$、$t_n+\\frac{\\Delta t}{2}$、$t_n+\\frac{\\Delta t}{2}$ 和 $t_n+\\Delta t$。\n\n3. 网格加密下的误差测量与阶估计。\n   - 从 $t_0 = 0$ 积分到 $t_{\\mathrm{final}} = 1$，初始条件为 $\\mathbf{Y}(0) = \\mathbf{Y}_{\\mathrm{exact}}(0)$。\n   - 对于给定的基础时间步长 $\\Delta t_0$，使用三种加密步长（$\\Delta t_0$、$\\Delta t_0/2$ 和 $\\Delta t_0/4$）计算 $t_{\\mathrm{final}}$ 处的数值解。对于每个 $\\Delta t$，计算误差\n     $$\n     E(\\Delta t) \\equiv \\left\\|\\mathbf{Y}_{\\mathrm{num}}(t_{\\mathrm{final}};\\Delta t) - \\mathbf{Y}_{\\mathrm{exact}}(t_{\\mathrm{final}})\\right\\|_{\\infty}.\n     $$\n   - 通过加密对 $(\\Delta t_0/2,\\ \\Delta t_0/4)$ 估计观测阶\n     $$\n     p_{\\mathrm{obs}} = \\log_2\\left(\\frac{E(\\Delta t_0/2)}{E(\\Delta t_0/4)}\\right).\n     $$\n     对于前向 Euler 方法，预期值为 $p_{\\mathrm{obs}} \\approx 1$；对于 $4$ 阶经典 Runge–Kutta 方法，预期值为 $p_{\\mathrm{obs}} \\approx 4$。\n\n4. 测试套件。\n   - 使用以下四个测试用例，每个用例由 $(\\lambda,\\ \\mu,\\ \\Delta t_0,\\ \\text{method})$ 指定：\n     - 用例 A（中等速率，前向 Euler）：$(2,\\ 1,\\ 0.05,\\ \\text{\"euler\"})$。\n     - 用例 B（中等速率，$4$ 阶 Runge–Kutta）：$(2,\\ 1,\\ 0.1,\\ \\text{\"rk4\"})$。\n     - 用例 C（较快速率，$4$ 阶 Runge–Kutta）：$(10,\\ 5,\\ 0.02,\\ \\text{\"rk4\"})$。\n     - 用例 D（较快速率，前向 Euler）：$(10,\\ 5,\\ 0.01,\\ \\text{\"euler\"})$。\n   - 所有量均为无量纲；无需进行物理单位转换。\n\n5. 程序要求与最终输出格式。\n   - 您的程序必须为每个 $(\\lambda,\\ \\mu)$ 实现从精确解和网络 $\\mathbf{F}(\\mathbf{Y})$ 推导出来的人造强迫项 $\\mathbf{Q}(t)$。\n   - 对于每个测试用例，计算如上定义的 $p_{\\mathrm{obs}}$ 并将其四舍五入到三位小数。\n   - 您的程序应生成单行输出，其中包含按 A、B、C、D 顺序排列的四个四舍五入后的 $p_{\\mathrm{obs}}$ 值，格式为方括号内以逗号分隔的列表，例如：[x,y,z,w]。", "solution": "该问题要求在使用前向 Euler 方法和 $4$ 阶经典 Runge-Kutta 方法这两种数值时间积分格式求解一个简单的核反应网络时，验证它们的精度阶。验证将使用“人造解方法”（MMS）进行。该过程包括：推导一个源项，以强制控制微分方程具有一个选定的精确解；实现数值格式来求解这个强迫系统；然后在网格加密的情况下测量数值误差的收敛率。\n\n系统的状态由物种丰度向量 $\\mathbf{Y}(t) = \\big(Y_{\\mathrm{A}}(t), Y_{\\mathrm{B}}(t), Y_{\\mathrm{C}}(t)\\big)^{\\top}$ 描述。无强迫演化由 ODE 系统 $\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y})$ 控制，其中反应网络 $\\mathrm{A} \\xrightarrow{\\lambda} \\mathrm{B} \\xrightarrow{\\mu} \\mathrm{C}$ 的反应项 $\\mathbf{F}(\\mathbf{Y})$ 由下式给出：\n$$\n\\mathbf{F}(\\mathbf{Y}) = \n\\begin{bmatrix}\n-\\lambda Y_{\\mathrm{A}} \\\\\n\\lambda Y_{\\mathrm{A}} - \\mu Y_{\\mathrm{B}} \\\\\n\\mu Y_{\\mathrm{B}}\n\\end{bmatrix}.\n$$\n\n首先，我们推导 MMS 所需的强迫项 $\\mathbf{Q}(t)$。强迫 ODE 系统是 $\\frac{d\\mathbf{Y}}{dt} = \\mathbf{F}(\\mathbf{Y}) + \\mathbf{Q}(t)$。根据设计，该系统必须具有精确解 $\\mathbf{Y}(t) \\equiv \\mathbf{Y}_{\\mathrm{exact}}(t)$。此条件将强迫项定义为：\n$$\n\\mathbf{Q}(t) \\equiv \\frac{d\\mathbf{Y}_{\\mathrm{exact}}}{dt} - \\mathbf{F}(\\mathbf{Y}_{\\mathrm{exact}}(t)).\n$$\n规定的人造解为：\n$$\n\\begin{aligned}\nY_{\\mathrm{A,exact}}(t) = 0.5 + 0.1\\cos(2\\pi t) \\\\\nY_{\\mathrm{B,exact}}(t) = 0.3 + 0.05\\sin(2\\pi t) \\\\\nY_{\\mathrm{C,exact}}(t) = 1 - Y_{\\mathrm{A,exact}}(t) - Y_{\\mathrm{B,exact}}(t) = 0.2 - 0.1\\cos(2\\pi t) - 0.05\\sin(2\\pi t)\n\\end{aligned}\n$$\n这些分量的时间导数为：\n$$\n\\frac{d\\mathbf{Y}_{\\mathrm{exact}}}{dt} = \n\\begin{bmatrix}\n-0.2\\pi \\sin(2\\pi t) \\\\\n0.1\\pi \\cos(2\\pi t) \\\\\n0.2\\pi \\sin(2\\pi t) - 0.1\\pi \\cos(2\\pi t)\n\\end{bmatrix}.\n$$\n接下来，我们在精确解处计算 $\\mathbf{F}$：\n$$\n\\mathbf{F}(\\mathbf{Y}_{\\mathrm{exact}}(t)) = \n\\begin{bmatrix}\n-\\lambda (0.5 + 0.1\\cos(2\\pi t)) \\\\\n\\lambda (0.5 + 0.1\\cos(2\\pi t)) - \\mu (0.3 + 0.05\\sin(2\\pi t)) \\\\\n\\mu (0.3 + 0.05\\sin(2\\pi t))\n\\end{bmatrix}.\n$$\n从 $\\frac{d\\mathbf{Y}_{\\mathrm{exact}}}{dt}$ 中减去 $\\mathbf{F}(\\mathbf{Y}_{\\mathrm{exact}}(t))$，得到 $\\mathbf{Q}(t) = \\big(Q_{\\mathrm{A}}(t), Q_{\\mathrm{B}}(t), Q_{\\mathrm{C}}(t)\\big)^{\\top}$ 的分量：\n$$\n\\begin{aligned}\nQ_{\\mathrm{A}}(t) = -0.2\\pi \\sin(2\\pi t) + \\lambda(0.5 + 0.1\\cos(2\\pi t)) \\\\\nQ_{\\mathrm{B}}(t) = 0.1\\pi \\cos(2\\pi t) - \\lambda(0.5 + 0.1\\cos(2\\pi t)) + \\mu(0.3 + 0.05\\sin(2\\pi t)) \\\\\nQ_{\\mathrm{C}}(t) = 0.2\\pi \\sin(2\\pi t) - 0.1\\pi \\cos(2\\pi t) - \\mu(0.3 + 0.05\\sin(2\\pi t))\n\\end{aligned}\n$$\n用于数值积分的右端项是 $\\mathbf{G}(t, \\mathbf{Y}) = \\mathbf{F}(\\mathbf{Y}) + \\mathbf{Q}(t)$。\n\n待验证的数值格式是：\n1.  **前向（显式）Euler 方法（$p=1$ 阶）**：\n    $$\n    \\mathbf{Y}_{n+1} = \\mathbf{Y}_{n} + \\Delta t\\, \\mathbf{G}(t_n, \\mathbf{Y}_n)\n    $$\n2.  **经典 Runge-Kutta 方法（$p=4$ 阶）**：\n    $$\n    \\begin{aligned}\n    \\mathbf{k}_1 = \\mathbf{G}(t_n, \\mathbf{Y}_n) \\\\\n    \\mathbf{k}_2 = \\mathbf{G}(t_n + \\frac{\\Delta t}{2}, \\mathbf{Y}_n + \\frac{\\Delta t}{2} \\mathbf{k}_1) \\\\\n    \\mathbf{k}_3 = \\mathbf{G}(t_n + \\frac{\\Delta t}{2}, \\mathbf{Y}_n + \\frac{\\Delta t}{2} \\mathbf{k}_2) \\\\\n    \\mathbf{k}_4 = \\mathbf{G}(t_n + \\Delta t, \\mathbf{Y}_n + \\Delta t \\mathbf{k}_3) \\\\\n    \\mathbf{Y}_{n+1} = \\mathbf{Y}_n + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n    \\end{aligned}\n    $$\n每个测试用例的数值实验通过将系统从 $t_0=0$ 积分到 $t_{\\mathrm{final}}=1$ 来进行，初始条件为 $\\mathbf{Y}(0) = \\mathbf{Y}_{\\mathrm{exact}}(0)$。此过程针对三个不同的时间步长完成：$\\Delta t_0$、$\\Delta t_1 = \\Delta t_0/2$ 和 $\\Delta t_2 = \\Delta t_0/4$。对于每个步长 $\\Delta t$，使用无穷范数计算最终时刻的误差：\n$$\nE(\\Delta t) = \\left\\|\\mathbf{Y}_{\\mathrm{num}}(t_{\\mathrm{final}}; \\Delta t) - \\mathbf{Y}_{\\mathrm{exact}}(t_{\\mathrm{final}})\\right\\|_{\\infty}.\n$$\n观测精度阶 $p_{\\mathrm{obs}}$ 是根据对应于两个最精细网格的误差 $E(\\Delta t_1)$ 和 $E(\\Delta t_2)$ 来估计的。假设误差行为如 $E(\\Delta t) \\approx C(\\Delta t)^p$，我们有：\n$$\np_{\\mathrm{obs}} = \\frac{\\log(E(\\Delta t_1)/E(\\Delta t_2))}{\\log(\\Delta t_1/\\Delta t_2)} = \\frac{\\log(E(\\Delta t_0/2)/E(\\Delta t_0/4))}{\\log(2)} = \\log_2\\left(\\frac{E(\\Delta t_0/2)}{E(\\Delta t_0/4)}\\right).\n$$\n对于前向 Euler 方法，预期结果是 $p_{\\mathrm{obs}} \\approx 1$；对于 RK4 方法，预期结果是 $p_{\\mathrm{obs}} \\approx 4$。算法实现将为 $\\mathbf{Y}_{\\mathrm{exact}}(t)$、$\\mathbf{G}(t,\\mathbf{Y})$ 和步进程序定义函数。主循环会遍历所有测试用例，对三种步长进行积分，计算误差，并为每个用例计算 $p_{\\mathrm{obs}}$。最终结果是这些观测阶的列表，四舍五入到三位小数。", "answer": "[1.014,3.996,3.996,1.012]", "id": "3525233"}]}