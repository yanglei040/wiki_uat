{"hands_on_practices": [{"introduction": "任何行星-星盘相互作用的模拟都始于一个稳定、无扰动的星盘。在引入行星的引力扰动之前，我们必须确保我们的背景星盘本身处于一个物理上合理的准平衡状态。本练习将指导你从第一性原理出发，构建这样一个一维径向星盘模型，并根据瑞利稳定性（Rayleigh stability）和托姆衡稳定性（Toomre stability）等关键物理准则来验证其有效性，这是任何数值研究都不可或缺的第一步 [@problem_id:3520488]。", "problem": "要求您设计、实现并验证一个围绕中心恒星的气体盘的一维径向初始化模型，其中没有嵌入的行星。目标是证明所选的边界条件和初始剖面在牛顿引力和理想气体状态方程下能产生一个准平衡构型。推导和验证必须从第一性原理出发。其计算天体物理背景是一个不含行星的原行星盘，其中主导力是压强梯度和中心引力，且垂直结构是流体静力的。您必须编写一个完整的、可运行的程序，该程序在指定的径向域上构建磁盘状态，并为几组参数集返回布尔值的验证结果。\n\n基本物理基础：\n- 稳态、轴对称的径向动量平衡（源于圆柱坐标系中径向速度为零的欧拉方程）关联了离心项、中心引力和径向压强梯度。中心引力场是牛顿的，并且是球对称的。\n- 气体遵循理想气体定律。\n- 垂直方向的流体静力平衡定义了标高与声速之间的关系。\n- 旋转的稳定性必须满足Rayleigh判据，而引力-旋转平衡由Toomre稳定性参数来表征。\n\n初始剖面：\n- 表面密度由一个给定的幂律给出：$\\Sigma(r) = \\Sigma_0 \\left(\\frac{r}{r_0}\\right)^{-p}$。\n- 温度由一个给定的幂律给出：$T(r) = T_0 \\left(\\frac{r}{r_0}\\right)^{-q}$。\n\n单位与常数：\n- 使用国际单位制（SI）：长度单位为米，质量单位为千克，时间单位为秒，温度单位为开尔文。\n- 使用$G$表示引力常数，$k_B$表示玻尔兹曼常数，$m_p$表示质子质量。平均分子量是一个无量纲参数$\\mu$，其定义使得气体粒子质量为$\\mu m_p$。\n\n径向域与边界条件：\n- 计算域是一维的，半径范围为$r \\in [r_{\\mathrm{in}}, r_{\\mathrm{out}}]$，由$N$个网格点离散化。在适当的情况下，网格应能解析几个数量级。\n- 径向速度的边界条件是在所有地方（包括边界）都为$v_r(r)=0$。\n- 径向压强梯度应在边界处使用一致的单边导数，在内部使用中心差分进行计算。\n\n从第一性原理推导：\n- 从稳态径向力平衡出发，推导出决定旋转剖面$v_\\phi(r)$的条件，用中心引力和径向压强梯度表示。\n- 使用理想气体定律，用$T(r)$和$\\mu$定义等温声速$c_s(r)$。\n- 在中心引力下，利用垂直流体静力平衡，用$c_s(r)$和开普勒角频率定义标高$H(r)$。\n- 获得与给定的$\\Sigma(r)$和$T(r)$一致的中平面密度$\\rho(r)$和中平面压强$P(r)$。\n\n准平衡的验证标准：\n- 旋转的正性：在整个域上$v_\\phi^2(r)  0$。\n- 径向力平衡残差：定义一个无量纲残差$R(r)$，其值为径向力平衡中的差异量级，并用引力项和压强支撑项的量级之和进行归一化。要求$\\max_r R(r) \\le \\epsilon$，其中$\\epsilon$是一个指定的容差。\n- Rayleigh稳定性：比角动量$j(r) = r v_\\phi(r)$必须在所有地方都满足$\\frac{dj}{dr} \\ge 0$。\n- Toomre稳定性：Toomre参数$Q(r)$必须在所有地方都满足$Q(r) \\ge 1$。\n\n实现细节：\n- 根据理想气体定律计算$c_s(r)$。使用牛顿引力计算开普勒角频率。根据垂直流体静力平衡计算$H(r)$。通过假设中平面处为高斯垂直结构，从$\\Sigma(r)$和$H(r)$计算$\\rho(r)$。计算中平面的$P(r)$。使用适用于非均匀网格的有限差分格式计算径向压强梯度$\\frac{dP}{dr}$。计算与径向力平衡一致的$v_\\phi(r)$。然后评估三个稳定性检查。\n- 残差容差取为$\\epsilon = 5 \\times 10^{-4}$。\n\n测试套件：\n对于每个测试用例，以SI单位提供参数$(M_\\star,\\Sigma_0,p,T_0,q,\\mu,r_0,r_{\\mathrm{in}},r_{\\mathrm{out}},N)$，其中$r_0$是一个参考半径，应为1天文单位（AU），以米表示。\n\n- 测试用例1（理想情况）：\n    - $M_\\star = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 5.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 1.0$, $T_0 = 280\\ \\mathrm{K}$, $q = 0.5$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.1\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 50\\ \\mathrm{AU}$, $N = 512$。\n- 测试用例2（更陡的表面密度和更冷的外盘）：\n    - $M_\\star = 0.5 \\times 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 3.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 1.5$, $T_0 = 120\\ \\mathrm{K}$, $q = 0.7$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 1\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 100\\ \\mathrm{AU}$, $N = 512$。\n- 测试用例3（预期因弱引力和热气体而失败的边缘情况）：\n    - $M_\\star = 0.2 \\times 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 5.0 \\times 10^{2}\\ \\mathrm{kg/m^2}$, $p = 0.5$, $T_0 = 400\\ \\mathrm{K}$, $q = 0.0$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.5\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 300\\ \\mathrm{AU}$, $N = 512$。\n- 测试用例4（热内盘，小区域）：\n    - $M_\\star = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 8.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 0.5$, $T_0 = 1000\\ \\mathrm{K}$, $q = 1.0$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.05\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 5\\ \\mathrm{AU}$, $N = 512$。\n\n天文单位换算：\n- $1\\ \\mathrm{AU} = 1.495978707 \\times 10^{11}\\ \\mathrm{m}$。\n\n程序输出规范：\n- 对于每个测试用例，您的程序必须输出一个布尔值，指示准平衡验证是通过（true）还是失败（false）。\n- 您的程序应输出单行结果，格式为方括号内包含的逗号分隔列表（例如，“[true,false,true,false]”）。使用Python的布尔字面量“True”或“False”转换为字符串后的形式，不含空格。\n\n不应读取任何外部输入；所有常数和测试参数必须在程序中定义。不使用角度。所有物理量均以SI单位表示。不使用百分比；任何分数量应为无量纲或使用适当的SI单位。", "solution": "该问题要求设计并验证一个处于准平衡状态的原行星气体盘的一维径向模型。该解是基于流体动力学和牛顿引力的第一性原理，并假设气体为理想气体而构建的。该过程包括从给定的表面密度和温度的幂律剖面推导盘的物理状态——包括密度、压强和旋转速度——然后根据四个物理和数值有效性标准来测试此状态。\n\n### 基本原理和控制方程\n\n该模型基于以下物理原理，在圆柱坐标系$(r, \\phi, z)$下表述，并假设轴对称（$\\partial/\\partial\\phi = 0$）、稳态（$\\partial/\\partial t = 0$）且无径向流动（$v_r=0$）。\n\n1.  **径向力平衡**：欧拉动量方程的径向分量描述了来自中心恒星的引力、径向压强梯度和旋转引起的离心力之间的平衡。对于密度为$\\rho$的气体微元，其平衡条件为：\n    $$\n    \\frac{v_\\phi^2(r)}{r} = \\frac{GM_\\star}{r^2} + \\frac{1}{\\rho(r)}\\frac{dP(r)}{dr}\n    $$\n    其中$v_\\phi(r)$是方位角速度，$M_\\star$是中心恒星的质量，$P(r)$是中平面气体压强，$G$是引力常数。\n\n2.  **理想气体定律**：气体压强$P$、密度$\\rho$和温度$T$通过理想气体定律相关联：\n    $$\n    P = \\frac{\\rho k_B T}{\\mu m_p}\n    $$\n    其中$k_B$是玻尔兹曼常数，平均粒子质量为$\\mu m_p$（$\\mu$是平均分子量，$m_p$是质子质量）。这使我们能够定义等温声速$c_s$，其平方为$c_s^2 = P/\\rho = k_B T / (\\mu m_p)$。\n\n3.  **垂直流体静力平衡**：在薄盘中，垂直结构由垂直压强梯度和恒星引力的垂直分量之间的平衡决定，即$g_z \\approx (GM_\\star/r^2)(z/r) = \\Omega_K^2 z$，其中$\\Omega_K(r) = \\sqrt{GM_\\star/r^3}$是开普勒角频率。这导致了高斯形式的垂直密度剖面$\\rho(r, z) = \\rho(r) \\exp(-z^2 / (2H(r)^2))$，其中$\\rho(r)$是中平面密度，$H(r)$是由下式给出的垂直压强标高：\n    $$\n    H(r) = \\frac{c_s(r)}{\\Omega_K(r)}\n    $$\n    在此，盘的角频率近似为开普勒值，这是初始模型的一个标准简化。表面密度$\\Sigma(r)$是$\\rho(r, z)$的垂直积分，可得$\\Sigma(r) = \\sqrt{2\\pi} \\rho(r) H(r)$。\n\n### 盘状态的算法实现\n\n盘状态在一个包含$N$个点的对数间隔的径向网格$r \\in [r_{\\mathrm{in}}, r_{\\mathrm{out}}]$上进行顺序构建，这适用于跨越数个数量级的计算域。\n\n1.  **初始剖面**：首先在网格上评估给定的表面密度和温度的幂律剖面：\n    $$\n    \\Sigma(r) = \\Sigma_0 \\left(\\frac{r}{r_0}\\right)^{-p} \\quad \\text{和} \\quad T(r) = T_0 \\left(\\frac{r}{r_0}\\right)^{-q}\n    $$\n\n2.  **派生物理量**：使用这些剖面，在每个网格点$r_i$处计算以下物理量：\n    -   等温声速：$c_s(r) = \\sqrt{k_B T(r) / (\\mu m_p)}$。\n    -   开普勒角频率：$\\Omega_K(r) = \\sqrt{G M_\\star / r^3}$。\n    -   标高：$H(r) = c_s(r) / \\Omega_K(r)$。\n    -   中平面密度：$\\rho(r) = \\Sigma(r) / (\\sqrt{2\\pi} H(r))$。\n    -   中平面压强：$P(r) = \\rho(r) c_s(r)^2$。\n\n3.  **旋转剖面**：径向压强梯度$dP/dr$使用二阶中心差分计算内部点，并在边界处使用单边差分进行数值计算，正如在`numpy.gradient`中的实现。然后通过重新排列径向力平衡方程来确定方位角速度$v_\\phi(r)$：\n    $$\n    v_\\phi^2(r) = \\frac{GM_\\star}{r} + \\frac{r}{\\rho(r)}\\frac{dP(r)}{dr}\n    $$\n    该公式确保了旋转速度与引力和压强支撑之间的平衡相一致。\n\n### 验证标准\n\n生成的盘状态将根据四个标准进行验证，以确保其代表一个物理上合理的准平衡构型。\n\n1.  **旋转的正性**：压强支撑项通常为负（$dP/dr  0$），其大小不能超过引力项。这要求在整个域上$v_\\phi^2(r)  0$。若此条件不满足，则表示一个不真实的物理状态，其中压强力会压倒引力。\n\n2.  **径向力平衡残差**：定义一个无量纲残差$R(r)$以验证数值的自洽性。它衡量了径向力（单位质量）平衡中的相对误差：\n    $$\n    R(r) = \\frac{\\left| \\frac{v_\\phi^2}{r} - \\left( \\frac{GM_\\star}{r^2} + \\frac{1}{\\rho}\\frac{dP}{dr} \\right) \\right|}{\\frac{GM_\\star}{r^2} + \\left| \\frac{1}{\\rho}\\frac{dP}{dr} \\right|}\n    $$\n    由于$v_\\phi^2$的计算本身就是为了满足这一平衡，所以$R(r)$应该在浮点精度范围内为零。检查$\\max_r R(r) \\le \\epsilon = 5 \\times 10^{-4}$可作为对数值实现的合理性检验。\n\n3.  **Rayleigh稳定性**：对于旋转流体，流体动力学稳定性要求比角动量$j(r) = r v_\\phi(r)$必须是半径的非减函数。这是Rayleigh判据：\n    $$\n    \\frac{dj(r)}{dr} \\ge 0\n    $$\n    导数$dj/dr$通过数值计算得出，并在所有网格点上检查该条件。\n\n4.  **Toomre稳定性**：为了使盘对其自身引力保持稳定，Toomre $Q$参数必须大于或等于1。$Q$参数由下式给出：\n    $$\n    Q(r) = \\frac{c_s(r) \\kappa(r)}{\\pi G \\Sigma(r)} \\ge 1\n    $$\n    其中$\\kappa(r)$是周转频率，其定义为$\\kappa^2(r) = \\frac{1}{r^3} \\frac{d(j^2)}{dr}$。导数$d(j^2)/dr$通过数值计算得出。Rayleigh稳定性判据确保了$\\kappa^2 \\ge 0$，因此$\\kappa$是实数。\n\n只有当所有四个标准在整个计算域上都得到满足时，一个测试用例才被认为通过验证。最终的程序会遍历每一组参数，执行这些计算，并返回一个布尔结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the disk validation for all test cases.\n    \"\"\"\n    # Physical and Astronomical Constants in SI units\n    G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    K_B = 1.380649e-23  # Boltzmann constant (J K^-1)\n    M_P = 1.67262192e-27  # Proton mass (kg)\n    AU = 1.495978707e11  # Astronomical Unit (m)\n    SOLAR_MASS = 1.98847e30 # Solar mass (kg)\n\n    def check_disk_equilibrium(params):\n        \"\"\"\n        Constructs and validates a 1D protoplanetary disk model.\n\n        Args:\n            params (tuple): A tuple containing the disk parameters in SI units:\n            (M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N)\n\n        Returns:\n            bool: True if the disk model passes all validation criteria, False otherwise.\n        \"\"\"\n        M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N = params\n        epsilon = 5.0e-4\n\n        # 1. Set up a logarithmically spaced radial grid\n        r = np.geomspace(r_in, r_out, N)\n\n        # 2. Define initial power-law profiles for surface density and temperature\n        Sigma = Sigma0 * (r / r0)**(-p)\n        T = T0 * (r / r0)**(-q)\n\n        # 3. Derive other physical quantities from first principles\n        cs_sq = K_B * T / (mu * M_P)\n        cs = np.sqrt(cs_sq)\n\n        Omega_K_sq = G * M_star / r**3\n        Omega_K = np.sqrt(Omega_K_sq)\n        \n        # Scale height assuming rotation is approximately Keplerian\n        H = cs / Omega_K\n\n        # Midplane density from surface density and scale height\n        rho = Sigma / (np.sqrt(2 * np.pi) * H)\n\n        # Midplane pressure from ideal gas law\n        P = rho * cs_sq\n\n        # 4. Determine the azimuthal velocity from radial force balance\n        # Compute the pressure gradient numerically\n        dPdr = np.gradient(P, r)\n        \n        # Calculate the square of the azimuthal velocity\n        v_phi_sq = G * M_star / r + r * dPdr / rho\n\n        # --- VALIDATION CHECKS ---\n\n        # Criterion 1: Positivity of rotation (v_phi^2 must be positive)\n        if not np.all(v_phi_sq > 0):\n            return False\n        \n        v_phi = np.sqrt(v_phi_sq)\n\n        # Criterion 2: Radial force balance residual\n        a_centrifugal = v_phi_sq / r\n        a_gravity = G * M_star / r**2\n        a_pressure = dPdr / rho\n        \n        numerator = np.abs(a_centrifugal - a_gravity - a_pressure)\n        denominator = a_gravity + np.abs(a_pressure)\n        # Avoid division by zero in the unlikely event denominator is zero\n        denominator[denominator == 0] = 1.0 \n        \n        R = numerator / denominator\n        if not np.max(R) = epsilon:\n            return False\n\n        # Criterion 3: Rayleigh stability (specific angular momentum non-decreasing)\n        j = r * v_phi\n        djdr = np.gradient(j, r)\n        if not np.all(djdr >= 0):\n            return False\n\n        # Criterion 4: Toomre stability (stable against self-gravity)\n        j_sq = j**2\n        dj_sq_dr = np.gradient(j_sq, r)\n        \n        # Rayleigh stability implies kappa^2 is non-negative.\n        # Add a check for robustness against small numerical errors.\n        if np.any(dj_sq_dr  0):\n             return False # Should be caught by Rayleigh check, but good practice\n        \n        kappa_sq = dj_sq_dr / r**3\n        kappa = np.sqrt(kappa_sq)\n\n        Q = cs * kappa / (np.pi * G * Sigma)\n        if not np.all(Q >= 1):\n            return False\n\n        # If all checks pass, the configuration is valid\n        return True\n\n    # Test suite parameters provided in the problem statement\n    test_cases = [\n        # (M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N)\n        # Case 1: Happy path\n        (1.0 * SOLAR_MASS, 5.0e3, 1.0, 280.0, 0.5, 2.34, 1.0 * AU, 0.1 * AU, 50.0 * AU, 512),\n        # Case 2: Steeper density, cooler disk\n        (0.5 * SOLAR_MASS, 3.0e3, 1.5, 120.0, 0.7, 2.34, 1.0 * AU, 1.0 * AU, 100.0 * AU, 512),\n        # Case 3: Expected fail (weak gravity, hot gas)\n        (0.2 * SOLAR_MASS, 5.0e2, 0.5, 400.0, 0.0, 2.34, 1.0 * AU, 0.5 * AU, 300.0 * AU, 512),\n        # Case 4: Hot inner disk, small domain\n        (1.0 * SOLAR_MASS, 8.0e3, 0.5, 1000.0, 1.0, 2.34, 1.0 * AU, 0.05 * AU, 5.0 * AU, 512),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_valid = check_disk_equilibrium(case)\n        results.append(str(is_valid))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3520488"}, {"introduction": "行星在星盘中激发的螺旋密度波是林德布拉德共振（Lindblad resonance）扭矩的主要载体，这种扭矩是驱动行星迁移的关键机制。本练习深入探讨了这一过程，要求你推导并求解由这些波携带的角动量通量 $F_J$ 的演化方程 [@problem_id:3520550]。通过考虑黏性耗散效应，你将亲手验证波的角动量是如何沉积到星盘中，从而施加扭矩，为理解行星迁移的物理本质提供一个半解析的窗口。", "problem": "您正在为一个几何薄、二维、等温、非自引力的Keplerian盘中，由小振幅、行星驱动的螺旋波所引起的角动量输运建立模型。一颗质量为 $m_{\\mathrm{p}}$ 的行星，在半径为 $r_{\\mathrm{p}}$ 的圆形轨道上运行，激发了内外螺旋波，这些波将其各自Lindblad共振点处的角动量带走。假设在一个引力常数乘以恒星质量等于1的单位制中，Keplerian角频率为 $\\Omega(r) = r^{-3/2}$，等温声速为 $c_{\\mathrm{s}}(r) = h\\,r\\,\\Omega(r)$（其中标高 $h$ 为常数），Shakura-Sunyaev运动粘性为 $\\nu(r) = \\alpha\\,c_{\\mathrm{s}}(r)^2 / \\Omega(r)$（其中 $\\alpha$ 为常数）。考虑方位波数为 $m$、模式频率为 $\\omega = m\\,\\Omega(r_{\\mathrm{p}})$ 的紧缠旋臂波，使得惯性声波的线性化局域色散关系成立，即\n$$(\\omega - m\\,\\Omega(r))^2 = \\kappa(r)^2 + c_{\\mathrm{s}}(r)^2\\,k(r)^2,$$\n其中，对于Keplerian盘，$\\kappa(r) = \\Omega(r)$，$k(r)$ 是沿WKB (Wentzel-Kramers-Brillouin) 波路径的径向波数。内外Lindblad共振半径 $r_{\\mathrm{IL}}$ 和 $r_{\\mathrm{OL}}$ 由 $|\\omega - m\\,\\Omega(r_{\\mathrm{L}})| = \\kappa(r_{\\mathrm{L}})$ 隐式定义；使用Keplerian恒等式证明 $r_{\\mathrm{IL}} = \\Omega_{\\mathrm{IL}}^{-2/3}$（其中 $\\Omega_{\\mathrm{IL}} = \\Omega(r_{\\mathrm{p}})/(1 - 1/m)$）和 $r_{\\mathrm{OL}} = \\Omega_{\\mathrm{OL}}^{-2/3}$（其中 $\\Omega_{\\mathrm{OL}} = \\Omega(r_{\\mathrm{p}})/(1 + 1/m)$）。\n\n从线性化流体方程和剪切流中正则波作用量的定义出发，从第一性原理推导出一个演化方程，该方程描述了在存在粘性耗散的情况下，单个WKB波分支所携带的径向角动量通量 $F_J(r)$。您必须从波作用量守恒以及粘性应力对微扰所做的功开始。证明在没有耗散的情况下，正则角动量通量 $F_J$ 沿射线是守恒的，并以局域运动粘性、径向波数和径向群速度 $c_g(r)$（定义为在模式频率固定时，色散关系对波数的适当导数）为基础，求出粘性空间阻尼率的主导项。您的推导必须产生一个物理上可解释的表达式，该表达式将 $dF_J/dr$ 与波的局域粘性耗散联系起来，并且必须对内分支和外分支均有效。\n\n然后，实现一个程序，对于指定的参数和边界，执行以下步骤：\n- 为给定的 $m$ 和 $r_{\\mathrm{p}}$ 计算 $r_{\\mathrm{IL}}$ 和 $r_{\\mathrm{OL}}$。\n- 对每个分支（内分支和外分支），在传播区域内选择一个与相应共振点有轻微偏移的起始半径 $r_0$，具体而言，内分支为 $r_0 = r_{\\mathrm{IL}} - \\epsilon$，外分支为 $r_0 = r_{\\mathrm{OL}} + \\epsilon$。其中偏移量 $\\epsilon$ 很小，以确保WKB近似有效且 $k(r_0)^2  0$。\n- 将行星-波耦合视为为每个分支建立了初始角动量通量 $F_J(r_0)$，其值分别等于指定的发射值 $T_{\\mathrm{launch,\\,in}}$ 和 $T_{\\mathrm{launch,\\,out}}$（无量纲转矩单位）。\n- 使用您推导出的粘性阻尼表达式，沿射线将 $F_J(r)$ 从 $r_0$ 积分到相应的区域边界（内分支为 $r_{\\mathrm{in}}$，外分支为 $r_{\\mathrm{out}}$），并计算以下两者：\n  1. 边界 $r_{\\mathrm{in}}$ 和 $r_{\\mathrm{out}}$ 处的通量 $F_J$，以及\n  2. 通过沿路径积分 $F_J$ 的局域耗散，计算在 $r_0$ 和边界之间盘中累积的角动量沉积。\n- 通过检查共振点和边界之间沉积在盘中的角动量是否等于发射通量与边界通量之差，来验证每个分支的全局转矩平衡，即恒等式\n$$\\Delta J_{\\mathrm{dep}} = T_{\\mathrm{launch}} - F_J(\\text{boundary}),$$\n在指定的数值容差范围内对内外分支都成立。\n\n所有计算均在与上述定义一致的无量纲代码单位中执行，因此不需要进行物理单位转换。角度（如果有）通过方位波数 $m$ 隐式处理；不需要角度单位。您的程序必须以适当的分辨率实现数值积分以捕捉波的阻尼，并且必须拒绝不满足传播条件 $k(r)^2  0$ 的点。\n\n测试套件：\n为以下参数集提供结果，每个参数集指定为一个元组 $(r_{\\mathrm{p}}, m, h, \\alpha, T_{\\mathrm{launch,\\,in}}, T_{\\mathrm{launch,\\,out}}, r_{\\mathrm{in}}, r_{\\mathrm{out}}, \\epsilon, \\text{tol})$，其中所有量均为无量纲：\n\n1. $(1.0, 20, 0.05, 0.001, 1.0\\times 10^{-5}, 1.2\\times 10^{-5}, 0.40, 2.50, 1.0\\times 10^{-3}, 1.0\\times 10^{-9})$。\n2. $(1.0, 20, 0.05, 0.0, 1.0\\times 10^{-5}, 1.0\\times 10^{-5}, 0.50, 2.00, 1.0\\times 10^{-3}, 1.0\\times 10^{-10})$。\n3. $(1.0, 20, 0.05, 0.005, 1.0\\times 10^{-5}, 1.0\\times 10^{-5}, 0.50, 2.50, 1.0\\times 10^{-3}, 1.0\\times 10^{-9})$。\n4. $(1.0, 30, 0.05, 0.001, 8.0\\times 10^{-6}, 9.0\\times 10^{-6}, 0.70, 1.30, 5.0\\times 10^{-4}, 1.0\\times 10^{-9})$。\n5. $(1.0, 50, 0.05, 0.001, 6.0\\times 10^{-6}, 6.5\\times 10^{-6}, 0.60, 1.80, 5.0\\times 10^{-4}, 1.0\\times 10^{-9})$。\n\n对于每个测试用例，输出一个布尔值，当且仅当全局转矩平衡恒等式在指定容差范围内同时对内分支和外分支都成立时，该值为真。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中 $r_i$ 是上述定义的测试用例 $i$ 的布尔结果。", "solution": "该问题是行星-盘相互作用理论中的一个提法恰当且有科学依据的练习，这是计算天体物理学中的一个基本课题。所有给定的定义、方程和物理假设都是标准的，并且与该主题的已有文献一致。因此，该问题被认为是**有效的**，下面给出完整的解法。\n\n我们的目标是推导由粘性盘中螺旋密度波携带的径向角动量通量 $F_J(r)$ 的演化方程，然后使用该方程来数值验证角动量守恒。\n\n推导过程始于波作用量守恒原理。对于在不随时间变化、轴对称的介质中的波，在没有耗散的情况下，波作用量是守恒的。在存在耗散的情况下，其守恒定律为计算波的阻尼提供了一种直接方法。波的角动量通量与其作用量通量成正比。\n\n设 $\\omega$ 为波在惯性参考系中的模式频率，$m$ 为其方位波数。在以角频率 $\\Omega(r)$ 旋转的盘中，波在局域共转流体参考系中的频率是多普勒频移后的频率，$\\omega'(r) = \\omega - m\\,\\Omega(r)$。波作用量密度 $\\mathcal{A}$ 定义为局域流体参考系中的波能量密度 $E'$ 除以此局域频率：$\\mathcal{A} = E'/\\omega'$。\n\n在有耗散的稳态下，波作用量守恒由下式给出：\n$$\n\\nabla \\cdot \\vec{\\mathcal{F}}_{\\mathcal{A}} = -\\mathcal{D}_{\\mathcal{A}}\n$$\n其中 $\\vec{\\mathcal{F}}_{\\mathcal{A}} = \\vec{c}_g \\mathcal{A}$ 是波作用量通量，$\\vec{c}_g$ 是群速度，$\\mathcal{D}_{\\mathcal{A}}$ 是每单位体积（或在二维盘中为每单位面积）的作用量耗散率。对于轴对称的二维盘，这简化为：\n$$\n\\frac{1}{r} \\frac{d}{dr}(r \\, c_g(r) \\, \\mathcal{A}(r)) = -\\mathcal{D}_{\\mathcal{A}}(r)\n$$\n其中 $c_g$ 是群速度的径向分量。\n\n通过半径为 $r$ 的圆柱面的总角动量通量 $F_J(r)$ 与总能量通量 $F_E(r)$ 的关系为 $F_J = (m/\\omega) F_E$。能量通量是惯性参考系中的波能量密度 $E$、群速度和面积 $2\\pi r$ 的乘积。能量密度 $E$ 与作用量密度 $\\mathcal{A}$ 的关系为 $E = \\omega \\mathcal{A}$。结合这些关系，我们发现总角动量通量与作用量密度之间的关系：\n$$\nF_J(r) = \\frac{m}{\\omega} F_E(r) = \\frac{m}{\\omega} (E \\, c_g \\, 2\\pi r) = \\frac{m}{\\omega} ((\\omega \\mathcal{A}) \\, c_g \\, 2\\pi r) = 2\\pi r m c_g(r) \\mathcal{A}(r)\n$$\n对 $F_J(r)$ 关于 $r$ 求导可得：\n$$\n\\frac{dF_J}{dr} = 2\\pi m \\frac{d}{dr}(r c_g \\mathcal{A})\n$$\n代入作用量守恒方程，我们得到：\n$$\n\\frac{dF_J}{dr} = 2\\pi m (-r \\mathcal{D}_{\\mathcal{A}})\n$$\n这个方程提供了关键的联系：角动量通量的径向变化等于波的局域耗散施加在盘上的转矩。负的 $dF_J/dr$ 对应于对盘的正转矩。\n\n作用量的耗散 $\\mathcal{D}_{\\mathcal{A}}$ 源于粘性。对于小振幅波，波作用量的粘性耗散率为 $\\mathcal{D}_{\\mathcal{A}} = 2\\gamma \\mathcal{A}$，其中 $\\gamma$ 是波振幅的阻尼率。对于粘性流体，在紧缠旋臂极限下，该阻尼率由 $\\gamma = \\nu k^2$ 给出，其中 $\\nu$ 是运动粘性，$k$ 是径向波数。\n因此，$\\mathcal{D}_{\\mathcal{A}}(r) = 2\\nu(r) k(r)^2 \\mathcal{A}(r)$。\n\n将此代入 $dF_J/dr$ 的方程中：\n$$\n\\frac{dF_J}{dr} = -4\\pi r m \\nu(r) k(r)^2 \\mathcal{A}(r)\n$$\n为了得到一个只含 $F_J$ 的方程，我们用其与 $F_J$ 的关系来表示 $\\mathcal{A}$：$\\mathcal{A}(r) = F_J(r) / (2\\pi r m c_g(r))$。\n$$\n\\frac{dF_J}{dr} = -4\\pi r m \\nu k^2 \\left( \\frac{F_J}{2\\pi r m c_g} \\right) = - \\frac{2\\nu(r) k(r)^2}{c_g(r)} F_J(r)\n$$\n这是一阶常微分方程，它描述了由于粘性阻尼引起的波的角动量通量的径向演化。在没有耗散（$\\nu=0$）的情况下，$dF_J/dr = 0$，角动量通量是守恒的，正如预期。\n\n为了解这个方程，我们需要从所提供的物理模型中推导出系数的显式表达式。\n1.  **盘的性质**：Keplerian角频率为 $\\Omega(r) = r^{-3/2}$（在 $GM_*=1$ 的单位制下）。声速为 $c_s(r) = h r \\Omega(r) = h r^{-1/2}$。运动粘性为 $\\nu(r) = \\alpha c_s(r)^2 / \\Omega(r) = \\alpha (h^2 r^{-1}) / (r^{-3/2}) = \\alpha h^2 r^{1/2}$。\n\n2.  **波数 $k(r)$**：从给定的色散关系 $(\\omega - m\\Omega)^2 = \\kappa^2 + c_s^2 k^2$，其中对于Keplerian盘 $\\kappa=\\Omega$，我们解出 $k^2$：\n    $$\n    k(r)^2 = \\frac{(\\omega - m\\Omega(r))^2 - \\Omega(r)^2}{c_s(r)^2}\n    $$\n    波在 $k^2 > 0$ 的地方传播，即Lindblad共振点之外。行星的模式频率是 $\\omega = m\\,\\Omega(r_{\\mathrm{p}})$。\n\n3.  **群速度 $c_g(r)$**：径向群速度通过对色散关系求导得到：$c_g = \\partial\\omega/\\partial k$。使用隐式微分，$c_g = -(\\partial D / \\partial k) / (\\partial D / \\partial \\omega)$，其中 $D(\\omega, k, r) = (\\omega - m\\Omega)^2 - \\Omega^2 - c_s^2 k^2 = 0$。\n    $$\n    \\frac{\\partial D}{\\partial\\omega} = 2(\\omega - m\\Omega) \\quad \\text{and} \\quad \\frac{\\partial D}{\\partial k} = -2c_s^2 k\n    $$\n    这得到 $c_g(r) = \\frac{c_s(r)^2 k(r)}{\\omega - m\\Omega(r)}$。$c_g$ 的符号正确地指出了外波向外传播（$\\omega > m\\Omega$）和内波向内传播（$\\omega  m\\Omega$）。\n\n结合这些，常微分方程中的阻尼项可以表示为：\n$$\n\\frac{dF_J}{dr} = - \\left( \\frac{2\\nu k^2}{c_s^2 k / (\\omega - m\\Omega)} \\right) F_J = - \\frac{2\\nu(r) |k(r)| (\\omega - m\\Omega(r))}{c_s(r)^2} \\text{sgn}(k) F_J(r)\n$$\n其中 $|k| = \\sqrt{k^2}$。注意到 $\\omega - m\\Omega$ 对每个分支都有正确的符号，因此可以吸收 $\\text{sgn}(k)$ 项。项 $k/c_g = k^2 (\\omega-m\\Omega)/c_s^2 k^2 = (\\omega-m\\Omega)/c_s^2$。于是常微分方程为：\n$$\n\\frac{dF_J}{dr} = - \\frac{2\\nu k^2 (\\omega-m\\Omega)}{c_s^2} F_J\n$$\n这种形式避免了围绕 $k(r)$ 符号的模糊性。\n\n为了执行所需的验证，我们数值积分这个常微分方程。在发射半径 $r_0$ 和边界 $r_b$ 之间沉积到盘中的总角动量为 $\\Delta J_{\\mathrm{dep}} = \\int_{r_0}^{r_b} (-\\frac{dF_J}{dr'}) dr'$。根据微积分基本定理，这等于 $F_J(r_0) - F_J(r_b)$。问题要求数值验证这个恒等式。我们可以建立一个包含两个常微分方程的系统：一个用于 $F_J(r)$，另一个用于累积沉积动量 $\\Delta J_{\\mathrm{dep}}(r) = \\int_{r_0}^r (-dF_J/dr')dr'$。\n令 $y_0(r) = F_J(r)$ 和 $y_1(r) = \\Delta J_{\\mathrm{dep}}(r)$。该系统为：\n$$\n\\frac{dy_0}{dr} = - \\frac{2\\nu k^2}{c_g} y_0(r)\n$$\n$$\n\\frac{dy_1}{dr} = -\\frac{dy_0}{dr} = \\frac{2\\nu k^2}{c_g} y_0(r)\n$$\n初始条件为 $y_0(r_0) = T_{\\mathrm{launch}}$ 和 $y_1(r_0) = 0$。从 $r_0$ 积分到 $r_b$ 后，我们检查 $|y_1(r_b) - (T_{\\mathrm{launch}} - y_0(r_b))|$ 是否在指定的容差 `tol` 范围内。这证实了对推导出的物理模型进行数值积分的自洽性。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases for planet-disk interaction.\n    \"\"\"\n    test_cases = [\n        (1.0, 20, 0.05, 0.001, 1.0e-5, 1.2e-5, 0.40, 2.50, 1.0e-3, 1.0e-9),\n        (1.0, 20, 0.05, 0.0, 1.0e-5, 1.0e-5, 0.50, 2.00, 1.0e-3, 1.0e-10),\n        (1.0, 20, 0.05, 0.005, 1.0e-5, 1.0e-5, 0.50, 2.50, 1.0e-3, 1.0e-9),\n        (1.0, 30, 0.05, 0.001, 8.0e-6, 9.0e-6, 0.70, 1.30, 5.0e-4, 1.0e-9),\n        (1.0, 50, 0.05, 0.001, 6.0e-6, 6.5e-6, 0.60, 1.80, 5.0e-4, 1.0e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_for_case(case)\n        results.append(result)\n\n    # Format the final output as a comma-separated list of booleans in a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation_for_case(case):\n    \"\"\"\n    Runs the simulation for a single test case and verifies torque balance.\n    \"\"\"\n    rp, m, h, alpha, T_launch_in, T_launch_out, r_in, r_out, epsilon, tol = case\n\n    # Keplerian angular frequency (GM_* = 1)\n    Omega = lambda r: r**(-1.5)\n    # Sound speed\n    cs = lambda r: h * r * Omega(r)\n    # Kinematic viscosity\n    nu = lambda r: alpha * cs(r)**2 / Omega(r) if alpha > 0.0 else 0.0\n\n    Omega_p = Omega(rp)\n    omega_pattern = m * Omega_p\n\n    # Lindblad resonance locations\n    # Omega_IL = omega_pattern / (m - 1) is unstable for m=1, but m>=2 here.\n    Omega_IL = omega_pattern / (m - 1)\n    r_IL = Omega_IL**(-2.0/3.0)\n\n    Omega_OL = omega_pattern / (m + 1)\n    r_OL = Omega_OL**(-2.0/3.0)\n\n    def ode_system(r, y, is_outer_branch):\n        \"\"\"\n        Defines the system of ODEs for flux and deposited angular momentum.\n        y[0] = F_J (Angular momentum flux)\n        y[1] = Delta J_dep (Deposited angular momentum)\n        \"\"\"\n        F_J = y[0]\n        \n        # If viscosity is zero, there's no damping.\n        if alpha == 0.0:\n            return [0.0, 0.0]\n\n        Om_r = Omega(r)\n        cs_r = cs(r)\n        nu_r = nu(r)\n\n        # Wavenumber squared\n        doppler_shifted_freq = omega_pattern - m * Om_r\n        k_sq = (doppler_shifted_freq**2 - Om_r**2) / cs_r**2\n\n        # Propagation condition\n        if k_sq = 0:\n            return [0.0, 0.0]\n\n        # Group velocity\n        # k is chosen with a sign convention for physical propagation direction,\n        # but the final ODE form does not depend on the sign of k.\n        # cg = cs_r**2 * k / doppler_shifted_freq\n        \n        # RHS of the ODE for F_J: dF_J/dr = - (2 * nu * k^2 / cg) * F_J\n        # The term (k^2 / cg) can be simplified to avoid taking sqrt of k^2:\n        # k^2 / cg = k^2 / (cs^2 * k / (omega - m*Omega))\n        # This requires care with k's sign.\n        # Alternatively, rate = (2 * nu * k^2) / cg\n        # Here we use the simplified form derived in the solution text\n        # dF_J/dr =  - (2 * nu * k^2 * (omega - m*Omega) / cs^2) * F_J.\n        # This is more numerically robust as it avoids k in the denominator.\n        \n        dF_J_dr_coeff = - (2.0 * nu_r * k_sq * doppler_shifted_freq) / (cs_r**2)\n        dF_J_dr = dF_J_dr_coeff * F_J\n        \n        # d(Delta J)/dr = -dF_J/dr\n        dDelta_J_dr = -dF_J_dr\n\n        return [dF_J_dr, dDelta_J_dr]\n\n    # --- Inner Branch Simulation ---\n    r0_in = r_IL - epsilon\n    rb_in = r_in\n    y0_in = [T_launch_in, 0.0]\n    sol_in = solve_ivp(\n        lambda r, y: ode_system(r, y, is_outer_branch=False),\n        (r0_in, rb_in),\n        y0_in,\n        method='RK45', # Dormand-Prince\n        rtol=1e-13,\n        atol=1e-13,\n    )\n    F_J_final_in = sol_in.y[0, -1]\n    Delta_J_dep_in = sol_in.y[1, -1]\n    \n    balance_check_in = abs(Delta_J_dep_in - (T_launch_in - F_J_final_in)) = tol\n\n    # --- Outer Branch Simulation ---\n    r0_out = r_OL + epsilon\n    rb_out = r_out\n    y0_out = [T_launch_out, 0.0]\n    sol_out = solve_ivp(\n        lambda r, y: ode_system(r, y, is_outer_branch=True),\n        (r0_out, rb_out),\n        y0_out,\n        method='RK45', # Dormand-Prince\n        rtol=1e-13,\n        atol=1e-13,\n    )\n    F_J_final_out = sol_out.y[0, -1]\n    Delta_J_dep_out = sol_out.y[1, -1]\n    \n    balance_check_out = abs(Delta_J_dep_out - (T_launch_out - F_J_final_out)) = tol\n\n    return balance_check_in and balance_check_out\n\nsolve()\n```", "id": "3520550"}, {"introduction": "除了与波相关的扭矩外，行星还对其轨道附近的同转区域（corotation region）内的气体施加同转扭矩。然而，这种扭矩的长期效力取决于一个关键的物理过程：饱和。本练习旨在培养你对扭矩饱和物理机制的直觉，通过比较马蹄形轨道（horseshoe region）中的气体振动（libration）时间 $t_{\\mathrm{lib}}$ 与黏性和热扩散时间 $t_{\\mathrm{diff}}$，你将能够根据星盘的基本参数预测同转扭矩是处于强劲的非饱和状态，还是微弱的饱和状态 [@problem_id:3520537]。", "problem": "您需要实现一个完整的、可运行的程序，通过改变运动粘度和热扩散率，来数值化地描绘行星-吸积盘系统中共同旋转力矩的饱和情况。重点是验证饱和转变发生的判据，即马蹄形区域的天平动时间与物质穿过该区域的扩散时间相当。请使用以下基本关系和常数。对于一个行星与恒星质量比为 $q$ 的行星，嵌入在一个质量为 $M_\\star$ 的恒星周围的开普勒盘中，其轨道半径为 $r$，轨道角频率由 $ \\Omega = \\sqrt{G M_\\star / r^3} $ 给出，其中 $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。马蹄形区域的半宽度按 $ x_s \\approx 1.1\\, r \\sqrt{q/h} $ 缩放，其中 $h$ 是盘的展弦比 $H/r$，被视为一个无量纲常数。马蹄形天平动时间为 $ t_{\\mathrm{lib}} \\approx \\dfrac{8\\pi r}{3\\,\\Omega\\,x_s} $。扩散时间尺度可由扩散方程得到：一个标量场穿过长度尺度 $L$ 需要的时间为 $t \\sim L^2/D$，其中 $D$ 是扩散系数。取 $L = x_s$，则粘滞扩散时间和热扩散时间分别为 $ t_{\\mathrm{visc}} = x_s^2/\\nu $ 和 $ t_{\\mathrm{therm}} = x_s^2/\\chi $，其中 $\\nu$ 是运动粘度，$\\chi$ 是热扩散率。您必须为每个测试用例实现以下逻辑：计算 $x_s$、$\\Omega$、$t_{\\mathrm{lib}}$、$t_{\\mathrm{visc}}$ 和 $t_{\\mathrm{therm}}$；计算比率 $ R_{\\mathrm{visc}} = t_{\\mathrm{lib}}/t_{\\mathrm{visc}} $ 和 $ R_{\\mathrm{therm}} = t_{\\mathrm{lib}}/t_{\\mathrm{therm}} $；在容差因子 $f_{\\mathrm{tol}} = 2.0$ 内，评估每个通道是否满足等价判据 $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$，这意味着如果比率在闭区间 $[1/f_{\\mathrm{tol}}, f_{\\mathrm{tol}}]$ 内，则认为判据得到验证。为了进行分类，为每个通道分配一个整数：如果满足接近判据，则标记为临界状态，代码为 $2$；否则，如果 $t_{\\mathrm{diff}}  t_{\\mathrm{lib}}$ (快速扩散，未饱和共转力矩)，则标记为 $1$；否则 (慢速扩散，饱和共转力矩)，标记为 $0$。所有时间必须以秒为单位计算，粘度和扩散率必须以 $\\mathrm{m^2/s}$ 为单位，质量以千克为单位，距离以米为单位，质量比 $q$ 和展弦比 $h$ 是无量纲的。您的程序必须将 $ R_{\\mathrm{visc}} $ 和 $ R_{\\mathrm{therm}} $ 四舍五入到六位小数。\n\n测试套件。使用以下五个测试用例，每个用例指定为一个元组 $(M_\\star, r, q, h, \\nu, \\chi)$，其单位和数值如上所述。天文单位为 $1\\,\\mathrm{au} = 1.496\\times 10^{11}\\,\\mathrm{m}$。\n\n1. 在 $r=5\\,\\mathrm{au}$ 处接近等价状态的一般情况：$(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 2.5\\times 10^{10}, 2.5\\times 10^{10})$。\n2. 在 $r=5\\,\\mathrm{au}$ 处的低扩散（双通道）：$(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{8}, 1\\times 10^{8})$。\n3. 在 $r=5\\,\\mathrm{au}$ 处的高扩散（双通道）：$(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{12}, 1\\times 10^{12})$。\n4. 在 $r=5\\,\\mathrm{au}$ 处的混合扩散：$(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{9}, 1\\times 10^{11})$。\n5. 在 $r=1\\,\\mathrm{au}$ 处不同的质量和展弦比：$(1.98847\\times 10^{30}, 1\\times 1.496\\times 10^{11}, 1\\times 10^{-4}, 0.03, 4\\times 10^{12}, 1\\times 10^{13})$。\n\n输出规范。您的程序应生成单行输出，包含一个各测试用例结果的列表，其中每个结果是列表 $[C_{\\mathrm{visc}}, C_{\\mathrm{therm}}, R_{\\mathrm{visc}}, R_{\\mathrm{therm}}, S_{\\mathrm{visc}}, S_{\\mathrm{therm}}]$，$C_{\\mathrm{visc}}$ 和 $C_{\\mathrm{therm}}$ 为布尔值，$R_{\\mathrm{visc}}$ 和 $R_{\\mathrm{therm}}$ 为四舍五入到六位小数的浮点数，$S_{\\mathrm{visc}}$ 和 $S_{\\mathrm{therm}}$ 为整数。最终格式必须是一个用方括号括起来的、以逗号分隔的单一列表，例如 $[[\\dots],[\\dots],\\dots]$。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于已建立的行星-吸积盘相互作用理论，特别是关于共转力矩的饱和问题。所提供的开普勒角频率、马蹄形区域宽度、天平动时间和扩散时间尺度的公式是该物理模型中的标准且正确的表示。所有必要的常数、参数和逻辑条件都已提供，使得该问题是适定的和自洽的。这些数值对于原行星盘环境是物理上合理的。\n\n该问题的核心原理是比较嵌入在原行星盘中的行星附近的两个特征时间尺度：天平动时间 $t_{\\mathrm{lib}}$ 和扩散时间 $t_{\\mathrm{diff}}$。共转力矩源于行星轨道马蹄形区域中的物质。只要物理扩散过程（粘度和热传导）能够比物质环流更快地平滑马蹄形区域宽度 $x_s$ 上的涡势和熵的梯度，该力矩就保持强劲（未饱和）。环流时间就是天平动时间 $t_{\\mathrm{lib}}$。如果扩散相对于天平动太慢，这些梯度就会被维持，力矩就会饱和（显著减弱）。这些状态之间的转变发生在时间尺度相当之时，即 $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$。\n\n解决此问题的算法过程涉及对每个给定测试用例进行一系列计算，每个测试用例由一组参数 $(M_\\star, r, q, h, \\nu, \\chi)$ 定义。\n\n首先，我们计算系统的基本动力学量。行星在质量为 $M_\\star$ 的恒星周围，轨道半径为 $r$ 处的轨道角频率 $\\Omega$ 由开普勒公式给出：\n$$ \\Omega = \\sqrt{\\frac{G M_\\star}{r^3}} $$\n其中 $G$ 是引力常数。\n\n接下来，我们确定相互作用区域的空间尺度。马蹄形区域的半宽度 $x_s$ 由行星与恒星的质量比 $q$ 和盘的展弦比 $h = H/r$ 通过以下标度关系确定：\n$$ x_s \\approx 1.1 r \\sqrt{\\frac{q}{h}} $$\n\n利用这些量，我们可以计算天平动时间，它代表了气体包裹沿马蹄形流线完成一圈轨道所需的时间：\n$$ t_{\\mathrm{lib}} \\approx \\frac{8\\pi r}{3\\,\\Omega\\,x_s} $$\n\n穿过此宽度 $x_s$ 的扩散时间是针对粘滞和热通道分别计算的，它们分别由运动粘度 $\\nu$ 和热扩散率 $\\chi$ 控制。对于扩散率为 $D$、穿过长度 $L$ 的扩散时间的一般形式是 $t \\sim L^2/D$。将其应用于我们的情境：\n$$ t_{\\mathrm{visc}} = \\frac{x_s^2}{\\nu} \\quad \\text{and} \\quad t_{\\mathrm{therm}} = \\frac{x_s^2}{\\chi} $$\n\n通过计算天平动时间与各扩散时间之比来评估饱和判据：\n$$ R_{\\mathrm{visc}} = \\frac{t_{\\mathrm{lib}}}{t_{\\mathrm{visc}}} \\quad \\text{and} \\quad R_{\\mathrm{therm}} = \\frac{t_{\\mathrm{lib}}}{t_{\\mathrm{therm}}} $$\n\n最后，对于每个通道（粘滞和热，用 $k \\in \\{\\mathrm{visc}, \\mathrm{therm}\\}$ 索引），我们根据比率 $R_k$ 的值对共转力矩的状态进行分类。使用一个容差因子 $f_{\\mathrm{tol}} = 2.0$ 来定义一个“临界”状态。\n\n1.  如果满足判据 $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$，则验证布尔值 $C_k$ 设置为 True，这定义为比率 $R_k$ 落在区间 $[1/f_{\\mathrm{tol}}, f_{\\mathrm{tol}}]$ 内，即 $C_k = (0.5 \\le R_k \\le 2.0)$。\n2.  饱和状态整数 $S_k$ 根据以下层级分配：\n    - 如果 $R_k > f_{\\mathrm{tol}}$ (即 $R_k > 2.0$)，扩散相对于天平动是快速的 ($t_{\\mathrm{diff}} \\ll t_{\\mathrm{lib}}$)。力矩是未饱和的。我们分配 $S_k = 1$。\n    - 如果 $R_k  1/f_{\\mathrm{tol}}$ (即 $R_k  0.5$)，扩散相对于天平动是缓慢的 ($t_{\\mathrm{diff}} \\gg t_{\\mathrm{lib}}$)。力矩是饱和的。我们分配 $S_k = 0$。\n    - 否则，比率在临界范围内，$1/f_{\\mathrm{tol}} \\le R_k \\le f_{\\mathrm{tol}}$。力矩是临界的。我们分配 $S_k = 2$。\n\n将此完整过程应用于每个测试用例，其结果，包括布尔值 $C_k$、四舍五入到六位小数的比率 $R_k$ 以及整数状态码 $S_k$，被汇总成最终指定的输出格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and classifies the saturation state of corotation torque\n    for a series of planet-disk interaction scenarios.\n    \"\"\"\n    \n    # Gravitational constant in SI units (m^3 kg^-1 s^-2)\n    G = 6.67430e-11\n    \n    # Tolerance factor for evaluating the saturation criterion\n    f_tol = 2.0\n\n    # Define the test cases as per the problem statement.\n    # Each case is a tuple: (M_star, r, q, h, nu, chi)\n    test_cases = [\n        # Case 1: General case\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 2.5e10, 2.5e10),\n        # Case 2: Low diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e8, 1e8),\n        # Case 3: High diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e12, 1e12),\n        # Case 4: Mixed diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e9, 1e11),\n        # Case 5: Different parameters\n        (1.98847e30, 1 * 1.496e11, 1e-4, 0.03, 4e12, 1e13),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        M_star, r, q, h, nu, chi = case\n\n        # 1. Compute orbital angular frequency\n        Omega = np.sqrt(G * M_star / r**3)\n\n        # 2. Compute horseshoe region half-width\n        xs = 1.1 * r * np.sqrt(q / h)\n\n        # 3. Compute horseshoe libration time\n        t_lib = (8.0 * np.pi * r) / (3.0 * Omega * xs)\n\n        # 4. Compute viscous and thermal diffusion times\n        t_visc = xs**2 / nu\n        t_therm = xs**2 / chi\n\n        # 5. Compute the ratios of libration to diffusion times\n        R_visc = t_lib / t_visc\n        R_therm = t_lib / t_therm\n        \n        # 6. Classify each channel (viscous and thermal)\n        results_for_case = []\n        \n        # Process viscous channel\n        C_visc = (1.0 / f_tol = R_visc = f_tol)\n        if R_visc > f_tol:\n            S_visc = 1  # Unsaturated\n        elif R_visc  1.0 / f_tol:\n            S_visc = 0  # Saturated\n        else:\n            S_visc = 2  # Marginal\n\n        # Process thermal channel\n        C_therm = (1.0 / f_tol = R_therm = f_tol)\n        if R_therm > f_tol:\n            S_therm = 1  # Unsaturated\n        elif R_therm  1.0 / f_tol:\n            S_therm = 0  # Saturated\n        else:\n            S_therm = 2  # Marginal\n            \n        # Assemble the result list for the current case as per specification\n        # [C_visc, C_therm, R_visc, R_therm, S_visc, S_therm]\n        case_output = [\n            C_visc, \n            C_therm, \n            round(R_visc, 6), \n            round(R_therm, 6), \n            S_visc, \n            S_therm\n        ]\n        all_results.append(case_output)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, stringified.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3520537"}]}