## 引言
在天体物理乃至更广泛的科学领域中，理解辐射如何与物质相互作用是解开众多物理过程之谜的关键。[辐射转移方程](@entry_id:160254)（RTE）为这一过程提供了数学描述，然而其复杂性，尤其是在多维和复杂几何中，使得解析求解几乎不可能，数值求解也充满挑战。蒙特卡洛[辐射转移](@entry_id:151695)（MCRT）方法应运而生，它以一种独特而强大的概率性视角，通过模拟大量单个能量包（[光子包](@entry_id:753418)）的随机旅程来构建[辐射场](@entry_id:164265)的宏观图像，从而绕过了直接求解复杂[微分](@entry_id:158718)[积分方程](@entry_id:138643)的困难。这种基于第一性原理的方法不仅物理直观，而且在处理复杂几何、散射过程和微观物理方面具有无与伦比的灵活性。

本文旨在为读者提供一份关于MCRT方法的全面指南，系统地解决如何从理论走向实践的问题。我们将带领您穿越三个层次的认知：

首先，在“原理与机制”一章中，我们将深入MCRT方法的核心，揭示其如何从[辐射转移方程](@entry_id:160254)演化而来，并详细介绍[光子](@entry_id:145192)传播、相互作用以及物理量记录等关键计算步骤。

接着，在“应用与跨学科联系”一章中，我们将视野扩展到真实世界的应用，探索MCRT如何在天体物理学的最前沿（如相对论性流体、非局部热[动平衡](@entry_id:163330)[谱线形成](@entry_id:160292)）以及医学物理、计算机图形学等[交叉](@entry_id:147634)学科中发挥关键作用。

最后，在“动手实践”部分，我们通过一系列精心设计的计算问题，引导您亲手实现MCRT的核心算法，将理论知识转化为实践能力。

通过这一系列的学习，您将不仅掌握MCRT的“是什么”和“为什么”，更将具备运用这一强大工具解决实际科学问题的能力。

## 原理与机制

本章旨在阐述蒙特卡洛[辐射转移](@entry_id:151695)（Monte Carlo Radiative Transfer, MCRT）方法的核心物理原理与计算机制。我们将从[辐射转移方程](@entry_id:160254)本身出发，揭示其与概率论的深刻联系，并展示如何通过模拟大量[光子包](@entry_id:753418)的随机历史来随机地求解该方程。随后，我们将系统地探讨模拟过程中的关键环节：[光子包](@entry_id:753418)的传播、散射相互作用、能量与动量的计算（即“记录”），以及在极端物理条件下（如[光学厚介质](@entry_id:752966)）方法的[渐近行为](@entry_id:160836)。最后，我们会通过一个完整的物理问题——尘埃温度的计算——来整合这些原理与机制，展示 MCRT 在解决实际天体物理问题中的强大威力。

### 从[辐射转移方程](@entry_id:160254)到[蒙特卡洛方法](@entry_id:136978)

[辐射转移](@entry_id:151695)理论的基石是描述[辐射场](@entry_id:164265)在介质中传播和相互作用的[辐射转移方程](@entry_id:160254)（Radiative Transfer Equation, RTE）。在一个不含时、无相对论效应的静态介质中，沿特定方向 $\hat{\mathbf{n}}$ 的一束辐射，其[谱强度](@entry_id:176230) $I_\nu(\mathbf{x}, \hat{\mathbf{n}})$ 随路径长度 $s$ 的变化由以下[微分方程](@entry_id:264184)描述：

$$
\frac{dI_\nu}{ds} = -\chi_\nu I_\nu + \eta_\nu
$$

这里，$I_\nu$ 是单位时间、单位面积、单位[立体角](@entry_id:154756)、单位频率间隔内传输的能量。方程右侧的两项代表了辐射与介质相互作用的两个基本过程：第一项 $-\chi_\nu I_\nu$ 描述了能量的损失，其中 $\chi_\nu$ 是**[消光系数](@entry_id:270201)**（extinction coefficient），包括了介质的真实吸收和将[光子散射](@entry_id:194085)出当前路径的过程；第二项 $+\eta_\nu$ 描述了能量的增加，其中 $\eta_\nu$ 是**发射系数**（emissivity），包括了介质自身的热发射以及从其他方向散射进入当前路径的贡献。

为了求解这个[一阶线性常微分方程](@entry_id:164502)，我们可以引入一个[积分因子](@entry_id:177812)，得到其形式积分解。考虑从 $s'=0$ 到 $s'=s$ 的路径，该解为：

$$
I_\nu(s) = I_\nu(0) e^{-\tau_\nu(0 \to s)} + \int_0^s \eta_\nu(s') e^{-\tau_\nu(s' \to s)} ds'
$$

其中，$\tau_\nu(a \to b) = \int_a^b \chi_\nu(\mathbf{x}(s'')) ds''$ 定义了从点 $a$到点 $b$ 的**[光学深度](@entry_id:150612)**（optical depth）。这个解具有清晰的物理图像：在 $s$ 点的[谱强度](@entry_id:176230)由两部分构成。第一部分是来自边界 $s=0$ 处的初始强度 $I_\nu(0)$ 在传播了[光学深度](@entry_id:150612) $\tau_\nu(0 \to s)$ 后衰减剩下的部分。第二部分是路径上每一点 $s'$ 的发射源 $\eta_\nu(s')$ 贡献的辐射，在传播了光学深度 $\tau_\nu(s' \to s)$ 后衰减到达 $s$ 点的贡献之和。

[蒙特卡洛方法](@entry_id:136978)的核心思想在于，将这个确定性的积分方程解重新诠释为一个概率过程的[期望值](@entry_id:153208)。指数衰减项 $e^{-\tau_\nu}$ 在概率论中正是“生存概率”的典型形式。我们可以将[光子](@entry_id:145192)在介质中的传播看作一个[随机过程](@entry_id:159502)，其在任意一点发生相互作用的概率由局域的[消光系数](@entry_id:270201) $\chi_\nu$ 决定。[光子](@entry_id:145192)在两次相互作用之间行进的**自由程**（free path）是一个[随机变量](@entry_id:195330)。

为了从这个概率模型中抽样得到[光子](@entry_id:145192)的自由程，我们采用**[逆变换采样法](@entry_id:142402)**（inverse transform sampling）。[光子](@entry_id:145192)沿路径传播到距离 $s$ 之前不发生相互作用的累积[概率分布](@entry_id:146404)函数（CDF）是 $F(s) = 1 - e^{-\tau_\nu(0 \to s)}$。我们令 $F(s) = \xi$，其中 $\xi$ 是一个在 $[0, 1)$ 区间内[均匀分布](@entry_id:194597)的随机数。解出 $s$ 就完成了抽样。

$$
\xi = 1 - e^{-\tau_\nu(0 \to s)} \implies 1 - \xi = e^{-\tau_\nu(0 \to s)}
$$

对两边取自然对数，得到 $-\ln(1-\xi) = \tau_\nu(0 \to s)$。由于 $\xi$ 是 $[0, 1)$ 的均匀随机数，那么 $1-\xi$ 也是。因此，[随机变量](@entry_id:195330) $T = -\ln(1-\xi)$ 服从均值为 1 的[指数分布](@entry_id:273894)，即 $T \sim \mathrm{Exp}(1)$。这意味着，在介质不均匀（$\chi_\nu$ 随空间变化）的情况下，我们不能直接抽样物理路径长度 $s$，而应该先抽样一个**随机[光学深度](@entry_id:150612)** $T$，然后通过求解积分方程来确定对应的物理路径长度 $s$：

$$
\int_0^s \chi_\nu(\mathbf{x}(s')) ds' = T
$$

这个过程在数学上等价于模拟一个非[齐次泊松过程](@entry_id:263782)，其局域发生率（hazard function）正是[消光系数](@entry_id:270201) $\chi_\nu(\mathbf{x}(s))$。通过模拟大量[光子包](@entry_id:753418)（代表一束具有相同属性的[光子](@entry_id:145192)集合）的随机历史——每一次随机地确定其自由程，然后在其终点模拟一次相互作用——我们实际上是在对RTE的积分形式进行随机求积。每个[光子包](@entry_id:753418)的历史都构成了对解的一个随机样本，对所有样本进行平均，便可得到对[谱强度](@entry_id:176230) $I_\nu$ 或其相关物理量的无偏估计。这就是蒙特卡洛[辐射转移](@entry_id:151695)方法的基本原理 [@problem_id:3523310]。

### 模拟[光子](@entry_id:145192)相互作用

当一个[光子包](@entry_id:753418)走完其自由程后，它将在该位置与介质发生一次相互作用。相互作用的类型主要分为**吸收**（absorption）和**散射**（scattering）。在模拟中，我们根据[吸收截面](@entry_id:172609)和散射截面在总截面中的相对比例，随机地决定此次相互作用的类型。如果发生吸收，[光子包](@entry_id:753418)的能量被介质吸收，其生命史通常就此终结。如果发生散射，[光子包](@entry_id:753418)的能量（在[弹性散射](@entry_id:152152)中）保持不变，但其运动方向会发生改变。

散射后方向的改变由**相函数**（phase function）$p(\cos\theta)$ 描述，它给出了[散射角](@entry_id:171822) $\theta$ 的余弦 $\mu = \cos\theta$ 的概率密度[分布](@entry_id:182848)。一个在天体物理中被广泛应用的例子是**[Henyey-Greenstein](@entry_id:750228) (HG) 相函数**：

$$
p(\mu) = \frac{1-g^2}{2(1+g^2-2g\mu)^{3/2}}, \quad -1 \le \mu \le 1
$$

其中，各向异性参数 $g$ 的取值范围为 $(-1, 1)$。$g > 0$ 对应[前向散射](@entry_id:191808)，$g  0$ 对应后向散射，而 $g=0$ 则退化为各向同性散射，$p(\mu) = 1/2$。

为了在模拟中实现对[散射角](@entry_id:171822) $\mu$ 的抽样，我们同样采用[逆变换采样法](@entry_id:142402)。首先，计算其[累积分布函数](@entry_id:143135) CDF，$F(\mu) = \int_{-1}^\mu p(\mu') d\mu'$：

$$
F(\mu) = \frac{1-g^2}{2g} \left( \frac{1}{\sqrt{1+g^2-2g\mu}} - \frac{1}{1+g} \right)
$$

然后，令 $F(\mu) = \xi$，其中 $\xi \sim U(0,1)$，再反解出 $\mu$。经过一系列代数运算，我们得到 $\mu$ 的显式抽样公式 [@problem_id:3523319]：

$$
\mu(\xi; g) = \frac{1}{2g} \left( 1 + g^2 - \left( \frac{1-g^2}{1-g+2g\xi} \right)^2 \right)
$$

对于 $g=0$ 的特殊情况，该公式虽然是 $0/0$ 型[不定式](@entry_id:144301)，但其极限为 $\mu = 2\xi - 1$，这正好是各向同性散射的正确抽样公式。因此，上述表达式在整个 $|g|1$ 范围内都是有效的。一旦 $\mu = \cos\theta$ 被抽出，我们还需要随机抽样一个方位角 $\phi \in [0, 2\pi)$，从而完全确定散射后的新方向。

### 记录物理量：MCRT估计量

MCRT的主要目的不仅是模拟[光子](@entry_id:145192)的传播，更重要的是利用这些[光子包](@entry_id:753418)的[路径信息](@entry_id:169683)来“测量”或“记录”[辐射场](@entry_id:164265)与介质相互作用的宏观物理量，例如介质的加热率、[辐射压力](@entry_id:165366)等。这些通过对[光子](@entry_id:145192)历史进行统计平均得到的量，被称为**[蒙特卡洛估计](@entry_id:637986)量**（Monte Carlo estimators）。一个好的估计量必须是**无偏的**（unbiased），即其[期望值](@entry_id:153208)严格等于所要测量的真实物理量。

以单位体积的加热率 $\Gamma = \int \kappa_\nu J_\nu d\nu$ 为例，其中 $\kappa_\nu$ 是[吸收系数](@entry_id:156541)，$J_\nu$ 是平均[谱强度](@entry_id:176230)。在MCRT模拟中，至少有两种常用的[无偏估计量](@entry_id:756290)来计算 $\Gamma$ [@problem_id:3523285]。

1.  **吸收计数估计量**（Absorption-Count Estimator）：
    这个估计量最符合物理直觉。当一个能量为 $E_k$ 的[光子包](@entry_id:753418)在体积为 $V$ 的计算单元内被真实吸收时，我们就记录下这个事件。在总模拟时间 $\Delta t$ 内，该单元的总加热率估计为：
    $$
    \hat{\Gamma}_{\mathrm{ABS}} = \frac{1}{V \Delta t} \sum_{\text{在单元内发生的吸收事件}} E_k
    $$
    该估计量是无偏的，因为其[期望值](@entry_id:153208)正比于吸收事件发生的概率，而该概率与[吸收系数](@entry_id:156541) $\kappa_\nu$ 成正比。

2.  **[路径长度估计量](@entry_id:149087)**（Path-Length Estimator）：
    该估计量不依赖于离散的吸收事件，而是利用了[光子包](@entry_id:753418)在单元内穿行的[路径信息](@entry_id:169683)。[光子包](@entry_id:753418) $k$ 在单元内走过的每一段路径 $l_{k,j}$，都对该处的平均强度 $J_\nu$ 有贡献。因此，我们可以沿路径连续地累积其对加热率的贡献。其表达式为：
    $$
    \hat{\Gamma}_{\mathrm{PL}} = \frac{1}{V \Delta t} \sum_{k,j} E_k \kappa_{\nu_{k,j}} l_{k,j}
    $$
    该估计量也是无偏的，其[期望值](@entry_id:153208)可以被证明等于 $\Gamma$。

这两种估计量虽然都是无偏的，但它们的统计**[方差](@entry_id:200758)**（variance）在不同物理条件下表现不同。[方差](@entry_id:200758)决定了估计量收敛的速度，[方差](@entry_id:200758)越小，达到同样精度所需的样本数（[光子包](@entry_id:753418)总数）就越少。

-   在**光学薄**（$\tau_{\text{abs}} \ll 1$）或**高[反照率](@entry_id:188373)**（single-scattering albedo $a \equiv \sigma_\nu/\chi_\nu \approx 1$）的区域，真实吸收是一个**稀有事件**。吸收计数[估计量的方差](@entry_id:167223)会非常大，因为大多数[光子包](@entry_id:753418)都直接穿过或散射出该区域，对加热率的贡献为零，只有极少数[光子包](@entry_id:753418)贡献了全部能量，导致统计起伏剧烈。相比之下，[路径长度估计量](@entry_id:149087)让每个穿过单元的[光子包](@entry_id:753418)都做出一个小的、非零的贡献（正比于 $\kappa_\nu l$），从而大大减小了[方差](@entry_id:200758)。
-   在**光学厚**（$\tau_{\text{abs}} \gtrsim 1$）且**吸收主导**（$a \lesssim 0.5$）的区域，几乎每个进入单元的[光子包](@entry_id:753418)都会被吸收。吸收事件不再稀有。此时，吸收计数[估计量的方差](@entry_id:167223)会很小。而[路径长度估计量](@entry_id:149087)的[方差](@entry_id:200758)则会受到[光子](@entry_id:145192)在单元内[随机游走](@entry_id:142620)路径长度起伏的影响，可能反而比吸收计数估计量更大。

我们可以通过一个更具体的例子——计算[辐射力](@entry_id:196819)密度——来定量地理解这两种[估计量的方差](@entry_id:167223)差异。考虑一个厚度为 $D$、吸收系数为 $\chi$ 的平板，[辐射力](@entry_id:196819)密度与动量吸收率成正比。[路径长度估计量](@entry_id:149087)可表示为 $y = \chi \ell'$，其中 $\ell'$ 是[光子](@entry_id:145192)在板内的路径；事件估计量则是一个伯努利变量 $X$，表示[光子](@entry_id:145192)是否在板内被吸收。可以严格证明，这两种[估计量的方差](@entry_id:167223)之比为 [@problem_id:3523327]：

$$
R(\tau) \equiv \frac{\mathrm{Var}(y)}{\mathrm{Var}(X)} = \frac{e^{2\tau} - 2\tau e^{\tau} - 1}{e^{\tau} - 1}
$$

其中 $\tau = \chi D$ 是平板的光学深度。当 $\tau \to 0$ 时，$R(\tau) \to 0$，表明[路径长度估计量](@entry_id:149087)的[方差](@entry_id:200758)远小于事件估计量。当 $\tau \to \infty$ 时，$R(\tau) \to \infty$，表明事件估计量更为优越。这一定量结果清晰地展示了根据物理环境选择合适估计量的重要性。

### 先进机制与极端物理条件

#### [辐射扩散](@entry_id:158401)极限

当介质变得极度**光学厚**时（$\chi L \gg 1$），[光子](@entry_id:145192)的[平均自由程](@entry_id:139563) $\lambda=1/\chi$ 远小于系统的特征尺度 $L$。[光子](@entry_id:145192)在介质中经历无数次各向同性散射，其轨迹如同分子的布朗运动，宏观上表现为一种**[扩散](@entry_id:141445)**（diffusion）现象。在这种极限情况下，[辐射转移](@entry_id:151695)可以被一个更简单的扩散方程所近似。

我们可以从RTE的[矩方程](@entry_id:149666)出发来推导这个结论。在长时间和大光学深度的极限下，辐射场趋于各向同性。通过[渐近分析](@entry_id:160416)可以证明，辐射能量密度 $E$ 的演化遵循一个标准的扩散方程 [@problem_id:3523305] [@problem_id:3523278]：

$$
\frac{\partial E}{\partial t} = \nabla \cdot (D \nabla E)
$$

其中，辐射**[扩散](@entry_id:141445)系数** $D$ 被证明与介质的[消光系数](@entry_id:270201) $\chi$ 和光速 $c$ 有一个简洁而深刻的关系：

$$
D = \frac{c}{3\chi}
$$

这个结果说明，在[光学厚介质](@entry_id:752966)中，MCRT模拟的本质就是求解一个扩散方程。[光子包](@entry_id:753418)的[随机游走](@entry_id:142620)行为（$\langle r^2 \rangle = 6Dt$）正是扩散过程的微观体现。理解这个极限对于开发加速算法（如隐式[蒙特卡洛](@entry_id:144354)，IMC）以及验证MCRT代码在光学厚区域的正确性至关重要。

#### Woodcock (Delta) 追踪

在处理具有复杂几何结构（如[自适应网格](@entry_id:164379) [AMR](@entry_id:204220)）或空间上剧烈变化的[消光系数](@entry_id:270201)的介质时，传统的光程[抽样方法](@entry_id:141232)（求解 $\int \chi_\nu ds = T$）会变得非常低效，因为它需要在每个网格边界处中断并重新计算。**Woodcock追踪**（也称**Delta追踪**）是一种优雅且高效的替代方案 [@problem_id:3523309]。

该方法的核心思想是引入一个**人造的**、空间均匀的**主宰[消光系数](@entry_id:270201)** $\bar{\chi}$，它必须大于或等于整个计算区域内所有物理[消光系数](@entry_id:270201)的最大值，即 $\bar{\chi} \ge \max(\chi_\nu(\mathbf{x}))$。然后，[光子](@entry_id:145192)的自由程 $l$ 就从一个简单的、均匀介质的指数分布中抽样：$l = -\ln(\xi) / \bar{\chi}$。

[光子](@entry_id:145192)沿直线传播距离 $l$ 后，到达一个“虚拟相互作用”点。此时，我们进行一次接受-拒绝判断：以概率 $p = \chi_\nu(\mathbf{x}) / \bar{\chi}$，这次虚拟相互作用被接受为一次“真实”的物理相互作用（散射或吸收）。如果被拒绝（概率为 $1-p$），则认为什么也没发生，[光子包](@entry_id:753418)继续沿原方向传播，直到下一次虚拟相互作用。

这个过程之所以是无偏的，可以从泊松过程的“筛选”特性来理解。均匀的虚拟相互作用构成一个速率为 $\bar{\chi}$ 的[齐次泊松过程](@entry_id:263782)。对其进行依赖于位置的概率 $p(\mathbf{x}) = \chi_\nu(\mathbf{x})/\bar{\chi}$ 筛选，得到的真实相互作用过程恰好是一个速率为 $\bar{\chi} \cdot p(\mathbf{x}) = \chi_\nu(\mathbf{x})$ 的非[齐次泊松过程](@entry_id:263782)，这与我们最初要模拟的物理过程完[全等](@entry_id:273198)价。

Woodcock追踪的效率取决于主宰[消光系数](@entry_id:270201) $\bar{\chi}$ 的选择。$\bar{\chi}$ 越大，虚拟相互作用越频繁，计算开销越大。我们可以推导出，在一段平均消光为 $\langle\chi\rangle$ 的路径上，每次真实相互作用平均伴随的虚拟（“浪费的”）相互作用次数为：

$$
\frac{E[N_v]}{E[N_r]} = \frac{\bar{\chi}}{\langle\chi\rangle} - 1
$$

这个结果表明，当介质的[消光系数](@entry_id:270201)变化剧烈时（$\bar{\chi} \gg \langle\chi\rangle$），Woodcock追踪的效率会降低，但它避免了复杂的几何追踪，在很多情况下仍然是最佳选择。

### 综合应用：尘埃[辐射平衡](@entry_id:158473)与[温度计](@entry_id:187929)算

现在，我们将上述原理和机制整合起来，解决一个天体物理学中的典型问题：计算被恒星加热的尘埃的平衡温度。

考虑一个被中心光源照亮的尘埃云。尘埃颗粒吸收来自光源的辐射（主要是紫外和可见光），自身被加热，然后以[热辐射](@entry_id:145102)的形式（主要是红外光）将能量重新发射出去。在**[辐射平衡](@entry_id:158473)**（radiative equilibrium）状态下，单位时间内吸收的能量等于发射的能量。

吸收的能量由MCRT的[路径长度估计量](@entry_id:149087)来计算。在一个体积为 $V$ 的计算单元中，[吸收功率](@entry_id:265908)可以写作 [@problem_id:3523268] [@problem_id:3523249]：

$$
P_{\text{abs}} = V \int_0^\infty \kappa_\nu (4\pi J_\nu) d\nu \approx V \cdot (4\pi) \cdot \frac{1}{4\pi V \Delta t} \sum_p \varepsilon_p \kappa_{\nu_p} l_p = \frac{1}{\Delta t} \sum_p \varepsilon_p \kappa_{\nu_p} l_p
$$

其中 $J_\nu$ 是由MCRT模拟的光源[光子包](@entry_id:753418)得到的平均[谱强度](@entry_id:176230)。

发射的能量则由尘埃自身的[热力学状态](@entry_id:755916)决定。在局部热[动平衡](@entry_id:163330)（LTE）假设下，发射功率由[普朗克函数](@entry_id:159605) $B_\nu(T)$ 和尘埃的吸收系数 $\kappa_\nu$ 给出：

$$
P_{\text{em}}(T) = V \int_0^\infty \kappa_\nu (4\pi B_\nu(T)) d\nu
$$

如果尘埃的吸收系数遵循[幂律](@entry_id:143404)形式 $\kappa_\nu \propto \nu^\beta$，可以证明其总发射功率与温度有如下关系：$P_{\text{em}} \propto T^{4+\beta}$。

[辐射平衡](@entry_id:158473)条件就是 $P_{\text{abs}} = P_{\text{em}}(T)$。这是一个关于未知温度 $T$ 的[非线性方程](@entry_id:145852)。著名的 **Lucy (1999)** 方法提供了一种稳定求解该方程的迭代方案：

$$
T_{k+1} = T_k \left( \frac{P_{\text{abs}}}{P_{\text{em}}(T_k)} \right)^{\frac{1}{4+\beta}}
$$

这个迭代格式不仅物理意义明确（如果当前发射过强，则降低温度；反之则升高），而且可以被证明是单调收敛的 [@problem_id:3523268]。通过MCRT模拟得到 $P_{\text{abs}}$，然后进行几次这样的迭代，就可以求出每个计算单元的尘埃温度。

这种方法的美妙之处在于，它将复杂的[辐射转移](@entry_id:151695)过程（通过MCRT模拟）与局域的热力学平衡计算（通过迭代求解）[解耦](@entry_id:637294)，构成了现代天体[物理模拟](@entry_id:144318)的基础。MCRT模拟不仅能够准确计算加热率，而且其结果自然地再现了物理上的[标度律](@entry_id:139947)。例如，在光学薄的情况下，MCRT模拟可以正确地重现尘埃温度的径向[分布](@entry_id:182848) $T(r) \propto L^{1/(4+\beta)} r^{-2/(4+\beta)}$ [@problem_id:3523249]。

最后，值得一提的是，在实际的[辐射流体力学](@entry_id:754009)模拟中，为了保证数值方案的严格[能量守恒](@entry_id:140514)，常常采用**不可分割能量包**（indivisible energy packets）的方案。在这种方案中，每个[光子包](@entry_id:753418)被定义为携带一个固定的同动系能量 $\epsilon$。当一个吸收事件发生时，一个能量为 $\epsilon$ 的包被吸收，同时一个同样能量为 $\epsilon$ 的新包被从介质中发射出来。这种“吸收后立即再发射”的机制，虽然是对物理过程的简化，但它通过构造保证了每次相互作用中介质与[辐射场](@entry_id:164265)之间的净能量交换为零，从而在数值上实现了精确的[能量守恒](@entry_id:140514) [@problem_id:3523328]。这再次体现了MCRT方法在理论的严谨性与计算实践的灵活性之间的巧妙平衡。