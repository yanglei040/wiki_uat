{"hands_on_practices": [{"introduction": "M1 闭合关系不仅仅是一个数学构造，它深深植根于物理原理。本练习将通过从第一性原理出发，引导您推导 M1 闭合关系，展示其如何源自狭义相对论。通过对一个共动系中的各向同性辐射场进行洛伦兹变换，我们将揭示辐射能流的存在如何自然地导致实验室坐标系中辐射压力张量的各向异性，从而加深您对辐射场动态行为的理解。[@problem_id:3522603]", "problem": "考虑一个由比辐射强度的前三个角矩所描述的辐射场：辐射能量密度 $E$、辐射通量矢量 $\\mathbf{F}$ 和辐射压力张量 $\\mathsf{P}$。约化通量定义为 $f \\equiv |\\mathbf{F}|/(c E)$，其中 $c$ 是光速。在矩方法中，需要一个闭合关系来用低阶矩表示 $\\mathsf{P}$。一种物理上合理的闭合关系是通过假设辐射场在随动参考系中是各向同性的，并通过一个与通量方向一致的洛伦兹助推来关联实验室参考系中的各阶矩。从随动参考系中的辐射应力-能量张量出发，利用狭义相对论沿通量方向进行助推，推导爱丁顿因子 $\\chi(f)$ 的解析表达式，其定义为平行于通量方向的压力分量与能量密度之比，并将整个张量 $\\mathsf{P}$ 用 $E$、$\\chi(f)$ 和单位通量方向 $\\hat{\\mathbf{n}}$ 表示。\n\n然后，对于一个状态，其 $E=1$（任意单位）、$|\\mathbf{F}|=0.6\\,c$ 且 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$，计算 $f$，求出 $\\chi(f)$，并计算 $\\mathsf{P}$ 的非零分量。最后，将得到的 $\\mathsf{P}$ 与扩散极限张量进行比较，并定性评论其差异。\n\n将您的数值结果四舍五入到四位有效数字。使用与 $E$ 相同的任意单位表示 $\\mathsf{P}$ 的分量。最终报告的答案必须是由 $\\chi(f)$、$P_{xx}$、$P_{yy}$ 和 $P_{zz}$ 组成的有序四元组。", "solution": "解答分为三个部分：\n1. 爱丁顿因子 $\\chi(f)$ 和辐射压力张量 $\\mathsf{P}$ 的解析表达式的推导。\n2. 对给定状态的 $f$、$\\chi(f)$ 和 $\\mathsf{P}$ 分量进行数值计算。\n3. 将得到的压力张量与扩散近似下的压力张量进行定性比较。\n\n**第一部分：M1闭合关系的推导**\n\n辐射场由应力-能量张量 $T^{\\alpha\\beta}$ 描述，其在实验室参考系中的分量与辐射能量密度 $E$、通量矢量 $\\mathbf{F}$ 和压力张量 $\\mathsf{P}$ 相关，如下所示：\n$$\nT^{00} = E, \\quad T^{0i} = T^{i0} = \\frac{F_i}{c}, \\quad T^{ij} = P_{ij}\n$$\n其中 $c$ 是光速，索引 $i, j$ 的取值范围为 1 到 3。\n\n问题指出，在一个相对于实验室参考系以速度 $\\mathbf{v}$ 运动的随动参考系中，辐射场是各向同性的。这是辐射的静止参考系。在此参考系中（用带撇的坐标表示），辐射通量为零（$\\mathbf{F}'=0$），且压力是各向同性的。对于光子气体，各向同性压力 $p'$ 与能量密度 $E'$ 的关系为 $p' = E'/3$。因此，静止参考系中的压力张量为 $P'_{ij} = (E'/3)\\delta_{ij}$。\n\n因此，静止参考系中的应力-能量张量 $T'^{\\alpha'\\beta'}$ 为：\n$$\nT'^{\\alpha'\\beta'} = \\begin{pmatrix} E'  0  0  0 \\\\ 0  E'/3  0  0 \\\\ 0  0  E'/3  0 \\\\ 0  0  0  E'/3 \\end{pmatrix}\n$$\n\n为了找到实验室参考系中的张量，我们对 $T'^{\\alpha'\\beta'}$ 执行洛伦兹助推。我们将助推方向与辐射通量 $\\mathbf{F}$ 的方向对齐，不失一般性，我们将其设为 $x$ 轴方向。静止参考系相对于实验室参考系的速度为 $\\mathbf{v} = v\\hat{\\mathbf{x}}$。此助推的洛伦兹变换矩阵 $\\Lambda^{\\alpha}_{\\alpha'}$ 为：\n$$\n\\Lambda^{\\alpha}_{\\alpha'} = \\begin{pmatrix} \\gamma  \\gamma\\beta  0  0 \\\\ \\gamma\\beta  \\gamma  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\n其中 $\\beta = v/c$ 且 $\\gamma = (1-\\beta^2)^{-1/2}$。\n\n实验室参考系张量 $T^{\\alpha\\beta}$ 通过变换 $T^{\\alpha\\beta} = \\Lambda^{\\alpha}_{\\alpha'} \\Lambda^{\\beta}_{\\beta'} T'^{\\alpha'\\beta'}$ 获得。我们计算相关分量：\n\n$T^{00} = E = (\\Lambda^{0}_{0})^2 T'^{00} + (\\Lambda^{0}_{1})^2 T'^{11} = \\gamma^2 E' + (\\gamma\\beta)^2 (E'/3) = \\gamma^2 E' (1 + \\beta^2/3)$。\n\n$T^{01} = F_x/c = \\Lambda^{0}_{0}\\Lambda^{1}_{0} T'^{00} + \\Lambda^{0}_{1}\\Lambda^{1}_{1} T'^{11} = (\\gamma)(\\gamma\\beta) E' + (\\gamma\\beta)(\\gamma) (E'/3) = \\gamma^2\\beta E'(1 + 1/3) = \\frac{4}{3}\\gamma^2\\beta E'$。通过类似的计算，$F_y=F_z=0$。\n\n$T^{11} = P_{xx} = (\\Lambda^{1}_{0})^2 T'^{00} + (\\Lambda^{1}_{1})^2 T'^{11} = (\\gamma\\beta)^2 E' + \\gamma^2 (E'/3) = \\gamma^2 E'(\\beta^2 + 1/3)$。\n\n$T^{22} = P_{yy} = (\\Lambda^{2}_{2})^2 T'^{22} = (1)^2(E'/3) = E'/3$。\n\n$T^{33} = P_{zz} = (\\Lambda^{3}_{3})^2 T'^{33} = (1)^2(E'/3) = E'/3$。\n\n所有非对角压力分量 $P_{ij}$ ($i\\neq j$) 均为零。\n\n约化通量 $f$ 定义为 $f \\equiv |\\mathbf{F}|/(cE)$。使用我们推导的表达式：\n$$\nf = \\frac{F_x}{cE} = \\frac{\\frac{4}{3}\\gamma^2\\beta E'}{\\gamma^2 E' (1 + \\beta^2/3)} = \\frac{4\\beta/3}{1+\\beta^2/3} = \\frac{4\\beta}{3+\\beta^2}\n$$\n对于 $\\beta \\in [0, 1]$，$f$ 的物理范围是 $[0, 1]$。\n\n爱丁顿因子 $\\chi(f)$ 是平行于通量的压力与能量密度之比，即 $\\chi(f) = P_{\\parallel}/E = P_{xx}/E$。\n$$\n\\chi = \\frac{P_{xx}}{E} = \\frac{\\gamma^2 E'(\\beta^2 + 1/3)}{\\gamma^2 E' (1 + \\beta^2/3)} = \\frac{3\\beta^2+1}{3+\\beta^2}\n$$\n为了将 $\\chi$ 表示为 $f$ 的函数，我们消去 $\\beta$。从 $f$ 和 $\\chi$ 的表达式中，我们可以建立一个关系。令 $X=\\chi$。则 $\\beta^2 = (3X-1)/(3-X)$。将其代入 $f$ 的平方表达式中：\n$$\nf^2 = \\frac{16\\beta^2}{(3+\\beta^2)^2} = \\frac{16(3X-1)/(3-X)}{(3+(3X-1)/(3-X))^2} = \\frac{16(3X-1)(3-X)}{(9-3X+3X-1)^2} = \\frac{16(9X-3X^2-3+X)}{64} = \\frac{-3X^2+10X-3}{4}\n$$\n这给出了关于 $X=\\chi(f)$ 的二次方程：$3X^2 - 10X + (3+4f^2) = 0$。解出 $X$：\n$$\n\\chi(f) = \\frac{10 \\pm \\sqrt{100 - 12(3+4f^2)}}{6} = \\frac{10 \\pm \\sqrt{64 - 48f^2}}{6} = \\frac{5 \\pm 2\\sqrt{4 - 3f^2}}{3}\n$$\n为了选择正确的物理分支，我们考虑各向同性极限，即 $f \\to 0$，此时我们期望 $\\chi \\to 1/3$。取负号得到 $\\chi(0) = (5 - 2\\sqrt{4})/3 = 1/3$，这是正确的。取正号会得到非物理的结果 $\\chi(0)=3$。因此，爱丁顿因子为：\n$$\n\\chi(f) = \\frac{5 - 2\\sqrt{4 - 3f^2}}{3}\n$$\n接下来，我们将压力张量 $\\mathsf{P}$用 $E$、$\\chi(f)$ 和单位通量方向 $\\hat{\\mathbf{n}} = \\mathbf{F}/|\\mathbf{F}|$ 表示。该张量的形式必须为 $P_{ij} = A\\delta_{ij} + B n_i n_j$。在与 $\\hat{\\mathbf{n}}$ 对齐的坐标系中，$P_{xx} = A+B$ 且 $P_{yy}=P_{zz}=A$。我们有两个条件：\n1. $\\chi$ 的定义：$P_{\\parallel} = P_{xx} = \\chi E \\implies A+B = \\chi E$。\n2. 应力-能量张量的迹：迹 $T^\\alpha_\\alpha = E - \\text{tr}(\\mathsf{P})$ 是一个洛伦兹不变量。在静止参考系中，$T'^{\\alpha'}}_{\\alpha'} = E' - (P'_{xx}+P'_{yy}+P'_{zz}) = E' - 3(E'/3) = 0$。因此，$E - \\text{tr}(\\mathsf{P}) = 0$，这意味着 $\\text{tr}(\\mathsf{P}) = P_{xx}+P_{yy}+P_{zz} = E$。\n\n使用这些条件：\n$(A+B) + A + A = E \\implies 3A+B=E$。\n我们解这个方程组：\n$3A+B=E$\n$A+B=\\chi E$\n第一个方程减去第二个方程得到 $2A = (1-\\chi)E \\implies A = \\frac{1-\\chi}{2}E$。\n将 $A$ 代回得到 $B = \\chi E - A = \\chi E - \\frac{1-\\chi}{2}E = \\frac{2\\chi-1+\\chi}{2}E = \\frac{3\\chi-1}{2}E$。\n因此，压力张量为：\n$$\n\\mathsf{P} = E \\left[ \\frac{1-\\chi(f)}{2} \\mathsf{I} + \\frac{3\\chi(f)-1}{2} \\hat{\\mathbf{n}} \\otimes \\hat{\\mathbf{n}} \\right]\n$$\n其中 $\\mathsf{I}$ 是单位张量，且 $(\\hat{\\mathbf{n}} \\otimes \\hat{\\mathbf{n}})_{ij} = n_i n_j$。\n\n**第二部分：数值计算**\n\n给定 $E=1$（任意单位），$|\\mathbf{F}|=0.6c$ 和 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}=(1,0,0)$。\n\n首先，我们计算约化通量 $f$：\n$$\nf = \\frac{|\\mathbf{F}|}{cE} = \\frac{0.6c}{c(1)} = 0.6\n$$\n\n接下来，我们对 $f=0.6$ 计算爱丁顿因子 $\\chi(f)$：\n$$\n\\chi(0.6) = \\frac{5 - 2\\sqrt{4 - 3(0.6)^2}}{3} = \\frac{5 - 2\\sqrt{4 - 3(0.36)}}{3} = \\frac{5 - 2\\sqrt{4 - 1.08}}{3} = \\frac{5 - 2\\sqrt{2.92}}{3}\n$$\n$$\n\\chi(0.6) \\approx \\frac{5 - 2(1.7088007)}{3} = \\frac{5 - 3.4176014}{3} = \\frac{1.5823986}{3} \\approx 0.5274662\n$$\n四舍五入到四位有效数字，$\\chi(0.6) = 0.5275$。\n\n现在我们计算压力张量 $\\mathsf{P}$ 的非零分量。当 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$ 时，分量为：\n$P_{xx} = P_{\\parallel} = \\chi E = (0.5274662)(1) = 0.5274662$。\n$P_{yy} = P_{zz} = P_{\\perp} = \\frac{1-\\chi}{2} E = \\frac{1-0.5274662}{2}(1) = \\frac{0.4725338}{2} = 0.2362669$。\n非对角分量为零。\n\n四舍五入到四位有效数字：\n$P_{xx} = 0.5275$\n$P_{yy} = 0.2363$\n$P_{zz} = 0.2363$\n\n有序四元组 $(\\chi(f), P_{xx}, P_{yy}, P_{zz})$ 是 $(0.5275, 0.5275, 0.2363, 0.2363)$。\n\n**第三部分：与扩散极限的比较**\n\n扩散近似在辐射场接近各向同性的极限下有效，即 $f \\ll 1$。在此极限下，$\\chi \\to 1/3$。扩散近似中的压力张量是各向同性的：\n$$\n\\mathsf{P}_{\\text{diff}} = \\frac{1}{3} E \\mathsf{I}\n$$\n对于 $E=1$，这得到 $P_{xx} = P_{yy} = P_{zz} = 1/3 \\approx 0.3333$。\n\n比较我们计算出的张量 $\\mathsf{P}_{\\text{M1}}$ 与 $\\mathsf{P}_{\\text{diff}}$：\n- **各向异性：** $\\mathsf{P}_{\\text{M1}}$ 是强各向异性的，而 $\\mathsf{P}_{\\text{diff}}$ 是各向同性的。M1闭合关系正确地反映了净辐射通量（$f=0.6$ 不小）意味着一个各向异性的压力场。\n- **压力分量：** 在M1模型中，平行于通量的压力分量显著增强（$P_{xx} \\approx 0.5275$ 对比 $0.3333$），而垂直分量被抑制（$P_{yy}=P_{zz} \\approx 0.2363$ 对比 $0.3333$）。这在物理上是直观的：辐射流携带的动量增加了流动方向上的压力。\n- **有效性：** $f=0.6$ 的状态远离扩散区域。在这种“半透明”或“流动态”条件下，M1闭合关系比简单的扩散近似为辐射压力张量提供了更好的物理描述，后者在辐射与物质的动力学耦合中会产生重大误差。M1闭合关系正确地在扩散极限（$f=0$, $\\chi=1/3$）和自由流极限（$f=1$, $\\chi=1$）之间进行插值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5275  0.5275  0.2363  0.2363\n\\end{pmatrix}\n}\n$$", "id": "3522603"}, {"introduction": "在实际的计算天体物理学应用中，选择合适的闭合模型是在计算成本和物理精度之间进行权衡的关键。虽然像 P1 这样的简单模型计算量小，但它们在辐射场偏离各向同性时会失效。本练习将您置于一个关键的中间区域——中等各向异性状态，并要求您定量比较 P1、通量限制扩散 (FLD) 和 M1 三种闭合模型的性能，从而锻炼您根据具体物理情境选择最恰当模型的判断力。[@problem_id:3522551]", "problem": "考虑在静态、均匀介质中的灰色（频率积分）辐射转移。设辐射矩为辐射能量密度 $E$、辐射通量 $\\mathbf{F}$ 和辐射压力张量 $\\mathsf{P}$。通过关系式 $\\mathsf{P} = \\chi\\,E\\,\\hat{\\mathbf{n}}\\hat{\\mathbf{n}} + \\frac{1-\\chi}{2}\\,E\\,(\\mathsf{I}-\\hat{\\mathbf{n}}\\hat{\\mathbf{n}})$ 定义约化通量 $f \\equiv \\lvert \\mathbf{F} \\rvert/(c\\,E)$ 和爱丁顿因子 $\\chi$，其中 $\\hat{\\mathbf{n}} \\equiv \\mathbf{F}/\\lvert \\mathbf{F} \\rvert$，$\\mathsf{I}$ 是单位张量。一个更高保真度的输运解表明，在某一点，辐射强度呈中度各向异性，其特征为约化通量 $f = 0.4$。\n\n您需要为三种闭合关系估算爱丁顿因子：\n- 一阶球谐函数闭合 (P1)，该闭合假设辐射压力是各向同性的。\n- 通量限制扩散 (FLD)，使用 Levermore–Pomraning 通量限制器，其中压力被视为各向同性。\n- 双矩 $M1$ 闭合（最大熵闭合）。\n\n对于 FLD，使用定义 $R \\equiv \\lvert \\nabla E \\rvert/(\\kappa\\rho\\,E)$ 和 Levermore–Pomraning 限制器\n$$\\lambda(R) = \\frac{1}{R}\\left(\\coth R - \\frac{1}{R}\\right),$$\n使得 FLD 通量大小满足 $\\lvert \\mathbf{F} \\rvert = \\frac{c\\,\\lambda(R)}{\\kappa\\rho}\\,\\lvert \\nabla E \\rvert$，因此 $f_{\\mathrm{FLD}} = \\lambda(R)\\,R$。假设局部 $E = 1$（任意单位），$\\lvert \\nabla E \\rvert = 1$（相同单位每单位长度），以及 $\\kappa\\rho = 0.75$（长度的倒数），因此 $R$ 由这些数据精确确定。在 P1 和 FLD 中，取辐射压力为各向同性。\n\n哪个选项正确报告了在 $f=0.4$ 时 P1、FLD 和 $M1$ 的爱丁顿因子 $\\chi$，并指出了在这三种闭合关系中，哪一种在这种中度各向异性情况下最准确，以及正确的原因？\n\nA. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 0.416$；$M1$ 闭合最准确，因为它提供了一个可变的爱丁顿因子 $\\chi(f)$，与扩散（$\\chi \\to 1/3$）和自由流（$\\chi \\to 1$）之间的过渡一致。\n\nB. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} \\approx 0.300$，$\\chi_{\\mathrm{M1}} \\approx 0.440$；FLD 闭合最准确，因为 $\\lambda(R)$ 正确地限制了通量，从而决定了压力的各向异性。\n\nC. $\\chi_{\\mathrm{P1}} \\approx 0.400$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 1.000$；P1 闭合最准确，因为中度各向异性仍然意味着压力近似各向同性。\n\nD. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 0.367$；P1 和 FLD 闭合最准确，因为对于 $f=0.4$，$\\chi$ 应保持接近 $1/3$。", "solution": "**爱丁顿因子的推导**\n\n爱丁顿因子 $\\chi$ 将压力张量的分量与辐射能量密度联系起来。每种闭合关系对压力张量的先验假设直接决定了其爱丁顿因子。\n\n**1. P1 闭合**\nP1 闭合，也称为爱丁顿近似，其基本假设是辐射压力张量是各向同性的。这表示为：\n$$ \\mathsf{P}_{\\mathrm{P1}} = \\frac{1}{3} E \\mathsf{I} $$\n为了找到相应的爱丁顿因子 $\\chi_{\\mathrm{P1}}$，我们将其与问题中给出的一般参数化形式相等：\n$$ \\chi E \\hat{\\mathbf{n}}\\hat{\\mathbf{n}} + \\frac{1-\\chi}{2} E (\\mathsf{I} - \\hat{\\mathbf{n}}\\hat{\\mathbf{n}}) = \\frac{1}{3} E \\mathsf{I} $$\n两边除以 $E$ 并收集具有张量结构 $\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}$ 和 $\\mathsf{I}$ 的项：\n$$ \\left(\\chi - \\frac{1-\\chi}{2}\\right) \\hat{\\mathbf{n}}\\hat{\\mathbf{n}} = \\left(\\frac{1}{3} - \\frac{1-\\chi}{2}\\right) \\mathsf{I} $$\n$$ \\left(\\frac{3\\chi-1}{2}\\right) \\hat{\\mathbf{n}}\\hat{\\mathbf{n}} = \\left(\\frac{2 - 3 + 3\\chi}{6}\\right) \\mathsf{I} = \\left(\\frac{3\\chi-1}{6}\\right) \\mathsf{I} $$\n对于非零通量方向 $\\hat{\\mathbf{n}}$，这个等式必须成立。由于张量 $\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}$ 和 $\\mathsf{I}$ 是线性无关的，这要求两边的系数都为零。因此，$3\\chi-1=0$，这给出：\n$$ \\chi_{\\mathrm{P1}} = \\frac{1}{3} $$\n这个结果与约化通量 $f$ 无关。\n\n**2. FLD 闭合**\n问题中有一个对 FLD 模型的明确指示：“在 P1 和 FLD 中，取辐射压力为各向同性。”这意味着为了计算爱丁顿因子，本问题中的 FLD 模型使用了与 P1 闭合相同的压力张量：\n$$ \\mathsf{P}_{\\mathrm{FLD}} = \\frac{1}{3} E \\mathsf{I} $$\n遵循与 P1 相同的推导过程，我们发现爱丁顿因子也是一个常数：\n$$ \\chi_{\\mathrm{FLD}} = \\frac{1}{3} $$\n为 FLD 提供的其他信息（限制器、局部参数）用于确认问题设置的一致性。当 $R = \\lvert \\nabla E \\rvert/(\\kappa\\rho\\,E) = 1/(0.75 \\times 1) = 4/3$ 时，约化通量为 $f_{\\mathrm{FLD}} = \\lambda(R)R = \\coth(R) - 1/R = \\coth(4/3) - 3/4 \\approx 1.1485 - 0.75 \\approx 0.3985$，这与给定的条件 $f=0.4$ 一致。\n\n**3. M1 闭合**\n$M1$ 闭合是一个更复杂的模型，其中爱丁顿因子是约化通量 $f$ 的函数。该函数形式是通过在给定 $E$ 和 $\\mathbf{F}$ 的情况下最大化辐射场的熵来导出的。标准的 $M1$ 闭合关系是：\n$$ \\chi_{\\mathrm{M1}}(f) = \\frac{3 + 4f^2}{5 + 2\\sqrt{4 - 3f^2}} $$\n这个公式正确地在扩散极限（$f \\to 0, \\chi \\to 1/3$）和自由流极限（$f \\to 1, \\chi \\to 1$）之间进行插值。我们被要求在 $f = 0.4$ 处计算它：\n$$ f^2 = (0.4)^2 = 0.16 $$\n将此代入公式：\n$$ \\chi_{\\mathrm{M1}}(0.4) = \\frac{3 + 4(0.16)}{5 + 2\\sqrt{4 - 3(0.16)}} = \\frac{3 + 0.64}{5 + 2\\sqrt{4 - 0.48}} = \\frac{3.64}{5 + 2\\sqrt{3.52}} $$\n数值计算此表达式：\n$$ \\chi_{\\mathrm{M1}}(0.4) \\approx \\frac{3.64}{5 + 2(1.87617)} = \\frac{3.64}{5 + 3.75234} = \\frac{3.64}{8.75234} \\approx 0.41589 $$\n四舍五入到三位有效数字，我们得到：\n$$ \\chi_{\\mathrm{M1}} \\approx 0.416 $$\n\n**准确性比较**\n对于 $f=0.4$，三种闭合关系给出以下爱丁顿因子：\n- $\\chi_{\\mathrm{P1}} = 1/3 \\approx 0.333$\n- $\\chi_{\\mathrm{FLD}} = 1/3 \\approx 0.333$\n- $\\chi_{\\mathrm{M1}} \\approx 0.416$\n\n$f=0.4$ 的约化通量代表了一个中度各向异性的辐射场，它处于光学厚（扩散）和光学薄（自由流）之间的中间状态。\n- P1 和指定的 FLD 模型通过强制 $\\chi = 1/3$ 的方式，未能捕捉压力张量的各向异性。它们仅对近各向同性的辐射（$f \\ll 1$）准确。\n- $M1$ 闭合是专门为处理这种中间状态而设计的，它提供了一个可变的爱丁顿因子 $\\chi(f)$，随着辐射场变得更加各向异性，该因子从 $1/3$ 增加到 $1$。这正确地模拟了压力张量在通量方向上变得更加“扁平化”的物理行为。因此，在这三种选项中，$M1$ 闭合在这种中度各向异性情况下提供了对辐射压力的最准确描述。\n\n**逐项分析**\n\n- **A. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 0.416$；$M1$ 闭合最准确，因为它提供了一个可变的爱丁顿因子 $\\chi(f)$，与扩散（$\\chi \\to 1/3$）和自由流（$\\chi \\to 1$）之间的过渡一致。**\n  计算出的值 $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} = 1/3$ 和 $\\chi_{\\mathrm{M1}} \\approx 0.416$ 都是正确的。关于 $M1$ 闭合最准确的评估及其附带原因也是正确的。此选项 **正确**。\n\n- **B. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} \\approx 0.300$，$\\chi_{\\mathrm{M1}} \\approx 0.440$；FLD 闭合最准确，因为 $\\lambda(R)$ 正确地限制了通量，从而决定了压力的各向异性。**\n  $\\chi_{\\mathrm{FLD}}$ 的值不正确；问题指定使用各向同性压力，这使得 $\\chi_{\\mathrm{FLD}} = 1/3$。$\\chi_{\\mathrm{M1}}$ 的值也不正确。关于 FLD 对压力准确性的说法在这种情况下具有误导性。此选项 **不正确**。\n\n- **C. $\\chi_{\\mathrm{P1}} \\approx 0.400$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 1.000$；P1 闭合最准确，因为中度各向异性仍然意味着压力近似各向同性。**\n  $\\chi_{\\mathrm{P1}}$ 的值不正确；它恰好是 $1/3$。$\\chi_{\\mathrm{M1}}$ 的值也不正确；$\\chi=1$ 仅在自由流极限（$f=1$）下成立。声称 P1 最准确是不正确的。此选项 **不正确**。\n\n- **D. $\\chi_{\\mathrm{P1}} = 1/3$，$\\chi_{\\mathrm{FLD}} = 1/3$，$\\chi_{\\mathrm{M1}} \\approx 0.367$；P1 和 FLD 闭合最准确，因为对于 $f=0.4$，$\\chi$ 应保持接近 $1/3$。**\n  $\\chi_{\\mathrm{M1}}$ 的值不正确。断言 P1 和 FLD 对于 $f=0.4$ 最准确是不正确的；这种程度的各向异性需要一个可变的爱丁顿因子来保证准确性。此选项 **不正确**。", "answer": "$$\\boxed{A}$$", "id": "3522551"}, {"introduction": "理论模型的最终价值体现在其能否被转化为可执行的计算机代码，以模拟复杂的物理现象。本练习旨在将矩方法理论与数值实践联系起来，指导您为一维 M1 辐射输运方程组设计一个有限体积法离散格式。您将构建一个现代辐射流体动力学程序的核心部件——使用 Harten–Lax–van Leer–Einfeldt (HLLE) 近似黎曼求解器计算的数值通量，这是处理双曲型守恒律方程的基石技术。[@problem_id:3522592]", "problem": "你需要设计并实现一个用于双矩辐射输运系统的一维有限体积（Finite Volume (FV)）离散化方法，该系统采用最大熵（Maximum Entropy (M1)）闭合。该系统在空间坐标 $x$ 和时间 $t$ 上演化辐射能量密度 $E$ 和辐射通量 $F$，其中光速 $c$ 以及源项 $S_E$ 和 $S_{F,x}$ 已给定。包含源项的控制双曲系统为\n$$\n\\partial_t \\begin{pmatrix} E \\\\ F \\end{pmatrix}\n+ \\partial_x \\begin{pmatrix} F \\\\ c^2 P_{xx} \\end{pmatrix}\n= \\begin{pmatrix} c S_E \\\\ S_{F,x} \\end{pmatrix}.\n$$\n沿 $x$ 方向收缩的辐射压力张量为 $P_{xx}$，这需要一个闭合关系。在 M1 闭合中，我们引入了约化通量 $f$ 和 Eddington 因子 $\\chi$，后者由其与 $f$ 的函数依赖关系定义。在一维中，该闭合简化为 $P_{xx}=\\chi E$，其中方向性与 $F$ 的符号一致。约化通量定义为 $f=\\lvert F \\rvert/(c E)$，根据因果律满足 $0 \\le f \\le 1$，并且 $\\chi$ 必须满足 $\\chi(0)=1/3$（各向同性扩散极限）和 $\\chi(1)=1$（自由流极限）。该系统必须在网格单元大小为 $\\Delta x$、时间增量为 $\\Delta t$ 的均匀网格上离散化，并通过近似黎曼求解器（Approximate Riemann Solver, ARS）在网格单元界面处构造数值通量。你的离散化方法必须保证特征信号速度不超过光速 $c$。\n\n从辐射矩的传播速度受 $c$ 限制以及控制系统是具有两个特征场的双曲系统的基本出发点，你必须推导一个与这些界限一致的 ARS，并实现它以计算界面通量。一个合适的选择是将左右信号速度限定为 $s_L=-c$ 和 $s_R=+c$，从而产生一个两波 Harten–Lax–van Leer–Einfeldt (HLLE) 通量。从状态向量 $\\mathbf{Q}=(E,F)^\\top$ 和由 $(E,F)$ 计算出的闭合关系 $P_{xx}=\\chi E$ 出发，物理通量向量为 $\\mathcal{F}(\\mathbf{Q})=(F,\\,c^2 P_{xx})^\\top$。对于界面处给定的左右状态 $(E_L,F_L)$ 和 $(E_R,F_R)$，你的程序必须计算该界面处的 HLLE 数值通量向量 $\\hat{\\mathcal{F}}_{i+1/2}$。\n\n你必须从第一性原理出发：\n- 从辐射输运中的矩定义开始，其中 $E$ 和 $F$ 分别是比强度的零阶和一阶角矩，而 $P$ 是二阶矩。\n- 强制执行因果性约束 $0 \\le f \\le 1$，并推导与最大熵原理一致的 M1 Eddington 因子 $\\chi(f)$，恢复极限值 $\\chi(0)=1/3$ 和 $\\chi(1)=1$。\n- 论证一个 ARS，其信号速度 $s_L$ 和 $s_R$ 将所有特征值限制在 $\\pm c$ 范围内，并用它从左右物理通量和状态构造一个一致的数值通量。\n- 说明如何从 $(E,F)$ 和闭合关系计算 $P_{xx}$，以及 $\\hat{\\mathcal{F}}$ 如何通过 $\\chi(f)$ 依赖于 $(E,F)$。\n\n所有计算都必须使用国际单位制（SI）进行。你必须使用 $c=2.99792458\\times 10^{8}$，单位为 $\\mathrm{m/s}$，其中 $E$ 的单位为 $\\mathrm{J/m^3}$，$F$ 的单位为 $\\mathrm{J/(m^2\\,s)}$，$P_{xx}$ 的单位为 $\\mathrm{J/m^3}$，通量的第二个分量 $c^2 P_{xx}$ 的单位为 $\\mathrm{J/(m\\,s^2)}$。在这个一维问题中不出现角度。不应使用百分比。\n\n测试套件：\n为以下四种左右状态计算 HLLE 数值通量，每种状态以 $(E_L,F_L,E_R,F_R)$ 形式给出：\n- 情况1（各向同性极限）：$(E_L,F_L,E_R,F_R)=(1.0,\\,0.0,\\,1.0,\\,0.0)$。\n- 情况2（向右自由流）：$(E_L,F_L,E_R,F_R)=(1.0,\\,c,\\,0.5,\\,0.5c)$。\n- 情况3（等能量反向流）：$(E_L,F_L,E_R,F_R)=(1.0,\\,0.5c,\\,1.0,\\,-0.5c)$。\n- 情况4（近真空能量与单侧通量）：$(E_L,F_L,E_R,F_R)=(10^{-12},\\,0.0,\\,10^{-12},\\,c\\times 10^{-12})$。\n\n对每种情况，计算 HLLE 数值通量向量 $\\hat{\\mathcal{F}}$ 的两个分量：\n- 第一个分量是能量通量，单位为 $\\mathrm{J/(m^2\\,s)}$。\n- 第二个分量是 $c^2 P_{xx}$，单位为 $\\mathrm{J/(m\\,s^2)}$。\n\n最终输出格式：\n你的程序应产生单行输出，包含一个由逗号分隔的8个浮点数列表，排序为 $[\\hat{\\mathcal{F}}^{(1)}_1,\\hat{\\mathcal{F}}^{(2)}_1,\\hat{\\mathcal{F}}^{(1)}_2,\\hat{\\mathcal{F}}^{(2)}_2,\\hat{\\mathcal{F}}^{(1)}_3,\\hat{\\mathcal{F}}^{(2)}_3,\\hat{\\mathcal{F}}^{(1)}_4,\\hat{\\mathcal{F}}^{(2)}_4]$，其中上标表示通量分量，下标表示情况。例如，输出必须看起来像 $[x_1,y_1,x_2,y_2,x_3,y_3,x_4,y_4]$，没有空格，其中每个 $x_k$ 和 $y_k$ 是国际单位制下的浮点数。程序必须完全自包含，且不得读取任何输入。", "solution": "为了求解这个双曲系统，我们首先需要定义闭合关系，该关系将二阶矩，即辐射压力 $P_{xx}$，表示为演化矩 $E$ 和 $F$ 的函数。\n\n**辐射矩与M1闭合关系**\n\n辐射场的矩由比强度 $I$ 的角积分定义。在一维中，通过与x轴夹角的余弦 $\\mu \\in [-1, 1]$ 来参数化方向，前三个矩是：\n- 零阶矩（辐射能量密度）：$E = \\frac{2\\pi}{c} \\int_{-1}^{1} I(\\mu) d\\mu$\n- 一阶矩（辐射通量）：$F_x \\equiv F = 2\\pi \\int_{-1}^{1} \\mu I(\\mu) d\\mu$\n- 二阶矩（辐射压力）：$P_{xx} = \\frac{2\\pi}{c} \\int_{-1}^{1} \\mu^2 I(\\mu) d\\mu$\n\n该系统通过定义 $P_{xx}$ 与演化变量 $E$ 和 $F$ 之间的关系来闭合。M1 闭合模型通过假设比强度 $I$ 是使辐射熵最大化的那个来实现这一点，其约束条件是它能重现给定的 $E$ 和 $F$。这个过程导致了 Eddington 因子 $\\chi = P_{xx}/E$ 和约化通量 $f = |F|/(cE)$ 之间的唯一函数关系。约化通量受到因果律的物理约束，$0 \\le f \\le 1$。Eddington 因子必须满足已知的物理极限：各向同性扩散极限 $\\chi(0) = 1/3$ 和自由流极限 $\\chi(1) = 1$。\n\n对于三维各向同性系统（这在三维代码中很常用）的最大熵推导结果，给出了 Eddington 因子的以下表达式：\n$$\n\\chi(f) = \\frac{3 + 4f^2}{5 + 2\\sqrt{4 - 3f^2}}\n$$\n这个函数正确地重现了所需的极限。我们将使用这个函数从状态 $(E, F)$ 计算 $P_{xx} = \\chi(f) E$。\n\n**HLLE近似黎曼求解器**\n\n对于有限体积方法，我们需要在两个网格单元 $i$ 和 $i+1$（其状态分别为 $\\mathbf{Q}_L$ 和 $\\mathbf{Q}_R$）之间的界面处得到一个数值通量 $\\hat{\\mathcal{F}}_{i+1/2}$。HLLE 近似黎曼求解器基于对从界面发出的最小（$s_L$）和最大（$s_R$）特征信号速度的估计来提供这样一个通量。HLLE 通量的通用公式是：\n$$\n\\hat{\\mathcal{F}}_{\\text{HLLE}} = \\frac{s_R \\mathcal{F}(\\mathbf{Q}_L) - s_L \\mathcal{F}(\\mathbf{Q}_R) + s_L s_R (\\mathbf{Q}_R - \\mathbf{Q}_L)}{s_R - s_L}\n$$\n辐射矩方程的特征速度从根本上受光速 $c$ 的限制。因此，正如问题中所指定的，对于信号速度的估计，一个简单而稳健的选择是取最耗散的界限：$s_L = -c$ 和 $s_R = +c$。这被称为 HLLE-C 通量。\n\n将这些速度代入通用公式，我们得到：\n$$\n\\hat{\\mathcal{F}} = \\frac{c \\mathcal{F}_L - (-c) \\mathcal{F}_R + (-c)(c) (\\mathbf{Q}_R - \\mathbf{Q}_L)}{c - (-c)} = \\frac{c(\\mathcal{F}_L + \\mathcal{F}_R) - c^2(\\mathbf{Q}_R - \\mathbf{Q}_L)}{2c}\n$$\n这简化为：\n$$\n\\hat{\\mathcal{F}} = \\frac{1}{2}(\\mathcal{F}_L + \\mathcal{F}_R) - \\frac{c}{2}(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\n\n**计算算法**\n\n为了计算给定左状态 $\\mathbf{Q}_L = (E_L, F_L)^\\top$ 和右状态 $\\mathbf{Q}_R = (E_R, F_R)^\\top$ 的 HLLE 数值通量 $\\hat{\\mathcal{F}} = (\\hat{\\mathcal{F}}^{(1)}, \\hat{\\mathcal{F}}^{(2)})^\\top$，我们执行以下步骤：\n\n1.  **读取输入：** 输入是左状态 $(E_L, F_L)$ 和右状态 $(E_R, F_R)$，以及常数 $c = 2.99792458 \\times 10^8 \\, \\mathrm{m/s}$。\n\n2.  **计算约化通量：** 计算左右状态的约化通量。为确保在 E 非常小的情况下的数值稳定性，我们定义如果 $E=0$ 则 $f=0$。对于 $E>0$：\n    $$ f_L = \\frac{|F_L|}{c E_L}, \\quad f_R = \\frac{|F_R|}{c E_R} $$\n\n3.  **计算 Eddington 因子：** 使用 M1 闭合公式，计算每个状态的 Eddington 因子：\n    $$ \\chi_L = \\chi(f_L) = \\frac{3 + 4f_L^2}{5 + 2\\sqrt{4 - 3f_L^2}}, \\quad \\chi_R = \\chi(f_R) = \\frac{3 + 4f_R^2}{5 + 2\\sqrt{4 - 3f_R^2}} $$\n\n4.  **计算物理通量：** 构造物理通量向量 $\\mathcal{F}_L$ 和 $\\mathcal{F}_R$：\n    $$ P_{xx, L} = \\chi_L E_L, \\quad P_{xx, R} = \\chi_R E_R $$\n    $$ \\mathcal{F}_L = \\begin{pmatrix} F_L \\\\ c^2 P_{xx, L} \\end{pmatrix}, \\quad \\mathcal{F}_R = \\begin{pmatrix} F_R \\\\ c^2 P_{xx, R} \\end{pmatrix} $$\n\n5.  **计算 HLLE 通量分量：** 逐分量地应用简化的 HLLE 公式。\n    - 第一个分量（数值能量通量）：\n      $$ \\hat{\\mathcal{F}}^{(1)} = \\frac{1}{2}(F_L + F_R) - \\frac{c}{2}(E_R - E_L) $$\n    - 第二个分量（数值动量通量，使用 $P_{xx}$ 的定义）：\n      $$ \\hat{\\mathcal{F}}^{(2)} = \\frac{1}{2}(c^2 P_{xx, L} + c^2 P_{xx, R}) - \\frac{c}{2}(F_R - F_L) = \\frac{c^2}{2}(\\chi_L E_L + \\chi_R E_R) - \\frac{c}{2}(F_R - F_L) $$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the HLLE numerical flux for the 1D M1 radiation transport system\n    for a given set of test cases.\n    \"\"\"\n    # Define physical constants\n    c = 2.99792458e8  # Speed of light in m/s\n\n    # Define the test cases as a list of tuples: (E_L, F_L, E_R, F_R)\n    test_cases = [\n        # Case 1: Isotropic limit\n        (1.0, 0.0, 1.0, 0.0),\n        # Case 2: Free-streaming to the right\n        (1.0, c, 0.5, 0.5 * c),\n        # Case 3: Counter-streaming of equal energy\n        (1.0, 0.5 * c, 1.0, -0.5 * c),\n        # Case 4: Nearly vacuum energy with one-sided flux\n        (1e-12, 0.0, 1e-12, c * 1e-12),\n    ]\n\n    results = []\n\n    def get_reduced_flux(E, F, c_val):\n        \"\"\"Calculates the reduced flux f = |F|/(cE).\"\"\"\n        # A robust implementation handles E -> 0.\n        if E == 0:\n            # If energy density is zero, flux must also be zero.\n            return 0.0\n        f = abs(F) / (c_val * E)\n        # Clamp to 1.0 to handle potential floating point inaccuracies and enforce causality.\n        return min(f, 1.0)\n\n\n    def get_eddington_factor(f):\n        \"\"\"Calculates the M1 Eddington factor chi(f).\"\"\"\n        # The argument of the square root is 4 - 3f^2.\n        # Since 0 = f = 1, this is always >= 1.\n        numerator = 3.0 + 4.0 * f**2\n        denominator = 5.0 + 2.0 * np.sqrt(4.0 - 3.0 * f**2)\n        return numerator / denominator\n\n    for case in test_cases:\n        E_L, F_L, E_R, F_R = case\n        \n        # --- Left State ---\n        f_L = get_reduced_flux(E_L, F_L, c)\n        chi_L = get_eddington_factor(f_L)\n        Pxx_L = chi_L * E_L\n        \n        # --- Right State ---\n        f_R = get_reduced_flux(E_R, F_R, c)\n        chi_R = get_eddington_factor(f_R)\n        Pxx_R = chi_R * E_R\n\n        # --- Physical Fluxes ---\n        P_flux_L = c**2 * Pxx_L\n        P_flux_R = c**2 * Pxx_R\n        \n        # --- HLLE Numerical Flux (with s_L = -c, s_R = +c) ---\n        # Formula: flux_hat = 0.5*(flux_L + flux_R) - 0.5*c*(Q_R - Q_L)\n        \n        # Component 1: Energy flux\n        flux1 = 0.5 * (F_L + F_R) + 0.5 * c * (E_L - E_R)\n        \n        # Component 2: Momentum flux\n        flux2 = 0.5 * (P_flux_L + P_flux_R) + 0.5 * c * (F_L - F_R)\n\n        results.extend([flux1, flux2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3522592"}]}