{"hands_on_practices": [{"introduction": "在自引力气体模拟中，最基本的加密判据是耶斯判据，它确保了引力不稳定的物理尺度能够被充分解析，从而避免伪碎裂（artificial fragmentation）。本练习将指导你如何应用该判据来计算一个给定的自适应网格加密（AMR）模拟所能解析的最大物理密度[@problem_id:3532043]。这个计算对于设置模拟参数（例如“星子”粒子 (sink particle) 的生成密度阈值）至关重要，它直接将数值分辨率与可模拟的物理过程联系起来。", "problem": "一个自引力恒星形成气体的自适应网格加密（AMR）模拟使用基于耶斯长度的加密判据来防止人为碎裂，同时还使用一个激波捕捉判据，在出现强压缩跳跃的地方进行加密。考虑一个温度为 $T$、平均分子量为 $\\mu$ 的等温均匀介质，其中气体遵循等温声速的理想气体关系。该 AMR 代码对每个局域耶斯长度强制要求 $N_{\\rm target}$ 个网格单元进行加密，其最高加密等级达到最小网格间距 $\\Delta x_{\\min}$。为避免未解析的引力坍缩，一旦密度超过一个阈值，就要创建汇集粒子，该阈值被选为最精细层级上能被耶斯长度判据解析的最大密度的 $\\alpha$ 倍。\n\n从均匀、等温、自引力介质的线性色散关系出发：\n$$\\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho,$$\n其中 $c_{s}$ 是等温声速，$\\rho$ 是质量密度，$G$ 是引力常数，$k$ 是波数。推导在临界稳定性时的临界波数 $k_{J}$ 和相应的耶斯长度 $\\lambda_{J}$。然后，利用 AMR 约束条件，即在最精细层级上，耶斯长度必须由至少 $N_{\\rm target}$ 个网格单元解析，即\n$$\\Delta x_{\\min} \\le \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}},$$\n求解最大可解析密度 $\\rho_{\\max}$，用 $c_{s}$、$G$、$N_{\\rm target}$ 和 $\\Delta x_{\\min}$ 表示。最后，使用以下参数计算汇集粒子产生密度 $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$：\n- $T = 10\\,\\mathrm{K}$，\n- $\\mu = 2.33$，\n- $N_{\\rm target} = 32$，\n- $\\Delta x_{\\min} = 1\\,\\mathrm{AU}$，\n- $\\alpha = 4$。\n\n使用以下基本常数：\n- $k_{B} = 1.380649\\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}}$，\n- $m_{H} = 1.6735575\\times 10^{-24}\\,\\mathrm{g}$，\n- $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$，\n以及单位换算：\n- $1\\,\\mathrm{AU} = 1.495978707\\times 10^{13}\\,\\mathrm{cm}$。\n\n假设等温声速由理想气体关系 $c_{s}=\\sqrt{k_{B}T/(\\mu m_{H})}$ 给出。将汇集粒子产生密度的最终答案以 $\\mathrm{g\\,cm^{-3}}$ 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "首先，将对问题陈述的科学合理性、完整性和清晰度进行验证。\n\n### 步骤1：提取给定条件\n- **色散关系：** $\\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho$，其中 $\\omega$ 是角频率，$c_s$ 是等温声速，$k$ 是波数，$G$ 是引力常数，$\\rho$ 是质量密度。\n- **AMR 加密判据：** $\\Delta x_{\\min} \\le \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}}$，其中 $\\Delta x_{\\min}$ 是最小网格间距，$\\lambda_{J}(\\rho_{\\max})$ 是在最大可解析密度 $\\rho_{\\max}$ 下计算的耶斯长度，$N_{\\rm target}$ 是每个耶斯长度的目标网格数。\n- **等温声速：** $c_{s}=\\sqrt{k_{B}T/(\\mu m_{H})}$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\mu$ 是平均分子量，$m_H$ 是氢原子质量。\n- **汇集粒子产生密度：** $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$，其中 $\\alpha$ 是一个常数因子。\n- **参数：**\n    - 温度，$T = 10\\,\\mathrm{K}$\n    - 平均分子量，$\\mu = 2.33$\n    - 每个耶斯长度的目标网格数，$N_{\\rm target} = 32$\n    - 最小网格间距，$\\Delta x_{\\min} = 1\\,\\mathrm{AU}$\n    - 汇集粒子密度因子，$\\alpha = 4$\n- **常数：**\n    - 玻尔兹曼常数，$k_{B} = 1.380649\\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}}$\n    - 氢原子质量，$m_{H} = 1.6735575\\times 10^{-24}\\,\\mathrm{g}$\n    - 引力常数，$G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$\n- **单位换算：** $1\\,\\mathrm{AU} = 1.495978707\\times 10^{13}\\,\\mathrm{cm}$\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估。\n- **有科学依据：** 该问题牢固地植根于引力不稳定性（耶斯不稳定性）和计算天体物理学的原理。色散关系是均匀、等温、自引力介质的标准关系。解析耶斯长度的概念是引力坍缩模拟中防止人为碎裂的基本要求。使用汇集粒子是此类模拟中的标准技术。所有概念都具有科学依据。\n- **提法明确：** 所有必要的参数、常数和控制方程均已提供。任务是推导一系列量并计算最终值，这是一个明确定义的数学过程。预期会有一个唯一的、稳定的解。\n- **客观性：** 问题陈述使用精确、定量的语言。没有主观或基于观点的陈述。\n- **完整性和一致性：** 问题是自洽的，并提供了计算所需的所有信息。单位已指定，物理设置是一致的。\n- **真实性：** 给定的参数值（$T = 10\\,\\mathrm{K}$，$\\mu = 2.33$ 等）对于致密的分子云核（一个典型的恒星形成场所）是物理上真实的。加密判据和汇集粒子处方是该领域的标准。\n\n该问题没有表现出验证清单中列出的任何缺陷，例如科学不合理、模糊或矛盾。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。现在将提供一个完整的、有理有据的解答。\n\n推导从给定的均匀、等温、自引力介质的色散关系开始：\n$$ \\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho $$\n当扰动能够增长时，引力不稳定性发生，这对应于 $\\omega^2  0$。临界情况，即临界稳定性，是当 $\\omega^2 = 0$ 时。发生这种情况时的波数是耶斯波数，$k_J$。\n$$ 0 = c_{s}^{2} k_{J}^{2} - 4\\pi G \\rho $$\n$$ c_{s}^{2} k_{J}^{2} = 4\\pi G \\rho $$\n求解 $k_J^2$ 然后求解 $k_J$ 可得：\n$$ k_{J}^{2} = \\frac{4\\pi G \\rho}{c_{s}^{2}} \\implies k_{J} = \\sqrt{\\frac{4\\pi G \\rho}{c_{s}^{2}}} = \\frac{\\sqrt{4\\pi G \\rho}}{c_{s}} $$\n波数 $k  k_J$ 的扰动是不稳定的。\n\n耶斯长度 $\\lambda_J$ 是对应于耶斯波数的波长，定义为 $\\lambda_J = 2\\pi/k_J$。代入 $k_J$ 的表达式：\n$$ \\lambda_J = \\frac{2\\pi}{k_J} = 2\\pi \\frac{c_s}{\\sqrt{4\\pi G \\rho}} = \\frac{2\\pi c_s}{2\\sqrt{\\pi G \\rho}} = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\n\nAMR 模拟必须解析局域耶斯长度。条件是，在最大可解析密度下的耶斯长度 $\\lambda_J(\\rho_{\\max})$ 必须由至少 $N_{\\rm target}$ 个大小为 $\\Delta x_{\\min}$ 的网格单元跨越。极限情况由等式给出：\n$$ \\Delta x_{\\min} = \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}} \\implies N_{\\rm target} \\Delta x_{\\min} = \\lambda_{J}(\\rho_{\\max}) $$\n这说明在最高密度下的耶斯长度在最精细的网格上恰好由 $N_{\\rm target}$ 个网格单元解析。我们代入在 $\\rho = \\rho_{\\max}$ 处求值的 $\\lambda_J$ 的表达式：\n$$ N_{\\rm target} \\Delta x_{\\min} = c_s \\sqrt{\\frac{\\pi}{G\\rho_{\\max}}} $$\n为了求出最大可解析密度 $\\rho_{\\max}$，我们对此方程求解。首先，我们将两边平方：\n$$ (N_{\\rm target} \\Delta x_{\\min})^2 = c_s^2 \\frac{\\pi}{G\\rho_{\\max}} $$\n整理以分离出 $\\rho_{\\max}$：\n$$ \\rho_{\\max} = \\frac{\\pi c_s^2}{G (N_{\\rm target} \\Delta x_{\\min})^2} = \\frac{\\pi}{G} \\left( \\frac{c_s}{N_{\\rm target} \\Delta x_{\\min}} \\right)^2 $$\n汇集粒子产生密度定义为 $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$。因此，$\\rho_{\\rm sink}$ 的最终符号表达式为：\n$$ \\rho_{\\rm sink} = \\alpha \\frac{\\pi}{G} \\left( \\frac{c_s}{N_{\\rm target} \\Delta x_{\\min}} \\right)^2 $$\n为了计算数值，我们首先使用给定的参数和常数计算等温声速的平方 $c_s^2$。所有单位都必须转换为一个一致的单位制，在此情况下为 CGS（厘米-克-秒）制。\n\n声速由 $c_s = \\sqrt{k_B T / (\\mu m_H)}$ 给出。我们计算 $c_s^2$：\n- $T = 10\\,\\mathrm{K}$\n- $\\mu = 2.33$\n- $k_B = 1.380649 \\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}} = 1.380649 \\times 10^{-16}\\,\\mathrm{g\\,cm^2\\,s^{-2}\\,K^{-1}}$\n- $m_H = 1.6735575 \\times 10^{-24}\\,\\mathrm{g}$\n$$ c_s^2 = \\frac{k_B T}{\\mu m_H} = \\frac{(1.380649 \\times 10^{-16}\\,\\mathrm{g\\,cm^2\\,s^{-2}\\,K^{-1}}) (10\\,\\mathrm{K})}{(2.33)(1.6735575 \\times 10^{-24}\\,\\mathrm{g})} $$\n$$ c_s^2 = \\frac{1.380649 \\times 10^{-15}}{3.900189975 \\times 10^{-24}}\\,\\mathrm{cm^2\\,s^{-2}} \\approx 3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}} $$\n\n接下来，我们以 CGS 单位整合用于计算 $\\rho_{\\rm sink}$ 的其他项：\n- $\\alpha = 4$\n- $G = 6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$\n- $N_{\\rm target} = 32$\n- $\\Delta x_{\\min} = 1\\,\\mathrm{AU} = 1.495978707 \\times 10^{13}\\,\\mathrm{cm}$\n\n现在，我们将这些数值代入 $\\rho_{\\rm sink}$ 的表达式中：\n$$ \\rho_{\\rm sink} = (4) \\frac{\\pi}{6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}} \\left( \\frac{\\sqrt{3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}}}}{(32)(1.495978707 \\times 10^{13}\\,\\mathrm{cm})} \\right)^2 $$\n使用带有 $c_s^2$ 的表达式更简单：\n$$ \\rho_{\\rm sink} = \\frac{4\\pi c_s^2}{G (N_{\\rm target} \\Delta x_{\\min})^2} $$\n让我们先计算分母：\n$$ (N_{\\rm target} \\Delta x_{\\min})^2 = \\left( 32 \\times 1.495978707 \\times 10^{13}\\,\\mathrm{cm} \\right)^2 $$\n$$ (4.7871318624 \\times 10^{14}\\,\\mathrm{cm})^2 \\approx 2.2916616 \\times 10^{29}\\,\\mathrm{cm^2} $$\n现在，完整的表达式为：\n$$ \\rho_{\\rm sink} = \\frac{4\\pi (3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}})}{(6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}) (2.2916616 \\times 10^{29}\\,\\mathrm{cm^2})} $$\n$$ \\rho_{\\rm sink} = \\frac{4.4484051 \\times 10^9\\,\\mathrm{cm^2\\,s^{-2}}}{1.5292833 \\times 10^{22}\\,\\mathrm{cm^5\\,g^{-1}\\,s^{-2}}} $$\n$$ \\rho_{\\rm sink} \\approx 2.90884 \\times 10^{-13}\\,\\mathrm{g\\,cm^{-3}} $$\n按要求，将结果四舍五入到四位有效数字，得到：\n$$ \\rho_{\\rm sink} \\approx 2.909 \\times 10^{-13}\\,\\mathrm{g\\,cm^{-3}} $$", "answer": "$$\\boxed{2.909 \\times 10^{-13}}$$", "id": "3532043"}, {"introduction": "在等温假设的基础上，本练习将探讨气体的热力学性质如何影响加密策略。我们使用一个更普适的正压状态方程 $p = K \\rho^{\\gamma}$ 来模拟气体，并分析耶斯长度如何随之改变[@problem_id:3532050]。本练习旨在挑战你分析在不同物理情境下（例如等温气体 $\\gamma=1$ 与硬状态方程气体 $\\gamma1$），耶斯判据和激波捕捉判据的相对重要性，从而加深对加密背后物理原理的直观理解。", "problem": "一个球对称坍缩分子核的自适应网格加密（AMR）模拟使用了两种加密触发器：一个耶斯长度触发器和一个激波传感器。气体遵循正压状态方程（EOS）$p = K \\rho^{\\gamma}$，其中 $p$ 是压力，$\\rho$ 是质量密度，$K$ 是一个常数，$\\gamma$ 是正压指数。耶斯长度触发器在每个局域耶斯长度内强制要求有 $N_J$ 个单元格，而激波传感器则标记出局域上游马赫数 $M_1 \\ge M_{\\mathrm{thr}}$ 的区域，并强制在激波处立即进行加密。假设一个初始均匀的核，其半径为 $R$，基础网格间距为 $\\Delta x_0 = R/N_{\\mathrm{base}}$，初始密度为 $\\rho_*$。对于等温（$\\gamma = 1$）和硬（$\\gamma  1$）两种情况，常数 $K$ 的选择使得在密度为 $\\rho_*$ 时的声速等于一个固定值 $c_{s,*}$，即对于一般的 $\\gamma$，有 $c_s^2(\\rho) = \\partial p/\\partial \\rho$ 在 $\\rho_*$ 处的值等于 $c_{s,*}^2$。你可以取 $R = 0.1\\,\\mathrm{pc}$，$N_{\\mathrm{base}} = 64$，$\\rho_* = 10^{-18}\\,\\mathrm{g\\,cm^{-3}}$，$c_{s,*} = 2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}$，$G = 6.674\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$，$N_J = 8$ 以及 $M_{\\mathrm{thr}} = 2$。在等温情况和一个 $\\gamma = 1.4$ 的硬状态方程情况下，考虑一个马赫数为 $M_1 = 5$ 的激波前入流。\n\n从第一性原理出发——即均匀介质的线性引力稳定性以及跨激波的守恒定律——分析正压状态方程如何改变局域耶斯长度，以及激波如何通过压缩改变它。然后，确定在何种条件下，基于激波的加密会在耶斯长度判据之前触发，以及对于给定的参数，这如何依赖于 $\\gamma$ 和 $M_1$。选择正确的陈述：\n\nA. 在等温情况 $\\gamma = 1$ 且 $M_1 = 5$ 时，激波后的耶斯长度相对于激波前的值减小了一个等于 $M_1$ 的因子。对于给定的基础网格，耶斯判据初始时是满足的，但在激波后立即被违反；因此，激波传感器是第一个被激活的触发器。\n\nB. 在硬状态方程情况 $\\gamma = 1.4$ 且 $M_1 = 5$ 时，激波后的耶斯长度减少的因子 $1/\\sqrt{r}$ 与等温情况相同，其中 $r$ 是压缩比，因此耶斯长度触发器是在激波处更严格的加密约束。\n\nC. 对于任何 $\\gamma \\ge 2$ 的正压状态方程，压缩会增加（或在 $\\gamma = 2$ 时保持不变）局域耶斯长度，这意味着对于任何 $M_1  1$，在激波位置，基于激波的加密必然主导基于耶斯长度的触发器。\n\nD. 对于任何 $\\gamma  1$，激波压缩总是使耶斯长度减小一个恰好等于 $1/M_1$ 的因子，因此在激波主导的区域，耶斯长度触发器总是比激波传感器更严格。", "solution": "该问题要求分析自适应网格加密（AMR）模拟中的两个加密判据：耶斯长度触发器和激波传感器。我们必须确定在由正压状态方程 $p = K \\rho^{\\gamma}$ 控制的不同物理条件下，它们之间的相互作用。\n\n**1. 第一性原理与通用公式**\n\n分析必须从关键物理量和判据的定义开始。\n\n**耶斯长度：** 耶斯长度 $\\lambda_J$ 代表了自引力流体中引力不稳定性的临界尺度。它是通过对流体方程进行线性微扰分析得出的，平衡了压力支持和引力坍缩。标准公式为：\n$$ \\lambda_J = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\n其中 $c_s$ 是声速，$\\rho$ 是质量密度，$G$ 是引力常数。\n\n**声速：** 状态方程（EOS）给出为 $p = K \\rho^{\\gamma}$。声速的平方定义为 $c_s^2 = \\frac{\\partial p}{\\partial \\rho}$。对于给定的正压状态方程，这得出：\n$$ c_s^2 = \\frac{\\partial}{\\partial \\rho}(K \\rho^{\\gamma}) = K \\gamma \\rho^{\\gamma-1} $$\n常数 $K$ 由初始密度 $\\rho_*$ 处的声速为 $c_{s,*}$ 的条件设定。因此，$c_{s,*}^2 = K \\gamma \\rho_*^{\\gamma-1}$，这使我们能够确定 $K = \\frac{c_{s,*}^2}{\\gamma \\rho_*^{\\gamma-1}}$。将此代回到 $c_s^2$ 的表达式中，我们可以用初始状态表示任意密度 $\\rho$ 处的声速：\n$$ c_s^2(\\rho) = \\left(\\frac{c_{s,*}^2}{\\gamma \\rho_*^{\\gamma-1}}\\right) \\gamma \\rho^{\\gamma-1} = c_{s,*}^2 \\left(\\frac{\\rho}{\\rho_*}\\right)^{\\gamma-1} $$\n$$ c_s(\\rho) = c_{s,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} $$\n\n**作为密度函数的耶斯长度：** 我们现在可以将耶斯长度完全写成密度 $\\rho$ 和初始状态参数的函数：\n$$ \\lambda_J(\\rho) = c_{s,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} \\sqrt{\\frac{\\pi}{G\\rho}} = c_{s,*} \\sqrt{\\frac{\\pi}{G\\rho_*}} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} \\left(\\frac{\\rho}{\\rho_*}\\right)^{-1/2} $$\n将初始耶斯长度定义为 $\\lambda_{J,*} = c_{s,*} \\sqrt{\\frac{\\pi}{G\\rho_*}}$，表达式简化为：\n$$ \\lambda_J(\\rho) = \\lambda_{J,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-2)/2} $$\n这个方程是分析的核心，因为它显示了对于给定的正压指数 $\\gamma$，耶斯长度如何随密度变化。\n\n**激波跳跃条件：** 跨过激波阵面，质量和动量必须守恒。让下标 $1$ 表示激波前（上游）状态，下标 $2$ 表示激波后（下游）状态。在激波参考系中，正压流体的朗肯-雨贡纽条件是：\n1.  质量守恒：$\\rho_1 v_1 = \\rho_2 v_2$\n2.  动量守恒：$p_1 + \\rho_1 v_1^2 = p_2 + \\rho_2 v_2^2$\n\n设压缩比为 $r = \\rho_2/\\rho_1$。从质量守恒得出 $v_2 = v_1/r$。动量方程变为：\n$$ p_1 + \\rho_1 v_1^2 = p_1 r^{\\gamma} + (\\rho_1 r) (v_1/r)^2 = p_1 r^{\\gamma} + \\frac{\\rho_1 v_1^2}{r} $$\n重新整理得到 $\\rho_1 v_1^2 (1 - 1/r) = p_1 (r^{\\gamma} - 1)$。上游马赫数是 $M_1 = v_1/c_{s,1}$。由于 $c_{s,1}^2 = \\gamma p_1/\\rho_1$，我们有 $\\rho_1 v_1^2 = \\gamma M_1^2 p_1$。代入此式，我们得到：\n$$ \\gamma M_1^2 p_1 \\left(\\frac{r-1}{r}\\right) = p_1 (r^{\\gamma} - 1) $$\n假设 $p_1 \\neq 0$，我们得到正压激波跳跃关系：\n$$ \\gamma M_1^2 \\frac{r-1}{r} = r^{\\gamma} - 1 $$\n对于 $\\gamma1$，如果状态方程代表总能量（即，它是一个绝热关系），这等同于标准结果 $r = \\frac{(\\gamma+1)M_1^2}{2 + (\\gamma-1)M_1^2}$。\n\n**加密判据：**\n1.  **耶斯长度触发器：** 如果每个耶斯长度内的单元格数量降到 $N_J$ 以下，则需要加密。对于局域单元格尺寸 $\\Delta x$，该条件为 $\\frac{\\lambda_J}{\\Delta x}  N_J$，或 $\\lambda_J  N_J \\Delta x$。\n2.  **激波传感器：** 如果上游马赫数 $M_1 \\ge M_{\\mathrm{thr}}$，则触发加密。\n\n**2. 选项分析**\n\n我们现在根据推导出的原理和给定的参数来评估每个陈述：$R = 0.1\\,\\mathrm{pc}$，$N_{\\mathrm{base}} = 64$，$\\rho_* = 10^{-18}\\,\\mathrm{g\\,cm^{-3}}$，$c_{s,*} = 2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}$，$G = 6.674\\times 10^{-8}\\,\\mathrm{cgs}$，$N_J = 8$，$M_{\\mathrm{thr}} = 2$。\n\n首先，我们计算初始状态：\n-   初始耶斯长度：$\\lambda_{J,*} = (2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}) \\sqrt{\\frac{\\pi}{(6.674\\times 10^{-8})(10^{-18})\\,\\mathrm{cgs}}} \\approx 1.37 \\times 10^{17}\\,\\mathrm{cm}$。\n-   基础网格间距：$\\Delta x_0 = \\frac{R}{N_{\\mathrm{base}}} = \\frac{0.1 \\times 3.086 \\times 10^{18}\\,\\mathrm{cm}}{64} \\approx 4.82 \\times 10^{15}\\,\\mathrm{cm}$。\n-   初始耶斯长度解析度：$\\frac{\\lambda_{J,*}}{\\Delta x_0} \\approx \\frac{1.37 \\times 10^{17}\\,\\mathrm{cm}}{4.82 \\times 10^{15}\\,\\mathrm{cm}} \\approx 28.4$。\n由于 $28.4  N_J = 8$，耶斯长度判据初始是满足的。\n\n**A. 在等温情况 $\\gamma = 1$ 且 $M_1 = 5$ 时，激波后的耶斯长度相对于激波前的值减小了一个等于 $M_1$ 的因子。对于给定的基础网格，耶斯判据初始时是满足的，但在激波后立即被违反；因此，激波传感器是第一个被激活的触发器。**\n\n- **$\\gamma = 1$（等温）情况分析：**\n    - 标度律给出 $\\lambda_J(\\rho) = \\lambda_{J,*} (\\rho/\\rho_*)^{-1/2} \\propto \\rho^{-1/2}$。\n    - 对于 $\\gamma=1$，跳跃关系 $\\gamma M_1^2 \\frac{r-1}{r} = r^{\\gamma} - 1$ 变为 $1 \\cdot M_1^2 \\frac{r-1}{r} = r-1$。对于激波（$r \\ne 1$），这简化为 $M_1^2/r=1$，所以 $r = M_1^2$。密度增加了马赫数的平方倍。\n    - 激波后的耶斯长度 $\\lambda_{J,2}$ 相对于激波前的长度 $\\lambda_{J,1}$ 为：\n      $ \\frac{\\lambda_{J,2}}{\\lambda_{J,1}} = \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{(\\gamma-2)/2} = r^{(1-2)/2} = r^{-1/2} = (M_1^2)^{-1/2} = \\frac{1}{M_1} $。\n    - 当 $M_1 = 5$ 时，激波后的耶斯长度减小了 5 倍。陈述的第一部分是正确的。\n- **使用给定参数进行验证：**\n    - 耶斯长度判据初始时是满足的（$28.4  8$）。\n    - 假设激波前状态为初始状态，所以 $\\lambda_{J,1} = \\lambda_{J,*}$ 且网格分辨率为 $\\Delta x_0$。\n    - 激波传感器会触发，因为 $M_1 = 5  M_{\\mathrm{thr}} = 2$。\n    - 在未加密的网格上，激波后的分辨率为 $\\frac{\\lambda_{J,2}}{\\Delta x_0} = \\frac{\\lambda_{J,1}/M_1}{\\Delta x_0} = \\frac{28.4}{5} \\approx 5.68$。\n    - 由于 $5.68  N_J=8$，耶斯长度判据现在被违反了。\n    - 马赫数为 $M_1 = 5$ 的激波事件直接触发了激波传感器。同一事件引起的密度跳跃导致了对耶斯长度判据的违反。从因果关系上看，激波是主要事件，激波传感器是其直接探测器。耶斯长度判据的违反是一个后果。因此，说激波传感器是第一个或主要的触发器是恰当的。\n- **结论：** **正确**。\n\n**B. 在硬状态方程情况 $\\gamma = 1.4$ 且 $M_1 = 5$ 时，激波后的耶斯长度减少的因子 $1/\\sqrt{r}$ 与等温情况相同，其中 $r$ 是压缩比，因此耶斯长度触发器是在激波处更严格的加密约束。**\n\n- **$\\gamma=1.4$ 情况分析：**\n    - 耶斯长度的减小因子为 $r^{(\\gamma-2)/2} = r^{(1.4-2)/2} = r^{-0.3}$。\n    - 陈述声称这个因子是 $1/\\sqrt{r} = r^{-0.5}$。这仅在 $\\gamma=1$ 时成立。对于 $\\gamma=1.4$，该声称是错误的。第一部分不正确。\n    - 无论如何我们还是来检查结论。对于 $\\gamma=1.4$ 和 $M_1=5$，压缩比（使用绝热公式）为：\n      $r = \\frac{(1.4+1)5^2}{2+(1.4-1)5^2} = \\frac{2.4 \\times 25}{2 + 0.4 \\times 25} = \\frac{60}{12} = 5$。\n    - 激波后的分辨率为 $\\frac{\\lambda_{J,2}}{\\Delta x_0} = \\frac{\\lambda_{J,1}}{\\Delta x_0} r^{-0.3} \\approx 28.4 \\times 5^{-0.3} \\approx 28.4 \\times 0.619 \\approx 17.58$。\n    - 由于 $17.58  N_J=8$，耶斯长度判据**没有**被违反。\n    - 激波传感器触发（$M_1=5  2$），但耶斯长度触发器没有触发。因此，耶斯长度触发器并非更严格；事实上，它根本没有被激活。\n- **结论：** **错误**。\n\n**C. 对于任何 $\\gamma \\ge 2$ 的正压状态方程，压缩会增加（或在 $\\gamma = 2$ 时保持不变）局域耶斯长度，这意味着对于任何 $M_1  1$，在激波位置，基于激波的加密必然主导基于耶斯长度的触发器。**\n\n- **$\\gamma \\ge 2$ 情况分析：**\n    - 标度律为 $\\lambda_J \\propto \\rho^{(\\gamma-2)/2}$。\n    - 如果 $\\gamma  2$，指数为正，所以当密度 $\\rho$ 增加时，$\\lambda_J$ 也增加。\n    - 如果 $\\gamma = 2$，指数为零，所以 $\\lambda_J$ 与密度无关。\n    - 激波总是引起压缩（$\\rho_2  \\rho_1$）。因此，对于任何激波，激波后的耶斯长度 $\\lambda_{J,2}$ 将大于或等于激波前的长度 $\\lambda_{J,1}$。\n    - 如果耶斯长度判据在激波前是满足的（$\\lambda_{J,1} / \\Delta x \\ge N_J$），那么在激波后它必定仍然是满足的（$\\lambda_{J,2} / \\Delta x \\ge \\lambda_{J,1} / \\Delta x \\ge N_J$）。\n    - 这意味着对于 $\\gamma \\ge 2$，激波永远不会导致耶斯长度判据被违反。因此，激波位置的加密只能由激波传感器触发（如果 $M_1 \\ge M_{\\mathrm{thr}}$）。从这个意义上说，基于激波的触发器“占主导地位”，因为它是两者中唯一可能在激波处激活的。\n- **结论：** **正确**。\n\n**D. 对于任何 $\\gamma  1$，激波压缩总是使耶斯长度减小一个恰好等于 $1/M_1$ 的因子，因此在激波主导的区域，耶斯长度触发器总是比激波传感器更严格。**\n\n- **分析：**\n    - 减小因子是 $r^{(\\gamma-2)/2}$。该陈述声称这个因子总是 $1/M_1$。我们已经证明这仅在 $\\gamma=1$ 的特殊情况下成立。对于我们的 $\\gamma=1.4, M_1=5$ 的情况，因子是 $r^{-0.3} = 5^{-0.3} \\approx 1/1.62$，而 $1/M_1 = 1/5$。它们不相等。陈述的第一部分是错误的。\n    - “因此在激波主导的区域，耶斯长度触发器总是比激波传感器更严格”的结论也是错误的。正如在对选项 B 的分析中所示（对于 $\\gamma=1.4$），耶斯长度触发器根本没有被激活，而激波传感器被激活了。\n- **结论：** **错误**。\n\n**结论**\n基于第一性原理的推导，陈述 A 和 C 是正确的，而 B 和 D 是错误的。", "answer": "$$\\boxed{AC}$$", "id": "3532050"}, {"introduction": "最后的这项实践将从分析转向综合应用。它将引导你设计并实现一个稳健的混合加密算法，该算法结合了基于物理原理的激波探测器和必不可少的耶斯判据[@problem_id:3532010]。本练习的重点是基于时间尺度比较和激波跳跃物理来创建一个激波触发器，为实际的 AMR 代码提供一个实用的算法模板。", "problem": "您的任务是为可压缩流体动力学中的自适应网格加密（AMR）设计并实现一个算法加密准则，该准则需要平衡对激波的加密与对不产生强跳跃的湍流压缩的加密，同时通过耶斯长度（Jeans length）来确保引力坍缩的解析度。请在一维空间中进行，并假设气体为量热完全气体。单元的加密决策必须基于一个由守恒律推理得出的激波/压缩探测器和一个由耶斯判据（Jeans criterion）得出的引力稳定性探测器的组合。\n\n从以下基本基础出发：\n\n- 质量守恒意味着，对于速度为 $v(x,t)$ 的一维流，体积压缩率为 $-\\nabla\\cdot\\mathbf{v} = -\\partial v/\\partial x$。压缩时间尺度为 $ \\tau_{\\mathrm{comp}} = 1/|\\nabla\\cdot\\mathbf{v}| $。\n- 声波穿过宽度为 $\\Delta x$ 的计算单元所需的时间为 $ \\tau_s = \\Delta x / c_s $，其中声速由 $ c_s = \\sqrt{\\gamma p/\\rho} $ 给出，$\\gamma$ 为绝热指数，$p$ 为压强，$\\rho$ 为质量密度。\n- 定义归一化压缩率 $ C = -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s $，它比较了压缩时间尺度与单元的声学时间。\n- 对于完全气体中的平面正激波，朗肯-雨贡纽关系（Rankine–Hugoniot relations）表明密度跳跃 $ r = \\rho_2/\\rho_1 $ 取决于上游马赫数 $ M_1 $，即 $ r(M_1,\\gamma) = \\dfrac{(\\gamma+1) M_1^2}{(\\gamma-1) M_1^2 + 2} $。一个具有物理意义的激波探测器应避免仅因产生可忽略跳跃的温和压缩而进行加密；一种形式化的方法是强制执行一个最小跳跃因子 $ r_{\\min}  1 $。\n- 自引力气体的耶斯长度为 $ \\lambda_J = c_s \\sqrt{\\pi/(G \\rho)} $，其中 $G$ 是引力常数。一个常见的分辨率规定是要求每个耶斯长度内至少有 $N_J$ 个单元，即如果 $ \\lambda_J  N_J \\Delta x $ 则进行加密。\n\n您的推导任务：\n\n1. 仅使用上述定义和第一性原理，通过结合 $ C $、马赫数 $ M = |v|/c_s $ 和最小密度跳跃要求 $ r_{\\min} $，推导出一个有原则的激波/压缩加密阈值。解释为什么时间尺度平衡会引出一个关于 $ C $ 的阈值，并根据朗肯-雨贡纽关系推导出使跳跃 $ r \\ge r_{\\min} $ 成立的马赫数下界 $ M_{\\min}(r_{\\min},\\gamma) $。\n\n2. 将此激波/压缩判据与耶斯长度判据相结合，使得一个单元当且仅当满足以下至少一个条件时被标记为需要加密：\n   - 流动是汇聚的，即 $ \\nabla\\cdot\\mathbf{v}  0 $，并且您推导出的激波/压缩阈值得到满足。\n   - 耶斯长度分辨率要求 $ \\lambda_J  N_J \\Delta x $ 被违反。\n\n实现任务：\n\n- 实现一个程序，为每个测试用例计算：\n  - 由 $ \\gamma $、$ p $ 和 $ \\rho $ 计算出的声速 $ c_s $。\n  - 归一化压缩率 $ C $。\n  - 马赫数 $ M = |v|/c_s $。\n  - 耶斯长度 $ \\lambda_J $。\n  - 对应于所需最小密度跳跃 $ r_{\\min} $ 的最小马赫数 $ M_{\\min}(r_{\\min},\\gamma) $。\n  - 基于上述组合判据的布尔值加密决策。\n- 使用一维假设，因此速度的法向分量等于速率 $ |v| $，且 $ \\nabla\\cdot\\mathbf{v} $ 等于 $ \\partial v/\\partial x $。\n- 在所有测试用例中统一使用以下固定参数：\n  - 绝热指数 $ \\gamma = 5/3 $。\n  - 引力常数 $ G = 6.67430\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}} $。\n  - 目标耶斯分辨率 $ N_J = 32 $。\n  - 最小密度跳跃 $ r_{\\min} = 1.2 $。\n  - 由您的推导设定的归一化压缩率 $ C $ 的时间尺度平衡阈值。\n- 所有物理量必须使用国际单位制（SI）处理。报告最终的布尔值加密标志，不带单位。\n\n测试套件：\n\n每个测试用例是一个元组 $(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x)$，其值如下，全部采用国际单位制：\n\n1. 用例 A（强压缩类激波流）：$(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x) = (1\\times 10^{-19}\\ \\mathrm{kg\\,m^{-3}},\\ 5.4\\times 10^{-13}\\ \\mathrm{Pa},\\ 9.0\\times 10^{3}\\ \\mathrm{m\\,s^{-1}},\\ -6.0\\times 10^{-12}\\ \\mathrm{s^{-1}},\\ 1.0\\times 10^{15}\\ \\mathrm{m})$。\n2. 用例 B（亚音速压缩，温和）：$(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 1.5\\times 10^{3},\\ -9.0\\times 10^{-13},\\ 1.0\\times 10^{15})$。\n3. 用例 C（临界超音速，慢压缩）：$(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 3.3\\times 10^{3},\\ -2.4\\times 10^{-12},\\ 1.0\\times 10^{15})$。\n4. 用例 D（通过耶斯长度实现引力加密）：$(1\\times 10^{-14},\\ 2.4\\times 10^{-10},\\ 1.0\\times 10^{2},\\ 0.0,\\ 1.0\\times 10^{15})$。\n5. 用例 E（热气体，亚音速压缩）：$(1\\times 10^{-20},\\ 2.4\\times 10^{-10},\\ 1.0\\times 10^{5},\\ -1.0\\times 10^{-11},\\ 1.0\\times 10^{15})$。\n6. 用例 F（膨胀）：$(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 3.0\\times 10^{3},\\ +5.0\\times 10^{-12},\\ 1.0\\times 10^{15})$。\n\n您的程序应生成一行输出，其中包含上述用例的六个布尔值加密决策，格式为用方括号括起来的逗号分隔列表（例如，$[{\\rm True},{\\rm False},\\dots]$）。不应打印任何其他文本。布尔值必须精确反映您推导的阈值和组合判据。", "solution": "我们从第一性原理和经过充分检验的公式出发，推导出一个平衡的加密阈值，该阈值能区分激波和良性压缩，并同时强制执行引力分辨率。\n\n基于时间尺度的压缩归一化：\n\n- 一维流的体积压缩率为 $ -\\nabla\\cdot\\mathbf{v} = -\\partial v/\\partial x $，相关的压缩时间尺度为 $ \\tau_{\\mathrm{comp}} = 1/|\\nabla\\cdot\\mathbf{v}| $。\n- 声波穿过宽度为 $ \\Delta x $ 的单元所需的时间为 $ \\tau_s = \\Delta x / c_s $，其中 $ c_s = \\sqrt{\\gamma p/\\rho} $ 是绝热声速。\n- 归一化压缩率定义为\n$$\nC \\equiv -\\frac{\\Delta x\\,\\nabla\\cdot\\mathbf{v}}{c_s} = \\frac{\\tau_s}{\\tau_{\\mathrm{comp}}}.\n$$\n- 物理解释：当 $ C \\gtrsim 1 $ 时，压缩时间尺度小于或等于声波穿过单元的时间，这表明流体压缩的速度比信息通过声波在一个单元内传播的速度还要快。这是离散化表示中类激波行为或初现的间断的特征。相反，$ C \\ll 1 $ 表示相对于声学通信，压缩是缓慢的，这是平滑、近等熵运动（如亚音速湍流）的典型特征。\n\n因此，一个有原则的类激波压缩时间尺度阈值为 $ C \\ge \\theta $，其中 $ \\theta $ 的量级为 1。根据定义，最自然的选择是 $ \\theta = 1 $，这对应于 $ \\tau_{\\mathrm{comp}} \\le \\tau_s $。\n\n最小物理显著跳跃：\n\n为避免因极弱的激波或不产生强状态变化的温和压缩而加密，我们对激波施加了一个最小密度跳跃 $ r_{\\min}  1 $。对于完全气体中的平面正激波，朗肯-雨贡纽（Rankine–Hugoniot）密度比为\n$$\nr(M_1,\\gamma) = \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1) M_1^2}{(\\gamma-1) M_1^2 + 2},\n$$\n其中 $ M_1 $ 是垂直于激波的上游马赫数。我们要求 $ r(M_1,\\gamma) \\ge r_{\\min} $。解出 $ M_1 $，得到产生至少指定跳跃所需的最小马赫数 $ M_{\\min} $：\n$$\nr_{\\min}\\left[(\\gamma-1) M_{\\min}^2 + 2\\right] = (\\gamma+1)M_{\\min}^2 \\quad\\Rightarrow\\quad\n\\left[(\\gamma+1) - r_{\\min}(\\gamma-1)\\right] M_{\\min}^2 = 2 r_{\\min}.\n$$\n假设 $ r_{\\min}  (\\gamma+1)/(\\gamma-1) $（这样右侧在物理上是可达到的），我们得到\n$$\nM_{\\min}(r_{\\min},\\gamma) = \\sqrt{\\frac{2 r_{\\min}}{(\\gamma+1) - r_{\\min}(\\gamma-1)}}.\n$$\n这个下界确保了加密不会被那些根据激波跳跃条件不会产生至少 $ r_{\\min} $ 密度增加的压缩所触发。\n\n结合压缩时间尺度和跳跃显著性：\n\n在一维中，流动的法向分量等于速率 $ |v| $，因此马赫数为 $ M = |v|/c_s $。一个汇聚流具有 $ \\nabla\\cdot\\mathbf{v}  0 $。于是，激波/压缩加密判据为：\n- 汇聚：$ \\nabla\\cdot\\mathbf{v}  0 $。\n- 时间尺度主导：$ C \\equiv -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s \\ge \\theta $，其中 $ \\theta = 1 $。\n- 最小跳跃一致性：$ M = |v|/c_s \\ge M_{\\min}(r_{\\min},\\gamma) $。\n\n如果这三者都成立，则单元因类激波压缩而被标记为需要加密。这平衡了真实激波与良性压缩，因为 (i) $ C \\ge 1 $ 过滤了慢压缩，(ii) $ M \\ge M_{\\min} $ 过滤了近等熵的亚音速运动，甚至包括那些不太可能产生强跳跃的极弱超音速压缩。\n\n耶斯长度加密：\n\n对于引力坍缩，耶斯长度为\n$$\n\\lambda_J = c_s \\sqrt{\\frac{\\pi}{G \\rho}}.\n$$\nTruelove类型的分辨率要求是在耶斯长度未被至少 $ N_J $ 个单元解析时进行加密：\n$$\n\\lambda_J  N_J \\Delta x.\n$$\n\n最终的组合加密决策：\n\n一个单元在以下任一情况满足时被加密：\n- 激波/压缩判据满足（汇聚、$ C \\ge 1 $ 且 $ M \\ge M_{\\min} $），或\n- 耶斯判据被违反（$ \\lambda_J  N_J \\Delta x $）。\n\n每个测试用例 $(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x)$ 的算法步骤：\n\n1. 计算 $ c_s = \\sqrt{\\gamma p/\\rho} $。\n2. 计算 $ C = -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s $。\n3. 计算 $ M = |v|/c_s $。\n4. 计算 $ \\lambda_J = c_s \\sqrt{\\pi/(G\\rho)} $。\n5. 使用上述封闭形式表达式计算 $ M_{\\min}(r_{\\min},\\gamma) $。如果 $ r_{\\min} \\ge (\\gamma+1)/(\\gamma-1) $，则设置 $ M_{\\min} \\to +\\infty $ 以确保不会错误加密；这里 $ r_{\\min} = 1.2 $ 且 $ \\gamma = 5/3 $ 会得到一个有限值。\n6. 定义布尔标志：\n   - $ \\mathrm{shock\\_refine} = (\\nabla\\cdot\\mathbf{v}  0) \\land (C \\ge 1) \\land (M \\ge M_{\\min}) $。\n   - $ \\mathrm{jeans\\_refine} = (\\lambda_J  N_J \\Delta x) $。\n   - $ \\mathrm{refine} = \\mathrm{shock\\_refine} \\lor \\mathrm{jeans\\_refine} $。\n\n在测试套件上的评估：\n\n- 用例 A：$ \\rho = 1\\times 10^{-19} $，$ p = 5.4\\times 10^{-13} $，$ v = 9.0\\times 10^{3} $，$ \\nabla\\cdot\\mathbf{v} = -6.0\\times 10^{-12} $，$ \\Delta x = 1.0\\times 10^{15} $。当 $ \\gamma = 5/3 $ 时，$ c_s = 3.0\\times 10^{3} $，因此 $ M = 3.0 $，$ C = 2.0 \\ge 1 $，满足汇聚条件，且 $ M_{\\min}(1.2,5/3) \\approx 1.135 $。耶斯长度 $ \\lambda_J \\approx 2.06\\times 10^{18} $ 远大于 $ N_J \\Delta x = 3.2\\times 10^{16} $。因激波而加密：${\\rm True}$。\n- 用例 B：$ M = 0.5 $，$ C = 0.3  1 $。无激波加密；耶斯长度被充分解析。${\\rm False}$。\n- 用例 C：$ M \\approx 1.1  M_{\\min} $，$ C = 0.8  1 $。${\\rm False}$。\n- 用例 D：稠密、冷气体：$ c_s = 2.0\\times 10^{2} $，$ \\lambda_J \\approx 4.34\\times 10^{14} \\text{ m}  3.2\\times 10^{16} \\text{ m} $。耶斯判据触发加密。${\\rm True}$。\n- 用例 E：热气体，亚音速温和压缩：$ C \\approx 0.05  1 $，$ M = 0.5 $。不加密。${\\rm False}$。\n- 用例 F：膨胀：$ \\nabla\\cdot\\mathbf{v}  0 $。无激波加密；耶斯长度被充分解析。${\\rm False}$。\n\n最终程序将实现这些计算，并以所需格式打印包含六个布尔值的单行列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef minimum_mach_from_density_jump(r_min: float, gamma: float) - float:\n    \"\"\"\n    Compute M_min such that the Rankine-Hugoniot density jump r(M,gamma) = r_min.\n    r(M,gamma) = ((gamma+1) M^2) / ((gamma-1) M^2 + 2)\n    Solve analytically for M^2.\n    If r_min is unphysical (= (gamma+1)/(gamma-1)) or non-compressive (= 1), return +inf to prevent refinement.\n    \"\"\"\n    r_max = (gamma + 1.0) / (gamma - 1.0)\n    if r_min = 1.0:\n        return np.inf\n    if r_min = r_max:\n        return np.inf\n    denom = (gamma + 1.0) - r_min * (gamma - 1.0)\n    m2 = 2.0 * r_min / denom\n    if m2 = 0.0:\n        return np.inf\n    return float(np.sqrt(m2))\n\ndef compute_sound_speed(rho: float, p: float, gamma: float) - float:\n    \"\"\"c_s = sqrt(gamma * p / rho)\"\"\"\n    return float(np.sqrt(gamma * p / rho))\n\ndef jeans_length(cs: float, rho: float, G: float) - float:\n    \"\"\"Jeans length: lambda_J = cs * sqrt(pi / (G * rho))\"\"\"\n    return float(cs * np.sqrt(np.pi / (G * rho)))\n\ndef refine_decision(case, gamma: float, G: float, N_J: int, r_min: float, theta_C: float) - bool:\n    \"\"\"\n    Decide refinement for one case.\n    case: tuple (rho, p, v, div_v, dx) with SI units.\n    gamma: adiabatic index\n    G: gravitational constant\n    N_J: target number of cells per Jeans length\n    r_min: minimum desired density jump across shocks\n    theta_C: threshold for normalized compression rate C\n    \"\"\"\n    rho, p, v, div_v, dx = case\n    cs = compute_sound_speed(rho, p, gamma)\n    # Normalized compression rate C = -dx * div_v / cs\n    C = -dx * div_v / cs\n    # Mach number in 1D (normal component equals |v|)\n    M = abs(v) / cs\n    # Jeans length\n    lam_J = jeans_length(cs, rho, G)\n    jeans_refine = lam_J  N_J * dx\n    # Minimum Mach consistent with minimum jump\n    M_min = minimum_mach_from_density_jump(r_min, gamma)\n    # Shock/compression refinement criterion\n    shock_refine = (div_v  0.0) and (C = theta_C) and (M = M_min)\n    return bool(jeans_refine or shock_refine)\n\ndef solve():\n    # Constants\n    gamma = 5.0 / 3.0  # adiabatic index\n    G = 6.67430e-11    # m^3 kg^-1 s^-2\n    N_J = 32           # cells per Jeans length\n    r_min = 1.2        # minimum density jump to consider significant\n    theta_C = 1.0      # timescale-balance threshold for normalized compression rate\n\n    # Define the test cases from the problem statement.\n    # Each tuple: (rho [kg/m^3], p [Pa], v [m/s], div_v [1/s], dx [m])\n    test_cases = [\n        (1.0e-19, 5.4e-13, 9.0e3, -6.0e-12, 1.0e15),   # Case A\n        (1.0e-19, 5.4e-13, 1.5e3, -9.0e-13, 1.0e15),   # Case B\n        (1.0e-19, 5.4e-13, 3.3e3, -2.4e-12, 1.0e15),   # Case C\n        (1.0e-14, 2.4e-10, 1.0e2,  0.0e0,   1.0e15),   # Case D\n        (1.0e-20, 2.4e-10, 1.0e5, -1.0e-11, 1.0e15),   # Case E\n        (1.0e-19, 5.4e-13, 3.0e3,  5.0e-12, 1.0e15),   # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        result = refine_decision(case, gamma=gamma, G=G, N_J=N_J, r_min=r_min, theta_C=theta_C)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3532010"}]}