{"hands_on_practices": [{"introduction": "在相对论流体动力学 (RHD) 模拟中，为了准确捕捉动力学过程，我们必须遵守 Courant–Friedrichs–Lewy (CFL) 条件，该条件根据最快信号速度来限制时间步长。相对论声速是这个限制的关键组成部分。本练习将引导您从基本的热力学原理出发，推导相对论声速的表达式，并计算其在不同物态方程下的数值，以突显相对论效应。[@problem_id:3517982]", "problem": "在一个用于模拟准直天体物理外流的有限体积相对论流体动力学求解器中，Courant–Friedrichs–Lewy 时间步长由包含相对论声速的信号速度控制。从绝热声速的定义，即等熵导数 $c_{s}^{2} = \\left(\\frac{\\partial p}{\\partial e}\\right)_{s}$（其中 $p$ 是压强，$e$ 是包含静质量贡献的总能量密度）出发，推导一个理想流体的 $c_{s}^{2}$ 表达式，该流体具有恒定的绝热指数 $\\Gamma$ 并遵循理想气体状态方程 $p = (\\Gamma - 1)\\,\\rho\\,\\varepsilon$，其中 $\\rho$ 是静质量密度，$\\varepsilon$ 是单位质量的比内能。请用 $\\Gamma$、$p$、$\\rho$ 和光速 $c$ 来表示你的结果，并写成明确使用比焓 $h = \\frac{e+p}{\\rho}$ 的形式。\n\n然后，对于一个弱相对论性喷流鞘层，其中比率 $p/(\\rho c^{2}) = 0.1$，请对两种成分计算无量纲声速比 $c_{s}/c$：辐射主导（$\\Gamma = 4/3$）和非相对论性离子主导（$\\Gamma = 5/3$）。将你的最终结果报告为一个有序对，分别为 $\\Gamma = 4/3$ 和 $\\Gamma = 5/3$ 时的 $\\left(c_{s}/c\\right)$ 值，并四舍五入到4位有效数字。最终答案必须按指定顺序表示为一个无量纲数对。", "solution": "该问题要求推导理想流体的相对论声速平方 $c_s^2$，并在特定条件下进行数值计算。\n\n问题的验证过程如下：\n1.  **已知条件提取**：\n    -   绝热声速平方的定义：$c_{s}^{2} = \\left(\\frac{\\partial p}{\\partial e}\\right)_{s}$。\n    -   $p$：压强。\n    -   $e$：总能量密度（包括静质量）。\n    -   流体模型：具有恒定绝热指数 $\\Gamma$ 的理想流体。\n    -   状态方程 (EOS)：$p = (\\Gamma - 1)\\rho\\varepsilon$。\n    -   $\\rho$：静质量密度。\n    -   $\\varepsilon$：单位质量的比内能。\n    -   比焓的定义：$h = \\frac{e+p}{\\rho}$。\n    -   数值计算条件：$p/(\\rho c^{2}) = 0.1$。\n    -   $\\Gamma$ 的情况：$\\Gamma = 4/3$ (辐射主导) 和 $\\Gamma = 5/3$ (非相对论性离子主导)。\n    -   要求输出：一个有序对，包含 $c_s/c$ 的值，四舍五入到4位有效数字。\n\n2.  **验证检查**：该问题具有相对论流体动力学的科学依据，使用了标准的定义和方程。问题提法恰当，为推导和数值计算提供了所有必要的信息。语言客观、精确。该问题没有任何指定的缺陷（例如，科学上不健全、不完整、含糊不清）。\n\n3.  **结论**：该问题有效。\n\n**第一部分：相对论声速的推导**\n\n我们从绝热声速平方的定义开始：\n$$\nc_s^2 = \\left(\\frac{\\partial p}{\\partial e}\\right)_s\n$$\n其中下标 $s$ 表示在恒定比熵下求导。计算其逆导数通常更方便：\n$$\nc_s^{-2} = \\left(\\frac{\\partial e}{\\partial p}\\right)_s\n$$\n总能量密度 $e$ 包括流体粒子的静质量能和它们的内能。它由 $e = \\rho c^2 + \\rho\\varepsilon$ 给出，其中 $c$ 是光速。\n\n问题给出了比焓的定义，$h = \\frac{e+p}{\\rho}$。我们可以用 $h$ 表示总能量密度 $e$ 为 $e = \\rho h - p$。\n现在，我们可以计算 $e$ 对 $p$ 在恒定熵下的导数：\n$$\n\\left(\\frac{\\partial e}{\\partial p}\\right)_s = \\left(\\frac{\\partial (\\rho h - p)}{\\partial p}\\right)_s = \\left(\\frac{\\partial (\\rho h)}{\\partial p}\\right)_s - \\left(\\frac{\\partial p}{\\partial p}\\right)_s\n$$\n使用乘法法则求导：\n$$\n\\left(\\frac{\\partial e}{\\partial p}\\right)_s = h \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s + \\rho \\left(\\frac{\\partial h}{\\partial p}\\right)_s - 1\n$$\n对于相对论流体，热力学第一定律可以用比焓表示为 $dh = Tds + \\frac{dp}{\\rho}$，其中 $T$ 是温度，$s$ 是比熵。对于等熵过程，$ds=0$，因此简化为 $dh = \\frac{dp}{\\rho}$。由此，我们得到 $h$ 对 $p$ 在恒定熵下的偏导数：\n$$\n\\left(\\frac{\\partial h}{\\partial p}\\right)_s = \\frac{1}{\\rho}\n$$\n将此结果代回我们关于 $(\\partial e / \\partial p)_s$ 的表达式中：\n$$\n\\left(\\frac{\\partial e}{\\partial p}\\right)_s = h \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s + \\rho \\left(\\frac{1}{\\rho}\\right) - 1 = h \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s\n$$\n为了继续，我们需要找到导数 $(\\partial \\rho / \\partial p)_s$。这需要状态方程 $p = (\\Gamma - 1)\\rho\\varepsilon$。对于经历绝热过程（$ds=0$）的流体元，热力学第一定律是 $d\\varepsilon + p d(1/\\rho) = 0$，可以改写为 $d\\varepsilon = \\frac{p}{\\rho^2}d\\rho$。\n从状态方程（EOS），我们有 $\\varepsilon = \\frac{p}{(\\Gamma-1)\\rho}$。对其求导得到：\n$$\nd\\varepsilon = \\frac{1}{\\Gamma-1} \\left( \\frac{dp}{\\rho} - \\frac{p d\\rho}{\\rho^2} \\right)\n$$\n令两个 $d\\varepsilon$ 的表达式相等：\n$$\n\\frac{p}{\\rho^2}d\\rho = \\frac{1}{\\Gamma-1} \\left( \\frac{dp}{\\rho} - \\frac{p d\\rho}{\\rho^2} \\right)\n$$\n乘以 $(\\Gamma-1)\\rho^2$：\n$$\n(\\Gamma-1)p d\\rho = \\rho dp - p d\\rho\n$$\n重新整理各项以分离变量：\n$$\n\\Gamma p d\\rho = \\rho dp \\implies \\frac{dp}{p} = \\Gamma \\frac{d\\rho}{\\rho}\n$$\n这个微分关系对等熵过程成立。由此，我们找到导数：\n$$\n\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\Gamma \\frac{p}{\\rho}\n$$\n及其逆导数：\n$$\n\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s = \\frac{\\rho}{\\Gamma p}\n$$\n现在，将此代入我们关于 $(\\partial e / \\partial p)_s$ 的表达式中：\n$$\n\\left(\\frac{\\partial e}{\\partial p}\\right)_s = h \\left(\\frac{\\rho}{\\Gamma p}\\right) = \\frac{\\rho h}{\\Gamma p}\n$$\n最后，取倒数得到声速平方的期望表达式：\n$$\nc_s^2 = \\frac{\\Gamma p}{\\rho h}\n$$\n这个表达式满足用 $\\Gamma$、 $p$、 $\\rho$ 表示，并明确使用比焓 $h$ 的要求。\n\n**第二部分：数值计算**\n\n我们被要求在条件 $p/(\\rho c^2) = 0.1$ 下计算无量纲声速比 $c_s/c$。首先，我们用给定物理量表示 $c_s^2/c^2$。\n$$\n\\frac{c_s^2}{c^2} = \\frac{\\Gamma p}{\\rho h c^2} = \\frac{\\Gamma \\frac{p}{\\rho c^2}}{\\frac{h}{c^2}}\n$$\n我们需要用给定的比率表示 $h$。使用 $e = \\rho c^2 + \\rho\\varepsilon$ 和 $p = (\\Gamma-1)\\rho\\varepsilon$，我们有 $\\rho\\varepsilon = p/(\\Gamma-1)$。\n$$\nh = \\frac{e+p}{\\rho} = \\frac{\\rho c^2 + \\rho\\varepsilon + p}{\\rho} = c^2 + \\varepsilon + \\frac{p}{\\rho} = c^2 + \\frac{p}{(\\Gamma-1)\\rho} + \\frac{p}{\\rho}\n$$\n$$\nh = c^2 + \\frac{p}{\\rho}\\left(1 + \\frac{1}{\\Gamma-1}\\right) = c^2 + \\frac{p}{\\rho}\\left(\\frac{\\Gamma-1+1}{\\Gamma-1}\\right) = c^2 + \\frac{\\Gamma p}{(\\Gamma-1)\\rho}\n$$\n除以 $c^2$：\n$$\n\\frac{h}{c^2} = 1 + \\frac{\\Gamma}{\\Gamma-1}\\frac{p}{\\rho c^2}\n$$\n将此代回 $c_s^2/c^2$ 的表达式中：\n$$\n\\frac{c_s^2}{c^2} = \\frac{\\Gamma \\left(\\frac{p}{\\rho c^2}\\right)}{1 + \\frac{\\Gamma}{\\Gamma-1}\\left(\\frac{p}{\\rho c^2}\\right)}\n$$\n令 $X = p/(\\rho c^2) = 0.1$。公式变为：\n$$\n\\left(\\frac{c_s}{c}\\right)^2 = \\frac{\\Gamma X}{1 + \\frac{\\Gamma}{\\Gamma-1}X}\n$$\n\n**情况1：辐射主导气体 ($\\Gamma = 4/3$)**\n对于这种情况，比率 $\\frac{\\Gamma}{\\Gamma-1} = \\frac{4/3}{4/3 - 1} = \\frac{4/3}{1/3} = 4$。\n$$\n\\left(\\frac{c_s}{c}\\right)^2 = \\frac{(4/3) \\times 0.1}{1 + 4 \\times 0.1} = \\frac{4/30}{1.4} = \\frac{4}{30 \\times 1.4} = \\frac{4}{42} = \\frac{2}{21}\n$$\n$$\n\\frac{c_s}{c} = \\sqrt{\\frac{2}{21}} \\approx 0.308606...\n$$\n四舍五入到4位有效数字，结果是 $0.3086$。\n\n**情况2：非相对论性离子主导气体 ($\\Gamma = 5/3$)**\n对于这种情况，比率 $\\frac{\\Gamma}{\\Gamma-1} = \\frac{5/3}{5/3 - 1} = \\frac{5/3}{2/3} = \\frac{5}{2} = 2.5$。\n$$\n\\left(\\frac{c_s}{c}\\right)^2 = \\frac{(5/3) \\times 0.1}{1 + 2.5 \\times 0.1} = \\frac{5/30}{1.25} = \\frac{1/6}{5/4} = \\frac{1}{6} \\times \\frac{4}{5} = \\frac{4}{30} = \\frac{2}{15}\n$$\n$$\n\\frac{c_s}{c} = \\sqrt{\\frac{2}{15}} \\approx 0.365148...\n$$\n四舍五入到4位有效数字，结果是 $0.3651$。\n\n最终答案是这两个值的有序对。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3086  0.3651 \\end{pmatrix}}\n$$", "id": "3517982"}, {"introduction": "从流体动力学过渡到磁流体动力学 (MHD) 时，一个关键步骤是在流体的静止参考系中正确描述磁场。在相对论磁流体动力学 (RMHD) 中，这是通过使用磁四维矢量 $b^\\mu$ 来完成的，它是构建应力-能量张量的核心。本练习将重点推导实验室参考系中的磁场 $\\mathbf{B}$ 与同动四维矢量 $b^\\mu$ 之间的关系，并利用它来计算磁化参数 $\\sigma$，这是衡量磁场动力学重要性的一个关键指标。[@problem_id:3517930]", "problem": "在相对论磁流体动力学 (Relativistic Magnetohydrodynamics, RMHD) 中，流体静止参考系中测量的磁场被编码在磁四维矢量 $b^{\\mu}$ 中，该矢量通过对偶电磁场张量 ${^{\\ast}\\!F}^{\\mu \\nu}$ 和流体四维速度 $u^{\\nu}$ 定义为 $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$。计算在平直时空中进行，其 Minkowski 度规符号为 $(-,+,+,+)$，采用光速 $c=1$ 的单位制，并使用 Heaviside–Lorentz 电磁单位。假设为理想磁流体动力学（完美电导率），使得实验室参考系中的电场和磁场满足 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$，其中 $\\mathbf{v}$ 是流体的三维速度。\n\n仅从上述定义出发，结合场张量及其对偶张量以实验室参考系场表示的标准形式，执行以下操作：\n\n1. 构建一个变换，将 $b^{\\mu}$ 显式地用实验室参考系磁场 $\\mathbf{B}$、流体三维速度 $\\mathbf{v}$ 和洛伦兹因子 $\\Gamma \\equiv (1 - v^{2})^{-1/2}$ 来表示，其中 $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$。\n\n2. 从你得到的一般表达式中，推导出一个关于 $b^{2} \\equiv b^{\\mu} b_{\\mu}$ 的简化标量表达式，用 $\\mathbf{B}$、$\\mathbf{v}$ 和 $\\Gamma$ 表示。\n\n3. 对于一个射流流体元，其实验室参考系磁场为 $\\mathbf{B} = (3, 4, 12)$，速度为 $\\mathbf{v} = (0.6, 0.3, 0.0)$，在给定焓密度 $w = 50$ 的情况下，计算 $b^{2}$，然后计算磁化参数 $\\sigma \\equiv b^{2}/w$。将你最终的 $\\sigma$ 答案表示为一个无量纲数。将你的最终答案四舍五入到 $4$ 位有效数字。", "solution": "用户提供了一个相对论磁流体动力学 (RMHD) 问题，并要求给出一个涉及磁四维矢量 $b^{\\mu}$ 的三部分解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- 磁四维矢量的定义：$b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$\n- 对偶电磁场张量：${^{\\ast}\\!F}^{\\mu \\nu}$\n- 流体四维速度：$u^{\\nu}$\n- 时空：平直，Minkowski 度规符号为 $\\eta_{\\mu\\nu} = \\text{diag}(-1, 1, 1, 1)$\n- 单位：光速 $c=1$，Heaviside–Lorentz 电磁单位。\n- 理想 MHD 条件：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$，其中 $\\mathbf{E}$ 和 $\\mathbf{B}$ 是实验室参考系场，$\\mathbf{v}$ 是流体三维速度。\n- 洛伦兹因子：$\\Gamma \\equiv (1 - v^{2})^{-1/2}$，其中 $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$。\n- 第 3 部分的数值数据：\n    - 实验室参考系磁场：$\\mathbf{B} = (3, 4, 12)$\n    - 流体三维速度：$\\mathbf{v} = (0.6, 0.3, 0.0)$\n    - 焓密度：$w = 50$\n- 磁化参数的定义：$\\sigma \\equiv b^{2}/w$\n- 标量平方的定义：$b^2 \\equiv b^{\\mu} b_{\\mu}$\n- 最终答案要求：将 $\\sigma$ 的最终值四舍五入到 4 位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题牢固地植根于狭义相对论理想磁流体动力学的标准形式。诸如 $b^{\\mu}$ 的定义、洛伦兹因子 $\\Gamma$、理想 MHD 条件以及电磁张量的结构等都是标准的教科书内容。\n- **适定性**：该问题结构清晰，由一个引导性推导和一个数值计算组成。每个步骤都提供了所有必要的信息。任务定义明确，可以得出一个唯一的解。\n- **客观性**：该问题使用了精确的数学和物理术语，没有歧义或主观性语言。\n- **完整性和一致性**：所提供的定义和约束是自洽的，并且足以解决该问题。$b^{\\mu}$ 的定义是明确的，避免了潜在的约定歧义。\n- **其他缺陷**：该问题不存在任何所列出的缺陷。这是一个计算天体物理学中的有效、正式的问题。\n\n**步骤 3：结论与行动**\n\n该问题被判定为**有效**。现在将推导解答。\n\n### 解答推导\n\n根据要求，解答由三部分组成。\n\n**第 1 部分：用实验室参考系物理量表示 $b^{\\mu}$**\n\n我们从定义 $b^{\\mu} = {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$ 开始。四维速度 $u^{\\mu}$ 及其协变形式 $u_{\\mu}$ 的分量为：\n$$ u^{\\mu} = (\\Gamma, \\Gamma \\mathbf{v}) = (\\Gamma, \\Gamma v^x, \\Gamma v^y, \\Gamma v^z) $$\n$$ u_{\\mu} = \\eta_{\\mu\\nu}u^{\\nu} = (-\\Gamma, \\Gamma \\mathbf{v}) = (-\\Gamma, \\Gamma v_x, \\Gamma v_y, \\Gamma v_z) $$\n用实验室参考系电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 表示的对偶电磁场张量 ${^{\\ast}\\!F}^{\\mu\\nu}$ 为：\n$$ {^{\\ast}\\!F}^{\\mu\\nu} = \\begin{pmatrix} 0   -B_x   -B_y   -B_z \\\\ B_x   0   E_z   -E_y \\\\ B_y   -E_z   0   E_x \\\\ B_z   E_y   -E_x   0 \\end{pmatrix} $$\n我们现在通过矩阵-矢量乘法计算 $b^{\\mu}$ 的分量。\n\n时间分量 $b^0$：\n$$ b^0 = {^{\\ast}\\!F}^{0\\nu}u_{\\nu} = {^{\\ast}\\!F}^{00}u_0 + {^{\\ast}\\!F}^{01}u_1 + {^{\\ast}\\!F}^{02}u_2 + {^{\\ast}\\!F}^{03}u_3 $$\n$$ b^0 = (0)(-\\Gamma) + (-B_x)(\\Gamma v_x) + (-B_y)(\\Gamma v_y) + (-B_z)(\\Gamma v_z) = -\\Gamma (B_x v_x + B_y v_y + B_z v_z) $$\n$$ b^0 = -\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}) $$\n\n空间分量 $b^i$（其中 $i=1,2,3$ 对应于 $x,y,z$）构成一个三维矢量 $\\mathbf{b}$。让我们计算 $b^1$：\n$$ b^1 = {^{\\ast}\\!F}^{1\\nu}u_{\\nu} = {^{\\ast}\\!F}^{10}u_0 + {^{\\ast}\\!F}^{11}u_1 + {^{\\ast}\\!F}^{12}u_2 + {^{\\ast}\\!F}^{13}u_3 $$\n$$ b^1 = (B_x)(-\\Gamma) + (0)(\\Gamma v_x) + (E_z)(\\Gamma v_y) + (-E_y)(\\Gamma v_z) = \\Gamma[-B_x + (E_z v_y - E_y v_z)] = \\Gamma[-B_x + (\\mathbf{v} \\times \\mathbf{E})_x] $$\n推广到所有三个空间分量：\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times \\mathbf{E}) $$\n现在我们应用理想 MHD 条件，$\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$。\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times (-\\mathbf{v} \\times \\mathbf{B})) = \\Gamma(-\\mathbf{B} - \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B})) $$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$，我们得到：\n$$ \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}(\\mathbf{v}\\cdot\\mathbf{v}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2 $$\n将此代入 $\\mathbf{b}$ 的表达式中：\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} - [\\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2]) = \\Gamma(-\\mathbf{B} - \\mathbf{v}(\\mathbf{B}\\cdot\\mathbf{v}) + \\mathbf{B}v^2) $$\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B}(1-v^2) - \\mathbf{v}(\\mathbf{B}\\cdot\\mathbf{v})) $$\n使用定义 $\\Gamma = (1-v^2)^{-1/2}$，我们有 $1-v^2 = 1/\\Gamma^2$：\n$$ \\mathbf{b} = \\Gamma(-\\frac{\\mathbf{B}}{\\Gamma^2} - (\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v}) = -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} $$\n因此，四维矢量 $b^{\\mu} = (b^0, \\mathbf{b})$ 表示为：\n$$ b^{\\mu} = \\left(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}), \\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n\n**第 2 部分：推导 $b^2 \\equiv b^{\\mu} b_{\\mu}$ 的表达式**\n\n标量平方 $b^2$ 是一个洛伦兹不变量。在 $(-,+,+,+)$ 度规符号下，其计算方式为：\n$$ b^2 = b^{\\mu} b_{\\mu} = -(b^0)^2 + \\mathbf{b} \\cdot \\mathbf{b} $$\n代入第 1 部分推导出的分量：\n$$ b^2 = -(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}))^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\frac{\\mathbf{B}}{\\Gamma}\\right) + 2\\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) + \\left(\\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + 2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 v^2 $$\n我们将含有 $(\\mathbf{B} \\cdot \\mathbf{v})^2$ 的项组合在一起：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2(-\\Gamma^2 + 2 + \\Gamma^2 v^2) $$\n$(\\mathbf{B} \\cdot \\mathbf{v})^2$ 的乘数因子可以显著简化：\n$$ -\\Gamma^2 + 2 + \\Gamma^2 v^2 = -\\Gamma^2(1 - v^2) + 2 $$\n因为 $\\Gamma^2(1-v^2) = 1$，这变为：\n$$ -1 + 2 = 1 $$\n因此，$b^2$ 的表达式简化为：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 $$\n这就是所求的标量表达式。\n\n**第 3 部分：根据给定的数值计算 $b^2$ 和 $\\sigma$**\n\n我们已知：\n- $\\mathbf{B} = (3, 4, 12)$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $w = 50$\n\n首先，我们计算所需的标量值。\n流体速度大小的平方：\n$$ v^2 = \\mathbf{v} \\cdot \\mathbf{v} = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45 $$\n洛伦兹因子的平方：\n$$ \\Gamma^2 = \\frac{1}{1 - v^2} = \\frac{1}{1 - 0.45} = \\frac{1}{0.55} = \\frac{1}{11/20} = \\frac{20}{11} $$\n磁场大小的平方：\n$$ |\\mathbf{B}|^2 = \\mathbf{B} \\cdot \\mathbf{B} = 3^2 + 4^2 + 12^2 = 9 + 16 + 144 = 169 $$\n$\\mathbf{B}$ 和 $\\mathbf{v}$ 的点积：\n$$ \\mathbf{B} \\cdot \\mathbf{v} = (3)(0.6) + (4)(0.3) + (12)(0.0) = 1.8 + 1.2 + 0.0 = 3.0 $$\n该点积的平方：\n$$ (\\mathbf{B} \\cdot \\mathbf{v})^2 = (3.0)^2 = 9.0 $$\n\n现在，将这些值代入 $b^2$ 的表达式：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 = 169 \\cdot \\frac{11}{20} + 9.0 $$\n$$ b^2 = \\frac{1859}{20} + 9.0 = 92.95 + 9.0 = 101.95 $$\n最后，我们计算磁化参数 $\\sigma$：\n$$ \\sigma = \\frac{b^2}{w} = \\frac{101.95}{50} = 2.039 $$\n题目要求将最终答案四舍五入到 4 位有效数字。计算出的值 $2.039$ 已经恰好是 4 位有效数字，因此无需进一步四舍五入。", "answer": "$$\\boxed{2.039}$$", "id": "3517930"}, {"introduction": "虽然笛卡尔坐标系很简单，但像喷流这样的许多天体物理学问题具有对称性，使得柱坐标或球坐标更为高效。然而，这些坐标系包含奇点（例如，在轴线 $R=0$ 处），需要进行仔细的数值处理以避免非物理结果。本练习将演示朴素的离散化方法如何在轴线附近产生伪力，并指导您实现一种正则化的有限体积格式，以正确捕捉物理现象并保持计算精度。[@problem_id:3517917]", "problem": "您正在柱坐标系下模拟轴对称射流和外流，并且需要处理对称轴上的坐标奇点。考虑一个柱坐标系中的轴对称控制体，其径向坐标为 $R \\ge 0$，其中质量密度为 $\\rho$，速度分量为 $v_{R}$ 和 $v_{z}$ 的连续性方程为：\n$$\\frac{\\partial \\rho}{\\partial t} + \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R \\rho v_{R}\\right) + \\frac{\\partial}{\\partial z}\\left(\\rho v_{z}\\right) = 0.$$\n定义 $A_{R}(R) \\equiv \\rho v_{R}$ 为径向质量通量密度。在轴附近，轴对称射流或外流的物理对称性意味着 $v_{R}$ 是 $R$ 的奇函数，而 $\\rho$ 是 $R$ 的偶函数，因此 $A_{R}$ 的泰勒展开式具有如下形式的奇函数形式：\n$$A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3},$$\n其中 $a_{0}$ 表示可能在数值上产生的非物理偶数污染，$a_{1}$ 捕捉了物理上允许的主阶奇数行为，$a_{3}$ 捕捉了更高阶的奇数行为。几何散度算子\n$$\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$$\n在其点态微分形式下，在 $R=0$ 处是奇异的，但其物理极限存在，并且任何数值方法都必须在不产生伪力的情况下捕捉到这个极限。\n\n任务：\n- 仅从连续性方程和泰勒展开出发，在给定奇宇称条件下，推导 $\\mathcal{L}[A_{R}]$ 在 $R \\to 0$ 时的有限极限。您的推导不得假设任何预知的专门正则化公式，并且必须从定义和泰勒展开开始。\n- 考虑一个一维均匀径向网格，其网格中心位于 $R_{i} = \\left(i + \\tfrac{1}{2}\\right)\\Delta R$，其中整数 $i \\ge 0$，因此前两个中心是 $R_{0} = \\tfrac{1}{2}\\Delta R$ 和 $R_{1} = \\tfrac{3}{2}\\Delta R$。为 $i \\in \\{0,1\\}$ 定义 $A_{i} \\equiv A_{R}(R_{i})$。\n\n  在第一个网格中心 $R_{0}$ 处，实现 $\\mathcal{L}[A_{R}]$ 的两种离散近似：\n  - 一种朴素的点态中心差分近似，直接在 $R_{0}$ 处离散化 $\\mathcal{L}[A_{R}] = \\tfrac{1}{R}\\tfrac{\\partial}{\\partial R}(R A_{R})$，对径向导数使用中心差分，并对位于 $i=-1$ 处的鬼点值使用偶数反射，即 $A_{-1} = A_{0}$ 在 $R_{-1} = -\\tfrac{1}{2}\\Delta R$ 处。这产生\n    $$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) \\approx \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}.$$\n    这反映了一个求解器在轴上没有强制执行正确的奇宇称。\n  - 一种正则化的有限体积近似，它强制执行奇宇称和通过轴面的净通量为零。该近似从第一个控制体 $[0,\\Delta R]$ 上的保守积分形式推导得出，其内侧面位于 $R_{-1/2} = 0$，外侧面位于 $R_{+1/2} = \\Delta R$。通过对最近的两个中心点的 $A(R)$ 进行局部线性拟合，并减去在 $R=0$ 处的拟合截距来移除偶数污染，然后线性插值到面，来估计在 $R_{+1/2}$ 处的面心值 $A_{R}$。在 $R_{0}$ 处的散度的最终有限体积形式为\n    $$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) \\approx \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R},$$\n    其中根据对称性 $A_{-1/2}^{\\mathrm{odd}} = 0$，而 $A_{+1/2}^{\\mathrm{odd}}$ 是通过奇宇称投影后进行线性插值得到的。\n\n- 对于每种情况，定义绝对轴心散度误差为 $e_{\\mathrm{naive}} \\equiv \\left|\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$ 和 $e_{\\mathrm{reg}} \\equiv \\left|\\mathcal{L}_{\\mathrm{reg}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$，其中 $\\mathcal{L}_{\\mathrm{exact}}(0)$ 是您推导出的解析轴心极限。通过以下比率来量化轴心奇点的数值影响和正则化的效果：\n  $$\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)},$$\n  其中 $\\epsilon$ 是一个小的正常数，以防止除以零。使用 $\\epsilon = 10^{-18}$。比率 $\\mathcal{R}$ 是无量纲的，必须以浮点数形式报告。\n\n- 实现一个完整的、可运行的程序，对于下面的每个测试用例，计算并输出如上定义的 $\\mathcal{R}$。\n\n使用以下测试套件，其中每个用例指定 $(a_{0}, a_{1}, a_{3}, \\Delta R)$，均为无量纲：\n- 用例 1: $(0, 1, 0, 10^{-3})$。\n- 用例 2: $(10^{-3}, 1, 0, 10^{-2})$。\n- 用例 3: $(2\\times 10^{-4}, 0.3, -2.0, 5\\times 10^{-2})$。\n- 用例 4: $(-5\\times 10^{-5}, 2.0, 10.0, 2\\times 10^{-1})$。\n- 用例 5: $(10^{-6}, 0.0, 5.0, 10^{-2})$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的、按上述测试套件顺序排列的逗号分隔的结果列表，例如 $[\\mathcal{R}_{1},\\mathcal{R}_{2},\\mathcal{R}_{3},\\mathcal{R}_{4},\\mathcal{R}_{5}]$。\n- 输出是纯粹的、无量纲的浮点数。", "solution": "问题陈述经评估有效。其科学基础是计算流体动力学的原理，特别是欧拉方程中坐标奇点的处理。该问题是适定的，提供了所有必要的定义、常数和边界条件，以推导出一个唯一的、可验证的解。术语精确且客观。这些任务是可数学形式化的，并与模拟天体物理射流的主题直接相关。\n\n求解过程分为四个阶段：\n1.  推导对称轴上散度算子的精确解析极限。\n2.  分析朴素数值近似及其相关误差。\n3.  分析正则化有限体积近似及其相关误差。\n4.  计算每个测试用例的误差比 $\\mathcal{R}$。\n\n**1. 精确轴心散度的推导**\n\n径向散度算子定义为 $\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$。径向质量通量密度 $A_{R}(R)$ 由泰勒展开式 $A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3}$ 给出。\n\n首先，我们计算导数内的乘积：\n$$R A_{R}(R) = R (a_{0} + a_{1} R + a_{3} R^{3}) = a_{0} R + a_{1} R^{2} + a_{3} R^{4}$$\n接下来，我们对 $R$ 求偏导数：\n$$\\frac{\\partial}{\\partial R}\\left(R A_{R}(R)\\right) = \\frac{\\partial}{\\partial R}\\left(a_{0} R + a_{1} R^{2} + a_{3} R^{4}\\right) = a_{0} + 2 a_{1} R + 4 a_{3} R^{3}$$\n最后，我们乘以因子 $\\frac{1}{R}$ 以获得算子的完整表达式：\n$$\\mathcal{L}[A_{R}] = \\frac{1}{R} \\left(a_{0} + 2 a_{1} R + 4 a_{3} R^{3}\\right) = \\frac{a_{0}}{R} + 2 a_{1} + 4 a_{3} R^{2}$$\n为了找到轴上的物理极限，我们取 $R \\to 0$ 的极限。问题陈述指出，对于物理的、轴对称的流动，径向速度 $v_{R}$ 是 $R$ 的奇函数，密度 $\\rho$ 是 $R$ 的偶函数。因此，它们的乘积，即质量通量 $A_R = \\rho v_R$，必须是 $R$ 的奇函数。一个奇函数在 $R=0$ 附近的泰勒级数只包含 $R$ 的奇次幂。因此，对于物理上正确的流动，偶次幂 $R^0$ 的系数 $a_0$ 必须为零。项 $a_0$ 被明确描述为“可能在数值上产生的非物理偶数污染”。在物理约束 $a_0 = 0$ 下，极限为：\n$$\\mathcal{L}_{\\mathrm{exact}}(0) \\equiv \\lim_{R \\to 0, a_0=0} \\mathcal{L}[A_{R}] = \\lim_{R \\to 0} \\left(2 a_{1} + 4 a_{3} R^{2}\\right) = 2 a_{1}$$\n这是对称轴上散度的精确、非奇异值。\n\n**2. 朴素数值格式的分析**\n\n朴素中心差分近似应用于第一个网格中心 $R_{0} = \\frac{1}{2}\\Delta R$。公式为：\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}$$\n网格位置为 $R_{1} = \\frac{3}{2}\\Delta R$ 和 $R_{-1} = -\\frac{1}{2}\\Delta R$。边界条件为偶数反射，$A_{-1} = A_{0}$。将这些代入公式：\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{\\frac{1}{2}\\Delta R} \\cdot \\frac{(\\frac{3}{2}\\Delta R)A_{1} - (-\\frac{1}{2}\\Delta R)A_{0}}{2\\Delta R} = \\frac{2}{\\Delta R} \\cdot \\frac{\\frac{\\Delta R}{2}(3 A_1 + A_0)}{2\\Delta R} = \\frac{3 A_1 + A_0}{2\\Delta R}$$\n为了分析误差，我们使用给定的展开式来表示 $A_{0} \\equiv A_{R}(R_{0})$ 和 $A_{1} \\equiv A_{R}(R_{1})$：\n$$A_{0} = a_{0} + a_{1}\\left(\\frac{1}{2}\\Delta R\\right) + a_{3}\\left(\\frac{1}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}$$\n$$A_{1} = a_{0} + a_{1}\\left(\\frac{3}{2}\\Delta R\\right) + a_{3}\\left(\\frac{3}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}$$\n将这些代入 $\\mathcal{L}_{\\mathrm{naive}}(R_{0})$ 的表达式中：\n$$3A_{1} + A_{0} = 3\\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) + \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$3A_{1} + A_{0} = 4a_{0} + \\left(\\frac{9}{2} + \\frac{1}{2}\\right)a_{1}\\Delta R + \\left(\\frac{81}{8} + \\frac{1}{8}\\right)a_{3}(\\Delta R)^{3} = 4a_{0} + 5a_{1}\\Delta R + \\frac{82}{8}a_{3}(\\Delta R)^{3}$$\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{4a_{0} + 5a_{1}\\Delta R + 10.25 a_{3}(\\Delta R)^{3}}{2\\Delta R} = \\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}$$\n误差为 $e_{\\mathrm{naive}} = |\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)|$：\n$$e_{\\mathrm{naive}} = \\left|\\left(\\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right) - 2a_{1}\\right| = \\left|\\frac{2a_{0}}{\\Delta R} + 0.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right|$$\n该格式存在一个与 $a_{0}/\\Delta R$ 成正比的项，如果存在非物理污染 $a_{0}$，该项在 $\\Delta R \\to 0$ 时会发散。\n\n**3. 正则化数值格式的分析**\n\n在第一个网格单元 $[0, \\Delta R]$ 上的正则化有限体积近似为：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R}$$\n面位于 $R_{-1/2} = 0$ 和 $R_{+1/2} = \\Delta R$。单元中心为 $R_0 = \\frac{1}{2}\\Delta R$。根据对称性，通过轴的通量为零，所以 $A_{-1/2}^{\\mathrm{odd}} = 0$。公式简化为：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{(\\Delta R) A_{+1/2}^{\\mathrm{odd}}}{(\\frac{1}{2}\\Delta R)\\Delta R} = \\frac{2 A_{+1/2}^{\\mathrm{odd}}}{\\Delta R}$$\n为了找到 $A_{+1/2}^{\\mathrm{odd}}$，我们遵循指定的步骤。首先，我们使用中心 $R_0$ 和 $R_1$ 处的值进行局部线性拟合 $f(R) = mR+c$。截距 $c$ 估计了偶数污染 $a_0$。\n$$m = \\frac{A_1 - A_0}{R_1 - R_0} = \\frac{A_1 - A_0}{\\Delta R}$$\n$$c = A_0 - m R_0 = A_0 - \\left(\\frac{A_1 - A_0}{\\Delta R}\\right)\\left(\\frac{1}{2}\\Delta R\\right) = \\frac{3}{2}A_0 - \\frac{1}{2}A_1$$\n接下来，我们定义一个投影函数 $A^{\\mathrm{odd}}_{\\text{local}}(R) = A(R) - c$，该函数已移除了污染。我们在单元中心 $R_0$ 和 $R_1$ 处评估此函数：\n$$A'_{0} = A_0 - c = A_0 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{1}{2}A_0 + \\frac{1}{2}A_1$$\n$$A'_{1} = A_1 - c = A_1 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{3}{2}A_0 + \\frac{3}{2}A_1$$\n最后，我们在点 $(R_0, A'_{0})$ 和 $(R_1, A'_{1})$ 之间进行线性插值，以找到面 $R_{+1/2} = \\Delta R$ 处的值：\n$$A_{+1/2}^{\\mathrm{odd}} = A'_{0} + (A'_{1} - A'_{0})\\frac{\\Delta R - R_0}{R_1 - R_0} = \\left(-\\frac{1}{2}A_0 + \\frac{1}{2}A_1\\right) + (-A_0 + A_1)\\frac{\\frac{1}{2}\\Delta R}{\\Delta R} = A_1 - A_0$$\n将此结果代回 $\\mathcal{L}_{\\mathrm{reg}}(R_{0})$ 的表达式中：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2(A_1 - A_0)}{\\Delta R}$$\n为了分析误差，我们使用 $A_0$ 和 $A_1$ 的表达式：\n$$A_1 - A_0 = \\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) - \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$A_1 - A_0 = a_1 \\Delta R + \\frac{26}{8}a_3(\\Delta R)^3 = a_1\\Delta R + 3.25 a_3(\\Delta R)^3$$\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2}{\\Delta R}\\left(a_1\\Delta R + 3.25 a_3(\\Delta R)^3\\right) = 2a_1 + 6.5 a_3 (\\Delta R)^2$$\n误差为 $e_{\\mathrm{reg}} = |\\mathcal{L}_{\\mathrm{reg}}(R_0) - \\mathcal{L}_{\\mathrm{exact}}(0)|$：\n$$e_{\\mathrm{reg}} = |\\left(2a_1 + 6.5 a_3 (\\Delta R)^2\\right) - 2a_1| = |6.5 a_3 (\\Delta R)^2|$$\n该格式是二阶精确的，并正确消除了与 $a_0$ 相关的发散项。\n\n**4. 误差比的计算**\n\n比率为 $\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)}$，其中 $\\epsilon = 10^{-18}$。使用推导出的解析误差表达式：\n\n用例 1: $(a_0, a_1, a_3, \\Delta R) = (0, 1, 0, 10^{-3})$\n$e_{\\mathrm{naive}} = |0.5(1)| = 0.5$\n$e_{\\mathrm{reg}} = |6.5(0)(10^{-3})^2| = 0$\n$\\mathcal{R} = \\frac{0.5}{\\max(0, 10^{-18})} = 5 \\times 10^{17}$\n\n用例 2: $(a_0, a_1, a_3, \\Delta R) = (10^{-3}, 1, 0, 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(10^{-3})}{10^{-2}} + 0.5(1)| = |0.2 + 0.5| = 0.7$\n$e_{\\mathrm{reg}} = |6.5(0)(10^{-2})^2| = 0$\n$\\mathcal{R} = \\frac{0.7}{\\max(0, 10^{-18})} = 7 \\times 10^{17}$\n\n用例 3: $(a_0, a_1, a_3, \\Delta R) = (2\\times 10^{-4}, 0.3, -2.0, 5\\times 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(2\\times 10^{-4})}{0.05} + 0.5(0.3) + 5.125(-2)(0.05)^2| = |0.008 + 0.15 - 0.025625| = 0.132375$\n$e_{\\mathrm{reg}} = |6.5(-2.0)(0.05)^2| = |-0.0325| = 0.0325$\n$\\mathcal{R} = \\frac{0.132375}{0.0325} \\approx 4.0730769$\n\n用例 4: $(a_0, a_1, a_3, \\Delta R) = (-5\\times 10^{-5}, 2.0, 10.0, 2\\times 10^{-1})$\n$e_{\\mathrm{naive}} = |\\frac{2(-5\\times 10^{-5})}{0.2} + 0.5(2.0) + 5.125(10)(0.2)^2| = |-0.0005 + 1.0 + 2.05| = 3.0495$\n$e_{\\mathrm{reg}} = |6.5(10.0)(0.2)^2| = |2.6| = 2.6$\n$\\mathcal{R} = \\frac{3.0495}{2.6} \\approx 1.1728846$\n\n用例 5: $(a_0, a_1, a_3, \\Delta R) = (10^{-6}, 0.0, 5.0, 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(10^{-6})}{0.01} + 0.5(0) + 5.125(5)(0.01)^2| = |0.0002 + 0.0025625| = 0.0027625$\n$e_{\\mathrm{reg}} = |6.5(5.0)(0.01)^2| = |0.00325| = 0.00325$\n$\\mathcal{R} = \\frac{0.0027625}{0.00325} = 0.85$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the ratio of errors between a naive and a regularized numerical\n    scheme for the divergence operator at the axis of a cylindrical coordinate system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a1, a3, delta_R)\n    test_cases = [\n        (0.0, 1.0, 0.0, 1e-3),\n        (1e-3, 1.0, 0.0, 1e-2),\n        (2e-4, 0.3, -2.0, 5e-2),\n        (-5e-5, 2.0, 10.0, 2e-1),\n        (1e-6, 0.0, 5.0, 1e-2),\n    ]\n\n    epsilon = 1e-18\n    results = []\n\n    for case in test_cases:\n        a0, a1, a3, delta_R = case\n\n        # Analytical value of the divergence at the R=0 axis.\n        # L_exact(0) = 2 * a1\n        L_exact = 2.0 * a1\n\n        # Define the radial mass flux density function A_R(R)\n        def A_R(R):\n            return a0 + a1 * R + a3 * R**3\n\n        # Define grid cell centers\n        R0 = 0.5 * delta_R\n        R1 = 1.5 * delta_R\n\n        # Evaluate A_R at cell centers\n        A0 = A_R(R0)\n        A1 = A_R(R1)\n\n        # --- Naive Approximation ---\n        # L_naive = (1/R0) * (R1*A1 - R_m1*A_m1) / (2*delta_R)\n        # where R_m1 = -R0 and A_m1 = A0 (even reflection)\n        # This simplifies to: L_naive = (3*A1 + A0) / (2*delta_R)\n        L_naive = (3.0 * A1 + A0) / (2.0 * delta_R)\n        \n        # --- Regularized Approximation ---\n        # The derivation in the solution text shows that the complex procedure\n        # described in the problem simplifies to:\n        # L_reg = 2 * (A1 - A0) / delta_R\n        L_reg = 2.0 * (A1 - A0) / delta_R\n\n        # --- Errors and Ratio ---\n        e_naive = abs(L_naive - L_exact)\n        e_reg = abs(L_reg - L_exact)\n\n        # The ratio R quantifies the improvement of the regularized scheme.\n        R_val = e_naive / max(e_reg, epsilon)\n        results.append(R_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3517917"}]}