{"hands_on_practices": [{"introduction": "在实施任何子网格模型之前，我们必须首先理解为何以及何时需要它们。这取决于天体物理湍流中存在的巨大尺度范围。这个练习探讨了最大的含能尺度（驱动尺度）与能量耗散的最小尺度（Kolmogorov尺度）之间的关系。通过计算捕捉这一“惯性区”一部分所需的网格分辨率，您将对驱动大涡模拟（LES）和子网格尺度（SGS）模型需求的基本挑战有更具体的理解。[@problem_id:3537255]", "problem": "考虑一块星际介质（ISM），它被建模为服从纳维-斯托克斯方程且具有有效运动黏度的可压缩流体。在大涡模拟（LES）中，网格间距充当空间滤波器，限制了可解析的最高波数。对于暖中性星际介质中一个被驱动的、近似各向同性的湍流，给定以下物理上合理的参数：\n- 驱动（能量注入）尺度 $L_{\\mathrm{drive}} = 50 \\,\\mathrm{pc}$，\n- 驱动尺度上的一维湍流速度弥散 $U = 10 \\,\\mathrm{km\\,s^{-1}}$，\n- 有效运动黏度 $\\nu = 5 \\times 10^{21} \\,\\mathrm{cm^{2}\\,s^{-1}}$。\n\n假设存在一个类柯尔莫哥洛夫的惯性级串，其中单位质量的平均能量耗散率满足 $\\epsilon \\sim U^{3}/L_{\\mathrm{drive}}$，并且最小的物理（耗散）尺度是由黏度和 $\\epsilon$ 决定的柯尔莫哥洛夫微尺度 $\\eta$。驱动波数为 $k_{\\mathrm{drive}}$，耗散波数为 $k_{\\mathrm{diss}}$，特征长度尺度 $\\ell$ 与波数 $k$ 之间的标准关系为 $k = 2\\pi/\\ell$。对于均匀的笛卡尔网格，最高可解析（奈奎斯特）波数为 $k_{c} = \\pi/\\Delta x$，其中 $\\Delta x$ 是网格间距。\n\n你的任务是确定所需的最小网格尺度，以使得在大涡模拟中，驱动尺度与耗散尺度在波数上至少相差一个数量级，并且该模拟不试图解析超出物理耗散波数的尺度。形式上，要求 $\\min(k_{\\mathrm{diss}},\\,k_{c})/k_{\\mathrm{drive}} \\geq 10$，并选择满足此约束的尽可能大的 $\\Delta x$。将你最终的 $\\Delta x$ 以秒差距（pc）为单位表示。使用 $1 \\,\\mathrm{pc} = 3.0857 \\times 10^{18} \\,\\mathrm{cm}$ 和 $1 \\,\\mathrm{km\\,s^{-1}} = 10^{5} \\,\\mathrm{cm\\,s^{-1}}$。将你的答案四舍五入到四位有效数字。", "solution": "该问题被验证为具有科学依据、问题明确且客观。所有提供的信息都是自洽和一致的。问题要求计算在满足尺度分离约束条件下，用于天体物理湍流大涡模拟（LES）的最大可能网格间距 $\\Delta x$。\n\n首先，我们建立一个一致的单位制。CGS（厘米-克-秒）单位制是合适的。给定参数转换如下：\n- 驱动尺度：$L_{\\mathrm{drive}} = 50 \\,\\mathrm{pc} = 50 \\times (3.0857 \\times 10^{18} \\,\\mathrm{cm}) = 1.54285 \\times 10^{20} \\,\\mathrm{cm}$。\n- 湍流速度弥散：$U = 10 \\,\\mathrm{km\\,s^{-1}} = 10 \\times (10^{5} \\,\\mathrm{cm\\,s^{-1}}) = 10^{6} \\,\\mathrm{cm\\,s^{-1}}$。\n- 有效运动黏度：$\\nu = 5 \\times 10^{21} \\,\\mathrm{cm^{2}\\,s^{-1}}$。\n\n问题陈述了模拟中尺度分离的形式要求：\n$$\n\\frac{\\min(k_{\\mathrm{diss}},\\,k_{c})}{k_{\\mathrm{drive}}} \\geq 10\n$$\n其中 $k_{\\mathrm{drive}}$ 是驱动波数，$k_{\\mathrm{diss}}$ 是耗散波数，$k_{c}$ 是网格截止（奈奎斯特）波数。我们的任务是找到满足此约束的最大可能网格间距 $\\Delta x$。\n\n波数与其特征长度尺度相关。使用所提供的定义：\n- 驱动波数：$k_{\\mathrm{drive}} = \\frac{2\\pi}{L_{\\mathrm{drive}}}$。\n- 耗散波数：$k_{\\mathrm{diss}} = \\frac{2\\pi}{\\eta}$，其中 $\\eta$ 是柯尔莫哥洛夫微尺度。\n- 奈奎斯特波数：$k_{c} = \\frac{\\pi}{\\Delta x}$。\n\n根据 $k_c$ 的定义，我们可知 $\\Delta x = \\frac{\\pi}{k_c}$。因此，最大化 $\\Delta x$ 等同于最小化 $k_{c}$。我们的目标是找到满足给定约束的 $k_c$ 的最小值。\n\n该约束涉及项 $\\min(k_{\\mathrm{diss}}, k_{c})$。为了评估它，我们必须将物理耗散波数 $k_{\\mathrm{diss}}$ 与波数 $10 k_{\\mathrm{drive}}$ 进行比较。问题指明该模拟是一个“不试图解析超出物理耗散波数”的大涡模拟，这意味着网格截止波数将小于或等于耗散波数，即 $k_{c} \\le k_{\\mathrm{diss}}$。在这种情况下，最小值为 $k_c$，约束简化为 $k_c \\geq 10 k_{\\mathrm{drive}}$。这个简化仅在系统本身的物理尺度满足 $k_{\\mathrm{diss}} \\geq 10 k_{\\mathrm{drive}}$ 时才有效。我们必须验证这个条件。\n\n耗散波数与驱动波数之比由驱动尺度与柯尔莫哥洛夫微尺度之比给出：\n$$\n\\frac{k_{\\mathrm{diss}}}{k_{\\mathrm{drive}}} = \\frac{2\\pi / \\eta}{2\\pi / L_{\\mathrm{drive}}} = \\frac{L_{\\mathrm{drive}}}{\\eta}\n$$\n柯尔莫哥洛夫微尺度 $\\eta$ 定义为 $\\eta = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4}$。单位质量的平均能量耗散率 $\\epsilon$ 由标度关系 $\\epsilon \\sim U^{3}/L_{\\mathrm{drive}}$ 给出。对于本计算，我们将其视为一个等式，$\\epsilon = U^{3}/L_{\\mathrm{drive}}$，这是湍流理论中进行数量级分析的标准做法。\n\n将 $\\epsilon$ 代入 $\\eta$ 的表达式中：\n$$\n\\eta = \\left( \\frac{\\nu^3}{U^3 / L_{\\mathrm{drive}}} \\right)^{1/4} = \\left( \\frac{\\nu^3 L_{\\mathrm{drive}}}{U^3} \\right)^{1/4}\n$$\n现在，尺度之比可以用驱动尺度雷诺数 $Re = \\frac{U L_{\\mathrm{drive}}}{\\nu}$ 来表示：\n$$\n\\frac{L_{\\mathrm{drive}}}{\\eta} = \\frac{L_{\\mathrm{drive}}}{\\left( \\frac{\\nu^3 L_{\\mathrm{drive}}}{U^3} \\right)^{1/4}} = \\frac{L_{\\mathrm{drive}}}{ \\frac{\\nu^{3/4} L_{\\mathrm{drive}}^{1/4}}{U^{3/4}} } = \\frac{L_{\\mathrm{drive}}^{3/4} U^{3/4}}{\\nu^{3/4}} = \\left( \\frac{U L_{\\mathrm{drive}}}{\\nu} \\right)^{3/4} = Re^{3/4}\n$$\n我们现在使用CGS单位制下的给定参数计算雷诺数：\n$$\nRe = \\frac{(10^{6} \\,\\mathrm{cm\\,s^{-1}})(1.54285 \\times 10^{20} \\,\\mathrm{cm})}{5 \\times 10^{21} \\,\\mathrm{cm^{2}\\,s^{-1}}} = \\frac{1.54285 \\times 10^{26}}{5 \\times 10^{21}} = 30857\n$$\n那么，物理波数之比为：\n$$\n\\frac{k_{\\mathrm{diss}}}{k_{\\mathrm{drive}}} = Re^{3/4} = (30857)^{3/4} \\approx 2303.6\n$$\n由于 $2303.6$ 远大于 $10$，条件 $k_{\\mathrm{diss}} > 10 k_{\\mathrm{drive}}$ 得到满足。这证实了湍流的惯性区足够宽，可以容纳所需的尺度分离一个数量级。\n\n确认这一点后，对于 $k_c \\le k_{\\mathrm{diss}}$ 的大涡模拟，约束 $\\min(k_{\\mathrm{diss}},\\,k_{c}) \\geq 10 k_{\\mathrm{drive}}$ 变为：\n$$\nk_c \\geq 10 k_{\\mathrm{drive}}\n$$\n为了最大化 $\\Delta x$，我们必须选择满足此不等式的最小可能 $k_c$ 值，即：\n$$\nk_{c, \\mathrm{min}} = 10 k_{\\mathrm{drive}}\n$$\n这个选择与大涡模拟的性质一致，因为 $k_{c, \\mathrm{min}} = 10 k_{\\mathrm{drive}} \\ll k_{\\mathrm{diss}} \\approx 2303.6 k_{\\mathrm{drive}}$。\n\n现在，我们可以确定与 $k_{c, \\mathrm{min}}$ 对应的最大允许网格间距 $\\Delta x_{\\mathrm{max}}$：\n$$\n\\Delta x_{\\mathrm{max}} = \\frac{\\pi}{k_{c, \\mathrm{min}}} = \\frac{\\pi}{10 k_{\\mathrm{drive}}}\n$$\n代入定义 $k_{\\mathrm{drive}} = 2\\pi/L_{\\mathrm{drive}}$，得到一个简单的关系式：\n$$\n\\Delta x_{\\mathrm{max}} = \\frac{\\pi}{10 \\left(\\frac{2\\pi}{L_{\\mathrm{drive}}}\\right)} = \\frac{\\pi L_{\\mathrm{drive}}}{20\\pi} = \\frac{L_{\\mathrm{drive}}}{20}\n$$\n所需的网格间距就是驱动尺度的二十分之一。\n\n使用给定的值 $L_{\\mathrm{drive}} = 50 \\,\\mathrm{pc}$：\n$$\n\\Delta x = \\frac{50 \\,\\mathrm{pc}}{20} = 2.5 \\,\\mathrm{pc}\n$$\n问题要求答案用四位有效数字表示。因此，我们将 $2.5$ 写为 $2.500$。", "answer": "$$\\boxed{2.500}$$", "id": "3537255"}, {"introduction": "在确定了SGS模型的需求之后，我们的下一步是探究一个简单的显式模型是如何工作的。经典的Smagorinsky模型在已解析的流动和未解析的耗散之间建立了直接联系。本练习通过计算涡粘性系数 $\\nu_t$ 深入Smagorinsky模型的核心，该系数参数化了子网格运动的耗散效应。您将把模型的核心公式应用于给定的已解析应变率张量，从而巩固您对局部流动变形如何产生有效湍流粘性的理解。[@problem_id:3537221]", "problem": "考虑一个自引力分子云中超音速湍流的可压缩大涡模拟 (LES)。在某个网格点上，滤波后的应变率张量定义为 $S_{ij} \\equiv \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i}\\right)$，其无迹部分定义为 $\\tilde{S}_{ij} \\equiv S_{ij} - \\frac{1}{3} S_{kk} \\delta_{ij}$。偏应力亚格子尺度应力使用 Boussinesq 涡粘性假设建模为 $\\tau_{ij} - \\frac{1}{3}\\tau_{kk} \\delta_{ij} = -2 \\rho \\nu_t \\tilde{S}_{ij}$，其中 $\\nu_t$ 是运动涡粘性系数。采用混合长度假设，特征长度为 $\\ell = C_s \\Delta$，其中 $\\Delta$ 是局部滤波长度， $C_s$ 是 Smagorinsky 系数，并定义特征应变大小为 $|\\tilde{S}| \\equiv \\sqrt{2 \\tilde{S}_{ij}\\tilde{S}_{ij}}$。\n\n从这些假设和定义出发，推导 $\\nu_t$ 关于 $C_s$、$\\Delta$ 和不变量 $\\tilde{S}_{ij}\\tilde{S}_{ij}$ 的表达式，然后在一个点上计算比率 $R \\equiv \\nu_t / \\nu_{\\mathrm{mol}}$，该点处：\n- $C_s = 0.17$，\n- $\\Delta = 1.0 \\times 10^{15} \\ \\mathrm{m}$，\n- 对称无迹张量 $\\tilde{S}_{ij}$ 的非零分量（单位为 $\\mathrm{s}^{-1}$）为：\n  $\\tilde{S}_{11} = 1.2 \\times 10^{-12}$， $\\tilde{S}_{22} = -1.5 \\times 10^{-12}$， $\\tilde{S}_{33} = 0.3 \\times 10^{-12}$， $\\tilde{S}_{12} = \\tilde{S}_{21} = 4.0 \\times 10^{-13}$， $\\tilde{S}_{13} = \\tilde{S}_{31} = -2.5 \\times 10^{-13}$， $\\tilde{S}_{23} = \\tilde{S}_{32} = 3.0 \\times 10^{-13}$，\n- 以及局部分子（运动）粘性系数为 $\\nu_{\\mathrm{mol}} = 6.00 \\times 10^{12} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$。\n\n给出你的最终答案，为单个无量纲数 $R$，四舍五入到三位有效数字。最终答案中不要包含单位。", "solution": "通过首先提取给定信息，然后检查其科学合理性、一致性和完整性来验证问题。\n\n**步骤 1：提取已知条件**\n-   滤波后的应变率张量定义：$S_{ij} \\equiv \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i}\\right)$\n-   应变率张量的无迹部分：$\\tilde{S}_{ij} \\equiv S_{ij} - \\frac{1}{3} S_{kk} \\delta_{ij}$\n-   偏应力亚格子尺度应力的 Boussinesq 涡粘性假设：$\\tau_{ij} - \\frac{1}{3}\\tau_{kk} \\delta_{ij} = -2 \\rho \\nu_t \\tilde{S}_{ij}$，其中 $\\nu_t$ 是运动涡粘性系数。\n-   混合长度假设：特征长度 $\\ell = C_s \\Delta$，其中 $\\Delta$ 是滤波长度， $C_s$ 是 Smagorinsky 系数。\n-   特征应变大小定义：$|\\tilde{S}| \\equiv \\sqrt{2 \\tilde{S}_{ij}\\tilde{S}_{ij}}$。\n-   Smagorinsky 系数：$C_s = 0.17$。\n-   滤波长度：$\\Delta = 1.0 \\times 10^{15} \\ \\mathrm{m}$。\n-   对称无迹张量 $\\tilde{S}_{ij}$ 的非零分量（单位为 $\\mathrm{s}^{-1}$）：\n    -   $\\tilde{S}_{11} = 1.2 \\times 10^{-12}$\n    -   $\\tilde{S}_{22} = -1.5 \\times 10^{-12}$\n    -   $\\tilde{S}_{33} = 0.3 \\times 10^{-12}$\n    -   $\\tilde{S}_{12} = \\tilde{S}_{21} = 4.0 \\times 10^{-13}$\n    -   $\\tilde{S}_{13} = \\tilde{S}_{31} = -2.5 \\times 10^{-13}$\n    -   $\\tilde{S}_{23} = \\tilde{S}_{32} = 3.0 \\times 10^{-13}$\n-   局部分子运动粘性系数：$\\nu_{\\mathrm{mol}} = 6.00 \\times 10^{12} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$。\n-   目标量：比率 $R \\equiv \\nu_t / \\nu_{\\mathrm{mol}}$，四舍五入到三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题牢固地植根于大涡模拟（LES）的湍流建模理论。Boussinesq 假设、Smagorinsky 模型以及应变率张量的定义都是计算流体动力学和天体物理学中的标准概念。\n-   **适定性：** 该问题提供了推导表达式和计算唯一数值所需的所有必要信息和定义。\n-   **客观性：** 该问题使用精确、客观和形式化的科学语言进行陈述。\n-   **一致性检查：** 一个关键的检查是确保给定的张量 $\\tilde{S}_{ij}$ 确实如所述是无迹的。迹为 $\\mathrm{Tr}(\\tilde{S}) = \\tilde{S}_{kk} = \\tilde{S}_{11} + \\tilde{S}_{22} + \\tilde{S}_{33}$。\n    $$ \\mathrm{Tr}(\\tilde{S}) = (1.2 \\times 10^{-12}) + (-1.5 \\times 10^{-12}) + (0.3 \\times 10^{-12}) = (1.2 - 1.5 + 0.3) \\times 10^{-12} = 0 $$\n    迹为零，证实了所提供数据的自洽性。该问题没有未定、过约束或矛盾之处。\n\n**结论**\n该问题在科学上是合理的，适定的，并且内部一致。因此，它被认为是**有效的**。我们可以继续进行求解。\n\n**涡粘性系数 $\\nu_t$ 的推导**\n运动涡粘性系数 $\\nu_t$ 是基于混合长度模型构建的。通过量纲分析，运动粘性系数的量纲必须是 $[L]^2[T]^{-1}$。问题提供了一个特征长度尺度 $\\ell$ 和一个特征应变率 $|\\tilde{S}|$（其量纲为 $[T]^{-1}$）。特征尺度 $\\ell$ 和 $|\\tilde{S}|$ 唯一能产生运动粘性系数正确量纲的组合是 $\\nu_t \\propto \\ell^2 |\\tilde{S}|$. 标准的 Smagorinsky 模型将比例常数设为 1。\n因此，$\\nu_t$ 的表达式为：\n$$ \\nu_t = \\ell^2 |\\tilde{S}| $$\n代入给定的定义 $\\ell = C_s \\Delta$ 和 $|\\tilde{S}| = \\sqrt{2 \\tilde{S}_{ij}\\tilde{S}_{ij}}$，我们得到：\n$$ \\nu_t = (C_s \\Delta)^2 \\sqrt{2 \\tilde{S}_{ij}\\tilde{S}_{ij}} $$\n这就是所求的表达式。\n\n**不变量 $\\tilde{S}_{ij}\\tilde{S}_{ij}$ 的计算**\n项 $\\tilde{S}_{ij}\\tilde{S}_{ij}$ 意味着对索引 $i$ 和 $j$ 求和。由于张量 $\\tilde{S}_{ij}$ 是对称的（$\\tilde{S}_{ij} = \\tilde{S}_{ji}$），所有分量的平方和为：\n$$ \\tilde{S}_{ij}\\tilde{S}_{ij} = \\sum_{i=1}^3 \\sum_{j=1}^3 (\\tilde{S}_{ij})^2 = \\tilde{S}_{11}^2 + \\tilde{S}_{22}^2 + \\tilde{S}_{33}^2 + 2(\\tilde{S}_{12}^2 + \\tilde{S}_{13}^2 + \\tilde{S}_{23}^2) $$\n我们代入给定的数值（单位为 $\\mathrm{s}^{-1}$）：\n$$ \\tilde{S}_{11}^2 = (1.2 \\times 10^{-12})^2 = 1.44 \\times 10^{-24} $$\n$$ \\tilde{S}_{22}^2 = (-1.5 \\times 10^{-12})^2 = 2.25 \\times 10^{-24} $$\n$$ \\tilde{S}_{33}^2 = (0.3 \\times 10^{-12})^2 = 0.09 \\times 10^{-24} $$\n$$ 2\\tilde{S}_{12}^2 = 2 \\times (4.0 \\times 10^{-13})^2 = 2 \\times (1.6 \\times 10^{-25}) = 0.32 \\times 10^{-24} $$\n$$ 2\\tilde{S}_{13}^2 = 2 \\times (-2.5 \\times 10^{-13})^2 = 2 \\times (6.25 \\times 10^{-26}) = 0.125 \\times 10^{-24} $$\n$$ 2\\tilde{S}_{23}^2 = 2 \\times (3.0 \\times 10^{-13})^2 = 2 \\times (9.0 \\times 10^{-26}) = 0.18 \\times 10^{-24} $$\n将这些值相加：\n$$ \\tilde{S}_{ij}\\tilde{S}_{ij} = (1.44 + 2.25 + 0.09 + 0.32 + 0.125 + 0.18) \\times 10^{-24} \\ \\mathrm{s}^{-2} $$\n$$ \\tilde{S}_{ij}\\tilde{S}_{ij} = 4.405 \\times 10^{-24} \\ \\mathrm{s}^{-2} $$\n\n**特征应变大小 $|\\tilde{S}|$ 的计算**\n使用定义 $|\\tilde{S}| = \\sqrt{2 \\tilde{S}_{ij}\\tilde{S}_{ij}}$：\n$$ |\\tilde{S}| = \\sqrt{2 \\times (4.405 \\times 10^{-24} \\ \\mathrm{s}^{-2})} = \\sqrt{8.81 \\times 10^{-24} \\ \\mathrm{s}^{-2}} = \\sqrt{8.81} \\times 10^{-12} \\ \\mathrm{s}^{-1} $$\n\n**涡粘性系数 $\\nu_t$ 的计算**\n现在我们使用推导出的公式计算 $\\nu_t$：\n$$ \\nu_t = (C_s \\Delta)^2 |\\tilde{S}| $$\n给定 $C_s = 0.17$ 和 $\\Delta = 1.0 \\times 10^{15} \\ \\mathrm{m}$：\n$$ (C_s \\Delta)^2 = (0.17 \\times 1.0 \\times 10^{15} \\ \\mathrm{m})^2 = (0.17)^2 \\times 10^{30} \\ \\mathrm{m}^2 = 0.0289 \\times 10^{30} \\ \\mathrm{m}^2 = 2.89 \\times 10^{28} \\ \\mathrm{m}^2 $$\n代入这个值和 $|\\tilde{S}|$ 的值：\n$$ \\nu_t = (2.89 \\times 10^{28} \\ \\mathrm{m}^2) \\times (\\sqrt{8.81} \\times 10^{-12} \\ \\mathrm{s}^{-1}) $$\n$$ \\nu_t = 2.89 \\times \\sqrt{8.81} \\times 10^{16} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1} $$\n使用 $\\sqrt{8.81} \\approx 2.968164$：\n$$ \\nu_t \\approx 2.89 \\times 2.968164 \\times 10^{16} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1} \\approx 8.5780 \\times 10^{16} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1} $$\n\n**比率 $R$ 的计算**\n最后，我们计算比率 $R = \\nu_t / \\nu_{\\mathrm{mol}}$，其中 $\\nu_{\\mathrm{mol}} = 6.00 \\times 10^{12} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$：\n$$ R = \\frac{\\nu_t}{\\nu_{\\mathrm{mol}}} = \\frac{8.5780 \\times 10^{16} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1}}{6.00 \\times 10^{12} \\ \\mathrm{m}^2 \\ \\mathrm{s}^{-1}} $$\n$$ R = \\frac{8.5780}{6.00} \\times 10^{16-12} = \\frac{8.5780}{6.00} \\times 10^4 $$\n$$ R \\approx 1.42967 \\times 10^4 $$\n问题要求答案四舍五入到三位有效数字。\n$$ R \\approx 1.43 \\times 10^4 $$\n这也可以写成 $14300$。", "answer": "$$\\boxed{1.43 \\times 10^{4}}$$", "id": "3537221"}, {"introduction": "虽然经典的Smagorinsky模型在概念上很简单，但其主要缺点是需要指定一个普适常数 $C_s$。动态程序通过直接从已解析的流场计算模型系数，提供了一个强大的解决方案。这个基于编程的高级练习将指导您实现动态Smagorinsky模型，它不仅教会您如何构建一个更复杂和自适应的SGS模型，还让您学会处理常见的数值问题，例如非物理的负系数，这是计算天体物理学中的一项关键技能。[@problem_id:3537227]", "problem": "考虑一个二维、恒定密度、在数学上呈周期性的已解析速度场，该速度场表示在间距为 $\\Delta x = \\Delta y = \\Delta$ 的均匀笛卡尔网格上。在大涡模拟 (LES) 的 Smagorinsky 模型闭合中，网格尺度上的偏亚格子尺度应力被建模为 $\\tau_{ij}^{\\mathrm{dev}} = -2 \\left(C_s \\Delta\\right)^2 \\left\\lvert S \\right\\rvert S_{ij}$，其中 $S_{ij} = \\frac{1}{2}\\left(\\partial_j u_i + \\partial_i u_j\\right)$ 是已解析应变率张量，且 $\\left\\lvert S \\right\\rvert = \\sqrt{2 S_{ij} S_{ij}}$。动态程序使用一个宽度为 $\\hat{\\Delta}$ 的额外测试滤波器和 Germano 恒等式，仅从已解析速度场确定 $C_s^2$。对于恒定密度和类不可压缩的已解析场，Germano 恒等式为 $L_{ij} = \\widetilde{u_i u_j} - \\widetilde{u_i}\\,\\widetilde{u_j}$，而基于模型的近似给出了一个与 $C_s^2$ 成比例的张量，该张量由网格尺度和测试尺度上滤波后的应变张量的组合构造而成。动态系数 $C_s^2$ 必须通过仅使用保持局部性的操作（有限差分和离散箱式滤波），以最小二乘法意义上最小化建模误差来获得，然后任何负值的 $C_s^2$ 必须通过以下两种方式之一处理：截断为零，或在求比值前对最小二乘的分子和分母进行局部平均。\n\n从滤波、应变率、在 $d$ 维空间中的偏张量投影 $A_{ij}^{\\mathrm{dev}} = A_{ij} - \\frac{1}{d}\\operatorname{tr}(A)\\delta_{ij}$ 以及 Germano 恒等式的基本定义出发，推导一个算法。该算法针对周期性网格上给定的已解析速度场，使用离散顶帽（箱式）测试滤波器和中心有限差分，计算每个网格点上的局部动态系数 $C_s^2$，然后应用两种负值处理策略之一：\n- 截断：将任何负的 $C_s^2$ 替换为 $0$。\n- 局部平均：在形成 $C_s^2$ 之前，在一个紧凑的模板上对最小二乘的分子和分母分别进行局部箱式平均；如果平均后的分母小于一个正则化阈值，则将 $C_s^2$ 设为 $0$；如果得到的 $C_s^2$ 为负，则将其设为 $0$。\n\n使用 $d = 2$，边长为 $L = N \\Delta$ 的方形域，每个方向有 $N$ 个网格点，并采用周期性边界条件。使用网格滤波器宽度 $\\Delta = 1$（无量纲单位）和测试滤波器宽度 $\\hat{\\Delta} = 2$。实施带周期性环绕的中心有限差分来计算空间导数，以及一个实现为 $3 \\times 3$ 周期性箱式平均的离散顶帽测试滤波器。两个对称二阶张量 $A_{ij}$ 和 $B_{ij}$ 的动态最小二乘缩并应使用完整的双点积 $A_{ij}B_{ij}$，在二维中其等于 $A_{xx}B_{xx} + A_{yy}B_{yy} + 2 A_{xy}B_{xy}$。将偏张量投影一致地应用于由 Germano 恒等式和模型构造的张量，以使各向同性部分不会污染最小二乘估计。\n\n您的程序必须为以下每个测试案例计算场 $C_s^2(\\mathbf{x})$，并返回每个案例在整个网格上的 $C_s^2$ 的空间平均值。所有量都是无量纲的。使用 $N = 32$，$\\Delta = 1$，$\\hat{\\Delta} = 2$，测试滤波器使用 $3 \\times 3$ 箱式滤波，当选择局部平均选项时，局部平均也使用 $3 \\times 3$ 箱式滤波。对于最小二乘公式中接近零的分母，使用正则化阈值 $\\varepsilon = 10^{-12}$。\n\n测试套件：\n- 案例 $\\mathrm{A}$（平滑剪切波；截断）：$u(x,y) = U_0 \\sin\\left(2\\pi y / L\\right)$，$v(x,y) = 0$，其中 $U_0 = 1$。使用截断策略处理负值。\n- 案例 $\\mathrm{B}$（Taylor–Green 涡；局部平均）：$u(x,y) = U_0 \\sin\\left(2\\pi x / L\\right)\\cos\\left(2\\pi y / L\\right)$，$v(x,y) = -U_0 \\cos\\left(2\\pi x / L\\right)\\sin\\left(2\\pi y / L\\right)$，其中 $U_0 = 1$。使用局部平均策略。\n- 案例 $\\mathrm{C}$（含噪声的涡；局部平均）：与案例 $\\mathrm{B}$ 的基础场相同，但对两个分量都添加振幅为 $A_n = 0.05$ 的零均值随机扰动，即 $u \\leftarrow u + \\eta_u$，$v \\leftarrow v + \\eta_v$，其中 $\\eta_u$ 和 $\\eta_v$ 是在 $\\left[-A_n, A_n\\right]$ 上独立同分布的。使用局部平均策略。使用固定的伪随机种子以确保结果是确定性的。\n\n需遵守的实现细节：\n- 对所有差分和滤波使用周期性边界条件。\n- 对 $\\partial_x$ 和 $\\partial_y$ 使用中心有限差分。\n- 在最小二乘估计中使用张量的偏量部分。\n- 使用与二维对称性一致的双点积。\n- 对于局部平均，在形成比值前，使用相同的 $3 \\times 3$ 箱式滤波器分别对分子和分母进行平均。\n\n您的程序应生成一行输出，其中包含案例 $\\mathrm{A}$、$\\mathrm{B}$ 和 $\\mathrm{C}$ 的三个空间平均 $C_s^2$ 值，形式为方括号括起来的逗号分隔列表（例如，$\\left[ r_1, r_2, r_3 \\right]$）。输出是无量纲实数。将报告的每个值四舍五入到小数点后 $6$ 位。", "solution": "该问题是有效的。这是一个来自计算流体力学领域（特别是大涡模拟（LES）闭合模型）的、表述清晰且符合科学原理的问题。所有参数、条件和要求的输出都已明确定义。没有内部矛盾、歧义或违背科学原理之处。\n\n任务是为二维已解析速度场推导并实现一个计算动态 Smagorinsky 系数 $C_s^2$ 的算法。这涉及到几个植根于 LES 基本理论的步骤。\n\n首先，我们定义背景。在 LES 中，速度场 $\\mathbf{u}$ 被分解为已解析（网格尺度）部分（在本问题背景下记为 $\\mathbf{u}$）和未解析（亚格子尺度）部分。亚格子尺度对已解析尺度的影响表现为一个亚格子尺度（SGS）应力张量 $\\tau_{ij}$。Smagorinsky 模型为此项提供了一个闭合。对于不可压缩流，SGS 应力的偏量部分建模为：\n$$\n\\tau_{ij}^{\\mathrm{dev}} = -2 \\nu_{SGS} S_{ij} = -2 (C_s \\Delta)^2 |S| S_{ij}\n$$\n其中 $C_s$ 是 Smagorinsky 系数，$\\Delta$ 是网格滤波器宽度，$S_{ij} = \\frac{1}{2}(\\partial_j u_i + \\partial_i u_j)$ 是已解析应变率张量，而 $|S| = \\sqrt{2 S_{kl} S_{kl}}$ 是应变率大小。\n\n由 Germano 等人（1991）提出的动态程序通过从已解析速度场动态计算 $C_s$ 的值，避免了为其选择一个恒定值。这是通过引入第二个更宽的“测试”滤波器实现的，其宽度为 $\\hat{\\Delta} > \\Delta$，用波浪号（$\\widetilde{\\cdot}$）表示。该程序的核心是 Germano 恒等式，它将源于 $\\Delta$ 和 $\\hat{\\Delta}$ 之间尺度的应力与这两个尺度上的 SGS 应力联系起来：\n$$\nL_{ij} = T_{ij} - \\widetilde{\\tau_{ij}}\n$$\n此处，$L_{ij} = \\widetilde{u_i u_j} - \\widetilde{u_i}\\widetilde{u_j}$ 是 Leonard 应力张量，代表测试滤波尺度上的已解析湍流应力。$T_{ij}$ 是测试滤波尺度上的 SGS 应力，$\\widetilde{\\tau_{ij}}$ 是来自网格尺度的经滤波后的 SGS 应力。\n\n假设 Smagorinsky 模型在两个尺度上都以相同的系数 $C_s$ 成立，我们有：\n$$\nT_{ij} = -2 (C_s \\hat{\\Delta})^2 |\\widetilde{S}| \\widetilde{S}_{ij}\n$$\n$$\n\\tau_{ij} = -2 (C_s \\Delta)^2 |S| S_{ij}\n$$\n其中 $\\widetilde{S}_{ij}$ 是根据测试滤波后的速度场 $\\widetilde{u}_i$ 计算的应变率张量。将这些代入 Germano 恒等式，并假设 $C_s$ 是局部常数，可以从滤波操作中提出（$\\widetilde{C_s^2} \\approx C_s^2$），我们得到：\n$$\nL_{ij} = C_s^2 M_{ij}\n$$\n其中模型张量 $M_{ij}$ 定义为：\n$$\nM_{ij} = 2 \\left( \\Delta^2 \\widetilde{|S| S_{ij}} - \\hat{\\Delta}^2 |\\widetilde{S}| \\widetilde{S}_{ij} \\right)\n$$\n这个方程是在域中每个点为单个标量未知数 $C_s^2$ 建立的张量恒等式。为了求解 $C_s^2$，我们以最小二乘法最小化平方误差 $e_{ij} e_{ij} = (L_{ij} - C_s^2 M_{ij})(L_{ij} - C_s^2 M_{ij})$。按照规定，此最小化应应用于张量的偏量部分，以与模型对偏应力的公式保持一致。在 $d=2$ 维中，张量 $A_{ij}$ 的偏量部分是 $A_{ij}^{\\mathrm{dev}} = A_{ij} - \\frac{1}{2}\\operatorname{tr}(A)\\delta_{ij}$。最小二乘法最小化问题 $\\partial/\\partial(C_s^2) \\left[ (L_{ij}^{\\mathrm{dev}} - C_s^2 M_{ij}^{\\mathrm{dev}})(L_{ij}^{\\mathrm{dev}} - C_s^2 M_{ij}^{\\mathrm{dev}}) \\right] = 0$ 产生的解为：\n$$\nC_s^2 = \\frac{L_{ij}^{\\mathrm{dev}} M_{ij}^{\\mathrm{dev}}}{M_{kl}^{\\mathrm{dev}} M_{kl}^{\\mathrm{dev}}}\n$$\n对于对称二维张量，张量缩并 $A_{ij}B_{ij}$ 为 $A_{xx}B_{xx} + A_{yy}B_{yy} + 2A_{xy}B_{xy}$。\n\n得到的 $C_s^2$ 场可能含有负值，这对于纯耗散的 Smagorinsky 模型来说是非物理的。问题指定了两种处理方法：\n1.  **截断**：任何负的 $C_s^2$ 值都简单地设为零，即 $C_s^2 \\leftarrow \\max(0, C_s^2)$。\n2.  **局部平均**：为提高稳定性，首先在局部计算分子 $N_{LS} = L_{ij}^{\\mathrm{dev}} M_{ij}^{\\mathrm{dev}}$ 和分母 $D_{LS} = M_{kl}^{\\mathrm{dev}} M_{kl}^{\\mathrm{dev}}$，然后在一个小的模板（$3 \\times 3$ 箱式滤波器）上进行平均。然后系数计算为 $C_s^2 = \\langle N_{LS} \\rangle / \\langle D_{LS} \\rangle$。使用一个正则化阈值 $\\varepsilon$ 来防止除以小数，并且任何得到的负值都被截断为零。\n\n该算法在均匀周期性网格上进行数值实现。空间导数使用带有周期性边界条件的二阶中心有限差分来近似。网格和测试滤波器实现为带有周期性边界条件的离散箱式平均。\n\n每个测试案例的总体算法流程如下：\n1.  构建 $N \\times N$ 网格并初始化速度分量 $u(x,y)$ 和 $v(x,y)$。\n2.  使用中心有限差分计算所有必需的空间导数（$\\partial_x u, \\partial_y u, \\partial_x v, \\partial_y v$）。\n3.  计算网格尺度应变率张量分量 $S_{xx}, S_{yy}, S_{xy}$ 和应变率大小 $|S|$。\n4.  将 $3 \\times 3$ 箱式测试滤波器应用于速度分量（$u, v$）得到 $\\widetilde{u}, \\widetilde{v}$，以及所需的速度乘积（$u^2, v^2, uv$）得到 $\\widetilde{u^2}, \\widetilde{v^2}, \\widetilde{uv}$。\n5.  计算 Leonard 应力张量分量 $L_{ij} = \\widetilde{u_i u_j} - \\widetilde{u_i}\\widetilde{u_j}$。\n6.  计算滤波后场的应变率张量 $\\widetilde{S}_{ij}$ 及其大小 $|\\widetilde{S}|$。\n7.  将测试滤波器应用于乘积 $|S|S_{ij}$。\n8.  组装模型张量分量 $M_{ij} = 2(\\Delta^2\\widetilde{|S|S_{ij}} - \\hat{\\Delta}^2|\\widetilde{S}|\\widetilde{S}_{ij})$。\n9.  计算偏量部分 $L_{ij}^{\\mathrm{dev}}$ 和 $M_{ij}^{\\mathrm{dev}}$。\n10. 在每个网格点上计算最小二乘公式的分子 $N_{LS} = L_{ij}^{\\mathrm{dev}} M_{ij}^{\\mathrm{dev}}$ 和分母 $D_{LS} = M_{ij}^{\\mathrm{dev}} M_{ij}^{\\mathrm{dev}}$。\n11. 应用指定的负值处理程序（截断或局部平均）来计算最终的 $C_s^2$ 场。\n12. 计算并存储所得 $C_s^2$ 场的空间平均值。\n对所有三个测试案例重复此过程以产生最终结果。", "answer": "[0.000000,0.016335,0.017300]", "id": "3537227"}]}