{"hands_on_practices": [{"introduction": "在构建复杂的宇宙线磁流体动力学模型之前，通过量级估算来理解主导的物理过程至关重要。本练习将指导您使用典型的银河系盘参数，比较平流、流以及扩散的特征时标，从而建立对宇宙线输运物理的直观理解。通过这项基础计算，您可以判断在特定天体物理环境中哪种输运机制起决定性作用[@problem_id:3518661]。", "problem": "考虑在银盘的一个分层区域中的宇宙线磁流体动力学（CR-MHD），该区域被建模为一个特征尺寸为 $L$ 的一维板，其中贯穿着强度为 $B_{0}$ 的均匀磁场，其质量密度为 $\\rho$，体气平流速度为 $U$，宇宙线（CR）平行扩散系数为 $\\kappa_{\\parallel}$。假设等离子体可以很好地由理想磁流体动力学（MHD）描述，因此沿磁场传播的小振幅横波速度（阿尔芬速度）由平衡场和密度决定。对于沿平均场的宇宙线输运，有三种相关机制：随气体平流、以阿尔芬速度流串以及平行扩散。在尺度 $L$ 上的输运特征量纲时间尺度分别为：平流为 $L/U$，流串为 $L/v_{A}$，扩散为 $L^{2}/\\kappa_{\\parallel}$。\n\n从理想MHD方程和核心定义出发，首先得到阿尔芬速度 $v_{A}$ 关于 $B_{0}$ 和 $\\rho$ 的表达式。然后，构建流串和扩散时间尺度与平流时间尺度的无量纲比值，并用它们来量化在以下基准银盘模型中哪个过程最快：\n- $L = 1.0$ 千秒差距，\n- $U = 10$ 公里/秒，\n- $B_{0} = 5.0$ 微高斯，\n- $\\rho = 1.67 \\times 10^{-24}$ 克/立方厘米，\n- $\\kappa_{\\parallel} = 3.0 \\times 10^{28}$ 平方厘米/秒。\n\n使用厘米-克-秒（cgs）单位制进行计算，其中 $1\\,\\mathrm{pc} = 3.086 \\times 10^{18}\\,\\mathrm{cm}$ 且 $1\\,\\mathrm{G}$ 代表高斯。定义无量纲比值\n$$\nR \\equiv \\frac{\\min\\left\\{L/U,\\;L/v_{A},\\;L^{2}/\\kappa_{\\parallel}\\right\\}}{L/U},\n$$\n该比值衡量了最快输运时间尺度相对于平流时间尺度的关系。根据上述基准参数计算 $R$。将您的答案四舍五入到四位有效数字。将 $R$ 作为无单位的无量纲数报告。", "solution": "解答包含两个主要部分：首先，从理想MHD方程推导阿尔芬速度；其次，根据给定参数计算无量纲比值 $R$。\n\n**第一部分：阿尔芬速度 ($v_A$) 的推导**\n\n理想MHD方程组在cgs-高斯单位制下包括连续性方程、动量方程和感应方程。我们考虑一个均匀、静态的背景等离子体（密度 $\\rho_0$，速度 $\\mathbf{v}_0 = 0$），其中贯穿着一个均匀磁场 $\\mathbf{B}_0 = B_0 \\hat{z}$。我们引入小振幅的横波微扰 $\\mathbf{v}_1(z, t)$ 和 $\\mathbf{B}_1(z, t)$，它们垂直于传播方向 $\\hat{z}$。\n\n线性化的动量方程和感应方程简化为：\n$$\n\\rho_0 \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{4\\pi} (\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0\n$$\n$$\n\\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) = (\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{v}_1 = B_0 \\frac{\\partial \\mathbf{v}_1}{\\partial z}\n$$\n对动量方程求时间导数，并代入感应方程的结果，经过矢量运算化简后，可以得到一个关于速度微扰 $\\mathbf{v}_1$ 的标准波动方程：\n$$\n\\frac{\\partial^2 \\mathbf{v}_1}{\\partial t^2} = \\frac{B_0^2}{4\\pi \\rho_0} \\frac{\\partial^2 \\mathbf{v}_1}{\\partial z^2}\n$$\n从这个波动方程中，我们可以直接读出波速的平方，即阿尔芬速度 $v_A$ 的平方：\n$$\nv_A^2 = \\frac{B_0^2}{4\\pi \\rho_0}\n$$\n取平方根并使用问题的符号（用 $\\rho$ 表示背景密度），我们得到：\n$$\nv_A = \\frac{B_0}{\\sqrt{4\\pi \\rho}}\n$$\n\n**第二部分：无量纲比值 $R$ 的计算**\n\n我们首先将所有参数转换为cgs单位。\n- $L = 1.0\\,\\mathrm{kpc} = 10^3\\,\\mathrm{pc} = 10^3 \\times (3.086 \\times 10^{18}\\,\\mathrm{cm}) = 3.086 \\times 10^{21}\\,\\mathrm{cm}$\n- $U = 10\\,\\mathrm{km/s} = 10 \\times 10^5\\,\\mathrm{cm/s} = 1.0 \\times 10^6\\,\\mathrm{cm/s}$\n- $B_0 = 5.0\\,\\mu\\mathrm{G} = 5.0 \\times 10^{-6}\\,\\mathrm{G}$\n- $\\rho = 1.67 \\times 10^{-24}\\,\\mathrm{g/cm^3}$\n- $\\kappa_{\\parallel} = 3.0 \\times 10^{28}\\,\\mathrm{cm^2/s}$\n\n接下来，我们使用推导出的公式计算阿尔芬速度 $v_A$：\n$$\nv_A = \\frac{B_0}{\\sqrt{4\\pi \\rho}} = \\frac{5.0 \\times 10^{-6}}{\\sqrt{4\\pi(1.67 \\times 10^{-24})}} \\approx \\frac{5.0 \\times 10^{-6}}{\\sqrt{2.09858 \\times 10^{-23}}} \\approx \\frac{5.0 \\times 10^{-6}}{4.58103 \\times 10^{-12}} \\approx 1.09146 \\times 10^6\\,\\mathrm{cm/s}\n$$\n问题要求计算 $R = \\frac{\\min\\left\\{\\tau_{adv}, \\tau_{stream}, \\tau_{diff}\\right\\}}{\\tau_{adv}}$，其中 $\\tau_{adv} = L/U$，$\\tau_{stream} = L/v_A$，$\\tau_{diff} = L^2/\\kappa_{\\parallel}$。这等价于找到 $\\{1, \\tau_{stream}/\\tau_{adv}, \\tau_{diff}/\\tau_{adv}\\}$ 中的最小值。\n\n我们计算各时间尺度与平流时间尺度的比值：\n1. 流串与平流时间尺度之比：\n$$\n\\frac{\\tau_{stream}}{\\tau_{adv}} = \\frac{L/v_A}{L/U} = \\frac{U}{v_A} = \\frac{1.0 \\times 10^6\\,\\mathrm{cm/s}}{1.09146 \\times 10^6\\,\\mathrm{cm/s}} \\approx 0.91619\n$$\n2. 扩散与平流时间尺度之比：\n$$\n\\frac{\\tau_{diff}}{\\tau_{adv}} = \\frac{L^2/\\kappa_{\\parallel}}{L/U} = \\frac{LU}{\\kappa_{\\parallel}} = \\frac{(3.086 \\times 10^{21}\\,\\mathrm{cm})(1.0 \\times 10^6\\,\\mathrm{cm/s})}{3.0 \\times 10^{28}\\,\\mathrm{cm^2/s}} = \\frac{3.086 \\times 10^{27}}{3.0 \\times 10^{28}} \\approx 0.10287\n$$\n比较这三个无量纲时间尺度 $\\{1, 0.91619, 0.10287\\}$，最小值是扩散时间尺度对应的比值，约为 $0.10287$。这表明对于这些参数，扩散是最快的输运过程。\n\n因此，无量纲比值 $R$ 为：\n$$\nR = \\frac{\\tau_{diff}}{\\tau_{adv}} = \\frac{LU}{\\kappa_{\\parallel}} = \\frac{3.086 \\times 10^{27}}{3.0 \\times 10^{28}} = 0.1028666...\n$$\n根据要求，将答案四舍五入到四位有效数字，得到：\n$$\nR \\approx 0.1029\n$$", "answer": "$$\\boxed{0.1029}$$", "id": "3518661"}, {"introduction": "在物理估算之后，我们转向解析模型，这是验证数值代码的基石。本练习将引导您推导一维宇宙线“流不稳定性”测试问题的精确解，该问题是宇宙线磁流体动力学领域的经典基准测试之一。通过求解这个黎曼问题，您将揭示在自约束模型下宇宙线如何传播，以及它们如何通过波的阻尼来加热背景气体[@problem_id:3518694]。", "problem": "考虑一个一维、磁化、静止的背景等离子体，其质量密度均匀，磁场沿 $x$ 轴方向均匀。阿尔芬速度（大小）为常数 $v_A$，气体速度为零。宇宙射线（CRs）被建模为绝热指数 $\\gamma_c = 4/3$ 的超相对论性流体，因此宇宙射线的能量密度和压强满足 $e_c = P_c/(\\gamma_c - 1) = 3 P_c$，宇宙射线的焓密度为 $e_c + P_c = 4 P_c$。在自约束假设下，宇宙射线沿磁场以漂流速度 $v_s = -\\,v_A\\,\\mathrm{sgn}(\\partial_x P_c)$ 流动，其中 $\\mathrm{sgn}$ 是符号函数。\n\n在时间 $t=0$ 时，宇宙射线压强初始化为一个阶跃函数：\n$$\nP_c(x,0) = \\begin{cases}\nP_L,   x \\le 0, \\\\\nP_R,   x > 0,\n\\end{cases}\n$$\n其中 $P_L > P_R$，且 $P_L$ 和 $P_R$ 均为正常数。\n\n从耦合的宇宙射线-气体系统的能量守恒和宇宙射线漂流的自约束闭合关系出发，推导在分布意义下所有 $t>0$ 时宇宙射线能量通量 $F_c(x,t)$ 和气体体积加热率 $H(x,t)$ 的精确时间演化。使用赫维赛德阶跃函数 $H(z)$ 表示任何不连续性，并使用狄拉克δ分布 $\\delta(z)$ 表示任何奇异的加热层。假设宇宙射线和气体之间唯一的能量交换是共振波加热，并且阿尔芬速度 $v_A$ 在时间和空间上保持不变。\n\n最后，计算单位横截面积上的总气体加热功率，\n$$\nQ(t) \\equiv \\int_{-\\infty}^{+\\infty} H(x,t)\\,dx,\n$$\n并将其表示为关于 $v_A$、$P_L$ 和 $P_R$ 的封闭形式解析表达式。将最终量 $Q(t)$ 作为你的最终答案。最终答案需用cgs单位（erg cm$^{-2}$ s$^{-1}$）表示。不需要进行数值代入；请提供精确表达式。", "solution": "问题要求解宇宙射线（CR）能量通量 $F_c(x,t)$、气体加热率 $H(x,t)$ 和总加热功率 $Q(t)$ 的时间演化。我们从宇宙射线流体的基本守恒定律开始。\n\n宇宙射线的能量密度为 $e_c = 3P_c$。宇宙射线能量守恒由以下方程描述：\n$$\n\\frac{\\partial e_c}{\\partial t} + \\frac{\\partial F_c}{\\partial x} = -H\n$$\n其中 $H$ 是从宇宙射线到气体的能量转移率（加热率）。背景气体速度为零，因此宇宙射线能量通量 $F_c$ 仅由漂流引起：\n$$\nF_c = (e_c + P_c) v_s = 4 P_c v_s\n$$\n问题指定宇宙射线漂流速度为 $v_s = -v_A\\,\\mathrm{sgn}(\\partial_x P_c)$，加热率由宇宙射线对漂流运动做功产生，在自约束模型中为 $H = -v_s \\partial_x P_c$。代入 $v_s$ 的表达式：\n$$\nH = -(-v_A\\,\\mathrm{sgn}(\\partial_x P_c)) \\partial_x P_c = v_A\\,\\mathrm{sgn}(\\partial_x P_c) \\partial_x P_c = v_A |\\partial_x P_c|\n$$\n\n现在，我们构建宇宙射线压强 $P_c$ 的演化方程。将 $e_c=3P_c$、$F_c = 4P_c v_s$ 和 $H=v_A|\\partial_x P_c|$ 代入能量守恒方程。初始条件是当 $x \\le 0$ 时 $P_c(x,0) = P_L$，当 $x > 0$ 时 $P_c(x,0) = P_R$，且 $P_L > P_R$。这意味着在任何时间 $t>0$，随着 $x$ 的增加，压强必须从一个高值过渡到一个低值。因此，在梯度非零的任何地方，我们必须有 $\\partial_x P_c \\le 0$，这意味着 $\\mathrm{sgn}(\\partial_x P_c) = -1$ 且 $|\\partial_x P_c| = -\\partial_x P_c$。\n方程变为：\n$$\n3\\frac{\\partial P_c}{\\partial t} + \\frac{\\partial}{\\partial x} \\left(4 P_c (v_A)\\right) = -v_A (-\\partial_x P_c)\n$$\n$$\n3\\frac{\\partial P_c}{\\partial t} + 4v_A \\frac{\\partial P_c}{\\partial x} = v_A \\frac{\\partial P_c}{\\partial x}\n$$\n$$\n3\\frac{\\partial P_c}{\\partial t} + 3v_A \\frac{\\partial P_c}{\\partial x} = 0 \\implies \\frac{\\partial P_c}{\\partial t} + v_A \\frac{\\partial P_c}{\\partial x} = 0\n$$\n这是一个线性平流方程，它表明 $P_c$ 的任何初始剖面都将以恒定速度 $v_A$ 向 $x$ 轴正方向传播，且形状不变。对于给定的初始阶跃函数，解为 $P_c(x,t) = P_c(x - v_A t, 0)$。使用赫维赛德阶跃函数 $H(z)$（其中当 $z>0$ 时 $H(z)=1$，当 $z \\le 0$ 时 $H(z)=0$），我们可以将 $t>0$ 时的解写为：\n$$\nP_c(x,t) = P_L H(-(x-v_A t)) + P_R H(x-v_A t) = P_L + (P_R - P_L) H(x - v_A t)\n$$\n这描述了一个位于 $x=v_A t$ 并向右移动的接触间断。\n\n接下来，我们推导加热率 $H(x,t)$。在分布意义下，对 $P_c(x,t)$ 关于 $x$ 求导（$\\frac{d}{dz}H(z) = \\delta(z)$）：\n$$\n\\partial_x P_c(x,t) = (P_R - P_L) \\delta(x - v_A t)\n$$\n加热率为：\n$$\nH(x,t) = v_A |\\partial_x P_c| = v_A |(P_R - P_L) \\delta(x - v_A t)| = v_A (P_L - P_R) \\delta(x - v_A t)\n$$\n这表明所有的加热都发生在一个与宇宙射线压强前沿共同移动的无限薄层中。\n\n我们通过积分 $\\partial_x F_c = -\\partial_t(3P_c) - H(x,t)$ 来求解宇宙射线能量通量 $F_c(x,t)$。\n$$\n\\frac{\\partial F_c}{\\partial x} = -3\\frac{\\partial P_c}{\\partial t} - H(x,t) = -3(v_A \\partial_x P_c) - v_A|\\partial_x P_c| = -3v_A (P_R-P_L)\\delta(x-v_A t) - v_A(P_L-P_R)\\delta(x-v_A t)\n$$\n$$\n\\frac{\\partial F_c}{\\partial x} = 4v_A (P_R - P_L) \\delta(x - v_A t)\n$$\n对 $x$ 进行积分，并应用边界条件 $F_c \\to 0$ as $x \\to -\\infty$，我们得到：\n$$\nF_c(x,t) = 4v_A (P_R - P_L) H(x - v_A t)\n$$\n这描述了一个在前沿上游（$x  v_A t$）为零，而在下游（$x > v_A t$）具有恒定负值 $4v_A(P_R-P_L)$ 的通量。\n\n最后，我们计算单位横截面积上的总气体加热功率 $Q(t)$：\n$$\nQ(t) = \\int_{-\\infty}^{+\\infty} H(x,t)\\,dx = \\int_{-\\infty}^{+\\infty} v_A (P_L - P_R) \\delta(x - v_A t)\\,dx\n$$\n利用狄拉克δ函数的积分性质，我们得到：\n$$\nQ(t) = v_A (P_L - P_R)\n$$\n结果不随时间变化，单位正确（$\\text{erg cm}^{-2} \\text{s}^{-1}$）。", "answer": "$$\\boxed{v_A(P_L - P_R)}$$", "id": "3518694"}, {"introduction": "从解析理论过渡到计算实践，数值模拟的核心是在离散网格上正确实现物理通量。本练习将指导您完成各向异性扩散通量的离散化过程，这是任何宇宙线磁流体动力学代码的关键组成部分。您将学习如何结合重构的梯度和通量限制器等关键数值技术来计算通过单元面的通量[@problem_id:3518646]。", "problem": "考虑笛卡尔网格上磁流体动力学中的宇宙线各向异性扩散。宇宙线压力（记为 $P_c$）主要沿磁场方向进行扩散输运。网格由具有单位面法向 $\\hat{\\boldsymbol{n}}$ 的平面单元面组成。每个单元面分隔一个“左”单元和一个“右”单元，从这两个单元对 $P_c$ 进行分段线性重构，可以得到在单元面上求值的以单元为中心的梯度。面中心的磁场方向由一个向量 $\\boldsymbol{b}$ 给出（其长度可能不为1），平行扩散系数是一个标量 $\\kappa_{\\parallel}$。\n\n基本原理：磁流体动力学中沿磁力线的各向异性扩散的扩散输运定律遵循一个本构关系，该关系基于推广到与磁场对齐的二阶传导张量的菲克定律：宇宙线压力的通量密度沿磁场方向，且与 $P_c$ 沿该场的方向导数成正比。令单位磁场方向为 $\\hat{\\boldsymbol{b}} = \\boldsymbol{b}/\\|\\boldsymbol{b}\\|$（对于 $\\|\\boldsymbol{b}\\| \\neq 0$）。沿 $\\hat{\\boldsymbol{b}}$ 的方向导数为 $\\hat{\\boldsymbol{b}}\\cdot\\nabla P_c$。离散的面法向通量应使用两侧重构的梯度和一个保持单调性的限制器来计算，以防止跨极值点的伪扩散。\n\n任务：对于每个单元面，使用从上述基本原理推导出的以下步骤，计算通过该面的标量通量，即各向异性扩散通量的法向分量：\n1. 将给定的面中心磁场方向归一化为 $\\hat{\\boldsymbol{b}}$。如果 $\\|\\boldsymbol{b}\\|=0$，则将通量定义为零。\n2. 将面法向归一化为单位向量 $\\hat{\\boldsymbol{n}}$。\n3. 根据左右两侧重构的梯度（记为 $\\nabla P_c^{L}$ 和 $\\nabla P_c^{R}$），计算方向导数 $s_L = \\hat{\\boldsymbol{b}}\\cdot\\nabla P_c^{L}$ 和 $s_R = \\hat{\\boldsymbol{b}}\\cdot\\nabla P_c^{R}$。\n4. 应用 minmod 限制器以获得一个受限的方向导数 $s^{\\star}$，其定义如下\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),   \\text{if } a\\,b0,\\\\\n0,   \\text{otherwise},\n\\end{cases}\n$$\n并设置 $s^{\\star} = \\operatorname{minmod}(s_L,s_R)$。\n5. 计算面上的各向异性扩散通量向量为\n$$\n\\boldsymbol{F}_{\\text{diff}} = -\\kappa_{\\parallel}\\, s^{\\star}\\, \\hat{\\boldsymbol{b}},\n$$\n然后计算通过该面的标量通量（即要输出的量）为\n$$\n\\phi = \\boldsymbol{F}_{\\text{diff}}\\cdot \\hat{\\boldsymbol{n}}.\n$$\n\n所有量均采用一致的代码单位。您必须以代码单位输出每个面的标量通量 $\\phi$。无需报告任何角度，但任何向量归一化都必须在欧几里得意义上进行。您的程序必须精确地实现以上步骤。\n\n测试套件：使用以下六个具有指定参数的面，每个参数均以代码单位给出。对于每种情况，输入为 $(\\kappa_{\\parallel},\\, \\boldsymbol{b},\\, \\hat{\\boldsymbol{n}},\\, \\nabla P_c^{L},\\, \\nabla P_c^{R})$。\n- 情况 1 (理想情况，磁场与面法向对齐):\n  $(0.5,\\,(1,0,0),\\,(1,0,0),\\,(1,0,0),\\,(3,0,0))$.\n- 情况 2 (磁场与面法向相切，投影为零):\n  $(1.0,\\,(0,1,0),\\,(1,0,0),\\,(10,0,0),\\,(10,0,0))$.\n- 情况 3 (方向导数相反，限制器结果为零):\n  $(0.25,\\,(1,1,0),\\,(0,1,0),\\,(4,0,0),\\,(-4,0,0))$.\n- 情况 4 (斜交场和非零的受限导数):\n  $(0.25,\\,(1,1,0),\\,(0,1,0),\\,(3,1,0),\\,(5,1,0))$.\n- 情况 5 (扩散系数为零):\n  $(0.0,\\,(0,0,5),\\,(0,0,1),\\,(0,0,2),\\,(0,0,2))$.\n- 情况 6 (磁场方向向量为零):\n  $(1.0,\\,(0,0,0),\\,(1,0,0),\\,(1,2,3),\\,(1,2,3))$.\n\n答案规格与最终输出格式：对于每种情况，计算如上定义的标量通量 $\\phi$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\phi_1,\\phi_2,\\ldots,\\phi_6]$，其中每个 $\\phi_i$ 是一个以代码单位表示的浮点数。\n\n程序不应读取任何外部输入；必须将测试套件硬编码并计算输出。此问题纯粹是数学和算法问题；在归一化向量时，请确保数值稳定性并避免除以零。", "solution": "任务是为六个给定情景计算通过单元面的标量扩散通量 $\\phi$。我们将精确遵循问题中描述的多步骤算法。\n\n**通用算法**\n\n对于每组输入 $(\\kappa_{\\parallel}, \\boldsymbol{b}, \\hat{\\boldsymbol{n}}, \\nabla P_c^{L}, \\nabla P_c^{R})$：\n\n1.  **归一化磁场向量**：计算磁场向量的欧几里得范数 $\\|\\boldsymbol{b}\\|$。如果 $\\|\\boldsymbol{b}\\| = 0$，则标量通量 $\\phi = 0$。否则，计算单位向量 $\\hat{\\boldsymbol{b}} = \\boldsymbol{b} / \\|\\boldsymbol{b}\\|$。\n2.  **归一化面法向向量**：确保面法向 $\\hat{\\boldsymbol{n}}$ 是单位向量。在给定的测试套件中，它们已经是单位向量。\n3.  **计算方向导数**：计算左右两侧压力梯度沿磁场方向的投影：$s_L = \\hat{\\boldsymbol{b}} \\cdot \\nabla P_c^{L}$ 和 $s_R = \\hat{\\boldsymbol{b}} \\cdot \\nabla P_c^{R}$。\n4.  **应用Minmod限制器**：使用 $\\operatorname{minmod}$ 函数计算受限的方向导数 $s^{\\star} = \\operatorname{minmod}(s_L, s_R)$。如果 $s_L$ 和 $s_R$ 符号相反或任一为零，则 $s^{\\star} = 0$。否则， $s^{\\star}$ 取两者中绝对值较小的一个。\n5.  **计算标量通量**：首先构建各向异性扩散通量向量 $\\boldsymbol{F}_{\\text{diff}} = -\\kappa_{\\parallel} s^{\\star} \\hat{\\boldsymbol{b}}$。然后，将其投影到面法向上得到最终的标量通量 $\\phi = \\boldsymbol{F}_{\\text{diff}} \\cdot \\hat{\\boldsymbol{n}}$。\n\n**应用于测试用例**\n\n**情况 1**：$(\\kappa_{\\parallel}=0.5, \\boldsymbol{b}=(1,0,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(1,0,0), \\nabla P_c^{R}=(3,0,0))$\n1.  $\\hat{\\boldsymbol{b}} = (1,0,0)$。\n2.  $\\hat{\\boldsymbol{n}}=(1,0,0)$。\n3.  $s_L = (1,0,0) \\cdot (1,0,0) = 1$。$s_R = (1,0,0) \\cdot (3,0,0) = 3$。\n4.  $s^{\\star} = \\operatorname{minmod}(1, 3) = 1$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = -0.5 \\cdot 1 \\cdot (1,0,0) = (-0.5, 0, 0)$。\n    $\\phi = (-0.5, 0, 0) \\cdot (1,0,0) = -0.5$。\n\n**情况 2**：$(\\kappa_{\\parallel}=1.0, \\boldsymbol{b}=(0,1,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(10,0,0), \\nabla P_c^{R}=(10,0,0))$\n1.  $\\hat{\\boldsymbol{b}} = (0,1,0)$。\n2.  $\\hat{\\boldsymbol{n}}=(1,0,0)$。\n3.  $s_L = (0,1,0) \\cdot (10,0,0) = 0$。$s_R = (0,1,0) \\cdot (10,0,0) = 0$。\n4.  $s^{\\star} = \\operatorname{minmod}(0, 0) = 0$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = (0,0,0)$。\n    $\\phi = (0,0,0) \\cdot (1,0,0) = 0.0$。\n\n**情况 3**：$(\\kappa_{\\parallel}=0.25, \\boldsymbol{b}=(1,1,0), \\hat{\\boldsymbol{n}}=(0,1,0), \\nabla P_c^{L}=(4,0,0), \\nabla P_c^{R}=(-4,0,0))$\n1.  $\\|\\boldsymbol{b}\\| = \\sqrt{2}$。$\\hat{\\boldsymbol{b}} = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$。\n2.  $\\hat{\\boldsymbol{n}}=(0,1,0)$。\n3.  $s_L = (1/\\sqrt{2}, 1/\\sqrt{2}, 0) \\cdot (4,0,0) = 4/\\sqrt{2}$。\n    $s_R = (1/\\sqrt{2}, 1/\\sqrt{2}, 0) \\cdot (-4,0,0) = -4/\\sqrt{2}$。\n4.  $s_L$ 和 $s_R$ 符号相反，因此 $s^{\\star} = 0$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = (0,0,0)$。\n    $\\phi = (0,0,0) \\cdot (0,1,0) = 0.0$。\n\n**情况 4**：$(\\kappa_{\\parallel}=0.25, \\boldsymbol{b}=(1,1,0), \\hat{\\boldsymbol{n}}=(0,1,0), \\nabla P_c^{L}=(3,1,0), \\nabla P_c^{R}=(5,1,0))$\n1.  $\\hat{\\boldsymbol{b}} = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$。\n2.  $\\hat{\\boldsymbol{n}}=(0,1,0)$。\n3.  $s_L = (1/\\sqrt{2}, 1/\\sqrt{2}, 0) \\cdot (3,1,0) = 4/\\sqrt{2} = 2\\sqrt{2}$。\n    $s_R = (1/\\sqrt{2}, 1/\\sqrt{2}, 0) \\cdot (5,1,0) = 6/\\sqrt{2} = 3\\sqrt{2}$。\n4.  $s^{\\star} = \\operatorname{minmod}(2\\sqrt{2}, 3\\sqrt{2}) = 2\\sqrt{2}$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = -0.25 \\cdot (2\\sqrt{2}) \\cdot (1/\\sqrt{2}, 1/\\sqrt{2}, 0) = -0.5\\sqrt{2} \\cdot (1/\\sqrt{2}, 1/\\sqrt{2}, 0) = (-0.5, -0.5, 0)$。\n    $\\phi = (-0.5, -0.5, 0) \\cdot (0,1,0) = -0.5$。\n\n**情况 5**：$(\\kappa_{\\parallel}=0.0, \\boldsymbol{b}=(0,0,5), \\hat{\\boldsymbol{n}}=(0,0,1), \\nabla P_c^{L}=(0,0,2), \\nabla P_c^{R}=(0,0,2))$\n由于 $\\kappa_{\\parallel} = 0.0$，$\\boldsymbol{F}_{\\text{diff}}$ 必为零。因此 $\\phi = 0.0$。\n\n**情况 6**：$(\\kappa_{\\parallel}=1.0, \\boldsymbol{b}=(0,0,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(1,2,3), \\nabla P_c^{R}=(1,2,3))$\n由于 $\\boldsymbol{b} = (0,0,0)$，根据规则，$\\phi = 0.0$。\n\n六种情况最终计算出的标量通量为：$-0.5$, $0.0$, $0.0$, $-0.5$, $0.0$, $0.0$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the anisotropic diffusive scalar flux for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        (0.5, np.array([1.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([3.0, 0.0, 0.0])),\n        # Case 2\n        (1.0, np.array([0.0, 1.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([10.0, 0.0, 0.0]), np.array([10.0, 0.0, 0.0])),\n        # Case 3\n        (0.25, np.array([1.0, 1.0, 0.0]), np.array([0.0, 1.0, 0.0]), np.array([4.0, 0.0, 0.0]), np.array([-4.0, 0.0, 0.0])),\n        # Case 4\n        (0.25, np.array([1.0, 1.0, 0.0]), np.array([0.0, 1.0, 0.0]), np.array([3.0, 1.0, 0.0]), np.array([5.0, 1.0, 0.0])),\n        # Case 5\n        (0.0, np.array([0.0, 0.0, 5.0]), np.array([0.0, 0.0, 1.0]), np.array([0.0, 0.0, 2.0]), np.array([0.0, 0.0, 2.0])),\n        # Case 6\n        (1.0, np.array([0.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([1.0, 2.0, 3.0]), np.array([1.0, 2.0, 3.0])),\n    ]\n\n    results = []\n    \n    def minmod(a, b):\n        if a * b > 0:\n            return np.sign(a) * np.min([np.abs(a), np.abs(b)])\n        else:\n            return 0.0\n\n    for case in test_cases:\n        kappa_parallel, b, n_face, grad_P_L, grad_P_R = case\n\n        b_norm = np.linalg.norm(b)\n        if b_norm == 0.0:\n            phi = 0.0\n            results.append(phi)\n            continue\n        \n        b_hat = b / b_norm\n\n        n_norm = np.linalg.norm(n_face)\n        if n_norm == 0.0:\n            phi = 0.0\n            results.append(phi)\n            continue\n        n_hat = n_face / n_norm\n        \n        s_L = np.dot(b_hat, grad_P_L)\n        s_R = np.dot(b_hat, grad_P_R)\n        \n        s_star = minmod(s_L, s_R)\n        \n        F_diff = -kappa_parallel * s_star * b_hat\n        phi = np.dot(F_diff, n_hat)\n        \n        results.append(phi)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3518646"}]}