## 引言
在广袤的宇宙中，[星系的形成与演化](@entry_id:160862)是一部由[引力](@entry_id:175476)、气体动力学和恒星生命周期共同谱写的壮丽史诗。现代[计算天体物理学](@entry_id:145768)通过大规模[数值模拟](@entry_id:137087)，试图在计算机中重现这一过程。然而，一个根本性的挑战横亘其中：[星系演化](@entry_id:158840)的尺度跨度巨大，从横跨数十万光年的星系盘，到尺度不足一光年的恒星形成核心，两者之间的尺度差异超过了任何现有或近期可预见的计算机的解析能力。恒星的诞生及其对周围环境的剧烈影响——即[恒星反馈](@entry_id:755431)——恰好发生在这些无法被直接解析的微小尺度上。

为了弥合这一鸿沟，科学家们发展了“[次网格模型](@entry_id:755601)”（sub-grid models）。这些模型并非试图精确模拟每一个微观物理细节，而是通过一套基于物理原理的[参数化](@entry_id:272587)“处方”，来捕捉那些无法解析的过程对模拟宏观演化的集[体效应](@entry_id:261475)。本文旨在系统性地剖析用于[恒星形成](@entry_id:159940)与[恒星反馈](@entry_id:755431)的[次网格模型](@entry_id:755601)，为读者构建一个从理论基础到前沿应用的完整知识框架。

在接下来的内容中，我们将分三个章节展开探讨。在**“原理与机制”**一章，我们将深入研究[次网格模型](@entry_id:755601)的核心物理基础，从其必要性（如Truelove判据）谈起，详细介绍恒星形成判据、[恒星形成](@entry_id:159940)定律以及各类反馈机制的建模方法。随后，在**“应用与跨学科连接”**一章，我们将展示这些理论如何转化为稳健的数值算法，并应用于解决“[过冷问题](@entry_id:753036)”等关键挑战，同时探讨模型如何再现肯尼科特-施密特关系等宏观观测规律。最后，在**“动手实践”**部分，我们将通过一系列精心设计的问题，引导读者亲手推导和分析[次网格模型](@entry_id:755601)中的关键概念，加深对理论知识的理解。

## 原理与机制

在宇宙学和星系形成的大尺度数值模拟中，由于计算资源的限制，我们无法在整个模拟域内解析所有相关的物理尺度。恒星的形成和其对周围环境的影响（即[恒星反馈](@entry_id:755431)）发生在远小于典型[星系模拟](@entry_id:749694)网格尺寸（通常为数十到数百秒差距）的尺度上。因此，为了在模拟中包含这些至关重要的过程，我们必须采用**[次网格模型](@entry_id:755601) (sub-grid models)**。这些模型旨在捕捉那些无法被直接解析的物理过程的统计或平均效应，并将它们与模拟中可解析的量联系起来。本章将深入探讨[恒星形成](@entry_id:159940)与反馈[次网格模型](@entry_id:755601)的关键原理和核心机制。

### [次网格模型](@entry_id:755601)的必要性：解析度问题

[次网格模型](@entry_id:755601)的根本需求源于一个基本的数值限制：为了确保数值解的物理真实性，必须充分解析控制该过程的关键物理尺度。在[恒星形成](@entry_id:159940)的情境下，这个尺度是**[金斯长度](@entry_id:157888) (Jeans length)**。

在一个自引力、等温的气体介质中，[金斯长度](@entry_id:157888) $\lambda_J$ 是区分[引力](@entry_id:175476)不稳定坍缩和稳定压力[振荡](@entry_id:267781)的临界波长。对于一个密度为 $\rho$、声速为 $c_s$ 的气体，[金斯长度](@entry_id:157888)由下式给出：

$$
\lambda_J = \sqrt{\frac{\pi c_s^2}{G\rho}}
$$

其中 $G$ 是[引力常数](@entry_id:262704)。任何大于 $\lambda_J$ 的扰动都将因自身[引力](@entry_id:175476)而坍缩。在基于网格的[流体动力学模拟](@entry_id:142279)中，为了准确捕捉抵抗坍缩的压力梯度，避免产生非物理的、由网格尺度决定的数值碎裂，[金斯长度](@entry_id:157888)必须被至少 $N_J$ 个网格单元所覆盖。这一要求被称为 **Truelove 判据 (Truelove criterion)**：

$$
\frac{\lambda_J}{\Delta x} \ge N_J
$$

其中 $\Delta x$ 是网格单元的线性尺寸，而 $N_J$ 通常取值为4或更大。

然而，在[星系模拟](@entry_id:749694)的典型环境中，这一判据很容易被违反。考虑一个假设性的[分子云](@entry_id:160702)区域，其声速 $c_s = 0.2\,\mathrm{km\,s^{-1}}$，背景密度 $\rho_0 = 2\times 10^{-21}\,\mathrm{g\,cm^{-3}}$。在这种条件下，[金斯长度](@entry_id:157888)约为 $\lambda_J \approx 1.0\,\mathrm{pc}$。如果一个模拟使用 $\Delta x = 0.5\,\mathrm{pc}$ 的网格分辨率，并要求 $N_J=4$，那么 Truelove 判据要求 $\Delta x \le \lambda_J/N_J \approx 0.25\,\mathrm{pc}$。显然，该模拟的分辨率 $0.5\,\mathrm{pc}$ 不满足此条件。[@problem_id:3537920]

当 Truelove 判据被违反时，模拟无法正确解析坍缩尺度上的压力支持，导致纯粹的数值碎裂，并可能因密度高估而导致过度的[辐射冷却](@entry_id:754014)。这正是必须引入[次网格模型](@entry_id:755601)的原因：我们必须用一个[参数化](@entry_id:272587)的“处方”来替代我们无法解析的[引力坍缩](@entry_id:161275)、恒星形成和早期反馈过程。

### 引力坍缩与恒星形成的[次网格模型](@entry_id:755601)

一旦确定某个区域的气体倾向于[引力坍缩](@entry_id:161275)，我们就需要模型来描述接下来在次网格尺度上发生的物理过程。

#### “汇聚粒子”：捕捉未解析的坍缩

为了处理无法解析的引力坍缩，模拟中常引入**汇聚粒子 (sink particles)**。汇聚粒子是一种数值构造，作为一个拉格朗日[控制体](@entry_id:143882)，代表一个正在进行引力坍缩的致密核心。它的核心功能是从周围的[计算网格](@entry_id:168560)中吸积气体质量和动量，从而将气体从[流体动力学](@entry_id:136788)求解中移除，并将其质量计入一个离散的粒子中。[@problem_id:3537925]

一个设计良好的汇聚粒子算法必须遵守基本的[守恒定律](@entry_id:269268)。汇聚[粒子质量](@entry_id:156313)的增长率必须精确等于通过其吸积边界流入的质量通量。同样，其动量的变化（除[引力](@entry_id:175476)等外力外）必须等于被吸积气体的[动量通量](@entry_id:199796)。这确保了“气体+汇聚粒子”系统的总质量和动量是守恒的。

此外，吸积过程必须基于物理判据。一个关键的判据是，只有**[引力](@entry_id:175476)束缚 (gravitationally bound)** 于汇聚粒子的气体才能被吸积。在汇聚粒子的[参考系](@entry_id:169232)中，一个气体单元的[引力](@entry_id:175476)束缚状态由其总比能 $e_{\text{total}}$ 决定，该能量是比动能 $e_k = \frac{1}{2}|\mathbf{v}_{\text{gas}} - \mathbf{v}_{\text{sink}}|^2$、比热能 $u$ 和比[引力势能](@entry_id:269038) $\phi$ 的总和。要求 $e_{\text{total}}  0$ 确保了只有那些没有足够能量逃离汇聚粒子引力势阱的气体才会被吸积，这与模拟坍缩流的物理图像是一致的。[@problem_id:3537925]

#### 恒星形成率的处方

当气体满足形成恒星的条件时，我们需要一个“处方”来决定恒星形成的速度。

##### [恒星形成](@entry_id:159940)的判据

首先，我们需要一个判据来确定一个网格单元中的气体是否应该形成恒星。
*   **密度阈值 (Density Threshold)**：最简单的方法是设置一个[临界密度](@entry_id:162027)阈值 $n_{\text{th}}$。任何密度 $n \ge n_{\text{th}}$ 的气体都被允许形成恒星。这种方法的优点是简单，但缺点是物理动机不足，并且对数值分辨率高度敏感。
*   **维里判据 (Virial Criterion)**：一个更具物理意义的方法是使用**维里参数 (virial parameter)** $\alpha_{\text{vir}}$。维里参数定义为气体云总动能的两倍与其引力势能[绝对值](@entry_id:147688)的比值：$\alpha_{\text{vir}} = 2E_{\text{kin}}/|E_{\text{grav}}|$。对于一个质量为 $M$、半径为 $R$、一维速度弥散为 $\sigma$ 的均匀球体，维里参数可以简化为：
$$
\alpha_{\text{vir}} = \frac{5\sigma^2 R}{GM}
$$
其中总速度弥散 $\sigma^2$ 包括[热弥散](@entry_id:147972)和非热（[湍流](@entry_id:151300)）弥散。$\alpha_{\text{vir}}  \alpha_{\text{crit}}$（通常 $\alpha_{\text{crit}} \approx 2$）表示[引力](@entry_id:175476)占主导地位，区域倾向于坍缩。与固定的密度阈值相比，维里判据更加优越，因为它明确考虑了抵抗[引力](@entry_id:175476)的动能支持。例如，在激波压缩产生的瞬态高密度区域，其动能同样很高，维里参数会正确地识别出该区域是[引力](@entry_id:175476)稳定的，从而避免了仅基于密度判据可能产生的“假阳性”恒星形成。[@problem_id:3537937]

##### [恒星形成](@entry_id:159940)定律

一旦气体被标记为可形成恒星，其速率通常由一个局域的体积定律描述。最广泛使用的模型将恒星形成率密度 $\dot{\rho}_\star$ 与当地气体密度 $\rho$ 和**自由落体时间 (free-fall time)** $t_{\text{ff}}$ 联系起来：
$$
\dot{\rho}_\star = \epsilon_{\text{ff}} \frac{\rho}{t_{\text{ff}}}
$$
这里，$t_{\text{ff}} = \sqrt{3\pi/(32G\rho)}$，而 $\epsilon_{\text{ff}}$ 是一个无量纲的参数，称为“每自由落体时间[恒星形成](@entry_id:159940)效率”，通常是一个小量（约0.01）。这个关系式意味着 $\dot{\rho}_\star \propto \rho^{3/2}$。[@problem_id:3537949]

这个局域的、基于三维物理量的[次网格模型](@entry_id:755601)，与观测上得到的、基于大尺度平均的二维**肯尼科特-施密特关系 (Kennicutt-Schmidt relation)**（$\Sigma_{\text{SFR}} \propto \Sigma^n$，其中 $n \approx 1.4$）在概念上是不同的。后者是一个宏观的经验定律，而前者是旨在解释该定律的微观物理模型。通过对[次网格模型](@entry_id:755601)进行积分，可以从理论上推导宏观关系。例如，在一个[自引力](@entry_id:271015)的等温气体盘中，结合该体积定律和垂直方向的[流体静力学](@entry_id:273578)平衡，可以推导出恒星形成[面密度](@entry_id:161889) $\Sigma_{\text{SFR}} \propto \Sigma^2$，这表明盘的垂直结构对于连接局域物理和全局观测至关重要。[@problem_id:3537949]

##### 先进的处方：基于化学和屏蔽的模型

更复杂的模型认识到恒星主要在寒冷、致密的**[分子云](@entry_id:160702) (molecular clouds)** 中形成。因此，[恒星形成](@entry_id:159940)率应与气体中的**分子氢（H₂）**含量成正比。这类模型将[恒星形成](@entry_id:159940)定律修改为：
$$
\dot{\rho}_\star = \epsilon_{\text{ff}} f_{\text{H}_2} \frac{\rho}{t_{\text{ff}}}
$$
其中 $f_{\text{H}_2}$ 是分子氢[质量分数](@entry_id:161575)。$f_{\text{H}_2}$ 的值本身由一个[次网格模型](@entry_id:755601)决定，该模型平衡了H₂在尘埃颗粒表面的形成速率和被星际紫外（UV）辐射场[光解](@entry_id:164141)的速率。解离速率受到气体自身（自屏蔽）和尘埃（尘埃屏蔽）的强烈影响。屏蔽的强度取决于柱密度 $N_{\text{H}}$ 和金属丰度 $Z$（因为它决定了尘埃与气体的比例）。

在模拟中，局域柱密度 $N_{\text{H}}$ 无法直接测量，但可以通过一个基于局域密度 $\rho$ 及其梯度 $\nabla\rho$ 的**索博列夫长度 (Sobolev length)** $L_S = \rho/|\nabla \rho|$ 来估计，即 $N_{\text{H}} \approx \rho L_S / m_{\text{H}}$。著名的 Krumholz–McKee–Tumlinson (KMT) 模型及其变体提供了计算 $f_{\text{H}_2}$ 的解析拟合公式，这些公式是柱密度和金属丰度的复杂函数，精确地捕捉了从原子气体到分子气体的转变。[@problem_id:3537963]

### [恒星反馈](@entry_id:755431)的[次网格模型](@entry_id:755601)

恒星形成后，它们通过各种机制将能量、动量、质量和重元素注入回周围的[星际介质](@entry_id:150031)（ISM）中。这个过程被称为**[恒星反馈](@entry_id:755431) (stellar feedback)**。

#### 恒星布居的表示

在模拟中，一个形成恒星的汇聚粒子通常会转变为一个**恒星粒子 (star particle)**。与作为质量汇的汇聚粒子不同，恒星粒子是一个无碰撞的粒子，代表一个**同龄单星族 (coeval simple stellar population, SSP)**。它通过[引力](@entry_id:175476)与气体和暗物质相互作用，并通过[次网格模型](@entry_id:755601)向[气体注入](@entry_id:749726)反馈，但它本身不受[气体动力学](@entry_id:147692)作用（如拖拽力）的影响。[@problem_id:3537925]

#### 初始[质量函数](@entry_id:158970)采样

一个质量为 $M_*$ 的恒星粒子代表了一群总质量为 $M_*$ 的恒星，这些恒星的个体质量分布遵循**初始[质量函数](@entry_id:158970) (Initial Mass Function, IMF)**，通常表示为[幂律](@entry_id:143404)形式 $\phi(m) \propto m^{-\alpha}$，其中 $m$ 是[恒星质量](@entry_id:157648)。如何从这个连续的[分布](@entry_id:182848)中为有限质量的恒星粒子提取反馈信息，存在两种主要方法：[@problem_id:3537990]

*   **连续采样 (Continuous Sampling)**：这种方法确定性地使用IMF的[期望值](@entry_id:153208)。例如，一个时间步内核心坍缩[超新星](@entry_id:161773)（CCSN）的期望数量 $\langle N_{\text{SN}} \rangle$ 被计算出来，并注入相应的总能量 $\langle N_{\text{SN}} \rangle E_{\text{SN}}$。这种方法产生的反馈率是平滑的，但可能导致非整数的事件数。

*   **随机采样 (Stochastic Sampling)**：这种方法从IMF中随机抽取单个恒星，直到它们的总质量达到 $M_*$。然后，根据这些被抽出的恒星的质量和寿命，以离散事件的形式（例如，整数个超新星）注入反馈。这种方法产生的反馈是“爆发性的”，更能反映单个[大质量恒星](@entry_id:159884)事件的随机性。

对于质量较小的恒星粒子（$M_* \lesssim 10^4 M_\odot$），其中[大质量恒星](@entry_id:159884)的数量很少，随机采样的重要性凸显出来。随机采样的总注入能量的[方差](@entry_id:200758)为 $\text{Var}(E_{\text{tot}}) = \mu E_{\text{SN}}^2$，其中 $\mu$ 是事件的平均数。这意味着能量的相对[均方根](@entry_id:263605)涨落与 $\mu^{-1/2}$ 成正比，表明当期望事件数很少时，涨落非常大。[@problem_id:3537990]

#### 反馈注入的机制

[恒星反馈](@entry_id:755431)通过多种渠道发生，主要包括[恒星风](@entry_id:161386)和超[新星爆发](@entry_id:160050)。

##### [超新星](@entry_id:161773)前反馈：[恒星风](@entry_id:161386)

在任何大质量恒星爆炸为[超新星](@entry_id:161773)之前，[恒星风](@entry_id:161386)就已经在向ISM注入能量和动量。主要有两种贡献：
*   **OB星风**：来自大质量、炽热的O型和B型恒星，由[辐射压](@entry_id:143156)（特别是[谱线](@entry_id:193408)驱动）驱动。它们的特点是速度极高（$v_\infty \sim 1000 - 3000\,\mathrm{km\,s^{-1}}$）、质量损失率中等。
*   **AGB星风**：来自演化到[渐近巨星支](@entry_id:157490)（AGB）的中等质量恒星，由尘埃驱动。它们的特点是速度很低（$v_\infty \sim 10 - 30\,\mathrm{km\,s^{-1}}$）、但质量损失率非常高。

一个风反馈[次网格模型](@entry_id:755601)根据恒星演化模型给出的随时间变化的质量损失率 $\dot{M}(t)$ 和[终端速度](@entry_id:147799) $v_\infty(t)$，计算注入的质量、[动量和动能](@entry_id:173022)率：
$$
\dot{M}_{\text{inj}} = \dot{M}(t) \quad , \quad \dot{p}_{\text{inj}} = \dot{M}(t) v_\infty(t) \quad , \quad \dot{E}_{k, \text{inj}} = \frac{1}{2}\dot{M}(t) v_\infty^2(t)
$$
由于其极高的速度，OB星风在总动能注入率上占绝对主导地位，通常在动量注入率上也占优。而AGB星风虽然能量和动量贡献较小，但由于其巨大的质量损失率，是向ISM归还质量和重元素的重要渠道。[@problem_id:3537970]

##### [超新星反馈](@entry_id:755651)与“[过冷问题](@entry_id:753036)”

核心坍缩[超新星](@entry_id:161773)（CCSN）是[恒星反馈](@entry_id:755431)最剧烈的形式之一。然而，在[数值模拟](@entry_id:137087)中有效地实现其影响是一个巨大的挑战，这被称为**“[过冷问题](@entry_id:753036)” (overcooling problem)**。一个[超新星遗迹](@entry_id:267906)（SNR）的早期演化是绝热的、[能量守恒](@entry_id:140514)的**赛道夫-泰勒 (Sedov-Taylor)** 阶段。然而，如果模拟的分辨率不足以解析这个阶段（即 $\Delta x \gtrsim R_{\text{cool}}$，其中 $R_{\text{cool}}$ 是SNR开始显著[辐射冷却](@entry_id:754014)的物理半径），注入的能量会因局限于高密度气体中而迅速通过[辐射冷却](@entry_id:754014)损失掉，无法转化为驱动[冲击波](@entry_id:199561)的机械功。

为了应对这个问题，发展了多种[次网格模型](@entry_id:755601)：[@problem_id:3537985]
*   **热能反馈 (Thermal Feedback)**：将[超新星](@entry_id:161773)能量 $E_{\text{SN}}$ 作为热能注入到周围的网格单元中。这种方法简单直接，但如果分辨率不足，几乎肯定会遭遇[过冷问题](@entry_id:753036)而失败。
*   **动能反馈 (Kinetic Feedback)**：将能量以动能形式注入，通过给周围气体一个[径向速度](@entry_id:159824)“踢”。这种方法并不能完全解决问题，因为它只是将能量转化的位置从注入点移到了正在形成的激波前沿，那里动能依然会转化为热能并可能快速冷却。
*   **机械反馈 (Mechanical Feedback)**：这种模型承认赛道夫-泰勒阶段是无法解析的，因此它直接跳过这一步，注入该阶段结束时SNR壳层应具有的**终端动量 (terminal momentum)** $p_{\text{sf}}$。这个动量值本身是从更高分辨率的模拟或解析模型中预先计算得到的。这种方法在低分辨率模拟中非常稳健，因为它绕过了最难处理的[绝热膨胀](@entry_id:144584)阶段。

### [次网格模型](@entry_id:755601)的验证与收敛性

最后，一个至关重要的问题是：我们如何验证这些[次网格模型](@entry_id:755601)的有效性，以及它们的解是否随着分辨率的提高而收敛？

#### 诊断数值效应：[能量收支](@entry_id:201027)

一个严格的诊断方法是进行**能量审计 (energy audit)**。通过在一个[控制体积](@entry_id:143882) $V$ 内追踪完整的积分[能量平衡方程](@entry_id:191484)，我们可以量化数值效应。气体总能量 $E_{\text{gas}} = \int_V e_{\text{gas}} dV$ 的变化率等于所有[源项](@entry_id:269111)（如反馈注入 $S_E$）、汇项（如[辐射冷却](@entry_id:754014) $\mathcal{C}$）、穿过边界的通量（平流和压力功）以及外力（如[引力](@entry_id:175476)）做功的总和。

完整的积分[能量平衡方程](@entry_id:191484)为：[@problem_id:3537939]
$$
\Delta E_{\text{gas}}(T) = \int_0^T \int_V S_E dV dt - \int_0^T \int_V \mathcal{C} dV dt - \int_0^T \oint_{\partial V} (e_{\text{gas}} + P)\mathbf{v} \cdot d\mathbf{A} dt - \int_0^T \int_V \rho\mathbf{v} \cdot \nabla \Phi dV dt
$$
其中 $\Delta E_{\text{gas}}(T) = \int_V e_{\text{gas}}(T) dV - \int_V e_{\text{gas}}(0) dV$ 是气体总能量的实际变化。我们可以定义一个诊断比率 $\mathcal{R}_E$，即实际能量变化与所有物理过程导致的预期能量变化（上式右侧各项之和）的比值。在一个完美的数值方案中，$\mathcal{R}_E=1$。如果 $\mathcal{R}_E \ll 1$，则表明有大量的能量因数值原因（如[过冷](@entry_id:162134)）而“丢失”，这是反馈模型实现失败的明确信号。

#### 收敛性的挑战

在传统[数值分析](@entry_id:142637)中，我们期望当网格尺寸 $\Delta x \to 0$ 时，数值解能收敛到一个唯一的精确解。然而，在包含[次网格模型](@entry_id:755601)的复杂[多尺度模拟](@entry_id:752335)中，情况更为复杂。这里我们需要区分两种收敛性：[@problem_id:3537982]

*   **强收敛 (Strong Convergence)**：当所有次网格参数保持固定时，随着分辨率的提高，预测的物理量（如全局[恒星形成](@entry_id:159940)率）保持不变。
*   **[弱收敛](@entry_id:146650) (Weak Convergence)**：通过将次网格参数作为分辨率 $\Delta x$ 的函数进行适当的重新调整，可以使预测的物理量在不同分辨率下保持不变。

在星系形成模拟中，强收敛往往难以实现。这是因为提高分辨率会解析出新的、更小尺度的密度结构，这会改变[次网格模型](@entry_id:755601)的输入（例如，更多气体超过密度阈值），从而导致全局结果（如[恒星形成](@entry_id:159940)率）发生变化。

因此，在实践中，目标通常是实现弱收敛。这可以通过**参数重缩放 (parameter rescaling)** 来实现。例如，如果发现提高分辨率会导致星形成率系统性地增加，可以通过降低效率参数 $\epsilon_{\text{ff}}$ 来补偿。另一个更具物理动机的方法是将恒星形成的密度阈值 $\rho_{\text{th}}$ 与分辨率联系起来，例如，通过要求在密度为 $\rho_{\text{th}}$ 时的[金斯长度](@entry_id:157888)必须被固定数量的网格单元解析。这将导致 $\rho_{\text{th}} \propto (\Delta x)^{-2}$，从而在高分辨率下使用更高的密度阈值，以抑制小尺度结构中过度的[恒星形成](@entry_id:159940)。[@problem_id:3537982]

总之，[次网格模型](@entry_id:755601)是现代[计算天体物理学](@entry_id:145768)中不可或缺的工具。理解其背后的物理原理、数值实现机制及其固有的局限性，对于解释模拟结果和推动该领域的发展至关重要。