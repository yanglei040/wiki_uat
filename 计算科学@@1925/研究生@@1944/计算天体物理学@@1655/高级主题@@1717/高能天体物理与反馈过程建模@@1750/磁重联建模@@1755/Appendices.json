{"hands_on_practices": [{"introduction": "在某些天体物理等离子体中，为什么磁重联会非常快？本练习通过对比两个里程碑式的模型，深入探讨了重联理论中最基本的问题之一。你将首先推导经典的Sweet-Parker模型，该模型预测了一个缓慢且依赖于电阻率的重联率；然后探索霍尔磁流体动力学（Hall MHD）模型，它揭示了动力学效应如何导致快速、近乎普适的重联率。这个练习对于理解自然界中观测到的快速重联的理论基础至关重要。", "problem": "一个二维稳态磁重联层在均匀、单电离、无碰撞等离子体中，在宏观尺度上通过磁流体力学（MHD）建模，在亚离子尺度上通过霍尔磁流体动力学（Hall MHD）建模。上游磁场为 $B_0$，质量密度为 $\\rho_0$，电流片的系统尺度长度为 $L$（沿出流方向）。假设为不可压缩流和无引导场的反平行场。阿尔芬速度为 $V_A = B_0/\\sqrt{\\mu_0 \\rho_0}$，伦德奎斯特数为 $S = \\mu_0 L V_A/\\eta$，其中 $\\eta$ 是电阻率。离子惯性长度为 $d_i = \\sqrt{m_i/(\\mu_0 n e^2)}$，其中 $n$ 是数密度，$e$ 是元电荷，$m_i$ 是离子质量。重联率定义为归一化入流，$R \\equiv V_{\\mathrm{in}}/V_A$，层厚度为 $\\delta$。\n\n以法拉第定律和安培定律的积分形式（忽略位移电流）、不可压缩流的质量连续性以及广义欧姆定律为基本出发点：\n$E + v_i \\times B = \\dfrac{J \\times B}{n e} - \\dfrac{\\nabla \\cdot P_e}{n e} - \\dfrac{m_e}{n e^2} \\dfrac{dJ}{dt} + \\eta J$，\n执行以下建模步骤：\n\n1) 在电阻性 MHD（忽略霍尔效应、电子压力张量和电子惯性）中，推导重联率 $R_{\\mathrm{SP}}$ 和电流层厚度 $\\delta_{\\mathrm{SP}}$ 关于 $S$ 和 $L$ 的 Sweet–Parker 标度律。\n\n2) 在 $d_i \\ll L$ 和 $\\eta \\to 0$ 的无碰撞霍尔机制下，采纳以下基于霍尔 MHD 的物理动机建模假设：(i) 离子耦合扩散区的厚度为 $\\delta_i \\sim d_i$，出流速度量级为 $V_A$，(ii) 色散哨声波动力学将扩散区沿出流方向局域化到长度 $\\ell \\sim \\kappa d_i$ 的范围内，其中 $\\kappa$ 是一个量级为1的常数，(iii) 根据法拉第定律，稳态重联电场 $E_z$ 在层内是均匀的。利用跨越离子层的质量连续性和这些假设，推导霍尔机制下的重联率 $R_{\\mathrm{H}}$ 和层厚度 $\\delta_{\\mathrm{H}}$ 关于 $L$、$d_i$ 和 $\\kappa$ 的标度律。\n\n3) 对于天体物理相关的参数选择 $S = 10^{8}$、$L/d_i = 5000$ 和 $\\kappa = 10$，计算无量纲比率 $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$。\n\n以纯数字形式提供最终答案 $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$。不需要单位。除精确计算外，不需要四舍五入。", "solution": "该问题要求在两种不同的物理机制下推导和比较磁重联率：电阻性磁流体力学（MHD）和霍尔 MHD。解题将按要求分三部分进行。\n\n第1部分：Sweet–Parker 标度律的推导\n\n在电阻性 MHD 的 Sweet–Parker 模型中，重联发生在一个长度为 $L$、厚度为 $\\delta_{\\mathrm{SP}}$ 的薄电流片中。我们对该区域应用守恒定律和欧姆定律。\n\n1.  质量守恒：对于稳态不可压缩流（$\\rho = \\rho_0 = \\mathrm{const}$），进入重联区的质量通量必须等于流出区的质量通量。等离子体沿长度 $L$ 从上下方以速度 $V_{\\mathrm{in}}$ 流入，并沿厚度 $\\delta_{\\mathrm{SP}}$ 从两侧以速度 $V_{\\mathrm{out}}$ 喷出。在二维近似下，这种平衡表示为：\n    $$ \\rho_0 V_{\\mathrm{in}} (2L) = \\rho_0 V_{\\mathrm{out}} (2\\delta_{\\mathrm{SP}}) $$\n    这简化为对片层纵横比的几何约束：\n    $$ V_{\\mathrm{in}} L = V_{\\mathrm{out}} \\delta_{\\mathrm{SP}} $$\n\n2.  能量守恒：流入等离子体的磁能被转换成流出等离子体射流的动能。将上游磁能密度与下游动能密度相等，可得：\n    $$ \\frac{1}{2}\\rho_0 V_{\\mathrm{out}}^2 \\approx \\frac{B_0^2}{2\\mu_0} $$\n    求解出流速度 $V_{\\mathrm{out}}$，得到其量级与上游阿尔芬速度 $V_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$ 相当：\n    $$ V_{\\mathrm{out}} \\approx V_A $$\n\n3.  欧姆定律和电动势：在稳态下（$\\partial/\\partial t = 0$），法拉第定律 $\\nabla \\times E = 0$ 意味着重联电场 $E_z$ 是均匀的。在理想入流区，电场由 $E \\approx -v \\times B$ 给出。对于 $v=(0, -V_{\\mathrm{in}}, 0)$ 和 $B=(B_0, 0, 0)$，我们得到 $E_z \\approx V_{\\mathrm{in}} B_0$。在电阻层内部，等离子体速度很小，广义欧姆定律 $E + v \\times B = \\eta J$ 的电阻项占主导地位。因此，$E_z \\approx \\eta J_z$。将 $E_z$ 的两种表达式相等，可得：\n    $$ V_{\\mathrm{in}} B_0 \\approx \\eta J_z $$\n\n4.  安培定律：电流密度 $J_z$ 与跨越层区的磁场剪切有关。根据安培定律 $\\nabla \\times B = \\mu_0 J$，我们可以估计电流密度为：\n    $$ J_z \\approx \\frac{1}{\\mu_0} \\frac{\\Delta B_x}{\\Delta y} \\approx \\frac{1}{\\mu_0} \\frac{2B_0}{\\delta_{\\mathrm{SP}}} $$\n    为了进行标度分析，我们使用 $J_z \\sim B_0 / (\\mu_0 \\delta_{\\mathrm{SP}})$。\n\n5.  求解标度律：将 $J_z$ 的表达式代入欧姆定律的关系式中：\n    $$ V_{\\mathrm{in}} B_0 \\sim \\eta \\frac{B_0}{\\mu_0 \\delta_{\\mathrm{SP}}} \\implies V_{\\mathrm{in}} \\mu_0 \\delta_{\\mathrm{SP}} \\sim \\eta $$\n    我们现在得到一个包含两个未知数 $V_{\\mathrm{in}}$ 和 $\\delta_{\\mathrm{SP}}$ 的两个标度关系式的系统：\n    由质量和能量守恒：$\\delta_{\\mathrm{SP}} \\sim L \\frac{V_{\\mathrm{in}}}{V_A}$。\n    由欧姆定律和安培定律：$V_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 \\delta_{\\mathrm{SP}}}$。\n    将第一个关系式中的 $\\delta_{\\mathrm{SP}}$ 代入第二个关系式：\n    $$ V_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 (L V_{\\mathrm{in}} / V_A)} = \\frac{\\eta V_A}{\\mu_0 L V_{\\mathrm{in}}} $$\n    $$ V_{\\mathrm{in}}^2 \\sim \\frac{\\eta V_A}{\\mu_0 L} $$\n    归一化重联率为 $R_{\\mathrm{SP}} = V_{\\mathrm{in}}/V_A$。两边同除以 $V_A^2$：\n    $$ R_{\\mathrm{SP}}^2 = \\left(\\frac{V_{\\mathrm{in}}}{V_A}\\right)^2 \\sim \\frac{\\eta}{\\mu_0 L V_A} $$\n    注意到伦德奎斯特数 $S = \\mu_0 L V_A / \\eta$ 的倒数：\n    $$ R_{\\mathrm{SP}} \\sim S^{-1/2} $$\n    然后通过以下方式求得层厚度 $\\delta_{\\mathrm{SP}}$：\n    $$ \\delta_{\\mathrm{SP}} \\sim L \\frac{V_{\\mathrm{in}}}{V_A} = L R_{\\mathrm{SP}} \\sim L S^{-1/2} $$\n\n第2部分：霍尔重联标度律\n\n在无碰撞霍尔 MHD 机制下，我们使用所提供的特定建模假设。在离子惯性尺度 $d_i$ 上打破磁冻结条件的霍尔效应和哨声波的物理学被封装在这些假设中。\n\n1.  扩散区几何：问题陈述扩散区的厚度 $\\delta_{\\mathrm{H}}$ 与离子惯性长度的量级相当，且出流被局限在长度为 $\\ell$ 的区域内。\n    - 假设 (i)：$\\delta_{\\mathrm{H}} \\sim d_i$。这直接给出了层厚度的标度律。\n    - 假设 (iii)：$\\ell \\sim \\kappa d_i$，其中 $\\kappa$ 是一个量级为1的常数。\n\n2.  出流速度：假设 (ii) 指出出流速度的量级仍然是阿尔芬速度，$V_{\\mathrm{out}} \\sim V_A$。\n\n3.  质量守恒：我们将不可压缩质量连续性方程应用于这个尺寸为 $\\ell \\times \\delta_{\\mathrm{H}}$ 的小的、局域化的扩散区：\n    $$ V_{\\mathrm{in}} \\ell \\sim V_{\\mathrm{out}} \\delta_{\\mathrm{H}} $$\n\n4.  求解标度律：将假设代入质量守恒关系式：\n    $$ V_{\\mathrm{in}} (\\kappa d_i) \\sim V_A d_i $$\n    求解入流速度 $V_{\\mathrm{in}}$：\n    $$ V_{\\mathrm{in}} \\sim \\frac{V_A d_i}{\\kappa d_i} = \\frac{V_A}{\\kappa} $$\n    因此，霍尔重联率 $R_{\\mathrm{H}} = V_{\\mathrm{in}}/V_A$ 为：\n    $$ R_{\\mathrm{H}} \\sim \\frac{1}{\\kappa} $$\n    层厚度的标度律由假设 (i) 直接给出：\n    $$ \\delta_{\\mathrm{H}} \\sim d_i $$\n    这些结果表明，霍尔重联率是一个常数（对于给定的 $\\kappa$），并且与全局系统尺寸 $L$ 和电阻率无关，从而导致“快速”重联。提供未使用的参数 $L/d_i$ 是为了确定该系统处于天体物理相关的机制下，其中全局尺度远大于动理学尺度（$L \\gg d_i$）。\n\n第3部分：计算比率 $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$\n\n我们已知参数 $S = 10^{8}$ 和 $\\kappa = 10$。使用推导出的标度律作为等式进行估算：\n\n1.  计算 Sweet-Parker 重联率 $R_{\\mathrm{SP}}$：\n    $$ R_{\\mathrm{SP}} = S^{-1/2} = (10^8)^{-1/2} = 10^{-4} $$\n\n2.  计算霍尔重联率 $R_{\\mathrm{H}}$：\n    $$ R_{\\mathrm{H}} = \\frac{1}{\\kappa} = \\frac{1}{10} = 0.1 $$\n\n3.  计算比率 $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$：\n    $$ \\frac{R_{\\mathrm{H}}}{R_{\\mathrm{SP}}} = \\frac{0.1}{10^{-4}} = \\frac{10^{-1}}{10^{-4}} = 10^{(-1) - (-4)} = 10^3 $$\n    该比率为 $1000$。", "answer": "$$\\boxed{1000}$$", "id": "3519768"}, {"introduction": "重联率是任何模型中的核心物理量，但在模拟中它究竟是如何被测量的呢？这个编程练习将为你提供一个基本诊断技术的实践经验。你将实现并比较两种不同的计算磁通量转移率的方法：一种基于沿扩散区积分电场，另一种基于理想入流条件。这个实践将巩固你对重联电场和理想磁流体动力学条件破缺的理解。", "problem": "您必须编写一个完整且可运行的程序，在一个二维平面不变的磁流体动力学重联背景下，实现并验证跨越一个预设切面的磁通量转移速率的一致性检查。目标是使用电场计算跨越一个垂直切面的磁通量转移速率，并将其与一个独立的估计值进行比较，该估计值由流入速度乘以其上游磁场构成，在理想磁流体动力学（MHD）条件下，这提供了重联电场的第二种度量。对于一小组参数选择的测试套件，结果必须以实值差异的形式返回。\n\n从以下基本原理开始：\n- 法拉第定律：$\\partial \\mathbf{B} / \\partial t = - \\nabla \\times \\mathbf{E}$，其中 $\\mathbf{B}$ 是磁场，$\\mathbf{E}$ 是电场。\n- 理想欧姆定律（在任何非理想区域之外的理想MHD极限）：$\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$，其中 $\\mathbf{v}$ 是等离子体速度。\n- 在沿 $z$ 轴不变的二维重联中，可以使用磁矢量势 $\\mathbf{A} = A_z(x,y,t) \\hat{\\mathbf{z}}$，其中 $\\mathbf{B} = \\nabla \\times \\mathbf{A} = (\\partial_y A_z, -\\partial_x A_z, 0)$ 且 $E_z = - \\partial_t A_z$（在一个标量势没有 $z$ 依赖的规范中）。沿着 $B_y = 0$ 和 $v_x = 0$ 的对称中线，在理想区域内，理想欧姆定律简化为 $E_z = v_y B_x$。\n\n此问题的定义：\n- 考虑一个位于 $x = 0$ 处，从 $y = -Y_c$ 到 $y = +Y_c$ 的垂直切面 $\\mathcal{C}$，其长度为 $2 Y_c$。\n- 将沿 $z$ 方向单位长度上跨越该切面的磁通量转移速率定义为\n$$\n\\dot{\\Phi}_{\\mathrm{cut}}(t) \\equiv \\int_{-Y_c}^{Y_c} E_z(x=0,y,t) \\, dy,\n$$\n这可由法拉第定律在一个矩形回路上积分得到，该回路使用 $\\mathcal{C}$ 作为其内部段，且位于除 $\\mathcal{C}$ 外切向电场可忽略的区域。在足够上游的理想区域中，$E_z$ 等于流入度量 $v_{\\mathrm{in}} B$，其中 $v_{\\mathrm{in}}$ 是朝向电流片的流入速度，而 $B$ 是重联的上游磁场分量。\n- 在测试配置中，采用一个由矢量势 $A_0(y)$ 导出的静态初始磁场构型，使得在时间 $t=0$ 时，重联磁场分量为 $B_x(y,0) = \\partial_y A_0(y) = B_0 \\tanh(y/\\delta)$，其中 $B_0 > 0$ 和 $\\delta > 0$ 是常数。\n- 在 $t=0$ 时规定一个形式为\n$$\nE_z(y) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right),\n$$\n的电场剖面 $E_z(y)$，其中包含常数 $E_0$（背景，理想贡献）、$E_1$（非理想局部修正）和 $w>0$（局部化宽度）。如果取 $A_z(x,y,t) = A_0(y) - E_z(y) t$，则该选择与 $E_z = - \\partial_t A_z$ 一致，此时 $B_x(y,t) = B_0 \\tanh(y/\\delta) - t \\, \\partial_y E_z(y)$；您需要在 $t=0$ 时计算所有量，因此 $B_x(y,0) = B_0 \\tanh(y/\\delta)$。\n- 定义一个“上游”采样位置 $y_{\\mathrm{up}}$，满足 $|y_{\\mathrm{up}}| \\le Y_c$ 但离 $y=0$ 足够远，以至于 $B_x(y_{\\mathrm{up}},0) \\neq 0$。在上游的理想区域中，流入关系给出\n$$\nE_{\\mathrm{up}} \\equiv \\left[v_{\\mathrm{in}}(y_{\\mathrm{up}}) \\, B_x(y_{\\mathrm{up}},0)\\right] = E_z(y_{\\mathrm{up}}),\n$$\n因此，假设沿切面均匀，预测的磁通量转移速率为\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\n\n您的任务：\n- 对于下面测试套件中的每组参数，数值计算定义 $\\dot{\\Phi}_{\\mathrm{cut}}$ 的积分以及乘积 $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_z(y_{\\mathrm{up}})$。\n- 计算绝对相对差异\n$$\nr = \\frac{\\left|\\dot{\\Phi}_{\\mathrm{cut}} - \\dot{\\Phi}_{\\mathrm{pred}}\\right|}{\\max\\!\\left(10^{-12}, \\left|\\dot{\\Phi}_{\\mathrm{cut}}\\right|\\right)},\n$$\n它是无量纲的。较小的 $r$ 值表示基于直接切面的磁通量转移速率与流入估计值之间具有一致性。\n\n使用的物理单位：\n- 磁场 $B$ 以特斯拉（T）为单位，\n- 长度 $y, Y_c, \\delta, w, y_{\\mathrm{up}}$ 以米（m）为单位，\n- 电场 $E$ 以伏特每米（V/m）为单位，\n- 速率 $\\dot{\\Phi}$ 的单位为伏特（V），因为它是 $E_z$ 沿 $y$ 的长度在单位 $z$ 长度上的积分。\n\n数值测试套件：\n- 使用以下四组参数集，每组指定为 $(B_0, \\delta, E_0, E_1, w, Y_c, y_{\\mathrm{up}})$，所有量均采用上述单位：\n    1. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 0.0, \\; 2.5 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    2. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 5.0 \\times 10^{-4}, \\; 2.5 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    3. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; -5.0 \\times 10^{-4}, \\; 1.0 \\times 10^{5}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    4. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 2.0 \\times 10^{-4}, \\; 1.0 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 5.0 \\times 10^{2})$\n\n程序要求：\n- 实现一个函数，对于每个测试用例，按规定定义 $E_z(y)$ 和 $B_x(y,0)$，并通过在 $y \\in [-Y_c, Y_c]$ 上的数值积分计算 $\\dot{\\Phi}_{\\mathrm{cut}}$。\n- 计算 $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_z(y_{\\mathrm{up}})$，然后计算如上定义的差异 $r$。\n- 您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表的结果（例如，\"[r1,r2,r3,r4]\"），其中每个条目是对应测试用例的 $r$ 值，顺序如上所列。条目必须是无单位的浮点数。\n\n科学真实性与约束条件：\n- 磁场剖面 $B_x(y,0) = B_0 \\tanh(y/\\delta)$ 是重联研究中使用的典型电流片模型。\n- 电场剖面 $E_z(y)$ 包含一个均匀的理想贡献 $E_0$ 和一个局部的非理想修正 $E_1 \\exp[-(y/w)^2]$，以便测试理想情况的一致性以及由非理想效应引起的偏离。\n- 流入估计 $v_{\\mathrm{in}} B$ 是在理想假设下，在上游采样点评估为 $E_z(y_{\\mathrm{up}})$。在存在局部非理想项的情况下，该估计可能与切面积分得到的 $\\dot{\\Phi}_{\\mathrm{cut}}$ 不匹配，差异 $r$ 量化了这种不一致性。\n\n此问题不涉及角度单位。所有要打印的数值结果都是纯数字（无量纲差异）。", "solution": "我们推导出一个可实现的表达式，用于计算跨越垂直切面的磁通量转移速率及其基于理想流入的代理值，然后提供一个数值计算方案来评估和比较它们。\n\n基本原理与几何结构：\n- 从法拉第定律 $\\partial \\mathbf{B} / \\partial t = - \\nabla \\times \\mathbf{E}$ 和理想欧姆定律 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$ 开始，后者在理想区域有效。\n- 在一个沿 $z$ 轴不变的二维系统中，令 $\\mathbf{A} = A_z(x,y,t) \\hat{\\mathbf{z}}$，$\\mathbf{B} = \\nabla \\times \\mathbf{A} = (\\partial_y A_z, -\\partial_x A_z, 0)$，且 $E_z = -\\partial_t A_z$。\n- 考虑一个位于 $x=0$ 处，从 $y=-Y_c$ 到 $y=+Y_c$ 的垂直切面 $\\mathcal{C}$。沿 $z$ 方向单位长度上跨越此切面的磁通量转移速率可以通过考虑一个矩形回路来获得，该回路使用 $\\mathcal{C}$ 作为一边，并在切向电场可忽略的区域闭合。根据积分形式的法拉第定律，$d\\Phi/dt = - \\oint \\mathbf{E} \\cdot d\\mathbf{l}$。如果沿闭合段的贡献消失（或在理想区域内可以忽略不计），则剩余的贡献是沿 $\\mathcal{C}$ 的线积分：\n$$\n\\dot{\\Phi}_{\\mathrm{cut}}(t) = \\int_{-Y_c}^{Y_c} E_z(x=0,y,t) \\, dy.\n$$\n当切面穿过非理想区域时，这是二维重联速率的标准诊断方法。\n\n理想流入代理：\n- 在对称中线上，通常有 $B_y = 0$ 和 $v_x = 0$。在理想区域内，理想欧姆定律的 $z$ 分量简化为 $E_z = v_y B_x$。在非理想效应可忽略的上游位置 $y_{\\mathrm{up}}$ 进行采样，可得\n$$\nE_{\\mathrm{up}} \\equiv v_{\\mathrm{in}}(y_{\\mathrm{up}}) \\, B_x(y_{\\mathrm{up}},0) = E_z(y_{\\mathrm{up}}).\n$$\n假设 $E_z$ 在沿切面的非理想层内近似均匀（这是稳态二维重联中的一个常见性质），则预测的磁通量转移速率为\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\n在 $E_z$ 严格均匀的情况下，$\\dot{\\Phi}_{\\mathrm{cut}} = \\dot{\\Phi}_{\\mathrm{pred}}$ 精确成立；在存在局部非理想增强或减弱时，它们可能会有所不同。\n\n测试套件的模型场：\n- 我们规定在 $t=0$ 时，重联磁场由\n$$\nB_x(y,0) = \\partial_y A_0(y) = B_0 \\tanh\\!\\left(\\frac{y}{\\delta}\\right),\n$$\n给出，其中 $B_0 > 0$ 和 $\\delta > 0$ 是常数。这是一个在重联建模中广泛使用的电流片剖面。\n- 我们规定在 $t=0$ 时的电场剖面为，\n$$\nE_z(y) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right),\n$$\n其中 $E_0$, $E_1$, $w > 0$ 是常数。如果取 $A_z(x,y,t) = A_0(y) - E_z(y) t$，则由 $E_z = -\\partial_t A_z$ 确保了与法拉第定律的一致性，因此 $B_x(y,t) = B_0 \\tanh(y/\\delta) - t \\, \\partial_y E_z(y)$。我们只在 $t=0$ 时进行评估，因此相关的磁场是 $B_x(y,0) = B_0 \\tanh(y/\\delta)$。\n\n计算定义：\n- 在 $t=0$ 时基于直接切面的速率是\n$$\n\\dot{\\Phi}_{\\mathrm{cut}} = \\int_{-Y_c}^{Y_c} \\left[E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right)\\right] dy.\n$$\n- 流入代理使用上游采样值，\n$$\nE_{\\mathrm{up}} = E_z(y_{\\mathrm{up}}) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y_{\\mathrm{up}}}{w}\\right)^2\\right),\n$$\n并预测\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\n- 需要报告的差异是绝对相对误差\n$$\nr = \\frac{\\left|\\dot{\\Phi}_{\\mathrm{cut}} - \\dot{\\Phi}_{\\mathrm{pred}}\\right|}{\\max\\!\\left(10^{-12}, \\left|\\dot{\\Phi}_{\\mathrm{cut}}\\right|\\right)}.\n$$\n\n算法规划：\n- 对于每个测试用例，按上文定义 $E_z(y)$，并使用稳健的求积方法在 $y \\in [-Y_c, Y_c]$ 上数值计算 $\\dot{\\Phi}_{\\mathrm{cut}}$ 的积分。\n- 评估 $E_{\\mathrm{up}} = E_z(y_{\\mathrm{up}})$ 并计算 $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_{\\mathrm{up}}$。\n- 按定义计算 $r$。\n- 按提供的测试套件顺序汇总结果 $[r_1, r_2, r_3, r_4]$。\n\n解释：\n- 情况 1 中 $E_1 = 0$，因此 $E_z(y)$ 是均匀的，两种度量在数值积分误差范围内应该一致；$r$ 应接近于 $0$。\n- 情况 2 和 3 包含沿 $y$ 变化的局部非理想修正（$E_1 \\neq 0$），因此 $\\dot{\\Phi}_{\\mathrm{cut}}$ 会累积这些变化，而 $\\dot{\\Phi}_{\\mathrm{pred}}$ 只反映上游的值；非零的 $r$ 量化了这种不一致性。\n- 情况 4 使用了一个非常小且靠近中性线的 $y_{\\mathrm{up}}$；尽管 $E_{\\mathrm{up}}$ 保持有限，但这可以探测在离电流片太近处采样时的灵敏度，提供了一个边界情况的检查。\n\n所有计算都将使用指定的单位进行，但打印输出的 $r_i$ 是按要求提供的无量纲实数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef ez_profile(y, E0, E1, w):\n    # Electric field profile E_z(y) = E0 + E1 * exp(-(y/w)^2)\n    if w == 0:\n        return E0\n    return E0 + E1 * np.exp(- (y / w)**2)\n\ndef bx_profile(y, B0, delta):\n    # Reconnecting magnetic field at t=0: B_x(y,0) = B0 * tanh(y/delta)\n    return B0 * np.tanh(y / delta)\n\ndef compute_dotPhi_cut(E0, E1, w, Yc):\n    # Numerically integrate E_z over y in [-Yc, Yc]\n    integrand = lambda yy: ez_profile(yy, E0, E1, w)\n    # Use high-accuracy quadrature\n    val, err = integrate.quad(integrand, -Yc, Yc, epsabs=1e-12, epsrel=1e-12, limit=200)\n    return val\n\ndef compute_discrepancy(case):\n    # Unpack parameters: (B0, delta, E0, E1, w, Yc, y_up)\n    B0, delta, E0, E1, w, Yc, y_up = case\n\n    # Direct cut-based flux-transfer rate\n    dotPhi_cut = compute_dotPhi_cut(E0, E1, w, Yc)\n\n    # Upstream E_z at y_up (ideal proxy v_in * B_up)\n    E_up = ez_profile(y_up, E0, E1, w)\n\n    # Predicted rate assuming uniform E_z across the cut\n    dotPhi_pred = 2.0 * Yc * E_up\n\n    # Discrepancy (absolute relative error)\n    denom = max(1e-12, abs(dotPhi_cut))\n    r = abs(dotPhi_cut - dotPhi_pred) / denom\n    return r\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (B0, delta, E0, E1, w, Yc, y_up)\n    test_cases = [\n        (2.0e-8, 5.0e4, 1.0e-3, 0.0,       2.5e4, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, 5.0e-4,    2.5e4, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, -5.0e-4,   1.0e5, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, 2.0e-4,    1.0e4, 5.0e5, 5.0e2),\n    ]\n\n    results = []\n    for case in test_cases:\n        r = compute_discrepancy(case)\n        # Format with reasonable precision to ensure a clean single-line output\n        results.append(f\"{r:.12g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3519733"}, {"introduction": "在三维空间中，磁重联不再发生在简单的X点，而是发生在由磁拓扑决定的复杂区域。这个高级计算实践介绍了一种识别这些区域的强大工具：磁场挤压因子$Q$。通过编写一个追踪磁力线并计算$Q$的程序，你将学习如何定位准分离层（QSLs），这是三维重联的优先发生位置。这项练习让你能够直接体验现代分析复杂三维磁场的方法。", "problem": "考虑一个磁流体动力学 (MHD) 磁场 $\\mathbf{B}(\\mathbf{r})$，它位于一个具有坐标 $(x,y,z)$ 的单连通笛卡尔盒子中，其中 $z$ 是开放磁力线映射的优选方向。假设在整个区域内 $\\nabla \\cdot \\mathbf{B} = 0$ 且 $B_z(x,y,z) > 0$，因此磁力线单调地将下边界 $z=0$ 连接到上边界 $z=L$。通过追踪从 $(x_0,y_0,0)$ 开始的磁力线，直到它在 $(X,Y,L)$ 处与平面 $z=L$ 相交，来定义磁力线映射 $\\mathcal{F}: (x_0,y_0) \\mapsto (X(x_0,y_0),Y(x_0,y_0))$。足点 $(x_0,y_0,0)$ 处的挤压因子 $Q$ 由该映射的 $2\\times 2$ 雅可比矩阵 $D\\mathcal{F}$ 定义，\n$$\nD\\mathcal{F}(x_0,y_0) \\equiv \n\\begin{pmatrix}\n\\frac{\\partial X}{\\partial x_0} & \\frac{\\partial X}{\\partial y_0} \\\\\n\\frac{\\partial Y}{\\partial x_0} & \\frac{\\partial Y}{\\partial y_0}\n\\end{pmatrix},\n$$\n且\n$$\nQ(x_0,y_0) \\equiv \\frac{\\left\\| D\\mathcal{F}(x_0,y_0) \\right\\|_F^2}{\\left| \\det D\\mathcal{F}(x_0,y_0) \\right|} = \\frac{\\left(\\frac{\\partial X}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial X}{\\partial y_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial y_0}\\right)^2}{\\left| \\frac{\\partial X}{\\partial x_0}\\frac{\\partial Y}{\\partial y_0} - \\frac{\\partial X}{\\partial y_0}\\frac{\\partial Y}{\\partial x_0} \\right|}.\n$$\n高的 $Q$ 值表示准分离层 (QSLs)，这些是可能发生磁重联的位置。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 数值积分磁力线，以计算 $z=0$ 上足点网格 $(x_0,y_0)$ 的映射 $\\mathcal{F}$。\n- 使用每个足点周围的有限差分来近似 $D\\mathcal{F}$。\n- 计算每个足点处的 $Q$。\n- 将 $Q \\ge Q_{\\mathrm{thr}}$ 的足点识别为可能的重联位置。\n\n使用以 $z$ 作为自变量的磁力线方程：\n$$\n\\frac{dx}{dz} = \\frac{B_x(x,y,z)}{B_z(x,y,z)}, \\qquad \\frac{dy}{dz} = \\frac{B_y(x,y,z)}{B_z(x,y,z)},\n$$\n从 $z=0$ 到 $z=L$ 进行积分，初始条件为 $(x(0),y(0))=(x_0,y_0)$，以确定 $(X,Y)=(x(L),y(L))$。对所有测试用例，使用具有统一恒定步数 $M$ 的显式四阶龙格-库塔方法。\n\n对于数值微分，使用增量为 $\\varepsilon$ 的对称两点模板：\n$$\n\\frac{\\partial X}{\\partial x_0} \\approx \\frac{X(x_0+\\varepsilon,y_0)-X(x_0-\\varepsilon,y_0)}{2\\varepsilon}, \\quad\n\\frac{\\partial X}{\\partial y_0} \\approx \\frac{X(x_0,y_0+\\varepsilon)-X(x_0,y_0-\\varepsilon)}{2\\varepsilon},\n$$\n对于 $\\partial Y/\\partial x_0$ 和 $\\partial Y/\\partial y_0$ 也类似。\n\n场位形。对于以下所有测试用例，采用由磁通函数和均匀引导场导出的无散度的面内场：\n$$\nB_x(x,y,z) = a\\,x + s\\,\\sin(\\pi x)\\cos(\\pi y), \\quad\nB_y(x,y,z) = -a\\,y - s\\,\\cos(\\pi x)\\sin(\\pi y), \\quad\nB_z(x,y,z) = B_0,\n$$\n其中 $a$、$s$ 和 $B_0$ 为常数（无量纲）。这满足 $\\nabla\\cdot\\mathbf{B}=0$ 和 $B_z(x,y,z)=B_0 > 0$。\n\n所有测试的通用数值要求：\n- 积分器：在 $z\\in[0,L]$ 上使用 $M$ 步的显式四阶龙格-库塔方法。\n- 有限差分增量：$\\varepsilon = 10^{-6}$。\n- $z=0$ 上的足点网格是在 $[x_{\\min},x_{\\max}]\\times[y_{\\min},y_{\\max}]$ 上的一个均匀 $N\\times N$ 笛卡尔网格，包括端点。\n\n测试套件。实现以下三个测试用例，每个用例由 $(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)$ 指定：\n- 测试 A（正常路径，线性双曲磁通管）：$(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(1,0,1,1,15,-1,1,-1,1,5,400)$。预期 $Q$ 在空间上是均匀的，且大于 $Q_{\\mathrm{thr}}$。\n- 测试 B（边界情况，均匀场）：$(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(0,0,1,1,9,-1,1,-1,1,2.5,400)$。预期 $Q$ 在空间上是均匀的，且小于 $Q_{\\mathrm{thr}}$。\n- 测试 C（双曲管的非线性扰动）：$(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(1,0.3,1,1,13,-0.9,0.9,-0.9,0.9,10,400)$。预期 $Q$ 在空间上是变化的，并具有局部增强。\n\n输出。对于每个测试用例，您的程序必须计算：\n- 网格上的最大挤压因子 $\\max Q$，以浮点数形式表示，四舍五入到 $6$ 位小数。\n- $Q \\ge Q_{\\mathrm{thr}}$ 的网格点计数，以整数形式表示。\n\n最终输出格式。您的程序应生成单行输出，其中包含所有三个测试的结果，格式为逗号分隔的列表的列表：\n$$\n\\big[\\,[\\max Q_A,\\ \\mathrm{count}_A],\\ [\\max Q_B,\\ \\mathrm{count}_B],\\ [\\max Q_C,\\ \\mathrm{count}_C]\\,\\big]\n$$\n其中每个 $\\max Q$ 都四舍五入到 $6$ 位小数。由于所有量在构造上都是无量纲的，因此没有物理单位。", "solution": "该问题要求开发一个数值代码，以在给定的磁场位形中识别潜在的磁重联位置。这通过计算磁力线足点网格上的磁挤压因子 $Q$ 来实现。高的 $Q$ 值与准分离层 (QSLs) 相关，磁重联很可能在这些区域发生。解决方案涉及数值追踪磁力线，近似磁力线映射的雅可比矩阵，然后计算 $Q$。\n\n磁力线是一条曲线 $\\mathbf{r}(l)$，其切线处处与磁场矢量 $\\mathbf{B}$ 平行，即 $d\\mathbf{r}/dl \\propto \\mathbf{B}$。问题指定了一个笛卡尔域，其中 $B_z > 0$，这允许我们使用 $z$ 坐标作为追踪磁力线的自变量。因此，磁力线方程由以下常微分方程 (ODEs) 组给出：\n$$\n\\frac{dx}{dz} = \\frac{B_x(x,y,z)}{B_z(x,y,z)}, \\qquad \\frac{dy}{dz} = \\frac{B_y(x,y,z)}{B_z(x,y,z)}\n$$\n我们将状态向量表示为 $\\mathbf{p}(z) = (x(z), y(z))^T$。该常微分方程组可以抽象地写为 $\\frac{d\\mathbf{p}}{dz} = \\mathbf{f}(z, \\mathbf{p})$，其中 $\\mathbf{f} = (B_x/B_z, B_y/B_z)^T$。\n\n为数值求解该系统，我们采用显式四阶龙格-库塔 (RK4) 方法。给定第 $n$ 步的初始位置 $\\mathbf{p}_n = \\mathbf{p}(z_n)$，下一步 $z_{n+1} = z_n + h$ 的位置近似为：\n$$\n\\mathbf{p}_{n+1} = \\mathbf{p}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n其中 $h$ 是步长，各阶段 $\\mathbf{k}_i$ 为：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{f}(z_n, \\mathbf{p}_n) \\\\\n\\mathbf{k}_2 = \\mathbf{f}(z_n + \\frac{h}{2}, \\mathbf{p}_n + \\frac{h}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathbf{f}(z_n + \\frac{h}{2}, \\mathbf{p}_n + \\frac{h}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathbf{f}(z_n + h, \\mathbf{p}_n + h\\mathbf{k}_3)\n\\end{aligned}\n$$\n我们使用 $M$ 个均匀步长从 $z=0$ 积分到 $z=L$，因此步长为 $h = L/M$。\n\n磁力线映射 $\\mathcal{F}$ 将磁力线在 $z=0$ 边界的起始坐标 $(x_0, y_0)$ 与其在 $z=L$ 边界的终止坐标 $(X, Y)$ 联系起来。这可以正式写为 $(X, Y) = \\mathcal{F}(x_0, y_0)$。该映射通过对磁力线方程进行积分来计算，初始条件为 $(x(0), y(0)) = (x_0, y_0)$，以求得 $(X, Y) = (x(L), y(L))$。\n\n挤压因子 $Q$ 基于此映射的 $2 \\times 2$ 雅可比矩阵 $D\\mathcal{F}$ 定义：\n$$\nD\\mathcal{F}(x_0,y_0) \\equiv \n\\begin{pmatrix}\n\\frac{\\partial X}{\\partial x_0} & \\frac{\\partial X}{\\partial y_0} \\\\\n\\frac{\\partial Y}{\\partial x_0} & \\frac{\\partial Y}{\\partial y_0}\n\\end{pmatrix}\n$$\n由于通常无法获得 $\\mathcal{F}$ 的解析表达式，我们使用对称两点有限差分公式来近似雅可比矩阵中的偏导数。对于一个小的位移 $\\varepsilon$，导数计算如下：\n$$\n\\begin{aligned}\n\\frac{\\partial X}{\\partial x_0} \\approx \\frac{X(x_0+\\varepsilon, y_0) - X(x_0-\\varepsilon, y_0)}{2\\varepsilon}, & \\frac{\\partial X}{\\partial y_0} \\approx \\frac{X(x_0, y_0+\\varepsilon) - X(x_0, y_0-\\varepsilon)}{2\\varepsilon} \\\\\n\\frac{\\partial Y}{\\partial x_0} \\approx \\frac{Y(x_0+\\varepsilon, y_0) - Y(x_0-\\varepsilon, y_0)}{2\\varepsilon}, & \\frac{\\partial Y}{\\partial y_0} \\approx \\frac{Y(x_0, y_0+\\varepsilon) - Y(x_0, y_0-\\varepsilon)}{2\\varepsilon}\n\\end{aligned}\n$$\n这要求对需要评估雅可比矩阵的每个足点 $(x_0, y_0)$ 进行四次独立的磁力线积分。\n\n利用雅可比矩阵的元素，我们使用其定义来计算挤压因子 $Q$：\n$$\nQ(x_0,y_0) = \\frac{\\left\\| D\\mathcal{F}(x_0,y_0) \\right\\|_F^2}{\\left| \\det D\\mathcal{F}(x_0,y_0) \\right|} = \\frac{\\left(\\frac{\\partial X}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial X}{\\partial y_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial y_0}\\right)^2}{\\left| \\frac{\\partial X}{\\partial x_0}\\frac{\\partial Y}{\\partial y_0} - \\frac{\\partial X}{\\partial y_0}\\frac{\\partial Y}{\\partial x_0} \\right|}\n$$\n分子是雅可比矩阵的弗罗贝尼乌斯范数的平方，分母是其行列式的绝对值。\n\n对于每个测试用例，总体算法流程如下：\n1. 在域 $[x_{\\min}, x_{\\max}] \\times [y_{\\min}, y_{\\max}]$ 上定义 $z=0$ 平面上的 $N \\times N$ 足点 $(x_0, y_0)$ 网格。\n2. 初始化最大 $Q$ 值的变量 $\\max Q = 0$，以及一个用于记录超过阈值的点的计数器 $\\mathrm{count} = 0$。\n3. 对于网格中的每个足点 $(x_0, y_0)$：\n    a. 对初始条件 $(x_0 \\pm \\varepsilon, y_0, 0)$ 和 $(x_0, y_0 \\pm \\varepsilon, 0)$ 执行四次 RK4 积分以找到终点。\n    b. 使用有限差分公式计算雅可比矩阵 $D\\mathcal{F}$ 的四个元素。\n    c. 根据雅可比矩阵的元素计算 $Q$ 的值。\n    d. 如果 $Q > \\max Q$，则更新 $\\max Q = Q$。\n    e. 如果 $Q \\ge Q_{\\mathrm{thr}}$，则增加 $\\mathrm{count}$ 计数。\n4. 遍历所有网格点后，存储最终的 $\\max Q$（四舍五入到 6 位小数）和 $\\mathrm{count}$。\n5. 处理完所有测试用例后，将结果格式化为表示列表的列表的单行字符串。\n对于特定的磁场 $\\mathbf{B} = (a\\,x + s\\,\\sin(\\pi x)\\cos(\\pi y), -a\\,y - s\\,\\cos(\\pi x)\\sin(\\pi y), B_0)$，由于 $B_z$ 是常数，常微分方程的右侧为 $\\mathbf{f} = \\frac{1}{B_0}(B_x, B_y)^T$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dz_derivs(z, pos, a, s, B0):\n    \"\"\"\n    Computes the RHS of the field-line ODEs, d(x,y)/dz.\n    z is formally an argument but is unused since B is z-independent.\n    \"\"\"\n    x, y = pos\n    # Bx = a*x + s*sin(pi*x)*cos(pi*y)\n    # By = -a*y - s*cos(pi*x)*sin(pi*y)\n    # Bz = B0\n    # dx/dz = Bx/Bz, dy/dz = By/Bz\n    bx = a * x + s * np.sin(np.pi * x) * np.cos(np.pi * y)\n    by = -a * y - s * np.cos(np.pi * x) * np.sin(np.pi * y)\n    return np.array([bx, by]) / B0\n\ndef trace_field_line(x0, y0, L, M, a, s, B0):\n    \"\"\"\n    Integrates a magnetic field line from (x0, y0, 0) to z=L.\n    Uses the 4th-order Runge-Kutta method.\n    \"\"\"\n    pos = np.array([x0, y0], dtype=np.float64)\n    z = 0.0\n    h = L / M\n\n    for _ in range(M):\n        k1 = dz_derivs(z, pos, a, s, B0)\n        k2 = dz_derivs(z + h/2, pos + h/2 * k1, a, s, B0)\n        k3 = dz_derivs(z + h/2, pos + h/2 * k2, a, s, B0)\n        k4 = dz_derivs(z + h, pos + h * k3, a, s, B0)\n        pos += (h/6) * (k1 + 2*k2 + 2*k3 + k4)\n        z += h\n    return pos\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, s, B0, L, N, x_min, x_max, y_min, y_max, Q_thr, M)\n        # Test A (happy path, linear hyperbolic flux tube)\n        (1, 0, 1, 1, 15, -1, 1, -1, 1, 5, 400),\n        # Test B (boundary case, uniform field)\n        (0, 0, 1, 1, 9, -1, 1, -1, 1, 2.5, 400),\n        # Test C (nonlinear perturbation of hyperbolic tube)\n        (1, 0.3, 1, 1, 13, -0.9, 0.9, -0.9, 0.9, 10, 400)\n    ]\n\n    all_results = []\n    # Finite-difference increment\n    eps = 1e-6\n\n    for case_params in test_cases:\n        a, s, B0, L, N, x_min, x_max, y_min, y_max, Q_thr, M = case_params\n\n        x_grid = np.linspace(x_min, x_max, N, dtype=np.float64)\n        y_grid = np.linspace(y_min, y_max, N, dtype=np.float64)\n\n        max_q = 0.0\n        q_count = 0\n\n        for y0 in y_grid:\n            for x0 in x_grid:\n                # Main logic to calculate the result for one grid point\n                # Trace four field lines for finite differences\n                pos_px = trace_field_line(x0 + eps, y0, L, M, a, s, B0)\n                pos_mx = trace_field_line(x0 - eps, y0, L, M, a, s, B0)\n                pos_py = trace_field_line(x0, y0 + eps, L, M, a, s, B0)\n                pos_my = trace_field_line(x0, y0 - eps, L, M, a, s, B0)\n\n                # Compute Jacobian elements\n                dX_dx0 = (pos_px[0] - pos_mx[0]) / (2 * eps)\n                dY_dx0 = (pos_px[1] - pos_mx[1]) / (2 * eps)\n                \n                dX_dy0 = (pos_py[0] - pos_my[0]) / (2 * eps)\n                dY_dy0 = (pos_py[1] - pos_my[1]) / (2 * eps)\n\n                # Compute squashing factor Q\n                norm_sq = dX_dx0**2 + dX_dy0**2 + dY_dx0**2 + dY_dy0**2\n                det = dX_dx0 * dY_dy0 - dX_dy0 * dY_dx0\n\n                q_val = 0.0\n                if abs(det) > 1e-15: # Avoid division by zero\n                    q_val = norm_sq / abs(det)\n                else:\n                    # If determinant is zero, Q is infinite (true separatrix)\n                    # unless norm_sq is also zero (trivial mapping)\n                    q_val = np.inf if norm_sq > 1e-15 else 2.0\n\n                if q_val >= Q_thr:\n                    q_count += 1\n                \n                if q_val > max_q:\n                    max_q = q_val\n        \n        # Store rounded max Q and the integer count\n        all_results.append([round(max_q, 6), q_count])\n\n    # Final print statement in the exact required format without spaces\n    sub_strings = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(sub_strings)}]\")\n\nsolve()\n```", "id": "3519769"}]}