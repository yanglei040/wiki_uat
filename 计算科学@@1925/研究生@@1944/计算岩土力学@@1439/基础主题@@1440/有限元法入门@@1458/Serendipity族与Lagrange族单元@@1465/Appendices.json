{"hands_on_practices": [{"introduction": "等参有限元方法的核心在于使用相同的形函数来描述单元的几何形状和场变量（如位移）。本练习将引导你完成一个基本但至关重要的全过程：从推导$S_2$ serendipity单元的形函数梯度，建立应变-位移矩阵$B$，到最终在给定的物理单元和节点位移下计算应变[@problem_id:3558296]。这个实践旨在巩固你对等参映射和应变计算之间关系的理解。", "problem": "考虑参考方形单元 $\\hat{\\Omega} = \\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ 上的二次 serendipity 族 $S_2$。$S_2$ 单元有 $8$ 个节点：$4$ 个角点和 $4$ 个边中点。设节点编号和参考坐标为\n$1:(-1,-1)$，$2:(1,-1)$，$3:(1,1)$，$4:(-1,1)$，$5:(0,-1)$，$6:(1,0)$，$7:(0,1)$，$8:(-1,0)$。\n在有限元法 (FEM) 中，$S_2$ 单元的形函数 $N_i(\\xi,\\eta)$ 是二次多项式，在这些节点上满足 Kronecker-delta 性质和单位分解特性。\n\n任务：\n- 从等参数插值和参考形函数性质的核心定义出发，推导在参考单元上所有 $i \\in \\{1,\\dots,8\\}$ 的梯度 $\\nabla_{\\hat{\\Omega}} N_i(\\xi,\\eta) = \\left[\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\right]$ 的显式公式。\n- 使用等参数概念，展示如何在映射 $\\boldsymbol{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\boldsymbol{x}_i$ 下，为二维小应变运动学（平面应变）计算应变-位移矩阵 $B$，其中 $\\boldsymbol{x}_i = (x_i,y_i)$ 是单元节点的物理坐标。基于链式法则和 Jacobian 矩阵 $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$ 进行推导。\n- 然后，考虑将节点置于以下坐标（单位：米）的物理四边形的等参数映射：\n$1:(-2,-1)$，$2:(2,-1)$，$3:(2,1)$，$4:(-2,1)$，$5:(0,-1)$，$6:(2,0)$，$7:(0,1)$，$8:(-2,0)$。展示在单元中心 $(\\xi,\\eta)=(0,0)$ 处 $\\boldsymbol{J}$ 和 $\\boldsymbol{J}^{-1}$ 的计算过程。\n- 对于平面应变中的岩土力学分析，应变-位移矩阵 $B(\\xi,\\eta)$ 的定义使得工程应变 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{x},\\,\\varepsilon_{y},\\,\\gamma_{xy}]^{\\mathsf{T}}$ 满足 $\\boldsymbol{\\varepsilon} = B\\,\\boldsymbol{u}$，其中 $\\boldsymbol{u}$ 堆叠了 $i=1,\\dots,8$ 的节点位移分量 $u_{i,x}$ 和 $u_{i,y}$。使用你在 $(\\xi,\\eta)=(0,0)$ 处计算的 $B$，评估在给定节点位移场（单位：米）下，单元中心的剪切应变 $\\gamma_{xy}$：\n$u_{1,x}=0$，$u_{1,y}=0$，$u_{2,x}=0$，$u_{2,y}=0$，$u_{3,x}=0$，$u_{3,y}=0$，$u_{4,x}=0$，$u_{4,y}=0$，$u_{5,x}=1\\times 10^{-3}$，$u_{5,y}=0$，$u_{6,x}=0$，$u_{6,y}=3\\times 10^{-3}$，$u_{7,x}=2\\times 10^{-3}$，$u_{7,y}=0$，$u_{8,x}=0$，$u_{8,y}=-1\\times 10^{-3}$。\n\n将你最终的 $\\gamma_{xy}$ 数值答案四舍五入到 $4$ 位有效数字。应变是无量纲的；将答案表示为纯数（无单位）。", "solution": "该问题要求在二维平面应变岩土力学问题的背景下，对一个 8 节点二次 serendipity 单元（$S_2$）进行多步分析，并使用有限元法（FEM）。任务是：$1$) 推导参考单元上形函数的梯度，$2$) 建立应变-位移矩阵 $B$ 的公式，$3$) 为一个特定的物理单元计算 Jacobian 矩阵 $\\boldsymbol{J}$，以及 $4$) 对于给定的位移场，计算单元中心的剪切应变 $\\gamma_{xy}$。\n\n**第 1 部分：$S_2$ 形函数的梯度**\n\n$S_2$ 单元在参考正方形 $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$ 上有 $8$ 个节点。有 $4$ 个角点和 $4$ 个边中点。形函数 $N_i(\\xi, \\eta)$ 的定义使得 $N_i$ 在节点 $i$ 处为 $1$，在所有其他节点处为 $0$。\n\n角点为 $i \\in \\{1, 2, 3, 4\\}$。其形函数由通用公式给出：\n$$N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(\\xi_i\\xi + \\eta_i\\eta - 1)$$\n其中 $(\\xi_i, \\eta_i)$ 是角点 $i$ 的坐标。关于 $\\xi$ 和 $\\eta$ 的偏导数是：\n$$\\frac{\\partial N_i}{\\partial \\xi} = \\frac{1}{4}\\xi_i(1+\\eta_i\\eta)(2\\xi_i\\xi+\\eta_i\\eta) = \\frac{1}{4}(1+\\eta_i\\eta)(2\\xi+\\xi_i\\eta_i\\eta)$$\n$$\\frac{\\partial N_i}{\\partial \\eta} = \\frac{1}{4}\\eta_i(1+\\xi_i\\xi)(2\\eta_i\\eta+\\xi_i\\xi) = \\frac{1}{4}(1+\\xi_i\\xi)(2\\eta+\\eta_i\\xi_i\\xi)$$\n\n边中点为 $i \\in \\{5, 6, 7, 8\\}$。其形函数由以下公式给出：\n对于边 $\\xi_i=0$ 上的节点（节点 $5, 7$）：$N_i(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta_i\\eta)$\n对于边 $\\eta_i=0$ 上的节点（节点 $6, 8$）：$N_i(\\xi, \\eta) = \\frac{1}{2}(1+\\xi_i\\xi)(1-\\eta^2)$\n\n边中点的偏导数为：\n对于 $i=5$，坐标为 $(\\xi_5, \\eta_5) = (0, -1)$：$N_5 = \\frac{1}{2}(1-\\xi^2)(1-\\eta)$\n$$\\frac{\\partial N_5}{\\partial \\xi} = -\\xi(1-\\eta), \\quad \\frac{\\partial N_5}{\\partial \\eta} = -\\frac{1}{2}(1-\\xi^2)$$\n对于 $i=6$，坐标为 $(\\xi_6, \\eta_6) = (1, 0)$：$N_6 = \\frac{1}{2}(1+\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_6}{\\partial \\xi} = \\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_6}{\\partial \\eta} = -(1+\\xi)\\eta$$\n对于 $i=7$，坐标为 $(\\xi_7, \\eta_7) = (0, 1)$：$N_7 = \\frac{1}{2}(1-\\xi^2)(1+\\eta)$\n$$\\frac{\\partial N_7}{\\partial \\xi} = -\\xi(1+\\eta), \\quad \\frac{\\partial N_7}{\\partial \\eta} = \\frac{1}{2}(1-\\xi^2)$$\n对于 $i=8$，坐标为 $(\\xi_8, \\eta_8) = (-1, 0)$：$N_8 = \\frac{1}{2}(1-\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_8}{\\partial \\xi} = -\\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_8}{\\partial \\eta} = -(1-\\xi)\\eta$$\n\n**第 2 部分：应变-位移矩阵 $B$**\n\n在等参数格式中，几何和位移场都使用相同的形函数进行插值。物理坐标 $(x,y)$ 和位移分量 $(u,v)$ 由以下公式给出：\n$$x(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) y_i$$\n$$u(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,x}, \\quad v(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,y}$$\n对于小应变运动学，工程应变为 $\\varepsilon_x = \\frac{\\partial u}{\\partial x}$，$\\varepsilon_y = \\frac{\\partial v}{\\partial y}$，以及 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。用矩阵形式表示：\n$$\\boldsymbol{\\varepsilon} = \\begin{Bmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial}{\\partial y} \\\\ \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial x} \\end{bmatrix} \\begin{Bmatrix} u \\\\ v \\end{Bmatrix} = \\boldsymbol{L} \\boldsymbol{d}$$\n关于物理坐标 $(x, y)$ 的导数通过链式法则与关于参考坐标 $(\\xi, \\eta)$ 的导数相关联，其中涉及到 Jacobian 矩阵 $\\boldsymbol{J}$：\n$$\\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{Bmatrix}$$\n其中标准 Jacobian 矩阵定义为 $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}$。反转该关系得到：\n$$\\begin{Bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{Bmatrix} = (\\boldsymbol{J}^{\\mathsf{T}})^{-1} \\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix} = (\\boldsymbol{J}^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix}$$\n使用位移插值，可以将应变与节点位移 $\\boldsymbol{u}$ 联系起来。该关系为 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B} \\boldsymbol{u}$，其中 $\\boldsymbol{B}$ 是 $3 \\times 16$ 的应变-位移矩阵，它是 $3 \\times 2$ 矩阵 $\\boldsymbol{B}_i$ 的串联：\n$$\\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\dots, \\boldsymbol{B}_8]$$\n每个 $\\boldsymbol{B}_i$ 矩阵由下式给出：\n$$\\boldsymbol{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}$$\n其中形函数的物理导数计算如下：\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = (\\boldsymbol{J}^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}$$\n\n**第 3 部分：在 $(\\xi, \\eta) = (0,0)$ 处计算 $\\boldsymbol{J}$ 和 $\\boldsymbol{J}^{-1}$**\n\n首先，我们计算在单元中心 $(\\xi, \\eta) = (0,0)$ 处形函数的梯度：\n对于角点 $i \\in \\{1,2,3,4\\}$：\n$$\\frac{\\partial N_i}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_i}{\\partial \\eta}(0,0) = 0$$\n对于边中点 $i \\in \\{5,6,7,8\\}$：\n$$\\frac{\\partial N_5}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_5}{\\partial \\eta}(0,0) = -\\frac{1}{2}(1-0^2) = -\\frac{1}{2}$$\n$$\\frac{\\partial N_6}{\\partial \\xi}(0,0) = \\frac{1}{2}(1-0^2) = \\frac{1}{2}, \\quad \\frac{\\partial N_6}{\\partial \\eta}(0,0) = 0$$\n$$\\frac{\\partial N_7}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_7}{\\partial \\eta}(0,0) = \\frac{1}{2}(1-0^2) = \\frac{1}{2}$$\n$$\\frac{\\partial N_8}{\\partial \\xi}(0,0) = -\\frac{1}{2}(1-0^2) = -\\frac{1}{2}, \\quad \\frac{\\partial N_8}{\\partial \\eta}(0,0) = 0$$\n\nJacobian 矩阵 $\\boldsymbol{J}$ 的分量是：\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{8} x_i \\frac{\\partial N_i}{\\partial \\xi}$，$J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{8} x_i \\frac{\\partial N_i}{\\partial \\eta}$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{8} y_i \\frac{\\partial N_i}{\\partial \\xi}$，$J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{8} y_i \\frac{\\partial N_i}{\\partial \\eta}$\n\n使用给定的物理坐标 $\\boldsymbol{x}_i=(x_i, y_i)$ 和在 $(0,0)$ 处的导数：\n$J_{11}(0,0) = x_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + x_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (2)(\\frac{1}{2}) + (-2)(-\\frac{1}{2}) = 1+1=2$\n$J_{12}(0,0) = x_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + x_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (0)(-\\frac{1}{2}) + (0)(\\frac{1}{2}) = 0$\n$J_{21}(0,0) = y_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + y_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (0)(\\frac{1}{2}) + (0)(-\\frac{1}{2}) = 0$\n$J_{22}(0,0) = y_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + y_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (-1)(-\\frac{1}{2}) + (1)(\\frac{1}{2}) = \\frac{1}{2}+\\frac{1}{2}=1$\n\n所以，在中心的 Jacobian 矩阵及其逆矩阵为：\n$$\\boldsymbol{J}(0,0) = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad \\boldsymbol{J}^{-1}(0,0) = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix}$$\n\n**第 4 部分：剪切应变计算**\n\n剪切应变为 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。使用插值函数：\n$$\\gamma_{xy} = \\sum_{i=1}^{8} u_{i,x} \\frac{\\partial N_i}{\\partial y} + \\sum_{i=1}^{8} u_{i,y} \\frac{\\partial N_i}{\\partial x}$$\n我们在 $(\\xi, \\eta) = (0,0)$ 处计算该值。首先，我们求出 $N_i$ 在此点的物理导数：\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x}(0,0) \\\\ \\frac{\\partial N_i}{\\partial y}(0,0) \\end{Bmatrix} = (\\boldsymbol{J}(0,0)^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix}^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{Bmatrix} \\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix}$$\n所以，在中心处，$\\gamma_{xy}$ 是：\n$$\\gamma_{xy}(0,0) = \\sum_{i=1}^{8} u_{i,x} \\left(\\frac{\\partial N_i}{\\partial \\eta}(0,0)\\right) + \\sum_{i=1}^{8} u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0)\\right)$$\n节点 1, 2, 3, 4 的节点位移为零。非零位移为：\n$u_{5,x}=1\\times 10^{-3}$，$u_{5,y}=0$\n$u_{6,x}=0$，$u_{6,y}=3\\times 10^{-3}$\n$u_{7,x}=2\\times 10^{-3}$，$u_{7,y}=0$\n$u_{8,x}=0$，$u_{8,y}=-1\\times 10^{-3}$\n\n第一个求和项变为（只有节点 $5$ 和 $7$ 具有非零的 $\\frac{\\partial N_i}{\\partial \\eta}$ 和非零的 $u_{i,x}$）：\n$$\\sum u_{i,x} \\frac{\\partial N_i}{\\partial \\eta} = u_{5,x}\\frac{\\partial N_5}{\\partial \\eta}(0,0) + u_{7,x}\\frac{\\partial N_7}{\\partial \\eta}(0,0)$$\n$$= (1 \\times 10^{-3})(-\\frac{1}{2}) + (2 \\times 10^{-3})(\\frac{1}{2}) = (-0.5 + 1.0) \\times 10^{-3} = 0.5 \\times 10^{-3}$$\n第二个求和项变为（只有节点 $6$ 和 $8$ 具有非零的 $\\frac{\\partial N_i}{\\partial \\xi}$ 和非零的 $u_{i,y}$）：\n$$\\sum u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}\\right) = u_{6,y}\\left(\\frac{1}{2}\\frac{\\partial N_6}{\\partial \\xi}(0,0)\\right) + u_{8,y}\\left(\\frac{1}{2}\\frac{\\partial N_8}{\\partial \\xi}(0,0)\\right)$$\n$$= (3 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot\\frac{1}{2}\\right) + (-1 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot(-\\frac{1}{2})\\right)$$\n$$= (3 \\times 10^{-3})(\\frac{1}{4}) + (-1 \\times 10^{-3})(-\\frac{1}{4}) = (0.75 + 0.25) \\times 10^{-3} = 1.0 \\times 10^{-3}$$\n总剪切应变是这两个贡献之和：\n$$\\gamma_{xy}(0,0) = (0.5 \\times 10^{-3}) + (1.0 \\times 10^{-3}) = 1.5 \\times 10^{-3}$$\n问题要求将答案四舍五入到 4 位有效数字。\n$$\\gamma_{xy}(0,0) = 0.001500 = 1.500 \\times 10^{-3}$$", "answer": "$$\\boxed{1.500 \\times 10^{-3}}$$", "id": "3558296"}, {"introduction": "在等参映射中，雅可比矩阵$J$及其行列式$\\det(J)$起着至关重要的作用，它关联了物理空间和母单元空间。一个有效的映射要求$\\det(J)$在单元内处处为正。本练习通过一个扭曲的四边形单元，让你亲手计算导致映射失效（即$\\det(J) \\le 0$）的临界几何参数[@problem_id:3558295]，从而深刻理解网格质量对有限元分析有效性的决定性影响。", "problem": "在平面应变计算岩土力学中，考虑一个从母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 中的双单位正方形到物理 $(x,y)$ 平面的等参映射，该映射使用标准的八节点二次 serendipity 单元族（记此族为 $S_2$）。设四个角节点的物理坐标为\n$$\n\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(2,0),\\quad \\mathbf{x}_3=(-s,2),\\quad \\mathbf{x}_4=(0,2),\n$$\n其中 $s>0$ 是一个单位为米的标量“翘曲振幅”参数。四个边中节点放置在对应边的物理中点处，即\n$$\n\\mathbf{x}_5=\\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2},\\quad \\mathbf{x}_6=\\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2},\\quad \\mathbf{x}_7=\\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2},\\quad \\mathbf{x}_8=\\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2}.\n$$\n仅使用等参映射的基本定义 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,\\mathbf{x}_i$ 和标准二次 serendipity ($S_2$) 形函数 $N_i(\\xi,\\eta)$，以及雅可比矩阵的定义 $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$，推导单元中心 $(\\xi,\\eta)=(0,0)$ 处的雅可比行列式作为 $s$ 的函数，并确定使中心雅可比行列式为零的最小正翘曲振幅 $s=s_{\\mathrm{crit}}$（单位为米）。然后，基于等参映射和单元几何的基本原理，简要讨论为什么在此构造中 $s>s_{\\mathrm{crit}}$ 意味着局部雅可比行列式为负，并概述两种不同的补救策略（网格质量改进或替代映射选择）以在实践中避免这种局部反转。\n\n以米为单位给出 $s_{\\mathrm{crit}}$ 的最终数值结果。无需四舍五入；请提供精确值。", "solution": "该问题要求推导一个八节点二次 serendipity 单元在其中心处的雅可比行列式，确定使该行列式为零的临界翘曲参数 $s_{\\mathrm{crit}}$，并讨论其影响和补救措施。\n\n求解过程分为四个阶段：\n1.  定义单元几何形状以及形函数及其导数。\n2.  计算单元中心 $(\\xi,\\eta)=(0,0)$ 处雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 的分量。\n3.  推导雅可比行列式 $\\det(\\mathbf{J}(0,0))$ 作为 $s$ 的函数，并求解 $s_{\\mathrm{crit}}$。\n4.  讨论负雅可比行列式的含义并提出补救策略。\n\n**1. 单元几何与形函数导数**\n\n从母域 $(\\xi,\\eta)$ 到物理域 $(x,y)$ 的映射由等参关系给出：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\mathbf{x}_i\n$$\n其中 $N_i$ 是 $S_2$ 族的形函数，$\\mathbf{x}_i=(x_i, y_i)$ 是节点坐标。八个节点的标准母坐标 $(\\xi_i, \\eta_i)$ 为：\n角节点：$1 \\leftrightarrow (-1,-1)$，$2 \\leftrightarrow (1,-1)$，$3 \\leftrightarrow (1,1)$，$4 \\leftrightarrow (-1,1)$。\n边中节点：$5 \\leftrightarrow (0,-1)$，$6 \\leftrightarrow (1,0)$，$7 \\leftrightarrow (0,1)$，$8 \\leftrightarrow (-1,0)$。\n**注意：** 问题描述中的角节点3和4的母坐标与标准编号不一致。标准编号中，节点3在(1,1)，节点4在(-1,1)。我们将遵循标准编号。\n\n物理坐标给出如下：\n$\\mathbf{x}_1 = (0,0)$\n$\\mathbf{x}_2 = (2,0)$\n$\\mathbf{x}_3 = (-s,2)$ (对应母坐标(1,1))\n$\\mathbf{x}_4 = (0,2)$ (对应母坐标(-1,1))\n边中节点位于边的物理中点：\n$\\mathbf{x}_5 = \\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2} = \\frac{(0,0)+(2,0)}{2} = (1,0)$\n$\\mathbf{x}_6 = \\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2} = \\frac{(2,0)+(-s,2)}{2} = (1-\\frac{s}{2}, 1)$\n$\\mathbf{x}_7 = \\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2} = \\frac{(-s,2)+(0,2)}{2} = (-\\frac{s}{2}, 2)$\n$\\mathbf{x}_8 = \\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2} = \\frac{(0,2)+(0,0)}{2} = (0,1)$\n\n雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\ \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix}\n$$\n标准 serendipity 形函数的一个关键特性是角节点形函数（$N_1, N_2, N_3, N_4$）的导数在单元中心 $(\\xi,\\eta)=(0,0)$ 处为零。边中节点形函数（$N_5, N_6, N_7, N_8$）在中心的导数非零，由下式给出：\n$$\n\\begin{array}{c|c|c}\ni & \\frac{\\partial N_i}{\\partial \\xi}\\Big|_{(0,0)} & \\frac{\\partial N_i}{\\partial \\eta}\\Big|_{(0,0)} \\\\\n\\hline\n5 & 0 & -1/2 \\\\\n6 & 1/2 & 0 \\\\\n7 & 0 & 1/2 \\\\\n8 & -1/2 & 0 \\\\\n\\end{array}\n$$\n\n**2. 单元中心的雅可比矩阵**\n\n使用上述导数，计算 $(\\xi,\\eta) = (0,0)$ 处的雅可比矩阵分量如下。求和简化为仅包含边中节点的项。\n\n$\\frac{\\partial x}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{\\partial N_6}{\\partial \\xi}x_6 + \\frac{\\partial N_8}{\\partial \\xi}x_8 = \\frac{1}{2}\\left(1-\\frac{s}{2}\\right) + \\left(-\\frac{1}{2}\\right)(0) = \\frac{1}{2}-\\frac{s}{4}$\n\n$\\frac{\\partial x}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{\\partial N_5}{\\partial \\eta}x_5 + \\frac{\\partial N_7}{\\partial \\eta}x_7 = \\left(-\\frac{1}{2}\\right)(1) + \\frac{1}{2}\\left(-\\frac{s}{2}\\right) = -\\frac{1}{2}-\\frac{s}{4}$\n\n$\\frac{\\partial y}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{\\partial N_6}{\\partial \\xi}y_6 + \\frac{\\partial N_8}{\\partial \\xi}y_8 = \\frac{1}{2}(1) + \\left(-\\frac{1}{2}\\right)(1) = 0$\n\n$\\frac{\\partial y}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{\\partial N_5}{\\partial \\eta}y_5 + \\frac{\\partial N_7}{\\partial \\eta}y_7 = \\left(-\\frac{1}{2}\\right)(0) + \\frac{1}{2}(2) = 1$\n\n中心的雅可比矩阵为：\n$$\n\\mathbf{J}(0,0) = \\begin{pmatrix} \\frac{1}{2} - \\frac{s}{4} & -\\frac{1}{2} - \\frac{s}{4} \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n**3. 雅可比行列式与临界翘曲振幅**\n\n中心的雅可比行列式为：\n$$\n\\det(\\mathbf{J}(0,0)) = \\left(\\frac{1}{2} - \\frac{s}{4}\\right)(1) - \\left(-\\frac{1}{2} - \\frac{s}{4}\\right)(0) = \\frac{1}{2} - \\frac{s}{4}\n$$\n当雅可比行列式为零或变为负时，映射变得无效。临界翘曲振幅 $s_{\\mathrm{crit}}$ 是使行列式为零的最小正 $s$ 值。\n$$\n\\det(\\mathbf{J}(0,0)) = 0 \\implies \\frac{1}{2} - \\frac{s}{4} = 0\n$$\n求解 $s$：\n$$\n\\frac{s}{4} = \\frac{1}{2} \\implies s = 2\n$$\n因此，临界翘曲振幅为 $s_{\\mathrm{crit}} = 2$ 米。\n\n**4. 关于负雅可比行列式和补救策略的讨论**\n\n对于一个有效的一对一等参映射，雅可比行列式必须在单元内处处为正，即 $\\det(\\mathbf{J}) > 0$。该行列式表示物理空间与母空间中微分面积的局部比率，$dA = \\det(\\mathbf{J}) d\\xi d\\eta$。正的行列式确保局部坐标系的方向得以保持。\n\n在此构造中，行列式 $\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{s}{4}$ 是 $s$ 的连续函数。当 $s > s_{\\mathrm{crit}}=2$ 时，行列式变为负值。例如，如果 $s=4$，$\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{4}{4} = -0.5$。负行列式意味着单元几何的局部反转或“折叠”。从几何上看，$J_{11} = \\frac{\\partial x}{\\partial \\xi}|_{(0,0)} = \\frac{1}{2} - \\frac{s}{4}$ 这一项在 $s>2$ 时变为负值。这意味着沿着单元的中心线（$\\eta=0$），母坐标 $\\xi$ 的增加（从节点8所在的边移动到节点6所在的边）会导致物理坐标 $x$ 的减少。单元几何形状变为自穿透，这对于连续体来说在物理上和数学上都是无效的。\n\n避免这种局部反转的两种不同补救策略是：\n\n1.  **网格质量改进：** 这种方法侧重于改变网格以防止严重畸变。\n    *   **节点重定位（平滑）：** 导致单元无效的主要原因是角节点 $\\mathbf{x}_3=(-s,2)$ 的极端位置。可以采用网格生成或平滑算法来重新定位该节点（即将 $s$ 的值减小到 $s_{\\mathrm{crit}}$ 以下），以确保网格中所有单元的雅可比行列式都为正。这是实践中最常见的方法。\n    *   **网格细化：** 可以用多个更小、形状更好的单元替换单个高度畸变的四边形。例如，该区域可以被细分为两个三角形单元或四个更小的四边形单元。这样做会增加自由度，但可以表示预期的几何形状而不会产生无效单元。\n\n2.  **替代公式或单元选择：** 这种方法修改有限元公式本身，而不是网格几何。\n    *   **亚参公式：** 可以使用比场变量近似阶数更低的形函数进行几何映射。例如，使用线性的几何映射（仅基于四个角节点）和二次形函数来求解场。这样单元的边将是直的。这是一种亚参单元。然而，对于足够大的 $s$，由四个角节点定义的四边形会变得自相交（一个“交叉四边形”），即使使用线性映射，它仍然是无效的。\n    *   **使用低阶或更鲁棒的单元：** 更简单的单元通常更能抵抗畸变。可以使用由四节点线性四边形 ($Q_1$) 或三节点线性三角形 (CST) 组成的网格。这些单元因节点定位而失效的趋势较低，但代价是每个单元的精度降低，尤其是在弯曲情况下。", "answer": "$$\\boxed{2}$$", "id": "3558295"}, {"introduction": "为了提高计算效率并克服某些单元的“闭锁”现象，工程实践中常采用降阶积分。然而，这种方法可能引入被称为“沙漏模式”的伪零能变形模式。本练习将通过一个二次serendipity单元，演示在$1\\times1$高斯积分下如何构造一种特定的节点位移场，使其不产生任何应变能[@problem_id:3558309]，从而让你直观地理解沙漏现象的根源及其对解的稳定性的潜在威胁。", "problem": "考虑一个均质、各向同性的土体，其小应变、平面应变、线弹性响应通过单个二阶 serendipity 族（$S_2$）四边形等参有限元进行离散。该单元在母坐标 $(\\xi,\\eta)$ 中占据方形参考域 $[-1,1]\\times[-1,1]$，对于本问题，等参映射为单位映射，因此物理坐标 $(x,y)$ 与 $(\\xi,\\eta)$ 重合。该单元有八个节点：四个角节点位于 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$，四个边中节点位于 $(\\xi,\\eta)=(0,-1),(1,0),(0,1),(-1,0)$。每个节点有两个位移自由度，$u_x$ 和 $u_y$。插值使用标准的 $S_2$ serendipity 形函数。\n\n应变张量 $\\boldsymbol{\\varepsilon}$ 由小应变运动学定义，即 $\\boldsymbol{\\varepsilon}=\\operatorname{sym}(\\nabla \\boldsymbol{u})$，应变能密度为 $W(\\boldsymbol{\\varepsilon})=\\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{D}$ 是平面应变问题的对称正定弹性矩阵。单元刚度将使用减缩积分法，通过 $1\\times 1$ 高斯求积法则（在参考正方形上，单个高斯点位于 $(\\xi,\\eta)=(0,0)$，权重为 $2\\times 2$）进行计算，因此应变能仅取决于在 $(\\xi,\\eta)=(0,0)$ 处计算的应变。\n\n仅使用上述定义和标准的 $S_2$ serendipity 形函数，推导在高斯点 $(\\xi,\\eta)=(0,0)$ 处的应变-位移关系，并说明减缩积分如何能产生零应变能的位移模式（沙漏模式）。然后，将注意力集中在一种位移模式上，其中所有节点自由度均为零，除了右侧和左侧边中节点（分别位于 $(\\xi,\\eta)=(1,0)$ 和 $(\\xi,\\eta)=(-1,0)$）的水平位移。将这两个非零自由度表示为 $u_{6x}=A$ 和 $u_{8x}=rA$，其中 $A\\neq 0$ 是一个任意振幅，$r$ 是一个实数值比率。确定 $r$ 的值，使得通过 $1\\times 1$ 求积法则计算的应变能恰好为零。将最终答案表示为一个实数。不需要四舍五入，也不需要报告物理单位。", "solution": "该问题是有效的，因为它科学地基于计算力学和有限元法的原理，是适定的、客观的，并为其解决提供了一套自洽和一致的数据和条件。\n\n有限元的总应变能 $U$ 由应变能密度 $W(\\boldsymbol{\\varepsilon})$ 在单元面积 $A_{e}$ 上的积分给出。由于问题指定了平面应变条件，我们考虑单位厚度的能量。等参映射是单位映射，因此物理坐标 $(x,y)$ 与母坐标 $(\\xi,\\eta)$ 相同，雅可比矩阵的行列式为 $|\\boldsymbol{J}|=1$。因此积分为：\n$$U = \\int_{A_e} W(\\boldsymbol{\\varepsilon}) \\, dA = \\int_{-1}^{1} \\int_{-1}^{1} W(\\boldsymbol{\\varepsilon}(\\xi, \\eta)) \\, d\\xi \\, d\\eta$$\n问题指定单元刚度以及应变能是通过 $1 \\times 1$ 高斯求积法则计算的。该法则通过在参考域的中心 $(\\xi, \\eta) = (0,0)$ 处计算被积函数，并乘以相应的权重（对于参考正方形 $[-1,1]\\times[-1,1]$，权重为 $2 \\times 2 = 4$）来近似积分。\n$$U \\approx 4 \\cdot W(\\boldsymbol{\\varepsilon}(0,0))$$\n应变能密度定义为 $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{D}$ 是对称正定弹性矩阵。由于 $\\boldsymbol{D}$ 是正定的，当且仅当应变张量 $\\boldsymbol{\\varepsilon}$ 为零张量时，$W(\\boldsymbol{\\varepsilon})$ 才为零。因此，通过减缩积分方案近似的应变能为零，当且仅当在高斯点处计算的应变张量为零：\n$$\\boldsymbol{\\varepsilon}(0,0) = \\mathbf{0}$$\n为了评估此条件，我们必须首先建立在 $(\\xi, \\eta) = (0,0)$ 处的应变-位移关系。位移场 $\\boldsymbol{u}(\\xi,\\eta)$ 是使用 $S_2$ serendipity 形函数 $N_i(\\xi, \\eta)$ 从节点位移 $\\boldsymbol{d}_i$ 插值得到的：\n$$\\boldsymbol{u}(\\xi,\\eta) = \\begin{pmatrix} u_x(\\xi,\\eta) \\\\ u_y(\\xi,\\eta) \\end{pmatrix} = \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix}$$\n在与 $(\\xi,\\eta)$ 重合的 $(x,y)$ 坐标系中，小应变张量的分量为：\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial u_x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} u_{ix}$$\n$$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial u_y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} u_{iy}$$\n$$\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial u_x}{\\partial \\eta} + \\frac{\\partial u_y}{\\partial \\xi} = \\sum_{i=1}^{8} \\left( \\frac{\\partial N_i}{\\partial \\eta} u_{ix} + \\frac{\\partial N_i}{\\partial \\xi} u_{iy} \\right)$$\n这些表达式必须在高斯点 $(\\xi, \\eta) = (0,0)$ 处进行计算。这需要 $S_2$ 形函数在该点的导数。\n\n对于角节点 ($i=1,2,3,4$)，形函数及其一阶偏导数在原点处均为零。\n对于边中节点 ($i=5,6,7,8$)，其形函数在原点处的偏导数如下：\n*   $i=5: (\\xi,\\eta)=(0,-1)$, $N_5 = \\frac{1}{2}(1-\\xi^2)(1-\\eta) \\implies \\frac{\\partial N_5}{\\partial\\xi}(0,0)=0$, $\\frac{\\partial N_5}{\\partial\\eta}(0,0)=-1/2$\n*   $i=6: (\\xi,\\eta)=(1,0)$, $N_6 = \\frac{1}{2}(1+\\xi)(1-\\eta^2) \\implies \\frac{\\partial N_6}{\\partial\\xi}(0,0)=1/2$, $\\frac{\\partial N_6}{\\partial\\eta}(0,0)=0$\n*   $i=7: (\\xi,\\eta)=(0,1)$, $N_7 = \\frac{1}{2}(1-\\xi^2)(1+\\eta) \\implies \\frac{\\partial N_7}{\\partial\\xi}(0,0)=0$, $\\frac{\\partial N_7}{\\partial\\eta}(0,0)=1/2$\n*   $i=8: (\\xi,\\eta)=(-1,0)$, $N_8 = \\frac{1}{2}(1-\\xi)(1-\\eta^2) \\implies \\frac{\\partial N_8}{\\partial\\xi}(0,0)=-1/2$, $\\frac{\\partial N_8}{\\partial\\eta}(0,0)=0$\n\n问题中定义的位移场仅涉及 $u_{6x}$ 和 $u_{8x}$：\n$$ u_{6x}=A, \\quad u_{8x}=rA $$\n所有其他节点位移均为零。\n\n现在我们在 $(\\xi,\\eta)=(0,0)$ 处计算应变分量：\n**轴向应变 $\\varepsilon_{xx}$:**\n$$ \\varepsilon_{xx}(0,0) = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi}(0,0) u_{ix} $$\n求和中只有 $i=6$ 和 $i=8$ 的项非零：\n$$ \\varepsilon_{xx}(0,0) = \\frac{\\partial N_6}{\\partial \\xi}(0,0) u_{6x} + \\frac{\\partial N_8}{\\partial \\xi}(0,0) u_{8x} = \\left(\\frac{1}{2}\\right) A + \\left(-\\frac{1}{2}\\right) rA = \\frac{A}{2}(1-r) $$\n**轴向应变 $\\varepsilon_{yy}$:**\n$$ \\varepsilon_{yy}(0,0) = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta}(0,0) u_{iy} $$\n由于所有 $u_{iy}$ 自由度均为零，因此 $\\varepsilon_{yy}(0,0) = 0$。\n\n**剪切应变 $\\gamma_{xy}$:**\n$$ \\gamma_{xy}(0,0) = \\sum_{i=1}^{8} \\left( \\frac{\\partial N_i}{\\partial \\eta}(0,0) u_{ix} + \\frac{\\partial N_i}{\\partial \\xi}(0,0) u_{iy} \\right) $$\n第二项为零，因为所有 $u_{iy}$ 均为零。第一项为：\n$$ \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta}(0,0) u_{ix} = \\frac{\\partial N_5}{\\partial \\eta}u_{5x} + \\frac{\\partial N_7}{\\partial \\eta}u_{7x} + \\dots $$\n由于 $u_{5x}$ 和 $u_{7x}$ 也为零，并且 $u_{6x}$ 和 $u_{8x}$ 对应的 $\\frac{\\partial N_i}{\\partial \\eta}$ 为零，所以该项也为零。因此 $\\gamma_{xy}(0,0) = 0$。\n\n为了使应变能为零，我们需要所有应变分量在高斯点处为零。$\\varepsilon_{yy}$ 和 $\\gamma_{xy}$ 已经为零。我们只需设置 $\\varepsilon_{xx}(0,0) = 0$：\n$$ \\frac{A}{2}(1-r) = 0 $$\n由于 $A \\neq 0$，我们必须有：\n$$ 1-r=0 \\implies r=1 $$\n因此，当 $r=1$ 时（即 $u_{6x} = A, u_{8x} = A$），该位移场在 $1\\times 1$ 减缩积分下产生零应变能。这是一种典型的沙漏模式，单元在没有产生任何应变能的情况下发生变形，导致刚度矩阵出现奇异性，并可能污染数值解。", "answer": "$$\\boxed{1}$$", "id": "3558309"}]}