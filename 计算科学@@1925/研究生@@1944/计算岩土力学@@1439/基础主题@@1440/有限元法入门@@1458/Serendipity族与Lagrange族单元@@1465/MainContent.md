## 引言
在计算岩[土力学](@entry_id:180264)的广阔领域中，有限元法（FEM）是模拟土壤、岩石及结构相互作用行为不可或缺的工具。该方法成功的基石在于其将复杂的连续介质问题离散为由简单几何单元组成的集合。在众多单元类型中，拉格朗日（Lagrangian）单元族和“赛伦迪皮蒂”（Serendipity）单元族因其构造的系统性和应用的广泛性，构成了四边形和[六面体单元](@entry_id:174602)库的主体。然而，对于初学者和许多实践者而言，这两种单元族系之间的选择往往令人困惑：它们在理论上究竟有何不同？这些看似细微的数学差异在解决[地基沉降](@entry_id:755031)、地震响应或边坡失稳等实际工程问题时，又会如何影响结果的精度、稳定性和计算效率？

本文旨在填补这一理论与实践之间的认知鸿沟。我们将系统性地剖析和对比这两种关键的单元族系，揭示其内在的设计哲学与性能表现。读者将通过本文学习到：

在“原则与机理”一章中，我们将回归本源，探讨协调单元的$C^0$连续性要求，并深入讲解拉格朗日单元的[张量积](@entry_id:140694)构造和赛伦迪皮蒂单元的节点削减策略，阐明它们各自多项式空间的完备性与不完备性。随后，在“应用与跨学科联系”一章中，我们将把这些理论置于真实世界的岩土工程场景下进行检验，分析它们在处理[体积锁定](@entry_id:172606)、多物理场耦合、波传播频散以及[大变形](@entry_id:167243)问题时的优劣。最后，“动手实践”部分将提供具体的计算练习，帮助读者巩固对[等参映射](@entry_id:173239)和单元行为的理解。

通过这一结构化的学习路径，本文旨在帮助读者不仅理解“是什么”，更能洞悉“为什么”，从而在未来的科研和工程实践中，能够根据具体问题，自信地做出最优的单元选择。让我们首先从这两种单元族系最核心的构造原则与机理开始。

## 原则与机理

在本章中，我们将深入探讨[有限元法](@entry_id:749389)中两种重要的单元族——拉格朗日（Lagrangian）单元族和“赛伦迪皮蒂”（Serendipity）单元族——的构造原则与内在机理。这些单元是计算岩土力学中位移法公式的基石。我们的讨论将从协调性单元的基本要求出发，逐步揭示这两种单元族的数学构造、[多项式完备性](@entry_id:177462)及其在实际应用中的性能差异。

### 弹性力学问题的协调性单元基础

在基于位移的岩[土力学](@entry_id:180264)小应变分析中，我们求解的是一个以[位移场](@entry_id:141476) $\boldsymbol{u}$ 为未知量的[偏微分方程](@entry_id:141332)系统。其标准的[变分形式](@entry_id:166033)（或称[弱形式](@entry_id:142897)）要求[试探函数](@entry_id:756165)和检验函数具备一定的[光滑性](@entry_id:634843)，以确保[能量积分](@entry_id:166228)有意义。具体而言，这些函数必须属于索博列夫空间 $H^1(\Omega)$，这是一个包含其自身及其一阶[弱导数](@entry_id:189356)均平方可积的函数空间。

当采用有限元法进行离散时，我们用分片多项式函数来逼近真实的位移场。为了使离散函数空间成为连续函数空间 $H^1(\Omega)$ 的一个[子空间](@entry_id:150286)，即构造一个**[协调有限元](@entry_id:170866)**方法，我们必须保证逼近函数在整个求解域上是连续的。这被称为 $C^0$ **跨单元连续性**。如果函数在单元边界上出现跳跃（不连续），其[弱导数](@entry_id:189356)将包含沿边界的狄拉克 $\delta$ 函数，这将导致其不属于 $H^1(\Omega)$ 空间。

因此，对于位移法而言，任何协调单元族的核心任务都是确保在单元拼接处位移场的连续性。拉格朗日型[节点单元](@entry_id:752523)通过在相邻单元的共享边界（二维中的边，三维中的面）上设置共享节点，并确保这些共享节点上的自由度能够唯一确定边界上的函数值（即迹），从而巧妙地满足了 $C^0$ 连续性要求。拉格朗日族和赛伦迪皮蒂族单元都是实现这一目标的主流选择 [@problem_id:3558255]。

### 超立方体上的拉格朗日单元族 ($Q_k$)

拉格朗日单元族，通常记为 $Q_k$（$k$ 为多项式次数），是在参考单元（二维为正方形，三维为立方体）上通过张量积构造的。这种构造方法系统而强大，是理解更复杂单元的基础。

#### [张量积](@entry_id:140694)构造

让我们从一维情况开始。在参考区间 $[-1, 1]$ 上，一个 $k$ 次多项式由 $k+1$ 个节点上的值唯一确定。对于最简单的一次多项式（$k=1$），我们需要两个节点，通常取为 $-1$ 和 $1$。对应的两个线性[拉格朗日基](@entry_id:751105)函数为：
$$
L_1(s) = \frac{1-s}{2}, \quad L_2(s) = \frac{1+s}{2}
$$
它们满足克罗内克-德尔塔（Kronecker delta）性质，即 $L_i(s_j) = \delta_{ij}$，其中 $s_1=-1, s_2=1$。

要将此推广到二维参考正方形 $\hat{K} = [-1,1]^2$（坐标为 $(\xi, \eta)$），我们只需将一维的[基函数](@entry_id:170178)进行**张量积**。对于双线性 $Q_1$ 单元，其四个节点位于正方形的四个角点 $(\pm 1, \pm 1)$。每个节点的形函数由其对应坐标的一维[基函数](@entry_id:170178)相乘得到。例如，对于节点 $1$ $(\xi_1, \eta_1) = (-1, -1)$，其形函数为：
$$
N_1(\xi, \eta) = L_1(\xi) L_1(\eta) = \frac{1-\xi}{2} \cdot \frac{1-\eta}{2} = \frac{1}{4}(1-\xi)(1-\eta)
$$
以此类推，我们可以得到全部四个形函数 [@problem_id:3558324]：
$$
\begin{pmatrix} N_1(\xi,\eta) & N_2(\xi,\eta) & N_3(\xi,\eta) & N_4(\xi,\eta) \end{pmatrix} = \begin{pmatrix} \frac{1}{4}(1-\xi)(1-\eta) & \frac{1}{4}(1+\xi)(1-\eta) & \frac{1}{4}(1+\xi)(1+\eta) & \frac{1}{4}(1-\xi)(1+\eta) \end{pmatrix}
$$
这些形函数具备两个关键性质。首先是**克罗内克-德尔[塔性质](@entry_id:273153)**，$N_a(\xi_b, \eta_b) = \delta_{ab}$，即每个形函数在自己的节点上取值为1，在所有其他节点上取值为0。其次是**[单位分解](@entry_id:150115)性**，$\sum_{a=1}^{4} N_a(\xi, \eta) = 1$，这保证了单元能够精确再现常数场，是收敛性的基本要求。

#### [多项式空间](@entry_id:144410) $\mathcal{Q}_k$

[张量积](@entry_id:140694)构造方法直接定义了拉格朗日单元能够精确再现的多项式空间。$\mathcal{Q}_k$ 空间由所有在每个坐标方向上次数最高为 $k$ 的多项式组成。换言之，它是单项式集合 $\{\xi_1^{i_1} \xi_2^{i_2} \cdots \xi_d^{i_d} : 0 \le i_\alpha \le k, \forall \alpha=1,\dots,d\}$ 的线性张成空间。

该空间的维数可以通过简单的组合学原理确定。对于 $d$ 维空间中的每个坐标 $\xi_\alpha$，指数 $i_\alpha$ 可以取 $k+1$ 个值（从 $0$ 到 $k$）。由于各坐标方向上的选择是独立的，总的[基函数](@entry_id:170178)（单项式）数量为 $(k+1)$ 的 $d$ 次方。因此，$\mathcal{Q}_k$ 空间的维数，也即 $Q_k$ 单元的节点数（或自由度数）为：
$$
\dim(\mathcal{Q}_k) = (k+1)^d
$$
这一公式清晰地量化了拉格朗日单元的复杂性。例如，对于一个二次（$k=2$）[四边形单元](@entry_id:176937)（$d=2$），其节点数为 $(2+1)^2=9$。对于三次（$k=3$）[四边形单元](@entry_id:176937)（$d=2$），节点数为 $(3+1)^2=16$；而对于三次[六面体单元](@entry_id:174602)（$d=3$），节点数则激增至 $(3+1)^3=64$ [@problem_id:3558313]。这种节点数的快速增长是高阶拉格朗日单元在实践中（尤其是在三维问题中）计算成本高昂的主要原因。

$\mathcal{Q}_k$ 空间的构造方式赋予了它**张量积完备性**，即它包含了所有可能的次数组合，直至每个方向上的最高次 $k$。这一性质保证了其优越的多项式再现能力 [@problem_id:3558265]。

### “赛伦迪皮蒂”单元族 ($S_k$)

为了在保持[高阶单元](@entry_id:750328)良好逼近性质的同时降低计算成本，研究者们发展了“赛伦迪皮蒂”单元族（Serendipity family），记为 $S_k$。其核心思想是，通过移除拉格朗日单元中的部分内部节点，减少自由度总数。

#### 动机与构造原则

$S_k$ 单元的构造原则是仅在单元的边界（顶点、边、面）上布置节点。对于二维[四边形单元](@entry_id:176937)，其节点仅[分布](@entry_id:182848)于4个顶点和4条边上。每条边（包括两个端点）上有 $k+1$ 个节点，足以唯一确定该边界上的一维 $k$ 次多项式。

由此，我们可以推导出二维 $S_k$ 单元的自由度数量。它由4个顶点节点和4条边上每条 $k-1$ 个内部节点组成，总数为 [@problem_id:3558322]：
$$
\dim(\mathcal{S}_k) = 4 + 4(k-1) = 4k
$$
以二次（$k=2$）单元为例，$\dim(\mathcal{S}_2) = 4 \times 2 = 8$，即著名的8节点[四边形单元](@entry_id:176937)，相比于 $Q_2$ 单元的9个节点，它移除了中心节点。对于三次（$k=3$）单元，$\dim(\mathcal{S}_3) = 4 \times 3 = 12$，相比于 $Q_3$ 单元的16个节点，它移除了内部的4个节点。这种自由度的显著减少是“赛伦迪皮蒂”单元吸[引力](@entry_id:175476)的关键所在。

#### 多项式空间 $\mathcal{S}_k$ 及其不完备性

由于自由度数减少，$\mathcal{S}_k$ 空间必然是 $\mathcal{Q}_k$ 的一个真[子空间](@entry_id:150286)（对于 $k \ge 2$）。那么，“赛伦迪皮蒂”单元究竟牺牲了什么？答案是：完整的[张量积](@entry_id:140694)完备性。

让我们以 $k=2$ 的情况来具体分析。$Q_2$ 空间由9个单项式 $\{1, \xi, \eta, \xi^2, \xi\eta, \eta^2, \xi^2\eta, \xi\eta^2, \xi^2\eta^2\}$ 张成。而 $S_2$ 空间为了仅用8个边界节点就能唯一确定，必须舍弃一个多项式[基函数](@entry_id:170178)。这个被舍弃的[基函数](@entry_id:170178)不能影响到边界上的二次多项式行为。可以证明，被舍弃的正是那个在所有8个边界节点上都为零的“内部气泡”模式，它与最高次的混合项 $\xi^2\eta^2$ 紧密相关。因此，$S_2$ 的多项式空间通常被定义为：
$$
\mathcal{S}_2 = \text{span}\{1, \xi, \eta, \xi^2, \xi\eta, \eta^2, \xi^2\eta, \xi\eta^2\}
$$
一个常见的误解是，$S_2$ 单元无法再现二次场。这是不正确的。从上式可以看出，$\mathcal{S}_2$ 包含了所有**总次数**不超过2的单项式（即 $\xi^2, \xi\eta, \eta^2$）。因此，$S_2$ 能够精确再现任何二次多项式场。它所不能再现的，是那些包含 $\xi^2\eta^2$ 这种更高次混合项的场 [@problem_id:3558270] [@problem_id:3558276]。

这个模式可以推广到更高阶。一种形式化的定义“赛伦迪皮蒂”空间的方法是基于**超线性次数**。一个单项式 $\xi^i \eta^j$ 的超线性次数定义为所有次数不小于2的指数之和。例如，$s(\xi^3\eta) = 3$, $s(\xi^3\eta^2) = 3+2=5$。$S_k$ 空间则被定义为 $\mathcal{Q}_k$ 中所有超线性次数不超过 $k$ 的单项式张成的[子空间](@entry_id:150286) [@problem_id:3558305]。

根据这个规则，我们可以系统地找出从 $\mathcal{Q}_k$ 中被舍弃的单项式。对于 $S_3$ 单元，其空间 $\mathcal{S}_3$ 中不包含所有超线性次数大于3的单项式。在 $\mathcal{Q}_3$ 的16个单项式中，满足 $i,j \ge 2$ 且 $i+j > 3$ 的项有 $\xi^2\eta^2$ ($2+2=4$), $\xi^2\eta^3$ ($2+3=5$), $\xi^3\eta^2$ ($3+2=5$), 和 $\xi^3\eta^3$ ($3+3=6$)。这4个单项式正是从 $\mathcal{Q}_3$ 中被舍弃的，从而使得 $\dim(\mathcal{S}_3) = 16 - 4 = 12$ [@problem_id:3558317]。

从分层基的角度看，$\mathcal{Q}_k$ 空间可以由顶点、边、面（或内部）函数构成。顶点和边函数定义了单元边界上的行为，而面函数（或内部[气泡函数](@entry_id:176111)）只在单元内部非零。$\mathcal{S}_k$ 空间可以被看作是保留了 $\mathcal{Q}_k$ 全套的顶点和边函数，但舍弃了部分或全部面函数的结果。对于 $k \ge 4$，需要舍弃的面函数数量为 $\frac{k^2+k-4}{2}$ [@problem_id:3558305]。

### 对比分析与实践意义

#### 多项式再现能力

$Q_k$ 与 $S_k$ 的核心区别在于它们的多项式再现能力。$Q_k$ 单元能够精确再现其张量积空间 $\mathcal{Q}_k$ 内的任何多项式场。而 $S_k$ 单元（对于 $k \ge 2$）由于缺少了特定的高阶混合项，无法再现这些场。例如，如果一个问题的精确解恰好包含 $\xi^2\eta^2$ 项，那么使用 $S_2$ 单元的有限元模型将无法得到精确解，而只能得到一个近似解。$Q_2$ 单元则可以精确捕捉该解 [@problem_id:3558265]。

#### [等参映射](@entry_id:173239)的影响

这一区别在处理弯曲几何时变得尤为重要。有限元法通过**[等参映射](@entry_id:173239)**将物理空间中任意形状的单元 $K$ 映射到参考单元 $\hat{K}$。这个映射本身也是用单元的形函数来构造的。对于一个普通的（非平行四边形）四边形，其[几何映射](@entry_id:749852)函数通常包含 $\xi\eta$ 这样的混合项。

现在考虑一个物理问题，其精确解是物理坐标 $(x,y)$ 下的一个简单二次多项式，例如 $p(x,y) = xy$。在[有限元分析](@entry_id:138109)中，我们需要考察这个解在参考单元上的形式，即它的“[拉回](@entry_id:160816)”（pullback）$p(x(\xi,\eta), y(\xi,\eta))$。如果[几何映射](@entry_id:749852) $x(\xi,\eta)$ 和 $y(\xi,\eta)$ 都含有 $\xi\eta$ 项，那么它们的乘积 $x(\xi,\eta) \cdot y(\xi,\eta)$ 将不可避免地产生 $(\xi\eta)^2 = \xi^2\eta^2$ 这一项。

这意味着，即使物理场是一个简单的二次多项式，在弯曲单元的参考坐标下，它也可能包含 $\xi^2\eta^2$ 项。由于 $S_2$ 空间恰恰缺少这一项，它将无法在弯曲单元上精确再现物理二次场。相比之下，$Q_2$ 空间包含了 $\xi^2\eta^2$，因此能够在这种情况下保持其再现能力。这一现象是“赛伦迪皮蒂”单元在处理弯曲几何时精度可能受限的一个典型例子，也是在选择单元时需要权衡的重要因素 [@problem_id:3558290]。

#### 单形上的情况：为何“赛伦迪皮蒂”是[超立方体](@entry_id:273913)的概念

一个自然的问题是：我们能否将“赛伦迪皮蒂”单元的思想——即移除内部节点来简化单元——应用到三角形或四面体这样的**单形单元**上？答案揭示了一个深刻的结构性差异。

单形单元上的标准多项式空间是**总次数**不超过 $k$ 的[多项式空间](@entry_id:144410) $\mathcal{P}_k$。与张量积空间 $\mathcal{Q}_k$ 不同，$\mathcal{P}_k$ 的一个关键特性是，当次数 $k$ 足够高时，它会包含严格的**内部[气泡函数](@entry_id:176111)**——即在单元整个边界上都为零但在内部非零的多项式。对于三角形，当 $k \ge 3$ 时，$\mathcal{P}_k$ 包含[气泡函数](@entry_id:176111) $\lambda_1\lambda_2\lambda_3$（其中 $\lambda_i$ 是[重心坐标](@entry_id:155488)）。对于四面体，当 $k \ge 4$ 时，$\mathcal{P}_k$ 包含[气泡函数](@entry_id:176111) $\lambda_1\lambda_2\lambda_3\lambda_4$。

这些[气泡函数](@entry_id:176111)的存在，使得为完整的 $\mathcal{P}_k$ 空间（对于上述高次情况）构造一个仅有边界自由度的协调单元成为不可能。因为任何只作用于边界的自由度（如节点值或导数值）都无法“感知”到这个内部[气泡函数](@entry_id:176111)，从而无法区分它和零函数，导致单元的自由度不唯一（unisolvent）。

因此，“赛伦迪皮蒂”单元这种“在保留完整[多项式空间](@entry_id:144410)的同时移除内部节点”的构造方式在单形上是行不通的。我们可以在单形上定义缺少某些高次项的简化空间，但这与四边形/六面体上从 $\mathcal{Q}_k$ 到 $\mathcal{S}_k$ 的系统性约简在概念上有所不同。这解释了为何“赛伦迪皮蒂”单元主要是与[超立方体](@entry_id:273913)（正方形、立方体）结构相关联的概念 [@problem_id:3558264]。

总之，拉格朗日单元族以其构造的系统性和强大的多项式再现能力为特点，但计算成本较高。而“赛伦迪皮蒂”单元族则通过巧妙地舍弃部分高阶混合多项式，在显著降低计算成本的同时，保持了对低阶多项式的完整再现能力和协调性，为工程实践提供了一种高效的折衷方案。然而，使用者必须清楚其在再现高阶场和处理弯曲几何方面的内在局限性。