{"hands_on_practices": [{"introduction": "有限元法提供的是一个近似解，理解其误差的来源和性质是计算力学中的一个核心任务。本练习 [@problem_id:3498577] 将指导你推导一个在自重作用下杆的精确位移场，并将其与一个单单元有限元模型的解进行比较。通过这个过程，你将学习如何量化能量范数下的离散误差，这是评估有限元解精度的关键概念。", "problem": "考虑一根长度为 $L$、横截面积为 $A$、杨氏模量为 $E$ 的棱柱形均匀杆，沿空间坐标 $x \\in [0,L]$ 放置。该杆受到一个沿轴向作用的、大小为 $b$ 的恒定单位体积体力。假设为小应变和线性弹性。其左端 $x=0$ 处为固定端 ($u(0)=0$)，右端 $x=L$ 处在轴向上无牵引力（即 $x=L$ 处的轴向力为零）。\n\n仅从轴向平衡和计算岩土力学中适用于一维杆的线性本构关系出发，推导满足边界条件的解析位移场 $u(x)$。然后，使用覆盖整个域 $[0,L]$ 的单个双节点线性杆单元，通过有限元法（FEM; Finite Element Method），构建具有一致体力荷载表示和给定自然边界条件的单单元有限元位移场 $u_h(x)$。\n\n使用由一维线弹性内能引出的能量范数，通过相对能量范数来量化离散误差。相对能量范数定义为误差场的能量范数与精确解的能量范数之比。请给出此相对误差的精确值，该值应为无单位的纯数，无需四舍五入。", "solution": "用户提供了一个问题陈述，在尝试求解之前需要对其进行验证。\n\n### 第1步：提取已知条件\n- 一根长度为 $L$、横截面积为 $A$、杨氏模量为 $E$ 的棱柱形均匀杆。\n- 该杆沿 $x$ 轴放置，占据域 $x \\in [0,L]$。\n- 一个大小为 $b$ 的恒定单位体积体力沿轴向作用。\n- 假设：小应变和线性弹性。\n- 边界条件：\n    1.  $x=0$ 处为固定端：$u(0)=0$。\n    2.  $x=L$ 处为无牵引力端：轴向力为零。\n- 任务是：\n    1.  推导解析位移场 $u(x)$。\n    2.  使用单个双节点线性单元推导有限元位移场 $u_h(x)$。\n    3.  使用相对能量范数 $\\eta = \\frac{||u-u_h||_E}{||u||_E}$ 来量化离散误差。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学性：** 该问题是固体力学和计算方法中的一个标准练习。它基于杆的轴向平衡、线性弹性（Hooke's Law）和有限元法（FEM）的基本原理。所有概念在计算岩土力学和工程领域都已牢固建立。\n- **适定性：** 该问题是一个二阶常微分方程，带有一个本质（Dirichlet）边界条件 $u(0)=0$ 和一个自然（Neumann）边界条件（$x=L$ 处力为零）。这种组合确保了存在唯一且稳定的解。\n- **客观性：** 问题陈述精确、定量，没有主观或模糊的语言。所有参数（$L, A, E, b$）都已明确定义。\n\n### 第3步：结论与行动\n该问题具有科学性、适定性、客观性和完整性。因此，它被判定为**有效**。将提供完整解答。\n\n### 解析解推导\n受体力作用的一维杆的轴向平衡控制方程由微分单元上的力平衡导出。用轴向应力 $\\sigma_{xx}$ 和单位体积体力 $b$ 表示的平衡方程为：\n$$ \\frac{d\\sigma_{xx}}{dx} + b = 0 $$\n对于线性弹性，本构关系（Hooke's Law）为：\n$$ \\sigma_{xx} = E \\epsilon_{xx} $$\n其中 $E$ 是杨氏模量，$\\epsilon_{xx}$ 是轴向应变。小应变下的应变-位移关系为：\n$$ \\epsilon_{xx} = \\frac{du}{dx} $$\n其中 $u(x)$ 是轴向位移场。\n将应变-位移关系和本构关系代入平衡方程，得到位移场 $u(x)$ 的控制微分方程：\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + b = 0 $$\n由于对于均匀杆，$E$ 是常数，方程简化为：\n$$ E \\frac{d^2u}{dx^2} = -b $$\n对 $x$ 积分一次得到：\n$$ E \\frac{du}{dx} = -bx + C_1 $$\n其中 $C_1$ 是一个积分常数。再次积分得到：\n$$ E u(x) = -\\frac{bx^2}{2} + C_1x + C_2 $$\n其中 $C_2$ 是第二个积分常数。这些常数通过应用边界条件来确定。\n\n1.  **$x=0$ 处为固定端**：$u(0) = 0$。\n    $$ E u(0) = -\\frac{b(0)^2}{2} + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n2.  **$x=L$ 处为无牵引力端**：轴向力 $N(x) = A\\sigma_{xx}(x)$ 在 $x=L$ 处必须为零。\n    $$ N(x) = A\\sigma_{xx} = A E \\frac{du}{dx} $$\n    使用第一次积分的结果：\n    $$ N(x) = A(-bx + C_1) $$\n    应用边界条件 $N(L)=0$：\n    $$ N(L) = A(-bL + C_1) = 0 \\implies C_1 = bL $$\n将 $C_1$ 和 $C_2$ 的值代回 $u(x)$ 的表达式，我们得到精确的解析解：\n$$ E u(x) = -\\frac{bx^2}{2} + bLx $$\n$$ u(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) $$\n\n### 有限元解推导\n我们使用一个覆盖域 $[0,L]$ 的双节点线性单元来模拟该杆。节点位于 $x_1=0$ 和 $x_2=L$。位移场 $u_h(x)$ 由节点位移 $d_1$ 和 $d_2$ 以及线性形函数 $N_1(x)$ 和 $N_2(x)$ 插值得到：\n$$ u_h(x) = N_1(x)d_1 + N_2(x)d_2 $$\n形函数为：\n$$ N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L} $$\n单元刚度矩阵 $\\mathbf{k}$ 和一致体力向量 $\\mathbf{f}_b$ 由下式给出：\n$$ \\mathbf{k} = \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n$$ \\mathbf{f}_b = \\int_{V} \\mathbf{N}^T b \\, dV = \\int_0^L A \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} b \\, dx = Ab \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx $$\n$$ \\mathbf{f}_b = Ab \\left[ \\begin{matrix} x - \\frac{x^2}{2L} \\\\ \\frac{x^2}{2L} \\end{matrix} \\right]_0^L = Ab \\begin{pmatrix} L - L/2 \\\\ L/2 \\end{pmatrix} = \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n有限元方程组为 $\\mathbf{k}\\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{f} = \\mathbf{f}_{ext} + \\mathbf{f}_b$。外部节点荷载向量为 $\\mathbf{f}_{ext} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix}$，其中 $R_1$ 是固定节点1处的反作用力，由于无牵引力边界条件，节点2处的力为零。\n该方程组为：\n$$ \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix} + \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n应用本质边界条件 $u(0)=0 \\implies d_1=0$。我们可以使用该方程组的第二个方程来求解未知位移 $d_2$：\n$$ \\frac{AE}{L} (-d_1 + d_2) = 0 + \\frac{AbL}{2} $$\n$$ \\frac{AE}{L} (0 + d_2) = \\frac{AbL}{2} \\implies d_2 = \\frac{AbL}{2} \\frac{L}{AE} = \\frac{bL^2}{2E} $$\n因此，有限元位移场为：\n$$ u_h(x) = N_1(x)(0) + N_2(x)d_2 = \\frac{x}{L} \\left( \\frac{bL^2}{2E} \\right) = \\frac{bL}{2E}x $$\n\n### 误差量化\n离散误差场为 $e(x) = u(x) - u_h(x)$：\n$$ e(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) - \\frac{bL}{2E}x = \\frac{b}{E} \\left( \\frac{Lx}{2} - \\frac{x^2}{2} \\right) = \\frac{b}{2E}(Lx - x^2) $$\n位移场 $v(x)$ 的能量范数定义为 $||v||_E = \\sqrt{\\int_0^L AE \\left(\\frac{dv}{dx}\\right)^2 dx}$。我们需要计算相对误差 $\\eta = \\frac{||e||_E}{||u||_E}$。我们首先计算范数的平方。\n\n精确解 $u(x)$ 的能量范数：\n$$ \\frac{du}{dx} = \\frac{b}{E}(L-x) $$\n$$ ||u||_E^2 = \\int_0^L AE \\left( \\frac{b}{E}(L-x) \\right)^2 dx = \\frac{Ab^2}{E} \\int_0^L (L-x)^2 dx $$\n$$ ||u||_E^2 = \\frac{Ab^2}{E} \\left[ -\\frac{(L-x)^3}{3} \\right]_0^L = \\frac{Ab^2}{E} \\left( 0 - \\left(-\\frac{L^3}{3}\\right) \\right) = \\frac{Ab^2L^3}{3E} $$\n\n误差场 $e(x)$ 的能量范数：\n$$ \\frac{de}{dx} = \\frac{b}{2E}(L-2x) $$\n$$ ||e||_E^2 = \\int_0^L AE \\left( \\frac{b}{2E}(L-2x) \\right)^2 dx = \\frac{Ab^2}{4E} \\int_0^L (L-2x)^2 dx $$\n$$ ||e||_E^2 = \\frac{Ab^2}{4E} \\left[ -\\frac{(L-2x)^3}{6} \\right]_0^L = \\frac{Ab^2}{4E} \\left( -\\frac{(-L)^3}{6} - \\left(-\\frac{L^3}{6}\\right) \\right) = \\frac{Ab^2}{4E} \\left( \\frac{L^3}{6} + \\frac{L^3}{6} \\right) = \\frac{Ab^2}{4E} \\frac{L^3}{3} = \\frac{Ab^2L^3}{12E} $$\n\n能量范数中的相对误差是两个范数之比：\n$$ \\eta = \\frac{||e||_E}{||u||_E} = \\sqrt{\\frac{||e||_E^2}{||u||_E^2}} = \\sqrt{\\frac{Ab^2L^3/(12E)}{Ab^2L^3/(3E)}} = \\sqrt{\\frac{1/12}{1/3}} = \\sqrt{\\frac{3}{12}} = \\sqrt{\\frac{1}{4}} $$\n$$ \\eta = \\frac{1}{2} $$\n相对误差的精确值为 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3498577"}, {"introduction": "在认识到有限元法存在近似误差后，我们如何确保自己编写的有限元程序是正确的？分片检验 (Patch Test) 是任何有限元实现中最基本且必要的正确性验证手段。这个动手编程练习 [@problem_id:3498516] 将向你展示如何验证标准的线性杆单元能够精确地再现一个常数应变场，无论网格如何划分。通过此检验是保证单元具有收敛性的前提，它能增强我们对单元公式和组装过程正确性的信心。", "problem": "考虑在小应变和小位移设定下的一维线性弹性杆。设杆占据区间 $x \\in [0,L]$，具有恒定的杨氏模量 $E$ 和恒定的横截面积 $A$。不存在体力。两端的位移场被指定为 $u(0) = \\alpha$ 和 $u(L) = \\alpha + \\beta L$，这强制在整个杆上产生精确的线性位移场 $u(x) = \\alpha + \\beta x$ 和恒定应变 $\\epsilon(x) = \\beta$。使用有限元法（FEM），您将推导并实现一个两节点线性杆单元的刚度，并为任意网格划分组装全局刚度矩阵。然后，您将通过施加给定的端部位移进行分片检验，并验证组装后的解对于任意网格划分都能重现精确的恒定应变场。\n\n使用的基本原理：\n- 运动学：一维小应变 $\\epsilon(x) = \\dfrac{du}{dx}$。\n- 本构律（胡克定律）：$\\sigma(x) = E \\, \\epsilon(x)$，其中 $\\sigma$ 是轴向应力。\n- 虚功原理 (PVW)：$\\displaystyle \\int_{0}^{L} \\sigma \\, \\delta \\epsilon \\, A \\, dx = \\int_{0}^{L} b \\, \\delta u \\, A \\, dx + \\left. t \\, \\delta u \\right|_{\\partial \\Omega_t}$，在本问题中，由于是纯本质边界条件，体力 $b=0$ 且无端部面力。\n\n任务：\n1. 从虚功原理以及上述运动学和本构关系出发，推导一个位于区间 $[x_i, x_{i+1}]$ 上的两节点线性杆单元的单元刚度矩阵。不要使用任何预先记忆的刚度公式；推导必须从虚功叙述开始，在单元内采用标准的两节点 $C^0$ 连续线性近似，并精确执行单元级积分。\n2. 为 $[0,L]$ 的任意划分（网格）组装全局刚度矩阵。施加本质边界条件 $u(0)=\\alpha$ 和 $u(L)=\\alpha+\\beta L$ 并求解内部节点位移。\n3. 对下面的每个测试用例，计算以下无量纲误差度量：\n   - 无穷范数下的最大相对节点位移误差：$\\displaystyle e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}$，其中 $u_h$ 是有限元解，$\\{x_j\\}$ 是节点坐标。\n   - 相对 $\\ell^2$ 位移误差：$\\displaystyle e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}}$。\n   - 最大相对单元应变误差：$\\displaystyle e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}$，其中 $\\epsilon_h^{(e)}$ 是在单元 $e$ 上计算的恒定应变，等于节点位移之差除以单元长度，而 $\\beta$ 是精确的恒定应变。\n所有三个误差都是无量纲的。您的输出中不应出现任何物理单位。\n\n测试套件：\n为以下四个测试用例提供结果。在每个用例中，$E$ 的单位是 $\\mathrm{Pa}$，$A$ 的单位是 $\\mathrm{m}^2$，$L$ 的单位是 $\\mathrm{m}$，$\\alpha$ 的单位是 $\\mathrm{m}$，$\\beta$ 的单位是 $\\mathrm{m}^{-1}$。网格由一个包含 $0$ 和 $L$ 的有序节点坐标列表给出。\n\n- 测试用例 1（常规不规则划分）：\n  - $L = 3.7$, $E = 2.1 \\times 10^{11}$, $A = 4.0 \\times 10^{-3}$, $\\alpha = 1.2 \\times 10^{-3}$, $\\beta = -8.5 \\times 10^{-4}$。\n  - 节点：$[0.0,\\, 0.3,\\, 1.1,\\, 2.5,\\, 3.7]$。\n\n- 测试用例 2（单单元划分）：\n  - $L = 5.0$, $E = 3.5 \\times 10^{10}$, $A = 2.5 \\times 10^{-2}$, $\\alpha = -3.0 \\times 10^{-3}$, $\\beta = 2.0 \\times 10^{-4}$。\n  - 节点：$[0.0,\\, 5.0]$。\n\n- 测试用例 3（在左端附近有非常小单元的高度倾斜划分）：\n  - $L = 1.0$, $E = 7.0 \\times 10^{10}$, $A = 1.0 \\times 10^{-2}$, $\\alpha = 0.5 \\times 10^{-3}$, $\\beta = 3.0 \\times 10^{-3}$。\n  - 节点：$[0.0,\\, 10^{-6},\\, 10^{-3},\\, 10^{-2},\\, 10^{-1},\\, 0.5,\\, 1.0]$。\n\n- 测试用例 4（具有许多单元的渐变网格）：\n  - $L = 2.0$, $E = 1.0 \\times 10^{11}$, $A = 5.0 \\times 10^{-3}$, $\\alpha = 2.5 \\times 10^{-4}$, $\\beta = -1.25 \\times 10^{-3}$。\n  - 节点：$x_i = L \\left( \\dfrac{i}{N} \\right)^2$，对于 $i=0,1,\\dots,N$ 且 $N=50$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个以逗号分隔的列表的列表，每个内部列表对应于上述顺序的一个测试用例，并包含三个误差 $[e_{u,\\infty}^{\\mathrm{rel}},\\, e_{u,2}^{\\mathrm{rel}},\\, e_{\\epsilon,\\infty}^{\\mathrm{rel}}]$。例如：$[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],[r_{3,1},r_{3,2},r_{3,3}],[r_{4,1},r_{4,2},r_{4,3}]]$。这些数字必须是无量纲的（不报告任何物理单位）。", "solution": "该问题被评估为有效。它在科学上基于线弹性静力学和有限元法的原理，作为一个狄利克雷边界值问题是适定的，表述客观且无歧义，并包含了推导表达式和计算所需数值结果的所有必要信息。该任务构成了计算力学中的一个基本验证程序——分片检验。\n\n### 1. 单元刚度矩阵的推导\n\n推导始于一维杆的虚功原理 (PVW)。鉴于没有体力 ($b=0$) 和边界上没有外部面力（因为边界条件纯粹是狄利克雷类型），虚功原理简化为其齐次形式，即对于任何运动学上容许的虚位移，内虚功为零：\n$$\n\\int_{0}^{L} \\delta W_{int} \\, dx = \\int_{0}^{L} \\sigma(x) \\, \\delta \\epsilon(x) \\, A \\, dx = 0\n$$\n其中 $\\sigma$ 是轴向应力，$\\epsilon$ 是轴向应变，$\\delta\\epsilon$ 是虚轴向应变，$A$ 是横截面积。\n\n整个域 $[0,L]$ 上的积分可以分解为有限元网格中每个单元上的积分之和。对于单个单元 $e$，占据域 $[x_i, x_{i+1}]$，长度为 $L_e = x_{i+1} - x_i$，其对虚功原理的贡献为：\n$$\n\\int_{x_i}^{x_{i+1}} \\sigma^{(e)}(x) \\, \\delta \\epsilon^{(e)}(x) \\, A \\, dx = 0\n$$\n\n我们引入该单元内位移场 $u(x)$ 的有限元近似。对于一个两节点线性杆单元，位移 $u_h^{(e)}(x)$ 是通过线性形函数从节点位移 $d_1^{(e)} = u_h(x_i)$ 和 $d_2^{(e)} = u_h(x_{i+1})$ 插值得到。我们定义一个局部坐标 $\\xi \\in [0,1]$，使得 $x = x_i + \\xi L_e$。线性形函数为：\n$$\nN_1(\\xi) = 1 - \\xi \\quad \\text{和} \\quad N_2(\\xi) = \\xi\n$$\n近似位移场于是可以写成矩阵形式：\n$$\nu_h^{(e)}(x(\\xi)) = N_1(\\xi)d_1^{(e)} + N_2(\\xi)d_2^{(e)} = \\mathbf{N}(\\xi) \\mathbf{d}^{(e)}\n$$\n其中 $\\mathbf{N}(\\xi) = [N_1(\\xi), N_2(\\xi)]$ 是形函数向量，$\\mathbf{d}^{(e)} = [d_1^{(e)}, d_2^{(e)}]^T$ 是单元节点位移向量。\n\n应变是位移的空间导数，$\\epsilon(x) = du/dx$。使用链式法则，我们将对 $x$ 的导数与对 $\\xi$ 的导数联系起来：\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{L_e}\\frac{d}{d\\xi}\n$$\n单元内的应变 $\\epsilon_h^{(e)}$ 于是为：\n$$\n\\epsilon_h^{(e)} = \\frac{du_h^{(e)}}{dx} = \\frac{1}{L_e} \\frac{d\\mathbf{N}(\\xi)}{d\\xi} \\mathbf{d}^{(e)}\n$$\n形函数的导数为 $\\frac{dN_1}{d\\xi} = -1$ 和 $\\frac{dN_2}{d\\xi} = 1$。这导出了应变-位移矩阵 $\\mathbf{B}$：\n$$\n\\epsilon_h^{(e)} = \\frac{1}{L_e}[-1, 1]\\mathbf{d}^{(e)} = \\mathbf{B}\\mathbf{d}^{(e)}\n$$\n注意，对于线性单元，$\\mathbf{B}$ 矩阵在单元内是常数，导致一个恒定的应变场。虚应变 $\\delta\\epsilon_h^{(e)}$ 通过同样的关系与虚节点位移 $\\delta\\mathbf{d}^{(e)}$ 相关联：\n$$\n\\delta\\epsilon_h^{(e)} = \\mathbf{B}\\delta\\mathbf{d}^{(e)}\n$$\n线弹性的本构关系（胡克定律）是 $\\sigma(x) = E \\epsilon(x)$。在单元背景下，这表示为 $\\sigma_h^{(e)} = E \\epsilon_h^{(e)} = E \\mathbf{B} \\mathbf{d}^{(e)}$，其中 $E$ 是恒定的杨氏模量。\n\n将这些表达式代入单元的虚功方程：\n$$\n\\int_{x_i}^{x_{i+1}} \\left( E \\mathbf{B} \\mathbf{d}^{(e)} \\right)^T \\left( \\mathbf{B} \\delta\\mathbf{d}^{(e)} \\right) A \\, dx = 0\n$$\n由于这些项是标量，应力项上的转置可以移动。我们可以重新排列表达式，注意到节点位移不是 $x$ 的函数：\n$$\n(\\delta\\mathbf{d}^{(e)})^T \\left( \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx \\right) \\mathbf{d}^{(e)} = 0\n$$\n由于这必须对任意虚位移 $\\delta\\mathbf{d}^{(e)}$ 成立，括号中的项必须为零。该项表示单元的力-位移关系，$\\mathbf{k}^{(e)}\\mathbf{d}^{(e)} = \\mathbf{f}^{(e)}$，其中 $\\mathbf{k}^{(e)}$ 是单元刚度矩阵。\n$$\n\\mathbf{k}^{(e)} = \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx\n$$\n由于 $E$，$A$ 和 $\\mathbf{B}$ 矩阵在单元内是常数，它们可以从积分中提出：\n$$\n\\mathbf{k}^{(e)} = \\mathbf{B}^T E A \\mathbf{B} \\int_{x_i}^{x_{i+1}} dx = (\\mathbf{B}^T E A \\mathbf{B}) L_e\n$$\n代入 $\\mathbf{B}$ 的表达式：\n$$\n\\mathbf{k}^{(e)} = \\left( \\left(\\frac{1}{L_e}\\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix}\\right) E A \\left(\\frac{1}{L_e}[-1, 1]\\right) \\right) L_e = \\frac{EA}{L_e^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} L_e\n$$\n这简化为著名的两节点线弹性杆单元的刚度矩阵：\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e}\n\\begin{bmatrix}\n1  -1 \\\\\n-1  1\n\\end{bmatrix}\n$$\n\n### 2. 全局组装与求解\n\n对于一个有 $N_{nodes}$ 个节点的网格，全局刚度矩阵 $\\mathbf{K}$ 是一个 $N_{nodes} \\times N_{nodes}$ 的矩阵，初始时填充为零。全局方程组是 $\\mathbf{K} \\mathbf{U} = \\mathbf{F}$，其中 $\\mathbf{U}$ 是全局节点位移向量，$\\mathbf{F}$ 是外部节点力向量（在本问题中为零）。\n\n矩阵 $\\mathbf{K}$ 是通过遍历连接全局节点 $i$ 和 $j$ 的每个单元 $e$，并将单元刚度矩阵 $\\mathbf{k}^{(e)}$ 的各项加到 $\\mathbf{K}$ 中相应的位置来组装的。对于连接节点 $i$ 和 $i+1$ 的单元，组装规则是：\n$$\nK_{i,i} \\leftarrow K_{i,i} + k^{(e)}_{11} \\quad \\quad K_{i,i+1} \\leftarrow K_{i,i+1} + k^{(e)}_{12} \\\\\nK_{i+1,i} \\leftarrow K_{i+1,i} + k^{(e)}_{21} \\quad \\quad K_{i+1,i+1} \\leftarrow K_{i+1,i+1} + k^{(e)}_{22}\n$$\n本质边界条件是 $u(0) = \\alpha$ 和 $u(L) = \\alpha + \\beta L$。这些条件施加在全局系统的第一个和最后一个节点上。全局系统被划分为未知（内部）和指定（边界）自由度 (DOF)，分别用下标 $u$ 和 $p$ 表示：\n$$\n\\begin{bmatrix}\n\\mathbf{K}_{uu}  \\mathbf{K}_{up} \\\\\n\\mathbf{K}_{pu}  \\mathbf{K}_{pp}\n\\end{bmatrix}\n\\begin{Bmatrix}\n\\mathbf{U}_u \\\\\n\\mathbf{U}_p\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\mathbf{F}_u \\\\\n\\mathbf{F}_p\n\\end{Bmatrix}\n$$\n这里，$\\mathbf{U}_u$ 是未知内部节点位移向量，$\\mathbf{U}_p = [\\alpha, \\alpha + \\beta L]^T$ 是已知边界位移向量。由于 $\\mathbf{F}_u = \\mathbf{0}$，未知自由度的系统为：\n$$\n\\mathbf{K}_{uu} \\mathbf{U}_u + \\mathbf{K}_{up} \\mathbf{U}_p = \\mathbf{0} \\implies \\mathbf{K}_{uu} \\mathbf{U}_u = - \\mathbf{K}_{up} \\mathbf{U}_p\n$$\n这个线性系统被求解以得到 $\\mathbf{U}_u$。然后通过组合求解出的内部位移 $\\mathbf{U}_u$ 和指定的边界位移 $\\mathbf{U}_p$ 来构建完整的有限元解向量 $u_h$。\n\n### 3. 误差度量与分片检验验证\n\n分片检验验证有限元实现是否能精确地重现常数或线性解场。对于本问题，精确解是线性位移场 $u(x) = \\alpha + \\beta x$ 和恒定应变场 $\\epsilon(x) = \\beta$。由于两节点单元使用线性插值，它可以精确地表示此解。因此，无论网格布局如何，有限元解 $u_h$ 都应在所有节点上与精确解 $u(x)$ 匹配到机器精度之内。\n\n计算以下无量纲误差度量以验证这一点：\n1.  最大相对节点位移误差：该度量测量在任何节点上的最大偏差，相对于最大的精确节点位移。\n    $$\n    e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}\n    $$\n2.  相对 $\\ell^2$ 位移误差：该度量以均方根的方式测量节点位移的总体误差。\n    $$\n    e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}} = \\frac{\\| \\mathbf{U}_h - \\mathbf{U}_{exact} \\|_2}{\\| \\mathbf{U}_{exact} \\|_2}\n    $$\n3.  最大相对单元应变误差：该度量测量单元级恒定应变与精确恒定应变 $\\beta$ 的最大偏差。\n    $$\n    e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}\n    $$\n    其中，对于连接节点 $j$ 和 $j+1$ 的单元，$\\epsilon_h^{(e)} = (u_h(x_{j+1}) - u_h(x_j))/(x_{j+1} - x_j)$。\n\n对于所有测试用例，由于必须通过分片检验，所有三个误差度量预计都为零或一个非常小的数，量级为机器浮点精度（例如，约 $10^{-14}$ 或更小）。", "answer": "```python\nimport numpy as np\n\ndef run_fem_patch_test(L, E, A, alpha, beta, nodes):\n    \"\"\"\n    Performs a 1D bar patch test for a given set of parameters and mesh.\n\n    Args:\n        L (float): Length of the bar.\n        E (float): Young's modulus.\n        A (float): Cross-sectional area.\n        alpha (float): Displacement constant u(x) = alpha + beta*x.\n        beta (float): Strain.\n        nodes (np.ndarray): Array of nodal coordinates.\n\n    Returns:\n        list: A list containing the three error metrics\n              [e_u_inf_rel, e_u_2_rel, e_eps_inf_rel].\n    \"\"\"\n    nodes = np.array(nodes, dtype=float)\n    n_nodes = len(nodes)\n    n_elements = n_nodes - 1\n\n    # If there is only one element (two nodes), the solution is trivial.\n    if n_nodes == 2:\n        u_h = np.array([alpha, alpha + beta * L])\n    else:\n        # Assemble global stiffness matrix K\n        K = np.zeros((n_nodes, n_nodes))\n        for i in range(n_elements):\n            node1_idx, node2_idx = i, i + 1\n            L_e = nodes[node2_idx] - nodes[node1_idx]\n            \n            if L_e == 0:\n                raise ValueError(\"Element length must be positive.\")\n\n            k_multiplier = E * A / L_e\n            k_e = k_multiplier * np.array([[1, -1], [-1, 1]])\n\n            # Add element stiffness to global matrix\n            K[node1_idx, node1_idx] += k_e[0, 0]\n            K[node1_idx, node2_idx] += k_e[0, 1]\n            K[node2_idx, node1_idx] += k_e[1, 0]\n            K[node2_idx, node2_idx] += k_e[1, 1]\n\n        # Apply boundary conditions by partitioning\n        # Unknown DOFs are at indices 1 to n_nodes-2\n        # Prescribed DOFs are at indices 0 and n_nodes-1\n        K_uu = K[1:-1, 1:-1]\n        K_up = K[1:-1, [0, n_nodes - 1]]\n        \n        # Prescribed displacements\n        u_p = np.array([alpha, alpha + beta * L])\n        \n        # Right-hand side vector for the reduced system\n        F_u_eff = -K_up @ u_p\n        \n        # Solve for interior displacements\n        u_u = np.linalg.solve(K_uu, F_u_eff)\n        \n        # Reconstruct the full displacement vector\n        u_h = np.concatenate(([u_p[0]], u_u, [u_p[1]]))\n\n    # --- Error Calculation ---\n    \n    # Exact solution at nodes\n    u_exact = alpha + beta * nodes\n    \n    # 1. Maximum relative nodal displacement error\n    err_abs_u_inf = np.max(np.abs(u_h - u_exact))\n    norm_u_exact_inf = np.max(np.abs(u_exact))\n    e_u_inf_rel = err_abs_u_inf / norm_u_exact_inf if norm_u_exact_inf > 0 else err_abs_u_inf\n\n    # 2. Relative l2 displacement error\n    norm_err_u_2 = np.linalg.norm(u_h - u_exact)\n    norm_u_exact_2 = np.linalg.norm(u_exact)\n    e_u_2_rel = norm_err_u_2 / norm_u_exact_2 if norm_u_exact_2 > 0 else norm_err_u_2\n    \n    # 3. Maximum relative element strain error\n    eps_h = np.zeros(n_elements)\n    for i in range(n_elements):\n        L_e = nodes[i+1] - nodes[i]\n        eps_h[i] = (u_h[i+1] - u_h[i]) / L_e\n        \n    err_abs_eps_inf = np.max(np.abs(eps_h - beta))\n    norm_beta = np.abs(beta)\n    e_eps_inf_rel = err_abs_eps_inf / norm_beta if norm_beta > 0 else err_abs_eps_inf\n\n    return [e_u_inf_rel, e_u_2_rel, e_eps_inf_rel]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test case 1\n    tc1 = {\n        'L': 3.7, 'E': 2.1e11, 'A': 4.0e-3, 'alpha': 1.2e-3, 'beta': -8.5e-4,\n        'nodes': [0.0, 0.3, 1.1, 2.5, 3.7]\n    }\n\n    # Test case 2\n    tc2 = {\n        'L': 5.0, 'E': 3.5e10, 'A': 2.5e-2, 'alpha': -3.0e-3, 'beta': 2.0e-4,\n        'nodes': [0.0, 5.0]\n    }\n\n    # Test case 3\n    tc3 = {\n        'L': 1.0, 'E': 7.0e10, 'A': 1.0e-2, 'alpha': 0.5e-3, 'beta': 3.0e-3,\n        'nodes': [0.0, 1e-6, 1e-3, 1e-2, 1e-1, 0.5, 1.0]\n    }\n    \n    # Test case 4\n    N4 = 50\n    L4 = 2.0\n    nodes4 = [L4 * (i / N4)**2 for i in range(N4 + 1)]\n    tc4 = {\n        'L': 2.0, 'E': 1.0e11, 'A': 5.0e-3, 'alpha': 2.5e-4, 'beta': -1.25e-3,\n        'nodes': nodes4\n    }\n\n    test_cases = [tc1, tc2, tc3, tc4]\n    \n    results = []\n    for case in test_cases:\n        errors = run_fem_patch_test(\n            L=case['L'], \n            E=case['E'], \n            A=case['A'], \n            alpha=case['alpha'], \n            beta=case['beta'], \n            nodes=case['nodes']\n        )\n        results.append(errors)\n\n    # Format the output as specified: [[r1,r2,r3],[...],...]\n    formatted_results = '],['.join([','.join(map(str, res)) for res in results])\n    print(f\"[[{formatted_results}]]\")\n\nsolve()\n```", "id": "3498516"}, {"introduction": "实际工程问题往往涉及复杂的几何形状和变化的材料属性，这超出了简单线性单元的能力范围。对于这些更复杂的单元，例如本练习 [@problem_id:3498547] 中考虑的具有线性变化截面的二次杆单元，其刚度矩阵的积分通常难以解析求解。本练习旨在引导你探索高斯求积 (Gauss quadrature) 这一强大的数值积分技术，并量化因采用不精确的积分方案所引入的误差。", "problem": "考虑一个用于小应变线性弹性的有限元法（FEM）中的三节点等参二次一维杆单元。该杆的长度为 $L$，节点坐标为 $x_{1}=0$、$x_{2}=L/2$ 和 $x_{3}=L$。横截面积沿杆长线性变化，其表达式为 $A(x)=A_{1}+\\left(\\frac{A_{2}-A_{1}}{L}\\right)x$，杨氏模量 $E$ 为常数。局部等参坐标为 $\\xi \\in [-1,1]$，标准的二次拉格朗日形函数为 $N_{1}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi-1)$、$N_{2}(\\xi)=1-\\xi^{2}$、$N_{3}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi+1)$，几何映射为 $x(\\xi)=\\sum_{i=1}^{3}N_{i}(\\xi)\\,x_{i}$。\n\n从基本原理和核心定义出发，使用小应变线性弹性本构关系 $\\sigma=E\\,\\varepsilon$、运动学关系 $\\varepsilon=\\frac{du}{dx}$ 以及虚功原理，推导出单元刚度矩阵项作为杆上积分的表达式。然后，执行精确积分和近似积分，以比较单点和两点高斯积分。\n\n给定参数为 $L=3\\ \\mathrm{m}$，$E=50\\times 10^{9}\\ \\mathrm{Pa}$，$A_{1}=0.01\\ \\mathrm{m}^{2}$，$A_{2}=0.025\\ \\mathrm{m}^{2}$。\n\n任务：\n1. 从虚功原理出发，推导单元刚度矩阵项 $K_{ij}$ 在物理坐标 $x$ 上的积分表达式，然后使用等参映射将其变换到局部坐标 $\\xi$。您的推导必须从弱形式和上述定义开始，不得引用预先推导好的单元矩阵。\n2. 通过对给定 $A(x)$ 和二次形函数的积分进行解析计算，求得精确的单元刚度矩阵。将最终的数值矩阵项以 $\\mathrm{N}/\\mathrm{m}$ 为单位表示。\n3. 使用区间 $[-1,1]$ 上的标准法则，计算单元刚度矩阵的单点高斯积分近似和两点高斯积分近似：对于单点积分，节点为 $\\xi_{1}=0$，权重为 $w_{1}=2$；对于两点积分，节点为 $\\xi_{1,2}=\\pm 1/\\sqrt{3}$，权重为 $w_{1,2}=1$。将得到的数值矩阵以 $\\mathrm{N}/\\mathrm{m}$ 为单位表示。\n4. 将 $n$ 点积分法则的相对积分误差定义为 $\\varepsilon_{n}=\\frac{\\|K^{(n)}-K\\|_{F}}{\\|K\\|_{F}}$，其中 $\\|\\,\\cdot\\,\\|_{F}$ 是弗罗贝尼乌斯范数，$K$ 是精确刚度矩阵，$K^{(n)}$ 是 $n$ 点高斯积分近似。计算 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$。\n\n将最终的误差值 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$ 四舍五入到六位有效数字，并以小数形式表示。最终答案必须使用 LaTeX 的 pmatrix 环境，以一个双元素行矩阵的形式报告，矩阵内不含单位。", "solution": "该问题要求推导和计算一个具有可变横截面的三节点二次杆单元的刚度矩阵，然后比较不同的数值积分方案。\n\n**任务1：单元刚度矩阵的推导**\n\n推导始于虚功原理。对于承受轴向载荷的一维物体，其内虚功 $\\delta W_{\\text{int}}$ 由虚应变能密度在体积 $V$ 上的积分给出。\n$$ \\delta W_{\\text{int}} = \\int_{V} \\delta\\varepsilon^{T} \\sigma \\, dV $$\n这里，$\\sigma$ 是轴向应力，$\\delta\\varepsilon$ 是虚轴向应变。对于杆单元，体积积分可以表示为沿长度 $L$ 的积分：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon \\sigma A(x) \\, dx $$\n其中 $A(x)$ 是位置 $x$ 处的横截面积。\n\n线性弹性的本构关系为 $\\sigma = E \\varepsilon$，其中 $E$ 是杨氏模量。将此代入虚功表达式，得到：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon E \\varepsilon A(x) \\, dx $$\n\n在有限元框架内，位移场 $u(x)$ 使用形函数 $N_i(x)$ 和节点位移 $d_i$ 进行近似：\n$$ u(x) = \\sum_{j=1}^{3} N_j(x) d_j = \\mathbf{N}(x) \\mathbf{d} $$\n轴向应变 $\\varepsilon$ 是位移的空间导数：\n$$ \\varepsilon = \\frac{du}{dx} = \\sum_{j=1}^{3} \\frac{dN_j}{dx} d_j = \\mathbf{B}(x) \\mathbf{d} $$\n其中 $\\mathbf{B}(x) = \\left[ \\begin{matrix} \\frac{dN_1}{dx}  \\frac{dN_2}{dx}  \\frac{dN_3}{dx} \\end{matrix} \\right]$ 是应变-位移矩阵。\n类似地，虚位移和虚应变由下式给出：\n$$ \\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{d} \\quad \\text{和} \\quad \\delta\\varepsilon = \\mathbf{B}(x) \\delta\\mathbf{d} $$\n将离散形式的 $\\varepsilon$ 和 $\\delta\\varepsilon$ 代入内虚功方程：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} (\\delta\\mathbf{d}^{T} \\mathbf{B}(x)^{T}) E (\\mathbf{B}(x) \\mathbf{d}) A(x) \\, dx $$\n$$ \\delta W_{\\text{int}} = \\delta\\mathbf{d}^{T} \\left( \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx \\right) \\mathbf{d} $$\n根据定义，$\\delta W_{\\text{int}} = \\delta\\mathbf{d}^T \\mathbf{K} \\mathbf{d}$，其中 $\\mathbf{K}$ 是单元刚度矩阵。因此：\n$$ \\mathbf{K} = \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx $$\n刚度矩阵的项为 $K_{ij} = \\int_{0}^{L} E A(x) \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$。\n\n对于等参单元，物理坐标 $x$ 通过与位移场相同的形函数从局部坐标 $\\xi \\in [-1,1]$ 映射而来：\n$$ x(\\xi) = \\sum_{k=1}^{3} N_k(\\xi) x_k $$\n形函数对 $x$ 的导数通过链式法则求得：$\\frac{dN_i}{dx} = \\frac{dN_i}{d\\xi} \\frac{d\\xi}{dx}$。项 $\\frac{dx}{d\\xi}$ 是变换的雅可比 $J$。\n$$ J = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\sum_{k=1}^{3} N_k(\\xi) x_k \\right) = \\sum_{k=1}^{3} \\frac{dN_k}{d\\xi} x_k $$\n微分长度元为 $dx = J d\\xi$。刚度矩阵积分变换到局部坐标系：\n$$ K_{ij} = \\int_{-1}^{1} E A(x(\\xi)) \\left( \\frac{1}{J} \\frac{dN_i}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{dN_j}{d\\xi} \\right) J \\, d\\xi = \\int_{-1}^{1} \\frac{E A(x(\\xi))}{J} \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} \\, d\\xi $$\n这完成了任务1所要求的推导。\n\n**任务2：精确单元刚度矩阵**\n\n首先，我们确定该问题的具体函数。给定的二次形函数为：\n$N_{1}(\\xi)=\\frac{1}{2}\\xi(\\xi-1)$、$N_{2}(\\xi)=1-\\xi^{2}$、$N_{3}(\\xi)=\\frac{1}{2}\\xi(\\xi+1)$。\n它们关于 $\\xi$ 的导数是：\n$$ \\frac{dN_1}{d\\xi} = \\xi - \\frac{1}{2}, \\quad \\frac{dN_2}{d\\xi} = -2\\xi, \\quad \\frac{dN_3}{d\\xi} = \\xi + \\frac{1}{2} $$\n节点坐标为 $x_1=0$、$x_2=L/2$ 和 $x_3=L$。雅可比 $J$ 为：\n$$ J = \\left(\\xi - \\frac{1}{2}\\right) (0) + (-2\\xi)\\left(\\frac{L}{2}\\right) + \\left(\\xi + \\frac{1}{2}\\right)(L) = -L\\xi + L\\xi + \\frac{L}{2} = \\frac{L}{2} $$\n由于中间节点位于几何中心，雅可比是一个常数。坐标映射为：\n$$ x(\\xi) = N_1(\\xi)(0) + N_2(\\xi)\\left(\\frac{L}{2}\\right) + N_3(\\xi)(L) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}(\\xi^2+\\xi)L = \\frac{L}{2}(1+\\xi) $$\n横截面积 $A(x) = A_1 + \\frac{A_2-A_1}{L}x$。代入 $x(\\xi)$：\n$$ A(x(\\xi)) = A_1 + \\frac{A_2-A_1}{L} \\frac{L}{2}(1+\\xi) = A_1 + \\frac{A_2-A_1}{2} + \\frac{A_2-A_1}{2}\\xi = \\frac{A_1+A_2}{2} + \\frac{A_2-A_1}{2}\\xi $$\n令 $A_c = \\frac{A_1+A_2}{2}$ 且 $\\Delta A = \\frac{A_2-A_1}{2}$。则 $A(x(\\xi)) = A_c + \\Delta A \\xi$。\n刚度矩阵的项为：\n$$ K_{ij} = \\int_{-1}^{1} \\frac{E (A_c + \\Delta A \\xi)}{L/2} \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi = \\frac{2E}{L} \\int_{-1}^{1} (A_c + \\Delta A \\xi) \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi $$\n项 $(\\frac{dN_i}{d\\xi})(\\frac{dN_j}{d\\xi})$ 是一个关于 $\\xi$ 的最高2次多项式。整个被积函数是一个最高3次的多项式。我们可以精确地积分它。令 $\\mathbf{B}_\\xi = [\\begin{matrix} \\xi-\\frac{1}{2}  -2\\xi  \\xi+\\frac{1}{2} \\end{matrix}]$。我们必须计算 $\\mathbf{K} = \\frac{2E}{L} \\int_{-1}^1 (A_c + \\Delta A \\xi) \\mathbf{B}_\\xi^T \\mathbf{B}_\\xi d\\xi$。\n该精确积分的结果得出以下矩阵：\n$$ \\mathbf{K} = \\frac{E}{3L} \\begin{pmatrix} 7A_c - 4\\Delta A  -8A_c + 4\\Delta A  A_c \\\\ -8A_c + 4\\Delta A  16A_c  -8A_c - 4\\Delta A \\\\ A_c  -8A_c - 4\\Delta A  7A_c + 4\\Delta A \\end{pmatrix} $$\n使用给定参数：$L=3\\,\\mathrm{m}$，$E=50 \\times 10^9\\,\\mathrm{Pa}$，$A_1=0.01\\,\\mathrm{m}^2$，$A_2=0.025\\,\\mathrm{m}^2$。\n$A_c = \\frac{0.01+0.025}{2} = 0.0175\\,\\mathrm{m}^2 = \\frac{7}{400}\\,\\mathrm{m}^2$。\n$\\Delta A = \\frac{0.025-0.01}{2} = 0.0075\\,\\mathrm{m}^2 = \\frac{3}{400}\\,\\mathrm{m}^2$。\n将这些值代入矩阵公式：\n$\\frac{E}{3L} = \\frac{50 \\times 10^9}{9}$。\n$7A_c-4\\Delta A = 7(\\frac{7}{400}) - 4(\\frac{3}{400}) = \\frac{37}{400}$。\n$-8A_c+4\\Delta A = -8(\\frac{7}{400}) + 4(\\frac{3}{400}) = -\\frac{44}{400}$。\n$A_c = \\frac{7}{400}$。\n$16A_c = 16(\\frac{7}{400}) = \\frac{112}{400}$。\n$-8A_c-4\\Delta A = -8(\\frac{7}{400})-4(\\frac{3}{400}) = -\\frac{68}{400}$。\n$7A_c+4\\Delta A = 7(\\frac{7}{400})+4(\\frac{3}{400}) = \\frac{61}{400}$。\n$$ \\mathbf{K} = \\frac{50 \\times 10^9}{9} \\frac{1}{400} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} = \\frac{1.25 \\times 10^8}{9} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} $$\n这可以写成 $\\mathbf{K} = \\frac{10^9}{72} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$。\n\n**任务3：近似单元刚度矩阵**\n\n$n$ 点高斯积分的通用公式为 $\\mathbf{K}^{(n)} = \\sum_{k=1}^{n} w_k \\left[ \\frac{E A(x(\\xi))}{J} \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=\\xi_k}$。\n\n**单点高斯积分 ($n=1$)**：\n法则：$\\xi_1 = 0$，$w_1=2$。\n$$ \\mathbf{K}^{(1)} = w_1 \\left[ \\frac{2E}{L} (A_c+\\Delta A\\xi) \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=0} $$\n在 $\\xi=0$ 处，我们有 $A(x(0)) = A_c$ 和 $\\mathbf{B}_\\xi(0) = [\\begin{matrix} -1/2  0  1/2 \\end{matrix}]$。\n$$ \\mathbf{K}^{(1)} = 2 \\cdot \\frac{2E A_c}{L} \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix} \\begin{pmatrix} -1/2  0  1/2 \\end{pmatrix} = \\frac{E A_c}{L} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\n代入数值：\n$\\frac{EA_c}{L} = \\frac{(50 \\times 10^9)(0.0175)}{3} = \\frac{7}{24} \\times 10^9$。\n$$ \\mathbf{K}^{(1)} = \\frac{7 \\times 10^9}{24} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} = \\frac{21 \\times 10^9}{72} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\n\n**两点高斯积分 ($n=2$)**：\n法则：$\\xi_{1,2} = \\pm 1/\\sqrt{3}$，$w_{1,2}=1$。\n$K_{ij}$ 的被积函数是关于 $\\xi$ 的3次多项式。两点高斯积分对于最高为 $2n-1 = 2(2)-1=3$ 次的多项式是精确的。因此，两点积分法则将精确计算该积分。\n$$ \\mathbf{K}^{(2)} = \\mathbf{K} $$\n\n**任务4：相对积分误差**\n\n相对误差定义为 $\\varepsilon_{n}=\\frac{\\|\\mathbf{K}^{(n)}-\\mathbf{K}\\|_{F}}{\\|\\mathbf{K}\\|_{F}}$，其中 $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数，$\\|\\mathbf{A}\\|_F = \\sqrt{\\sum_{i,j} |a_{ij}|^2}$。\n\n对于两点法则，由于 $\\mathbf{K}^{(2)} = \\mathbf{K}$，分子 $\\|\\mathbf{K}^{(2)}-\\mathbf{K}\\|_F = 0$。因此，\n$$ \\varepsilon_2 = 0 $$\n对于单点法则，我们计算误差 $\\varepsilon_1$。我们可以提出公因子 $C = \\frac{10^9}{72}$。\n令 $\\mathbf{M}_K = \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$ 且 $\\mathbf{M}_{K1} = \\begin{pmatrix} 21  0  -21 \\\\ 0  0  0 \\\\ -21  0  21 \\end{pmatrix}$。\n那么 $\\mathbf{K} = C \\mathbf{M}_K$ 且 $\\mathbf{K}^{(1)} = C \\mathbf{M}_{K1}$。\n误差为 $\\varepsilon_1 = \\frac{\\|C(\\mathbf{M}_{K1}-\\mathbf{M}_K)\\|_F}{\\|C\\mathbf{M}_K\\|_F} = \\frac{\\|\\mathbf{M}_{K1}-\\mathbf{M}_K\\|_F}{\\|\\mathbf{M}_K\\|_F}$。\n令 $\\Delta\\mathbf{M} = \\mathbf{M}_{K1}-\\mathbf{M}_K$：\n$$ \\Delta\\mathbf{M} = \\begin{pmatrix} 21-37  0-(-44)  -21-7 \\\\ 0-(-44)  0-112  0-(-68) \\\\ -21-7  0-(-68)  21-61 \\end{pmatrix} = \\begin{pmatrix} -16  44  -28 \\\\ 44  -112  68 \\\\ -28  68  -40 \\end{pmatrix} $$\n现在我们计算弗罗贝尼乌斯范数的平方：\n$$ \\|\\mathbf{M}_K\\|_F^2 = 37^2 + (-44)^2 + 7^2 + (-44)^2 + 112^2 + (-68)^2 + 7^2 + (-68)^2 + 61^2 $$\n$$ \\|\\mathbf{M}_K\\|_F^2 = 1369 + 1936 + 49 + 1936 + 12544 + 4624 + 49 + 4624 + 3721 = 30852 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = (-16)^2 + 44^2 + (-28)^2 + 44^2 + (-112)^2 + 68^2 + (-28)^2 + 68^2 + (-40)^2 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = 256 + 1936 + 784 + 1936 + 12544 + 4624 + 784 + 4624 + 1600 = 29088 $$\n相对误差 $\\varepsilon_1$ 是：\n$$ \\varepsilon_1 = \\sqrt{\\frac{\\|\\Delta\\mathbf{M}\\|_F^2}{\\|\\mathbf{M}_K\\|_F^2}} = \\sqrt{\\frac{29088}{30852}} \\approx \\sqrt{0.942823739} \\approx 0.970991136 $$\n四舍五入到六位有效数字，$\\varepsilon_1 = 0.970991$。\n最终的误差值为 $\\varepsilon_1 = 0.970991$ 和 $\\varepsilon_2 = 0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.970991  0\n\\end{pmatrix}\n}\n$$", "id": "3498547"}]}