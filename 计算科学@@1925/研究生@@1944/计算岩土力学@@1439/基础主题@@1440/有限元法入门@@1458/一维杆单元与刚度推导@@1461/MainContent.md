## 引言
[一维杆单元](@entry_id:171268)是有限元分析中最基本也最重要的构建模块，是理解更复杂的二维和三维单元的理论基石。尽管其形式简单，但它蕴含了从连续介质力学到离散代数系统的核心转化思想。本文旨在系统性地回答一个关键问题：我们如何将一个连续体的力学[平衡问题](@entry_id:636409)，严谨地转化为计算机可以求解的矩阵方程 $KU=F$？

为了全面解答这一问题，本文将引导读者完成一次从理论到实践的完整旅程。在“原理与机制”一章中，我们将从连续介质力学的第一性原理出发，推导控制方程的弱形式，并最终构建出[单元刚度矩阵](@entry_id:139369)。随后的“应用与[交叉](@entry_id:147634)学科联系”一章将展示这一基础模型惊人的扩展性，探讨如何利用它来模拟[材料非线性](@entry_id:162855)、结构失稳、动力学以及多物理场耦合等复杂工程现象。最后，在“动手实践”一章中，读者将通过具体的编程与计算练习，亲手验证理论的正确性并解决实际问题，从而将抽象的知识内化为实用的计算技能。

## 原理与机制

本章旨在深入探讨一维（1D）杆单元的力学原理、数学表述及其在有限元方法（FEM）中的实现机制。我们将从[连续介质力学](@entry_id:155125)的基本公理出发，系统地推导出控制方程的弱形式，并在此基础上构建[单元刚度矩阵](@entry_id:139369)和荷载向量。本章内容将为理解更复杂单元（如二维和三维实体单元）的力学行为奠定坚实的理论基础。

### 连续介质力学基础

在建立任何计算模型之前，我们必须首先精确定义描述物理系统变形和受力的基本量。对于一维杆件，这一过程始于运动学，即对几何变形的数学描述。

#### [运动学](@entry_id:173318)：[应变测量](@entry_id:193240)

考虑一根初始长度为 $L$ 的直杆，其在未变形的 **参考构型** 中占据 $X \in [0, L]$ 的区间。$X$ 称为 **物质坐标** 或 **拉格朗日坐标**，因为它标记了特定的物质点。当杆件受力变形后，这些物质点会移动到新的位置。在 **当前构型** 中，原先位于 $X$ 的物质点移动到了空间位置 $x$。$x$ 称为 **空间坐标** 或 **欧拉坐标**。

物质点从参考构型到当前构型的位移场由 $u(X)$ 定义，其关系为：
$x = X + u(X)$

变形的局部度量由 **变形梯度** $F$ 给出，它描述了参考构型中一个无限小线段 $dX$ 到当前构型中对应线段 $dx$ 的映射关系。
$$ F = \frac{dx}{dX} = \frac{d}{dX}(X + u(X)) = 1 + \frac{du}{dX} $$
$F$ 完整地捕捉了物[质点](@entry_id:186768)的局部拉伸和旋转信息（在一维情况下只有拉伸）。$F=1$ 表示没有变形。

为了定义一个纯粹度量“拉伸”的量，并且该量在刚体运动（即只有平移和旋转，无变形）下为零，我们引入 **[格林-拉格朗日应变张量](@entry_id:187745)**（Green-Lagrange strain）$E$。在一维情况下，它通过变形梯度的平方（即右柯西-格林变形张量 $C = F^2$）来定义：
$$ E = \frac{1}{2}(F^2 - 1) $$
将 $F = 1 + du/dX$ 代入，我们得到 $E$ 与[位移梯度](@entry_id:165352)的精确非[线性关系](@entry_id:267880)：
$$ E = \frac{1}{2}\left(\left(1 + \frac{du}{dX}\right)^2 - 1\right) = \frac{1}{2}\left(1 + 2\frac{du}{dX} + \left(\frac{du}{dX}\right)^2 - 1\right) = \frac{du}{dX} + \frac{1}{2}\left(\frac{du}{dX}\right)^2 $$
这个表达式是几何精确的，适用于任何大小的变形。

在许多工程应用中，特别是在岩土力学的大多数场景下，材料的应变非常小。这引导我们引入 **小应变假定**，即[位移梯度](@entry_id:165352)远小于1（$|\frac{du}{dX}| \ll 1$）。在此条件下，[位移梯度](@entry_id:165352)的平方项 $(\frac{du}{dX})^2$ 与线性项 $\frac{du}{dX}$ 相比可以忽略不计。这种[运动学](@entry_id:173318)的线性化处理产生了 **工程应变** 或 **小应变** 度量 $\epsilon$：
$$ \epsilon = \frac{du}{dX} $$
因此，我们可以看到工程应变 $\epsilon$ 是[格林-拉格朗日应变](@entry_id:170427) $E$ 的[一阶近似](@entry_id:147559)。它们之间的关系为 $E = \epsilon + \frac{1}{2}\epsilon^2$。这意味着当且仅当 $|\epsilon| \ll 1$ 时，$\epsilon \approx E$ 成立，其近似误差为 $\mathcal{O}(\epsilon^2)$ [@problem_id:3498513]。

为了量化这种差异，我们考虑一个均匀拉伸的例子，$u(X) = \alpha X$。此时，$\epsilon = \alpha$。[相对误差](@entry_id:147538)为 $(E - \epsilon) / \epsilon = (\frac{1}{2}\epsilon^2) / \epsilon = \frac{1}{2}\epsilon = \frac{1}{2}\alpha$。当拉伸率为 $\alpha = 0.05$（即5%应变）时，使用工程应变代替[格林-拉格朗日应变](@entry_id:170427)所引入的相对误差约为 $0.025$ 或 $2.5\%$。然而，当拉伸率增加到 $\alpha = 0.20$（20%应变）时，相对误差将达到 $10\%$。这个简单的计算表明，小应变假定的[适用范围](@entry_id:636189)是有限的，对于需要精确描述[大变形](@entry_id:167243)或[几何非线性](@entry_id:169896)行为的问题，必须采用像格林-Lagrange应变这样的[非线性](@entry_id:637147)[应变度量](@entry_id:755495) [@problem_id:3498513]。在有限元分析中，这通常意味着需要采用 **总拉格朗日（Total Lagrangian）** 列式，其中几何精确的[应变度量](@entry_id:755495) $E$ 与[热力学](@entry_id:141121)共轭的第二类[Piola-Kirchhoff应力](@entry_id:173629)一起使用。然而，对于本章的其余部分，我们将始终基于小应变假定。

#### [本构关系](@entry_id:186508)与虚功原理

**[本构关系](@entry_id:186508)** 或 **材料模型** 描述了材料的力学响应，即应力与应变之间的关系。对于线弹性材料，这个关系是线性的。我们可以从[热力学](@entry_id:141121)第一和第二定律出发，为线弹性[本构关系](@entry_id:186508)建立一个坚实的理论基础。

考虑一个[等温过程](@entry_id:143096)，系统的状态可以用 **[亥姆霍兹自由能](@entry_id:136442)密度** $\psi$（单位参考体积的能量）来描述，它是应变 $\epsilon$ 的函数。根据热力学第二定律（以[Clausius-Duhem不等式](@entry_id:193424)形式表述），对于任意过程，内部[耗散率](@entry_id:748577)必须是非负的：
$$ \sigma \dot{\epsilon} - \dot{\psi} \ge 0 $$
其中 $\sigma$ 是柯西应力，$\dot{\epsilon}$ 是[应变率](@entry_id:154778)，$\dot{\psi}$ 是[亥姆霍兹自由能](@entry_id:136442)的时间变化率。利用链式法则，$\dot{\psi} = \frac{\partial\psi}{\partial\epsilon}\dot{\epsilon}$，不等式变为：
$$ \left(\sigma - \frac{\partial\psi}{\partial\epsilon}\right) \dot{\epsilon} \ge 0 $$
对于一个纯弹性（或称 **可逆**）过程，定义上不存在[能量耗散](@entry_id:147406)，因此等号成立。由于这个等式必须对任意[应变率](@entry_id:154778) $\dot{\epsilon}$ 成立，括号内的项必须为零，这便导出了 **[超弹性](@entry_id:159356)** 本构关系：
$$ \sigma = \frac{\partial\psi}{\partial\epsilon} $$
对于 **线弹性** 材料，我们假设其储存的[应变能](@entry_id:162699)是应变的二次函数，即 $\psi(\epsilon) = \frac{1}{2}E\epsilon^2$，其中 $E > 0$ 是杨氏模量，以保证[材料稳定性](@entry_id:183933)。将此能量函数代入，我们便得到了著名的 **胡克定律** [@problem_id:3498551]：
$$ \sigma = \frac{\partial}{\partial\epsilon}\left(\frac{1}{2}E\epsilon^2\right) = E\epsilon $$
这个从热力学势推导出的[本构关系](@entry_id:186508)，是建立在小应变、等温和[可逆过程](@entry_id:276625)等一系列假定之上的。

在杆件分析中，我们通常更关心[合力](@entry_id:163825)而非应力。定义 **轴力** $N(x)$ 为应力在[横截面](@entry_id:154995)积 $A(x)$ 上的积分。对于均匀应力[分布](@entry_id:182848)，这简化为 $N(x) = A(x)\sigma(x)$。结合运动学关系 $\epsilon = du/dx$ 和胡克定律，我们得到轴力与位移之间的核心关系 [@problem_id:3498514]：
$$ N(x) = A(x)E(x)\frac{du}{dx} $$
这里我们明确允许杨氏模量 $E(x)$ 和[横截面](@entry_id:154995)积 $A(x)$ 沿杆长 $x$ 变化。

有了[运动学](@entry_id:173318)和本构关系，我们便可以建立问题的控制方程。在静力学中，控制方程是力的[平衡方程](@entry_id:172166)。对于一根受到[分布](@entry_id:182848)式轴向荷载 $\bar{q}(x)$（单位长度上的力）作用的杆件，其 **强形式** [平衡方程](@entry_id:172166)为：
$$ \frac{dN}{dx} + \bar{q}(x) = 0 \quad \text{for } x \in (0, L) $$
这是一个[二阶常微分方程](@entry_id:204212)，需要辅以边界条件才能求解。然而，直接求解强形式在几何形状或材料属性复杂时非常困难。有限元方法通过求解其等价的 **[弱形式](@entry_id:142897)** 来规避这一难题。

[弱形式](@entry_id:142897)是通过 **[虚功原理](@entry_id:138749)** 导出的。我们将[平衡方程](@entry_id:172166)乘以一个任意的、满足一定条件的 **[虚位移](@entry_id:168781)** $v(x)$（也称为 **检验函数**），并在整个定义域上积分：
$$ \int_0^L \left(\frac{dN}{dx} + \bar{q}(x)\right) v(x) \, dx = 0 $$
对第一项进行 **[分部积分](@entry_id:136350)** 是推导弱形式的关键步骤：
$$ \int_0^L \frac{dN}{dx} v(x) \, dx = [N(x)v(x)]_0^L - \int_0^L N(x) \frac{dv}{dx} \, dx $$
代入原积分方程并整理，得到：
$$ \int_0^L N(x) \frac{dv}{dx} \, dx = \int_0^L \bar{q}(x)v(x) \, dx + N(L)v(L) - N(0)v(0) $$
最后，代入 $N(x) = A(x)E(x)\frac{du}{dx}$，我们得到最终的[弱形式](@entry_id:142897)：
寻找位移场 $u(x)$，使得对于所有容许的[虚位移](@entry_id:168781) $v(x)$，下式成立：
$$ \underbrace{\int_0^L A(x)E(x)\frac{du}{dx}\frac{dv}{dx} \, dx}_{a(u,v)} = \underbrace{\int_0^L \bar{q}(x)v(x) \, dx + N(L)v(L) - N(0)v(0)}_{f(v)} $$
这个方程被称为弱形式，因为它对导数的要求比强形式更“弱”（仅要求一阶导数存在于积分意义下，而非逐点存在）。左侧的 $a(u,v)$ 是一个 **双线性形式**，代表了系统的内部[虚功](@entry_id:176403)；右侧的 $f(v)$ 是一个 **[线性泛函](@entry_id:276136)**，代表了外力所做的[虚功](@entry_id:176403)。

### 边界条件与问题的[适定性](@entry_id:148590)

分部积分过程中自然出现的边界项 $[N(x)v(x)]_0^L$ 揭示了两种性质截然不同的边界条件 [@problem_id:3498515]。

- **[本质边界条件](@entry_id:173524) (Essential Boundary Conditions)**：这类边界条件直接施加在问题的基本未知量上，在此即位移 $u(x)$。例如，$u(0) = \bar{u}_0$。为了让弱形式有意义，我们要求真实的位移场 $u(x)$ 在指定点满足该条件。同时，为了消除[弱形式](@entry_id:142897)中未知的反力项（如$N(0)$），我们要求检验函数 $v(x)$ 在该点满足对应的齐次条件，即 $v(0) = 0$。因此，本质边界条件是通过 **限制[试探函数](@entry_id:756165)和[检验函数](@entry_id:166589)的空间** 来施加的。

- **自然边界条件 (Natural Boundary Conditions)**：这类边界条件施加在出现在弱形式边界项中的量上，在此即轴力 $N(x)$。例如，$N(L) = \bar{N}_L$。这类边界条件 **自然地** 出现在载荷项 $f(v)$ 中。当一个边界上规定了自然边界条件时，我们不对检验函数 $v(x)$ 在该点施加任何限制，而是将已知的力值 $\bar{N}_L$ 代入弱形式中。

一个边值问题的 **[适定性](@entry_id:148590) (Well-posedness)** 指的是其解存在、唯一且稳定。对于[弹性静力学](@entry_id:198298)问题，[解的唯一性](@entry_id:143619)与 **刚体运动** 密切相关。对于一根未固定的杆件，它可以作为一个整体自由平移而不产生任何应变或应力，即 $u(x) = C$（常数）是一个导致内部[虚功](@entry_id:176403) $a(u,v) = 0$ 的非零解。这种非唯一性在物理上是合理的，但在数学上导致求解失败。

为了获得唯一解，我们必须通过施加至少一个[本质边界条件](@entry_id:173524)来 **约束[刚体运动](@entry_id:193355)**。例如，规定 $u(0)=0$ 可以防止整个杆件平移。从数学上讲，施加[本质边界条件](@entry_id:173524)后，系统的[双线性形式](@entry_id:746794) $a(u,v)$ 在满足齐次本质边界条件的函数空间上变得 **强制 (Coercive)**。这意味着对于该空间中任何非零位移场 $u$，其[应变能](@entry_id:162699) $a(u,u)$ 都是严格正的。根据 **Lax-Milgram 定理**，一个强制且连续的[双线性形式](@entry_id:746794)，配上一个连续的[线性泛函](@entry_id:276136)，能够保证弱形式存在唯一的解 [@problem_id:3498580]。

在有限元方法中，这一性质直接反映在[全局刚度矩阵](@entry_id:138630)的特性上。一个无[约束系统](@entry_id:164587)的[全局刚度矩阵](@entry_id:138630)是 **奇异的**（或称 **正半定的**），其[零空间](@entry_id:171336)对应于[刚体模态](@entry_id:754366)。施加足够的本质边界条件后，经过处理的刚度矩阵将变为 **非奇异的**（或称 **正定的**），从而保证代数方程组 $KU=F$ 有唯一解 [@problem_e:3498515, @problem_id:3498568]。

### [有限元离散化](@entry_id:193156)

有限元方法的核心思想在于将连续的弱形式问题转化为离散的[代数方程](@entry_id:272665)组。这通过将求解[域划分](@entry_id:748628)为有限个单元，并在每个单元内用简单的 **形函数** 来近似真实的位移场来实现。

#### 等参元与形函数

对于一个典型的二节点杆单元，我们引入一个 **父坐标** $\xi \in [-1, 1]$。单元内的任何场，包括位移和几何坐标，都通过定义在父[坐标系](@entry_id:156346)下的 **形函数** $N_i(\xi)$ 和单元节点上的值来插值。对于一个二节点线性单元，形函数为：
$$ N_1(\xi) = \frac{1-\xi}{2}, \quad N_2(\xi) = \frac{1+\xi}{2} $$
**等参 (Isoparametric)** 概念是指我们使用同一套形函数来插值几何坐标和求解的场变量（此处为位移）。
位移插值： $u(\xi) = N_1(\xi)u_1 + N_2(\xi)u_2 = \mathbf{N}(\xi)\mathbf{d}$
坐标插值： $x(\xi) = N_1(\xi)x_1 + N_2(\xi)x_2$
其中 $u_1, u_2$ 是节点位移， $x_1, x_2$ 是节点坐标，$\mathbf{d}$ 是单元节点位移向量。

为了计算应变，我们需要位移对物理坐标 $x$ 的导数。利用链式法则，我们建立起物理坐标导数和父坐标导数之间的关系：
$$ \frac{d}{dx} = \frac{d\xi}{dx}\frac{d}{d\xi} = \frac{1}{J}\frac{d}{d\xi} $$
其中 **雅可比行列式** $J = \frac{dx}{d\xi}$ 是[坐标映射](@entry_id:747874)的[尺度因子](@entry_id:266678)。对于线性单元，雅可比是常数：
$$ J = \frac{d}{d\xi}\left(N_1(\xi)x_1 + N_2(\xi)x_2\right) = -\frac{1}{2}x_1 + \frac{1}{2}x_2 = \frac{x_2-x_1}{2} = \frac{L_e}{2} $$
其中 $L_e$ 是单元长度。

现在我们可以推导 **[应变-位移矩阵](@entry_id:163451)** $\mathbf{B}$，它将节点位移与单元内的应变联系起来：
$$ \epsilon = \frac{du}{dx} = \frac{1}{J}\frac{du}{d\xi} = \frac{1}{J}\frac{d\mathbf{N}}{d\xi}\mathbf{d} = \mathbf{B}\mathbf{d} $$
因此，
$$ \mathbf{B} = \frac{1}{J}\frac{d\mathbf{N}}{d\xi} = \frac{1}{L_e/2}\begin{bmatrix} -\frac{1}{2}  \frac{1}{2} \end{bmatrix} = \frac{1}{L_e}\begin{bmatrix} -1  1 \end{bmatrix} $$
对于二节点线性杆单元，$\mathbf{B}$ 矩阵也是一个常数矩阵，这意味着单元内的应变是恒定的。

#### [单元刚度矩阵](@entry_id:139369)的推导

[单元刚度矩阵](@entry_id:139369) $\mathbf{k}_e$ 源于[弱形式](@entry_id:142897)中的[双线性形式](@entry_id:746794) $a(u,v)$ 在单元级别的体现。将[插值函数](@entry_id:262791) $u = \mathbf{N}\mathbf{d}$ 和 $v = \mathbf{N}\delta\mathbf{d}$ 代入，并变换到父[坐标系](@entry_id:156346)下积分，我们得到[单元刚度矩阵](@entry_id:139369)的通用表达式：
$$ \mathbf{k}_e = \int_{V_e} \mathbf{B}^T E A \mathbf{B} \, dV = \int_{-1}^{1} \mathbf{B}(\xi)^T E(\xi)A(\xi) \mathbf{B}(\xi) J(\xi) \, d\xi $$
这个表达式是计算所有杆[单元刚度矩阵](@entry_id:139369)的出发点 [@problem_id:3498543]。

**情况1：常数[截面](@entry_id:154995)和材料 ($E, A$ 为常数)**
当 $E$ 和 $A$ 为常数时，$\mathbf{B}$, $E$, $A$, $J$ 都是常数，可以移出积分号：
$$ \mathbf{k}_e = \mathbf{B}^T E A \mathbf{B} J \int_{-1}^{1} d\xi = (\mathbf{B}^T E A \mathbf{B} J) \cdot 2 $$
代入 $\mathbf{B} = \frac{1}{L_e}\begin{bmatrix} -1  1 \end{bmatrix}$ 和 $J = L_e/2$：
$$ \mathbf{k}_e = \frac{1}{L_e^2}\begin{bmatrix} -1 \\ 1 \end{bmatrix} \begin{bmatrix} -1  1 \end{bmatrix} E A \left(\frac{L_e}{2}\right) \cdot 2 = \frac{EA}{L_e} \begin{bmatrix} 1  -1 \\ -1  1 \end{bmatrix} $$
这就是我们所熟知的均匀杆单元的[刚度矩阵](@entry_id:178659) [@problem_id:3498551]。

**情况2：变化的[截面](@entry_id:154995)和/或材料**
当 $E(x)$ 或 $A(x)$ 沿杆长变化时，它们不能被移出积分号。对于一个线性单元，$\mathbf{B}$ 和 $J$ 仍然是常数，因此[刚度矩阵](@entry_id:178659)为 [@problem_id:3498514]：
$$ \mathbf{k}_e = (\mathbf{B}^T\mathbf{B}) \int_{x_1}^{x_2} E(x)A(x) \, dx = \frac{1}{L_e^2}\begin{bmatrix} 1  -1 \\ -1  1 \end{bmatrix} \int_{x_1}^{x_2} E(x)A(x) \, dx $$
考虑一个特殊情况，即轴向刚度 $R(x)=E(x)A(x)$ 在单元内呈线性变化，可以通过节点值 $R_1, R_2$ 插值得到：$R(\xi) = N_1(\xi)R_1 + N_2(\xi)R_2$。此时，积分可以解析求解 [@problem_id:3498556]：
$$ \int_{x_1}^{x_2} R(x) \, dx = \int_{-1}^{1} R(\xi) J \, d\xi = \frac{L_e}{2}\int_{-1}^{1} (N_1(\xi)R_1 + N_2(\xi)R_2) \, d\xi $$
由于 $\int_{-1}^{1} N_1(\xi) d\xi = 1$ 且 $\int_{-1}^{1} N_2(\xi) d\xi = 1$，上式积分为 $\frac{L_e}{2}(R_1 + R_2)$。这物理上对应于梯形面积。因此，刚度矩阵为：
$$ \mathbf{k}_e = \frac{1}{L_e^2} \frac{L_e(R_1+R_2)}{2} \begin{bmatrix} 1  -1 \\ -1  1 \end{bmatrix} = \frac{R_1+R_2}{2L_e} \begin{bmatrix} 1  -1 \\ -1  1 \end{bmatrix} $$
这可以被看作是使用单元的平均刚度 $\frac{R_1+R_2}{2}$ 计算的。

### [数值积分](@entry_id:136578)与荷载向量

#### 高斯积分
当 $E(x)A(x)$ 的形式复杂，导致积分难以解析求解时，必须采用 **数值积分**。**高斯-勒让德（Gauss-Legendre）求积** 是有限元中最常用的方法。其核心思想是，通过精心选择积分点的位置和权重，用 $n_p$ 个积分点可以精确地计算最高 $2n_p-1$ 次多项式的积分。

刚度矩阵积分的被积函数为 $f(\xi) = (\mathbf{B}^T \mathbf{B}) E(\xi) A(\xi) J(\xi)$。对于线性单元，$\mathbf{B}$ 和 $J$ 是常数（0次多项式）。因此，被积函数的次数完全由 $E(\xi)A(\xi)$ 决定。

-   如果 $E, A$ 均为常数，则被积函数是0次多项式。我们需要 $2n_p-1 \ge 0$，因此 $n_p=1$（单[点积](@entry_id:149019)分）就足够精确 [@problem_id:3498533]。
-   如果杆件是锥形的（$A(\xi)$为1次）且材料是均匀的（$E$为0次），则被积函数是1次多项式。我们仍需 $2n_p-1 \ge 1$，因此 $n_p=1$ 依然足够。
-   如果 $A(\xi)$ 是1次多项式，而材料属性 $E(\xi)$ 是 $m$ 次多项式，那么被积函数的次数是 $1+m$。若采用2点高斯积分（$n_p=2$），可精确积分最高 $2(2)-1=3$ 次多项式。因此，我们需要 $1+m \le 3$，即 $m \le 2$。这意味着对于线性变化的[截面](@entry_id:154995)，只要材料杨氏模量的变化不超过二次多项式，2点[高斯积分](@entry_id:187139)就能得到精确的[单元刚度矩阵](@entry_id:139369) [@problem_id:3498543]。

#### [一致荷载向量](@entry_id:163156)

外力也必须通过虚功原理转化为作用在节点上的等效 **[一致荷载向量](@entry_id:163156)**。例如，考虑一个均匀的[体力](@entry_id:174230) $b$（单位体积的力，如重力），其做的[虚功](@entry_id:176403)为 $\delta W_{ext,b} = \int_{V_e} b \delta u \, dV$。将[虚位移](@entry_id:168781) $\delta u = \mathbf{N}\delta\mathbf{d}$ 代入并变换到父[坐标系](@entry_id:156346)：
$$ \delta W_{ext,b} = (\delta\mathbf{d})^T \int_{-1}^{1} \mathbf{N}(\xi)^T b A J \, d\xi $$
由 $\delta W_{ext,b} = (\delta\mathbf{d})^T \mathbf{f}_b$ 可得体力的[一致荷载向量](@entry_id:163156)为：
$$ \mathbf{f}_b = \int_{-1}^{1} \mathbf{N}(\xi)^T b A J \, d\xi $$
对于一个均匀杆件（$A, J$ 为常数）和均匀[体力](@entry_id:174230)（$b$ 为常数）：
$$ \mathbf{f}_b = b A J \int_{-1}^{1} \begin{pmatrix} N_1(\xi) \\ N_2(\xi) \end{pmatrix} \, d\xi = b A \left(\frac{L_e}{2}\right) \begin{pmatrix} 1 \\ 1 \end{pmatrix} = \begin{pmatrix} bAL_e/2 \\ bAL_e/2 \end{pmatrix} $$
这个结果物理意义非常直观：单元所受的总体力 $bAL_e$被平均分配到了两个节点上 [@problem_id:3498527]。

### 组装与求解

最后一步是组装所有单元的刚度矩阵和荷载向量，形成全局的代数方程组 $K U = F$。在此过程中，关键任务是正确施加[本质边界条件](@entry_id:173524)。

假设全局系统被划分为自由度（$F$）和约束自由度（$C$），其中 $U_C = \bar{U}_C$ 是已知的。分区后的[方程组](@entry_id:193238)为：
$$
\begin{pmatrix} K_{FF}  K_{FC} \\ K_{CF}  K_{CC} \end{pmatrix} \begin{pmatrix} U_F \\ U_C \end{pmatrix} = \begin{pmatrix} F_F \\ F_R \end{pmatrix}
$$
其中 $F_R$ 是未知的支座反力。理论上最清晰的处理方法是 **[静态凝聚](@entry_id:176722)** 或 **分区**。我们只需求解第一个[方程组](@entry_id:193238)：
$$ K_{FF} U_F + K_{FC} U_C = F_F $$
由于 $U_C = \bar{U}_C$ 已知，方程变为：
$$ K_{FF} U_F = F_F - K_{FC} \bar{U}_C $$
这个规模减小的系统 $K_{FF} U_F = F'_F$ 是正定的，可以唯一求解 $U_F$ [@problem_id:3498568]。

在实际编程中，直接进行矩阵分区可能不便。一种常用且严格等效的方法是 **消元法**。该方法通过修改全局矩阵 $K$ 和向量 $F$ 来实现：
1.  对于每个约束自由度 $i \in C$ (其规定位移为 $\bar{u}_i$)：
2.  将全局荷载向量 $F$ 进行修正：对于所有自由度 $j \in F$，更新 $F_j = F_j - K_{ji} \bar{u}_i$。这步相当于将上式中的 $K_{FC}\bar{U}_C$ 项移到右边。
3.  将 $K$ 矩阵的第 $i$ 行和第 $i$ 列（对角元除外）置为零。
4.  将 $K$ 矩阵的对角元 $K_{ii}$ 置为1。
5.  将荷载向量的第 $i$ 项 $F_i$ 置为规定的位移值 $\bar{u}_i$。

经过这一系列操作，原[方程组](@entry_id:193238)中第 $i$ 行的方程变为 $1 \cdot U_i = \bar{u}_i$，直接施加了该约束。而其他行的方程则变为与理论上的分区法完全相同的形式。这种方法的好处是它保持了矩阵的对称性，并且是精确的，不会引入罚方法那样的病态问题 [@problem_id:3498568]。