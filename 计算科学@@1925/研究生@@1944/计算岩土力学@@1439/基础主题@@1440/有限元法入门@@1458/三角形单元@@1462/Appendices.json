{"hands_on_practices": [{"introduction": "在实际的岩土力学模型中，几何形状通常是复杂的。有限元分析通过将一个标准的、简单的“参考”单元映射到物理网格上来简化这个问题。本练习将引导您完成二次应变三角形（LST）单元的等参映射计算，其中几何形状和场变量（如位移）使用相同的形函数进行插值。通过完成这个计算 [@problem_id:3569080]，您将具体理解坐标是如何转换的，雅可比矩阵如何描述几何变形，以及如何在物理单元上执行数值积分，这是理解和调试有限元代码的一项基本技能。", "problem": "在计算岩土力学中，等参三角形单元使用相同的形函数对几何和场进行插值，从而将一个参考三角形映射到一个物理三角形。考虑一个六节点二次等参线性应变三角形 (LST)，其物理节点坐标（单位为米）如下\n$$\n(x_{1},y_{1})=(0,0),\\quad (x_{2},y_{2})=(3,0),\\quad (x_{3},y_{3})=(0,2),\\quad (x_{4},y_{4})=(1.5,0.05),\\quad (x_{5},y_{5})=(1.5,1.0),\\quad (x_{6},y_{6})=(0.0,1.0).\n$$\n设参考三角形由自然坐标 $(\\xi,\\eta)$ 定义，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$，并设面积（重心）坐标为\n$$\nL_{1}=1-\\xi-\\eta,\\quad L_{2}=\\xi,\\quad L_{3}=\\eta,\\quad L_{1}+L_{2}+L_{3}=1.\n$$\n二次 LST 形函数用面积坐标表示为\n$$\nN_{1}=L_{1}(2L_{1}-1),\\quad N_{2}=L_{2}(2L_{2}-1),\\quad N_{3}=L_{3}(2L_{3}-1),\\quad N_{4}=4L_{1}L_{2},\\quad N_{5}=4L_{2}L_{3},\\quad N_{6}=4L_{3}L_{1}.\n$$\n等参映射为\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{6}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad y(\\xi,\\eta)=\\sum_{i=1}^{6}N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\n在参考三角形上使用 Dunavant 2阶求积法则，其求积点和权值以重心坐标形式由下式给出\n$$\n(L_{1},L_{2},L_{3})\\in\\left\\{\\left(\\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6}\\right),\\ \\left(\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6}\\right),\\ \\left(\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3}\\right)\\right\\},\\qquad w=\\tfrac{1}{6}\\ \\text{for each point}.\n$$\n假设节点排序保持方向，从而使得雅可比行列式在整个单元上为正。从以上定义出发，执行以下操作：\n\n- 通过等参映射，将每个 Dunavant 求积点从重心坐标 $(L_{1},L_{2},L_{3})$ 映射到物理坐标 $(x,y)$。\n- 计算雅可比矩阵\n$$\n\\mathbf{J}(\\xi,\\eta)=\\begin{pmatrix}\\dfrac{\\partial x}{\\partial \\xi}  \\dfrac{\\partial x}{\\partial \\eta} \\\\[6pt] \\dfrac{\\partial y}{\\partial \\xi}  \\dfrac{\\partial y}{\\partial \\eta}\\end{pmatrix}\n$$\n及其在每个求积点处的行列式。\n- 在每个点处，构造经雅可比行列式缩放的求积权值 $w_{i}\\,\\det\\mathbf{J}(\\xi_{i},\\eta_{i})$。\n\n然后，通过在参考三角形上使用 Dunavant 求积法则，利用这些雅可比权值来计算面积分\n$$\n\\int_{\\Omega_{e}}1\\,\\mathrm{d}\\Omega=\\int_{\\hat{\\Omega}}\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n。以平方米表示最终面积。提供一个最终答案，除非无法精确计算，否则无需四舍五入。", "solution": "用户希望执行一系列与六节点二次等参三角形单元相关的计算，最终使用 Dunavant 2阶求积法则计算单元的面积。\n\n### 第0步：问题验证\n\n**提取已知条件：**\n- 单元类型：六节点二次等参线性应变三角形 (LST)。\n- 物理节点坐标 $(x_i, y_i)$，单位为米：\n  - $(x_1, y_1) = (0, 0)$\n  - $(x_2, y_2) = (3, 0)$\n  - $(x_3, y_3) = (0, 2)$\n  - $(x_4, y_4) = (1.5, 0.05)$\n  - $(x_5, y_5) = (1.5, 1.0)$\n  - $(x_6, y_6) = (0.0, 1.0)$\n- 参考三角形顶点，以自然坐标 $(\\xi, \\eta)$ 表示：$(0,0)$, $(1,0)$ 和 $(0,1)$。\n- 面积（重心）坐标：$L_{1}=1-\\xi-\\eta$, $L_{2}=\\xi$, $L_{3}=\\eta$。\n- 二次形函数 $N_i$：\n  - $N_{1}=L_{1}(2L_{1}-1)$\n  - $N_{2}=L_{2}(2L_{2}-1)$\n  - $N_{3}=L_{3}(2L_{3}-1)$\n  - $N_{4}=4L_{1}L_{2}$\n  - $N_{5}=4L_{2}L_{3}$\n  - $N_{6}=4L_{3}L_{1}$\n- 等参映射：$x(\\xi,\\eta)=\\sum_{i=1}^{6}N_{i}(\\xi,\\eta)x_{i}$, $y(\\xi,\\eta)=\\sum_{i=1}^{6}N_{i}(\\xi,\\eta)y_{i}$。\n- Dunavant 2阶求积法则：\n  - 求积点，以重心坐标 $(L_1, L_2, L_3)$ 表示：$(\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$, $(\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$, $(\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$。\n  - 每个点的权值：$w = \\frac{1}{6}$。\n- 雅可比矩阵定义：$\\mathbf{J}(\\xi,\\eta)=\\begin{pmatrix} \\partial x/\\partial\\xi  \\partial x/\\partial\\eta \\\\ \\partial y/\\partial\\xi  \\partial y/\\partial\\eta \\end{pmatrix}$。\n- 面积分定义：$\\int_{\\Omega_{e}}1\\,\\mathrm{d}\\Omega=\\int_{\\hat{\\Omega}}\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n\n**验证：**\n1.  **科学依据：** 该问题是有限元法 (FEM) 在等参映射和数值积分方面的标准应用，这些是计算力学中的核心概念。所有定义和公式都是标准且正确的。\n2.  **适定性：** 所有必要数据（节点坐标、形函数、求积法则）都已提供。任务定义清晰，并会导出一个唯一解。\n3.  **客观性：** 问题陈述纯粹是数学性和程序性的，没有任何主观或模糊的语言。\n4.  **自洽性与一致性：** 所提供的信息足以解决问题。没有内部矛盾。例如，形函数之和为 $\\sum N_i = 1$，求积权值之和 $3 \\times \\frac{1}{6} = \\frac{1}{2}$ 对应于参考三角形的面积，这表明求积法则的定义是一致的。\n\n**结论：** 问题是有效的。\n\n### 第1步：映射求积点\n\n首先，我们使用关系式 $L_2 = \\xi$ 和 $L_3 = \\eta$ 将求积点 (QP) 的重心坐标 $(L_1, L_2, L_3)$ 转换为自然坐标 $(\\xi, \\eta)$。\n- **求积点1:** $(L_1, L_2, L_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6}) \\implies (\\xi_1, \\eta_1) = (\\frac{1}{6}, \\frac{1}{6})$。\n- **求积点2:** $(L_1, L_2, L_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6}) \\implies (\\xi_2, \\eta_2) = (\\frac{2}{3}, \\frac{1}{6})$。\n- **求积点3:** $(L_1, L_2, L_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3}) \\implies (\\xi_3, \\eta_3) = (\\frac{1}{6}, \\frac{2}{3})$。\n\n对于每个求积点，我们计算形函数 $N_i$，然后使用等参映射来找到物理坐标 $(x, y)$。\n\n**对于求积点1: $(L_1, L_2, L_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$**\n- 形函数：\n  $N_1 = \\frac{2}{3}(2\\cdot\\frac{2}{3}-1) = \\frac{2}{9}$\n  $N_2 = \\frac{1}{6}(2\\cdot\\frac{1}{6}-1) = -\\frac{1}{9}$\n  $N_3 = \\frac{1}{6}(2\\cdot\\frac{1}{6}-1) = -\\frac{1}{9}$\n  $N_4 = 4(\\frac{2}{3})(\\frac{1}{6}) = \\frac{4}{9}$\n  $N_5 = 4(\\frac{1}{6})(\\frac{1}{6}) = \\frac{1}{9}$\n  $N_6 = 4(\\frac{1}{6})(\\frac{2}{3}) = \\frac{4}{9}$\n- 物理坐标：\n  $x_1 = \\sum N_i x_i = (-\\frac{1}{9})(3) + (\\frac{4}{9})(1.5) + (\\frac{1}{9})(1.5) = \\frac{-3+6+1.5}{9} = \\frac{4.5}{9} = \\frac{1}{2}$\n  $y_1 = \\sum N_i y_i = (-\\frac{1}{9})(2) + (\\frac{4}{9})(0.05) + (\\frac{1}{9})(1) + (\\frac{4}{9})(1) = \\frac{-2+0.2+1+4}{9} = \\frac{3.2}{9} = \\frac{16}{45}$\n- 映射点1： $(x,y) = (\\frac{1}{2}, \\frac{16}{45})$。\n\n**对于求积点2: $(L_1, L_2, L_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$**\n- 形函数：\n  $N_1 = -\\frac{1}{9}$, $N_2 = \\frac{2}{9}$, $N_3 = -\\frac{1}{9}$, $N_4 = \\frac{4}{9}$, $N_5 = \\frac{4}{9}$, $N_6 = \\frac{1}{9}$\n- 物理坐标：\n  $x_2 = (\\frac{2}{9})(3) + (\\frac{4}{9})(1.5) + (\\frac{4}{9})(1.5) = \\frac{6+6+6}{9} = \\frac{18}{9} = 2$\n  $y_2 = (-\\frac{1}{9})(2) + (\\frac{4}{9})(0.05) + (\\frac{4}{9})(1) + (\\frac{1}{9})(1) = \\frac{-2+0.2+4+1}{9} = \\frac{3.2}{9} = \\frac{16}{45}$\n- 映射点2： $(x,y) = (2, \\frac{16}{45})$。\n\n**对于求积点3: $(L_1, L_2, L_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$**\n- 形函数：\n  $N_1 = -\\frac{1}{9}$, $N_2 = -\\frac{1}{9}$, $N_3 = \\frac{2}{9}$, $N_4 = \\frac{1}{9}$, $N_5 = \\frac{4}{9}$, $N_6 = \\frac{4}{9}$\n- 物理坐标：\n  $x_3 = (-\\frac{1}{9})(3) + (\\frac{1}{9})(1.5) + (\\frac{4}{9})(1.5) = \\frac{-3+1.5+6}{9} = \\frac{4.5}{9} = \\frac{1}{2}$\n  $y_3 = (\\frac{2}{9})(2) + (\\frac{1}{9})(0.05) + (\\frac{4}{9})(1) + (\\frac{4}{9})(1) = \\frac{4+0.05+4+4}{9} = \\frac{12.05}{9} = \\frac{241}{180}$\n- 映射点3： $(x,y) = (\\frac{1}{2}, \\frac{241}{180})$。\n\n### 第2步：计算雅可比矩阵及其行列式\n\n雅可比矩阵 $\\mathbf{J}$ 的分量通过对等参映射函数求导得到。\n$\\frac{\\partial x}{\\partial\\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial\\xi} x_i$, $\\frac{\\partial x}{\\partial\\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial\\eta} x_i$，等等。\n通过检查所有六个节点的坐标，可以验证 $x$ 的映射恰好为 $x(\\xi,\\eta)=3\\xi$。因此，在单元内任何地方都有 $\\frac{\\partial x}{\\partial\\xi} = 3$ 和 $\\frac{\\partial x}{\\partial\\eta} = 0$。\n\n$y$ 的映射为 $y(\\xi,\\eta) = \\sum N_i y_i = 2N_3 + 0.05N_4 + 1.0N_5 + 1.0N_6$。展开形函数并合并同类项，得到 $y$ 作为 $\\xi, \\eta$ 函数的表达式：\n$y(\\xi, \\eta) = 2\\eta + 0.2\\xi - 0.2\\xi^2 - 0.2\\xi\\eta$.\n求其偏导数：\n$\\frac{\\partial y}{\\partial\\xi}(\\xi, \\eta) = 0.2 - 0.4\\xi - 0.2\\eta = \\frac{1}{5} - \\frac{2}{5}\\xi - \\frac{1}{5}\\eta$\n$\\frac{\\partial y}{\\partial\\eta}(\\xi, \\eta) = 2 - 0.2\\xi = 2 - \\frac{1}{5}\\xi$\n雅可比矩阵为 $\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 3  0 \\\\ \\frac{1}{5} - \\frac{2}{5}\\xi - \\frac{1}{5}\\eta  2 - \\frac{1}{5}\\xi \\end{pmatrix}$。\n行列式为 $\\det\\mathbf{J}(\\xi, \\eta) = 3(2 - \\frac{1}{5}\\xi) = 6 - \\frac{3}{5}\\xi$。\n\n现在我们在每个求积点计算雅可比矩阵及其行列式。\n\n**对于求积点1: $(\\xi_1, \\eta_1) = (\\frac{1}{6}, \\frac{1}{6})$**\n- 雅可比矩阵：\n  $J_{11}=3$, $J_{12}=0$\n  $J_{21} = \\frac{1}{5} - \\frac{2}{5}(\\frac{1}{6}) - \\frac{1}{5}(\\frac{1}{6}) = \\frac{1}{5} - \\frac{3}{30} = \\frac{1}{5} - \\frac{1}{10} = \\frac{1}{10}$\n  $J_{22} = 2 - \\frac{1}{5}(\\frac{1}{6}) = 2 - \\frac{1}{30} = \\frac{59}{30}$\n  $\\mathbf{J}_1 = \\begin{pmatrix} 3  0 \\\\ 1/10  59/30 \\end{pmatrix}$\n- 行列式：\n  $\\det\\mathbf{J}_1 = 6 - \\frac{3}{5}(\\frac{1}{6}) = 6 - \\frac{1}{10} = \\frac{59}{10} = 5.9$\n\n**对于求积点2: $(\\xi_2, \\eta_2) = (\\frac{2}{3}, \\frac{1}{6})$**\n- 雅可比矩阵：\n  $J_{11}=3$, $J_{12}=0$\n  $J_{21} = \\frac{1}{5} - \\frac{2}{5}(\\frac{2}{3}) - \\frac{1}{5}(\\frac{1}{6}) = \\frac{1}{5} - \\frac{4}{15} - \\frac{1}{30} = \\frac{6-8-1}{30} = -\\frac{3}{30} = -\\frac{1}{10}$\n  $J_{22} = 2 - \\frac{1}{5}(\\frac{2}{3}) = 2 - \\frac{2}{15} = \\frac{28}{15}$\n  $\\mathbf{J}_2 = \\begin{pmatrix} 3  0 \\\\ -1/10  28/15 \\end{pmatrix}$\n- 行列式：\n  $\\det\\mathbf{J}_2 = 6 - \\frac{3}{5}(\\frac{2}{3}) = 6 - \\frac{2}{5} = \\frac{28}{5} = 5.6$\n\n**对于求积点3: $(\\xi_3, \\eta_3) = (\\frac{1}{6}, \\frac{2}{3})$**\n- 雅可比矩阵：\n  $J_{11}=3$, $J_{12}=0$\n  $J_{21} = \\frac{1}{5} - \\frac{2}{5}(\\frac{1}{6}) - \\frac{1}{5}(\\frac{2}{3}) = \\frac{1}{5} - \\frac{1}{15} - \\frac{2}{15} = \\frac{1}{5} - \\frac{3}{15} = \\frac{1}{5} - \\frac{1}{5} = 0$\n  $J_{22} = 2 - \\frac{1}{5}(\\frac{1}{6}) = 2 - \\frac{1}{30} = \\frac{59}{30}$\n  $\\mathbf{J}_3 = \\begin{pmatrix} 3  0 \\\\ 0  59/30 \\end{pmatrix}$\n- 行列式：\n  $\\det\\mathbf{J}_3 = 6 - \\frac{3}{5}(\\frac{1}{6}) = 6 - \\frac{1}{10} = \\frac{59}{10} = 5.9$\n\n### 第3步：构造经雅可比行列式缩放的求积权值\n\n每个求积点的权值 $w$ 给出为 $\\frac{1}{6}$。经雅可比行列式缩放的权值为 $w \\det\\mathbf{J}$。\n- 权值1： $w_1 \\det\\mathbf{J}_1 = \\frac{1}{6} \\times \\frac{59}{10} = \\frac{59}{60}$\n- 权值2： $w_2 \\det\\mathbf{J}_2 = \\frac{1}{6} \\times \\frac{28}{5} = \\frac{28}{30} = \\frac{14}{15}$\n- 权值3： $w_3 \\det\\mathbf{J}_3 = \\frac{1}{6} \\times \\frac{59}{10} = \\frac{59}{60}$\n\n### 第4步：计算面积分\n\n物理单元 $\\Omega_e$ 的面积由积分 $\\int_{\\Omega_e} 1\\,\\mathrm{d}\\Omega$ 给出。将此积分变换到参考单元 $\\hat{\\Omega}$ 上得到 $\\int_{\\hat{\\Omega}}\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n我们使用给定的 Dunavant 求积法则来近似该积分：\n面积 $\\approx \\sum_{i=1}^{3} w_i \\det\\mathbf{J}(\\xi_i, \\eta_i)$\n该和是上一步计算出的经雅可比行列式缩放的权值之和。\n面积 $\\approx \\frac{59}{60} + \\frac{14}{15} + \\frac{59}{60} = \\frac{59}{60} + \\frac{56}{60} + \\frac{59}{60} = \\frac{59+56+59}{60} = \\frac{174}{60} = \\frac{29}{10} = 2.9$\n\n由于被积函数 $\\det\\mathbf{J} = 6 - \\frac{3}{5}\\xi$ 是关于 $\\xi$ 和 $\\eta$ 的线性多项式，2阶求积法则（对最高为2次的多项式是精确的）可以得到精确的面积。\n精确面积 $= \\int_{0}^{1} \\int_{0}^{1-\\xi} (6 - \\frac{3}{5}\\xi) d\\eta d\\xi = \\int_{0}^{1} (6 - \\frac{3}{5}\\xi)(1-\\xi) d\\xi$\n$= \\int_{0}^{1} (6 - 6\\xi - \\frac{3}{5}\\xi + \\frac{3}{5}\\xi^2) d\\xi = \\int_{0}^{1} (\\frac{3}{5}\\xi^2 - \\frac{33}{5}\\xi + 6) d\\xi$\n$= [\\frac{1}{5}\\xi^3 - \\frac{33}{10}\\xi^2 + 6\\xi]_0^1 = \\frac{1}{5} - \\frac{33}{10} + 6 = \\frac{2-33+60}{10} = \\frac{29}{10} = 2.9$。\n数值求积结果是精确的。", "answer": "$$\n\\boxed{2.9}\n$$", "id": "3569080"}, {"introduction": "理解了单元如何映射之后，下一个自然的问题是：它们在表示真实几何体方面的表现如何，特别是像隧道或钻孔这样的曲面边界？本练习对比了具有直边的常应变三角形（CST）单元与具有曲边的线性应变三角形（LST）单元的几何逼近能力。通过推导误差的主导项 [@problem_id:3569095]，您将能够量化地理解高阶单元在捕捉几何形状方面的优越性，这种分析为在计算成本和模型精度之间做出明智的单元选择决策提供了理论基础。", "problem": "在一个半径为 $R$ 的圆形隧道的平面应变计算岩土力学模型中，隧道边界被用三角形有限元离散化。考虑两种边界边离散化方式：\n\n- 一种是恒应变三角形 (CST)，每个单元有 $3$ 个节点，其边界边是一条直线弦，连接着两个恰好位于真实圆形边界上的端点节点。\n- 一种是线性应变三角形 (LST)，在等参格式下每个单元有 $6$ 个节点，其边界边是一条二次曲线，由通过两个端点节点和边中节点的二次形函数得到，这三个节点都精确地放置在真实的圆形边界上，且边中节点位于两个端点节点之间的边界弧的中点。\n\n设沿边界的节点间距为 $L$，且 $L \\ll R$。定义单个边界边的几何近似误差 $\\delta_{\\max}$ 为在该边的跨度上，沿边界法向方向测量的真实圆形边界与有限元边之间的最大距离。\n\n仅使用几何和插值的第一性原理（例如，圆方程和多项式插值），推导当 $L/R \\to 0$ 时，以下两种情况下 $\\delta_{\\max}$ 的领头阶渐近表达式：\n\n- CST 的直边边界边。\n- 上述的 LST 等参二次边界边。\n\n哪个选项给出了用 $L$ 和 $R$ 表示的正确的一对领头阶渐近式？\n\nA. CST: $\\delta_{\\max} \\sim \\dfrac{L^{2}}{8 R}$; LST: $\\delta_{\\max} \\sim \\dfrac{L^{4}}{512 R^{3}}$。\n\nB. CST: $\\delta_{\\max} \\sim \\dfrac{L^{2}}{8 R}$; LST: $\\delta_{\\max} \\sim \\dfrac{L^{3}}{96 R^{2}}$。\n\nC. CST: $\\delta_{\\max} \\sim \\dfrac{L^{2}}{12 R}$; LST: $\\delta_{\\max} \\sim \\dfrac{L^{4}}{512 R^{3}}$。\n\nD. CST: $\\delta_{\\max} \\sim \\dfrac{L^{2}}{8 R}$; LST: $\\delta_{\\max} \\sim \\dfrac{L^{4}}{128 R^{3}}$。", "solution": "我们在边的中点建立一个局部标准正交坐标系。设 $x$ 为切向坐标，$y$ 为外法向坐标。半径为 $R$ 的真实圆形边界可以局部地（圆心在 $y$ 轴上）写为\n$$\nx^{2} + (R - y)^{2} = R^{2},\n$$\n这给出了精确的边界方程\n$$\ny_{\\text{circ}}(x) = R - \\sqrt{R^{2} - x^{2}}.\n$$\n对于小的 $|x|/R$，其泰勒展开式为\n$$\ny_{\\text{circ}}(x) = \\frac{x^{2}}{2 R} + \\frac{x^{4}}{8 R^{3}} + \\mathcal{O}\\!\\left(\\frac{x^{6}}{R^{5}}\\right).\n$$\n设一条边的两个端点节点沿边界的弧长为 $L$。半弦长为 $a$。对于小曲率， $a$ 和 $L/2$ 的差异仅在 $\\mathcal{O}\\!\\left(L^{3}/R^{2}\\right)$ 阶，因此对于领头阶渐近分析，我们可以取\n$$\na \\approx \\frac{L}{2}.\n$$\n\nCST 情况（直弦）：\nCST 边是连接 $x = \\pm a$ 处两个端点节点的直弦。在我们选择的局部坐标系中，弦在中点处与 $x$ 轴相切，因此直边为 $y_{\\text{CST}}(x) = 0$。圆与弦之间的最大法向偏差出现在中点 $x=0$ 处，这正是由半角 $\\theta$ 所对的圆的经典弦高。根据圆的几何性质，半弦长满足 $a = R \\sin \\theta$，弦高为\n$$\n\\delta_{\\max}^{\\text{CST}} = R - R \\cos \\theta = R(1 - \\cos \\theta).\n$$\n对于小 $\\theta$，有 $\\sin \\theta \\approx \\theta$ 和 $\\cos \\theta \\approx 1 - \\theta^{2}/2$。因此 $a \\approx R \\theta$ 且\n$$\n\\delta_{\\max}^{\\text{CST}} \\approx R \\cdot \\frac{\\theta^{2}}{2} \\approx \\frac{a^{2}}{2 R}.\n$$\n使用 $a \\approx L/2$ 得到\n$$\n\\delta_{\\max}^{\\text{CST}} \\sim \\frac{(L/2)^{2}}{2 R} = \\frac{L^{2}}{8 R} \\quad \\text{当 } \\frac{L}{R} \\to 0.\n$$\n\nLST 情况（通过三个边界点的二次等参边）：\n根据构造，等参二次边界边通过三个点 $\\{(-a, y_{\\text{circ}}(-a)), (0, y_{\\text{circ}}(0)), (a, y_{\\text{circ}}(a))\\}$。对称性意味着二次插值函数具有以下形式\n$$\ny_{\\text{LST}}(x) = c_{2}\\, x^{2}.\n$$\n在 $x = a$ 处施加插值条件得到\n$$\nc_{2} a^{2} = y_{\\text{circ}}(a) = \\frac{a^{2}}{2 R} + \\frac{a^{4}}{8 R^{3}} + \\mathcal{O}\\!\\left(\\frac{a^{6}}{R^{5}}\\right),\n$$\n所以\n$$\nc_{2} = \\frac{1}{2 R} + \\frac{a^{2}}{8 R^{3}} + \\mathcal{O}\\!\\left(\\frac{a^{4}}{R^{5}}\\right).\n$$\n因此，\n$$\ny_{\\text{LST}}(x) = \\left(\\frac{1}{2 R} + \\frac{a^{2}}{8 R^{3}} + \\cdots \\right) x^{2}.\n$$\n二次边与真实圆之间的点态误差为\n$$\ne(x) := y_{\\text{LST}}(x) - y_{\\text{circ}}(x) = \\left(\\frac{1}{2 R} + \\frac{a^{2}}{8 R^{3}}\\right) x^{2} - \\left(\\frac{x^{2}}{2 R} + \\frac{x^{4}}{8 R^{3}}\\right) + \\mathcal{O}\\!\\left(\\frac{x^{6}}{R^{5}}\\right).\n$$\n$x^{2}/(2R)$ 项相消，保留领头阶项得到\n$$\ne(x) = \\frac{a^{2} x^{2} - x^{4}}{8 R^{3}} + \\mathcal{O}\\!\\left(\\frac{a^{4} x^{2}}{R^{5}}, \\frac{x^{6}}{R^{5}}\\right).\n$$\n在区间 $x \\in [-a,a]$ 上， $|e(x)|$ 的领头阶部分在临界点处取得最大值，该临界点通过最大化函数 $f(x) = a^{2} x^{2} - x^{4}$（其中 $x \\in [0,a]$）得到。其导数为 $f'(x) = 2 a^{2} x - 4 x^{3}$，在 $x = 0$ 和 $x = a/\\sqrt{2}$ 处为零。在 $[0,a]$ 上的最大值出现在 $x = a/\\sqrt{2}$ 处，其值为\n$$\nf\\!\\left(\\frac{a}{\\sqrt{2}}\\right) = a^{2} \\cdot \\frac{a^{2}}{2} - \\frac{a^{4}}{4} = \\frac{a^{4}}{4}.\n$$\n因此，LST 二次边的最大法向偏差为\n$$\n\\delta_{\\max}^{\\text{LST}} \\sim \\frac{1}{8 R^{3}} \\cdot \\frac{a^{4}}{4} = \\frac{a^{4}}{32 R^{3}}.\n$$\n使用 $a \\approx L/2$，这得到\n$$\n\\delta_{\\max}^{\\text{LST}} \\sim \\frac{(L/2)^{4}}{32 R^{3}} = \\frac{L^{4}}{512 R^{3}} \\quad \\text{当 } \\frac{L}{R} \\to 0.\n$$\n\n总结：\n- CST: $\\delta_{\\max}^{\\text{CST}} \\sim \\dfrac{L^{2}}{8 R}$.\n- LST: $\\delta_{\\max}^{\\text{LST}} \\sim \\dfrac{L^{4}}{512 R^{3}}$.\n\n逐个选项分析：\n- 选项 A 表明 CST: $\\delta_{\\max} \\sim \\dfrac{L^{2}}{8 R}$ 且 LST: $\\delta_{\\max} \\sim \\dfrac{L^{4}}{512 R^{3}}$，这与推导结果相符。正确。\n- 选项 B 给出了正确的 CST 领头项，但 LST 的缩放关系为 $\\sim \\dfrac{L^{3}}{96 R^{2}}$，这与偶对称性和泰勒分析不一致；对于圆形边界，领头的 LST 几何误差是关于 $L$ 的四次方，并与 $R^{-3}$ 成正比，而不是关于 $L$ 的三次方。不正确。\n- 选项 C 将 CST 的常数更改为 $\\dfrac{1}{12}$，这与推导出弦高结果为 $\\dfrac{1}{8}$ 相矛盾；虽然 LST 的常数是正确的，但 CST 部分是错误的。不正确。\n- 选项 D 保留了 CST 的常数，但将 LST 的常数更改为 $\\dfrac{1}{128}$，这与最大化结果给出 $\\dfrac{1}{512}$ 相矛盾。不正确。\n\n因此，正确的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "3569095"}, {"introduction": "构建单元对全局模型贡献的最后一步是计算其刚度矩阵，这需要进行积分。该积分通常是数值完成的，而积分规则的选择并非无足轻重。本练习探讨了数值积分、秩亏和稳定性等关键概念，研究了当一个单元被“减缩积分”（即使用过少的积分点）时会发生什么。通过这个练习 [@problem_id:3569129]，您将学会区分简单的精度损失和可能导致仿真结果毫无意义的灾难性“伪零能模式”。对于高级有限元分析和正确解读商业软件的结果而言，理解这些概念至关重要。", "problem": "考虑一个用于计算岩土力学中小应变平面应力问题的二维、均质、各向同性的三角形有限元，该单元为线性应变三角形 (LST) 类型，具有 $n=6$ 个节点，每个节点有 $2$ 个位移自由度。该单元的位移场由面积（重心）坐标中的二次多项式插值，相应的应变场是位移的对称梯度。材料由杨氏模量 $E$ 和泊松比 $\\nu$ 表征，并组装成用于平面应力的 $3\\times 3$ 弹性矩阵 $\\mathbf{D}$。一致单元刚度矩阵由域积分定义\n$$\n\\mathbf{K}_e=\\int_{\\Omega_e} \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x})\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{B}(\\mathbf{x})$ 是从二次形函数的导数中获得的应变-位移矩阵。\n\n你需要从第一性原理出发，推理 (i) $\\mathbf{K}_e$ 中被积函数的多项式次数，(ii) 为无积分误差地计算 $\\mathbf{K}_e$ 所需的三角形数值积分的精确性要求，以及 (iii) 降阶积分刚度矩阵的秩性质。特别地，考虑一个具有正权重 $w_j0$ 和不同内部点 $\\mathbf{x}_j\\in\\Omega_e$ 的通用 $m$ 点三角形积分，它产生如下近似\n$$\n\\widetilde{\\mathbf{K}}_e=\\sum_{j=1}^{m} w_j\\,\\mathbf{B}(\\mathbf{x}_j)^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x}_j).\n$$\n假设 $\\mathbf{D}$ 是正定的，且三角形是非退化的。$\\mathbf{K}_e$ 的物理上正确的零空间恰好包含 $k=3$ 种刚体模态（两个平移和一个平面内旋转），因此精确的 $\\mathbf{K}_e$ 是半正定的，秩为 $r_\\text{phys}=2n-k=12-3=9$。\n\n以下哪些陈述是正确的？\n\nA. 对于 LST 单元，被积函数 $\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$ 在空间坐标上是二次的，因此任何对二次及以下多项式精确的三角形积分方案都能得到秩为 9 的精确 $\\mathbf{K}_e$（即零空间中只有 3 种刚体模态）。\n\nB. 对于使用少于 3 个点（例如，$m=1$ 的形心法则）的降阶积分，$\\widetilde{\\mathbf{K}}_e$ 的秩必然严格小于 9，并且除了 3 种刚体模态外，还会表现出伪零能变形模态；其后果不仅仅是小的积分误差，而是内在的秩亏。\n\nC. 如果使用 3 个具有正权重的内部积分点，但积分方案在多项式上不精确（权重偏离了精确值），那么通常情况下 $\\widetilde{\\mathbf{K}}_e$ 会保持秩为 9（没有伪模态），而刚度系数会产生积分误差；这是一种良性的精度误差，而不是运动学约束表示的失败。\n\nD. 因为常应变三角形 (CST) 和线性应变三角形 (LST) 都在单元上产生常应变，所以单点积分对两者都是精确的；因此，对 LST 使用形心法则不会从根本上改变其秩或精度。\n\nE. 在近不可压缩岩土力学中，故意对 LST 使用单点降阶积分可以缓解体积锁定，且不会有出现伪零能模态的风险，因此这是一种安全且通常被推荐的保持稳定性的做法。\n\n选择所有适用项。", "solution": "用户希望我验证并解决一个关于 6 节点线性应变三角形 (LST) 有限元刚度矩阵性质的问题。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n- **单元类型**：一个二维、均质、各向同性的三角形有限元，属于线性应变三角形 (LST) 类型。\n- **节点数**：$n=6$ 个节点。\n- **自由度 (DOFs)**：每个节点 2 个位移自由度，总共 $2n=12$ 个自由度。\n- **分析类型**：小应变平面应力。\n- **位移场**：由二次多项式插值，$u(\\mathbf{x}) = \\sum_{i=1}^6 N_i(\\mathbf{x}) u_i$, $v(\\mathbf{x}) = \\sum_{i=1}^6 N_i(\\mathbf{x}) v_i$，其中 $N_i$ 是二次形函数。\n- **应变场**：位移场的对称梯度，$\\boldsymbol{\\epsilon} = \\mathbf{L}\\mathbf{u}$，其中 $\\mathbf{L}$ 是微分算子。这导致应变场在空间坐标上是线性的。\n- **材料性质**：由杨氏模量 $E$ 和泊松比 $\\nu$ 表征。用于平面应力的 $3 \\times 3$ 弹性矩阵 $\\mathbf{D}$ 是常数且正定的。\n- **应变-位移矩阵**：$\\mathbf{B}(\\mathbf{x})$ 是通过对二次形函数进行一次微分得到的，因此其元素是空间坐标 $\\mathbf{x}$ 的线性函数。\n- **精确刚度矩阵**：$\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x})\\,\\mathrm{d}\\Omega$。\n- **数值积分刚度矩阵**：$\\widetilde{\\mathbf{K}}_e = \\sum_{j=1}^{m} w_j\\,\\mathbf{B}(\\mathbf{x}_j)^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x}_j)$，有 $m$ 个点、正权重 $w_j0$ 和不同的内部点 $\\mathbf{x}_j$。\n- **假设**：三角形是非退化的。\n- **$\\mathbf{K}_e$ 的物理性质**：精确 $\\mathbf{K}_e$ 的零空间维度为 $k=3$，对应于刚体模态。秩为 $r_\\text{phys} = 2n-k = 12-3=9$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于线弹性有限元法 (FEM) 的标准且被广泛接受的理论。所有概念，包括 LST 单元、二次形函数、线性应变、刚度矩阵积分、数值积分、秩亏和伪模态，都是计算力学的基础。所描述的性质在事实上是正确的。\n- **适定性**：该问题是适定的。它提供了一个清晰而完整的设置，并要求基于此设置评估几个陈述。所给信息足以对每个陈述得出明确的结论。\n- **客观性**：语言精确、专业，没有歧义或主观性。所有术语都是该领域的标准术语。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。这是一个在计算力学领域中表述良好的问题。我现在将对每个选项进行详细的推导和评估。\n\n### **推导与选项分析**\n\n该问题涉及 6 节点 LST 单元的 $12 \\times 12$ 刚度矩阵 $\\mathbf{K}_e$。节点位移向量为 $\\mathbf{d} \\in \\mathbb{R}^{12}$。应变场由 $\\boldsymbol{\\epsilon}(\\mathbf{x}) = \\mathbf{B}(\\mathbf{x})\\mathbf{d}$ 给出。由于位移场是二次的，其导数是线性的。因此，$3 \\times 12$ 的应变-位移矩阵 $\\mathbf{B}(\\mathbf{x})$ 的元素是空间坐标 $(x, y)$ 的线性函数。\n\n刚度矩阵的被积函数是 $\\mathbf{B}(\\mathbf{x})^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x})$。由于 $\\mathbf{B}(\\mathbf{x})$ 的元素是 1 次多项式，而 $\\mathbf{D}$ 是常数矩阵，因此被积函数的元素是线性多项式的乘积，从而得到 2 次多项式。\n\n刚度矩阵的秩至关重要。$\\mathbf{K}_e$ 或 $\\widetilde{\\mathbf{K}}_e$ 的零空间由导致零应变能的节点位移向量 $\\mathbf{d}$ 组成。\n对于精确矩阵，$U_e = \\frac{1}{2}\\mathbf{d}^{\\mathsf{T}}\\mathbf{K}_e\\mathbf{d} = \\frac{1}{2}\\int_{\\Omega_e} (\\mathbf{B}\\mathbf{d})^{\\mathsf{T}}\\mathbf{D}(\\mathbf{B}\\mathbf{d})\\,\\mathrm{d}\\Omega = 0$。由于 $\\mathbf{D}$ 是正定的，这要求对于所有 $\\mathbf{x} \\in \\Omega_e$ 都有 $\\mathbf{B}(\\mathbf{x})\\mathbf{d} = \\mathbf{0}$。唯一能在任何地方都产生零应变的节点位移向量 $\\mathbf{d}$ 是三种刚体模态。因此，零空间的维度为 3，秩为 $12-3=9$。\n\n对于数值积分的矩阵，$U_e \\approx \\frac{1}{2}\\mathbf{d}^{\\mathsf{T}}\\widetilde{\\mathbf{K}}_e\\mathbf{d} = \\frac{1}{2}\\sum_{j=1}^{m} w_j (\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d})^{\\mathsf{T}}\\mathbf{D}(\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d}) = 0$。当 $w_j0$ 且 $\\mathbf{D}$ 是正定时，这要求对于所有积分点 $j=1, \\dots, m$ 都有 $\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d} = \\mathbf{0}$。\n\n让我们评估每个陈述。\n\n**A. 对于 LST 单元，被积函数 $\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$ 在空间坐标上是二次的，因此任何对二次及以下多项式精确的三角形积分方案都能得到秩为 9 的精确 $\\mathbf{K}_e$（即零空间中只有 3 种刚体模态）。**\n\n如上所述，$\\mathbf{B}(\\mathbf{x})$ 的元素是坐标的线性函数。被积函数 $\\mathbf{B}(\\mathbf{x})^{\\mathsf{T}}\\mathbf{D}\\,\\mathbf{B}(\\mathbf{x})$ 是一个 $12 \\times 12$ 的矩阵，其元素是二次多项式。为了精确计算一个二次多项式在三角形上的积分，数值积分方案必须对至少 2 次的多项式是精确的。标准的三角形积分法则，例如在边中点设置的 3 点法则，满足此条件。如果积分被精确执行，得到的刚度矩阵 $\\mathbf{K}_e$ 将具有正确的物理性质，包括一个由 3 种刚体模态构成的零空间。因此，其秩将为 $12 - 3 = 9$。该陈述与有限元理论完全一致。\n\n结论：**正确**。\n\n**B. 对于使用少于 3 个点（例如，$m=1$ 的形心法则）的降阶积分，$\\widetilde{\\mathbf{K}}_e$ 的秩必然严格小于 9，并且除了 3 种刚体模态外，还会表现出伪零能变形模态；其后果不仅仅是小的积分误差，而是内在的秩亏。**\n\n降阶积分意味着使用一个对其被积函数多项式次数而言不精确的积分法则。对于二次被积函数，任何少于 3 个点的法则通常都是降阶积分。\n让我们分析 $\\widetilde{\\mathbf{K}}_e$ 的零空间。如果对于所有的 $j=1, \\dots, m$ 都有 $\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d} = \\mathbf{0}$，则向量 $\\mathbf{d}$ 位于零空间中。\n每个条件 $\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d} = \\mathbf{0}$ 代表了关于 $\\mathbf{d}$ 的 12 个分量的 3 个线性方程（因为 $\\mathbf{B}$ 是 $3 \\times 12$ 矩阵）。\n- 如果 $m=1$（例如，形心法则），我们有 3 个方程。对于非退化单元，矩阵 $\\mathbf{B}(\\mathbf{x}_1)$ 的秩为 3。根据秩-零度定理，$\\mathbf{B}(\\mathbf{x}_1)$ 零空间的维度是 $12 - \\text{rank}(\\mathbf{B}(\\mathbf{x}_1)) = 12 - 3 = 9$。$\\widetilde{\\mathbf{K}}_e$ 的秩是 $12 - 9 = 3$。由于 $3  9$，该矩阵是秩亏的。零空间的维度是 9，比 3 种物理刚体模态多出 6 种。这 6 种额外的模态是伪零能模态，不具有物理意义。\n- 如果 $m=2$，我们有 6 个方程，由堆叠矩阵 $\\begin{pmatrix} \\mathbf{B}(\\mathbf{x}_1) \\\\ \\mathbf{B}(\\mathbf{x}_2) \\end{pmatrix}\\mathbf{d} = \\mathbf{0}$ 给出。对于非退化三角形中的不同点，这个 $6 \\times 12$ 的矩阵秩为 6。零空间的维度是 $12 - 6 = 6$。$\\widetilde{\\mathbf{K}}_e$ 的秩是 $12-6=6$。这也严格小于 9，并且存在 $6-3=3$ 种伪模态。\n在这两种情况（$m=1, 2$）下，秩都严格小于 9，并且引入了伪模态。这是一个根本性的“秩亏”，而不仅仅是微小的误差。\n\n结论：**正确**。\n\n**C. 如果使用 3 个具有正权重的内部积分点，但积分方案在多项式上不精确（权重偏离了精确值），那么通常情况下 $\\widetilde{\\mathbf{K}}_e$ 会保持秩为 9（没有伪模态），而刚度系数会产生积分误差；这是一种良性的精度误差，而不是运动学约束表示的失败。**\n\n$\\widetilde{\\mathbf{K}}_e$ 的零空间是由积分*点* $\\mathbf{x}_j$ 的集合决定的，而不是由*权重* $w_j$ 决定（只要 $w_j0$）。向量 $\\mathbf{d}$ 位于零空间的条件是对于 $j=1, 2, 3$ 都有 $\\mathbf{B}(\\mathbf{x}_j)\\mathbf{d} = \\mathbf{0}$。这是一个包含 $3 \\times 3 = 9$ 个线性方程和 12 个未知数的方程组。该方程组的矩阵是由 $\\mathbf{B}(\\mathbf{x}_1)$、$\\mathbf{B}(\\mathbf{x}_2)$ 和 $\\mathbf{B}(\\mathbf{x}_3)$ 堆叠而成的 $9 \\times 12$ 矩阵。对于足以积分二次函数的 3 点法则，积分点通常选择在边的中点或中点三角形的中点。对于任何 3 个不共线的点，该矩阵的 9 行是线性无关的。因此，系统矩阵的秩为 9。零空间的维度是 $12 - 9 = 3$。这三种模态是刚体模态，它们在所有点（包括积分点）上都产生零应变。因此，$\\widetilde{\\mathbf{K}}_e$ 的零空间维度为 3，秩为 9。没有伪模态。然而，如果权重 $w_j$ 不是二次精确积分法则的正确权重，积分将只是近似的，$\\widetilde{\\mathbf{K}}_e$ 的元素将与精确的 $\\mathbf{K}_e$ 相比存在一些误差。这是一个精度问题，而不是稳定性（秩）问题。\n\n结论：**正确**。\n\n**D. 因为常应变三角形 (CST) 和线性应变三角形 (LST) 都在单元上产生常应变，所以单点积分对两者都是精确的；因此，对 LST 使用形心法则不会从根本上改变其秩或精度。**\n\n这个陈述建立在一个错误的前提之上。常应变三角形（CST，3 节点，线性位移）具有常数应变场。线性应变三角形（LST，6 节点，二次位移）具有线性应变场，而不是常数。因为 LST 的应变场是线性的，其刚度矩阵的被积函数 $\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$ 是二次的。单点积分（例如，在形心处）仅对线性（或常数）被积函数是精确的。它对二次被积函数不精确。如在对陈述 B 的分析中所示，对 LST 单元使用单点积分会导致严重的秩亏（秩从 9 降至 3）并引入 6 种伪零能模态。这是一个灾难性的失败，从根本上改变了秩和稳定性。\n\n结论：**不正确**。\n\n**E. 在近不可压缩岩土力学中，故意对 LST 使用单点降阶积分可以缓解体积锁定，且不会有出现伪零能模态的风险，因此这是一种安全且通常被推荐的保持稳定性的做法。**\n\n虽然降阶积分是一种用于缓解近不可压缩材料中体积锁定的技术，但该陈述关于安全性和稳定性的说法是错误的。如在对陈述 B 的分析中所示，LST 单元的单点积分会引入 6 种伪零能模态。这些模态，通常称为“沙漏模态”，可以在单元网格中传播，导致全局刚度矩阵奇异或病态，并产生无意义的、振荡的位移场。这些伪模态的存在使单元运动学上不稳定。因此，尽管它可能缓解锁定，但它是以牺牲稳定性为代价的，这使得它对于这种单元类型成为一种不安全且不被推荐的做法。需要特定的沙漏控制方案来稳定单元，但该陈述声称可以“不会冒着”出现这些模态的风险，这是错误的。\n\n结论：**不正确**。", "answer": "$$\\boxed{ABC}$$", "id": "3569129"}]}