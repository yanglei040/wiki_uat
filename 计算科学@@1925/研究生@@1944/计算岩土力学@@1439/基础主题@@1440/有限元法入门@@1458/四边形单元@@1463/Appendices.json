{"hands_on_practices": [{"introduction": "有限元方法的核心在于使用离散的节点值来近似连续的场。这个练习提供了使用四节点（Q4）和八节点（Q8）等参单元的形函数来插值单元内任意点位移场的基础实践。这是所有后续计算的基石，掌握它将帮助你理解场变量在单元内部是如何被表示的。[@problem_id:3553756]", "problem": "考虑一个通过有限元法（FEM）分析的平面应变土体域中的等参四边形有限元。在自然坐标系 $(\\xi,\\eta)$ 中（其中 $\\xi,\\eta \\in [-1,1]$），对于四节点双线性四边形（Q4）和八节点赛伦迪普四边形（Q8）单元，采用以下标准节点位置：\n- 角节点：节点 $1:(-1,-1)$，节点 $2:(1,-1)$，节点 $3:(1,1)$，节点 $4:(-1,1)$。\n- Q8 的边中节点：节点 $5:(0,-1)$，节点 $6:(1,0)$，节点 $7:(0,1)$，节点 $8:(-1,0)$。\n位移场通过标准等参方法从节点自由度插值得到。设节点位移分量 $(u_{x,i},u_{y,i})$ 以毫米为单位，规定如下：\n- 节点 $1$：$u_{x,1} = 2.10$， $u_{y,1} = -1.88$。\n- 节点 $2$：$u_{x,2} = 2.40$， $u_{y,2} = -0.68$。\n- 节点 $3$：$u_{x,3} = 2.30$， $u_{y,3} = -0.08$。\n- 节点 $4$：$u_{x,4} = 1.40$， $u_{y,4} = -0.88$。\n- 节点 $5$：$u_{x,5} = 2.15$， $u_{y,5} = -1.33$。\n- 节点 $6$：$u_{x,6} = 2.40$， $u_{y,6} = -0.45$。\n- 节点 $7$：$u_{x,7} = 1.75$， $u_{y,7} = -0.53$。\n- 节点 $8$：$u_{x,8} = 1.80$， $u_{y,8} = -1.45$。\n在计算点 $(\\xi,\\eta) = (0.25,-0.5)$ 处：\n- 利用 Lagrange 插值的定义属性和等参概念，首先确定 Q4 和 Q8 单元在给定点的形函数 $N_i(\\xi,\\eta)$。\n- 然后分别使用 Q4 和 Q8 插值计算插值得到的位移分量 $u_x(\\xi,\\eta)$ 和 $u_y(\\xi,\\eta)$。\n提供四个量 $u_x^{\\mathrm{Q4}}$、$u_y^{\\mathrm{Q4}}$、$u_x^{\\mathrm{Q8}}$、$u_y^{\\mathrm{Q8}}$ 的最终数值，四舍五入到五位有效数字，并以毫米表示位移。按 $(u_x^{\\mathrm{Q4}}, u_y^{\\mathrm{Q4}}, u_x^{\\mathrm{Q8}}, u_y^{\\mathrm{Q8}})$ 的顺序报告这四个值。", "solution": "场变量的等参有限元插值是基于在指定了节点的自然方形域上定义的 Lagrange 形函数构建的。对于四边形单元，位移矢量场 $\\mathbf{u}(\\xi,\\eta)$ 通过形函数插值为节点值的凸组合，这些形函数满足克罗内克-德尔塔性质 $N_i(\\xi_j,\\eta_j) = \\delta_{ij}$ 和单位分解性质 $\\sum_i N_i(\\xi,\\eta) = 1$。我们使用这些基本性质来构建和计算 $N_i(\\xi,\\eta)$，然后插值位移分量。\n\n对于四节点双线性四边形（Q4），每个参数坐标上的 Lagrange 基是线性的，通过张量积构造可得\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n在 $(\\xi,\\eta) = (0.25,-0.5)$ 处计算这些值：\n$$\n1-\\xi = 0.75, \\quad 1+\\xi = 1.25, \\quad 1-\\eta = 1.5, \\quad 1+\\eta = 0.5,\n$$\n因此\n$$\nN_1 = \\frac{1}{4}(0.75)(1.5) = 0.28125, \\quad\nN_2 = \\frac{1}{4}(1.25)(1.5) = 0.46875, \\quad\nN_3 = \\frac{1}{4}(1.25)(0.5) = 0.15625, \\quad\nN_4 = \\frac{1}{4}(0.75)(0.5) = 0.09375,\n$$\n且 $\\sum_{i=1}^{4} N_i = 1.0$ 符合要求。\n\nQ4 的插值位移分量由等参插值得到：\n$$\nu_x^{\\mathrm{Q4}}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,u_{x,i}, \\quad\nu_y^{\\mathrm{Q4}}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,u_{y,i}.\n$$\n计算 $u_x^{\\mathrm{Q4}}$：\n$$\nu_x^{\\mathrm{Q4}} = (0.28125)(2.10) + (0.46875)(2.40) + (0.15625)(2.30) + (0.09375)(1.40).\n$$\n逐项：\n$$\n(0.28125)(2.10) = 0.590625, \\quad\n(0.46875)(2.40) = 1.125, \\quad\n(0.15625)(2.30) = 0.359375, \\quad\n(0.09375)(1.40) = 0.13125,\n$$\n因此\n$$\nu_x^{\\mathrm{Q4}} = 0.590625 + 1.125 + 0.359375 + 0.13125 = 2.20625.\n$$\n计算 $u_y^{\\mathrm{Q4}}$：\n$$\nu_y^{\\mathrm{Q4}} = (0.28125)(-1.88) + (0.46875)(-0.68) + (0.15625)(-0.08) + (0.09375)(-0.88).\n$$\n逐项：\n$$\n(0.28125)(-1.88) = -0.52875, \\quad\n(0.46875)(-0.68) = -0.31875, \\quad\n(0.15625)(-0.08) = -0.0125, \\quad\n(0.09375)(-0.88) = -0.0825,\n$$\n因此\n$$\nu_y^{\\mathrm{Q4}} = -0.52875 - 0.31875 - 0.0125 - 0.0825 = -0.9425.\n$$\n\n对于八节点赛伦迪普四边形（Q8），角节点形函数被构造成关于 $\\xi$ 和 $\\eta$ 的二次函数，同时保持节点插值性和单位分解性；边中节点的形函数在其对应边之外为零，并能再现边上的二次变化。一组标准的形函数为：\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)(-\\,\\xi - \\eta - 1), \\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(\\xi - \\eta - 1),\n$$\n$$\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(\\xi + \\eta - 1), \\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)(-\\,\\xi + \\eta - 1),\n$$\n$$\nN_5(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^{2})(1-\\eta), \\quad\nN_6(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta^{2}),\n$$\n$$\nN_7(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^{2})(1+\\eta), \\quad\nN_8(\\xi,\\eta) = \\frac{1}{2}(1-\\xi)(1-\\eta^{2}).\n$$\n在 $(\\xi,\\eta) = (0.25,-0.5)$ 处计算：\n首先计算辅助量：\n$$\n1-\\xi = 0.75, \\quad 1+\\xi = 1.25, \\quad 1-\\eta = 1.5, \\quad 1+\\eta = 0.5,\n$$\n$$\n\\xi^{2} = 0.0625, \\quad \\eta^{2} = 0.25, \\quad 1-\\xi^{2} = 0.9375, \\quad 1-\\eta^{2} = 0.75,\n$$\n和\n$$\n-\\,\\xi - \\eta - 1 = -0.25 + 0.5 - 1 = -0.75, \\quad\n\\xi - \\eta - 1 = 0.25 + 0.5 - 1 = -0.25,\n$$\n$$\n\\xi + \\eta - 1 = 0.25 - 0.5 - 1 = -1.25, \\quad\n-\\,\\xi + \\eta - 1 = -0.25 - 0.5 - 1 = -1.75.\n$$\n因此\n$$\nN_1 = \\frac{1}{4}(0.75)(1.5)(-0.75) = -0.2109375, \\quad\nN_2 = \\frac{1}{4}(1.25)(1.5)(-0.25) = -0.1171875,\n$$\n$$\nN_3 = \\frac{1}{4}(1.25)(0.5)(-1.25) = -0.1953125, \\quad\nN_4 = \\frac{1}{4}(0.75)(0.5)(-1.75) = -0.1640625,\n$$\n$$\nN_5 = \\frac{1}{2}(0.9375)(1.5) = 0.703125, \\quad\nN_6 = \\frac{1}{2}(1.25)(0.75) = 0.46875,\n$$\n$$\nN_7 = \\frac{1}{2}(0.9375)(0.5) = 0.234375, \\quad\nN_8 = \\frac{1}{2}(0.75)(0.75) = 0.28125,\n$$\n且 $\\sum_{i=1}^{8} N_i = 1.0$。\n\n插值位移分量：\n$$\nu_x^{\\mathrm{Q8}}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,u_{x,i}, \\quad\nu_y^{\\mathrm{Q8}}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,u_{y,i}.\n$$\n逐项计算 $u_x^{\\mathrm{Q8}}$：\n$$\n(-0.2109375)(2.10) = -0.44296875, \\quad\n(-0.1171875)(2.40) = -0.28125, \\quad\n(-0.1953125)(2.30) = -0.44921875, \\quad\n(-0.1640625)(1.40) = -0.2296875,\n$$\n$$\n(0.703125)(2.15) = 1.51171875, \\quad\n(0.46875)(2.40) = 1.125, \\quad\n(0.234375)(1.75) = 0.41015625, \\quad\n(0.28125)(1.80) = 0.50625,\n$$\n求和可得\n$$\nu_x^{\\mathrm{Q8}} = \\big(-0.44296875 - 0.28125 - 0.44921875 - 0.2296875\\big) + \\big(1.51171875 + 1.125 + 0.41015625 + 0.50625\\big) = 2.15.\n$$\n逐项计算 $u_y^{\\mathrm{Q8}}$：\n$$\n(-0.2109375)(-1.88) = 0.3965625, \\quad\n(-0.1171875)(-0.68) = 0.0796875, \\quad\n(-0.1953125)(-0.08) = 0.015625, \\quad\n(-0.1640625)(-0.88) = 0.144375,\n$$\n$$\n(0.703125)(-1.33) = -0.93515625, \\quad\n(0.46875)(-0.45) = -0.2109375, \\quad\n(0.234375)(-0.53) = -0.12421875, \\quad\n(0.28125)(-1.45) = -0.4078125,\n$$\n求和可得\n$$\nu_y^{\\mathrm{Q8}} = \\big(0.3965625 + 0.0796875 + 0.015625 + 0.144375\\big) + \\big(-0.93515625 - 0.2109375 - 0.12421875 - 0.4078125\\big) = -1.041875.\n$$\n\n最后，将每个值四舍五入到五位有效数字，并以毫米表示：\n$$\nu_x^{\\mathrm{Q4}} = 2.20625 \\to 2.2063, \\quad\nu_y^{\\mathrm{Q4}} = -0.9425 \\to -0.94250,\n$$\n$$\nu_x^{\\mathrm{Q8}} = 2.15 \\to 2.1500, \\quad\nu_y^{\\mathrm{Q8}} = -1.041875 \\to -1.0419.\n$$\n按 $(u_x^{\\mathrm{Q4}}, u_y^{\\mathrm{Q4}}, u_x^{\\mathrm{Q8}}, u_y^{\\mathrm{Q8}})$ 的顺序报告这四个值。", "answer": "$$\\boxed{\\begin{pmatrix}2.2063  -0.94250  2.1500  -1.0419\\end{pmatrix}}$$", "id": "3553756"}, {"introduction": "在学会插值位移之后，下一个逻辑步骤是将这些位移与力联系起来。这个练习将演示如何计算单元刚度矩阵（$K_e$），它代表了这种力-位移关系。你将应用形函数、雅可比矩阵以及数值积分（特别是 $2 \\times 2$ 的高斯积分）的知识来组装有限元分析中的关键部分。[@problem_id:3553827]", "problem": "在有限元法 (FEM) 中，一个四节点双线性四边形单元 ($\\text{Q4}$) 被用来模拟一个土层的平面应变线性弹性问题。该单元的节点坐标（单位为米）为 $ (x_1,y_1)=(0,0)$、$(x_2,y_2)=(2,0)$、$(x_3,y_3)=(2,1)$ 和 $(x_4,y_4)=(0,1)$，具有恒定厚度 $t=1\\,\\text{m}$。土壤是均质且各向同性的，其杨氏模量 $E=60\\,\\text{MPa}$，泊松比 $\\nu=0.25$。在父域 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 上使用 $2\\times 2$ 高斯积分（标准高斯点位于 $\\xi,\\eta=\\pm 1/\\sqrt{3}$，每个点的权重为1）。\n\n从单元刚度矩阵的定义出发\n$$\n\\mathbf{K}_{e}=\\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}(\\xi,\\eta)^{\\top}\\, \\mathbf{D} \\, \\mathbf{B}(\\xi,\\eta)\\, t \\, \\det \\mathbf{J}(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\mathbf{B}$ 是 $\\text{Q4}$ 单元的应变-位移矩阵，$\\mathbf{D}$ 是平面应变各向同性本构矩阵，$\\mathbf{J}$ 是等参映射的雅可比矩阵，执行 $2\\times 2$ 高斯求积来为该单元组装 $\\mathbf{K}_e$。\n\n假设规范自由度排序为 $\\{u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4\\}$，其中 $u_i$ 和 $v_i$ 分别是节点在 $x$ 和 $y$ 方向上的位移。计算出刚度矩阵后，报告单个矩阵元 $K_{11}$（即对应于 $u_1$ 与 $u_1$ 耦合的 $(1,1)$ 元）。以 $\\text{N}/\\text{m}$ 为单位表示您的最终数值答案，并将答案四舍五入到四位有效数字。", "solution": "对用户提供的问题进行了严格评估，并确认其有效。该问题科学地基于计算固体力学的原理，特别是针对线性弹性的有限元法 (FEM)。问题是适定的，提供了所有必要的数据（单元几何形状、材料属性、积分方案），并且没有矛盾或歧义。它代表了该领域一个标准的可解练习。因此，我们可以着手求解。\n\n单个单元的刚度矩阵 $\\mathbf{K}_e$ 由在父单元域 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$ 上的积分给出：\n$$\n\\mathbf{K}_{e}=\\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}(\\xi,\\eta)^{\\top}\\, \\mathbf{D} \\, \\mathbf{B}(\\xi,\\eta)\\, t \\, \\det \\mathbf{J}(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n该积分将使用 $2 \\times 2$ 高斯求积进行数值计算。数值积分的公式是：\n$$\n\\mathbf{K}_{e} \\approx t \\sum_{k=1}^{4} \\mathbf{B}(\\xi_k,\\eta_k)^{\\top}\\, \\mathbf{D} \\, \\mathbf{B}(\\xi_k,\\eta_k) \\, \\det \\mathbf{J}(\\xi_k,\\eta_k)\\, W_k\n$$\n其中四个高斯点为 $(\\xi_k, \\eta_k)$，对于 $k \\in \\{1,2,3,4\\}$，坐标为 $(\\pm a, \\pm a)$，其中 $a=1/\\sqrt{3}$，所有点的权重为 $W_k=1$。单元厚度给定为 $t=1\\,\\text{m}$。\n\n我们需要找到特定的矩阵元 $K_{11}$，它对应于自由度 $u_1$（节点1的 $x$ 方向位移）。该矩阵元由下式给出：\n$$\nK_{11} \\approx t \\sum_{k=1}^{4} \\left( \\mathbf{B}(\\xi_k,\\eta_k)^{\\top}\\, \\mathbf{D} \\, \\mathbf{B}(\\xi_k,\\eta_k) \\right)_{11} \\det \\mathbf{J}(\\xi_k,\\eta_k)\n$$\n\n计算过程分为几个步骤：\n1.  **等参映射与雅可比矩阵：**\n4节点双线性四边形单元的形函数为：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n使用这些形函数和节点坐标 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(2,0)$、$(x_3,y_3)=(2,1)$ 和 $(x_4,y_4)=(0,1)$，将全局坐标 $(x,y)$ 从父坐标 $(\\xi,\\eta)$ 映射过来：\n$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i = 0 \\cdot N_1 + 2 \\cdot N_2 + 2 \\cdot N_3 + 0 \\cdot N_4 = \\frac{2}{4}(1+\\xi)(1-\\eta) + \\frac{2}{4}(1+\\xi)(1+\\eta) = \\frac{1}{2}(1+\\xi)[(1-\\eta)+(1+\\eta)] = 1+\\xi$\n$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i = 0 \\cdot N_1 + 0 \\cdot N_2 + 1 \\cdot N_3 + 1 \\cdot N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)$\n\n此变换的雅可比矩阵 $\\mathbf{J}$ 是：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n$$\n雅可比矩阵在整个单元上是常数。其行列式为 $\\det \\mathbf{J} = (1)(\\frac{1}{2}) - (0)(0) = \\frac{1}{2}$。逆雅可比矩阵为 $\\mathbf{J}^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$。\n\n2.  **本构矩阵 $\\mathbf{D}$：**\n对于平面应变，各向同性本构矩阵是：\n$$\n\\mathbf{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix} 1-\\nu  \\nu  0 \\\\ \\nu  1-\\nu  0 \\\\ 0  0  \\frac{1-2\\nu}{2} \\end{pmatrix}\n$$\n给定 $E=60\\,\\text{MPa} = 60 \\times 10^6\\,\\text{Pa}$ 和 $\\nu=0.25$：\n前置因子为 $\\frac{60 \\times 10^6}{(1+0.25)(1-2 \\cdot 0.25)} = \\frac{60 \\times 10^6}{(1.25)(0.5)} = 96 \\times 10^6\\,\\text{Pa}$。\n$$\n\\mathbf{D} = 96 \\times 10^6 \\begin{pmatrix} 0.75  0.25  0 \\\\ 0.25  0.75  0 \\\\ 0  0  0.25 \\end{pmatrix} = \\begin{pmatrix} 72 \\times 10^6  24 \\times 10^6  0 \\\\ 24 \\times 10^6  72 \\times 10^6  0 \\\\ 0  0  24 \\times 10^6 \\end{pmatrix} \\,\\text{Pa}\n$$\n所以，$D_{11} = 72 \\times 10^6\\,\\text{Pa}$ 且 $D_{33} = 24 \\times 10^6\\,\\text{Pa}$。\n\n3.  **应变-位移矩阵 $\\mathbf{B}$：**\n应变向量 $\\boldsymbol{\\epsilon} = \\{\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}\\}^T$ 通过 $\\boldsymbol{\\epsilon} = \\mathbf{B}\\boldsymbol{d}$ 与节点位移向量 $\\boldsymbol{d}$ 相关联。矩阵 $\\mathbf{B}$ 由块 $\\mathbf{B}_i$ 组成：\n$\\mathbf{B}_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}$。\n项 $(\\mathbf{B}^\\top \\mathbf{D} \\mathbf{B})_{11}$ 对应于 $u_1$ 的耦合，因此我们只需要完整 $\\mathbf{B}$ 矩阵的第一列。这一列对应于 $\\mathbf{B}_1$ 的第一列。我们将完整 $\\mathbf{B}$ 矩阵的第一列称为 $\\mathbf{b}_1$。\n$\\mathbf{b}_1 = \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix}$。\n$N_1$ 的空间导数可以通过逆雅可比矩阵求得：\n$\\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-T} \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{Bmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{Bmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{Bmatrix} = \\begin{Bmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{2}(1-\\xi) \\end{Bmatrix}$。\n\n被积矩阵的 $(1,1)$ 分量是 $\\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1$：\n$$\n\\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1 = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} \\mathbf{D} \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = D_{11} \\left(\\frac{\\partial N_1}{\\partial x}\\right)^2 + D_{33} \\left(\\frac{\\partial N_1}{\\partial y}\\right)^2\n$$\n代入导数：\n$$\n\\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1 = D_{11} \\left(\\frac{-(1-\\eta)}{4}\\right)^2 + D_{33} \\left(\\frac{-(1-\\xi)}{2}\\right)^2 = \\frac{(1-\\eta)^2}{16}D_{11} + \\frac{(1-\\xi)^2}{4}D_{33}\n$$\n\n4.  **数值积分：**\n我们将此表达式在四个高斯点 $(\\xi_k, \\eta_k) = (\\pm a, \\pm a)$（其中 $a=1/\\sqrt{3}$）上求和。\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1 = \\sum_{k=1}^{4} \\left( \\frac{(1-\\eta_k)^2}{16}D_{11} + \\frac{(1-\\xi_k)^2}{4}D_{33} \\right) = \\frac{D_{11}}{16}\\sum_{k=1}^{4}(1-\\eta_k)^2 + \\frac{D_{33}}{4}\\sum_{k=1}^{4}(1-\\xi_k)^2\n$$\n我们来计算这些和。由于对称性：\n$\\sum_{k=1}^{4}(1-\\eta_k)^2 = (1-(-a))^2 + (1-(-a))^2 + (1-a)^2 + (1-a)^2 = 2(1+a)^2+2(1-a)^2 = 2(1+2a+a^2) + 2(1-2a+a^2) = 4(1+a^2)$.\n当 $a^2 = (1/\\sqrt{3})^2 = 1/3$ 时，和为 $4(1+1/3) = 4(4/3) = 16/3$。\n和 $\\sum(1-\\xi_k)^2$ 也为 $16/3$。\n将这些和代回：\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1 = \\frac{D_{11}}{16}\\left(\\frac{16}{3}\\right) + \\frac{D_{33}}{4}\\left(\\frac{16}{3}\\right) = \\frac{D_{11}}{3} + \\frac{4D_{33}}{3}\n$$\n代入 $D_{11}$ 和 $D_{33}$ 的值：\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1 = \\frac{72 \\times 10^6}{3} + \\frac{4 \\times (24 \\times 10^6)}{3} = \\frac{(72 + 96) \\times 10^6}{3} = \\frac{168 \\times 10^6}{3} = 56 \\times 10^6\\,\\text{Pa}\n$$\n\n5.  **$K_{11}$ 的最终计算：**\n最后，我们组装 $K_{11}$：\n$$\nK_{11} \\approx t \\cdot \\det \\mathbf{J} \\cdot \\sum_{k=1}^{4} (\\mathbf{b}_1^\\top \\mathbf{D} \\mathbf{b}_1)(\\xi_k, \\eta_k) W_k\n$$\n在 $t=1\\,\\text{m}$、$\\det \\mathbf{J} = 1/2$ 且所有 $W_k=1$ 的条件下：\n$$\nK_{11} = (1) \\cdot \\left(\\frac{1}{2}\\right) \\cdot (56 \\times 10^6) = 28 \\times 10^6\\,\\text{N/m}\n$$\n这个计算是精确的，因为 $2 \\times 2$ 高斯求积能精确地积分最高3次的多项式，而我们的被积函数是2次的。结果是 $K_{11} = 28,000,000\\,\\text{N/m}$。\n问题要求答案四舍五入到四位有效数字。即为 $2.800 \\times 10^7\\,\\text{N/m}$。\n*Note: A small correction in the solution logic regarding derivative computation: the chain rule for derivatives is $\\left\\{\\frac{\\partial N}{\\partial x}, \\frac{\\partial N}{\\partial y}\\right\\}^T = \\mathbf{J}^{-T} \\left\\{\\frac{\\partial N}{\\partial \\xi}, \\frac{\\partial N}{\\partial \\eta}\\right\\}^T$. With the given $\\mathbf{J}$, $\\mathbf{J}^{-T} = (\\mathbf{J}^{-1})^T = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}^T = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$. The original solution used $\\mathbf{J}^{-1}$ but since it was a diagonal matrix, the result was the same. The logic has been adjusted to use the correct $\\mathbf{J}^{-T}$ formula.*", "answer": "$$\n\\boxed{2.800 \\times 10^7}\n$$", "id": "3553827"}, {"introduction": "有限元解的准确性在很大程度上取决于网格的质量。这项实践将带你进入有限元分析中一个关键的实用领域：评估单元畸变。你将学习计算基于雅可比矩阵的度量指标，这些指标可以量化单元偏离理想形状的程度，并预测误差放大的可能性，这是进行可靠计算建模的一项至关重要的技能。[@problem_id:3553815]", "problem": "在平面应变计算岩土力学中，考虑一个节点逆时针排序的四节点等参四边形（Q4）单元，其物理坐标由下式给出\n- 节点 $1$：$(x_{1},y_{1}) = (0,0)$，\n- 节点 $2$：$(x_{2},y_{2}) = (3.2,0.1)$，\n- 节点 $3$：$(x_{3},y_{3}) = (2.8,2.5)$，\n- 节点 $4$：$(x_{4},y_{4}) = (-0.3,1.8)$。\n从母坐标 $(\\xi,\\eta)\\in[-1,1]^{2}$ 出发的等参映射使用四节点四边形（Q4）的标准双线性形函数 $N_{i}(\\xi,\\eta)$，雅可比矩阵定义为\n$$\n\\mathbf{J}(\\xi,\\eta) \\equiv\n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\\n\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix},\n\\quad\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i},\\quad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\n使用标准 $2\\times 2$ 高斯网格，其中 $(\\xi,\\eta)\\in\\{(\\pm g,\\pm g)\\}$，$g\\equiv 1/\\sqrt{3}$。将高斯网格上的基于雅可比的质量度量定义为\n$$\nq_{J} \\equiv \\frac{\\min\\limits_{(\\xi,\\eta)} \\det \\mathbf{J}(\\xi,\\eta)}{\\max\\limits_{(\\xi,\\eta)} \\det \\mathbf{J}(\\xi,\\eta)}.\n$$\n为预测畸变引起的刚度计算误差放大，使用该映射所隐含的应变-位移缩放。具体而言，定义标量场\n$$\nT(\\xi,\\eta) \\equiv \\|\\mathbf{J}^{-1}(\\xi,\\eta)\\|_{F}^{2}\\,\\det \\mathbf{J}(\\xi,\\eta) \\;=\\; \\operatorname{tr}\\!\\big(\\mathbf{J}(\\xi,\\eta)^{-T}\\mathbf{J}(\\xi,\\eta)^{-1}\\big)\\,\\det \\mathbf{J}(\\xi,\\eta),\n$$\n并将放大因子取为高斯网格上的比值\n$$\nA \\equiv \\frac{\\max\\limits_{(\\xi,\\eta)} T(\\xi,\\eta)}{\\min\\limits_{(\\xi,\\eta)} T(\\xi,\\eta)}.\n$$\n计算给定单元的 $q_{J}$ 和 $A$。将最终答案以数对 $(q_{J},A)$ 的形式报告，四舍五入到四位有效数字。两个数均表示为无单位的无量纲值。", "solution": "用户提供了一个计算岩土力学问题，要求评估一个四节点等参四边形单元的两个质量度量。问题陈述已经过验证，被认为是科学上合理的、适定的、客观的和完整的。我现在将着手解答。\n\n问题的核心是从母单元（一个由 $(\\xi, \\eta) \\in [-1, 1]^2$ 定义的方形域）到 $(x, y)$ 平面中的物理单元的等参映射。该映射由下式给出：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n其中 $(x_i, y_i)$ 是四个节点的坐标，$N_i(\\xi, \\eta)$ 是Q4单元的双线性形函数：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n此变换的雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} J_{11}  J_{12} \\\\ J_{21}  J_{22} \\end{bmatrix}\n$$\n雅可比矩阵的分量通过对映射方程求导得到：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i, \\quad \\text{etc.}\n$$\n形函数的导数是：\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta) \\\\\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n\\end{aligned}\n$$\n使用节点坐标 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(3.2,0.1)$、$(x_3,y_3)=(2.8,2.5)$ 和 $(x_4,y_4)=(-0.3,1.8)$，我们可以计算雅可比矩阵的分量：\n$$\n\\begin{aligned}\nJ_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4] \\\\\n= \\frac{1}{4} [ (1-\\eta)(x_2 - x_1) + (1+\\eta)(x_3 - x_4) ] \\\\\n= \\frac{1}{4} [ (1-\\eta)(3.2 - 0) + (1+\\eta)(2.8 - (-0.3)) ] = \\frac{1}{4}[3.2(1-\\eta) + 3.1(1+\\eta)] = \\frac{1}{4}(6.3 - 0.1\\eta) \\\\\nJ_{12} = \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} [ (1-\\eta)(y_2 - y_1) + (1+\\eta)(y_3 - y_4) ] \\\\\n= \\frac{1}{4} [ (1-\\eta)(0.1 - 0) + (1+\\eta)(2.5 - 1.8) ] = \\frac{1}{4}[0.1(1-\\eta) + 0.7(1+\\eta)] = \\frac{1}{4}(0.8 + 0.6\\eta) \\\\\nJ_{21} = \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} [ -(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4 ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(x_4 - x_1) + (1+\\xi)(x_3 - x_2) ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(-0.3 - 0) + (1+\\xi)(2.8 - 3.2) ] = \\frac{1}{4}[-0.3(1-\\xi) - 0.4(1+\\xi)] = \\frac{1}{4}(-0.7 - 0.1\\xi) \\\\\nJ_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} [ (1-\\xi)(y_4 - y_1) + (1+\\xi)(y_3 - y_2) ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(1.8 - 0) + (1+\\xi)(2.5 - 0.1) ] = \\frac{1}{4}[1.8(1-\\xi) + 2.4(1+\\xi)] = \\frac{1}{4}(4.2 + 0.6\\xi)\n\\end{aligned}\n$$\n雅可比矩阵的行列式是 $\\det \\mathbf{J} = J_{11}J_{22} - J_{12}J_{21}$。\n$$\n\\begin{aligned}\n\\det \\mathbf{J}(\\xi, \\eta) = \\frac{1}{16} [ (6.3 - 0.1\\eta)(4.2 + 0.6\\xi) - (0.8 + 0.6\\eta)(-0.7 - 0.1\\xi) ] \\\\\n= \\frac{1}{16} [ (26.46 + 3.78\\xi - 0.42\\eta - 0.06\\xi\\eta) - (-0.56 - 0.08\\xi - 0.42\\eta - 0.06\\xi\\eta) ] \\\\\n= \\frac{1}{16} [ 26.46 + 3.78\\xi - 0.42\\eta - 0.06\\xi\\eta + 0.56 + 0.08\\xi + 0.42\\eta + 0.06\\xi\\eta ] \\\\\n= \\frac{1}{16} (27.02 + 3.86\\xi)\n\\end{aligned}\n$$\n质量度量在 $2 \\times 2$ 高斯网格上进行评估，网格点为 $(\\xi, \\eta) \\in \\{ (\\pm g, \\pm g) \\}$，其中 $g = 1/\\sqrt{3}$。\n由于 $\\det \\mathbf{J}$ 仅依赖于 $\\xi$，因此在此网格上行列式有两个不同的值：\n$$\n\\det \\mathbf{J}(\\xi=g) = \\frac{1}{16}(27.02 + 3.86g) = \\frac{1}{16}(27.02 + 3.86/\\sqrt{3}) \\approx 1.82803\n$$\n$$\n\\det \\mathbf{J}(\\xi=-g) = \\frac{1}{16}(27.02 - 3.86g) = \\frac{1}{16}(27.02 - 3.86/\\sqrt{3}) \\approx 1.54946\n$$\n雅可比质量度量 $q_J$ 是这些值的最小值与最大值之比：\n$$\nq_J = \\frac{\\min \\det \\mathbf{J}}{\\max \\det \\mathbf{J}} = \\frac{1.54946...}{1.82803...} \\approx 0.84761\n$$\n接下来，我们计算放大因子 $A$。这需要标量场 $T(\\xi, \\eta) = \\operatorname{tr}(\\mathbf{J}^{-T}\\mathbf{J}^{-1}) \\det \\mathbf{J}$。如问题描述所述，这等价于 $\\|\\mathbf{J}^{-1}\\|_F^2 \\det \\mathbf{J}$。对于一个 $2 \\times 2$ 矩阵 $\\mathbf{J}$，这可以简化为：\n$$\nT(\\xi, \\eta) = \\frac{\\|\\mathbf{J}\\|_F^2}{\\det \\mathbf{J}} = \\frac{J_{11}^2 + J_{12}^2 + J_{21}^2 + J_{22}^2}{\\det \\mathbf{J}}\n$$\n首先，我们计算弗罗贝尼乌斯范数的平方，$\\|\\mathbf{J}\\|_F^2$：\n$$\n\\begin{aligned}\n\\|\\mathbf{J}\\|_F^2 = \\frac{1}{16} \\left[ (6.3-0.1\\eta)^2 + (0.8+0.6\\eta)^2 + (-0.7-0.1\\xi)^2 + (4.2+0.6\\xi)^2 \\right] \\\\\n= \\frac{1}{16} [ (39.69 - 1.26\\eta + 0.01\\eta^2) + (0.64 + 0.96\\eta + 0.36\\eta^2) \\\\\n \\qquad + (0.49 + 0.14\\xi + 0.01\\xi^2) + (17.64 + 5.04\\xi + 0.36\\xi^2) ] \\\\\n= \\frac{1}{16} [ 58.46 + 5.18\\xi - 0.30\\eta + 0.37\\xi^2 + 0.37\\eta^2 ]\n\\end{aligned}\n$$\n在高斯点处，$\\xi^2 = g^2 = 1/3$ 且 $\\eta^2 = g^2 = 1/3$。因此 $\\xi^2+\\eta^2 = 2/3$。\n$$\n\\|\\mathbf{J}\\|_F^2 = \\frac{1}{16} [ 58.46 + 5.18\\xi - 0.30\\eta + 0.37(2/3) ] = \\frac{1}{16} [ 58.70666... + 5.18\\xi - 0.30\\eta ]\n$$\n现在我们计算四个高斯点处的 $T = \\|\\mathbf{J}\\|_F^2 / \\det \\mathbf{J}$：\n$$\nT(\\xi, \\eta) = \\frac{58.70666... + 5.18\\xi - 0.30\\eta}{27.02 + 3.86\\xi}\n$$\n我们在每个点上计算 $T$ 的值，其中 $g = 1/\\sqrt{3}$：\n1.  GP1: $(\\xi, \\eta) = (g, g)$。\n    $T_1 = \\frac{58.70666... + 5.18g - 0.30g}{27.02 + 3.86g} = \\frac{58.70666... + 4.88g}{27.02 + 3.86g} \\approx 2.10348$\n2.  GP2: $(\\xi, \\eta) = (-g, g)$。\n    $T_2 = \\frac{58.70666... - 5.18g - 0.30g}{27.02 - 3.86g} = \\frac{58.70666... - 5.48g}{27.02 - 3.86g} \\approx 2.24039$\n3.  GP3: $(\\xi, \\eta) = (-g, -g)$。\n    $T_3 = \\frac{58.70666... - 5.18g + 0.30g}{27.02 - 3.86g} = \\frac{58.70666... - 4.88g}{27.02 - 3.86g} \\approx 2.25438$\n4.  GP4: $(\\xi, \\eta) = (g, -g)$。\n    $T_4 = \\frac{58.70666... + 5.18g + 0.30g}{27.02 + 3.86g} = \\frac{58.70666... + 5.48g}{27.02 + 3.86g} \\approx 2.11532$\n\n高斯网格上 $T$ 的最小值和最大值是：\n$$\nT_{\\min} = T_1 \\approx 2.10348, \\quad T_{\\max} = T_3 \\approx 2.25438\n$$\n放大因子 $A$ 是它们的比值：\n$$\nA = \\frac{T_{\\max}}{T_{\\min}} = \\frac{2.25438...}{2.10348...} \\approx 1.07174\n$$\n根据要求，将最终结果四舍五入到四位有效数字：\n$q_J \\approx 0.8476$\n$A \\approx 1.072$\n\n最终答案为数对 $(q_J, A)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8476  1.072\n\\end{pmatrix}\n}\n$$", "id": "3553815"}]}