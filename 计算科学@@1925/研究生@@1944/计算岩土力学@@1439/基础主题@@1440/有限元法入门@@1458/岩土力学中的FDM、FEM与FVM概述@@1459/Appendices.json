{"hands_on_practices": [{"introduction": "等参映射概念是有限元方法（FEM）的基石，它使得模拟岩土工程中常见的复杂几何形状成为可能。本练习 [@problem_id:3547676] 将引导你完成从形函数推导单元刚度矩阵的基本步骤，这是构建任何有限元程序的核心环节。通过这个实践，你将深入理解 FEM 如何将物理问题转化为可解的代数系统。", "problem": "在计算岩土力学中，不同的空间离散化范式，包括有限差分法（FDM）、有限体积法（FVM）和有限元法（FEM），使用对几何和未知场的不同表示来近似连续介质平衡定律。有限元法（FEM）采用等参映射，使用相同的插值基来表示几何和场，这有助于对岩土力学中常见的复杂域进行稳健处理。\n\n从小变形假设下的小应变运动学和线性弹性理论出发，考虑一个二维四边形等参单元，其母单元坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，物理坐标为 $(x,y)\\in\\Omega_{e}$。设四个节点按逆时针顺序排列为：节点 1：左下，节点 2：右下，节点 3：右上，以及节点 4：左上。\n\n任务：\n- 使用相同的双线性形函数为几何和位移场定义等参映射。明确写出母正方形上的双线性形函数 $N_{i}(\\xi,\\eta)$，$i\\in\\{1,2,3,4\\}$。\n- 使用小应变定义 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u}+(\\nabla\\boldsymbol{u})^{T}\\right)$ 和等参映射的链式法则，推导平面应变情况下以Voigt形式 $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}^{T}$ 表示的应变-位移矩阵 $\\boldsymbol{B}(\\xi,\\eta)$，并用形函数关于 $(x,y)$ 的导数和映射的雅可比矩阵表示。\n- 写出单元刚度矩阵的形式 $\\boldsymbol{K}_{e}=\\displaystyle\\int_{\\Omega_{e}}\\boldsymbol{B}^{T}\\mathbb{C}\\boldsymbol{B}\\,t\\,d\\Omega$，其中 $t$ 是恒定厚度，$\\mathbb{C}$ 是各向同性材料的平面应变弹性张量。\n\n然后，针对以下具体配置，以获得一个单一的闭式标量表达式：\n- 设物理单元为矩形，其节点坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(a,0)$、$(x_{3},y_{3})=(a,b)$、$(x_{4},y_{4})=(0,b)$，其中 $a>0$，$b>0$，且厚度 $t>0$ 为常数。\n- 考虑与岩土力学中平面外滑移相关的反平面剪切简化情况，其中唯一的非零位移分量是平面外方向的 $w(x,y)$，其应变能密度与 $G|\\nabla w|^{2}$ 成正比，其中 $G>0$ 是剪切模量。在这种简化下，与节点 1 自耦合相关的单元刚度项为\n$$\nk_{11}\\;=\\;\\int_{\\Omega_{e}}G\\,t\\,\\nabla N_{1}\\cdot\\nabla N_{1}\\,d\\Omega,\n$$\n其中 $N_{1}(x,y)$ 是节点 1 形函数的等参插值。\n将 $k_{11}$ 计算为一个关于 $G$、$t$、$a$ 和 $b$ 的精确闭式解析表达式。不要进行数值计算或在最终表达式中包含单位。", "solution": "其基础包括小应变运动学、通过有限元法（FEM）离散化的线性动量平衡以及线性各向同性弹性理论。等参概念对几何和主场使用相同的插值基，这有助于利用链式法则将导数从母空间 $(\\xi,\\eta)$ 转换到物理空间 $(x,y)$。\n\n等参映射和双线性形函数。在母正方形 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$上，四节点四边形的双线性形函数定义为\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\\\\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n几何的等参映射由下式给出\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n位移场插值则为\n$$\nu_{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{xi},\\qquad\nu_{y}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{yi}.\n$$\n\n平面应变中的应变-位移矩阵。小应变张量为 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u}+(\\nabla\\boldsymbol{u})^{T}\\right)$。在平面应变的Voigt标记法中，应变向量为\n$$\n\\boldsymbol{\\varepsilon}=\n\\begin{bmatrix}\n\\varepsilon_{xx}\\\\[4pt]\n\\varepsilon_{yy}\\\\[4pt]\n\\gamma_{xy}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial u_{x}}{\\partial x}\\\\[8pt]\n\\displaystyle \\frac{\\partial u_{y}}{\\partial y}\\\\[8pt]\n\\displaystyle \\frac{\\partial u_{x}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial x}\n\\end{bmatrix}.\n$$\n通过等参插值，$u_{x}=\\sum_{i}N_{i}u_{xi}$ 且 $u_{y}=\\sum_{i}N_{i}u_{yi}$。使用链式法则，\n$$\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial}{\\partial x}\\\\[4pt]\n\\displaystyle \\frac{\\partial}{\\partial y}\n\\end{bmatrix}\n=\n\\boldsymbol{J}^{-T}\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial}{\\partial \\xi}\\\\[4pt]\n\\displaystyle \\frac{\\partial}{\\partial \\eta}\n\\end{bmatrix},\\qquad\n\\boldsymbol{J}=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial x}{\\partial \\xi}  \\displaystyle \\frac{\\partial x}{\\partial \\eta}\\\\[8pt]\n\\displaystyle \\frac{\\partial y}{\\partial \\xi}  \\displaystyle \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}.\n$$\n因此，\n$$\n\\frac{\\partial N_{i}}{\\partial x}=\\left[\\boldsymbol{J}^{-T}\\right]_{11}\\frac{\\partial N_{i}}{\\partial \\xi}+\\left[\\boldsymbol{J}^{-T}\\right]_{12}\\frac{\\partial N_{i}}{\\partial \\eta},\\qquad\n\\frac{\\partial N_{i}}{\\partial y}=\\left[\\boldsymbol{J}^{-T}\\right]_{21}\\frac{\\partial N_{i}}{\\partial \\xi}+\\left[\\boldsymbol{J}^{-T}\\right]_{22}\\frac{\\partial N_{i}}{\\partial \\eta}.\n$$\n以Voigt形式收集各项，平面应变下四节点四边形的应变-位移矩阵 $\\boldsymbol{B}(\\xi,\\eta)$ 为\n$$\n\\boldsymbol{B}=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial N_{1}}{\\partial x}  0  \\frac{\\partial N_{2}}{\\partial x}  0  \\frac{\\partial N_{3}}{\\partial x}  0  \\frac{\\partial N_{4}}{\\partial x}  0\\\\[8pt]\n0  \\displaystyle \\frac{\\partial N_{1}}{\\partial y}  0  \\frac{\\partial N_{2}}{\\partial y}  0  \\frac{\\partial N_{3}}{\\partial y}  0  \\frac{\\partial N_{4}}{\\partial y}\\\\[8pt]\n\\displaystyle \\frac{\\partial N_{1}}{\\partial y}  \\displaystyle \\frac{\\partial N_{1}}{\\partial x} \n\\frac{\\partial N_{2}}{\\partial y}  \\frac{\\partial N_{2}}{\\partial x} \n\\frac{\\partial N_{3}}{\\partial y}  \\frac{\\partial N_{3}}{\\partial x} \n\\frac{\\partial N_{4}}{\\partial y}  \\frac{\\partial N_{4}}{\\partial x}\n\\end{bmatrix}.\n$$\n\n平面应变中的单元刚度。对于各向同性材料，平面应变弹性矩阵为\n$$\n\\mathbb{C}=\n\\begin{bmatrix}\n\\lambda+2\\mu  \\lambda  0\\\\[4pt]\n\\lambda  \\lambda+2\\mu  0\\\\[4pt]\n0  0  \\mu\n\\end{bmatrix},\\qquad\n\\lambda=\\frac{E\\nu}{(1+\\nu)(1-2\\nu)},\\quad \\mu=\\frac{E}{2(1+\\nu)},\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。单元刚度矩阵为\n$$\n\\boldsymbol{K}_{e}=\\int_{\\Omega_{e}}\\boldsymbol{B}^{T}\\mathbb{C}\\boldsymbol{B}\\,t\\,d\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}(\\xi,\\eta)^{T}\\mathbb{C}\\,\\boldsymbol{B}(\\xi,\\eta)\\,t\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta.\n$$\n\n针对矩形单元的反平面剪切进行特例化。考虑节点为 $(0,0)$、$(a,0)$、$(a,b)$、$(0,b)$ 的矩形。等参几何映射成为一个仿射映射：\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}x_{i}=\\frac{a}{2}(1+\\xi),\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}y_{i}=\\frac{b}{2}(1+\\eta),\n$$\n因此雅可比矩阵是常数，\n$$\n\\boldsymbol{J}=\\begin{bmatrix}\n\\displaystyle \\frac{\\partial x}{\\partial \\xi}  \\displaystyle \\frac{\\partial x}{\\partial \\eta}\\\\[8pt]\n\\displaystyle \\frac{\\partial y}{\\partial \\xi}  \\displaystyle \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\displaystyle \\frac{a}{2}  0\\\\[8pt]\n0  \\displaystyle \\frac{b}{2}\n\\end{bmatrix},\\qquad\n\\det\\boldsymbol{J}=\\frac{ab}{4},\\qquad\n\\boldsymbol{J}^{-T}=\\begin{bmatrix}\n\\displaystyle \\frac{2}{a}  0\\\\[8pt]\n0  \\displaystyle \\frac{2}{b}\n\\end{bmatrix}.\n$$\n对于反平面剪切，唯一的位移分量是 $w(x,y)$，插值为 $w(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i}$，应变能密度为 $G|\\nabla w|^{2}$。与节点 1 自耦合相关的标量单元刚度项为\n$$\nk_{11}=\\int_{\\Omega_{e}}G\\,t\\,\\nabla N_{1}\\cdot\\nabla N_{1}\\,d\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}G\\,t\\,\\left[\\left(\\frac{\\partial N_{1}}{\\partial x}\\right)^{2}+\\left(\\frac{\\partial N_{1}}{\\partial y}\\right)^{2}\\right]\\det\\boldsymbol{J}\\,d\\xi\\,d\\eta.\n$$\n使用常数 $\\boldsymbol{J}^{-T}$ 和链式法则，\n$$\n\\frac{\\partial N_{1}}{\\partial x}=\\frac{2}{a}\\frac{\\partial N_{1}}{\\partial \\xi},\\qquad\n\\frac{\\partial N_{1}}{\\partial y}=\\frac{2}{b}\\frac{\\partial N_{1}}{\\partial \\eta}.\n$$\n$N_{1}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$ 在母空间中的导数为\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi}=-\\frac{1}{4}(1-\\eta),\\qquad\n\\frac{\\partial N_{1}}{\\partial \\eta}=-\\frac{1}{4}(1-\\xi).\n$$\n因此，\n$$\n\\left(\\frac{\\partial N_{1}}{\\partial x}\\right)^{2}=\\frac{1}{4a^{2}}(1-\\eta)^{2},\\qquad\n\\left(\\frac{\\partial N_{1}}{\\partial y}\\right)^{2}=\\frac{1}{4b^{2}}(1-\\xi)^{2}.\n$$\n代入并提出常数，\n$$\nk_{11}=G\\,t\\,\\frac{ab}{4}\\int_{-1}^{1}\\int_{-1}^{1}\\left[\\frac{1}{4a^{2}}(1-\\eta)^{2}+\\frac{1}{4b^{2}}(1-\\xi)^{2}\\right]\\,d\\xi\\,d\\eta\n=G\\,t\\,\\frac{ab}{16}\\left[\\frac{1}{a^{2}}\\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta+\\frac{1}{b^{2}}\\int_{-1}^{1}\\int_{-1}^{1}(1-\\xi)^{2}\\,d\\xi\\,d\\eta\\right].\n$$\n内层积分可以分离：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta=\\left(\\int_{-1}^{1}d\\xi\\right)\\left(\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\eta\\right)=2\\cdot\\int_{-1}^{1}(1-2\\eta+\\eta^{2})\\,d\\eta.\n$$\n计算\n$$\n\\int_{-1}^{1}(1-2\\eta+\\eta^{2})\\,d\\eta=\\left[\\eta-\\eta^{2}+\\frac{\\eta^{3}}{3}\\right]_{-1}^{1}=\\left(1-1+\\frac{1}{3}\\right)-\\left(-1-1-\\frac{1}{3}\\right)=\\frac{1}{3}+\\frac{7}{3}=\\frac{8}{3}.\n$$\n因此 $\\displaystyle \\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta=\\frac{16}{3}$，并且根据对称性，$\\displaystyle \\int_{-1}^{1}\\int_{-1}^{1}(1-\\xi)^{2}\\,d\\xi\\,d\\eta=\\frac{16}{3}$。所以，\n$$\nk_{11}=G\\,t\\,\\frac{ab}{16}\\left[\\frac{1}{a^{2}}\\cdot\\frac{16}{3}+\\frac{1}{b^{2}}\\cdot\\frac{16}{3}\\right]\n=G\\,t\\,\\frac{ab}{16}\\cdot\\frac{16}{3}\\left(\\frac{1}{a^{2}}+\\frac{1}{b^{2}}\\right)\n=G\\,t\\,\\frac{ab}{3}\\left(\\frac{1}{a^{2}}+\\frac{1}{b^{2}}\\right).\n$$\n一个紧凑的等价形式是\n$$\nk_{11}=G\\,t\\left(\\frac{b}{3a}+\\frac{a}{3b}\\right).\n$$\n这个闭式表达式完成了所要求的计算。", "answer": "$$\\boxed{G\\,t\\left(\\frac{b}{3a}+\\frac{a}{3b}\\right)}$$", "id": "3547676"}, {"introduction": "岩土工程中的一个关键挑战是模拟具有不同性质的分层岩石或土体。本实践 [@problem_id:3547671] 针对一个简单的一维稳态流问题，直接比较了有限差分法（FDM）、有限元法（FEM）和有限体积法（FVM）如何处理此类材料界面。这个练习突显了这些方法在构造上的根本差异，以及它们各自如何保证物理界面条件的实现。", "problem": "考虑一个由质量守恒和达西定律控制的均匀饱和多孔介质中的一维稳态地下流。基本原理如下：\n- 无源稳态的质量守恒：$\\dfrac{d}{dx}\\,q(x)=0$。\n- 达西定律：$q(x)=-k(x)\\,\\dfrac{dp}{dx}$，其中 $k(x)$ 是水力传导系数，$p(x)$ 是水头。\n- 在材料不连续处的界面条件，单位法向量 $\\mathbf{n}$ 指向 $+x$ 方向：$\\llbracket p \\rrbracket=0$ 和 $\\llbracket \\mathbf{q}\\cdot\\mathbf{n} \\rrbracket=0$，即水头和法向通量在界面上是连续的。\n\n设区域为 $x\\in[-L,L]$，狄利克雷边界条件为 $p(-L)=p_L$ 和 $p(L)=p_R$。施加一个水力传导系数的人为不连续性\n$$\nk(x)=\\begin{cases}\nk_1,  x0, \\\\\nk_2,  x>0,\n\\end{cases}\n$$\n在 $x=0$ 处有一个突变界面。假设 $k_10$ 和 $k_20$。将 $p$ 视为单位为 $\\mathrm{m}$ 的水头，将 $k$ 视为单位为 $\\mathrm{m/s}$ 的水力传导系数，因此 $q$ 的单位为 $\\mathrm{m/s}$。此问题不涉及角度。不应使用百分比。\n\n您的任务是实现三种一维空间离散化方法来近似 $p(x)$，并评估它们在多大程度上保持了界面条件：\n- 有限差分法 (FDM)，在均匀节点网格上使用中心差分。\n- 有限元法 (FEM)，在均匀网格上使用连续分段线性（线性）形函数（伽辽金法）。\n- 有限体积法 (FVM)，在均匀网格上使用单元中心的、两点通量格式，并采用调和平均的界面传输率。\n\n所有网格必须是均匀的，间距为 $h=\\dfrac{2L}{N}$，其中 $N$ 是一个偶正整数，以确保 $x=0$ 处的界面对于节点格式（FDM, FEM）与节点对齐，对于单元中心格式（FVM）与单元面对齐。在 $x=-L$ 和 $x=L$ 处精确施加狄利克雷条件。\n\n定义以下界面跳跃诊断量，以量化每种方法在 $x=0$ 处保持界面条件的情况：\n- 对于 FDM：设 $x_i=-L+i\\,h$，$i\\in\\{0,1,\\dots,N\\}$，并设 $i_0=\\dfrac{N}{2}$ 以使 $x_{i_0}=0$。计算与界面相邻的面上的单边通量，\n$$\nq_{\\text{left}}^{\\text{FDM}}=-k\\!\\left(x_{i_0-\\tfrac{1}{2}}\\right)\\frac{p_{i_0}-p_{i_0-1}}{h},\\quad\nq_{\\text{right}}^{\\text{FDM}}=-k\\!\\left(x_{i_0+\\tfrac{1}{2}}\\right)\\frac{p_{i_0+1}-p_{i_0}}{h},\n$$\n并定义通量跳跃幅度 $\\Delta q^{\\text{FDM}}=\\left|q_{\\text{right}}^{\\text{FDM}}-q_{\\text{left}}^{\\text{FDM}}\\right|$，单位为 $\\mathrm{m/s}$。因为节点未知量包含界面点，所以根据标准中心差分的构造，定义水头跳跃幅度 $\\Delta p^{\\text{FDM}}=0$，单位为 $\\mathrm{m}$。\n- 对于 FEM：使用相同的节点网格和连续分段线性基函数，并进行精确的单元积分。当 $i_0=\\dfrac{N}{2}$ 时，计算单边单元通量\n$$\nq_{\\text{left}}^{\\text{FEM}}=-k_1\\,\\frac{p_{i_0}-p_{i_0-1}}{h},\\quad\nq_{\\text{right}}^{\\text{FEM}}=-k_2\\,\\frac{p_{i_0+1}-p_{i_0}}{h},\n$$\n并定义 $\\Delta q^{\\text{FEM}}=\\left|q_{\\text{right}}^{\\text{FEM}}-q_{\\text{left}}^{\\text{FEM}}\\right|$，单位为 $\\mathrm{m/s}$，以及 $\\Delta p^{\\text{FEM}}=0$，单位为 $\\mathrm{m}$。\n- 对于 FVM：使用一个单元中心网格，包含 $N$ 个宽度为 $h$ 的单元，单元中心为 $x_j=-L+\\left(j+\\dfrac{1}{2}\\right)h$，$j\\in\\{0,1,\\dots,N-1\\}$，这样 $x=0$ 处的界面与单元 $j=\\dfrac{N}{2}-1$ 和 $j=\\dfrac{N}{2}$ 之间的面重合。设内部面传输率为 $T=\\dfrac{k_{\\text{harm}}}{h}$，其中 $k_{\\text{harm}}=\\dfrac{2}{\\tfrac{1}{k_{\\text{L}}}+\\tfrac{1}{k_{\\text{R}}}}$ 是该面上左右单元电导率的调和平均值，边界面传输率为 $T_{\\text{bnd}}=\\dfrac{2k_{\\text{cell}}}{h}$。计算界面上唯一的面通量 $q_{\\text{face}}^{\\text{FVM}}=-T\\left(p_{\\text{R}}-p_{\\text{L}}\\right)$，这强制了通量的连续性，并定义 $\\Delta q^{\\text{FVM}}=0$，单位为 $\\mathrm{m/s}$。为了在单元中心格式中探测水头的连续性，使用两侧单元中心的单边线性重构来重构单边面水头：\n$$\np_{\\text{L,face}}^{\\text{FVM}} \\approx p_{j_{\\text{L}}}+\\frac{1}{2}\\left(p_{j_{\\text{L}}}-p_{j_{\\text{LL}}}\\right),\\quad\np_{\\text{R,face}}^{\\text{FVM}} \\approx p_{j_{\\text{R}}}-\\frac{1}{2}\\left(p_{j_{\\text{RR}}}-p_{j_{\\text{R}}}\\right),\n$$\n其中 $j_{\\text{L}}=\\dfrac{N}{2}-1$，$j_{\\text{LL}}=j_{\\text{L}}-1$，$j_{\\text{R}}=\\dfrac{N}{2}$，$j_{\\text{RR}}=j_{\\text{R}}+1$，并定义水头跳跃幅度 $\\Delta p^{\\text{FVM}}=\\left|p_{\\text{R,face}}^{\\text{FVM}}-p_{\\text{L,face}}^{\\text{FVM}}\\right|$，单位为 $\\mathrm{m}$。\n\n为遵循基本原理的实现细节：\n- FDM 应使用中心差分，并在中点 $x_{i+\\tfrac{1}{2}}$ 处评估面传导系数，即如果 $x_{i+\\tfrac{1}{2}}0$ 则 $k\\!\\left(x_{i+\\tfrac{1}{2}}\\right)=k_1$，如果 $x_{i+\\tfrac{1}{2}}>0$ 则为 $k_2$。\n- FEM 应使用单元矩阵 $\\dfrac{k_e}{h}\\begin{bmatrix}1-1\\\\-11\\end{bmatrix}$ 组装标准对称刚度矩阵，对于 $x0$ 的单元使用 $k_e=k_1$，对于 $x>0$ 的单元使用 $k_e=k_2$。\n- FVM 应组装一个保守的两点通量系统，在内部面上使用调和平均，并使用半单元距离通过边界面传输率来施加狄利克雷边界条件。\n\n测试套件。使用以下参数集，每个集都指定为一个元组 $\\left(L,k_1,k_2,p_L,p_R,N\\right)$，其中 $L$ 的单位为 $\\mathrm{m}$，$k_1,k_2$ 的单位为 $\\mathrm{m/s}$，$p_L,p_R$ 的单位为 $\\mathrm{m}$，$N$ 为偶数整数：\n- 案例 1：$\\left(1,1,1,10,0,100\\right)$。\n- 案例 2：$\\left(1,10^{-3},1,10,0,100\\right)$。\n- 案例 3：$\\left(1,1,10^{-3},10,0,100\\right)$。\n- 案例 4：$\\left(1,10^{-4},10^{2},7,2,200\\right)$。\n- 案例 5：$\\left(1,1,100,5,5,50\\right)$。\n\n程序要求：\n- 按所述实现三种方法，并对每个案例，计算指定的六个诊断量 $\\left[\\Delta p^{\\text{FDM}},\\Delta q^{\\text{FDM}},\\Delta p^{\\text{FEM}},\\Delta q^{\\text{FEM}},\\Delta p^{\\text{FVM}},\\Delta q^{\\text{FVM}}\\right]$，单位需符合规定。\n- 您的程序应生成单行输出，其中包含所有案例的结果，格式为方括号括起来的逗号分隔的列表的列表，例如 $\\left[\\left[r_{1,1},\\dots,r_{1,6}\\right],\\left[r_{2,1},\\dots,r_{2,6}\\right],\\dots\\right]$，其中每个 $r_{i,j}$ 是一个浮点数。", "solution": "所提出的问题要求实现并比较三种数值方法——有限差分法 (FDM)、有限元法 (FEM) 和有限体积法 (FVM)——用于解决多孔介质中具有不连续水力传导系数的一维稳态流动问题。任务的核心是评估每种方法如何保证在材料界面上压力连续和通量连续的物理条件。\n\n### 解析预备知识\n控制方程为 $\\dfrac{d}{dx}\\left(k(x)\\dfrac{dp}{dx}\\right)=0$。一次积分得到 $k(x)\\dfrac{dp}{dx} = -q_0$，其中 $q_0$ 是整个区域内恒定的达西通量。在边界条件 $p(-L)=p_L$ 和 $p(L)=p_R$ 以及界面条件 $\\llbracket p \\rrbracket=0, \\llbracket q \\rrbracket=0$ (在 $x=0$ 处)下进行二次积分，可得到精确解析解。压力 $p(x)$ 是分段线性的，通量 $q_0$ 是恒定的，由 $q_0 = \\dfrac{p_L-p_R}{L/k_1 + L/k_2}$ 给出。界面处的压力为 $p(0)=\\dfrac{p_L k_1 + p_R k_2}{k_1+k_2}$。\n\n### 方法1：有限差分法 (FDM)\n区域被离散化为节点网格 $x_i = -L+ih$，$i=0,\\dots,N$，共有 $N+1$ 个节点。压力 $p_0=p_L$ 和 $p_N=p_R$ 是已知的。我们求解 $N-1$ 个内部压力 $p_1, \\dots, p_{N-1}$。\n\n控制方程使用保守中心差分格式进行离散化。在内部节点 $i$ 处，离散化为：\n$$\n\\frac{1}{h}\\left[ \\left(-k\\frac{dp}{dx}\\right)_{i+1/2} - \\left(-k\\frac{dp}{dx}\\right)_{i-1/2} \\right] = 0\n$$\n近似导数并在面中点处评估电导率，得到：\n$$\n-k(x_{i+1/2})\\frac{p_{i+1}-p_i}{h} + k(x_{i-1/2})\\frac{p_i-p_{i-1}}{h} = 0\n$$\n这可以重排为关于 $p_{i-1}, p_i, p_{i+1}$ 的线性方程。为 $i=1,\\dots,N-1$ 组装这些方程，会得到一个三对角线性系统 $A\\mathbf{p}_{\\text{int}}=\\mathbf{b}$，其中 $\\mathbf{p}_{\\text{int}}=[p_1, \\dots, p_{N-1}]^T$。\n\n- 对于均匀区域中的节点（远离界面），$k(x_{i-1/2})=k(x_{i+1/2})=k_1$ 或 $k_2$，方程简化为拉普拉斯算子的标准三点模板。\n- 在界面节点 $i_0 = N/2$ 处，我们有 $x_{i_0-1/2}=-h/2$ 和 $x_{i_0+1/2}=h/2$。因此 $k(x_{i_0-1/2})=k_1$ 且 $k(x_{i_0+1/2})=k_2$。方程为：\n$$\n-k_2\\frac{p_{i_0+1}-p_{i_0}}{h} + k_1\\frac{p_{i_0}-p_{i_0-1}}{h} = 0 \\implies k_1\\frac{p_{i_0}-p_{i_0-1}}{h} = k_2\\frac{p_{i_0+1}-p_{i_0}}{h}\n$$\n问题将单边通量定义为 $q_{\\text{left}}^{\\text{FDM}}=-k_1\\frac{p_{i_0}-p_{i_0-1}}{h}$ 和 $q_{\\text{right}}^{\\text{FDM}}=-k_2\\frac{p_{i_0+1}-p_{i_0}}{h}$。因此，界面处的离散方程等效于强制 $q_{\\text{left}}^{\\text{FDM}}=q_{\\text{right}}^{\\text{FDM}}$。因此，通量跳跃 $\\Delta q^{\\text{FDM}} = |q_{\\text{right}}^{\\text{FDM}}-q_{\\text{left}}^{\\text{FDM}}|$ 根据构造为零（在浮点精度范围内）。\n由于 FDM 是节点格式，压力在每个节点（包括界面节点 $i_0$）上都有唯一定义。因此，水头跳跃 $\\Delta p^{\\text{FDM}}$ 根据定义为零。\n\n### 方法2：有限元法 (FEM)\n在相同的节点网格上使用标准的伽辽金有限元法，配合连续分段线性基函数 ($\\phi_i(x)$)，问题的弱形式导出一个线性系统 $K\\mathbf{p}=\\mathbf{f}$。刚度矩阵项为 $K_{ij} = \\int_{-L}^L k(x) \\phi_j'(x) \\phi_i'(x) dx$。\n\n对于这个一维问题，组装单元刚度矩阵 $\\frac{k_e}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$（其中 $k_e$ 是单元电导率）会为内部节点生成一个全局方程组，该方程组与 FDM 系统相同（最多相差一个不影响结果的全局符号）。\n- 在界面节点 $i_0$ 处，组装过程结合了来自电导率为 $k_1$ 的单元 $[x_{i_0-1}, x_{i_0}]$ 和电导率为 $k_2$ 的单元 $[x_{i_0}, x_{i_0+1}]$ 的贡献。这会得出一个与 FDM 方程相同的方程。\n\n因此，FDM 和 FEM 计算出的节点压力 $p_i$ 将是相同的。\n- **诊断量**：与 FDM 一样，由于基函数是连续的，$\\Delta p^{\\text{FEM}} = 0$ 是根据构造得出的。由于压力解与 FDM 的相同，计算出的通量以及通量跳跃 $\\Delta q^{\\text{FEM}}$ 也将与 FDM 的相同，即根据构造为零。\n\n### 方法3：有限体积法 (FVM)\nFVM 在一个由 $N$ 个控制体积（单元）组成的单元中心网格上实现。未知数 $p_j$ 代表单元 $j$ 内的平均压力。$x=0$ 处的界面位于单元 $j_{\\text{L_idx}}=N/2-1$ 和单元 $j_{\\text{R_idx}}=N/2$ 之间的面上。\n\n该方法根据构造是保守的，意味着数值通量在单元面上是连续的。每个单元 $j$ 的方程强制其各面通量之和为零。\n$$\nq_{j+1/2} - q_{j-1/2} = 0\n$$\n其中 $q_{j+1/2} = -T_{j+1/2}(p_{j+1}-p_j)$ 是单元 $j$ 和 $j+1$ 之间面上的通量。\n- 在材料界面处，传输率 $T$ 使用相邻单元电导率的调和平均值计算：$T_{\\text{iface}} = \\frac{1}{h} \\frac{2k_1k_2}{k_1+k_2}$。已知这种特定选择可为一维分层介质产生精确通量。\n- 在区域边界处，通过边界面传输率 $T_{\\text{bnd}}=2k_{\\text{cell}}/h$ 施加二阶精确的狄利克雷条件。\n\n将两点通量近似与界面传输率的调和平均相结合，并采用二阶边界条件处理，这使得 FVM 格式对于此一维问题是精确的。计算出的单元中心压力 $p_j$ 将等于在单元中心处评估的解析解 $p_{\\text{exact}}(x_j)$。\n- **诊断量**：对于这种保守格式，$\\Delta q^{\\text{FVM}}=0$ 是根据定义得出的。水头跳跃 $\\Delta p^{\\text FVM}$ 是通过从左右两侧重构界面处的水头来计算的。指定的单边线性重构是：\n$$\np_{\\text{L,face}}^{\\text{FVM}} = p_{j_{\\text{L}}}+\\frac{1}{2}\\left(p_{j_{\\text{L}}}-p_{j_{\\text{LL}}}\\right) \\quad \\text{and} \\quad p_{\\text{R,face}}^{\\text{FVM}} = p_{j_{\\text{R}}}-\\frac{1}{2}\\left(p_{j_{\\text{RR}}}-p_{j_{\\text{R}}}\\right)\n$$\n由于 FVM 解 $p_j$ 在单元中心是精确的，并且解析解是分段线性的，因此这种线性重构将从两侧精确地恢复界面处的解析水头：$p_{\\text{L,face}}^{\\text{FVM}}=p_{\\text{exact}}(0^-)$ 和 $p_{\\text{R,face}}^{\\text{FVM}}=p_{\\text{exact}}(0^+)$。由于解析水头是连续的（$p_{\\text{exact}}(0^-)=p_{\\text{exact}}(0^+)$），计算出的水头跳跃 $\\Delta p^{\\text{FVM}}$ 将为零（在浮点误差范围内）。\n\n### 分析结论\n对于所描述的特定问题和特定的数值格式，所有三种方法的构造方式都能完美地保证界面处的压力和通量连续性，这要么是通过构造实现的，要么是通过为这一维案例得出精确解实现的。因此，所有六个诊断跳跃值预计都将为零或接近机器精度的零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_fdm_fem(L, k1, k2, pL, pR, N):\n    \"\"\"\n    Solves the 1D flow problem using a conservative Finite Difference Method.\n    The problem specifies a piecewise-linear Finite Element Method that results\n    in an identical algebraic system.\n    \n    Args:\n        L (float): Half-length of the domain [-L, L].\n        k1 (float): Hydraulic conductivity for x  0.\n        k2 (float): Hydraulic conductivity for x  0.\n        pL (float): Hydraulic head at x = -L.\n        pR (float): Hydraulic head at x = L.\n        N (int): Number of grid cells (must be even).\n        \n    Returns:\n        tuple: A tuple containing the four diagnostics:\n               (delta_p_fdm, delta_q_fdm, delta_p_fem, delta_q_fem).\n    \"\"\"\n    h = 2.0 * L / N\n    i0 = N // 2  # Index of the interface node\n\n    num_unknowns = N - 1\n    A = np.zeros((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Assemble the tridiagonal system for interior nodes p_1, ..., p_{N-1}\n    for i in range(1, N):  # Node indices from 1 to N-1\n        row_idx = i - 1\n\n        if i  i0:\n            # Region 1 (k=k1)\n            lower_diag, main_diag, upper_diag = k1, -2.0 * k1, k1\n        elif i == i0:\n            # Interface node\n            lower_diag, main_diag, upper_diag = k1, -(k1 + k2), k2\n        else:  # i  i0\n            # Region 2 (k=k2)\n            lower_diag, main_diag, upper_diag = k2, -2.0 * k2, k2\n\n        if i  1:\n            A[row_idx, row_idx - 1] = lower_diag\n        A[row_idx, row_idx] = main_diag\n        if i  N - 1:\n            A[row_idx, row_idx + 1] = upper_diag\n\n    # Apply Dirichlet boundary conditions\n    b[0] -= k1 * pL\n    if num_unknowns  0:\n        b[num_unknowns - 1] -= k2 * pR\n\n    # Solve for interior pressures\n    p_int = np.linalg.solve(A, b) if num_unknowns  0 else np.array([])\n    p = np.concatenate(([pL], p_int, [pR]))\n\n    # --- Diagnostics ---\n    # The discrete equation at i0 enforces flux continuity, so delta_q will be ~0.\n    # Nodal schemes have continuous pressure by construction.\n    delta_p_fdm = 0.0\n    \n    p_i0_minus_1 = p[i0 - 1]\n    p_i0 = p[i0]\n    p_i0_plus_1 = p[i0 + 1]\n    \n    q_left = -k1 * (p_i0 - p_i0_minus_1) / h\n    q_right = -k2 * (p_i0_plus_1 - p_i0) / h\n    delta_q_fdm = abs(q_right - q_left)\n\n    # For this problem, FEM results are identical to FDM\n    delta_p_fem = 0.0\n    delta_q_fem = delta_q_fdm\n\n    return delta_p_fdm, delta_q_fdm, delta_p_fem, delta_q_fem\n\ndef solve_fvm(L, k1, k2, pL, pR, N):\n    \"\"\"\n    Solves the 1D flow problem using a cell-centered Finite Volume Method.\n    \n    Args:\n        L (float): Half-length of the domain [-L, L].\n        k1 (float): Hydraulic conductivity for x  0.\n        k2 (float): Hydraulic conductivity for x  0.\n        pL (float): Hydraulic head at x = -L.\n        pR (float): Hydraulic head at x = L.\n        N (int): Number of grid cells (must be even).\n        \n    Returns:\n        tuple: A tuple containing the two diagnostics: (delta_p_fvm, delta_q_fvm).\n    \"\"\"\n    h = 2.0 * L / N\n    j_iface = N // 2 # Interface is face j_iface, between cells j_iface-1 and j_iface\n\n    # Transmissibilities\n    T_k1 = k1 / h\n    T_k2 = k2 / h\n    T_iface = (2.0 * k1 * k2) / (h * (k1 + k2)) if (k1 + k2)  0 else 0.0\n    T_bnd_L = 2.0 * k1 / h\n    T_bnd_R = 2.0 * k2 / h\n\n    A = np.zeros((N, N))\n    b = np.zeros(N)\n\n    # Assemble system for cell-centered pressures p_0, ..., p_{N-1}\n    # Equation for cell j: T_{j+1/2}(p_{j+1}-p_j) - T_{j-1/2}(p_j-p_{j-1}) = 0\n    # Rearranged: T_{j-1/2} p_{j-1} - (T_{j-1/2}+T_{j+1/2}) p_j + T_{j+1/2} p_{j+1} = 0\n    for j in range(N):\n        # Left face of cell j is face j\n        if j == 0:\n            T_left = T_bnd_L\n            b[j] += T_left * pL\n        else:\n            T_left = T_k2 if j  j_iface else (T_iface if j == j_iface else T_k1)\n            A[j, j - 1] += T_left\n        \n        # Right face of cell j is face j+1\n        if j == N - 1:\n            T_right = T_bnd_R\n            b[j] += T_right * pR\n        else:\n            T_right = T_k2 if j + 1  j_iface else (T_iface if j + 1 == j_iface else T_k1)\n            A[j, j + 1] += T_right\n\n        A[j, j] -= (T_left + T_right)\n\n    # The system is A*p=b where A is defined above. We solve -A*p=-b.\n    p_cell = np.linalg.solve(-A, -b)\n\n    # --- Diagnostics ---\n    # Conservative FVM has continuous flux by construction.\n    delta_q_fvm = 0.0\n    \n    # Head jump from linear reconstruction\n    # For this 1D problem, FVM is exact, and linear reconstruction is exact.\n    # Thus, delta_p should be ~0.\n    j_L = j_iface - 1\n    j_LL = j_iface - 2\n    j_R = j_iface\n    j_RR = j_iface + 1\n    \n    p_L_face = p_cell[j_L] + 0.5 * (p_cell[j_L] - p_cell[j_LL])\n    p_R_face = p_cell[j_R] - 0.5 * (p_cell[j_RR] - p_cell[j_R])\n    delta_p_fvm = abs(p_R_face - p_L_face)\n\n    return delta_p_fvm, delta_q_fvm\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (1.0, 1.0, 1.0, 10.0, 0.0, 100),\n        (1.0, 1e-3, 1.0, 10.0, 0.0, 100),\n        (1.0, 1.0, 1e-3, 10.0, 0.0, 100),\n        (1.0, 1e-4, 1e2, 7.0, 2.0, 200),\n        (1.0, 1.0, 100.0, 5.0, 5.0, 50),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, k1, k2, pL, pR, N = case\n        \n        # FDM and FEM calculations\n        dp_fdm, dq_fdm, dp_fem, dq_fem = solve_fdm_fem(L, k1, k2, pL, pR, N)\n        \n        # FVM calculation\n        dp_fvm, dq_fvm = solve_fvm(L, k1, k2, pL, pR, N)\n        \n        case_results = [dp_fdm, dq_fdm, dp_fem, dq_fem, dp_fvm, dq_fvm]\n        results.append(case_results)\n\n    # Format the final output string\n    outer_list = []\n    for res_list in results:\n        inner_list = \", \".join(f\"{x:.8e}\" for x in res_list)\n        outer_list.append(f\"[{inner_list}]\")\n    \n    print(f\"[{', '.join(outer_list)}]\")\n\nsolve()\n```", "id": "3547671"}, {"introduction": "许多现实世界的岩土力学问题涉及固体变形与流体流动的耦合（即孔隙弹性理论）。制造解方法（MMS）是一种强大而严谨的技术，用于验证计算机代码是否正确地求解了这些复杂的耦合方程。本练习 [@problem_id:3547686] 将演示如何将 MMS 应用于一个经典的孔隙弹性问题，这对于开发可靠的科学计算软件是一项至关重要的技能。", "problem": "考虑一个饱和弹性多孔固体（Biot 多孔弹性理论）的准静态、小应变、线性多孔弹性模型。设空间域为单位正方形 $\\Omega = (0,1) \\times (0,1)$，时间 $t \\ge 0$。未知量是位移矢量场 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 和孔隙压力 $p(\\boldsymbol{x},t)$。该模型由线性动量守恒和质量守恒定义，其中 Cauchy 应力遵循线性弹性定律，流体流动遵循达西定律。基本陈述如下：\n- 线性动量守恒：$- \\nabla \\cdot \\boldsymbol{\\sigma} + \\alpha \\nabla p = \\boldsymbol{f}$，其中 $\\boldsymbol{\\sigma}$ 是应力张量，$\\alpha$ 是 Biot 系数，$\\boldsymbol{f}$ 是待确定的体力。\n- 线性弹性本构律：$\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，应变张量 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2} \\left( \\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top} \\right)$，$\\boldsymbol{I}$ 是单位张量。\n- 质量守恒：$\\frac{\\partial}{\\partial t} \\left( \\alpha \\nabla \\cdot \\boldsymbol{u} + c\\, p \\right) - \\nabla \\cdot \\left( K \\nabla p \\right) = s$，其中 $c$ 是比储水系数， $K$ 是常数导水系数（假定为各向同性），$s$ 是待确定的源项。\n\n您的任务是使用人工解法（MMS）为计算岩土力学中常用的三种离散化方法族构建一个验证问题：有限差分法（FDM）、有限元法（FEM）和有限体积法（FVM）。具体而言：\n\n- 概述一个验证计划，该计划应： \n  (i) 规定如何在 $\\partial \\Omega$ 上施加 $\\boldsymbol{u}$ 和 $p$ 以匹配人工解； \n  (ii) 指定用于测量两个场以及时空中的源驱动残差的误差范数； \n  (iii) 陈述具有代表性的二阶中心有限差分法、采用线性元和压力一致性稳定化的协调 Galerkin 有限元法，以及采用线性重构的二阶有限体积法的预期网格/时间步收敛阶。\n- 仅从上述基本定律出发，并采用以下具有常数 $U0$、$P0$、$\\beta0$ 的解析人工解对：\n$$\n\\boldsymbol{u}(x,y,t) = \\begin{pmatrix}\nU \\sin(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t) \\\\\nU \\cos(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t)\n\\end{pmatrix}, \n\\qquad\np(x,y,t) = P \\sin(\\pi x)\\, \\cos(\\pi y)\\, \\exp(\\beta t),\n$$\n推导出体力 $\\boldsymbol{f}(x,y,t)$ 和质量源 $s(x,y,t)$ 的闭合形式，使得当边界数据取为人工场的迹时，解对 $\\left( \\boldsymbol{u}, p \\right)$ 在 $\\Omega \\times (0,\\infty)$ 中精确满足控制方程。\n\n用 $\\lambda$、$\\mu$、$\\alpha$、$c$、$K$、$U$、$P$、$\\beta$、$x$、$y$ 和 $t$ 将最终答案表示为一个单行矩阵，其条目分别对应于 $\\boldsymbol{f}$ 的第一个分量、$\\boldsymbol{f}$ 的第二个分量和 $s$。不需要进行数值计算。如果您选择简化三角函数乘积，请进行代数简化。不要在最终的方框表达式中包含物理单位。不要进行任何四舍五入，并提供精确的符号表达式。", "solution": "该问题是有效的。这是一个适定的、有科学依据的练习，将人工解法应用于线性多孔弹性理论的既定方程，这是计算岩土力学中的一个标准课题。该任务需要直接应用矢量和张量微积分来推导源项，这是一个数学上严谨且可验证的过程。\n\n解答包括两个部分。首先，概述一个验证计划。其次，推导体力 $\\boldsymbol{f}(x,y,t)$ 和质量源项 $s(x,y,t)$ 的显式符号形式。\n\n### 验证计划\n\n针对给定的 Biot 多孔弹性问题，使用人工解法（MMS）的验证计划包括以下步骤：\n\n(i) **边界和初始条件**：将位移 $\\boldsymbol{u}(x,y,t)$ 和压力 $p(x,y,t)$ 的人工解作为狄利克雷边界条件，在所有时间 $t \\ge 0$ 施加于域 $\\Omega = (0,1) \\times (0,1)$ 的整个边界 $\\partial\\Omega$ 上。\n-   位移边界条件：$\\boldsymbol{u}(\\boldsymbol{x},t) = \\boldsymbol{u}_{\\text{manufactured}}(\\boldsymbol{x},t)$ 对于所有 $\\boldsymbol{x} \\in \\partial\\Omega$，$t \\ge 0$。\n-   压力边界条件：$p(\\boldsymbol{x},t) = p_{\\text{manufactured}}(\\boldsymbol{x},t)$ 对于所有 $\\boldsymbol{x} \\in \\partial\\Omega$，$t \\ge 0$。\n在 $t=0$ 时的初始条件也直接由人工解规定：\n-   初始位移：$\\boldsymbol{u}(\\boldsymbol{x},0) = \\boldsymbol{u}_{\\text{manufactured}}(\\boldsymbol{x},0)$。\n-   初始压力：$p(\\boldsymbol{x},0) = p_{\\text{manufactured}}(\\boldsymbol{x},0)$。\n\n(ii) **误差测量**：一个使用推导出的源项 $\\boldsymbol{f}$ 和 $s$ 求解问题的数值代码应生成数值解 $\\boldsymbol{u}_h(\\boldsymbol{x},t)$ 和 $p_h(\\boldsymbol{x},t)$，其中 $h$ 是特征网格尺寸。误差是数值解与精确人工解之间的差异。误差使用适当的范数进行测量，通常在固定的时间 $t_{final}$ 进行评估。\n-   位移误差：\n    -   $L^2$范数：$\\| \\boldsymbol{u} - \\boldsymbol{u}_h \\|_{L^2(\\Omega)} = \\left(\\int_\\Omega (\\boldsymbol{u} - \\boldsymbol{u}_h) \\cdot (\\boldsymbol{u} - \\boldsymbol{u}_h) \\, d\\Omega\\right)^{1/2}$。\n    -   $H^1$半范数：$| \\boldsymbol{u} - \\boldsymbol{u}_h |_{H^1(\\Omega)} = \\left(\\int_\\Omega \\| \\nabla\\boldsymbol{u} - \\nabla\\boldsymbol{u}_h \\|_F^2 \\, d\\Omega\\right)^{1/2}$，其中 $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数。\n-   压力误差：\n    -   $L^2$范数：$\\| p - p_h \\|_{L^2(\\Omega)} = \\left(\\int_\\Omega (p - p_h)^2 \\, d\\Omega\\right)^{1/2}$。\n    -   $H^1$半范数：$| p - p_h |_{H^1(\\Omega)} = \\left(\\int_\\Omega \\| \\nabla p - \\nabla p_h \\|^2 \\, d\\Omega\\right)^{1/2}$。\n通过细化网格尺寸 $h$ 和时间步长 $\\Delta t$，可以观察到这些误差范数收敛于零，并计算收敛速率。\n\n(iii) **预期收敛阶**：对于指定的数值方法，假设使用二阶精度的时间步进格式（例如，Crank-Nicolson），预期的收敛阶如下：\n-   **二阶中心有限差分法**：该方法在离散 $L^2$ 范数下，位移和压力的收敛阶预期均为二阶，即误差为 $O(h^2 + \\Delta t^2)$。\n-   **采用线性元的协调 Galerkin 有限元法**：对于位移和压力均使用 P1/P1（线性）单元，标准理论预测两个场在 $L^2$ 范数下的误差估计为 $O(h^2)$，在 $H^1$ 范数下为 $O(h)$。使用“一致性稳定化”对于防止压力振荡和达到这些最优速率至关重要，否则由于 LBB (Ladyzhenskaya-Babuška-Brezzi) 条件，可能无法保证这些速率。时间误差取决于时间步进格式，例如，对于二阶格式为 $O(\\Delta t^2)$。\n-   **采用线性重构的二阶有限体积法**：该方法被设计为空间上二阶精确。与二阶时间积分格式相结合，对于单元平均值或重构点值，预期在离散 $L^2$ 范数下显示出 $O(h^2 + \\Delta t^2)$ 的总收敛阶。\n\n### 源项推导\n\n源项 $\\boldsymbol{f}$ 和 $s$ 是通过将人工解代入控制方程推导出来的。\n\n人工解为：\n$$\n\\boldsymbol{u}(x,y,t) = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix}\nU \\sin(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t) \\\\\nU \\cos(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t)\n\\end{pmatrix}\n$$\n$$\np(x,y,t) = P \\sin(\\pi x)\\, \\cos(\\pi y)\\, \\exp(\\beta t)\n$$\n\n**1. 体力 $\\boldsymbol{f}$ 的推导**\n\n体力 $\\boldsymbol{f}$ 由 $\\boldsymbol{f} = -\\nabla \\cdot \\boldsymbol{\\sigma} + \\alpha \\nabla p$ 给出。一个方便计算线性弹性应力张量散度的恒等式是 $\\nabla \\cdot \\boldsymbol{\\sigma} = (\\lambda+\\mu)\\nabla(\\nabla \\cdot \\boldsymbol{u}) + \\mu \\nabla^2 \\boldsymbol{u}$。\n\n首先，我们计算 $\\boldsymbol{u}$ 的必要导数：\n-   $\\boldsymbol{u}$ 的散度：\n    $\\nabla \\cdot \\boldsymbol{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\pi U \\cos(\\pi x) \\sin(\\pi y) \\exp(\\beta t) + \\pi U \\cos(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n    $\\nabla \\cdot \\boldsymbol{u} = \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) \\exp(\\beta t)$\n-   散度的梯度：\n    $\\frac{\\partial}{\\partial x}(\\nabla \\cdot \\boldsymbol{u}) = -\\pi^2 U \\sin(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) \\exp(\\beta t)$\n    $\\frac{\\partial}{\\partial y}(\\nabla \\cdot \\boldsymbol{u}) = \\pi^2 U \\cos(\\pi x) (\\cos(\\pi y) - \\sin(\\pi y)) \\exp(\\beta t)$\n    所以，$\\nabla(\\nabla \\cdot \\boldsymbol{u}) = \\pi^2 U \\exp(\\beta t) \\begin{pmatrix} -\\sin(\\pi x)(\\sin(\\pi y) + \\cos(\\pi y)) \\\\ \\cos(\\pi x)(\\cos(\\pi y) - \\sin(\\pi y)) \\end{pmatrix}$。\n-   $\\boldsymbol{u}$ 的拉普拉斯算子：\n    $\\nabla^2 u_x = \\frac{\\partial^2 u_x}{\\partial x^2} + \\frac{\\partial^2 u_x}{\\partial y^2} = -\\pi^2 u_x - \\pi^2 u_x = -2\\pi^2 U \\sin(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n    $\\nabla^2 u_y = \\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial y^2} = -\\pi^2 u_y - \\pi^2 u_y = -2\\pi^2 U \\cos(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n    所以，$\\nabla^2 \\boldsymbol{u} = -2\\pi^2 \\exp(\\beta t) \\begin{pmatrix} U \\sin(\\pi x)\\sin(\\pi y) \\\\ U \\cos(\\pi x)\\sin(\\pi y) \\end{pmatrix}$。\n\n现在，我们计算 $\\nabla \\cdot \\boldsymbol{\\sigma}$：\n-   x-分量：$(\\nabla \\cdot \\boldsymbol{\\sigma})_x = (\\lambda+\\mu)\\frac{\\partial(\\nabla \\cdot \\boldsymbol{u})}{\\partial x} + \\mu \\nabla^2 u_x$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = (\\lambda+\\mu) \\left[-\\pi^2 U \\sin(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y))\\right] \\exp(\\beta t) + \\mu \\left[-2\\pi^2 U \\sin(\\pi x) \\sin(\\pi y)\\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = -\\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+\\mu)(\\sin(\\pi y) + \\cos(\\pi y)) + 2\\mu \\sin(\\pi y) \\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = -\\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] \\exp(\\beta t)$\n-   y-分量：$(\\nabla \\cdot \\boldsymbol{\\sigma})_y = (\\lambda+\\mu)\\frac{\\partial(\\nabla \\cdot \\boldsymbol{u})}{\\partial y} + \\mu \\nabla^2 u_y$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = (\\lambda+\\mu) \\left[\\pi^2 U \\cos(\\pi x) (\\cos(\\pi y) - \\sin(\\pi y))\\right] \\exp(\\beta t) + \\mu \\left[-2\\pi^2 U \\cos(\\pi x) \\sin(\\pi y)\\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)(\\cos(\\pi y) - \\sin(\\pi y)) - 2\\mu \\sin(\\pi y) \\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)\\cos(\\pi y) - (\\lambda+3\\mu)\\sin(\\pi y) \\right] \\exp(\\beta t)$\n\n接下来，我们计算压力 $p$ 的梯度：\n$\\nabla p = P \\exp(\\beta t) \\begin{pmatrix} \\pi \\cos(\\pi x) \\cos(\\pi y) \\\\ -\\pi \\sin(\\pi x) \\sin(\\pi y) \\end{pmatrix}$\n\n最后，我们组合 $\\boldsymbol{f} = (f_x, f_y)^T$：\n$f_x = -(\\nabla \\cdot \\boldsymbol{\\sigma})_x + \\alpha \\frac{\\partial p}{\\partial x}$\n$f_x = \\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] \\exp(\\beta t) + \\alpha \\pi P \\cos(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n$f_x = \\left( \\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] + \\pi \\alpha P \\cos(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t)$\n\n$f_y = -(\\nabla \\cdot \\boldsymbol{\\sigma})_y + \\alpha \\frac{\\partial p}{\\partial y}$\n$f_y = -\\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)\\cos(\\pi y) - (\\lambda+3\\mu)\\sin(\\pi y) \\right] \\exp(\\beta t) - \\alpha \\pi P \\sin(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n$f_y = \\left( \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) - (\\lambda+\\mu)\\cos(\\pi y) \\right] - \\pi \\alpha P \\sin(\\pi x) \\sin(\\pi y) \\right) \\exp(\\beta t)$\n\n**2. 质量源 $s$ 的推导**\n\n质量源 $s$ 由 $s = \\frac{\\partial}{\\partial t} \\left( \\alpha \\nabla \\cdot \\boldsymbol{u} + c\\, p \\right) - \\nabla \\cdot \\left( K \\nabla p \\right)$ 给出。\n\n首先，我们计算时间导数内的项：\n$\\alpha \\nabla \\cdot \\boldsymbol{u} + c p = \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t)$\n其时间导数为：\n$\\frac{\\partial}{\\partial t}(\\dots) = \\beta \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t)$\n\n接下来，我们计算流体通量散度项 $- \\nabla \\cdot (K \\nabla p)$。由于 $K$ 是常数，该项为 $-K \\nabla^2 p$。\n$\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -\\pi^2 p_0(x,y) \\exp(\\beta t) - \\pi^2 p_0(x,y) \\exp(\\beta t) = -2 \\pi^2 p$\n$\\nabla^2 p = -2\\pi^2 P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n所以，$-K \\nabla^2 p = 2\\pi^2 K P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$。\n\n最后，我们组合 $s$：\n$s = \\beta \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t) + 2\\pi^2 K P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n合并与 $P$ 成比例的项：\n$s = \\left( \\beta \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + (\\beta c + 2\\pi^2 K) P \\sin(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t)$\n\n推导出的 $f_x$、$f_y$ 和 $s$ 的表达式是使给定的 $\\boldsymbol{u}$ 和 $p$ 成为多孔弹性方程精确解所需的源项。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left( \\pi^{2} U \\sin(\\pi x) ((\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y)) + \\pi \\alpha P \\cos(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t),  \\left( \\pi^{2} U \\cos(\\pi x) ((\\lambda+3\\mu)\\sin(\\pi y) - (\\lambda+\\mu)\\cos(\\pi y)) - \\pi \\alpha P \\sin(\\pi x) \\sin(\\pi y) \\right) \\exp(\\beta t),  \\left( \\beta \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + (\\beta c + 2\\pi^{2} K) P \\sin(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t) \\end{pmatrix}}\n$$", "id": "3547686"}]}