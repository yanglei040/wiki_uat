{"hands_on_practices": [{"introduction": "在有限元分析中，核心步骤之一是将离散的节点位移转化为单元内的连续应变场。这一转化通过应变-位移矩阵（$B$ 矩阵）实现，而 $B$ 矩阵的构建直接依赖于形函数梯度。本练习将通过一个线性三角形单元，带你亲手推导并计算形函数梯度，让你深入理解单元几何、形函数与其导数之间的基本关系。[@problem_id:3561763]", "problem": "在对一个土体进行的二维平面应变分析中，考虑物理坐标系中的一个线性三节点三角形有限元，其节点位置为 $P_1=(x_1,y_1)=(0,0)$、$P_2=(x_2,y_2)=(3,1)$ 和 $P_3=(x_3,y_3)=(1,4)$。对于 $i\\in\\{1,2,3\\}$，线性形函数 $N_i(x,y)$ 是与该三角形关联的重心坐标，因此它们是仿射函数，满足克罗内克-德尔塔性质 $N_i(P_j)=\\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{3}N_i(x,y)=1$（对于单元内的所有点 $(x,y)$）。\n\n请仅从线性三角形形函数的定义性质和三角形有向面积的几何定义出发，推导出一个用节点坐标和三角形有向面积 $A$ 表示的常梯度 $\\nabla N_i$ 的通用表达式。然后，对于上面定义的三角形，计算物理 $(x,y)$ 坐标系中梯度 $\\nabla N_1$、$\\nabla N_2$ 和 $\\nabla N_3$ 的数值。\n\n请将你的最终答案以单行矩阵的形式报告，其中分量按 $\\left[\\frac{\\partial N_1}{\\partial x},\\frac{\\partial N_1}{\\partial y},\\frac{\\partial N_2}{\\partial x},\\frac{\\partial N_2}{\\partial y},\\frac{\\partial N_3}{\\partial x},\\frac{\\partial N_3}{\\partial y}\\right]$ 的顺序排列。请使用精确值（不要四舍五入）。", "solution": "用户希望我解决以下问题：\n在对一个土体进行的二维平面应变分析中，考虑物理坐标系中的一个线性三节点三角形有限元，其节点位置为 $P_1=(x_1,y_1)=(0,0)$、$P_2=(x_2,y_2)=(3,1)$ 和 $P_3=(x_3,y_3)=(1,4)$。对于 $i\\in\\{1,2,3\\}$，线性形函数 $N_i(x,y)$ 是与该三角形关联的重心坐标，因此它们是仿射函数，满足克罗内克-德尔塔性质 $N_i(P_j)=\\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{3}N_i(x,y)=1$（对于单元内的所有点 $(x,y)$）。\n\n请仅从线性三角形形函数的定义性质和三角形有向面积的几何定义出发，推导出一个用节点坐标和三角形有向面积 $A$ 表示的常梯度 $\\nabla N_i$ 的通用表达式。然后，对于上面定义的三角形，计算物理 $(x,y)$ 坐标系中梯度 $\\nabla N_1$、$\\nabla N_2$ 和 $\\nabla N_3$ 的数值。\n\n请将你的最终答案以单行矩阵的形式报告，其中分量按 $\\left[\\frac{\\partial N_1}{\\partial x},\\frac{\\partial N_1}{\\partial y},\\frac{\\partial N_2}{\\partial x},\\frac{\\partial N_2}{\\partial y},\\frac{\\partial N_3}{\\partial x},\\frac{\\partial N_3}{\\partial y}\\right]$ 的顺序排列。请使用精确值（不要四舍五入）。\n\n### 步骤1：提取已知条件\n- 单元类型：二维线性三节点三角形有限元。\n- 分析类型：平面应变。\n- 节点坐标：$P_1=(x_1,y_1)=(0,0)$，$P_2=(x_2,y_2)=(3,1)$，$P_3=(x_3,y_3)=(1,4)$。\n- 对于 $i \\in \\{1,2,3\\}$，形函数 $N_i(x,y)$ 是：\n    - 线性（仿射函数）。\n    - 重心坐标。\n    - 满足克罗内克-德尔塔性质：$N_i(P_j) = \\delta_{ij}$。\n    - 满足单位分解性质：$\\sum_{i=1}^{3} N_i(x,y) = 1$。\n- 任务，第1部分：推导用节点坐标和单元有向面积 $A$ 表示的 $\\nabla N_i$ 的通用表达式。\n- 任务，第2部分：计算给定单元的 $\\nabla N_1$、$\\nabla N_2$ 和 $\\nabla N_3$ 的数值。\n- 输出格式：一个包含六个梯度分量的单行矩阵。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是有限元方法（FEM）中的一个标准练习，有限元方法是计算力学和工程学的基石。所有概念（形函数、重心坐标、梯度）都是有限元方法的基础。\n- **适定的**：该问题提供了所有必要的信息（节点坐标）和定义，可以唯一地确定形函数及其梯度。存在唯一解。\n- **客观的**：语言是精确和数学化的。\n- **相关性**：该问题与空间离散化和形函数直接相关，这些是计算岩土力学中的核心课题。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个适定的、科学上合理的、客观的、且与指定领域直接相关的问题。我将继续进行求解。\n\n### 梯度表达式的推导\n\n三节点三角形的线性形函数 $N_i(x,y)$ 是空间坐标 $(x,y)$ 的仿射函数，可以写成：\n$$\nN_i(x,y) = c_{i,1} + c_{i,2}x + c_{i,3}y\n$$\n该函数的梯度在单元上是恒定的：\n$$\n\\nabla N_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} c_{i,2} \\\\ c_{i,3} \\end{pmatrix}\n$$\n问题指出，形函数是重心坐标。点 $P(x,y)$ 相对于节点 $P_1$ 的重心坐标 $N_1(x,y)$ 定义为由点 $P$、$P_2$ 和 $P_3$ 组成的子三角形的面积与主三角形 $P_1P_2P_3$ 的总面积之比。设 $A$ 为三角形 $P_1P_2P_3$ 的有向面积，$A_1$ 为三角形 $PP_2P_3$ 的有向面积。则 $N_1(x,y) = A_1/A$。\n\n一个顶点按逆时针顺序排列为 $(x_a, y_a)$、$(x_b, y_b)$ 和 $(x_c, y_c)$ 的三角形的有向面积由行列式公式给出：\n$$\n\\text{Area} = \\frac{1}{2} \\det \\begin{pmatrix} 1  x_a  y_a \\\\ 1  x_b  y_b \\\\ 1  x_c  y_c \\end{pmatrix}\n$$\n单元的总有向面积为：\n$$\nA = \\frac{1}{2} \\det \\begin{pmatrix} 1  x_1  y_1 \\\\ 1  x_2  y_2 \\\\ 1  x_3  y_3 \\end{pmatrix} = \\frac{1}{2} [x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2)]\n$$\n子三角形 $PP_2P_3$ 的面积 $A_1$ 为：\n$$\nA_1 = \\frac{1}{2} \\det \\begin{pmatrix} 1  x  y \\\\ 1  x_2  y_2 \\\\ 1  x_3  y_3 \\end{pmatrix} = \\frac{1}{2} [x(y_2 - y_3) + x_2(y_3 - y) + x_3(y - y_2)]\n$$\n我们可以重新排列 $A_1$ 表达式中的项，以突出其对 $x$ 和 $y$ 的依赖关系：\n$$\nA_1 = \\frac{1}{2} [x(y_2 - y_3) + y(x_3 - x_2) + (x_2y_3 - x_3y_2)]\n$$\n现在我们可以写出形函数 $N_1(x,y)$ 的表达式：\n$$\nN_1(x,y) = \\frac{A_1}{A} = \\frac{1}{2A} [x(y_2 - y_3) + y(x_3 - x_2) + (x_2y_3 - x_3y_2)]\n$$\n正如预期的，这是一个关于 $x$ 和 $y$ 的仿射函数。梯度 $\\nabla N_1$ 的分量是 $x$ 和 $y$ 的系数：\n$$\n\\frac{\\partial N_1}{\\partial x} = \\frac{y_2 - y_3}{2A}\n$$\n$$\n\\frac{\\partial N_1}{\\partial y} = \\frac{x_3 - x_2}{2A}\n$$\n因此，第一个形函数的梯度是：\n$$\n\\nabla N_1 = \\frac{1}{2A} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix}\n$$\n$\\nabla N_2$ 和 $\\nabla N_3$ 的表达式可以通过对下标 $(1, 2, 3)$ 进行循环置换得到。对于 $N_2$，我们应用置换 $(1 \\to 2, 2 \\to 3, 3 \\to 1)$：\n$$\n\\nabla N_2 = \\frac{1}{2A} \\begin{pmatrix} y_3 - y_1 \\\\ x_1 - x_3 \\end{pmatrix}\n$$\n对于 $N_3$，我们再次应用置换 $(2 \\to 3, 3 \\to 1, 1 \\to 2)$：\n$$\n\\nabla N_3 = \\frac{1}{2A} \\begin{pmatrix} y_1 - y_2 \\\\ x_2 - x_1 \\end{pmatrix}\n$$\n这些就是线性三角形形函数梯度的通用表达式。\n\n### 数值计算\n\n给定的节点坐标为 $P_1=(x_1,y_1)=(0,0)$、$P_2=(x_2,y_2)=(3,1)$ 和 $P_3=(x_3,y_3)=(1,4)$。\n\n首先，我们计算 $2A$ 的值：\n$$\n2A = x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2)\n$$\n$$\n2A = 0(1 - 4) + 3(4 - 0) + 1(0 - 1) = 0 + 12 - 1 = 11\n$$\n面积 $A = \\frac{11}{2}$ 为正，表示顶点的排列顺序为逆时针。\n\n现在我们可以计算每个梯度的分量：\n\n对于 $\\nabla N_1$：\n$$\n\\frac{\\partial N_1}{\\partial x} = \\frac{y_2 - y_3}{2A} = \\frac{1 - 4}{11} = -\\frac{3}{11}\n$$\n$$\n\\frac{\\partial N_1}{\\partial y} = \\frac{x_3 - x_2}{2A} = \\frac{1 - 3}{11} = -\\frac{2}{11}\n$$\n\n对于 $\\nabla N_2$：\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{y_3 - y_1}{2A} = \\frac{4 - 0}{11} = \\frac{4}{11}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = \\frac{x_1 - x_3}{2A} = \\frac{0 - 1}{11} = -\\frac{1}{11}\n$$\n\n对于 $\\nabla N_3$：\n$$\n\\frac{\\partial N_3}{\\partial x} = \\frac{y_1 - y_2}{2A} = \\frac{0 - 1}{11} = -\\frac{1}{11}\n$$\n$$\n\\frac{\\partial N_3}{\\partial y} = \\frac{x_2 - x_1}{2A} = \\frac{3 - 0}{11} = \\frac{3}{11}\n$$\n\n作为检验，单位分解性质 $\\sum_{i=1}^3 N_i = 1$ 意味着梯度之和必须为零：$\\sum_{i=1}^3 \\nabla N_i = \\mathbf{0}$。\nx-分量之和：$\\frac{\\partial N_1}{\\partial x} + \\frac{\\partial N_2}{\\partial x} + \\frac{\\partial N_3}{\\partial x} = -\\frac{3}{11} + \\frac{4}{11} - \\frac{1}{11} = \\frac{-3+4-1}{11} = 0$。\ny-分量之和：$\\frac{\\partial N_1}{\\partial y} + \\frac{\\partial N_2}{\\partial y} + \\frac{\\partial N_3}{\\partial y} = -\\frac{2}{11} - \\frac{1}{11} + \\frac{3}{11} = \\frac{-2-1+3}{11} = 0$。\n计算结果是一致的。\n\n最终答案是这六个分量组成的行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\frac{3}{11}  -\\frac{2}{11}  \\frac{4}{11}  -\\frac{1}{11}  -\\frac{1}{11}  \\frac{3}{11} \\end{pmatrix}\n}\n$$", "id": "3561763"}, {"introduction": "在构建单元刚度矩阵或质量矩阵时，我们通常需要对形函数或其导数的乘积在单元域上进行积分。对于除最简单单元外的所有情况，精确的解析积分既繁琐又困难，因此数值积分（尤其是高斯积分）成为标准方法。本练习将让你对比使用数值积分和解析积分计算一个标准四节点四边形（Q4）单元上形函数乘积的积分，从而体会高斯积分在有限元计算中的准确性和高效性。[@problem_id:3561798]", "problem": "在计算岩土力学中使用的等参有限元的背景下，考虑定义在母正方形域 $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$ 上的四节点四边形 (Q4) 单元的双线性形函数。设节点排序为节点 $1$ 位于 $(\\xi,\\eta)=(-1,-1)$，节点 $2$ 位于 $(\\xi,\\eta)=(1,-1)$。相关的双线性形函数为\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\qquad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta).\n$$\n定义积分\n$$\nI \\equiv \\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,N_2(\\xi,\\eta)\\, d\\xi\\, d\\eta.\n$$\n(a) 在母域上使用张量积两点 Gauss–Legendre 求积（$2\\times 2$ 法则）数值计算 $I$，其中一维横坐标和权重为 $\\xi=\\pm 1/\\sqrt{3}$，单位权重为 $w=1$，二维权重为一维权重的乘积。\n(b) 通过在母域上进行精确积分来解析计算 $I$。\n给出 $I$ 的精确值。无需四舍五入。将最终答案表示为最简分数。", "solution": "该问题要求计算积分 $I \\equiv \\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,N_2(\\xi,\\eta)\\, d\\xi\\, d\\eta$，其中 $N_1$ 和 $N_2$ 是四节点四边形单元的双线性形函数。给定的形函数为：\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n首先，我们构建被积函数，记为 $f(\\xi,\\eta)$：\n$$\nf(\\xi,\\eta) = N_1(\\xi,\\eta)\\,N_2(\\xi,\\eta) = \\left(\\frac{1}{4}(1-\\xi)(1-\\eta)\\right) \\left(\\frac{1}{4}(1+\\xi)(1-\\eta)\\right)\n$$\n化简此表达式，我们得到：\n$$\nf(\\xi,\\eta) = \\frac{1}{16}(1-\\xi)(1+\\xi)(1-\\eta)(1-\\eta) = \\frac{1}{16}(1-\\xi^2)(1-\\eta)^2\n$$\n该问题要求用两种方法计算 $I$：数值求积和解析积分。\n\n(a) 使用 $2 \\times 2$ Gauss-Legendre 求积进行数值计算。\n在母正方形域上进行二维数值求积的公式为：\n$$\nI \\approx I_{num} = \\int_{-1}^{1}\\int_{-1}^{1} f(\\xi,\\eta)\\,d\\xi\\,d\\eta \\approx \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_i w_j f(\\xi_i, \\eta_j)\n$$\n对于指定的 $2 \\times 2$ 法则（$n=2$），一维横坐标为 $\\xi_1 = -1/\\sqrt{3}$，$\\xi_2 = 1/\\sqrt{3}$，对应的权重为 $w_1=1$ 和 $w_2=1$。$\\eta$ 坐标也同样适用：$\\eta_1 = -1/\\sqrt{3}$，$\\eta_2 = 1/\\sqrt{3}$，权重为 $w_1=1$ 和 $w_2=1$。\n这给出了域内的四个求积点 $(\\xi_i, \\eta_j)$，每个点的权重为 $w_i w_j = 1 \\times 1 = 1$。这些点是：\n\\begin{itemize}\n    \\item $(\\xi_1, \\eta_1) = (-1/\\sqrt{3}, -1/\\sqrt{3})$\n    \\item $(\\xi_2, \\eta_1) = (1/\\sqrt{3}, -1/\\sqrt{3})$\n    \\item $(\\xi_1, \\eta_2) = (-1/\\sqrt{3}, 1/\\sqrt{3})$\n    \\item $(\\xi_2, \\eta_2) = (1/\\sqrt{3}, 1/\\sqrt{3})$\n\\end{itemize}\n积分的数值是被积函数在这四个点上的值的总和：\n$$\nI_{num} = f(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}) + f(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}) + f(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}) + f(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})\n$$\n我们来计算被积函数 $f(\\xi, \\eta) = \\frac{1}{16}(1-\\xi^2)(1-\\eta)^2$ 在每个点上的值。注意到项 $(1-\\xi^2)$ 对于 $\\xi = \\pm 1/\\sqrt{3}$ 是相同的：\n$$\n1-\\xi^2 = 1 - (\\pm \\frac{1}{\\sqrt{3}})^2 = 1 - \\frac{1}{3} = \\frac{2}{3}\n$$\n所以，被积函数的值仅取决于 $\\eta$ 坐标：\n$$\nf(\\pm \\frac{1}{\\sqrt{3}}, \\eta) = \\frac{1}{16}\\left(\\frac{2}{3}\\right)(1-\\eta)^2 = \\frac{1}{24}(1-\\eta)^2\n$$\n现在我们计算 $\\eta_1 = -1/\\sqrt{3}$ 和 $\\eta_2 = 1/\\sqrt{3}$ 时的值：\n$$\nf(\\pm \\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}) = \\frac{1}{24}(1-(-\\frac{1}{\\sqrt{3}}))^2 = \\frac{1}{24}(1+\\frac{1}{\\sqrt{3}})^2 = \\frac{1}{24}(1 + \\frac{2}{\\sqrt{3}} + \\frac{1}{3}) = \\frac{1}{24}(\\frac{4}{3} + \\frac{2}{\\sqrt{3}})\n$$\n$$\nf(\\pm \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}) = \\frac{1}{24}(1-\\frac{1}{\\sqrt{3}})^2 = \\frac{1}{24}(1 - \\frac{2}{\\sqrt{3}} + \\frac{1}{3}) = \\frac{1}{24}(\\frac{4}{3} - \\frac{2}{\\sqrt{3}})\n$$\n将这四个点的值相加：\n$$\nI_{num} = 2 \\times f(\\xi_1, \\eta_1) + 2 \\times f(\\xi_1, \\eta_2) = 2 \\left[\\frac{1}{24}(\\frac{4}{3} + \\frac{2}{\\sqrt{3}})\\right] + 2 \\left[\\frac{1}{24}(\\frac{4}{3} - \\frac{2}{\\sqrt{3}})\\right]\n$$\n$$\nI_{num} = \\frac{2}{24} \\left[ (\\frac{4}{3} + \\frac{2}{\\sqrt{3}}) + (\\frac{4}{3} - \\frac{2}{\\sqrt{3}}) \\right] = \\frac{1}{12} \\left[ \\frac{4}{3} + \\frac{4}{3} \\right] = \\frac{1}{12} \\left( \\frac{8}{3} \\right) = \\frac{8}{36} = \\frac{2}{9}\n$$\n\n(b) 通过精确积分进行解析计算。\n需要计算的积分为：\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} \\frac{1}{16}(1-\\xi^2)(1-\\eta)^2 \\, d\\xi\\, d\\eta\n$$\n由于被积函数是仅关于 $\\xi$ 和 $\\eta$ 的函数的乘积（即可分离），该二重积分可以写成两个单积分的乘积：\n$$\nI = \\frac{1}{16} \\left( \\int_{-1}^{1} (1-\\xi^2) \\,d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)^2 \\,d\\eta \\right)\n$$\n我们分别计算每个积分。第一个积分为：\n$$\n\\int_{-1}^{1} (1-\\xi^2) \\,d\\xi = \\left[ \\xi - \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n第二个积分为：\n$$\n\\int_{-1}^{1} (1-\\eta)^2 \\,d\\eta = \\int_{-1}^{1} (1 - 2\\eta + \\eta^2) \\,d\\eta = \\left[ \\eta - \\eta^2 + \\frac{\\eta^3}{3} \\right]_{-1}^{1}\n$$\n$$\n= \\left(1 - 1^2 + \\frac{1^3}{3}\\right) - \\left(-1 - (-1)^2 + \\frac{(-1)^3}{3}\\right) = \\left(1 - 1 + \\frac{1}{3}\\right) - \\left(-1 - 1 - \\frac{1}{3}\\right) = \\frac{1}{3} - \\left(-\\frac{7}{3}\\right) = \\frac{8}{3}\n$$\n现在，我们将这些结果相乘来求 $I$：\n$$\nI = \\frac{1}{16} \\left( \\frac{4}{3} \\right) \\left( \\frac{8}{3} \\right) = \\frac{32}{16 \\times 9} = \\frac{2}{9}\n$$\n数值计算和解析计算都得出了相同的结果。这是预料之中的，因为一个2点 Gauss-Legendre 求积法则可以精确积分最高 $2n-1 = 2(2)-1 = 3$ 次的多项式。在 $\\xi$ 中的被积函数分量是 $(1-\\xi^2)$，其次数为 $2$，在 $\\eta$ 中的分量是 $(1-\\eta)^2$，其次数也为 $2$。由于两个次数都小于或等于 $3$，因此 $2 \\times 2$ 法则对于此积分是精确的。\n\n$I$ 的精确值为 $\\frac{2}{9}$。", "answer": "$$\n\\boxed{\\frac{2}{9}}\n$$", "id": "3561798"}, {"introduction": "将形函数和积分方法结合起来，我们便可以构建出完整的单元矩阵，例如在动力学分析中至关重要的质量矩阵。本练习将引导你推导四节点四边形（Q4）单元的一致质量矩阵，并将其与一种常见的简化方法——集中质量矩阵——进行对比。通过计算这两种矩阵之间的差异，你将能更好地理解不同质量矩阵公式背后的物理假设及其对计算结果的潜在影响。[@problem_id:3561753]", "problem": "考虑一个均质土层在平面运动学下的小应变、单相线性动量动态平衡。将注意力限制在单个位移分量上，使得惯性项仅涉及一个标量场。从平衡律的弱形式出发，使用有限元法 (FEM) 和一个四节点双线性四边形 (Q4) 单元来推导单元级一致质量算子。设物理单元为一个矩形，其在 $x$ 和 $y$ 方向上的边长分别为 $a$ 和 $b$，具有恒定的厚度 $t$ 和均匀的质量密度 $\\rho$。使用从母域 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 出发的标准等参映射，由 $x(\\xi)=x_{c}+\\frac{a}{2}\\,\\xi$ 和 $y(\\eta)=y_{c}+\\frac{b}{2}\\,\\eta$ 给出，以及标准的 Q4 形函数\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n任务：\n- 从线性动量的弱形式出发，推导此 Q4 单元的一致单元质量矩阵 $M_{e}$。\n- 对于均匀的 $\\rho$ 和 $t$，显式计算 $M_{e}$ 的各项，并用 $a$ 和 $b$ 表示。\n- 使用行和法构造集中质量矩阵，并证明其等价于在具有均匀 $\\rho$ 和 $t$ 的 Q4 单元上通过节点求积获得的集中质量。\n- 定义无量纲归一化一致质量矩阵 $\\widehat{M}_{e}:=\\frac{4}{\\rho\\,t\\,a\\,b}\\,M_{e}$，使得通过行和法得到的相应集中质量为单位矩阵 $I_{4}$。计算 $\\widehat{M}_{e}$ 和 $I_{4}$ 之间偏差的单个标量度量，即弗罗贝尼乌斯范数\n$$\n\\|\\widehat{M}_{e}-I_{4}\\|_{F}=\\left(\\sum_{i=1}^{4}\\sum_{j=1}^{4}(\\widehat{M}_{e,ij}-\\delta_{ij})^{2}\\right)^{1/2},\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ。\n将最终的标量偏差表示为一个精确的无量纲数。不需要单位。不要四舍五入；提供一个精确的闭式表达式。", "solution": "用户希望在动力学问题的有限元分析背景下，推导并分析一个四节点双线性四边形 (Q4) 单元的质量矩阵。推导过程如问题陈述所述，分为几个步骤。\n\n### 第 1 步：一致单元质量矩阵 ($M_e$) 的推导\n\n仅考虑标量位移场 $u$ 的惯性项时，线性动量动态平衡的弱形式由下式给出：\n$$ \\int_{\\Omega} w \\, \\rho \\, \\ddot{u} \\, dV $$\n其中 $w$ 是检验函数，$\\rho$ 是质量密度，$\\ddot{u}$ 是加速度场，积分在域体积 $\\Omega$ 上进行。\n\n在有限元法 (FEM) 中，单元内的位移场 $u$ 和检验函数 $w$ 使用形函数 $N_i$ 从其节点值进行插值：\n$$ u(\\mathbf{x}, t) = \\sum_{i=1}^{4} N_i(\\mathbf{x}) u_i(t) = \\mathbf{N}(\\mathbf{x}) \\mathbf{u}_e(t) $$\n$$ w(\\mathbf{x}) = \\sum_{j=1}^{4} N_j(\\mathbf{x}) w_j = \\mathbf{N}(\\mathbf{x}) \\mathbf{w}_e $$\n其中 $\\mathbf{u}_e = [u_1, u_2, u_3, u_4]^T$ 和 $\\mathbf{w}_e = [w_1, w_2, w_3, w_4]^T$ 是节点值向量。则加速度为 $\\ddot{u}(\\mathbf{x}, t) = \\mathbf{N}(\\mathbf{x}) \\ddot{\\mathbf{u}}_e(t)$。\n\n将这些代入单个单元域 $\\Omega_e$ 的弱形式中：\n$$ \\int_{\\Omega_e} (\\mathbf{N} \\mathbf{w}_e)^T \\rho (\\mathbf{N} \\ddot{\\mathbf{u}}_e) dV = \\mathbf{w}_e^T \\left( \\int_{\\Omega_e} \\rho \\mathbf{N}^T \\mathbf{N} dV \\right) \\ddot{\\mathbf{u}}_e $$\n根据 $\\mathbf{w}_e$ 的任意性，括号中的项即为单元一致质量矩阵 $\\mathbf{M}_e$：\n$$ \\mathbf{M}_e = \\int_{\\Omega_e} \\rho \\mathbf{N}^T \\mathbf{N} dV $$\n对于厚度为常数 $t$ 的单元，体积积分变为面积分：\n$$ \\mathbf{M}_e = \\rho t \\int_{A_e} \\mathbf{N}^T \\mathbf{N} dA $$\n积分使用等参映射在母域 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$ 上进行。微分面积元为 $dA = |\\det(\\mathbf{J})| d\\xi d\\eta$，其中 $\\mathbf{J}$ 是坐标变换的雅可比矩阵。给定的映射为 $x = x_c + \\frac{a}{2}\\xi$ 和 $y = y_c + \\frac{b}{2}\\eta$。雅可比矩阵为：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}  0 \\\\ 0  \\frac{b}{2} \\end{pmatrix} $$\n行列式为常数：$|\\det(\\mathbf{J})| = \\frac{ab}{4}$。质量矩阵的分量为：\n$$ M_{e,ij} = \\rho t \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) N_j(\\xi, \\eta) \\left(\\frac{ab}{4}\\right) d\\xi d\\eta $$\n\n### 第 2 步：$M_e$ 各项的显式计算\n\nQ4 形函数是一维函数的乘积：$N_i(\\xi, \\eta) = \\frac{1}{4} f_i(\\xi) g_i(\\eta)$。\n$f_1=1-\\xi, g_1=1-\\eta$; $f_2=1+\\xi, g_2=1-\\eta$; $f_3=1+\\xi, g_3=1+\\eta$; $f_4=1-\\xi, g_4=1+\\eta$。\n$M_{e,ij}$ 的积分可以分离：\n$$ M_{e,ij} = \\rho t \\frac{ab}{4} \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\frac{1}{4} f_i(\\xi) g_i(\\eta)\\right) \\left(\\frac{1}{4} f_j(\\xi) g_j(\\eta)\\right) d\\xi d\\eta $$\n$$ M_{e,ij} = \\rho t \\frac{ab}{64} \\left( \\int_{-1}^{1} f_i(\\xi)f_j(\\xi)d\\xi \\right) \\left( \\int_{-1}^{1} g_i(\\eta)g_j(\\eta)d\\eta \\right) $$\n我们计算基本的一维积分：\n$$ \\int_{-1}^{1} (1-z)^2 dz = \\frac{8}{3}, \\quad \\int_{-1}^{1} (1+z)^2 dz = \\frac{8}{3}, \\quad \\int_{-1}^{1} (1-z)(1+z) dz = \\frac{4}{3} $$\n我们来计算 $M_{e,11}$：\n$$ M_{e,11} = \\rho t \\frac{ab}{64} \\left( \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\right) = \\rho t \\frac{ab}{64} \\left(\\frac{8}{3}\\right)\\left(\\frac{8}{3}\\right) = \\rho t \\frac{ab}{64} \\frac{64}{9} = \\rho t \\frac{ab}{9} $$\n我们来计算 $M_{e,12}$：\n$$ M_{e,12} = \\rho t \\frac{ab}{64} \\left( \\int_{-1}^{1} (1-\\xi)(1+\\xi) d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\right) = \\rho t \\frac{ab}{64} \\left(\\frac{4}{3}\\right)\\left(\\frac{8}{3}\\right) = \\rho t \\frac{ab}{64} \\frac{32}{9} = \\rho t \\frac{ab}{18} $$\n我们来计算 $M_{e,13}$：\n$$ M_{e,13} = \\rho t \\frac{ab}{64} \\left( \\int_{-1}^{1} (1-\\xi)(1+\\xi) d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)(1+\\eta) d\\eta \\right) = \\rho t \\frac{ab}{64} \\left(\\frac{4}{3}\\right)\\left(\\frac{4}{3}\\right) = \\rho t \\frac{ab}{64} \\frac{16}{9} = \\rho t \\frac{ab}{36} $$\n利用对称性和形函数的结构，我们发现给定行中各项的比例为 $4:2:1:2$（对角项、相邻边、对角角点、相邻边）。\n$M_{e,11}:M_{e,12}:M_{e,13}:M_{e,14} \\implies \\frac{ab}{9} : \\frac{ab}{18} : \\frac{ab}{36} : \\frac{ab}{18}$。除以 $\\rho t \\frac{ab}{36}$ 得到 $4:2:1:2$。\n完整的一致质量矩阵为：\n$$ \\mathbf{M}_e = \\frac{\\rho t a b}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} $$\n\n### 第 3 步：集中质量矩阵及其等价性\n\n集中质量矩阵 $\\mathbf{M}_e^L$ 可以通过行和法获得，其中每个对角线元素是 $\\mathbf{M}_e$ 对应行中所有元素的和，而非对角线元素为零。\n对于第一行：\n$$ M_{e,11}^L = \\sum_{j=1}^{4} M_{e,1j} = \\frac{\\rho t a b}{36} (4 + 2 + 1 + 2) = \\frac{\\rho t a b}{36} (9) = \\frac{\\rho t a b}{4} $$\n由于单元和形函数的对称性，所有行和都是相同的。因此，集中质量矩阵为：\n$$ \\mathbf{M}_e^L = \\frac{\\rho t a b}{4} \\mathbf{I}_4 = \\frac{\\rho t a b}{4} \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} $$\n这个结果在物理上意味着单元的总质量 $M_{total} = \\rho t a b$ 被平均分配到四个节点上。\n\n与节点求积的等价性：通过节点求积的集中化方法通过在节点处计算被积函数的加权和来近似质量矩阵的积分：\n$$ M_{e,ij}^L = \\rho t \\sum_{k=1}^4 W_k N_i(\\mathbf{x}_k) N_j(\\mathbf{x}_k) $$\n其中 $\\mathbf{x}_k$ 是节点坐标，$W_k$ 是面积权重。由于性质 $N_i(\\mathbf{x}_k) = \\delta_{ik}$（克罗内克 δ），表达式简化为一个对角矩阵：\n$$ M_{e,ij}^L = \\rho t \\sum_{k=1}^4 W_k \\delta_{ik} \\delta_{jk} = \\rho t W_i \\delta_{ij} $$\n对于矩形单元，每个节点关联的从属面积为 $W_i = \\frac{ab}{4}$。这得到 $M_{e,ii}^L = \\rho t \\frac{ab}{4}$，与行和法的结果相匹配。形式上，行和法的等价性可以通过使用单位分解性质 $\\sum_{j=1}^{4} N_j(\\mathbf{x}) = 1$ 来证明：\n$$ \\sum_{j=1}^{4} M_{e,ij} = \\sum_{j=1}^{4} \\rho t \\int_{A_e} N_i N_j dA = \\rho t \\int_{A_e} N_i \\left(\\sum_{j=1}^{4} N_j\\right) dA = \\rho t \\int_{A_e} N_i dA $$\n项 $\\int_{A_e} N_i dA$ 是形函数在单元面积上的积分，对于矩形上的 Q4 单元，对任何 $i$ 其值均为 $\\frac{ab}{4}$。因此，$\\sum_{j} M_{e,ij} = \\rho t \\frac{ab}{4}$，从而证明了等价性。\n\n### 第 4 步：归一化一致质量矩阵 ($\\widehat{\\mathbf{M}}_e$)\n\n归一化矩阵定义为 $\\widehat{\\mathbf{M}}_e = \\frac{4}{\\rho t a b} \\mathbf{M}_e$。\n$$ \\widehat{\\mathbf{M}}_e = \\frac{4}{\\rho t a b} \\left( \\frac{\\rho t a b}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} \\right) = \\frac{4}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} $$\n$$ \\widehat{\\mathbf{M}}_e = \\frac{1}{9} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} $$\n通过行和法，该矩阵的集中版本其对角线元素等于 $\\frac{1}{9}(4+2+1+2) = 1$，这证实了它是单位矩阵 $\\mathbf{I}_4$。\n\n### 第 5 步：弗罗贝尼乌斯范数计算\n\n我们计算偏差矩阵 $\\mathbf{D} = \\widehat{\\mathbf{M}}_e - \\mathbf{I}_4$ 的弗罗贝尼乌斯范数：\n$$ \\mathbf{D} = \\frac{1}{9} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} - \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 4-9  2  1  2 \\\\ 2  4-9  2  1 \\\\ 1  2  4-9  2 \\\\ 2  1  2  4-9 \\end{pmatrix} $$\n$$ \\mathbf{D} = \\frac{1}{9} \\begin{pmatrix} -5  2  1  2 \\\\ 2  -5  2  1 \\\\ 1  2  -5  2 \\\\ 2  1  2  -5 \\end{pmatrix} $$\n弗罗贝尼乌斯范数为 $\\|\\mathbf{D}\\|_F = \\left(\\sum_{i,j} D_{ij}^2\\right)^{1/2}$。\n$$ \\|\\mathbf{D}\\|_F^2 = \\left(\\frac{1}{9}\\right)^2 \\sum_{i,j} d_{ij}^2 \\quad \\text{其中 } \\mathbf{d} = \\begin{pmatrix} -5  2  1  2 \\\\ 2  -5  2  1 \\\\ 1  2  -5  2 \\\\ 2  1  2  -5 \\end{pmatrix} $$\n矩阵 $\\mathbf{d}$ 的元素平方和为：\n$$ \\sum_{i,j} d_{ij}^2 = 4 \\times (-5)^2 + 8 \\times 2^2 + 4 \\times 1^2 = 4 \\times 25 + 8 \\times 4 + 4 \\times 1 = 100 + 32 + 4 = 136 $$\n或者，四行中每一行元素的平方和为 $(-5)^2+2^2+1^2+2^2=25+4+1+4=34$。所以总和为 $4 \\times 34 = 136$。\n$$ \\|\\mathbf{D}\\|_F^2 = \\frac{1}{81} \\times 136 = \\frac{136}{81} $$\n弗罗贝尼乌斯范数是其平方根：\n$$ \\|\\mathbf{D}\\|_F = \\sqrt{\\frac{136}{81}} = \\frac{\\sqrt{136}}{\\sqrt{81}} = \\frac{\\sqrt{4 \\times 34}}{9} = \\frac{2\\sqrt{34}}{9} $$\n这就是最终的无量纲标量偏差度量。", "answer": "$$\n\\boxed{\\frac{2\\sqrt{34}}{9}}\n$$", "id": "3561753"}]}