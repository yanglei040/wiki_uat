{"hands_on_practices": [{"introduction": "这个练习将毕奥（Biot）有效应力原理应用于一个核心的岩土力学实验——三轴压缩试验。通过计算平均有效应力$p'$的变化，并结合经典的莫尔-库仑（Mohr-Coulomb）破坏准则，你将把抽象的理论与实际的工程屈服分析联系起来。这个实践旨在强化你对有效应力如何控制多孔介质力学行为（包括强度和稳定性）的基本理解。", "problem": "在室温下，对一块饱和多孔砂岩进行了一次轴对称三轴压缩试验。试样承受各向同性的背压，孔隙流体在力学上被理想化为施加各向同性的孔隙压力。采用广义有效应力原理，Biot 系数为 $b \\in (0,1]$，并将平均应力定义为柯西应力张量迹的三分之一。假设轴对称性，主应力为 $\\sigma_{1} \\ge \\sigma_{2} = \\sigma_{3}$。试验从初始应力状态发展到最终应力状态，具体如下：\n- Biot 系数: $b = 0.75$。\n- 初始状态：围压 $\\sigma_{3}^{(i)} = 12 \\ \\mathrm{MPa}$，轴向应力 $\\sigma_{1}^{(i)} = 12 \\ \\mathrm{MPa}$，孔隙压力 $u^{(i)} = 4 \\ \\mathrm{MPa}$。\n- 最终状态：围压 $\\sigma_{3}^{(f)} = 18 \\ \\mathrm{MPa}$，轴向应力 $\\sigma_{1}^{(f)} = 42 \\ \\mathrm{MPa}$，孔隙压力 $u^{(f)} = 9 \\ \\mathrm{MPa}$。\n\n破坏行为由三轴压缩条件下的 Mohr–Coulomb (MC) 准则理想化，有效摩擦角 $\\phi' = 30^{\\circ}$，有效黏聚力 $c' = 0.4 \\ \\mathrm{MPa}$。令应力不变量为平均有效应力 $p' = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}')$ 和偏应力量度 $q$，其中对于轴对称压缩，$q = \\sigma_{1}' - \\sigma_{3}'$。\n\n任务：\n1) 从广义有效应力原理和平均应力为迹的三分之一的定义出发，推导在给定的总应力、孔隙压力和 Biot 系数下，指定最终状态和初始状态之间平均有效应力变化量 $\\Delta p'$ 的表达式。利用上述数据计算其数值。将 $\\Delta p'$ 的最终数值以 $\\mathrm{MPa}$ 表示，并四舍五入到四位有效数字。\n2) 在 $(p', q)$ 平面中表达三轴压缩的 Mohr–Coulomb 屈服条件，并利用计算出的最终状态下的 $p'$ 值，判断最终状态是位于弹性域内、屈服面上还是塑性域内。报告在最终 $p'$ 值下 MC 屈服线对应的 $q$ 值，并将其与最终状态的实际 $q$ 值进行比较。您唯一需要作为最终答案报告的量是在任务 1 中计算出的数值。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观且完整的。所有提供的数据在岩土力学背景下都是物理上现实的。任务定义清晰，可以使用连续介质力学和土/岩石力学的标准原理解答。因此，我们可以开始进行解答。\n\n该问题要求完成两项任务。第一项是推导并计算初始状态和最终状态之间平均有效应力的变化量 $\\Delta p'$。第二项是根据 Mohr-Coulomb 屈服准则评估最终应力状态。\n\n**任务 1：平均有效应力变化量 $\\Delta p'$**\n\n由 Biot 提出的广义有效应力原理，将有效应力张量 $\\boldsymbol{\\sigma}'$ 与总应力张量 $\\boldsymbol{\\sigma}$ 和孔隙流体压力 $u$ 联系起来。其关系式如下：\n$$ \\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - b u \\mathbf{I} $$\n其中 $b$ 是 Biot 系数，$\\mathbf{I}$ 是二阶单位张量。\n\n平均应力定义为相应应力张量迹的三分之一。因此，平均有效应力 $p'$ 为：\n$$ p' = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}') $$\n将有效应力张量的定义代入此表达式，得到：\n$$ p' = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma} - b u \\mathbf{I}) $$\n利用迹算子的线性特性：\n$$ p' = \\frac{1}{3} \\left( \\mathrm{tr}(\\boldsymbol{\\sigma}) - \\mathrm{tr}(b u \\mathbf{I}) \\right) $$\n总应力张量的迹为 $\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33}$。在主应力坐标系中，这变为 $\\sigma_1 + \\sigma_2 + \\sigma_3$。单位张量的迹为 $\\mathrm{tr}(\\mathbf{I}) = 3$。因此，$\\mathrm{tr}(b u \\mathbf{I}) = 3bu$。\n将这些结果代回，我们得到：\n$$ p' = \\frac{1}{3}(\\sigma_1 + \\sigma_2 + \\sigma_3) - bu $$\n这可以写作 $p' = p - bu$，其中 $p = \\frac{1}{3}(\\sigma_1 + \\sigma_2 + \\sigma_3)$ 是平均总应力。\n\n对于给定的轴对称条件，主应力为 $\\sigma_1$ 和 $\\sigma_2 = \\sigma_3$。$p'$ 的表达式简化为：\n$$ p' = \\frac{\\sigma_1 + 2\\sigma_3}{3} - bu $$\n我们需要求解初始状态（上标 $i$）和最终状态（上标 $f$）之间的平均有效应力变化量 $\\Delta p'$：\n$$ \\Delta p' = p'^{(f)} - p'^{(i)} $$\n$$ \\Delta p' = \\left( \\frac{\\sigma_1^{(f)} + 2\\sigma_3^{(f)}}{3} - b u^{(f)} \\right) - \\left( \\frac{\\sigma_1^{(i)} + 2\\sigma_3^{(i)}}{3} - b u^{(i)} \\right) $$\n我们可以分别计算 $p'^{(i)}$ 和 $p'^{(f)}$。\n\n给定数据如下：\nBiot 系数：$b = 0.75$。\n初始状态：$\\sigma_{1}^{(i)} = 12 \\ \\mathrm{MPa}$，$\\sigma_{3}^{(i)} = 12 \\ \\mathrm{MPa}$，$u^{(i)} = 4 \\ \\mathrm{MPa}$。\n最终状态：$\\sigma_{1}^{(f)} = 42 \\ \\mathrm{MPa}$，$\\sigma_{3}^{(f)} = 18 \\ \\mathrm{MPa}$，$u^{(f)} = 9 \\ \\mathrm{MPa}$。\n\n首先，我们计算初始状态的平均有效应力 $p'^{(i)}$：\n$$ p'^{(i)} = \\frac{\\sigma_1^{(i)} + 2\\sigma_3^{(i)}}{3} - b u^{(i)} = \\frac{12 + 2(12)}{3} - (0.75)(4) $$\n$$ p'^{(i)} = \\frac{12 + 24}{3} - 3 = \\frac{36}{3} - 3 = 12 - 3 = 9 \\ \\mathrm{MPa} $$\n\n接着，我们计算最终状态的平均有效应力 $p'^{(f)}$：\n$$ p'^{(f)} = \\frac{\\sigma_1^{(f)} + 2\\sigma_3^{(f)}}{3} - b u^{(f)} = \\frac{42 + 2(18)}{3} - (0.75)(9) $$\n$$ p'^{(f)} = \\frac{42 + 36}{3} - 6.75 = \\frac{78}{3} - 6.75 = 26 - 6.75 = 19.25 \\ \\mathrm{MPa} $$\n\n最后，我们计算变化量 $\\Delta p'$：\n$$ \\Delta p' = p'^{(f)} - p'^{(i)} = 19.25 - 9 = 10.25 \\ \\mathrm{MPa} $$\n问题要求答案四舍五入到四位有效数字。数值 $10.25$ 已经有四位有效数字。\n\n**任务 2：相对于 Mohr-Coulomb 屈服准则评估最终状态**\n\n用有效主应力表示的三轴压缩（$\\sigma_1' \\ge \\sigma_3'$）条件下的 Mohr-Coulomb (MC) 屈服准则为：\n$$ \\sigma_1' = \\sigma_3' \\frac{1 + \\sin\\phi'}{1 - \\sin\\phi'} + 2c' \\frac{\\cos\\phi'}{1 - \\sin\\phi'} $$\n其中 $c'$ 是有效黏聚力，$\\phi'$ 是有效摩擦角。\n\n我们需要将此准则在 $(p', q)$ 平面中表示，其中 $p' = \\frac{\\sigma_1' + 2\\sigma_3'}{3}$ 且 $q = \\sigma_1' - \\sigma_3'$。根据这些定义，我们可以用 $p'$ 和 $q$ 来表示有效主应力：\n$$ \\sigma_1' = p' + \\frac{2}{3}q $$\n$$ \\sigma_3' = p' - \\frac{1}{3}q $$\n将这些代入 MC 准则，得到 $(p', q)$ 平面中的屈服线。一种等效且通常更直接的方法是从破坏面上剪应力 $\\tau$ 和法向有效应力 $\\sigma_n'$ 的基本准则形式 $\\tau = c' + \\sigma_n' \\tan\\phi'$ 推导出直线 $q = M p' + q_0$。在主应力空间中，这等效于：\n$$ \\frac{\\sigma_1' - \\sigma_3'}{2} = \\frac{\\sigma_1' + \\sigma_3'}{2} \\sin\\phi' + c'\\cos\\phi' $$\n代入不变量 $p'$ 和 $q$，我们有 $\\sigma_1' - \\sigma_3' = q$ 和 $\\sigma_1' + \\sigma_3' = 2p' + q/3$。该准则变为：\n$$ \\frac{q}{2} = \\left(p' + \\frac{q}{6}\\right) \\sin\\phi' + c'\\cos\\phi' $$\n重新整理以求解 $q$：\n$$ q\\left(\\frac{1}{2} - \\frac{\\sin\\phi'}{6}\\right) = p' \\sin\\phi' + c'\\cos\\phi' $$\n$$ q\\left(\\frac{3 - \\sin\\phi'}{6}\\right) = p' \\sin\\phi' + c'\\cos\\phi' $$\n$$ q = \\left(\\frac{6 \\sin\\phi'}{3 - \\sin\\phi'}\\right) p' + \\left(\\frac{6 c' \\cos\\phi'}{3 - \\sin\\phi'}\\right) $$\n该表达式定义了在给定 $p'$ 下 $q$ 的屈服值，我们称之为 $q_{yield}$。\n\n现在，我们代入材料参数 $\\phi' = 30^{\\circ}$ 和 $c' = 0.4 \\ \\mathrm{MPa}$：\n$\\sin(30^{\\circ}) = 0.5$ 且 $\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$。\n屈服线的斜率为：\n$$ M = \\frac{6 \\sin(30^{\\circ})}{3 - \\sin(30^{\\circ})} = \\frac{6(0.5)}{3 - 0.5} = \\frac{3}{2.5} = 1.2 $$\n屈服线的 $q$ 轴截距为：\n$$ q_0 = \\frac{6 c' \\cos(30^{\\circ})}{3 - \\sin(30^{\\circ})} = \\frac{6(0.4)\\cos(30^{\\circ})}{2.5} = \\frac{2.4\\left(\\frac{\\sqrt{3}}{2}\\right)}{2.5} = \\frac{1.2\\sqrt{3}}{2.5} \\approx 0.8314 \\ \\mathrm{MPa} $$\n所以，屈服条件为 $q_{yield} = 1.2 p' + \\frac{1.2\\sqrt{3}}{2.5}$。\n\n接下来，我们确定最终状态的应力点 $(p'^{(f)}, q^{(f)})$。我们已经计算出 $p'^{(f)} = 19.25 \\ \\mathrm{MPa}$。现在我们计算 $q^{(f)}$：\n$$ q^{(f)} = \\sigma_1'^{(f)} - \\sigma_3'^{(f)} $$\n最终的有效应力为：\n$$ \\sigma_1'^{(f)} = \\sigma_1^{(f)} - b u^{(f)} = 42 - (0.75)(9) = 42 - 6.75 = 35.25 \\ \\mathrm{MPa} $$\n$$ \\sigma_3'^{(f)} = \\sigma_3^{(f)} - b u^{(f)} = 18 - (0.75)(9) = 18 - 6.75 = 11.25 \\ \\mathrm{MPa} $$\n因此，偏应力为：\n$$ q^{(f)} = 35.25 - 11.25 = 24.0 \\ \\mathrm{MPa} $$\n最终应力状态位于点 $(p', q) = (19.25, 24.0)$，单位为 MPa。\n\n现在我们在 $p'^{(f)} = 19.25 \\ \\mathrm{MPa}$ 处评估屈服偏应力 $q_{yield}$：\n$$ q_{yield} = 1.2 (19.25) + \\frac{1.2\\sqrt{3}}{2.5} = 23.1 + 0.8314... = 23.9314... \\ \\mathrm{MPa} $$\n我们必须将实际偏应力 $q^{(f)} = 24.0 \\ \\mathrm{MPa}$ 与屈服值 $q_{yield} \\approx 23.93 \\ \\mathrm{MPa}$进行比较。\n由于 $q^{(f)} > q_{yield}$，最终状态位于 Mohr-Coulomb 准则定义的弹性域之外。对于此状态，屈服函数 $f(p', q) = q - M p' - q_0$ 将为正。在率无关弹塑性的背景下，这样的状态是不可达的，这意味着必须发生塑性屈服才能达到此状态，并且最终状态应位于屈服面上，而不是超出它。该问题是对给定应力状态的静态评估，我们的结论是该状态处于塑性域内。\n在最终 $p'$ 值下，MC 屈服线对应的 $q$ 值为 $q_{yield} \\approx 23.93 \\ \\mathrm{MPa}$，该值小于实际的 $q$ 值 $24.0 \\ \\mathrm{MPa}$。\n\n问题要求仅将任务 1 中的数值作为最终答案。\n\n$\\Delta p' = 10.25 \\ \\mathrm{MPa}$。", "answer": "$$\n\\boxed{10.25}\n$$", "id": "3521093"}, {"introduction": "在许多地质材料（如页岩）中，孔隙弹性的响应是各向异性的，这要求我们将毕奥（Biot）系数从一个标量推广到一个张量$\\boldsymbol{\\alpha}$。本练习要求你通过编程实现，探索这种张量形式的有效应力原理对三轴加载路径下应力不变量$p'$和$q$的影响。通过对比经典有效应力与广义张量有效应力的结果，你将深刻理解材料对称性如何改变有效应力状态，这是精确进行计算建模的关键一步。", "problem": "一个三维多孔固体被具有均匀孔隙压力的单一流体所饱和。考虑在试样坐标系中进行三轴加载，轴向与 $z$ 轴对齐，因此总柯西应力张量为\n$$\n\\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(\\sigma_1,\\,\\sigma_3,\\,\\sigma_3\\right),\n$$\n其中 $\\sigma_1$ 是轴向应力，$\\sigma_3$ 是径向（围压）应力。孔隙压力是一个空间均匀的标量 $u$。对于横观各向同性页岩，Biot有效应力系数是一个二阶张量。在材料对称坐标系中，层理面法向沿 $z$ 轴方向，Biot张量为\n$$\n\\boldsymbol{\\alpha}_\\mathrm{mat}=\\mathrm{diag}\\!\\left(\\alpha_h,\\,\\alpha_h,\\,\\alpha_v\\right),\n$$\n其中 $\\alpha_h$ 是面内（平行层理）系数，$\\alpha_v$ 是垂直层理系数。设层理法向相对于试样轴线绕 $y$ 轴（在 $x$–$z$ 平面内）旋转了一个角度 $\\theta$。将材料对称基映射到试样基的旋转矩阵是\n$$\n\\mathbf{R}(\\theta)=\\begin{bmatrix}\n\\cos\\theta  0  \\sin\\theta\\\\\n0  1  0\\\\\n-\\sin\\theta  0  \\cos\\theta\n\\end{bmatrix}.\n$$\n那么，在试样坐标系中的Biot张量为\n$$\n\\boldsymbol{\\alpha}=\\mathbf{R}(\\theta)\\,\\boldsymbol{\\alpha}_\\mathrm{mat}\\,\\mathbf{R}(\\theta)^\\top.\n$$\n多孔介质中的有效应力原理将总应力与骨架承受的应力关联如下。根据经典的Terzaghi原理，\n$$\n\\boldsymbol{\\sigma}'_\\mathrm{T}=\\boldsymbol{\\sigma}-u\\,\\mathbf{I},\n$$\n其中 $\\mathbf{I}$ 是单位张量。根据广义张量原理，\n$$\n\\boldsymbol{\\sigma}'_\\mathrm{G}=\\boldsymbol{\\sigma}-\\boldsymbol{\\alpha}\\,u.\n$$\n对于任意二阶应力张量 $\\boldsymbol{\\sigma}'$，定义平均有效应力\n$$\np'=\\frac{1}{3}\\,\\mathrm{tr}\\!\\left(\\boldsymbol{\\sigma}'\\right),\n$$\n偏应力张量\n$$\n\\mathbf{s}'=\\boldsymbol{\\sigma}'-p'\\,\\mathbf{I},\n$$\n以及von Mises型偏应力不变量\n$$\nq=\\sqrt{\\frac{3}{2}\\,\\mathbf{s}':\\mathbf{s}'},\n$$\n其中双点积为 $\\mathbf{A}:\\mathbf{B}=\\sum_{i=1}^3\\sum_{j=1}^3 A_{ij}B_{ij}$。这些不变量定义了三轴加载下 $(p',q)$ 空间中的应力路径。\n\n仅从这些定义和张量变换规则出发，推导并实现一个算法，对于给定的 $(\\sigma_1,\\sigma_3,u,\\alpha_h,\\alpha_v,\\theta)$，分别计算Terzaghi原理和广义张量原理下的 $(p'_\\mathrm{T},q_\\mathrm{T})$ 和 $(p'_\\mathrm{G},q_\\mathrm{G})$，从而量化各向异性 $\\boldsymbol{\\alpha}$ 对三轴应力路径的影响。所有应力必须以兆帕 (MPa) 表示，角度 $\\theta$ 必须以度表示。程序必须返回四舍五入到三位小数的值。\n\n您的程序应评估以下参数集测试套件，每组参数均以 $(\\sigma_1,\\sigma_3,u,\\alpha_h,\\alpha_v,\\theta)$ 的形式列出，单位为MPa和度：\n- 情况1：$(80,\\,20,\\,10,\\,0.60,\\,0.95,\\,30)$，\n- 情况2：$(60,\\,15,\\,5,\\,0.80,\\,0.80,\\,40)$，\n- 情况3：$(100,\\,30,\\,12,\\,0.50,\\,0.90,\\,0)$，\n- 情况4：$(70,\\,25,\\,8,\\,1.00,\\,1.00,\\,75)$，\n- 情况5：$(80,\\,20,\\,0,\\,0.60,\\,0.95,\\,45)$。\n\n对于每种情况，计算并报告列表 $[p'_\\mathrm{T},q_\\mathrm{T},p'_\\mathrm{G},q_\\mathrm{G}]$（全部以MPa为单位）。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是该情况四个数字的逗号分隔列表。例如，输出格式必须是：\n$$\n\\text{[}[p'_\\mathrm{T}^{(1)},q_\\mathrm{T}^{(1)},p'_\\mathrm{G}^{(1)},q_\\mathrm{G}^{(1)}],[p'_\\mathrm{T}^{(2)},q_\\mathrm{T}^{(2)},p'_\\mathrm{G}^{(2)},q_\\mathrm{G}^{(2)}],\\dots\\text{]},\n$$\n打印行中不含空格。", "solution": "该问题被评估为有效。它在科学上基于连续介质力学和多孔弹性力学的原理，对于每组输入都是适定的且具有唯一解，是客观的，并提供了一套完整且一致的定义和数据。\n\n目标是计算在两种不同的有效应力原理下（经典的Terzaghi原理和针对各向异性材料的广义张量原理），三轴加载的多孔固体的平均有效应力 $p'$ 和von Mises偏应力不变量 $q$。以下推导为计算算法提供了基础。\n\n首先，定义所有给定的参数。\n总柯西应力张量：$\\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(\\sigma_1,\\,\\sigma_3,\\,\\sigma_3\\right)$\n孔隙压力：$u$\nBiot系数：$\\alpha_h$（面内），$\\alpha_v$（法向）\n层理面旋转角度：$\\theta$\n\n求解过程涉及计算应力不变量 $(p'_\\mathrm{T}, q'_\\mathrm{T})$ 和 $(p'_\\mathrm{G}, q'_\\mathrm{G})$。\n\n**1. Terzaghi有效应力原理**\n\nTerzaghi有效应力张量 $\\boldsymbol{\\sigma}'_\\mathrm{T}$ 定义为：\n$$\n\\boldsymbol{\\sigma}'_\\mathrm{T} = \\boldsymbol{\\sigma} - u\\,\\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是二阶单位张量。鉴于 $\\boldsymbol{\\sigma}$ 是对角形式，Terzaghi有效应力张量也是对角的：\n$$\n\\boldsymbol{\\sigma}'_\\mathrm{T} = \\begin{bmatrix} \\sigma_1  0  0 \\\\ 0  \\sigma_3  0 \\\\ 0  0  \\sigma_3 \\end{bmatrix} - u \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{bmatrix} \\sigma_1-u  0  0 \\\\ 0  \\sigma_3-u  0 \\\\ 0  0  \\sigma_3-u \\end{bmatrix}\n$$\n\n平均有效应力 $p'_\\mathrm{T}$ 是 $\\boldsymbol{\\sigma}'_\\mathrm{T}$ 的迹的三分之一：\n$$\np'_\\mathrm{T} = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}'_\\mathrm{T}) = \\frac{1}{3} \\left( (\\sigma_1-u) + (\\sigma_3-u) + (\\sigma_3-u) \\right) = \\frac{1}{3} (\\sigma_1 + 2\\sigma_3 - 3u)\n$$\n\n偏应力张量 $\\mathbf{s}'_\\mathrm{T}$ 由 $\\mathbf{s}'_\\mathrm{T} = \\boldsymbol{\\sigma}'_\\mathrm{T} - p'_\\mathrm{T}\\mathbf{I}$ 给出。其分量为：\n$$\ns'_{T,11} = (\\sigma_1-u) - p'_\\mathrm{T} = \\frac{2}{3}(\\sigma_1 - \\sigma_3)\n$$\n$$\ns'_{T,22} = s'_{T,33} = (\\sigma_3-u) - p'_\\mathrm{T} = -\\frac{1}{3}(\\sigma_1 - \\sigma_3)\n$$\n偏应力与孔隙压力 $u$ 无关，因为它仅取决于总主应力之间的差值。\n\nvon Mises不变量 $q_\\mathrm{T}$ 定义为 $q_\\mathrm{T} = \\sqrt{\\frac{3}{2}\\,\\mathbf{s}'_\\mathrm{T}:\\mathbf{s}'_\\mathrm{T}}$。双点积是各分量的平方和：\n$$\n\\mathbf{s}'_\\mathrm{T}:\\mathbf{s}'_\\mathrm{T} = (s'_{T,11})^2 + (s'_{T,22})^2 + (s'_{T,33})^2 = \\left(\\frac{2}{3}(\\sigma_1 - \\sigma_3)\\right)^2 + 2\\left(-\\frac{1}{3}(\\sigma_1 - \\sigma_3)\\right)^2 = \\frac{2}{3}(\\sigma_1 - \\sigma_3)^2\n$$\n将此代入 $q_\\mathrm{T}$ 的定义中：\n$$\nq_\\mathrm{T} = \\sqrt{\\frac{3}{2} \\cdot \\frac{2}{3}(\\sigma_1 - \\sigma_3)^2} = \\sqrt{(\\sigma_1 - \\sigma_3)^2} = |\\sigma_1 - \\sigma_3|\n$$\n对于典型的三轴压缩试验，$\\sigma_1 \\ge \\sigma_3$，因此 $q_\\mathrm{T} = \\sigma_1 - \\sigma_3$。\n\n**2. 广义张量有效应力原理**\n\n广义有效应力张量 $\\boldsymbol{\\sigma}'_\\mathrm{G}$ 定义为：\n$$\n\\boldsymbol{\\sigma}'_\\mathrm{G} = \\boldsymbol{\\sigma} - \\boldsymbol{\\alpha}\\,u\n$$\n其中 $\\boldsymbol{\\alpha}$ 是试样坐标系中的Biot有效应力系数张量。它是通过使用给定的旋转矩阵 $\\mathbf{R}(\\theta)$ 将Biot张量从材料对称坐标系 $\\boldsymbol{\\alpha}_\\mathrm{mat}$ 旋转得到的：\n$$\n\\boldsymbol{\\alpha} = \\mathbf{R}(\\theta)\\,\\boldsymbol{\\alpha}_\\mathrm{mat}\\,\\mathbf{R}(\\theta)^\\top\n$$\n给定 $\\boldsymbol{\\alpha}_\\mathrm{mat}=\\mathrm{diag}\\!\\left(\\alpha_h,\\,\\alpha_h,\\,\\alpha_v\\right)$ 和 $\\mathbf{R}(\\theta)$，$\\boldsymbol{\\alpha}$ 的分量计算如下（令 $c = \\cos\\theta$，$s = \\sin\\theta$）：\n$$\n\\boldsymbol{\\alpha} = \\begin{bmatrix} c  0  s \\\\ 0  1  0 \\\\ -s  0  c \\end{bmatrix} \\begin{bmatrix} \\alpha_h  0  0 \\\\ 0  \\alpha_h  0 \\\\ 0  0  \\alpha_v \\end{bmatrix} \\begin{bmatrix} c  0  -s \\\\ 0  1  0 \\\\ s  0  c \\end{bmatrix} = \\begin{bmatrix} \\alpha_h c^2 + \\alpha_v s^2  0  (\\alpha_v - \\alpha_h)sc \\\\ 0  \\alpha_h  0 \\\\ (\\alpha_v - \\alpha_h)sc  0  \\alpha_h s^2 + \\alpha_v c^2 \\end{bmatrix}\n$$\n确定 $\\boldsymbol{\\alpha}$ 后，即可计算 $\\boldsymbol{\\sigma}'_\\mathrm{G}$ 的分量。\n\n平均有效应力 $p'_\\mathrm{G}$ 为：\n$$\np'_\\mathrm{G} = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}'_\\mathrm{G}) = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma} - \\boldsymbol{\\alpha}u) = \\frac{1}{3}\\left(\\mathrm{tr}(\\boldsymbol{\\sigma}) - u\\,\\mathrm{tr}(\\boldsymbol{\\alpha})\\right)\n$$\n$\\boldsymbol{\\sigma}$ 的迹是 $\\sigma_1 + 2\\sigma_3$。$\\boldsymbol{\\alpha}$ 的迹在旋转下是不变的：\n$$\n\\mathrm{tr}(\\boldsymbol{\\alpha}) = (\\alpha_h c^2 + \\alpha_v s^2) + \\alpha_h + (\\alpha_h s^2 + \\alpha_v c^2) = \\alpha_h(c^2+s^2) + \\alpha_v(s^2+c^2) + \\alpha_h = 2\\alpha_h + \\alpha_v\n$$\n因此，$p'_\\mathrm{G}$ 为：\n$$\np'_\\mathrm{G} = \\frac{1}{3} (\\sigma_1 + 2\\sigma_3 - u(2\\alpha_h + \\alpha_v))\n$$\n偏应力张量为 $\\mathbf{s}'_\\mathrm{G} = \\boldsymbol{\\sigma}'_\\mathrm{G} - p'_\\mathrm{G}\\mathbf{I}$。如果 $\\alpha_h \\neq \\alpha_v$ 且 $\\theta$ 不是 $90^\\circ$ 的倍数，则该张量通常具有非零的非对角分量。\n\nvon Mises不变量 $q_\\mathrm{G}$ 使用其定义计算：\n$$\nq_\\mathrm{G} = \\sqrt{\\frac{3}{2}\\,\\mathbf{s}'_\\mathrm{G}:\\mathbf{s}'_\\mathrm{G}}\n$$\n其中 $\\mathbf{s}'_\\mathrm{G}:\\mathbf{s}'_\\mathrm{G} = \\sum_{i,j} (s'_{G,ij})^2$。在计算上，直接以数值方式构造张量 $\\boldsymbol{\\sigma}$、$\\boldsymbol{\\alpha}$ 和 $\\boldsymbol{\\sigma}'_\\mathrm{G}$，然后计算 $p'_\\mathrm{G}$、$\\mathbf{s}'_\\mathrm{G}$，最后计算 $q_\\mathrm{G}$ 是很简单的。\n\n**实现算法**\n\n对于每组参数 $(\\sigma_1, \\sigma_3, u, \\alpha_h, \\alpha_v, \\theta)$：\n1. 将角度 $\\theta$ 从度转换为弧度。\n2. 计算 $p'_\\mathrm{T} = (\\sigma_1 + 2\\sigma_3 - 3u)/3$。\n3. 计算 $q_\\mathrm{T} = \\sigma_1 - \\sigma_3$。\n4. 构造总应力张量 $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1, \\sigma_3, \\sigma_3)$。\n5. 构造材料Biot张量 $\\boldsymbol{\\alpha}_\\mathrm{mat} = \\mathrm{diag}(\\alpha_h, \\alpha_h, \\alpha_v)$。\n6. 构造旋转矩阵 $\\mathbf{R}(\\theta)$。\n7. 计算试样Biot张量 $\\boldsymbol{\\alpha} = \\mathbf{R}(\\theta) \\boldsymbol{\\alpha}_\\mathrm{mat} \\mathbf{R}(\\theta)^\\top$。\n8. 计算广义有效应力张量 $\\boldsymbol{\\sigma}'_\\mathrm{G} = \\boldsymbol{\\sigma} - u\\boldsymbol{\\alpha}$。\n9. 计算广义平均有效应力 $p'_\\mathrm{G} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}'_\\mathrm{G})$。\n10. 计算广义偏应力张量 $\\mathbf{s}'_\\mathrm{G} = \\boldsymbol{\\sigma}'_\\mathrm{G} - p'_\\mathrm{G}\\mathbf{I}$。\n11. 计算双点积 $\\mathbf{s}'_\\mathrm{G}:\\mathbf{s}'_\\mathrm{G}$，即 $\\mathbf{s}'_\\mathrm{G}$ 各元素的平方和。\n12. 计算广义von Mises不变量 $q_\\mathrm{G} = \\sqrt{1.5 \\times (\\mathbf{s}'_\\mathrm{G}:\\mathbf{s}'_\\mathrm{G})}$。\n13. 收集四个值 $[p'_\\mathrm{T}, q_\\mathrm{T}, p'_\\mathrm{G}, q_\\mathrm{G}]$ 并四舍五入到三位小数。\n\n该算法针对每个提供的测试用例进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes effective stress invariants for triaxial loading on a transversely\n    isotropic porous solid, according to Terzaghi and general tensorial principles.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (sigma_1, sigma_3, u, alpha_h, alpha_v, theta_deg) in MPa and degrees.\n        (80.0, 20.0, 10.0, 0.60, 0.95, 30.0),\n        (60.0, 15.0, 5.0, 0.80, 0.80, 40.0),\n        (100.0, 30.0, 12.0, 0.50, 0.90, 0.0),\n        (70.0, 25.0, 8.0, 1.00, 1.00, 75.0),\n        (80.0, 20.0, 0.0, 0.60, 0.95, 45.0),\n    ]\n\n    def calculate_invariants(sigma_1, sigma_3, u, alpha_h, alpha_v, theta_deg):\n        \"\"\"\n        Calculates stress invariants for a single test case.\n        \"\"\"\n        # Identity tensor\n        I = np.identity(3)\n\n        # 1. Terzaghi Principle\n        p_prime_T = (sigma_1 + 2 * sigma_3 - 3 * u) / 3.0\n        # In triaxial compression, sigma_1 >= sigma_3\n        q_T = sigma_1 - sigma_3\n\n        # 2. General Tensorial Principle\n        \n        # Total Cauchy stress tensor\n        sigma = np.diag([sigma_1, sigma_3, sigma_3])\n\n        # Convert angle to radians and get sin/cos\n        theta_rad = np.deg2rad(theta_deg)\n        c = np.cos(theta_rad)\n        s = np.sin(theta_rad)\n\n        # Rotation matrix R\n        R = np.array([\n            [c, 0, s],\n            [0, 1, 0],\n            [-s, 0, c]\n        ])\n\n        # Biot tensor in material coordinates\n        alpha_mat = np.diag([alpha_h, alpha_h, alpha_v])\n\n        # Biot tensor in specimen coordinates\n        alpha = R @ alpha_mat @ R.T\n\n        # General effective stress tensor\n        sigma_prime_G = sigma - u * alpha\n\n        # Mean effective stress\n        p_prime_G = np.trace(sigma_prime_G) / 3.0\n\n        # Deviatoric effective stress tensor\n        s_prime_G = sigma_prime_G - p_prime_G * I\n\n        # Double contraction s':s' is the sum of squares of components (Frobenius norm squared)\n        s_prime_G_ddot_s_prime_G = np.sum(s_prime_G**2)\n\n        # von Mises invariant\n        q_G = np.sqrt(1.5 * s_prime_G_ddot_s_prime_G)\n\n        return [\n            round(p_prime_T, 3),\n            round(q_T, 3),\n            round(p_prime_G, 3),\n            round(q_G, 3)\n        ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_invariants(*case)\n        results.append(result)\n\n    # Format the output as specified: [[r1,r2,r3,r4],[...],...]\n    # Using repr() on the list of lists produces the desired string representation\n    # without spaces after commas.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3521089"}, {"introduction": "这个综合性练习将带你从头构建一个用于模拟一维固结问题的混合有限元（FEM）模型，这是计算多孔介质力学的基石。你将从力平衡、流体连续性和本构关系等基本原理出发，推导并实施一个耦合位移-压力（$\\mathbf{u}-p$）的求解器。这项实践将理论知识（如有效应力原理和达西定律）转化为一个强大的计算工具，让你能够模拟饱和多孔介质在荷载作用下的时间和空间演化。", "problem": "您需要推导、实现并测试一个混合有限元格式，该格式使用位移-压力主变量，用于模拟一维小应变、完全饱和的多孔柱在突加表面荷载作用下的准静态固结过程。从基本平衡定律和有效应力原理出发，为未知位移场 $u(x,t)$ 和孔隙压力场 $p(x,t)$ 推导弱形式和一个一致的半离散系统，然后实现后向欧拉时间积分和双节点线性有限元离散化。代码必须能组装全局矩阵，施加本质边界条件和自然边界条件，随时间推进求解，并为一组测试用例生成指定的输出。\n\n推导必须从以下基本陈述开始：\n\n- 一维小应变运动学：轴向应变为 $\\varepsilon(x,t) = \\dfrac{du(x,t)}{dx}$。\n- Terzaghi 有效应力原理的推广形式：总轴向应力为 $\\sigma(x,t) = \\sigma'(x,t) + \\alpha\\,p(x,t)$，其中 $\\sigma'(x,t)$ 是有效轴向应力，$p(x,t)$ 是孔隙压力，$\\alpha$ 是 Biot 系数（$0 \\le \\alpha \\le 1$）。对于线性弹性骨架，$\\sigma'(x,t) = E\\,\\varepsilon(x,t)$，其中 $E$ 是杨氏模量。\n- 准静态力平衡（无惯性力，无体力）：在域内 $\\dfrac{d\\sigma(x,t)}{dx} = 0$。\n- 流体质量守恒和 Darcy 定律：单位体积的流体含量增量为 $d\\zeta = \\alpha\\,d\\varepsilon + \\dfrac{1}{M}\\,dp$，其中 $M$ 是 Biot 模量，Darcy 通量为 $q(x,t) = -\\dfrac{k}{\\mu}\\,\\dfrac{dp(x,t)}{dx}$，其中 $k$ 为固有渗透率，$\\mu$ 为动力粘度。连续性方程为 $\\dfrac{d\\zeta}{dt} + \\dfrac{dq}{dx} = 0$。\n\n基于以上公式，推导适用于混合有限元离散化的弱形式，其中位移的试函数为 $w(x)$，压力的试函数为 $\\eta(x)$，作用于具有恒定横截面积 $A$ 的一维域 $\\Omega=[0,L]$ 上。该弱形式将导出一个通过一致矩阵耦合节点位移和节点压力的半离散线性系统。使用带有标准形函数的双节点线性单元。\n\n实现以下物理上和数值上适定的边界条件和初始条件：\n\n- 几何：长度为 $L$、横截面积恒为 $A$ 的柱体。\n- 力学边界条件：本质边界条件 $u(0,t)=0$（在 $x=0$ 处为固定底座）；在顶部 $x=L$ 处的自然边界条件，在 $t=0^{+}$ 时施加一个大小为 $\\Delta\\sigma$ 的均匀压缩面力，此后保持不变。轴向朝下为正方向，因此压缩产生正位移 $u$。\n- 水力边界条件：本质边界条件 $p(L,t)=0$（顶部排水）；在 $x=0$ 处的自然无流动边界（不透水底座）。\n- $t=0$ 时的初始条件：处处 $u(x,0)=0$；在内部 $p(x,0)=\\Delta\\sigma$，并在顶部满足排水边界条件 $p(L,0)=0$。\n\n将域离散为 $N_e$ 个等长的双节点线性单元。组装由弱形式产生的全局矩阵，并使用后向欧拉时间积分（时间步长为 $\\Delta t$，总时间为 $T$）来推进半离散系统。通过直接修改全局系统来施加本质边界条件（即将相应的行设为单位向量，列设为零向量，并将右侧项设置为指定值）。\n\n您的程序必须为每个测试用例计算顶部的最终沉降 $u(L,T)$（单位：米）和底部的最终孔隙压力 $p(0,T)$（单位：帕斯卡）。程序必须生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表，顺序为 $[u_1,p_1,u_2,p_2,u_3,p_3]$，其中下标表示测试用例的索引。\n\n所有物理量均使用其标准的国际单位制（SI）单位表示。具体而言，位移单位为米，压力单位为帕斯卡。不涉及角度。任何分数量必须表示为小数。\n\n使用以下参数集组成的测试套件来检验不同的工况：\n\n- 测试用例 1（中等渗透性，中等压缩性，常规路径）：\n  - $L = 1.0\\,\\text{m}$，$A = 1.0\\,\\text{m}^2$，$N_e = 20$。\n  - $E = 5.0\\times 10^{7}\\,\\text{Pa}$，$\\alpha = 1.0$，$M = 2.0\\times 10^{9}\\,\\text{Pa}$。\n  - $k = 1.0\\times 10^{-12}\\,\\text{m}^2$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n  - $\\Delta\\sigma = 1.0\\times 10^{5}\\,\\text{Pa}$，$\\Delta t = 1.0\\times 10^{3}\\,\\text{s}$，$T = 1.0\\times 10^{5}\\,\\text{s}$。\n\n- 测试用例 2（高渗透性，快速固结，边界条件覆盖）：\n  - $L = 1.0\\,\\text{m}$，$A = 1.0\\,\\text{m}^2$，$N_e = 20$。\n  - $E = 5.0\\times 10^{7}\\,\\text{Pa}$，$\\alpha = 1.0$，$M = 2.0\\times 10^{9}\\,\\text{Pa}$。\n  - $k = 1.0\\times 10^{-9}\\,\\text{m}^2$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n  - $\\Delta\\sigma = 1.0\\times 10^{5}\\,\\text{Pa}$，$\\Delta t = 1.0\\times 10^{3}\\,\\text{s}$，$T = 1.0\\times 10^{4}\\,\\text{s}$。\n\n- 测试用例 3（大 Biot 模量和更刚性的骨架，存储的边缘情况）：\n  - $L = 1.0\\,\\text{m}$，$A = 1.0\\,\\text{m}^2$，$N_e = 20$。\n  - $E = 5.0\\times 10^{8}\\,\\text{Pa}$，$\\alpha = 1.0$，$M = 1.0\\times 10^{12}\\,\\text{Pa}$。\n  - $k = 1.0\\times 10^{-12}\\,\\text{m}^2$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n  - $\\Delta\\sigma = 1.0\\times 10^{5}\\,\\text{Pa}$，$\\Delta t = 1.0\\times 10^{3}\\,\\text{s}$，$T = 1.0\\times 10^{5}\\,\\text{s}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[u_1,p_1,u_2,p_2,u_3,p_3]$），其中每个 $u_i$ 的单位是米（$\\text{m}$），每个 $p_i$ 的单位是帕斯卡（$\\text{Pa}$）。", "solution": "我们从微小应变运动学和有效应力原理出发，展示如何为一维饱和多孔柱推导出一个混合的位移-压力有限元系统。\n\n运动学和本构关系：轴向应变为 $\\varepsilon(x,t) = \\dfrac{du(x,t)}{dx}$。对于线性弹性骨架，有效轴向应力为 $\\sigma'(x,t) = E\\,\\varepsilon(x,t)$，总轴向应力为 $\\sigma(x,t) = \\sigma'(x,t) + \\alpha\\,p(x,t) = E\\,\\dfrac{du}{dx} + \\alpha p$。\n\n动量平衡：在准静态且无体力条件下，线性动量平衡方程为在 $\\Omega = [0,L]$ 上 $\\dfrac{d\\sigma}{dx} = 0$。代入 $\\sigma$ 得 $\\dfrac{d}{dx}\\left(E\\,\\dfrac{du}{dx}\\right) + \\alpha\\,\\dfrac{dp}{dx} = 0$。\n\n流体质量平衡和 Darcy 定律：单位体积流体含量的增量为 $d\\zeta = \\alpha\\,d\\varepsilon + \\dfrac{1}{M}\\,dp$，因此 $\\dfrac{d\\zeta}{dt} = \\alpha\\,\\dfrac{d\\varepsilon}{dt} + \\dfrac{1}{M}\\,\\dfrac{dp}{dt} = \\alpha\\,\\dfrac{d}{dt}\\left(\\dfrac{du}{dx}\\right) + \\dfrac{1}{M}\\,\\dfrac{dp}{dt}$。Darcy 定律给出 $q = -\\dfrac{k}{\\mu}\\,\\dfrac{dp}{dx}$。连续性方程 $\\dfrac{d\\zeta}{dt} + \\dfrac{dq}{dx} = 0$ 则导出\n$$\n\\alpha\\,\\dfrac{d}{dt}\\left(\\dfrac{du}{dx}\\right) + \\dfrac{1}{M}\\,\\dfrac{dp}{dt} - \\dfrac{d}{dx}\\left(\\dfrac{k}{\\mu}\\,\\dfrac{dp}{dx}\\right) = 0 \\quad \\text{on } \\Omega.\n$$\n\n弱形式：设 $w(x)$ 为一个容许的位移试函数（由于 $x=0$ 处的本质边界条件，有 $w(0)=0$），并设 $\\eta(x)$ 为一个容许的压力试函数（如果 $p(L,t)$ 是给定的，则 $\\eta(L)=0$）。将动量方程乘以 $w(x)$，并在横截面积 $A$ 和域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} A\\,E\\,\\dfrac{du}{dx}\\,\\dfrac{dw}{dx}\\,dx + \\int_{\\Omega} A\\,\\alpha\\,p\\,\\dfrac{dw}{dx}\\,dx = \\int_{\\partial\\Omega_t} A\\,\\bar{t}\\,w\\,ds,\n$$\n其中 $\\bar{t} = \\Delta\\sigma$ 是在 $x=L$ 处施加的面力。对于质量平衡方程，乘以 $\\eta(x)$ 并积分：\n$$\n\\int_{\\Omega} A\\,\\alpha\\,\\eta\\,\\dfrac{d}{dt}\\left(\\dfrac{du}{dx}\\right)\\,dx + \\int_{\\Omega} A\\,\\dfrac{1}{M}\\,\\eta\\,\\dfrac{dp}{dt}\\,dx + \\int_{\\Omega} A\\,\\dfrac{k}{\\mu}\\,\\dfrac{d\\eta}{dx}\\,\\dfrac{dp}{dx}\\,dx = 0.\n$$\n这些弱形式自然地为混合格式导出了一致的有限元矩阵。\n\n有限元离散化：将 $\\Omega$ 划分为 $N_e$ 个等长的双节点线性单元，每个单元的长度为 $l_e = \\dfrac{L}{N_e}$。将场近似表示为 $u(x,t) \\approx \\sum_{a=1}^{N_n} N_a(x)\\,u_a(t)$ 和 $p(x,t) \\approx \\sum_{b=1}^{N_n} N_b(x)\\,p_b(t)$，其中有 $N_n=N_e+1$ 个节点，且每个单元上都有标准的线性形函数。轴向应变 $\\varepsilon \\approx \\sum_a B_a(x)\\,u_a$，其中 $B_a(x) = \\dfrac{dN_a}{dx}$ 在每个单元上是常数。对于一个具有节点 $i$ 和 $j$ 的典型单元，$B_i = -\\dfrac{1}{l_e}$ 和 $B_j = \\dfrac{1}{l_e}$，而 $N_i$ 和 $N_j$ 是线性形函数。\n\n由弱形式产生的单元矩阵是：\n- 位移刚度：\n$$\n\\mathbf{K}_{uu}^{(e)} = \\int_{\\Omega_e} A\\,E\\,\\mathbf{B}^T \\mathbf{B}\\,dx = \\dfrac{A\\,E}{l_e}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}.\n$$\n- 动量方程中的位移-压力耦合：\n$$\n\\mathbf{K}_{up}^{(e)} = \\int_{\\Omega_e} A\\,\\alpha\\,\\mathbf{B}^T \\mathbf{N}\\,dx = A\\,\\alpha \\begin{bmatrix} -\\dfrac{1}{2}  -\\dfrac{1}{2} \\\\ \\dfrac{1}{2}  \\dfrac{1}{2} \\end{bmatrix},\n$$\n其中 $\\mathbf{N} = [N_i, N_j]$ 和 $\\mathbf{B} = [-\\dfrac{1}{l_e}, \\dfrac{1}{l_e}]$。\n- 压力质量（存储）：\n$$\n\\mathbf{S}_{pp}^{(e)} = \\int_{\\Omega_e} A\\,\\mathbf{N}^T \\mathbf{N}\\,dx = \\dfrac{A\\,l_e}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}.\n$$\n- 质量方程中的位移-压力耦合（在常系数下，由于弱形式的对称性，它是 $\\mathbf{K}_{up}^{(e)}$ 的转置）：\n$$\n\\mathbf{C}_{pu}^{(e)} = \\int_{\\Omega_e} A\\,\\alpha\\,\\mathbf{N}^T \\mathbf{B}\\,dx = \\left(\\mathbf{K}_{up}^{(e)}\\right)^T.\n$$\n- 压力扩散（Darcy）：\n$$\n\\mathbf{H}_{pp}^{(e)} = \\int_{\\Omega_e} A\\,\\dfrac{k}{\\mu}\\,\\left(\\dfrac{d\\mathbf{N}}{dx}\\right)^T \\left(\\dfrac{d\\mathbf{N}}{dx}\\right)\\,dx = \\dfrac{A}{l_e}\\,\\dfrac{k}{\\mu}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}.\n$$\n\n全局组装：通过将单元贡献累加到相应的全局自由度上，组装 $\\mathbf{K}_{uu}$、$\\mathbf{K}_{up}$、$\\mathbf{S}_{pp}$ 和 $\\mathbf{H}_{pp}$。全局未知向量为 $\\mathbf{x} = \\begin{bmatrix} \\mathbf{u} \\\\ \\mathbf{p} \\end{bmatrix}$，大小为 $N_n + N_n$。\n\n时间离散化：使用后向欧拉法在一个时间步长 $\\Delta t$ 上近似 $\\dot{\\mathbf{u}} \\approx \\dfrac{\\mathbf{u}^{n+1}-\\mathbf{u}^{n}}{\\Delta t}$ 和 $\\dot{\\mathbf{p}} \\approx \\dfrac{\\mathbf{p}^{n+1}-\\mathbf{p}^{n}}{\\Delta t}$。在时间层 $n+1$ 的半离散分块系统是\n$$\n\\begin{bmatrix}\n\\mathbf{K}_{uu}  \\mathbf{K}_{up} \\\\\n\\dfrac{1}{\\Delta t}\\,\\mathbf{C}_{pu}  \\dfrac{1}{M\\,\\Delta t}\\,\\mathbf{S}_{pp} + \\mathbf{H}_{pp}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u}^{n+1} \\\\ \\mathbf{p}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f}_u \\\\ \\dfrac{1}{\\Delta t}\\,\\mathbf{C}_{pu}\\,\\mathbf{u}^{n} + \\dfrac{1}{M\\,\\Delta t}\\,\\mathbf{S}_{pp}\\,\\mathbf{p}^{n}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{f}_u$ 是由施加的面力产生的全局力学荷载向量，在顶部节点处其值为 $A\\,\\Delta\\sigma$，其他位置为零。通过修改全局系统来施加本质边界条件，即在每个时间步将相应的行设置为单位向量，列设置为零向量，并将右端项的条目设置为给定值 $u(0,t)=0$ 和 $p(L,t)=0$。\n\n边界和初始条件：在 $t=0$ 时，设置 $\\mathbf{u}^{0} = \\mathbf{0}$。在所有内部节点上设置 $\\mathbf{p}^{0} = \\Delta\\sigma$，并在顶部节点处施加 $p(L,0)=0$ 以满足排水边界。底部的水力边界是自然无流动边界，无需直接修改。顶部的力学面力 $\\Delta\\sigma$ 在顶部节点的位移自由度上产生一个大小为 $A\\,\\Delta\\sigma$ 的节点力。\n\n算法概述：\n\n- 对于给定的 $L$、$A$、$N_e$、$E$、$\\alpha$、$M$、$k$、$\\mu$、$\\Delta\\sigma$、$\\Delta t$ 和 $T$，生成一个具有 $N_n=N_e+1$ 个节点和单元长度 $l_e=\\dfrac{L}{N_e}$ 的均匀网格。\n- 组装全局矩阵 $\\mathbf{K}_{uu}$、$\\mathbf{K}_{up}$、$\\mathbf{S}_{pp}$ 和 $\\mathbf{H}_{pp}$。\n- 按照描述初始化 $\\mathbf{u}^{0}=\\mathbf{0}$ 和 $\\mathbf{p}^{0}$，并施加 $p(L,0)=0$。\n- 对于 $n=0,1,\\dots,N_{\\text{steps}}-1$（其中 $N_{\\text{steps}}=\\dfrac{T}{\\Delta t}$），建立分块矩阵和右端项，对 $u(0,t)$ 和 $p(L,t)$ 施加本质边界条件，求解 $\\mathbf{u}^{n+1}$ 和 $\\mathbf{p}^{n+1}$，并更新状态。\n- 在 $t=T$ 时，提取顶部沉降 $u(L,T)$ 和底部孔隙压力 $p(0,T)$。\n\n各测试用例的预期行为：\n- 对于测试用例 1，固结是中等的：最终沉降接近排水值 $u_{\\text{drained}} \\approx \\dfrac{\\Delta\\sigma\\,L}{E}$，并且由于渗透性有限，在给定的时间 $T$ 后，底部孔隙压力会衰减但仍为有限值。\n- 对于测试用例 2，高渗透性（$k$ 值大）导致孔隙压力快速消散，在较短的时间 $T$ 内，沉降接近排水极限。\n- 对于测试用例 3，大的 Biot 模量 $M$ 和刚性骨架 $E$ 减小了储水能力和沉降量；孔隙压力的演化主要由耦合而非储水主导，这为混合格式提供了一个严格的稳定性测试。\n\n最终程序为每个测试用例组装并推进混合位移-压力有限元模型，并打印一行包含六个浮点数输出 $[u_1,p_1,u_2,p_2,u_3,p_3]$ 的结果，其中每个 $u_i$ 的单位是米（$\\text{m}$），每个 $p_i$ 的单位是帕斯卡（$\\text{Pa}$）。", "answer": "```python\n# Python 3.12 program implementing a 1D mixed u-p finite element consolidation model\n# Environment: numpy==1.23.5, scipy==1.11.4 (scipy not used)\nimport numpy as np\n\ndef assemble_mixed_matrices(L, A, Ne, E, alpha, k, mu, M):\n    \"\"\"\n    Assemble global matrices for the mixed u-p finite element formulation in 1D.\n    Uses two-node linear elements over a uniform mesh.\n    Returns Kuu, Kup, Spp, Hpp, element length le, number of nodes Nn.\n    \"\"\"\n    Nn = Ne + 1\n    le = L / Ne\n\n    # Initialize global matrices\n    Kuu = np.zeros((Nn, Nn), dtype=float)\n    Kup = np.zeros((Nn, Nn), dtype=float)\n    Spp = np.zeros((Nn, Nn), dtype=float)\n    Hpp = np.zeros((Nn, Nn), dtype=float)\n\n    # Element matrices (constants per element)\n    Kuu_e = (A * E / le) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    Kup_e = (A * alpha) * np.array([[-0.5, -0.5], [0.5, 0.5]])\n    Spp_e = (A * le / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    Hpp_e = (A * (k / mu) / le) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n\n    # Assemble\n    for e in range(Ne):\n        i = e\n        j = e + 1\n        # Displacement stiffness\n        Kuu[i, i] += Kuu_e[0, 0]\n        Kuu[i, j] += Kuu_e[0, 1]\n        Kuu[j, i] += Kuu_e[1, 0]\n        Kuu[j, j] += Kuu_e[1, 1]\n        # Displacement-pressure coupling (momentum)\n        Kup[i, i] += Kup_e[0, 0]\n        Kup[i, j] += Kup_e[0, 1]\n        Kup[j, i] += Kup_e[1, 0]\n        Kup[j, j] += Kup_e[1, 1]\n        # Pressure mass\n        Spp[i, i] += Spp_e[0, 0]\n        Spp[i, j] += Spp_e[0, 1]\n        Spp[j, i] += Spp_e[1, 0]\n        Spp[j, j] += Spp_e[1, 1]\n        # Pressure diffusion\n        Hpp[i, i] += Hpp_e[0, 0]\n        Hpp[i, j] += Hpp_e[0, 1]\n        Hpp[j, i] += Hpp_e[1, 0]\n        Hpp[j, j] += Hpp_e[1, 1]\n\n    return Kuu, Kup, Spp, Hpp, le, Nn\n\ndef apply_dirichlet_block(A, b, fixed_indices_values):\n    \"\"\"\n    Apply Dirichlet boundary conditions to a global block matrix A and RHS b.\n    fixed_indices_values: list of tuples (global_index, value)\n    Sets row to identity, column to zero, RHS to value.\n    \"\"\"\n    for gi, val in fixed_indices_values:\n        # Zero row and column, set diagonal to 1\n        A[gi, :] = 0.0\n        A[:, gi] = 0.0\n        A[gi, gi] = 1.0\n        b[gi] = val\n\ndef run_case(params):\n    \"\"\"\n    Run a single test case and return final top settlement u(L,T) and bottom pressure p(0,T).\n    params: dict containing the model parameters.\n    \"\"\"\n    L = params[\"L\"]\n    A = params[\"A\"]\n    Ne = params[\"Ne\"]\n    E = params[\"E\"]\n    alpha = params[\"alpha\"]\n    M = params[\"M\"]\n    k = params[\"k\"]\n    mu = params[\"mu\"]\n    dsig = params[\"dsig\"]\n    dt = params[\"dt\"]\n    T = params[\"T\"]\n\n    # Assemble constant global matrices\n    Kuu, Kup, Spp, Hpp, le, Nn = assemble_mixed_matrices(L, A, Ne, E, alpha, k, mu, M)\n    Cpu = Kup.T  # Symmetric coupling under constant coefficients\n\n    # Initial conditions\n    u_prev = np.zeros(Nn, dtype=float)\n    p_prev = np.full(Nn, dsig, dtype=float)\n    # Enforce drained top boundary at t=0: p(L,0) = 0\n    p_prev[-1] = 0.0\n\n    # Mechanical load vector due to traction at top: f_u(last node) = A * dsig\n    f_u = np.zeros(Nn, dtype=float)\n    f_u[-1] = A * dsig\n\n    # Time stepping\n    nsteps = int(round(T / dt))\n    # Precompute scaled matrices\n    Cpu_dt = (1.0 / dt) * Cpu\n    S_over_dt = (1.0 / (M * dt)) * Spp\n\n    Nu = Nn\n    Np = Nn\n    total_dofs = Nu + Np\n\n    for _ in range(nsteps):\n        # Build block matrix and RHS\n        A11 = Kuu\n        A12 = Kup\n        A21 = Cpu_dt\n        A22 = S_over_dt + Hpp\n\n        # Block assembly\n        top_block = np.hstack((A11, A12))\n        bottom_block = np.hstack((A21, A22))\n        Aglob = np.vstack((top_block, bottom_block))\n\n        # RHS\n        bu = f_u.copy()\n        bp = Cpu_dt.dot(u_prev) + S_over_dt.dot(p_prev)\n        bglob = np.concatenate((bu, bp))\n\n        # Apply Dirichlet: u(0) = 0, p(L) = 0\n        fixed = []\n        # Displacement at node 0\n        fixed.append((0, 0.0))\n        # Pressure at top node (global index offset by Nu)\n        fixed.append((Nu + (Nn - 1), 0.0))\n        apply_dirichlet_block(Aglob, bglob, fixed)\n\n        # Solve\n        x = np.linalg.solve(Aglob, bglob)\n        u_new = x[:Nu]\n        p_new = x[Nu:]\n\n        # Update\n        u_prev = u_new\n        p_prev = p_new\n\n    # Extract final top settlement and bottom pressure\n    u_top = u_prev[-1]\n    p_bottom = p_prev[0]\n    return float(u_top), float(p_bottom)\n\ndef solve():\n    # Define test cases\n    test_cases = [\n        {\n            \"L\": 1.0,\n            \"A\": 1.0,\n            \"Ne\": 20,\n            \"E\": 5.0e7,\n            \"alpha\": 1.0,\n            \"M\": 2.0e9,\n            \"k\": 1.0e-12,\n            \"mu\": 1.0e-3,\n            \"dsig\": 1.0e5,\n            \"dt\": 1.0e3,\n            \"T\": 1.0e5,\n        },\n        {\n            \"L\": 1.0,\n            \"A\": 1.0,\n            \"Ne\": 20,\n            \"E\": 5.0e7,\n            \"alpha\": 1.0,\n            \"M\": 2.0e9,\n            \"k\": 1.0e-9,\n            \"mu\": 1.0e-3,\n            \"dsig\": 1.0e5,\n            \"dt\": 1.0e3,\n            \"T\": 1.0e4,\n        },\n        {\n            \"L\": 1.0,\n            \"A\": 1.0,\n            \"Ne\": 20,\n            \"E\": 5.0e8,\n            \"alpha\": 1.0,\n            \"M\": 1.0e12,\n            \"k\": 1.0e-12,\n            \"mu\": 1.0e-3,\n            \"dsig\": 1.0e5,\n            \"dt\": 1.0e3,\n            \"T\": 1.0e5,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        u_top, p_bottom = run_case(case)\n        results.append(u_top)\n        results.append(p_bottom)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3521008"}]}