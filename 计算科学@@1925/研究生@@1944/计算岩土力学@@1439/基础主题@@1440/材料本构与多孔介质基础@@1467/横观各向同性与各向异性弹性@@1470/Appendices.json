{"hands_on_practices": [{"introduction": "横观各向同性材料的五个独立弹性常数不仅仅是数学模型中的抽象参数，更是必须通过实验测量的物理属性。本练习旨在挑战您设计一套最简化且完备的实验室测试方案，以精确确定这些常数。这有助于您将抽象的本构关系与实际的力学实验紧密联系起来，这是从理论走向工程实践的关键一步。[@problem_id:3568653]", "problem": "一个均匀的线性弹性横观各向同性 (TI) 岩土材料试样，其已知的材料对称轴与坐标方向 $x_3$ 对齐。在小应变假设下，应力分量为 $\\sigma_1$、$\\sigma_2$、$\\sigma_3$、$\\tau_{23}$、$\\tau_{13}$、$\\tau_{12}$，应变分量为 $\\epsilon_1$、$\\epsilon_2$、$\\epsilon_3$、$\\gamma_{23}$、$\\gamma_{13}$、$\\gamma_{12}$，采用标准的Voigt标记法。对于对称轴为 $x_3$ 的横观各向同性弹性问题，有五个独立的工程常数：平面内杨氏模量 $E_\\perp$（沿 $x_1$ 和 $x_2$ 方向相同），轴向杨氏模量 $E_\\parallel$（沿 $x_3$ 方向），平面内泊松比 $\\nu_{12}$，轴向对面内泊松比 $\\nu_{13}$，以及包含对称轴的平面内的剪切模量 $G_{13}$（因对称性而等于 $G_{23}$）。平面内剪切模量 $G_{12}$ 不是独立的，因为垂直于 $x_3$ 的平面是各向同性的。\n\n你的任务是选择一个最少且完备的实验室测试组合，该组合仅使用平行和垂直于对称轴的单轴加载，以及在包含对称轴的平面内和垂直于对称轴的平面内进行的剪切试验，来唯一地确定五个独立的横观各向同性工程常数，并且不使用平面应力或平面应变近似，也不依赖多轴比例加载。每个试验描述必须指明施加的非零应力分量、所有其他应力保持为零的条件，以及为确保常数的可识别性而必须测量的应变分量。考虑到实际的数据采集中，在单轴试验中可以同时测量轴向和横向应变，在纯剪切试验中可以测量剪切应变。\n\n哪个选项提供了这样一个最少且完备的测试组合？\n\nA. 试验 $1$：平行于 $x_3$ 进行单轴加载，施加 $\\sigma_3 \\neq 0$，同时 $\\sigma_1=\\sigma_2=\\tau_{23}=\\tau_{13}=\\tau_{12}=0$，测量 $\\epsilon_3$ 以及 $\\epsilon_1$ 或 $\\epsilon_2$。试验 $2$：垂直于 $x_3$ 进行单轴加载，施加 $\\sigma_1 \\neq 0$，同时 $\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{13}=\\tau_{12}=0$，测量 $\\epsilon_1$ 和 $\\epsilon_2$。试验 $3$：在包含对称轴的平面内进行纯剪切，施加 $\\tau_{13} \\neq 0$，同时 $\\sigma_1=\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{12}=0$，测量 $\\gamma_{13}$。试验 $4$：在垂直于对称轴的平面内进行纯剪切，施加 $\\tau_{12} \\neq 0$，同时 $\\sigma_1=\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{13}=0$，测量 $\\gamma_{12}$。\n\nB. 试验 $1$：平行于 $x_3$ 进行单轴加载，施加 $\\sigma_3 \\neq 0$，仅测量 $\\epsilon_3$。试验 $2$：垂直于 $x_3$ 进行单轴加载，施加 $\\sigma_1 \\neq 0$，仅测量 $\\epsilon_1$。试验 $3$：在包含对称轴的平面内进行纯剪切，施加 $\\tau_{13} \\neq 0$，测量 $\\gamma_{13}$。试验 $4$：在垂直于对称轴的平面内进行纯剪切，施加 $\\tau_{12} \\neq 0$，测量 $\\gamma_{12}$。\n\nC. 试验 $1$：平行于 $x_3$ 进行单轴加载，施加 $\\sigma_3 \\neq 0$，测量 $\\epsilon_3$ 和 $\\epsilon_2$。试验 $2$：垂直于 $x_3$ 进行单轴加载，施加等量双轴平面内加载 $\\sigma_1=\\sigma_2 \\neq 0$，仅测量 $\\epsilon_1$。试验 $3$：在垂直于对称轴的平面内进行纯剪切，施加 $\\tau_{12} \\neq 0$，测量 $\\gamma_{12}$。试验 $4$：省略在包含对称轴的平面内的剪切试验。\n\nD. 试验 $1$：静水压力压缩，施加 $\\sigma_1=\\sigma_2=\\sigma_3 \\neq 0$，测量体积应变 $\\epsilon_1+\\epsilon_2+\\epsilon_3$。试验 $2$：垂直于 $x_3$ 进行单轴加载，施加 $\\sigma_1 \\neq 0$，测量 $\\epsilon_1$ 和 $\\epsilon_3$。试验 $3$：在包含对称轴的平面内进行纯剪切，施加 $\\tau_{23} \\neq 0$，测量 $\\gamma_{23}$。试验 $4$：省略在垂直于对称轴的平面内的剪切试验。\n\nE. 试验 $1$：平行于 $x_3$ 进行单轴加载，施加 $\\sigma_3 \\neq 0$，测量 $\\epsilon_3$ 和 $\\epsilon_1$。试验 $2$：垂直于 $x_3$ 进行单轴加载，施加 $\\sigma_1 \\neq 0$，测量 $\\epsilon_1$ 和 $\\epsilon_3$。试验 $3$：对圆柱体绕 $x_3$ 轴施加扭转，解释测得的扭转以获得 $G_{13}$。试验 $4$：省略在垂直于对称轴的平面内的剪切试验。\n\n选择唯一最佳选项。", "solution": "首先，写出对称轴沿 $x_3$ 的横观各向同性 (TI) 材料的线性弹性本构关系的柔度形式：\n$$\n\\begin{bmatrix}\n\\epsilon_1\\\\\n\\epsilon_2\\\\\n\\epsilon_3\\\\\n\\gamma_{23}\\\\\n\\gamma_{13}\\\\\n\\gamma_{12}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nS_{11} & S_{12} & S_{13} & 0 & 0 & 0\\\\\nS_{12} & S_{11} & S_{13} & 0 & 0 & 0\\\\\nS_{13} & S_{13} & S_{33} & 0 & 0 & 0\\\\\n0 & 0 & 0 & S_{44} & 0 & 0\\\\\n0 & 0 & 0 & 0 & S_{44} & 0\\\\\n0 & 0 & 0 & 0 & 0 & S_{66}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\sigma_1\\\\\n\\sigma_2\\\\\n\\sigma_3\\\\\n\\tau_{23}\\\\\n\\tau_{13}\\\\\n\\tau_{12}\n\\end{bmatrix}.\n$$\n五个独立的工程常数通过以下关系与柔度系数相关：\n$$\nS_{11}=\\frac{1}{E_\\perp},\\quad\nS_{33}=\\frac{1}{E_\\parallel},\\quad\nS_{12}=-\\frac{\\nu_{12}}{E_\\perp},\\quad\nS_{13}=-\\frac{\\nu_{13}}{E_\\parallel},\\quad\nS_{44}=\\frac{1}{G_{13}}.\n$$\n因为 $x_1x_2$ 平面是各向同性的，所以 $G_{12}$ 不是独立的，并遵循以下关系：\n$$\nS_{66}=\\frac{1}{G_{12}}=\\frac{2(1+\\nu_{12})}{E_\\perp},\\qquad G_{12}=\\frac{E_\\perp}{2(1+\\nu_{12})}.\n$$\n现在我们展示如何通过特定的简单应力状态和相应的应变测量来确定每个常数。\n\n平行于对称轴的单轴加载：施加 $\\sigma_3\\neq 0$，所有其他应力为零。则\n$$\n\\epsilon_3 = S_{33}\\sigma_3 = \\frac{\\sigma_3}{E_\\parallel},\\qquad\n\\epsilon_1 = S_{13}\\sigma_3 = -\\frac{\\nu_{13}}{E_\\parallel}\\sigma_3,\\qquad\n\\epsilon_2 = S_{13}\\sigma_3.\n$$\n从测得的 $\\epsilon_3$ 以及 $\\epsilon_1$ 或 $\\epsilon_2$，我们得到：\n$$\nE_\\parallel = \\frac{\\sigma_3}{\\epsilon_3},\\qquad\n\\nu_{13} = -\\frac{\\epsilon_1}{\\epsilon_3} = -\\frac{\\epsilon_2}{\\epsilon_3}.\n$$\n\n垂直于对称轴的单轴加载：例如，施加 $\\sigma_1\\neq 0$，所有其他应力为零。则\n$$\n\\epsilon_1 = S_{11}\\sigma_1 = \\frac{\\sigma_1}{E_\\perp},\\qquad\n\\epsilon_2 = S_{12}\\sigma_1 = -\\frac{\\nu_{12}}{E_\\perp}\\sigma_1,\\qquad\n\\epsilon_3 = S_{13}\\sigma_1 = -\\frac{\\nu_{13}}{E_\\parallel}\\sigma_1.\n$$\n从测得的 $\\epsilon_1$ 和 $\\epsilon_2$，我们得到：\n$$\nE_\\perp = \\frac{\\sigma_1}{\\epsilon_1},\\qquad\n\\nu_{12} = -\\frac{\\epsilon_2}{\\epsilon_1}.\n$$\n注意，在 $\\sigma_1$ 作用下测量 $\\epsilon_3$ 将通过 $-\\epsilon_3/\\epsilon_1$ 得到 $\\nu_{31}$，并且线性弹性中的互易性意味着 $\\nu_{13}/E_\\parallel=\\nu_{31}/E_\\perp$，但使用 $\\epsilon_2$ 可以直接确定 $\\nu_{12}$。\n\n在包含对称轴的平面内进行纯剪切：施加 $\\tau_{13}\\neq 0$，所有其他应力为零。则\n$$\n\\gamma_{13} = S_{44}\\tau_{13} = \\frac{\\tau_{13}}{G_{13}}\\quad\\Rightarrow\\quad G_{13}=\\frac{\\tau_{13}}{\\gamma_{13}}.\n$$\n\n在垂直于对称轴的平面内进行纯剪切：施加 $\\tau_{12}\\neq 0$，所有其他应力为零。则\n$$\n\\gamma_{12} = S_{66}\\tau_{12} = \\frac{\\tau_{12}}{G_{12}}\\quad\\Rightarrow\\quad G_{12}=\\frac{\\tau_{12}}{\\gamma_{12}}.\n$$\n在横观各向同性材料中，$G_{12}$ 必须满足 $G_{12}=E_\\perp/[2(1+\\nu_{12})]$；因此，$\\tau_{12}$ 试验提供了一个交叉验证，而不是确定一个独立的常数。\n\n综合来看，要最少且完备地确定五个独立的横观各向同性工程常数 $\\{E_\\perp,E_\\parallel,\\nu_{12},\\nu_{13},G_{13}\\}$，可以通过以下方式实现：\n- 单轴 $\\sigma_3$ 加载，并测量 $\\epsilon_3$ 和一个横向应变（$\\epsilon_1$ 或 $\\epsilon_2$），\n- 单轴 $\\sigma_1$ 加载，并测量 $\\epsilon_1$ 和 $\\epsilon_2$，\n- 纯剪切 $\\tau_{13}$ 加载，并测量 $\\gamma_{13}$，\n以及可选地，\n- 纯剪切 $\\tau_{12}$ 加载，并测量 $\\gamma_{12}$，以根据 $E_\\perp$ 和 $\\nu_{12}$ 验证 $G_{12}$。\n\n逐个选项分析：\n\nA. 精确地指明了上述应力状态和测量方法。试验 $1$ 确定了 $E_\\parallel$ 和 $\\nu_{13}$。试验 $2$ 确定了 $E_\\perp$ 和 $\\nu_{12}$。试验 $3$ 确定了 $G_{13}$。试验 $4$ 测量了 $G_{12}$，它不是独立的，但通过 $G_{12}=E_\\perp/[2(1+\\nu_{12})]$ 验证了 $x_1x_2$ 平面内的横观各向同性性质。该测试组合最少地使用了平行和垂直于对称轴的单轴加载以及在包含对称轴和垂直于对称轴的平面内进行的剪切试验，来确定五个独立的常数，且不依赖于平面应力假设或多轴比例加载。结论 — 正确。\n\nB. 在单轴试验中仅测量轴向应变，这只能得到 $E_\\parallel$ 和 $E_\\perp$，但无法得到 $\\nu_{13}$ 或 $\\nu_{12}$；因此无法完全确定五个独立的常数。结论 — 错误。\n\nC. 使用 $\\sigma_3$ 加载并测量 $\\epsilon_3$ 和 $\\epsilon_2$ 可以确定 $E_\\parallel$ 和 $\\nu_{13}$，但接着施加等量双轴加载 $\\sigma_1=\\sigma_2$ 且仅测量 $\\epsilon_1$。一个仅有单个应变测量的双轴试验无法分离出 $\\nu_{12}$；需要测量 $\\sigma_1$ 作用下的 $\\epsilon_2$ 耦合效应。此外，它省略了在包含对称轴的平面内的剪切试验，因此 $G_{13}$ 无法确定。结论 — 错误。\n\nD. 静水压力压缩不能唯一地分离出各向异性常数；它聚合了响应，无法区分 $E_\\perp$、$E_\\parallel$、$\\nu_{12}$ 和 $\\nu_{13}$。虽然通过 $\\sigma_1$ 加载并测量 $\\epsilon_1$ 和 $\\epsilon_3$ 可以利用互易性关联 $\\nu_{13}$ 和 $\\nu_{31}$，但若不在平面内单轴加载下测量 $\\epsilon_2$，该路径仍然无法直接确定 $\\nu_{12}$。它还省略了垂直于对称轴的剪切试验，没有提供独立的 $G_{12}$ 验证路径。结论 — 错误。\n\nE. 对圆柱体绕 $x_3$ 轴的扭转试验主要涉及垂直于轴的横截面（即 $x_1x_2$ 平面）内的剪切，因此得到的是 $G_{12}$，而不是 $G_{13}$。因此，它错误地识别了需要在包含对称轴的平面内确定的剪切模量。此外，省略 $\\tau_{12}$ 试验移除了对平面内各向同性的验证途径。结论 — 错误。\n\n因此，唯一满足所述要求并能使用指定类型的试验确保五个独立横观各向同性工程常数可识别性的选项是A。", "answer": "$$\\boxed{A}$$", "id": "3568653"}, {"introduction": "在获得材料常数后，我们常常需要在工程分析中应用它们，这通常涉及建立简化模型。本练习将探讨在分析横观各向同性板的弯曲问题时，两种常见的理想化假设——平面应力与平面应变——所带来的不同影响。通过计算和对比，您将量化这些建模选择如何改变对结构刚度和变形的预测，从而更深刻地理解在各向异性材料建模中做出恰当假设的重要性。[@problem_id:3568616]", "problem": "一个代表层状地质构造的横观各向同性（TI）岩层，被建模为一个由完全粘合的相同层组成的叠层体，其横观各向同性轴与面外方向 $z$ 对齐。面内方向 $x$ 和 $y$ 是各向同性的。在小变形情况下，三维线弹性本构定律写为柔度形式 $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\varepsilon}$ 是应变矢量，$\\boldsymbol{\\sigma}$ 是应力矢量。对于具有面内各向同性的 TI 材料，其非零工程常数为：面内杨氏模量 $E_{h}$、面外杨氏模量 $E_{v}$、面内泊松比 $\\nu_{hh}$、满足互易关系 $E_{v}\\,\\nu_{vh} = E_{h}\\,\\nu_{hv}$ 的耦合泊松比 $\\nu_{hv}$ 和 $\\nu_{vh}$、面内剪切模量 $G_{h}$ 以及面外剪切模量 $G_{hv}$。假设采用 Kirchhoff–Love 薄板弯曲运动学，并忽略横向剪切变形。考虑一个总厚度为 $h$ 的宽板，承受单位宽度的均匀弯矩 $M_{x}$，产生绕 $y$ 轴的曲率，即中面曲率 $\\kappa_{x}$。\n\n利用通过施加平面应力条件（$\\sigma_{z} = 0$, $\\tau_{xz} = 0$, $\\tau_{yz} = 0$）或平面应变条件（$\\varepsilon_{z} = 0$, $\\gamma_{xz} = 0$, $\\gamma_{yz} = 0$）从三维 TI 柔度矩阵得到的降维面内矩阵，推导出每种假设下的方向弯曲刚度 $D_{xx}$ 和相应的曲率 $\\kappa_{x}$。然后，对于以下材料参数，计算在平面应力与平面应变条件下预测的中面 $x$ 方向曲率之比，\n$$\nR = \\frac{\\kappa_{x}^{\\text{(plane stress)}}}{\\kappa_{x}^{\\text{(plane strain)}}},\n$$\n材料参数如下：\n- $E_{h} = 30\\,\\mathrm{GPa}$, $E_{v} = 12\\,\\mathrm{GPa}$,\n- $\\nu_{hh} = 0.30$, $\\nu_{hv} = 0.12$, $\\nu_{vh} = \\dfrac{E_{v}}{E_{h}}\\,\\nu_{hv}$,\n- $G_{h} = \\dfrac{E_{h}}{2\\left(1+\\nu_{hh}\\right)}$,\n- 在给定的运动学条件下，纯弯曲绕 $y$ 轴时不需要 $G_{hv}$。\n\n由于所有层都相同且对齐，您可以将该叠层体在弯曲中视为宏观均匀体。使用关于弯矩和曲率的标准板本构关系，并用适当的降维面内刚度表达 $D_{xx}$。将最终答案表示为一个无量纲数，四舍五入到四位有效数字。最终答案中不要包含任何单位。", "solution": "用户希望找到对于横观各向同性（TI）材料，在两种不同建模假设下板曲率的比值。\n\n### 第1步：问题验证\n\n该问题被判定为**有效**。它在科学上基于线弹性和板理论，问题提法得当且数据完整，并使用了客观、正式的语言。对于像页岩这样的地质材料，所给参数在物理上是合理的。指示清晰，能导出一个唯一且可验证的解。\n\n### 第2步：理论构建\n\n线弹性材料的本构定律以柔度形式给出为 $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}$。对于一个各向同性平面为 $x$-$y$ 平面的横观各向同性材料，其柔度矩阵 $\\mathbf{S}$ 将工程应变矢量 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_x & \\varepsilon_y & \\varepsilon_z & \\gamma_{yz} & \\gamma_{xz} & \\gamma_{xy} \\end{pmatrix}^T$ 与应力矢量 $\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_x & \\sigma_y & \\sigma_z & \\tau_{yz} & \\tau_{xz} & \\tau_{xy} \\end{pmatrix}^T$ 联系起来，如下所示：\n$$\n\\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\varepsilon_z \\\\ \\gamma_{yz} \\\\ \\gamma_{xz} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n1/E_{h}  & -\\nu_{hh}/E_{h}  & -\\nu_{vh}/E_{h}  & 0  & 0  & 0 \\\\\n-\\nu_{hh}/E_{h}  & 1/E_{h}  & -\\nu_{vh}/E_{h}  & 0  & 0  & 0 \\\\\n-\\nu_{vh}/E_{h}  & -\\nu_{vh}/E_{h}  & 1/E_{v}  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 1/G_{hv}  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 1/G_{hv}  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 1/G_h\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_x \\\\ \\sigma_y \\\\ \\sigma_z \\\\ \\tau_{yz} \\\\ \\tau_{xz} \\\\ \\tau_{xy} \\end{pmatrix}\n$$\n柔度矩阵的对称性要求满足互易关系 $\\nu_{hv}/E_h = \\nu_{vh}/E_v$，这可以重写为 $E_v \\nu_{hv} = E_h \\nu_{vh}$。问题中陈述了此关系，这是相符的。\n\n根据 Kirchhoff-Love 板理论，应变沿板厚 $z$ 呈线性变化：\n$$\n\\varepsilon_x(z) = z\\,\\kappa_x, \\quad \\varepsilon_y(z) = z\\,\\kappa_y, \\quad \\gamma_{xy}(z) = z\\,\\kappa_{xy}\n$$\n此处我们采用的约定是，当 $z>0$ 时，正曲率 $\\kappa_x$ 对应于正应变 $\\varepsilon_x$。单位宽度的弯矩是应力的积分：\n$$\nM_x = \\int_{-h/2}^{h/2} \\sigma_x(z) z \\, dz\n$$\n面内应力与应变之间的关系由一个 $3 \\times 3$ 的降维刚度矩阵 $\\mathbf{Q}$ 描述：\n$$\n\\begin{pmatrix} \\sigma_x \\\\ \\sigma_y \\\\ \\tau_{xy} \\end{pmatrix} = \\mathbf{Q} \\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix} Q_{11} & Q_{12} & Q_{16} \\\\ Q_{12} & Q_{22} & Q_{26} \\\\ Q_{16} & Q_{26} & Q_{66} \\end{pmatrix} \\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\n对于给定的 TI 材料，$Q_{11}=Q_{22}$ 且 $Q_{16}=Q_{26}=0$。\n问题描述了一个承受均匀弯矩 $M_x$ 的宽板，这意味着圆柱形弯曲。该条件对应于 $\\kappa_y = 0$ 和 $\\kappa_{xy} = 0$。因此，对于所有 $z$，都有 $\\varepsilon_y(z)=0$ 和 $\\gamma_{xy}(z)=0$。\n应力 $\\sigma_x(z)$ 则由 $\\sigma_x(z) = Q_{11} \\varepsilon_x(z) = Q_{11} z \\kappa_x$ 给出。将此代入弯矩积分中：\n$$\nM_x = \\int_{-h/2}^{h/2} (Q_{11} z \\kappa_x) z \\, dz = Q_{11} \\kappa_x \\int_{-h/2}^{h/2} z^2 \\, dz = Q_{11} \\kappa_x \\frac{h^3}{12}\n$$\n方向弯曲刚度为 $D_{xx} = Q_{11} \\dfrac{h^3}{12}$，曲率为 $\\kappa_x = \\dfrac{M_x}{D_{xx}} = \\dfrac{12 M_x}{Q_{11} h^3}$。\n曲率 $\\kappa_x$ 与刚度分量 $Q_{11}$ 成反比。因此，两种假设下的曲率之比将是相应 $Q_{11}$ 值的反比：\n$$\nR = \\frac{\\kappa_{x}^{\\text{(plane stress)}}}{\\kappa_{x}^{\\text{(plane strain)}}} = \\frac{1/Q_{11}^{\\text{(ps)}}}{1/Q_{11}^{\\text{(pe)}}} = \\frac{Q_{11}^{\\text{(pe)}}}{Q_{11}^{\\text{(ps)}}}\n$$\n我们的任务简化为找到在平面应力和平面应变假设下 $Q_{11}$ 的表达式。\n\n### 第3步：平面应力推导 ($\\sigma_z = 0$)\n\n在平面应力条件（$\\sigma_z = \\tau_{xz} = \\tau_{yz} = 0$）下，面内应力-应变关系直接取自完整柔度矩阵的左上部分：\n$$\n\\varepsilon_x = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y\n$$\n$$\n\\varepsilon_y = -\\frac{\\nu_{hh}}{E_h}\\sigma_x + \\frac{1}{E_h}\\sigma_y\n$$\n对该方程组求逆，以求得以应变表示的应力：\n$$\n\\sigma_x = \\frac{E_h}{1-\\nu_{hh}^2}(\\varepsilon_x + \\nu_{hh}\\varepsilon_y)\n$$\n根据定义，$\\sigma_x = Q_{11}^{(\\text{ps})}\\varepsilon_x + Q_{12}^{(\\text{ps})}\\varepsilon_y$。通过比较系数，我们确定：\n$$\nQ_{11}^{(\\text{ps})} = \\frac{E_h}{1-\\nu_{hh}^2}\n$$\n弯曲刚度为 $D_{xx}^{(\\text{ps})} = \\dfrac{E_h h^3}{12(1-\\nu_{hh}^2)}$，曲率为 $\\kappa_x^{(\\text{ps})} = \\dfrac{12 M_x (1-\\nu_{hh}^2)}{E_h h^3}$。\n\n### 第4步：平面应变推导 ($\\varepsilon_z = 0$)\n\n在平面应变条件（$\\varepsilon_z = \\gamma_{xz} = \\gamma_{yz} = 0$）下，我们首先找到施加 $\\varepsilon_z=0$ 所需的应力 $\\sigma_z$。根据完整柔度关系的第三行：\n$$\n\\varepsilon_z = -\\frac{\\nu_{vh}}{E_h}\\sigma_x - \\frac{\\nu_{vh}}{E_h}\\sigma_y + \\frac{1}{E_v}\\sigma_z = 0 \\quad \\implies \\quad \\sigma_z = \\frac{E_v}{E_h}\\nu_{vh}(\\sigma_x + \\sigma_y)\n$$\n现在，将 $\\sigma_z$ 的这个表达式代入 $\\varepsilon_x$ 和 $\\varepsilon_y$ 的方程中：\n$$\n\\varepsilon_x = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y - \\frac{\\nu_{vh}}{E_h}\\sigma_z = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y - \\frac{\\nu_{vh}}{E_h}\\frac{E_v}{E_h}\\nu_{vh}(\\sigma_x + \\sigma_y)\n$$\n利用互易关系 $E_v \\nu_{hv} = E_h \\nu_{vh}$，我们可以将上式替换为包含 $\\nu_{hv}$ 的形式，以简化表达式：\n$$\n\\varepsilon_x = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y - \\frac{\\nu_{hv}}{E_h}\\nu_{vh}(\\sigma_x + \\sigma_y)\n$$\n按 $\\sigma_x$ 和 $\\sigma_y$ 对各项进行分组：\n$$\n\\varepsilon_x = \\frac{1}{E_h}(1 - \\nu_{hv}\\nu_{vh})\\sigma_x - \\frac{1}{E_h}(\\nu_{hh} + \\nu_{hv}\\nu_{vh})\\sigma_y\n$$\n根据对称性，$\\varepsilon_y$ 的方程为：\n$$\n\\varepsilon_y = -\\frac{1}{E_h}(\\nu_{hh} + \\nu_{hv}\\nu_{vh})\\sigma_x + \\frac{1}{E_h}(1 - \\nu_{hv}\\nu_{vh})\\sigma_y\n$$\n我们需要对这个 $2 \\times 2$ 方程组求逆，以求得 $\\sigma_x$ 作为 $\\varepsilon_x$ 和 $\\varepsilon_y$ 的函数，从中我们可以确定 $Q_{11}^{(\\text{pe})}$。设上述方程组为 $\\boldsymbol{\\varepsilon} = \\mathbf{S}'\\boldsymbol{\\sigma}$。$\\mathbf{S}'$ 的行列式为：\n$$\n\\det(\\mathbf{S'}) = \\frac{1}{E_h^2} \\left[ (1 - \\nu_{hv}\\nu_{vh})^2 - (\\nu_{hh} + \\nu_{hv}\\nu_{vh})^2 \\right] = \\frac{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh})}{E_h^2}\n$$\n逆矩阵为 $\\mathbf{Q}^{(\\text{pe})} = (\\mathbf{S}')^{-1}$。分量 $Q_{11}^{(\\text{pe})}$ 由 $S'_{22}/\\det(\\mathbf{S'})$ 给出：\n$$\nQ_{11}^{(\\text{pe})} = \\frac{\\frac{1}{E_h}(1 - \\nu_{hv}\\nu_{vh})}{\\frac{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh})}{E_h^2}} = \\frac{E_h(1 - \\nu_{hv}\\nu_{vh})}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh})}\n$$\n弯曲刚度为 $D_{xx}^{(\\text{pe})} = Q_{11}^{(\\text{pe})} \\dfrac{h^3}{12}$，曲率为 $\\kappa_x^{(\\text{pe})} = \\dfrac{12 M_x}{Q_{11}^{(\\text{pe})} h^3}$。\n\n### 第5步：比值 R 的计算\n\n现在我们计算比值 $R$：\n$$\nR = \\frac{Q_{11}^{(\\text{pe})}}{Q_{11}^{(\\text{ps})}} = \\frac{\\frac{E_h(1 - \\nu_{hv}\\nu_{vh})}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh})}}{\\frac{E_h}{1-\\nu_{hh}^2}} = \\frac{(1 - \\nu_{hv}\\nu_{vh})(1-\\nu_{hh}^2)}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh})}\n$$\n使用恒等式 $1-\\nu_{hh}^2 = (1-\\nu_{hh})(1+\\nu_{hh})$，我们可以简化 R 的表达式：\n$$\nR = \\frac{(1 - \\nu_{hv}\\nu_{vh})(1-\\nu_{hh})}{1-\\nu_{hh}-2\\nu_{hv}\\nu_{vh}}\n$$\n现在，代入给定的数值：\n$E_{h} = 30\\,\\mathrm{GPa}$\n$E_{v} = 12\\,\\mathrm{GPa}$\n$\\nu_{hh} = 0.30$\n$\\nu_{hv} = 0.12$\n\n首先，使用互易关系计算相关的泊松比 $\\nu_{vh}$：\n$$\n\\nu_{vh} = \\frac{E_v}{E_h}\\nu_{hv} = \\frac{12}{30} \\times 0.12 = 0.4 \\times 0.12 = 0.048\n$$\n接下来，计算乘积 $\\nu_{hv}\\nu_{vh}$：\n$$\n\\nu_{hv}\\nu_{vh} = 0.12 \\times 0.048 = 0.00576\n$$\n现在，将这些值代入 R 的表达式中：\n$$\nR = \\frac{(1 - 0.00576)(1 - 0.30)}{1 - 0.30 - 2(0.00576)} = \\frac{(0.99424)(0.7)}{0.7 - 0.01152} = \\frac{0.695968}{0.68848}\n$$\n$$\nR \\approx 1.010876\n$$\n按要求四舍五入到四位有效数字，我们得到：\n$$\nR = 1.011\n$$\n这个结果表明，对于给定的材料属性，平面应力假设下的曲率预测值比平面应变假设下的预测值高出约 $1.1\\%$。", "answer": "$$\n\\boxed{1.011}\n$$", "id": "3568616"}, {"introduction": "对于复杂的几何形状和边界条件，我们必须依赖有限元法（FEM）等数值工具。在有限元分析中，一个至关重要的步骤是在模型的全局坐标系中正确地表示材料的本构关系。本编程练习将指导您完成一个核心的计算力学任务：将材料在其主轴坐标系下的刚度张量旋转到任意的全局坐标系中，这是在实际工程问题中处理各向异性材料的基石。[@problem_id:3568667]", "problem": "要求您开发一个完整、可运行的程序，用于计算在平面应变条件下，横观各向同性（TI）材料在全局坐标系下的单元层级本构矩阵。材料的对称轴相对于单元在三维空间中任意取向，并且该单元相对于全局坐标轴具有一个平面内方向角。您必须仅从基本线弹性定律、张量在刚性旋转下的坐标变换以及平面应变的定义出发，推导出一个计算流程，为一组测试用例生成全局平面应变本构矩阵 $D$。\n\n您必须使用的基本依据是：\n- 小应变下的线弹性理论：$\\,\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}\\,$，其中 $\\boldsymbol{\\sigma}$ 为二阶应力张量，$\\boldsymbol{\\varepsilon}$ 为二阶应变张量，$\\mathbb{C}$ 为四阶刚度张量。\n- 张量的刚性旋转：如果 $\\mathbf{R}$ 是一个正交旋转矩阵（$\\mathbf{R}^\\top \\mathbf{R} = \\mathbf{I}$），则四阶刚度张量的变换方式为 $\\,\\mathbb{C}'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} \\,\\mathbb{C}_{pqrs}\\,$，二阶张量的变换方式为 $\\,\\boldsymbol{T}' = \\mathbf{R}\\,\\boldsymbol{T}\\,\\mathbf{R}^\\top\\,$。\n- 全局坐标系中的平面应变运动学条件：在全局坐标系中，$\\,\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0\\,$，而 $\\,\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}\\,$ 可以不为零。\n\n您必须在其主材料坐标系中构建 TI 材料，其中对称轴为 $3$ 轴，并使用物理上一致的柔度描述。然后：\n1. 在材料坐标系中，将材料柔度转换为刚度。\n2. 根据工程剪应变 $\\,\\gamma_{ij} = 2 \\varepsilon_{ij}\\,$ 和剪应力 $\\,\\tau_{ij} = \\sigma_{ij}\\,$，在 $6 \\times 6$ 工程Voigt表示与完整的四阶张量之间进行一致性转换。\n3. 构建一个标准正交三轴标架，使材料的 $3$ 轴与单元局部坐标系中给定的对称轴对齐，然后通过单元的平面内方向角将该局部坐标系旋转到全局坐标系。\n4. 使用四阶张量的旋转法则，将四阶刚度张量从材料坐标系旋转到全局坐标系。\n5. 在全局坐标系中，提取全局平面应变本构矩阵 $D$ 作为将 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$ 映射到 $[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$ 的 $3 \\times 3$ 分块矩阵。\n\n所有刚度模量必须以吉帕斯卡（GPa）为单位。所有角度必须以弧度为单位。$D$ 的最终输出条目必须以吉帕斯卡（GPa）为单位。将报告的每个条目四舍五入到六位小数。\n\n在主材料坐标系中，通过五个独立的工程常数定义横观各向同性（TI）材料：\n- 平面内杨氏模量 $E_1$（$E_1 = E_2$），\n- 平面外杨氏模量 $E_3$，\n- 平面内泊松比 $\\nu_{12}$，\n- 平面外泊松比 $\\nu_{13}$（$\\nu_{13} = \\nu_{23}$），\n- 平面外剪切模量 $G_{13}$（$G_{13} = G_{23}$），\n且平面内剪切模量受 TI 对称性约束为 $\\,G_{12} = \\dfrac{E_1}{2(1+\\nu_{12})}\\,$.\n\n使用以下测试套件（所有刚度单位为吉帕斯卡 (GPa)，角度单位为弧度）。对于每种情况，单元局部坐标系中的对称轴由球坐标角 $(\\alpha,\\beta)$ 参数化，因此其单位向量为 $\\,\\mathbf{a} = [\\sin\\beta\\cos\\alpha,\\,\\sin\\beta\\sin\\alpha,\\,\\cos\\beta]^\\top\\,$。然后，单元局部坐标系围绕全局 $z$ 轴旋转一个平面内角 $\\phi$，以转换到全局坐标系。\n\n- 情况1（一般取向，正常路径）：\n  - $E_1 = 25$, $E_3 = 50$, $\\nu_{12} = 0.25$, $\\nu_{13} = 0.20$, $G_{13} = 9$, 角度：$\\alpha = 1.0$, $\\beta = 0.4$, $\\phi = 0.3$。\n- 情况2（轴与全局 $z$ 轴对齐，边界检查）：\n  - $E_1 = 40$, $E_3 = 80$, $\\nu_{12} = 0.20$, $\\nu_{13} = 0.17$, $G_{13} = 15$, 角度：$\\alpha = 0.0$, $\\beta = 0.0$, $\\phi = 0.0$。\n- 情况3（各向同性检查，边缘情况）：\n  - $E_1 = 30$, $E_3 = 30$, $\\nu_{12} = 0.25$, $\\nu_{13} = 0.25$, $G_{13} = 12$, 角度：$\\alpha = 0.1$, $\\beta = 0.7$, $\\phi = 0.5$。\n\n您的程序应生成单行输出，其中包含一个长度为三的列表。该列表的每个元素都是一个包含九个浮点数的列表，代表相应测试用例的 $3 \\times 3$ 全局平面应变本构矩阵 $D$（以吉帕斯卡 GPa 为单位），按行主序排列，并四舍五入到六位小数。确切要求的格式为：\n$[[d_{11},d_{12},d_{13},d_{21},d_{22},d_{23},d_{31},d_{32},d_{33}], [\\cdots], [\\cdots]]$。", "solution": "该问题是有效的，因为它以线弹性理论为科学基础，提法恰当，并给出了客观、可形式化的要求。它描述了计算力学中处理各向异性材料的一个标准（尽管不简单）的流程。\n\n确定横观各向同性（TI）材料的全局平面应变本构矩阵 $\\mathbf{D}$ 的计算流程包括四个主要步骤：\n$1$. 在其主坐标系中构建材料刚度张量。\n$2$. 确定将材料坐标系变换到全局坐标系的旋转矩阵。\n$3$. 将刚度张量变换到全局坐标系。\n$4$. 从变换后的全局刚度张量中提取平面应变本构矩阵。\n\n下面详细介绍每个步骤，并遵循问题陈述中规定的原则。所有索引 $i, j, k, l$ 的范围为 $1$ 到 $3$。\n\n### 步骤1：主坐标系中的材料刚度\n\n横观各向同性材料由五个独立的弹性常数表征。问题中给出的这些常数是：平面内杨氏模量 $E_1$、平面外杨氏模量 $E_3$、平面内泊松比 $\\nu_{12}$、平面外泊松比 $\\nu_{13}$ 以及平面外剪切模量 $G_{13}$。该材料围绕某一特定轴表现出旋转对称性，我们将此轴与主材料坐标系中的 $3$ 轴对齐。各向同性平面为 $1$-$2$ 平面。\n\n在 Voigt 表示法中，柔度矩阵 $\\mathbf{S}$ 将应变向量 $\\boldsymbol{\\varepsilon}$ 与应力向量 $\\boldsymbol{\\sigma}$ 关联起来，即 $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\boldsymbol{\\sigma}$。对于以 $3$ 轴为对称轴的 TI 材料，其柔度矩阵 $\\mathbf{S}$ 在工程表示法（其中 $\\varepsilon_4=\\gamma_{23}$ 等）下由下式给出：\n$$\n\\mathbf{S} = \\begin{pmatrix}\n1/E_1 & -\\nu_{12}/E_1 & -\\nu_{13}/E_1 & 0 & 0 & 0 \\\\\n-\\nu_{12}/E_1 & 1/E_1 & -\\nu_{13}/E_1 & 0 & 0 & 0 \\\\\n-\\nu_{13}/E_1 & -\\nu_{13}/E_1 & 1/E_3 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1/G_{13} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1/G_{13} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1/G_{12}\n\\end{pmatrix}\n$$\n这种形式正确地包含了对称性关系 $E_1=E_2$、$\\nu_{13}=\\nu_{23}$ 和 $G_{13}=G_{23}$。柔度矩阵的对称性是应变能考量的结果，要求 $S_{ij} = S_{ji}$。这意味着 $\\nu_{13}/E_1 = \\nu_{31}/E_3$，其中 $\\nu_{31}$ 是表征由 $3$ 方向的应力引起的 $1$ 方向应变的泊松比。平面内剪切模量 $G_{12}$ 受 $1$-$2$ 平面内的各向同性约束，由 $G_{12} = \\frac{E_1}{2(1+\\nu_{12})}$ 给出。\n\nVoigt 表示法下的刚度矩阵 $\\mathbf{C}$ 是柔度矩阵的逆：\n$$\n\\mathbf{C} = \\mathbf{S}^{-1}\n$$\n这个 $6 \\times 6$ 的矩阵 $\\mathbf{C}$ 代表了主材料坐标系中的材料刚度。\n\n为了正确执行坐标变换，我们必须将这个 Voigt 矩阵 $\\mathbf{C}$ 转换为四阶刚度张量 $\\mathbb{C}$。关系式 $\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ 必须与使用工程应变 $\\gamma_{ij} = 2\\varepsilon_{ij}$ 的 Voigt 形式 $\\boldsymbol{\\sigma} = \\mathbf{C}\\boldsymbol{\\varepsilon}$ 保持一致。这种一致性导致了索引的直接映射。令 $\\alpha$ 为标号对 $(i, j)$ 的 Voigt 索引，$\\beta$ 为 $(k, l)$ 的 Voigt 索引（例如，$(1,1) \\to 1$, $(2,2) \\to 2$, ..., $(1,2) \\to 6$）。那么，$\\mathbb{C}_{ijkl} = C_{\\alpha\\beta}$。例如，$\\mathbb{C}_{1111} = C_{11}$，$\\mathbb{C}_{1122} = C_{12}$，以及 $\\mathbb{C}_{1212} = C_{66}$。\n\n### 步骤2：坐标系旋转\n\n该问题定义了两个连续的旋转，以确定材料在全局坐标系中的方向：\n$1$. 在单元局部坐标系内，确定材料对称轴的方向。\n$2$. 将单元局部坐标系进行平面内旋转，以对齐到全局坐标系。\n\n设材料、局部和全局坐标系分别具有标准正交基 $\\{\\mathbf{e}_1^m, \\mathbf{e}_2^m, \\mathbf{e}_3^m\\}$、$\\{\\mathbf{e}_x^L, \\mathbf{e}_y^L, \\mathbf{e}_z^L\\}$ 和 $\\{\\mathbf{e}_X^G, \\mathbf{e}_Y^G, \\mathbf{e}_Z^G\\}$。材料的对称轴是 $\\mathbf{e}_3^m$。\n\n首先，我们定义从材料坐标系到单元局部坐标系的旋转。对称轴 $\\mathbf{e}_3^m$ 与局部坐标系中的向量 $\\mathbf{a}$ 对齐，其中 $\\mathbf{a} = [\\sin\\beta\\cos\\alpha, \\sin\\beta\\sin\\alpha, \\cos\\beta]^\\top$。我们将此作为旋转后材料坐标系的第三个基向量，即 $\\mathbf{v}_3 = \\mathbf{a}$。我们构建一个标准正交的右手坐标基 $(\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3)$，用以表示局部坐标系中的材料轴。一种稳健的方法是选择一个不平行于 $\\mathbf{v}_3$ 的辅助向量 $\\mathbf{u}$，计算 $\\mathbf{v}_1' = \\mathbf{u} \\times \\mathbf{v}_3$，然后计算 $\\mathbf{v}_2' = \\mathbf{v}_3 \\times \\mathbf{v}_1'$。将这些向量归一化后得到 $\\mathbf{v}_1$ 和 $\\mathbf{v}_2$。旋转矩阵 $\\mathbf{R}_{m \\to L}$ 以这些向量为列向量：$\\mathbf{R}_{m \\to L} = [\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3]$。\n\n其次，单元局部坐标系围绕全局 $Z$ 轴 $\\mathbf{e}_Z^G$ 旋转一个角度 $\\phi$，以与全局坐标系对齐。旋转矩阵为：\n$$\n\\mathbf{R}_{L \\to G} = \\begin{pmatrix}\n\\cos\\phi & -\\sin\\phi & 0 \\\\\n\\sin\\phi & \\cos\\phi & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n将向量分量从材料坐标系变换到全局坐标系的总旋转矩阵 $\\mathbf{R}$ 是这两个矩阵的乘积：\n$$\n\\mathbf{R} = \\mathbf{R}_{L \\to G} \\mathbf{R}_{m \\to L}\n$$\n\n### 步骤3：刚度张量的变换\n\n像刚度张量 $\\mathbb{C}$ 这样的四阶张量，在由 $\\mathbf{R}$ 定义的刚性旋转下，遵循以下变换法则：\n$$\n\\mathbb{C}'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} \\mathbb{C}_{pqrs}\n$$\n此处，$\\mathbb{C}$ 是材料坐标系中的刚度张量，$\\mathbb{C}'$ 是全局坐标系中变换后的张量。索引 $p, q, r, s$ 遵循爱因斯坦求和约定。该操作可以使用张量缩并高效实现，例如使用 `numpy.einsum`。\n\n### 步骤4：提取平面应变本构矩阵\n\n旋转张量后，我们得到全局刚度张量 $\\mathbb{C}'$。该张量将全局应力分量 $\\sigma'_{ij}$ 与全局应变分量 $\\varepsilon'_{kl}$ 关联起来：$\\sigma'_{ij} = \\mathbb{C}'_{ijkl}\\varepsilon'_{kl}$。为清晰起见，我们省略撇号。\n\n全局坐标系中的平面应变条件通过将某些应变分量设为零来定义：\n$$\n\\varepsilon_{zz} = 0, \\quad \\varepsilon_{xz} = 0, \\quad \\varepsilon_{yz} = 0\n$$\n在工程 Voigt 表示法中，应变向量为 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}, \\gamma_{xz}, \\gamma_{xy}]^\\top$，平面应变条件对应于 $\\varepsilon_3 = 0$，$\\varepsilon_4 = 0$ 和 $\\varepsilon_5 = 0$。\n\n全局坐标系中的完整三维本构关系是 $\\boldsymbol{\\sigma} = \\mathbf{C}_{\\text{glob}} \\boldsymbol{\\varepsilon}$。展开与平面应变分析相关的分量（$\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}$）：\n$$\n\\begin{align*}\n\\sigma_{xx} & = (C_{\\text{glob}})_{11} \\varepsilon_{xx} + (C_{\\text{glob}})_{12} \\varepsilon_{yy} + (C_{\\text{glob}})_{16} \\gamma_{xy} \\\\\n\\sigma_{yy} & = (C_{\\text{glob}})_{21} \\varepsilon_{xx} + (C_{\\text{glob}})_{22} \\varepsilon_{yy} + (C_{\\text{glob}})_{26} \\gamma_{xy} \\\\\n\\sigma_{xy} & = (C_{\\text{glob}})_{61} \\varepsilon_{xx} + (C_{\\text{glob}})_{62} \\varepsilon_{yy} + (C_{\\text{glob}})_{66} \\gamma_{xy}\n\\end{align*}\n$$\n这定义了平面内应力向量 $[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$（其中 $\\tau_{xy} = \\sigma_{xy}$）与平面内工程应变向量 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$ 之间的关系。因此，所需的 $3 \\times 3$ 平面应变本构矩阵 $\\mathbf{D}$ 是全局 $6 \\times 6$ 刚度矩阵 $\\mathbf{C}_{\\text{glob}}$ 的一个子矩阵：\n$$\n\\mathbf{D} = \\begin{pmatrix}\n(C_{\\text{glob}})_{11} & (C_{\\text{glob}})_{12} & (C_{\\text{glob}})_{16} \\\\\n(C_{\\text{glob}})_{21} & (C_{\\text{glob}})_{22} & (C_{\\text{glob}})_{26} \\\\\n(C_{\\text{glob}})_{61} & (C_{\\text{glob}})_{62} & (C_{\\text{glob}})_{66}\n\\end{pmatrix}\n$$\n为了获得 $\\mathbf{C}_{\\text{glob}}$，我们使用与步骤 1 中相同的索引映射，将四阶张量 $\\mathbb{C}'$ 逆转换为 Voigt 表示。然后从得到的 $6 \\times 6$ 矩阵中提取 $\\mathbf{D}$ 的分量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_voigt_stiffness_ti(E1, E3, nu12, nu13, G13):\n    \"\"\"\n    Computes the 6x6 stiffness matrix in Voigt notation for a\n    transversely isotropic material in its principal frame.\n    The input nu13 is the standard engineering constant, and the\n    reciprocal relation nu31/E3 = nu13/E1 is used to ensure symmetry.\n    \"\"\"\n    G12 = E1 / (2 * (1 + nu12))\n    \n    # Reciprocal Poisson's ratio for matrix symmetry\n    nu31 = nu13 * E3 / E1\n    \n    S = np.zeros((6, 6))\n    \n    S[0, 0] = 1 / E1\n    S[1, 1] = 1 / E1\n    S[2, 2] = 1 / E3\n    \n    S[0, 1] = S[1, 0] = -nu12 / E1\n    \n    # Using the standard definition S_13 = -nu_31/E_3 and S_31 = -nu_13/E_1.\n    # For symmetry S_13 = S_31 must hold, which implies nu_31/E_3 = nu_13/E_1.\n    S[0, 2] = S[2, 0] = -nu13 / E1 # Corresponds to S_1133\n    S[1, 2] = S[2, 1] = -nu13 / E1 # Corresponds to S_2233\n    \n    S[3, 3] = 1 / G13  # G23 = G13\n    S[4, 4] = 1 / G13  # G13\n    S[5, 5] = 1 / G12\n    \n    C = np.linalg.inv(S)\n    return C\n\ndef voigt_to_tensor(C_voigt):\n    \"\"\"\n    Converts a 6x6 stiffness matrix in Voigt notation (engineering strain)\n    to a 3x3x3x3 fourth-order stiffness tensor.\n    \"\"\"\n    C_tensor = np.zeros((3, 3, 3, 3))\n    voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n    \n    for i in range(3):\n        for j in range(3):\n            for k in range(3):\n                for l in range(3):\n                    try:\n                        voigt_i = voigt_map.index(tuple(sorted((i, j))))\n                    except ValueError:\n                         voigt_i = voigt_map.index(tuple(sorted((j, i))))\n                    \n                    try:\n                        voigt_j = voigt_map.index(tuple(sorted((k, l))))\n                    except ValueError:\n                        voigt_j = voigt_map.index(tuple(sorted((l, k))))\n                    \n                    C_tensor[i, j, k, l] = C_voigt[voigt_i, voigt_j]\n    return C_tensor\n    \ndef tensor_to_voigt(C_tensor):\n    \"\"\"\n    Converts a 3x3x3x3 fourth-order stiffness tensor\n    to a 6x6 stiffness matrix in Voigt notation (engineering strain).\n    \"\"\"\n    C_voigt = np.zeros((6, 6))\n    voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n    \n    for i in range(6):\n        for j in range(6):\n            i1, i2 = voigt_map[i]\n            j1, j2 = voigt_map[j]\n            C_voigt[i, j] = C_tensor[i1, i2, j1, j2]\n            \n    return C_voigt\n\ndef get_total_rotation_matrix(alpha, beta, phi):\n    \"\"\"\n    Computes the total rotation matrix from the material frame to the global frame.\n    \"\"\"\n    # Rotation from material frame to element-local frame\n    cos_a, sin_a = np.cos(alpha), np.sin(alpha)\n    cos_b, sin_b = np.cos(beta), np.sin(beta)\n    \n    v3 = np.array([sin_b * cos_a, sin_b * sin_a, cos_b])\n    \n    # Construct an orthonormal basis (v1, v2, v3)\n    # Pick an auxiliary vector 'up' not parallel to v3\n    if abs(v3[2])  0.99999999: # not close to Z-axis pole\n        up = np.array([0.0, 0.0, 1.0])\n    else: # close to Z-axis pole, use X-axis\n        up = np.array([1.0, 0.0, 0.0])\n        \n    v1 = np.cross(up, v3)\n    v1 /= np.linalg.norm(v1)\n    \n    v2 = np.cross(v3, v1)\n    # v2 is already normalized since v3 and v1 are unit and orthogonal\n    \n    R_ml = np.array([v1, v2, v3]).T\n    \n    # Rotation from element-local frame to global frame\n    cos_p, sin_p = np.cos(phi), np.sin(phi)\n    R_lg = np.array([[cos_p, -sin_p, 0.0],\n                     [sin_p, cos_p, 0.0],\n                     [0.0,   0.0,   1.0]])\n                     \n    # Total rotation matrix\n    R_total = R_lg @ R_ml\n    return R_total\n\ndef calculate_plane_strain_matrix(params):\n    \"\"\"\n    Main computational procedure for a single test case.\n    \"\"\"\n    E1, E3, nu12, nu13, G13, alpha, beta, phi = params\n    \n    # 1. Get stiffness matrix in material frame\n    C_mat_voigt = get_voigt_stiffness_ti(E1, E3, nu12, nu13, G13)\n    \n    # In case of isotropy, the tensor is invariant to rotation. We can check the result.\n    if E1 == E3 and nu12 == nu13:\n        E_iso = E1\n        nu_iso = nu12\n        G_iso = E_iso / (2 * (1 + nu_iso))\n        if np.isclose(G13, G_iso):\n            # For isotropic material, D is known and independent of rotation\n            factor = E_iso / ((1 + nu_iso) * (1 - 2 * nu_iso))\n            D_iso = np.array([[1 - nu_iso, nu_iso, 0],\n                              [nu_iso, 1 - nu_iso, 0],\n                              [0, 0, (1 - 2 * nu_iso) / 2]]) * factor\n            return np.round(D_iso.flatten(), 6).tolist()\n\n    # 2. Convert Voigt matrix to 4th-order tensor\n    C_mat_tensor = voigt_to_tensor(C_mat_voigt)\n    \n    # 3. Get total rotation matrix\n    R = get_total_rotation_matrix(alpha, beta, phi)\n    \n    # 4. Rotate stiffness tensor to global frame\n    C_glob_tensor = np.einsum('ip,jq,kr,ls,pqrs->ijkl', R, R, R, R, C_mat_tensor)\n    \n    # 5. Convert global tensor back to Voigt matrix\n    C_glob_voigt = tensor_to_voigt(C_glob_tensor)\n    \n    # 6. Extract 3x3 plane strain matrix D\n    indices = np.array([0, 1, 5]) # Corresponds to xx, yy, xy components\n    D = C_glob_voigt[np.ix_(indices, indices)]\n    \n    # 7. Flatten and round\n    return np.round(D.flatten(), 6).tolist()\n\ndef solve():\n    \"\"\"\n    Defines test cases, solves them, and prints the formatted output.\n    \"\"\"\n    test_cases = [\n        # Case 1: general orientation\n        (25.0, 50.0, 0.25, 0.20, 9.0, 1.0, 0.4, 0.3),\n        # Case 2: axis aligned with global z-axis\n        (40.0, 80.0, 0.20, 0.17, 15.0, 0.0, 0.0, 0.0),\n        # Case 3: isotropy check\n        (30.0, 30.0, 0.25, 0.25, 12.0, 0.1, 0.7, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_flat = calculate_plane_strain_matrix(case)\n        results.append(D_flat)\n        \n    # Format the output string as per requirements\n    output_str_parts = []\n    for res_list in results:\n        res_str = f\"[{','.join(f'{x:.6f}' for x in res_list)}]\"\n        output_str_parts.append(res_str)\n        \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3568667"}]}