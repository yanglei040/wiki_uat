{"hands_on_practices": [{"introduction": "第一个实践练习旨在巩固我们对莫尔圆的理解。它不仅仅是一个抽象的几何图形；圆上的每一个点都具有直接的物理意义。本练习将指导您完成将莫尔图上的一个点转换回作用于特定物理平面上的牵引力矢量的过程，从而加强这两种表示方法之间的基本联系。[@problem_id:3544306]", "problem": "岩土材料中某点的平面应力状态，在固定的笛卡尔坐标系 $\\{x,y\\}$ 中由 Cauchy 应力张量表示为\n$$\n\\boldsymbol{\\sigma}\n=\n\\begin{pmatrix}\n\\sigma_{x}  \\tau_{xy} \\\\\n\\tau_{xy}  \\sigma_{y}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n30  20 \\\\\n20  -10\n\\end{pmatrix}\n\\ \\text{MPa},\n$$\n其符号约定为：拉伸正应力为正，剪应力分量 $\\tau_{xy}$ 在正 $x$ 面上沿正 $y$ 方向作用时为正（标准张量符号约定）。莫尔图绘制时，正应力轴 $\\sigma$ 为水平方向（向右为正），剪应力轴 $\\tau$ 为垂直方向（向上为正）。莫尔圆的参考半径定义为从圆心到对应于单位法向量为 $\\boldsymbol{e}_{x}$ 的平面的点之间的连线，即莫尔图上坐标为 $(\\sigma_{x},\\tau_{xy})$ 的点。莫尔圆上的一个点由中心角 $\\varphi = 120^\\circ$ 指定，该角从参考半径开始逆时针测量。\n\n仅从面力和 Cauchy 应力的定义出发，重构与莫尔圆上此点对应的物理平面的单位法向量 $\\boldsymbol{n}$ 和单位切向量 $\\boldsymbol{s}$，求出该点的法向和切向面力分量 $(\\sigma_{n},\\tau_{n})$，然后使用分解式 $\\boldsymbol{t} = \\sigma_{n}\\,\\boldsymbol{n} + \\tau_{n}\\,\\boldsymbol{s}$ 映射回作用于物理平面上的笛卡尔面力向量 $\\boldsymbol{t}$。使用平面内右手定则，其中 $\\boldsymbol{s}$ 通过将 $\\boldsymbol{n}$ 逆时针旋转 $90^\\circ$ 得到，从而莫尔图上的正 $\\tau_{n}$ 对应于沿 $\\boldsymbol{s}$ 方向的面力。\n\n将最终的面力向量分量表示为一个 $1\\times 2$ 的行向量 $(t_{x},\\,t_{y})$，单位为兆帕 (MPa)。使用精确值，不要四舍五入。角度以度为单位给出；如果进行转换，可以在中间步骤中使用弧度，但最终答案只要求以 MPa 为单位的面力分量。", "solution": "该解题过程首先根据给定的应力张量和符号约定，确定莫尔圆的几何特性以及物理旋转与莫尔圆上旋转之间的关系。然后，计算目标点对应的物理平面方向，并使用应力变换公式计算该平面上的应力分量。最后，通过向量分解重构面力向量并进行验证。\n\n**1. 莫尔圆参数**\n给定的应力分量为 $\\sigma_x = 30$ MPa，$\\sigma_y = -10$ MPa，$\\tau_{xy} = 20$ MPa。\n莫尔圆的圆心位于 $\\sigma$ 轴上，其值为平均正应力：\n$$ \\sigma_{avg} = \\frac{\\sigma_x + \\sigma_y}{2} = \\frac{30 + (-10)}{2} = 10 \\ \\text{MPa} $$\n圆心 C 的坐标为 $(10, 0)$。\n根据约定，圆上的参考点 P 对应于 $x$ 面（法向量为 $\\boldsymbol{e}_x$），其坐标为 $(\\sigma_x, \\tau_{xy})$，即 $(30, 20)$。\n圆的半径 R 是圆心 C 到点 P 的距离：\n$$ R = \\sqrt{(\\sigma_x - \\sigma_{avg})^2 + \\tau_{xy}^2} = \\sqrt{(30 - 10)^2 + 20^2} = \\sqrt{20^2 + 20^2} = \\sqrt{800} = 20\\sqrt{2} \\ \\text{MPa} $$\n\n**2. 物理平面的方向**\n对于问题中明确的符号约定（拉伸为正，$\\tau$ 轴向上，x-面的参考点为 $(\\sigma_x, \\tau_{xy})$），物理空间中逆时针旋转 $\\theta$ 的平面对应于莫尔圆上从参考点开始逆时针旋转 $2\\theta$ 的点。\n问题指定莫尔圆上的目标点是从参考点逆时针旋转 $\\varphi = 120^\\circ$。因此，我们有关系 $2\\theta = \\varphi = 120^\\circ$，这意味着物理平面的法线从 $x$ 轴逆时针旋转了 $\\theta = 60^\\circ$。\n\n**3. 目标平面上的应力分量**\n我们可以使用标准应力变换公式来计算新平面（$\\theta=60^\\circ$）上的法向应力 $\\sigma_n$ 和剪应力 $\\tau_n$：\n$$ \\sigma_n = \\frac{\\sigma_x + \\sigma_y}{2} + \\frac{\\sigma_x - \\sigma_y}{2}\\cos(2\\theta) + \\tau_{xy}\\sin(2\\theta) $$\n$$ \\tau_n = -\\frac{\\sigma_x - \\sigma_y}{2}\\sin(2\\theta) + \\tau_{xy}\\cos(2\\theta) $$\n代入 $\\theta=60^\\circ$（即 $2\\theta=120^\\circ$）和给定的应力值：\n$$ \\sigma_n = \\frac{30-10}{2} + \\frac{30-(-10)}{2}\\cos(120^\\circ) + 20\\sin(120^\\circ) = 10 + 20(-\\frac{1}{2}) + 20(\\frac{\\sqrt{3}}{2}) = 10\\sqrt{3} \\ \\text{MPa} $$\n$$ \\tau_n = -\\frac{30-(-10)}{2}\\sin(120^\\circ) + 20\\cos(120^\\circ) = -20(\\frac{\\sqrt{3}}{2}) + 20(-\\frac{1}{2}) = -10\\sqrt{3} - 10 \\ \\text{MPa} $$\n\n**4. 法向量、切向量与面力向量重构**\n单位法向量 $\\boldsymbol{n}$ 和单位切向量 $\\boldsymbol{s}$（由 $\\boldsymbol{n}$ 逆时针旋转 $90^\\circ$ 得到）为：\n$$ \\boldsymbol{n} = \\begin{pmatrix} \\cos(60^\\circ) \\\\ \\sin(60^\\circ) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} $$\n$$ \\boldsymbol{s} = \\begin{pmatrix} \\cos(60^\\circ+90^\\circ) \\\\ \\sin(60^\\circ+90^\\circ) \\end{pmatrix} = \\begin{pmatrix} \\cos(150^\\circ) \\\\ \\sin(150^\\circ) \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix} $$\n根据定义，面力向量 $\\boldsymbol{t}$ 可以分解为沿 $\\boldsymbol{n}$ 和 $\\boldsymbol{s}$ 的分量： $\\boldsymbol{t} = \\sigma_n\\boldsymbol{n} + \\tau_n\\boldsymbol{s}$。\n$$ \\boldsymbol{t} = (10\\sqrt{3}) \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} + (-10\\sqrt{3}-10) \\begin{pmatrix} -\\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix} $$\n计算其笛卡尔分量 $(t_x, t_y)$：\n$$ t_x = (10\\sqrt{3})\\left(\\frac{1}{2}\\right) + (-10\\sqrt{3}-10)\\left(-\\frac{\\sqrt{3}}{2}\\right) = 5\\sqrt{3} + \\frac{10\\cdot 3 + 10\\sqrt{3}}{2} = 5\\sqrt{3} + 15 + 5\\sqrt{3} = 15 + 10\\sqrt{3} $$\n$$ t_y = (10\\sqrt{3})\\left(\\frac{\\sqrt{3}}{2}\\right) + (-10\\sqrt{3}-10)\\left(\\frac{1}{2}\\right) = \\frac{10\\cdot 3}{2} - 5\\sqrt{3} - 5 = 15 - 5\\sqrt{3} - 5 = 10 - 5\\sqrt{3} $$\n因此，面力向量为 $\\boldsymbol{t} = (15 + 10\\sqrt{3}, 10 - 5\\sqrt{3})^T$。\n\n**5. 验证**\n我们可以使用柯西应力公式 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 直接计算面力向量进行验证：\n$$ \\boldsymbol{t} = \\begin{pmatrix} 30  20 \\\\ 20  -10 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} = \\begin{pmatrix} 30(\\frac{1}{2}) + 20(\\frac{\\sqrt{3}}{2}) \\\\ 20(\\frac{1}{2}) - 10(\\frac{\\sqrt{3}}{2}) \\end{pmatrix} = \\begin{pmatrix} 15 + 10\\sqrt{3} \\\\ 10 - 5\\sqrt{3} \\end{pmatrix} $$\n结果完全匹配，证实了整个推导过程和计算的正确性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n15 + 10\\sqrt{3}  10 - 5\\sqrt{3}\n\\end{pmatrix}\n}\n$$", "id": "3544306"}, {"introduction": "在手动计算的基础上，这个实践练习将我们的关注点从单个点扩展到整个莫尔圆。我们将首先从第一性原理出发，推导莫尔圆的参数方程，然后通过编程实现它们。通过将解析公式的结果与基于柯西牵引力公式的直接数值计算进行比较，我们可以严格地验证我们的理解，并构建一个基础的计算工具。[@problem_id:3544334]", "problem": "在连续介质力学中，平面牵引变换提供了柯西应力张量与在任意平面上测量的应力分量之间的基本关系。在主应力基中，柯西应力张量是对角矩阵，其对角元等于主应力。莫尔圆表示法编码了所有可能的正应力和剪应力对，这些应力作用于其法线位于主平面内的平面上。使用牵引矢量以及将其正交分解为正应力分量和剪应力分量的方法，推导出用方向角参数函数表示的正应力和剪应力的解析圆方程，然后通过参数化采样对这些方程进行数值验证。\n\n从以下基本原理出发：\n- 柯西牵引公式：如果应力张量为 $\\boldsymbol{\\sigma}$，平面的单位法线为 $\\mathbf{n}$，则该平面上的牵引矢量为 $\\mathbf{t} = \\boldsymbol{\\sigma}\\,\\mathbf{n}$。\n- 平面上的正应力为 $\\sigma_n = \\mathbf{n}\\cdot\\mathbf{t}$。\n- 平面上的剪应力矢量为 $\\boldsymbol{\\tau} = \\mathbf{t} - \\sigma_n \\mathbf{n}$，剪应力大小为 $\\tau = \\|\\boldsymbol{\\tau}\\|$。\n\n在主应力坐标系中，应力张量为 $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1,\\sigma_2,\\sigma_3)$，其中 $\\sigma_1$、$\\sigma_2$ 和 $\\sigma_3$ 是主应力。考虑一个平面，其单位法线位于由坐标轴 $i$ 和 $j$（其中 $i\\neq j \\in \\{1,2,3\\}$）张成的一个主平面内。设单位法线 $\\mathbf{n}(\\theta)$ 在该主平面内由相对于轴 $i$ 的单个方向角 $\\theta$（以弧度为单位）参数化。使用上述基本原理，推导轨迹 $(\\sigma_n(\\theta),\\tau(\\theta))$ 关于 $\\sigma_i$、$\\sigma_j$ 和 $\\theta$ 的解析参数方程，并表示出在 $(\\sigma_n,\\tau)$ 平面中相应的圆方程。\n\n您的实现必须：\n- 使用 $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$、$\\sigma_n=\\mathbf{n}\\cdot\\mathbf{t}$ 和 $\\tau=\\|\\mathbf{t}-\\sigma_n\\mathbf{n}\\|$ 构建基于变换的应力分量 $(\\sigma_n(\\theta),\\tau(\\theta))$，并构建从您的圆方程推导出的解析参数函数。\n- 在 $[0,2\\pi)$ 范围内以弧度为单位均匀采样 $\\theta$，采样点数为指定的 $N$。\n- 对于每个测试用例，计算所有采样 $\\theta$ 值中，基于变换的结果与解析参数方程之间的最大绝对差异。使用欧几里得差异 $\\max_{\\theta} \\sqrt{\\left(\\Delta \\sigma_n(\\theta)\\right)^2 + \\left(\\Delta \\tau(\\theta)\\right)^2}$，其中 $\\Delta \\sigma_n(\\theta)$ 是正应力的差值，$\\Delta \\tau(\\theta)$ 是剪应力大小的差值。差异以兆帕 (MPa) 表示。\n\n假设使用以下测试用例集。在 $2\\mathrm{D}$ 情况下，将应力张量视为 $\\boldsymbol{\\sigma}=\\mathrm{diag}(\\sigma_1,\\sigma_2)$，平面法线位于 $(1,2)$ 主平面内；在 $3\\mathrm{D}$ 情况下，通过索引对 $(i,j)$ 选择主平面，并通过构造 $\\mathbf{n}(\\theta)$ 将第三个方向余弦设为零。\n\n测试用例参数：\n- 用例 $1$ (一般 $2\\mathrm{D}$): $\\sigma_1=80\\,\\mathrm{MPa}$，$\\sigma_2=20\\,\\mathrm{MPa}$，主平面索引对 $(i,j)=(1,2)$，$N=361$ 个样本。\n- 用例 $2$ (一般 $3\\mathrm{D}$): $\\sigma_1=120\\,\\mathrm{MPa}$，$\\sigma_2=60\\,\\mathrm{MPa}$，$\\sigma_3=30\\,\\mathrm{MPa}$，主平面索引对 $(i,j)=(1,3)$，$N=361$ 个样本。\n- 用例 $3$ (各向同性 $3\\mathrm{D}$): $\\sigma_1=50\\,\\mathrm{MPa}$，$\\sigma_2=50\\,\\mathrm{MPa}$，$\\sigma_3=50\\,\\mathrm{MPa}$，主平面索引对 $(i,j)=(1,2)$，$N=181$ 个样本。\n- 用例 $4$ (压缩 $2\\mathrm{D}$): $\\sigma_1=-10\\,\\mathrm{MPa}$，$\\sigma_2=-50\\,\\mathrm{MPa}$，主平面索引对 $(i,j)=(1,2)$，$N=181$ 个样本。\n- 用例 $5$ (近退化圆 $3\\mathrm{D}$): $\\sigma_1=100\\,\\mathrm{MPa}$，$\\sigma_2=99\\,\\mathrm{MPa}$，$\\sigma_3=20\\,\\mathrm{MPa}$，主平面索引对 $(i,j)=(1,2)$，$N=721$ 个样本。\n\n角度单位必须是弧度。应力单位必须是兆帕 (MPa)。您的程序应生成单行输出，其中包含用例 1 到 5 的差异，格式为方括号括起来的逗号分隔列表，单位为 MPa，例如 $[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\text{result5}]$。", "solution": "该问题要求从第一性原理推导应力莫尔圆的解析参数方程，并对其进行数值验证。验证过程将直接通过张量变换计算出的应力分量与从推导出的解析公式得到的应力分量进行比较。\n\n设柯西应力张量 $\\boldsymbol{\\sigma}$ 的主应力为 $\\sigma_1$、$\\sigma_2$ 和 $\\sigma_3$。在对应的以基矢量 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 构成的坐标系中，该应力张量是对角矩阵：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_1  0  0 \\\\ 0  \\sigma_2  0 \\\\ 0  0  \\sigma_3 \\end{pmatrix}\n$$\n我们关心的是法矢量位于主平面内的那些平面上的应力状态。让我们考虑由主轴 $i$ 和 $j$ 张成的平面，其中 $i,j \\in \\{1,2,3\\}$ 且 $i \\neq j$。该平面内的单位法矢量 $\\mathbf{n}$ 可由其相对于 $\\mathbf{e}_i$ 轴的角度 $\\theta$ 参数化：\n$$\n\\mathbf{n}(\\theta) = \\cos(\\theta) \\mathbf{e}_i + \\sin(\\theta) \\mathbf{e}_j\n$$\n该矢量的分量为 $n_i = \\cos(\\theta)$、$n_j = \\sin(\\theta)$，且对于 $k \\notin \\{i, j\\}$ 有 $n_k = 0$。\n\n根据柯西牵引公式，由 $\\mathbf{n}$ 定义的平面上的牵引矢量 $\\mathbf{t}$ 由 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ 给出。由于 $\\boldsymbol{\\sigma}$ 是对角矩阵，其分量为 $t_k = \\sigma_k n_k$（此处不进行求和）。对于我们选择的 $\\mathbf{n}$，牵引矢量为：\n$$\n\\mathbf{t} = \\sigma_i \\cos(\\theta) \\mathbf{e}_i + \\sigma_j \\sin(\\theta) \\mathbf{e}_j\n$$\n\n正应力 $\\sigma_n$ 是牵引矢量 $\\mathbf{t}$ 在单位法矢量 $\\mathbf{n}$ 上的投影：\n$$\n\\sigma_n = \\mathbf{t} \\cdot \\mathbf{n} = (\\sigma_i \\cos(\\theta) \\mathbf{e}_i + \\sigma_j \\sin(\\theta) \\mathbf{e}_j) \\cdot (\\cos(\\theta) \\mathbf{e}_i + \\sin(\\theta) \\mathbf{e}_j)\n$$\n$$\n\\sigma_n = \\sigma_i \\cos^2(\\theta) + \\sigma_j \\sin^2(\\theta)\n$$\n使用倍角公式 $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ 和 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$，我们可以将 $\\sigma_n$ 重写为：\n$$\n\\sigma_n(\\theta) = \\sigma_i \\left(\\frac{1+\\cos(2\\theta)}{2}\\right) + \\sigma_j \\left(\\frac{1-\\cos(2\\theta)}{2}\\right) = \\frac{\\sigma_i + \\sigma_j}{2} + \\frac{\\sigma_i - \\sigma_j}{2} \\cos(2\\theta)\n$$\n这就是正应力 $\\sigma_n$ 作为方向角 $\\theta$ 的函数的参数方程。\n\n剪应力大小 $\\tau$ 是剪应力矢量 $\\boldsymbol{\\tau}$ 的模，$\\boldsymbol{\\tau}$ 是 $\\mathbf{t}$ 垂直于 $\\mathbf{n}$ 的分量。该关系由 $\\boldsymbol{\\tau} = \\mathbf{t} - \\sigma_n \\mathbf{n}$ 给出，因此 $\\tau = \\|\\mathbf{t} - \\sigma_n\\mathbf{n}\\|$。一种等效的求 $\\tau$ 的方法是使用勾股关系 $\\|\\mathbf{t}\\|^2 = \\sigma_n^2 + \\tau^2$，得到 $\\tau = \\sqrt{\\|\\mathbf{t}\\|^2 - \\sigma_n^2}$（因为 $\\tau \\ge 0$）。让我们计算 $\\|\\mathbf{t}\\|^2$：\n$$\n\\|\\mathbf{t}\\|^2 = (\\sigma_i \\cos(\\theta))^2 + (\\sigma_j \\sin(\\theta))^2 = \\sigma_i^2 \\cos^2(\\theta) + \\sigma_j^2 \\sin^2(\\theta)\n$$\n代入 $\\|\\mathbf{t}\\|^2$ 和 $\\sigma_n^2$ 的表达式：\n$$\n\\tau^2 = (\\sigma_i^2 \\cos^2(\\theta) + \\sigma_j^2 \\sin^2(\\theta)) - (\\sigma_i \\cos^2(\\theta) + \\sigma_j \\sin^2(\\theta))^2\n$$\n$$\n\\tau^2 = \\sigma_i^2 \\cos^2(\\theta) + \\sigma_j^2 \\sin^2(\\theta) - (\\sigma_i^2 \\cos^4(\\theta) + 2\\sigma_i\\sigma_j \\cos^2(\\theta)\\sin^2(\\theta) + \\sigma_j^2 \\sin^4(\\theta))\n$$\n$$\n\\tau^2 = \\sigma_i^2(\\cos^2(\\theta) - \\cos^4(\\theta)) + \\sigma_j^2(\\sin^2(\\theta) - \\sin^4(\\theta)) - 2\\sigma_i\\sigma_j \\cos^2(\\theta)\\sin^2(\\theta)\n$$\n使用恒等式 $\\cos^2(\\theta)(1-\\cos^2(\\theta)) = \\cos^2(\\theta)\\sin^2(\\theta)$ 和 $\\sin^2(\\theta)(1-\\sin^2(\\theta)) = \\sin^2(\\theta)\\cos^2(\\theta)$：\n$$\n\\tau^2 = \\sigma_i^2 \\cos^2(\\theta)\\sin^2(\\theta) + \\sigma_j^2 \\cos^2(\\theta)\\sin^2(\\theta) - 2\\sigma_i\\sigma_j \\cos^2(\\theta)\\sin^2(\\theta)\n$$\n$$\n\\tau^2 = (\\sigma_i^2 - 2\\sigma_i\\sigma_j + \\sigma_j^2) \\cos^2(\\theta)\\sin^2(\\theta) = (\\sigma_i - \\sigma_j)^2 (\\cos(\\theta)\\sin(\\theta))^2\n$$\n使用恒等式 $\\cos(\\theta)\\sin(\\theta) = \\frac{\\sin(2\\theta)}{2}$：\n$$\n\\tau^2 = (\\sigma_i - \\sigma_j)^2 \\left(\\frac{\\sin(2\\theta)}{2}\\right)^2 = \\left(\\frac{\\sigma_i - \\sigma_j}{2}\\right)^2 \\sin^2(2\\theta)\n$$\n由于 $\\tau$ 是一个大小（模），它必须是非负的。取平方根，我们得到剪应力的参数方程：\n$$\n\\tau(\\theta) = \\left|\\frac{\\sigma_i - \\sigma_j}{2} \\sin(2\\theta)\\right|\n$$\n推导出的轨迹 $(\\sigma_n(\\theta), \\tau(\\theta))$ 的参数方程为：\n$$\n\\sigma_n(\\theta) = \\frac{\\sigma_i + \\sigma_j}{2} + \\frac{\\sigma_i - \\sigma_j}{2} \\cos(2\\theta)\n$$\n$$\n\\tau(\\theta) = \\left|\\frac{\\sigma_i - \\sigma_j}{2} \\sin(2\\theta)\\right|\n$$\n为了得到圆方程，我们定义圆心 $C = \\frac{\\sigma_i + \\sigma_j}{2}$ 和半径 $R = \\left|\\frac{\\sigma_i - \\sigma_j}{2}\\right|$。参数方程可以重新整理为：\n$$\n\\left(\\sigma_n - C\\right)^2 = \\left(\\frac{\\sigma_i - \\sigma_j}{2}\\right)^2 \\cos^2(2\\theta) = R^2 \\cos^2(2\\theta)\n$$\n$$\n\\tau^2 = \\left(\\frac{\\sigma_i - \\sigma_j}{2}\\right)^2 \\sin^2(2\\theta) = R^2 \\sin^2(2\\theta)\n$$\n将这两个方程相加，得到 $(\\sigma_n, \\tau)$ 平面上的圆方程：\n$$\n(\\sigma_n - C)^2 + \\tau^2 = R^2 (\\cos^2(2\\theta) + \\sin^2(2\\theta)) \\implies \\left(\\sigma_n - \\frac{\\sigma_i + \\sigma_j}{2}\\right)^2 + \\tau^2 = \\left(\\frac{\\sigma_i - \\sigma_j}{2}\\right)^2\n$$\n数值验证通过比较在角度范围 $\\theta \\in [0, 2\\pi)$ 内计算应力对 $(\\sigma_n, \\tau)$ 的两种方法来进行。\n方法 1（基于变换）直接应用基本定义。对于每个角度 $\\theta$，它计算 $\\mathbf{n}(\\theta)$，然后计算 $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$、$\\sigma_n=\\mathbf{n}\\cdot\\mathbf{t}$，最后计算 $\\tau = \\|\\mathbf{t}-\\sigma_n\\mathbf{n}\\|$。\n方法 2（解析法）直接使用推导出的 $\\sigma_n(\\theta)$ 和 $\\tau(\\theta)$ 的参数公式。\n两种方法之间的差异通过所有采样角度下，在 $(\\sigma_n, \\tau)$ 平面中所得点之间的最大欧几里得距离来量化：$\\max_{\\theta} \\sqrt{(\\sigma_{n,1} - \\sigma_{n,2})^2 + (\\tau_1 - \\tau_2)^2}$。\n\n实现过程将处理每个测试用例，方法是设置适当的 2D 或 3D 应力张量，并在指定的 $(i,j)$ 主平面内定义法矢量。对 $N$ 个均匀间隔的角度执行这两种计算方法。然后计算并报告最大差异。此过程验证了推导出的解析方程确实等同于基本变换定律，任何非零差异都可归因于浮点表示误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_discrepancy(stresses, plane_indices, N):\n    \"\"\"\n    Computes the maximum discrepancy between transformation-based and analytic\n    stress components for a Mohr's circle.\n\n    Args:\n        stresses (tuple): A tuple of principal stresses.\n                          (sigma_1, sigma_2) for 2D.\n                          (sigma_1, sigma_2, sigma_3) for 3D.\n        plane_indices (tuple): A tuple (i, j) of 1-based indices specifying the\n                               principal plane.\n        N (int): The number of samples for the angle theta.\n\n    Returns:\n        float: The maximum Euclidean discrepancy.\n    \"\"\"\n    is_3d = len(stresses) == 3\n    # Adjust for 0-based Python indexing\n    i = plane_indices[0] - 1\n    j = plane_indices[1] - 1\n    \n    sigma_i = stresses[i]\n    sigma_j = stresses[j]\n\n    # Generate sample angles\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n\n    # Method 2: Analytic parametric equations\n    sigma_center = (sigma_i + sigma_j) / 2.0\n    # The term (sigma_i - sigma_j) / 2 defines a signed radius, which is\n    # important for the orientation of the circle via the cos term.\n    radius_signed = (sigma_i - sigma_j) / 2.0\n    \n    sigma_n_analytic = sigma_center + radius_signed * np.cos(2 * theta)\n    tau_analytic = np.abs(radius_signed * np.sin(2 * theta))\n\n    # Method 1: Transformation-based calculation\n    dim = 3 if is_3d else 2\n    sigma_mat = np.diag(stresses)\n\n    sigma_n_transform = np.zeros(N)\n    tau_transform = np.zeros(N)\n\n    for k, th in enumerate(theta):\n        n = np.zeros(dim)\n        if is_3d:\n            n[i] = np.cos(th)\n            n[j] = np.sin(th)\n        else:  # 2D case, plane is implicitly (1,2)\n            n[0] = np.cos(th)\n            n[1] = np.sin(th)\n\n        # Apply Cauchy's formula: t = sigma * n\n        t = sigma_mat @ n\n        \n        # Normal stress: sigma_n = t . n\n        s_n = np.dot(t, n)\n        \n        # Shear stress magnitude: tau = ||t - sigma_n * n||\n        tau_vec = t - s_n * n\n        t_mag = np.linalg.norm(tau_vec)\n\n        sigma_n_transform[k] = s_n\n        tau_transform[k] = t_mag\n    \n    # Compute maximum Euclidean discrepancy\n    delta_sigma_n = sigma_n_transform - sigma_n_analytic\n    delta_tau = tau_transform - tau_analytic\n    discrepancies = np.sqrt(delta_sigma_n**2 + delta_tau**2)\n    \n    return np.max(discrepancies)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general 2D)\n        {'stresses': (80.0, 20.0), 'plane_indices': (1, 2), 'N': 361},\n        # Case 2 (general 3D)\n        {'stresses': (120.0, 60.0, 30.0), 'plane_indices': (1, 3), 'N': 361},\n        # Case 3 (isotropic 3D)\n        {'stresses': (50.0, 50.0, 50.0), 'plane_indices': (1, 2), 'N': 181},\n        # Case 4 (compressive 2D)\n        {'stresses': (-10.0, -50.0), 'plane_indices': (1, 2), 'N': 181},\n        # Case 5 (near-degenerate circle in 3D)\n        {'stresses': (100.0, 99.0, 20.0), 'plane_indices': (1, 2), 'N': 721},\n    ]\n\n    results = []\n    for case in test_cases:\n        discrepancy = compute_discrepancy(\n            case['stresses'], case['plane_indices'], case['N']\n        )\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3544334"}, {"introduction": "一个成功的计算模型不仅必须是准确的，还必须是数值稳健的。最后一个实践练习将探讨应力分析中的一个关键挑战：当主应力几乎相等时出现的数值不稳定性。我们将探索如何建立一个有原则的准则来检测这种近简并状态，并量化主方向定向的潜在误差，这是创建可靠的岩土力学软件的关键一步。[@problem_id:3544295]", "problem": "考虑一个在二维或三维空间中的对称 Cauchy 应力张量 $\\boldsymbol{\\sigma}$，其分量 $\\sigma_{ij}$ 以兆帕 (MPa) 为单位。在二维空间中，该张量是一个 $2\\times 2$ 的对称矩阵；在三维空间中，它是一个 $3\\times 3$ 的对称矩阵。主应力 $\\sigma_1$、$\\sigma_2$ 和 $\\sigma_3$（若适用）是 $\\boldsymbol{\\sigma}$ 的特征值，并按 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$ 的顺序排列。被称为莫尔圆的几何构造表示了通过这些主应力作用的平面上的正应力和剪应力；在三维空间中，有三个莫尔圆，其直径由主应力对 $(\\sigma_1,\\sigma_2)$、$(\\sigma_2,\\sigma_3)$ 和 $(\\sigma_1,\\sigma_3)$ 定义；在二维空间中，只有一个莫尔圆，其直径为 $(\\sigma_1,\\sigma_2)$。对应于应力对 $(\\sigma_i,\\sigma_j)$ 的莫尔圆半径由 $\\frac{|\\sigma_i - \\sigma_j|}{2}$ 给出，主方向的方位可通过 $\\boldsymbol{\\sigma}$ 的特征向量获得，或者在二维情况下，通过涉及角度 $\\theta$ 的变换得到，使得角度为 $\\theta$ 的平面呈现主应力状态。\n\n在计算岩土力学中，当 $\\sigma_1 \\approx \\sigma_2$（或任意一对主应力非常接近）时，相关的莫尔圆半径会变小，基于特征向量的方位计算可能变得病态，导致不稳定的数值行为。请从第一性原理出发，建立一个有原则的、算法化的判据来检测近简并主应力，并用它来为微小扰动下主方向的可能方位误差提供一个界限。您的推导必须从应力张量、主应力和莫尔圆几何的定义开始，并且必须通过基于矩阵范数和特征值间距的扰动/敏感性分析来证明该检测判据的合理性。假设应力分量的相对测量不确定度为 $10^{-6}$，并使用 $10^{-6}$ 作为相对于所选 $\\boldsymbol{\\sigma}$ 范数的数据误差大小。使用弗罗贝尼乌斯范数 $\\|\\boldsymbol{\\sigma}\\|_F = \\sqrt{\\sum_{i,j} \\sigma_{ij}^2}$ 对误差进行归一化。角度必须以弧度表示。\n\n实现以下计算任务：\n- 对于每个给定的应力张量，计算其主应力以及任意两个不同主应力之间的最小间距（最小分离度 $g_{\\min}$）。基于敏感性推导的检测判据，判断应力状态是否为近简并（若是则返回布尔值 $1$，否则返回 $0$）。同时，计算最敏感主方向子空间方位误差的一个保守界，表示为一个浮点数（单位为弧度）。如果发生精确简并（间距为零），则将该界定义为 $\\frac{\\pi}{2}$ 弧度。\n- 检测应是维度感知的（$2$D 或 $3$D），使用该维度下的最小特征值间距，并通过由假设的相对测量不确定度和矩阵范数推导出的、与范数一致的扰动尺度对间距进行归一化。\n\n使用以下应力张量测试集（所有条目单位均为 MPa）：\n- 测试 $1$（$2$D，一般情况）：$\\boldsymbol{\\sigma} = \\begin{bmatrix} 30  5 \\\\ 5  28 \\end{bmatrix}$。\n- 测试 $2$（$2$D，近简并）：$\\boldsymbol{\\sigma} = \\begin{bmatrix} 100  10^{-10} \\\\ 10^{-10}  100.0000001 \\end{bmatrix}$。\n- 测试 $3$（$3$D，近简并对应对 $(\\sigma_1,\\sigma_2)$）：$\\boldsymbol{\\sigma} = \\begin{bmatrix} 50  0  0 \\\\ 0  50.00002  0 \\\\ 0  0  10 \\end{bmatrix}$。\n- 测试 $4$（$3$D，精确简并）：$\\boldsymbol{\\sigma} = \\begin{bmatrix} 25  0  0 \\\\ 0  25  0 \\\\ 0  0  25 \\end{bmatrix}$。\n- 测试 $5$（$2$D，大间距）：$\\boldsymbol{\\sigma} = \\begin{bmatrix} -120  30 \\\\ 30  60 \\end{bmatrix}$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试，且为一个双元素列表 $[b,\\theta]$，其中 $b$ 是一个整数（近简并为 $1$，否则为 $0$），$\\theta$ 是一个浮点数，等于方位误差的保守界（单位为弧度）。例如，输出应类似于 $[[b_1,\\theta_1],[b_2,\\theta_2],\\dots]$。\n\n所有角度必须以弧度为单位。所有应力值均以 MPa 为单位。检测判据和方位误差界必须从第一性原理和敏感性分析出发，从上述定义开始推导，不得在本陈述中提供快捷公式。", "solution": "该问题要求建立一个用于检测近简并主应力的判据，并基于矩阵扰动理论推导主方向方位误差的界限。应力状态由一个对称的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 表示。分析的关键在于对 $\\boldsymbol{\\sigma}$ 的微小扰动如何影响其特征向量（主方向）。\n\n**1. 扰动框架**\n\n设精确的应力张量为一个对称矩阵 $\\boldsymbol{\\sigma}$。由于测量不确定性，我们观测到的是一个受扰动的张量 $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} + \\mathbf{E}$，其中 $\\mathbf{E}$ 是一个表示误差的对称扰动矩阵。问题给出了 $10^{-6}$ 的相对不确定度。我们按照规定，使用弗罗贝尼乌斯范数来量化此误差的大小。因此，扰动的界限为：\n$$\n\\|\\mathbf{E}\\|_F \\le \\epsilon\n$$\n其中 $\\epsilon$ 是绝对误差尺度，定义为：\n$$\n\\epsilon = \\epsilon_{rel} \\cdot \\|\\boldsymbol{\\sigma}\\|_F = 10^{-6} \\|\\boldsymbol{\\sigma}\\|_F\n$$\n此处，$\\|\\boldsymbol{\\sigma}\\|_F = \\sqrt{\\sum_{i,j} \\sigma_{ij}^2}$ 是应力张量的弗罗贝尼乌斯范数。主应力 $\\sigma_i$ 和相应的主方向 $\\mathbf{v}_i$ 分别是 $\\boldsymbol{\\sigma}$ 的特征值和特征向量，满足 $\\boldsymbol{\\sigma}\\mathbf{v}_i = \\sigma_i\\mathbf{v}_i$。\n\n**2. 特征向量敏感性与方位误差**\n\n虽然对称矩阵的特征值总是良态的（根据 Weyl 不等式， $|\\sigma_i' - \\sigma_i| \\le \\|\\mathbf{E}\\|_2 \\le \\|\\mathbf{E}\\|_F$），但其特征向量可能对扰动极其敏感。这种敏感性与特征值之间的间距成反比。\n\n支配此行为的基础性结果是 Davis-Kahan $\\sin\\Theta$ 定理。对于一个对称矩阵 $\\boldsymbol{\\sigma}$，假设其特征谱被划分为两组，相应的特征空间由 $\\mathbf{V}_1$ 和 $\\mathbf{V}_2$ 的列向量张成。设 $\\mathbf{V}_1'$ 是对应于 $\\boldsymbol{\\sigma}'$ 的受扰动特征空间。该定理为原始特征空间与受扰动特征空间之间的最大主角 $\\Theta$ 的正弦值提供了一个界限。对于单个特征向量 $\\mathbf{v}_i$（对应于单特征值 $\\sigma_i$）的角度 $\\theta_i$，一个简化且广泛使用的推论是：\n$$\n\\sin \\theta_i \\le \\frac{\\|\\mathbf{E}\\|_2}{g_i}\n$$\n其中 $g_i = \\min_{j \\neq i} |\\sigma_i - \\sigma_j|$ 是 $\\sigma_i$ 与其余特征谱之间的绝对间距。由于 2-范数受弗罗贝尼乌斯范数所约束（对于任意矩阵 $\\mathbf{A}$ 都有 $\\|\\mathbf{A}\\|_2 \\le \\|\\mathbf{A}\\|_F$），我们可以使用我们定义的扰动尺度 $\\epsilon$ 建立一个保守界：\n$$\n\\sin \\theta_i \\le \\frac{\\|\\mathbf{E}\\|_F}{g_i} \\le \\frac{\\epsilon}{g_i} = \\frac{10^{-6} \\|\\boldsymbol{\\sigma}\\|_F}{g_i}\n$$\n对于小角度，$\\theta_i \\approx \\sin \\theta_i$。因此，方位误差 $\\theta_i$ 的一个保守界是 $\\theta_i \\le \\arcsin(\\epsilon/g_i)$。\n\n问题要求为最敏感主方向的方位误差提供一个单一的界。这对应于与最小特征值间距相关联的特征向量。我们定义所有不同主应力上的最小间距 $g_{\\min}$：\n$$\ng_{\\min} = \\min_{\\sigma_i \\ne \\sigma_j} |\\sigma_i - \\sigma_j|\n$$\n如果所有特征值都相同（完全简并），则不存在不同的对应对，我们定义 $g_{\\min} = 0$。\n\n因此，方位误差的总体保守界 $\\theta_{\\text{bound}}$ 为：\n$$\n\\theta_{\\text{bound}} = \\arcsin\\left(\\frac{\\epsilon}{g_{\\min}}\\right)\n$$\n这个公式仅在 $\\epsilon/g_{\\min} \\le 1$ 时有意义。如果 $\\epsilon  g_{\\min}$，则扰动大于间距，这意味着特征向量不再锚定于一个分离良好的特征值。在这种情况下，方位可能会发生剧烈变化，其误差界可取为一个方向可能的最大值，即 $\\pi/2$ 弧度。这也适用于精确简并（$g_{\\min} = 0$）的情况，如问题所述。完整的界限公式为：\n$$\n\\theta_{\\text{bound}} = \\begin{cases} \\frac{\\pi}{2}  \\text{if } g_{\\min} \\le \\epsilon \\\\ \\arcsin\\left(\\frac{\\epsilon}{g_{\\min}}\\right)  \\text{if } g_{\\min}  \\epsilon \\end{cases}\n$$\n对于 $g_{\\min}  0$ 的情况，这可以紧凑地写作 $\\theta_{\\text{bound}} = \\arcsin\\left(\\min\\left(1, \\frac{\\epsilon}{g_{\\min}}\\right)\\right)$；对于 $g_{\\min} = 0$ 的情况，则为 $\\pi/2$。\n\n**3. 近简并判据**\n\n如果一个应力状态的主方向对微小扰动高度敏感，则认为该应力状态是近简并的。根据上述分析，当最小间距 $g_{\\min}$ 很小时，这种敏感性就很高。“小”是相对于扰动尺度 $\\epsilon$ 而言的。一个有原则的、非任意的判据是直接将间距与扰动大小进行比较。如果间距小于或等于扰动尺度，则特征值在数值上难以区分，相应的主方向也不稳定。\n\n因此，我们定义一个应力状态为**近简并**，如果：\n$$\ng_{\\min} \\le \\epsilon \\quad \\text{或等价地，} \\quad g_{\\min} \\le 10^{-6} \\|\\boldsymbol{\\sigma}\\|_F\n$$\n这个条件直接对应于方位误差界 $\\theta_{\\text{bound}}$ 达到其最大值 $\\pi/2$ 的情况。如果满足此条件（近简并），布尔标志 $b$ 为 $1$，否则为 $0$。\n\n**4. 算法实现**\n\n对于每个给定的应力张量 $\\boldsymbol{\\sigma}$，计算步骤如下：\n1.  计算弗罗贝尼乌斯范数 $\\|\\boldsymbol{\\sigma}\\|_F$。\n2.  计算扰动尺度 $\\epsilon = 10^{-6} \\|\\boldsymbol{\\sigma}\\|_F$。\n3.  计算 $\\boldsymbol{\\sigma}$ 的特征值。设其为 $\\{\\sigma_i\\}$。\n4.  识别唯一的特征值集合。如果只有一个唯一特征值，则为精确简并情况。设置 $g_{\\min}=0$，$b=1$，以及 $\\theta_{\\text{bound}}=\\pi/2$。\n5.  如果有多个唯一特征值，计算所有相邻的、已排序的唯一特征值之间的差值，并找出其中的最小值。此即为 $g_{\\min}$。\n6.  应用近简并判据：如果 $g_{\\min} \\le \\epsilon$，则设置 $b=1$；否则设置 $b=0$。\n7.  计算方位误差界 $\\theta_{\\text{bound}}$。如果 $g_{\\min} \\le \\epsilon$（或 $g_{\\min}=0$），则 $\\theta_{\\text{bound}} = \\pi/2$。否则，$\\theta_{\\text{bound}} = \\arcsin(\\epsilon / g_{\\min})$。\n8.  返回数对 $[b, \\theta_{\\text{bound}}]$。\n\n此算法将为每个提供的测试用例实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a suite of stress tensors.\n    \n    For each tensor, it determines if the principal stress state is near-degenerate\n    and computes a conservative bound on the orientation error of the most\n    sensitive principal direction.\n    \"\"\"\n\n    # --- Test Cases ---\n    # All stress values are in MPa.\n    test_cases = [\n        # Test 1: 2D, general case\n        np.array([[30, 5], [5, 28]], dtype=float),\n        \n        # Test 2: 2D, near-degenerate\n        np.array([[100, 1e-10], [1e-10, 100.0000001]], dtype=float),\n        \n        # Test 3: 3D, near-degenerate pair (sigma1, sigma2)\n        np.array([[50, 0, 0], [0, 50.00002, 0], [0, 0, 10]], dtype=float),\n        \n        # Test 4: 3D, exact degeneracy\n        np.array([[25, 0, 0], [0, 25, 0], [0, 0, 25]], dtype=float),\n        \n        # Test 5: 2D, large separation\n        np.array([[-120, 30], [30, 60]], dtype=float),\n    ]\n\n    results = []\n    \n    # Relative measurement uncertainty\n    relative_uncertainty = 1e-6\n\n    for sigma_tensor in test_cases:\n        # Step 1: Calculate Frobenius norm\n        norm_sigma = np.linalg.norm(sigma_tensor, 'fro')\n        \n        # Step 2: Calculate perturbation scale\n        epsilon = relative_uncertainty * norm_sigma\n        \n        # Step 3: Compute eigenvalues (principal stresses)\n        # eigvalsh is used for symmetric matrices for better performance and stability.\n        principal_stresses = np.linalg.eigvalsh(sigma_tensor)\n        \n        # Step 4  5: Find minimal gap g_min\n        unique_stresses = np.unique(principal_stresses)\n        \n        is_degenerate = 0\n        orientation_error_bound = 0.0\n        \n        if len(unique_stresses)  2:\n            # Exact degeneracy (all eigenvalues are the same)\n            g_min = 0.0\n        else:\n            # Sort unique stresses to find gaps between adjacent ones\n            unique_stresses.sort()\n            gaps = np.diff(unique_stresses)\n            g_min = np.min(gaps)\n\n        # Step 6: Apply near-degeneracy criterion\n        # A state is near-degenerate if the gap is smaller than or equal to the perturbation scale\n        if g_min = epsilon:\n            is_degenerate = 1\n        else:\n            is_degenerate = 0\n            \n        # Step 7: Calculate orientation error bound\n        if g_min == 0.0:\n            # Exact degeneracy as per problem statement and derivation\n            orientation_error_bound = np.pi / 2.0\n        else:\n            arg = epsilon / g_min\n            # The argument of arcsin must be = 1. If not, the bound is pi/2.\n            if arg > 1.0:\n                orientation_error_bound = np.pi / 2.0\n            else:\n                orientation_error_bound = np.arcsin(arg)\n\n        # The criterion for is_degenerate=1 implies g_min = epsilon,\n        # which means arg >= 1 (or g_min=0), so bound is pi/2. The logic is consistent.\n        if is_degenerate == 1:\n            orientation_error_bound = np.pi / 2.0\n                \n        results.append([is_degenerate, orientation_error_bound])\n\n    # Final print statement in the exact required format.\n    # Joining a list of lists requires converting inner lists to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3544295"}]}