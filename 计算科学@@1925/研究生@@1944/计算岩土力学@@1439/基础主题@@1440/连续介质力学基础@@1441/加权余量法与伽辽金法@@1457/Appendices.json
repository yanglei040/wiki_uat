{"hands_on_practices": [{"introduction": "在伽辽金弱形式中出现的积分，尤其是在使用等参元的情况下，通常无法通过解析方法求解，必须依赖数值积分。本练习将引导你确定精确积分一个单元刚度矩阵所需的最小高斯求积阶数 [@problem_id:3571272]。理解形函数的导数所产生的被积函数多项式次数与高斯-勒让德求积法则的精确性之间的关系，对于确保有限元解的准确性至关重要。", "problem": "一个具有弹性行为的均质平面应变土样，在有限元法（FEM）框架内，使用伽辽金法，通过单个等参 $Q_2$（双二次）四边形有限元进行建模。该土样占据一个子域 $\\Omega_e \\subset \\mathbb{R}^2$，其平面应变线性弹性的本构矩阵（记为 $\\boldsymbol{D}$）在整个 $\\Omega_e$ 上为常数。平衡弱形式导出的单元刚度矩阵的各项为\n$$\nK_{ij} = \\int_{\\Omega_e} \\boldsymbol{B}_i^{T} \\boldsymbol{D} \\boldsymbol{B}_j \\,\\mathrm{d}\\Omega,\n$$\n其中 $\\boldsymbol{B}_i$ 是与形函数相关的应变-位移矩阵。\n\n假设从自然坐标 $(\\xi,\\eta)$ 下的父单元正方形 $[-1,1]\\times[-1,1]$ 到物理单元存在一个仿射映射，因此雅可比矩阵 $\\boldsymbol{J}$ 及其行列式 $\\det\\boldsymbol{J}$ 在整个单元上为常数。$Q_2$ 形函数是 $(\\xi,\\eta)$ 中的标准张量积二次拉格朗日多项式，所采用的高斯求积是每个参数方向上具有 $n$ 个点的张量积高斯-勒让德法则。\n\n在所述假设下，利用伽辽金法和自然坐标中被积函数的多项式次数，确定精确积分刚度矩阵 $K_{ij}$ 所有项所需的最小整数 $n$（每个方向上的高斯求积阶数）。请提供论证，指出被积函数在每个参数方向上存在的最高多项式次数，并利用高斯-勒让德求积的精确性性质。以整数 $n$ 的形式给出最终答案。", "solution": "出发点是无体力的均质物体平面应变线性弹性的强形式，\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0},\n$$\n以及本构律和运动学关系\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{D}\\,\\boldsymbol{\\epsilon}, \\qquad \\boldsymbol{\\epsilon} = \\boldsymbol{L}\\,\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{\\sigma}$ 是应力向量，$\\boldsymbol{\\epsilon}$ 是应变向量，$\\boldsymbol{u}$ 是位移向量，$\\boldsymbol{D}$ 是平面应变的常数本构矩阵，$\\boldsymbol{L}$ 是将位移映射到应变的微分算子。在加权余量法框架中采用伽辽金法（即检验函数等于试探形函数），在一个单元 $\\Omega_e$ 上的弱形式得出单元刚度矩阵\n$$\nK_{ij} = \\int_{\\Omega_e} \\boldsymbol{B}_i^{T} \\boldsymbol{D} \\boldsymbol{B}_j \\,\\mathrm{d}\\Omega,\n$$\n其中 $\\boldsymbol{B}_i$ 是与第 $i$ 个形函数相关的应变-位移矩阵。\n\n引入从父域 $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$ 到物理坐标 $(x,y)$ 的等参映射\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{n_n} N_a(\\xi,\\eta)\\, x_a, \\qquad y(\\xi,\\eta) = \\sum_{a=1}^{n_n} N_a(\\xi,\\eta)\\, y_a,\n$$\n其中 $N_a(\\xi,\\eta)$ 是 $Q_2$ 形函数，$n_n=9$ 是双二次四边形单元的节点数。在仿射映射假设下，雅可比矩阵\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n$$\n及其行列式 $\\det\\boldsymbol{J}$ 在整个单元上为常数。通过链式法则，关于物理坐标 $(x,y)$ 的导数与关于自然坐标 $(\\xi,\\eta)$ 的导数相关联：\n$$\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x} \\\\\n\\frac{\\partial}{\\partial y}\n\\end{pmatrix}\n=\n\\boldsymbol{J}^{-1}\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial \\xi} \\\\\n\\frac{\\partial}{\\partial \\eta}\n\\end{pmatrix},\n$$\n因此应变-位移矩阵满足\n$$\n\\boldsymbol{B}_i = \\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_i(\\xi,\\eta),\n$$\n其中 $\\boldsymbol{T}$ 是一个将笛卡尔导数组合成应变分量的常数矩阵，而 $\\boldsymbol{G}_i(\\xi,\\eta)$ 在适当位置收集了自然导数 $\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial \\eta}$。\n\n将刚度积分变换到父域可得\n$$\nK_{ij} = \\int_{-1}^{1}\\int_{-1}^{1} \n\\left(\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_i(\\xi,\\eta)\\right)^{T}\n\\boldsymbol{D}\n\\left(\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_j(\\xi,\\eta)\\right)\n\\,\\det\\boldsymbol{J}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n在仿射映射假设下，$\\boldsymbol{J}$、$\\boldsymbol{J}^{-1}$、$\\det\\boldsymbol{J}$、$\\boldsymbol{T}$ 和 $\\boldsymbol{D}$ 均为常数，因此被积函数简化为一个夹在形函数自然导数乘积周围的常数矩阵：\n$$\nK_{ij} = \\det\\boldsymbol{J}\\,\n\\int_{-1}^{1}\\int_{-1}^{1} \n\\boldsymbol{G}_i(\\xi,\\eta)^{T}\n\\left(\\boldsymbol{J}^{-T}\\boldsymbol{T}^{T}\\boldsymbol{D}\\,\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\right)\n\\boldsymbol{G}_j(\\xi,\\eta)\\,\n\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n因此，被积函数在 $(\\xi,\\eta)$ 中的多项式次数完全由 $\\boldsymbol{G}_i(\\xi,\\eta)$ 和 $\\boldsymbol{G}_j(\\xi,\\eta)$ 的分量，即 $Q_2$ 形函数的自然导数的次数决定。\n\n对于张量积 $Q_2$ 基，每个形函数的形式为\n$$\nN(\\xi,\\eta) = L_p(\\xi)\\,L_q(\\eta),\n$$\n其中 $L_p(\\xi)$ 和 $L_q(\\eta)$ 是一维二次拉格朗日多项式。因此，\n$$\n\\frac{\\partial N}{\\partial \\xi} = L_p'(\\xi)\\,L_q(\\eta), \\qquad\n\\frac{\\partial N}{\\partial \\eta} = L_p(\\xi)\\,L_q'(\\eta).\n$$\n由于 $L_p'(\\xi)$ 是关于 $\\xi$ 的线性函数（次数为 $1$），而 $L_q(\\eta)$ 是关于 $\\eta$ 的二次函数（次数为 $2$），因此\n$$\n\\frac{\\partial N}{\\partial \\xi} \\in \\mathcal{P}_1(\\xi)\\otimes \\mathcal{P}_2(\\eta),\n$$\n同理\n$$\n\\frac{\\partial N}{\\partial \\eta} \\in \\mathcal{P}_2(\\xi)\\otimes \\mathcal{P}_1(\\eta),\n$$\n其中 $\\mathcal{P}_k$ 表示在指定变量中次数最多为 $k$ 的多项式。被积函数 $\\boldsymbol{G}_i^{T}(\\cdot)\\,(\\cdot)\\,\\boldsymbol{G}_j(\\cdot)$ 是这些分量乘积之和。可能的乘积及其在每个变量中的次数为：\n- 包含 $\\left(\\frac{\\partial N}{\\partial \\xi}\\right)^2$ 的项：在 $\\xi$ 方向次数为 $2$（因为 $1+1=2$），在 $\\eta$ 方向次数为 $4$（因为 $2+2=4$）。\n- 包含 $\\left(\\frac{\\partial N}{\\partial \\eta}\\right)^2$ 的项：在 $\\xi$ 方向次数为 $4$，在 $\\eta$ 方向次数为 $2$。\n- 混合项 $\\frac{\\partial N}{\\partial \\xi}\\,\\frac{\\partial N}{\\partial \\eta}$：在 $\\xi$ 方向次数为 $3$（因为 $1+2=3$），在 $\\eta$ 方向次数为 $3$（因为 $2+1=3$）。\n\n因此，被积函数在任一参数方向上出现的最高多项式次数为 $4$。因为在仿射映射下 $\\det\\boldsymbol{J}$ 和各矩阵均为常数，所以这个最大次数不受常数因子的影响。\n\n每个方向上具有 $n$ 个点的二维张量积高斯-勒让德求积，对每个变量分别可精确积分最高 $2n-1$ 次的多项式。要精确积分在 $\\xi$ 和 $\\eta$ 方向上次数最高为 $4$ 的多项式，我们需要\n$$\n2n - 1 \\geq 4 \\quad \\Longrightarrow \\quad n \\geq 2.5\n$$\n因此，在所述假设下，保证精确积分所有刚度矩阵项的最小整数 $n$ 是 $n=3$。", "answer": "$$\\boxed{3}$$", "id": "3571272"}, {"introduction": "虽然精确积分是理想情况，但在实践中，为了节省计算成本或缓解单元锁定，我们有时会有意地采用“减缩积分”。本练习探讨了这种做法的一个主要后果：产生了称为“沙漏模式”的非物理、零能量变形模式 [@problem_id:3571287]。理解这些伪模式源于减缩积分下单元刚度矩阵的“秩亏”，是有效使用减缩积分单元的关键。", "problem": "考虑一个均匀、线弹性的平面应变体，该物体被一个等参双线性四边形单元（$Q_1$）离散，其节点在父域 $\\left[-1,1\\right]^2$ 中按逆时针方向标记为 $1$–$4$。使用 Galerkin 加权余量法（有限元法 (FEM) 中，Galerkin 法选择的权函数等于试探形函数），单元刚度矩阵 $K_e$ 从平衡弱形式中得到：\n$$\nK_e \\;=\\; \\int_{\\Omega_e} B^T D B \\, \\mathrm{d}\\Omega,\n$$\n其中 $B$ 是应变-位移矩阵，$D$ 是平面应变弹性本构矩阵（对于稳定材料是正定的），$\\Omega_e$ 是单元域。在缩减（单点）Gauss 积分中，积分在单元中心 $\\left(\\xi,\\eta\\right)=\\left(0,0\\right)$ 处近似为：\n$$\nK_e^{(RI)} \\;\\approx\\; w\\,\\det J(0,0)\\, B(0,0)^T\\, D\\, B(0,0),\n$$\n其中 $J$ 是等参 Jacobian 矩阵，$w0$ 是积分权重。对于一个非退化单元（即 $\\det J(0,0) \\neq 0$），通过识别沙漏模式并解释其与 $K_e^{(RI)}$ 秩亏的关系，分析这种缩减积分对 $Q_1$ 平面应变单元的影响。假设小应变和线性运动学。\n\n下列陈述中哪些是正确的？选择所有适用项。\n\nA. 对于一个采用单点缩减积分的通用非退化等参 $Q_1$ 平面应变单元，单元刚度矩阵 $K_e^{(RI)}$ 的秩为 $3$，这意味着除了 $3$ 个刚体模式外，还存在恰好 $2$ 个线性独立的沙漏模式。\n\nB. 在一个仿射映射（平行四边形）的 $Q_1$ 单元上，单点缩减积分消除了沙漏模式，因为应变场是恒定的，所以 $K_e^{(RI)}$ 是满秩的。\n\nC. 沙漏子空间的一个基可以取为与节点位移模式 $\\left[+1,\\,-1,\\,+1,\\,-1\\right]$ 成比例的位移场，该位移场独立地应用于 $u_x$（此时 $u_y=0$）和 $u_y$（此时 $u_x=0$）；对于任何满足 $\\det J(0,0)\\neq 0$ 的单元形状，这两种模式在 Gauss 点处产生的应变均为零。\n\nD. 沙漏模式的出现是因为用单个 Gauss 点计算的 Galerkin 弱形式错误地积分了非零的常应变场；这些伪模式对应于常应变机制。\n\nE. 在平面应变中，由于应变向量的维度为 $3$，乘积 $K_e^{(RI)} = B(0,0)^T D B(0,0)$ 的秩最多为 $3$。对于一个通用的非退化单元，这解释了秩亏以及非刚体零能模式的存在。", "solution": "用户提供了一个关于平面应变条件下，单个等参双线性四边形单元（$Q_1$）在使用单点缩减积分时的数值特性的问题陈述。任务是验证该问题，然后分析所提供的陈述。\n\n### 问题验证\n\n问题陈述是有效的。它在科学上植根于应用于计算固体力学的有限元法（FEM）的成熟理论。所有术语，如“等参双线性四边形单元”、“平面应变”、“Galerkin 加权余量法”、“单元刚度矩阵”、“缩减积分”和“沙漏模式”，在该领域内都是标准且明确定义的。所提供的精确积分和缩减积分刚度矩阵的方程是正确的。该问题是适定的，要求在明确规定的条件下对一个已知的数值伪影（沙漏）进行标准分析。它是客观且自洽的，为进行严谨的数学推导提供了足够的信息。\n\n### 推导\n\n一个平面应变双线性四边形单元（$Q_1$）有 $4$ 个节点，每个节点有 $2$ 个自由度（DOF）（$u_x, u_y$）。因此，该单元总共有 $4 \\times 2 = 8$ 个自由度。节点位移向量 $\\mathbf{u}_e$ 是一个 $8 \\times 1$ 的向量。单元刚度矩阵 $K_e$ 是一个 $8 \\times 8$ 的矩阵。\n\n对于平面应变中的线弹性材料，应变向量为 $\\boldsymbol{\\epsilon} = [\\epsilon_x, \\epsilon_y, \\gamma_{xy}]^T$，其维度为 $3$。本构矩阵 $D$ 是一个 $3 \\times 3$ 的对称正定矩阵。应变-位移关系由 $\\boldsymbol{\\epsilon} = B \\mathbf{u}_e$ 给出，其中 $B$ 是 $3 \\times 8$ 的应变-位移矩阵。$B$ 的元素是形函数 $N_i$ 对物理坐标 $(x,y)$ 的导数的函数。\n\n在单点（缩减）Gauss 积分下，单元刚度矩阵在父单元的中心 $(\\xi, \\eta) = (0,0)$ 处近似为：\n$$\nK_e^{(RI)} = w\\,\\det J(0,0)\\, B(0,0)^T\\, D\\, B(0,0)\n$$\n此处，$w$ 是正的积分权重（对于 $[-1,1]^2$ 域中的单点积分，$w=4$），$J(0,0)$ 是在中心点计算的等参映射的 Jacobian 矩阵。对于非退化单元，$\\det J(0,0)  0$。令 $c = w\\,\\det J(0,0)$。由于 $c  0$， $K_e^{(RI)}$ 的秩由矩阵乘积 $B(0,0)^T D B(0,0)$ 的秩决定。\n\n$K_e^{(RI)}$ 的秩可以分析如下：\n$\\text{rank}(K_e^{(RI)}) = \\text{rank}(B(0,0)^T D B(0,0))$。由于 $D$ 是一个 $3 \\times 3$ 的正定矩阵，它是满秩的，我们可以写出 $D = L L^T$，其中 $L$ 是一个非奇异的 $3 \\times 3$ 矩阵（例如，通过 Cholesky 分解得到）。那么，\n$$\n\\text{rank}(K_e^{(RI)}) = \\text rank(B(0,0)^T L L^T B(0,0)) = \\text{rank}((L^T B(0,0))^T (L^T B(0,0))) = \\text{rank}(L^T B(0,0))\n$$\n因为 $L^T$ 是非奇异的（秩为 $3$），秩进一步简化为：\n$$\n\\text{rank}(K_e^{(RI)}) = \\text{rank}(B(0,0))\n$$\n矩阵 $B(0,0)$ 是一个 $3 \\times 8$ 的矩阵。任何矩阵的秩最多为其行数和列数的最小值。因此，$\\text{rank}(B(0,0)) \\le \\min(3, 8) = 3$。对于一个通用的（非病态的）单元几何形状，$B(0,0)$ 的三行是线性独立的。因此，对于一个通用单元，$\\text{rank}(K_e^{(RI)}) = 3$。\n\n单元的零能模式数量是 $K_e^{(RI)}$ 零空间的维度。根据秩-零度定理，对于 $8 \\times 8$ 矩阵 $K_e^{(RI)}$：\n$$\n\\dim(\\text{null}(K_e^{(RI)})) = \\text{总自由度数} - \\text{rank}(K_e^{(RI)}) = 8 - 3 = 5.\n$$\n这 5 个模式是位移模式 $\\mathbf{u}_e$，对于这些模式，通过缩减积分计算出的应变能为零。\n\n零能模式由刚体模式和伪（沙漏）模式组成。对于一个二维物体，总是有 $3$ 个刚体模式（两个平移和一个平面内旋转），它们在任何地方都产生零应变，因此具有零应变能。\n$$\n\\text{沙漏模式数量} = (\\text{总零能模式数}) - (\\text{刚体模式数}) = 5 - 3 = 2.\n$$\n一个稳定的单元（在考虑了刚体运动之后）应具有秩为 $8 - 3 = 5$ 的刚度矩阵。秩为 $3$ 表明存在 $5-3=2$ 的秩亏，对应于两个伪沙漏模式。\n\n### 逐项分析\n\n**A. 对于一个采用单点缩减积分的通用非退化等参 $Q_1$ 平面应变单元，单元刚度矩阵 $K_e^{(RI)}$ 的秩为 $3$，这意味着除了 $3$ 个刚体模式外，还存在恰好 $2$ 个线性独立的沙漏模式。**\n该陈述是上述推导的直接结果。$K_e^{(RI)}$ 的秩为 $3$。其零空间的维度为 $8-3=5$。这个零空间由 $3$ 个刚体模式和 $2$ 个额外的、伪的、线性独立的沙漏模式张成。该陈述完全正确。\n**结论：正确**\n\n**B. 在一个仿射映射（平行四边形）的 $Q_1$ 单元上，单点缩减积分消除了沙漏模式，因为应变场是恒定的，所以 $K_e^{(RI)}$ 是满秩的。**\n这个陈述包含几个谬误。首先，对于一个 $Q_1$ 单元，即使是仿射映射（Jacobian 矩阵 $J$ 为常数），应变场也不是恒定的。双线性形函数的导数是父坐标的线性函数，因此应变也是线性的。其次，对于任何非退化的 $Q_1$ 单元，无论是否为仿射映射，单点积分都不能消除沙漏现象。上面分析的导致秩亏的机制与 Jacobian 矩阵是否为常数无关。第三，因此，$K_e^{(RI)}$ 不是满秩的（即，在移除刚体模式后秩为 $5$）；它的秩是 $3$。\n**结论：不正确**\n\n**C. 沙漏子空间的一个基可以取为与节点位移模式 $\\left[+1,\\,-1,\\,+1,\\,-1\\right]$ 成比例的位移场，该位移场独立地应用于 $u_x$（此时 $u_y=0$）和 $u_y$（此时 $u_x=0$）；对于任何满足 $\\det J(0,0)\\neq 0$ 的单元形状，这两种模式在 Gauss 点处产生的应变均为零。**\n令节点向量为 $\\boldsymbol{\\psi} = [1, -1, 1, -1]^T$（对应于节点 1,2,3,4）。\n考虑模式 $\\mathbf{u}_e$，其中 $u_{xi} = c \\psi_i$ 且 $u_{yi}=0$。在中心点 $(\\xi, \\eta)=(0,0)$ 处的应变为 $\\boldsymbol{\\epsilon}(0,0) = B(0,0) \\mathbf{u}_e$。我们必须检查该乘积是否为零。应变分量为：\n$\\epsilon_x(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}|_{(0,0)} u_{xi} = c \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}|_{(0,0)} \\psi_i$。\n$\\epsilon_y(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}|_{(0,0)} u_{yi} = 0$。\n$\\gamma_{xy}(0,0) = \\sum_{i=1}^4 \\left(\\frac{\\partial N_i}{\\partial y}|_{(0,0)} u_{xi} + \\frac{\\partial N_i}{\\partial x}|_{(0,0)} u_{yi}\\right) = c \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}|_{(0,0)} \\psi_i$。\n在中心点处形函数的导数为 $\\frac{\\partial N_i}{\\partial \\xi}|_{(0,0)} = \\frac{1}{4}\\xi_i$ 和 $\\frac{\\partial N_i}{\\partial \\eta}|_{(0,0)} = \\frac{1}{4}\\eta_i$。使用逆 Jacobian 法则，$\\frac{\\partial N_i}{\\partial x}|_{(0,0)}$ 是 $\\xi_i$ 和 $\\eta_i$ 的线性组合，$\\frac{\\partial N_i}{\\partial y}|_{(0,0)}$ 也是。求和项 $\\sum_{i=1}^4 \\xi_i \\psi_i$ 和 $\\sum_{i=1}^4 \\eta_i \\psi_i$ 为：\n$\\sum \\xi_i \\psi_i = (-1)(1) + (1)(-1) + (1)(1) + (-1)(-1) = -1 - 1 + 1 + 1 = 0$。\n$\\sum \\eta_i \\psi_i = (-1)(1) + (-1)(-1) + (1)(1) + (1)(-1) = -1 + 1 + 1 - 1 = 0$。\n由于这些和为零，它们的任何线性组合也为零。因此，在 $(0,0)$ 处的所有应变分量都为零。同样的逻辑适用于 $u_{xi}=0$ 和 $u_{yi} = c\\psi_i$ 的模式。这两种模式不是刚体运动，并且是线性独立的。由于我们发现恰好有两个沙漏模式，这两种模式构成了沙漏子空间的一个有效基。这对任何非退化单元都成立。\n**结论：正确**\n\n**D. 沙漏模式的出现是因为用单个 Gauss 点计算的 Galerkin 弱形式错误地积分了非零的常应变场；这些伪模式对应于常应变机制。**\n这个陈述错误地描述了这一现象。单点积分能正确计算常应变场的能量。$K_e^{(RI)}$ 的秩为 $3$ 对应于其表示三维常平面应变状态空间的能力。沙漏模式不是常应变机制。它们是高阶变形模式（例如，对于矩形单元，沙漏位移场与 $\\xi\\eta$ 成正比），其对应的应变场非零，但恰好在单个积分点处为零。因此，积分法则将其应变能错误地估计为零。\n**结论：不正确**\n\n**E. 在平面应变中，由于应变向量的维度为 $3$，乘积 $K_e^{(RI)} = B(0,0)^T D B(0,0)$ 的秩最多为 $3$。对于一个通用的非退化单元，这解释了秩亏以及非刚体零能模式的存在。**\n该陈述正确地指出了秩限制的根本原因。刚度矩阵是通过涉及 $3 \\times 8$ 矩阵 $B(0,0)$ 的乘积形成的。由 $B(0,0)$ 表示的从 $8$ 维节点位移空间到 Gauss 点处 $3$ 维应变空间的映射，内在地将任何后续矩阵乘积的秩限制在最多为 $3$。一个稳定的单元（没有伪模式）需要秩为 $8-3=5$。由于秩最多为 $3$，该矩阵必然是秩亏的。这种秩亏是存在超越刚体模式的零能模式的数学原因。这个推理是合理的。（注意：问题中省略了标量因子 $w \\det J(0,0)$，但这不影响秩）。\n**结论：正确**", "answer": "$$\\boxed{ACE}$$", "id": "3571287"}, {"introduction": "伽辽金方法的成功不仅取决于积分的准确性，还取决于所选的近似空间能否充分表达问题的物理行为。本练习将通过一个经典的“体积锁定”案例，揭示当低阶单元的近似能力不足以满足几乎不可压缩材料的体积不变约束时，会发生什么情况 [@problem_id:3571246]。通过分析离散形式下的无散度约束，你将亲眼看到一个看似合理的离散化方案是如何导致一个过度约束、无法得到有意义解的数值灾难的。", "problem": "考虑一个在方形区域 $\\Omega = [0,1]\\times[0,1]$ 上的、针对近不可压缩地质材料的静态、小应变、平面应变线性弹性问题。其强形式由线动量平衡方程和线性弹性本构方程组成：求位移场 $\\boldsymbol{u}:\\Omega\\rightarrow\\mathbb{R}^2$，使得在 $\\Omega$ 中有 $-\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{f}$，并在边界 $\\partial\\Omega$ 上满足均匀狄利克雷边界条件 $\\boldsymbol{u}=\\boldsymbol{0}$。柯西应力为 $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))\\,\\boldsymbol{I}$，其中 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$ 是小应变张量，$\\mu0$ 是剪切模量，$\\lambda\\gg\\mu$ 是第一拉梅参数（与体积相关的模量），用于模拟近不可压缩性。\n\n在标准伽辽金意义下使用加权余量法，其弱形式为：求 $\\boldsymbol{u}\\in \\boldsymbol{V}=\\{\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}:\\boldsymbol{v}=\\boldsymbol{0}\\text{ on }\\partial\\Omega\\}$，使得\n$$\na(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v})\\quad \\text{for all }\\boldsymbol{v}\\in \\boldsymbol{V},\n$$\n其中\n$$\na(\\boldsymbol{u},\\boldsymbol{v})=\\int_{\\Omega}\\big(2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})+\\lambda\\,(\\nabla\\cdot\\boldsymbol{u})(\\nabla\\cdot\\boldsymbol{v})\\big)\\,{\\rm d}\\Omega,\\quad\n\\ell(\\boldsymbol{v})=\\int_{\\Omega}\\boldsymbol{f}\\cdot\\boldsymbol{v}\\,{\\rm d}\\Omega.\n$$\n\n通过将正方形的中心 $(\\tfrac{1}{2},\\tfrac{1}{2})$ 与其四个顶点 $(0,0)$、$(1,0)$、$(1,1)$ 和 $(0,1)$ 连接，用得到的协调三角剖分对 $\\Omega$ 进行离散化，从而产生四个三角形。设近似空间为两个位移分量上的连续分片线性拉格朗日空间（两个分量采用同阶 $P_{1}$），即 $\\boldsymbol{V}_{h}=[V_{h}]^{2}$，其中 $V_{h}=\\{v_{h}\\in C^{0}(\\overline{\\Omega})\\mid v_{h}|_{T}\\in \\mathbb{P}_{1}(T)\\ \\forall T\\}\\cap H^{1}_{0}(\\Omega)$。在所有四个边界顶点上施加均匀狄利克雷条件，因此唯一的非零节点位移位于内部节点 $(\\tfrac{1}{2},\\tfrac{1}{2})$。\n\n从上述基本定义出发，应用伽辽金方法推导该网格的离散体积项和对体积应变的离散约束。在极限 $\\lambda\\to\\infty$（近不可压缩极限）下，离散解必须在 $L^{2}$ 意义上逐单元满足体积应变为零。通过检验对内部节点位移产生的逐单元约束，确定离散无散子空间的维数\n$$\n\\boldsymbol{Z}_{h}=\\{\\boldsymbol{u}_{h}\\in \\boldsymbol{V}_{h}\\mid (\\nabla\\cdot \\boldsymbol{u}_{h})|_{T}=0\\ \\text{for each triangle }T\\}.\n$$\n\n你的最终答案必须是等于 $\\dim(\\boldsymbol{Z}_{h})$ 的单个整数。不应报告任何中间结果或推导过程。答案是无量纲的，无需四舍五入。", "solution": "用户希望我严格验证一个给定的问题，如果问题有效，则提供一个完整且有理有据的解答。\n\n### 第 1 步：提取已知信息\n- **问题类型**：静态、小应变、平面应变线性弹性问题。\n- **区域**：$\\Omega = [0,1]\\times[0,1]$。\n- **控制方程**：在 $\\Omega$ 中 $-\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{f}$。\n- **边界条件**：均匀狄利克雷边界条件，在 $\\partial\\Omega$ 上 $\\boldsymbol{u}=\\boldsymbol{0}$。\n- **本构关系**：柯西应力 $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))\\,\\boldsymbol{I}$。\n- **应变张量**：$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$。\n- **材料参数**：剪切模量 $\\mu0$，第一拉梅参数 $\\lambda\\gg\\mu$（近不可压缩性）。\n- **弱形式**：求 $\\boldsymbol{u}\\in \\boldsymbol{V}$，使得对所有 $\\boldsymbol{v}\\in \\boldsymbol{V}$ 都有 $a(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v})$。\n- **函数空间**：$\\boldsymbol{V}=\\{\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}:\\boldsymbol{v}=\\boldsymbol{0}\\text{ on }\\partial\\Omega\\}$。\n- **双线性形式**：$a(\\boldsymbol{u},\\boldsymbol{v})=\\int_{\\Omega}\\big(2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})+\\lambda\\,(\\nabla\\cdot\\boldsymbol{u})(\\nabla\\cdot\\boldsymbol{v})\\big)\\,{\\rm d}\\Omega$。\n- **线性泛函**：$\\ell(\\boldsymbol{v})=\\int_{\\Omega}\\boldsymbol{f}\\cdot\\boldsymbol{v}\\,{\\rm d}\\Omega$。\n- **离散化**：通过将方形区域的中心 $(\\tfrac{1}{2},\\tfrac{1}{2})$ 与其四个顶点 $(0,0)$、$(1,0)$、$(1,1)$ 和 $(0,1)$ 连接，得到协调三角剖分，从而生成四个三角形。\n- **近似空间**：$\\boldsymbol{V}_{h}=[V_{h}]^{2}$，其中 $V_{h}=\\{v_{h}\\in C^{0}(\\overline{\\Omega})\\mid v_{h}|_{T}\\in \\mathbb{P}_{1}(T)\\ \\forall T\\}\\cap H^{1}_{0}(\\Omega)$。这是满足均匀边界条件的连续分片线性向量函数空间。\n- **节点自由度**：在四个边界顶点上施加均匀狄利克雷条件。唯一的非零节点位移位于内部节点 $(\\tfrac{1}{2},\\tfrac{1}{2})$。\n- **目标**：确定离散无散子空间 $\\boldsymbol{Z}_{h}=\\{\\boldsymbol{u}_{h}\\in \\boldsymbol{V}_{h}\\mid (\\nabla\\cdot \\boldsymbol{u}_{h})|_{T}=0\\ \\text{for each triangle }T\\}$ 的维数。\n\n### 第 2 步：使用提取的已知信息进行验证\n这是一个关于近不可压缩弹性有限元分析的标准教科书练习。\n- **科学依据**：该问题基于成熟的线性弹性理论和有限元方法（特别是伽辽金法）。在不可压缩极限下，低阶单元的“锁定”现象是计算力学中的一个经典课题。所有原理都是合理的。\n- **适定性**：问题陈述清晰，要求计算一个特定的、可计算的量（一个向量子空间的维数）。存在唯一解。\n- **客观性**：语言精确且数学化。没有主观或基于意见的陈述。\n- **完整性和一致性**：提供了所有必要的信息。区域、网格、边界条件和有限元空间都已完全指定。没有矛盾之处。\n- **现实性和可行性**：该设置是一个为教学目的而简化的标准模型。完全可以进行分析。\n- **结构合理**：问题直接且明确。它要求解一个定义明确的子空间的维数。\n\n问题有效。\n\n### 第 3 步：结论与行动\n问题有效。我将继续进行解答。\n\n问题要求解离散无散子空间 $\\boldsymbol{Z}_{h}$ 的维数。该子空间由离散有限元空间 $\\boldsymbol{V}_{h}$ 中所有在网格的每个单元上散度为零的向量场 $\\boldsymbol{u}_{h}$ 组成。\n\n区域 $\\Omega = [0,1]\\times[0,1]$ 通过连接顶点 $N_1=(0,0)$、$N_2=(1,0)$、$N_3=(1,1)$、$N_4=(0,1)$ 到中心点 $N_5=(\\frac{1}{2},\\frac{1}{2})$ 被划分为四个三角形网格。这四个三角形是：\n- $T_1$：顶点为 $N_1$、$N_2$、$N_5$。\n- $T_2$：顶点为 $N_2$、$N_3$、$N_5$。\n- $T_3$：顶点为 $N_3$、$N_4$、$N_5$。\n- $T_4$：顶点为 $N_4$、$N_1$、$N_5$。\n\n有限元空间 $\\boldsymbol{V}_{h}$ 由连续的分片线性向量函数组成。均匀狄利克雷边界条件 $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\partial\\Omega$ 意味着边界节点 $N_1, N_2, N_3, N_4$ 处的节点位移均为零：\n$$\n\\boldsymbol{u}(N_1) = \\boldsymbol{u}(N_2) = \\boldsymbol{u}(N_3) = \\boldsymbol{u}(N_4) = \\boldsymbol{0}.\n$$\n唯一的非零自由度是内部节点 $N_5$ 处位移向量的两个分量。设 $\\boldsymbol{u}_5 = (u_{x,5}, u_{y,5})$ 表示此节点位移向量。\n\n任何函数 $\\boldsymbol{u}_h \\in \\boldsymbol{V}_h$ 都可以用基函数表示。设 $\\phi_i(x,y)$ 是与节点 $N_i$ 相关联的标准分片线性（P1）基函数，定义为 $\\phi_i(N_j) = \\delta_{ij}$。给定边界条件，位移场 $\\boldsymbol{u}_h(x,y)$ 由下式给出：\n$$\n\\boldsymbol{u}_h(x,y) = \\boldsymbol{u}_5 \\phi_5(x,y) = (u_{x,5}\\phi_5(x,y), u_{y,5}\\phi_5(x,y)).\n$$\n空间 $\\boldsymbol{V}_h$ 的维数是自由度的数量，即 2。\n\n我们正在寻找子空间 $\\boldsymbol{Z}_h \\subset \\boldsymbol{V}_h$，使得对于任何 $\\boldsymbol{u}_h \\in \\boldsymbol{Z}_h$，条件 $(\\nabla\\cdot \\boldsymbol{u}_{h})|_{T_k}=0$ 对每个三角形 $T_k$（$k=1,2,3,4$）都成立。\n\n$\\boldsymbol{u}_h$ 的散度为：\n$$\n\\nabla\\cdot\\boldsymbol{u}_h = \\frac{\\partial}{\\partial x}(u_{x,5}\\phi_5) + \\frac{\\partial}{\\partial y}(u_{y,5}\\phi_5) = u_{x,5}\\frac{\\partial\\phi_5}{\\partial x} + u_{y,5}\\frac{\\partial\\phi_5}{\\partial y}.\n$$\n由于 $\\phi_5$ 是一个分片线性函数，它的梯度 $\\nabla\\phi_5 = (\\frac{\\partial\\phi_5}{\\partial x}, \\frac{\\partial\\phi_5}{\\partial y})$ 在每个三角形 $T_k$ 上是常数。让我们计算它在四个三角形上各自的梯度。\n\n在任何三角形上，一个线性函数 $f(x,y) = ax+by+c$ 的梯度 $(a,b)$ 是一个常数。系数可以通过函数在三个顶点处的值求得。基函数 $\\phi_5$ 在 $N_5=(\\frac{1}{2},\\frac{1}{2})$ 处为 1，在所有其他节点处为 0。\n\n1.  **三角形 $T_1$**：顶点为 $N_1(0,0)$、$N_2(1,0)$ 和 $N_5(\\frac{1}{2},\\frac{1}{2})$。\n    在 $T_1$ 上的函数 $\\phi_5(x,y)$ 由 $\\phi_5(0,0)=0$、$\\phi_5(1,0)=0$ 和 $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1$ 定义。\n    设 $\\phi_5(x,y)|_{T_1} = a_1 x + b_1 y + c_1$。\n    $\\phi_5(0,0)=0 \\implies c_1=0$。\n    $\\phi_5(1,0)=0 \\implies a_1(1)+b_1(0)+c_1=0 \\implies a_1=0$。\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies a_1(\\frac{1}{2})+b_1(\\frac{1}{2})+c_1=1 \\implies \\frac{1}{2}b_1 = 1 \\implies b_1=2$。\n    所以，在 $T_1$ 上，$\\nabla\\phi_5 = (0, 2)$。\n\n2.  **三角形 $T_2$**：顶点为 $N_2(1,0)$、$N_3(1,1)$ 和 $N_5(\\frac{1}{2},\\frac{1}{2})$。\n    设 $\\phi_5(x,y)|_{T_2} = a_2 x + b_2 y + c_2$。\n    $\\phi_5(1,0)=0 \\implies a_2+c_2=0$。\n    $\\phi_5(1,1)=0 \\implies a_2+b_2+c_2=0 \\implies b_2=0$。\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_2+\\frac{1}{2}b_2+c_2=1 \\implies \\frac{1}{2}a_2-a_2=1 \\implies -\\frac{1}{2}a_2 = 1 \\implies a_2=-2$。\n    所以，在 $T_2$ 上，$\\nabla\\phi_5 = (-2, 0)$。\n\n3.  **三角形 $T_3$**：顶点为 $N_3(1,1)$、$N_4(0,1)$ 和 $N_5(\\frac{1}{2},\\frac{1}{2})$。\n    通过与 $T_1$ 的对称性（关于 $y=x$ 反射），可以推断出梯度。更正式地，设 $\\phi_5(x,y)|_{T_3} = a_3 x + b_3 y + c_3$。\n    $\\phi_5(0,1)=0 \\implies b_3+c_3=0$。\n    $\\phi_5(1,1)=0 \\implies a_3+b_3+c_3=0 \\implies a_3=0$。\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_3+\\frac{1}{2}b_3+c_3=1 \\implies \\frac{1}{2}b_3-b_3=1 \\implies -\\frac{1}{2}b_3 = 1 \\implies b_3=-2$。\n    所以，在 $T_3$ 上，$\\nabla\\phi_5 = (0, -2)$。\n\n4.  **三角形 $T_4$**：顶点为 $N_4(0,1)$、$N_1(0,0)$ 和 $N_5(\\frac{1}{2},\\frac{1}{2})$。\n    通过与 $T_2$ 的对称性（关于 $y=x$ 反射），可以推断出梯度。正式地，设 $\\phi_5(x,y)|_{T_4} = a_4 x + b_4 y + c_4$。\n    $\\phi_5(0,0)=0 \\implies c_4=0$。\n    $\\phi_5(0,1)=0 \\implies b_4+c_4=0 \\implies b_4=0$。\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_4+\\frac{1}{2}b_4+c_4=1 \\implies \\frac{1}{2}a_4=1 \\implies a_4=2$。\n    所以，在 $T_4$ 上，$\\nabla\\phi_5 = (2, 0)$。\n\n现在我们对每个三角形应用约束 $(\\nabla\\cdot \\boldsymbol{u}_{h})|_{T_k}=0$，使用表达式 $\\nabla\\cdot\\boldsymbol{u}_h = u_{x,5}\\frac{\\partial\\phi_5}{\\partial x} + u_{y,5}\\frac{\\partial\\phi_5}{\\partial y}$：\n\n- 在 $T_1$ 上：$u_{x,5}(0) + u_{y,5}(2) = 2u_{y,5} = 0$。\n- 在 $T_2$ 上：$u_{x,5}(-2) + u_{y,5}(0) = -2u_{x,5} = 0$。\n- 在 $T_3$ 上：$u_{x,5}(0) + u_{y,5}(-2) = -2u_{y,5} = 0$。\n- 在 $T_4$ 上：$u_{x,5}(2) + u_{y,5}(0) = 2u_{x,5} = 0$。\n\n为了使 $\\boldsymbol{u}_h$ 属于 $\\boldsymbol{Z}_h$，这个关于两个未知数 $u_{x,5}$ 和 $u_{y,5}$ 的四个线性方程组必须得到满足。\n第一个方程给出 $u_{y,5}=0$。第二个方程给出 $u_{x,5}=0$。\n其余两个方程与此解一致。\n该方程组的唯一解是 $(u_{x,5}, u_{y,5}) = (0,0)$。\n\n这意味着满足逐单元零散度约束的唯一位移场 $\\boldsymbol{u}_h \\in \\boldsymbol{V}_h$ 是零场，即 $\\boldsymbol{u}_h(x,y) = \\boldsymbol{0}$。\n因此，子空间 $\\boldsymbol{Z}_h$ 只包含零向量：\n$$\n\\boldsymbol{Z}_h = \\{\\boldsymbol{0}\\}.\n$$\n一个只包含零向量的向量空间的维数是 $0$。\n这个结果是体积锁定的一个例子，即对于这种特定的网格和低阶 P1 单元，不可压缩性约束是如此严格，以至于它消除了所有非平凡解。", "answer": "$$\n\\boxed{0}\n$$", "id": "3571246"}]}