{"hands_on_practices": [{"introduction": "主应力不变量在建立本构理论（如屈服准则）时非常方便，但我们进行物理状态解释或破坏分析时，往往需要主应力本身。本练习旨在揭示它们之间的基本代数关系，要求你通过求解特征方程，从一组给定的不变量反向推导出主应力。这项实践强化了抽象不变量表示与物理应力状态之间的直接联系。[@problem_id:3565204]", "problem": "岩土材料中的一个均质点被建模为在准静态加载下无体力矩的柯西连续介质。根据力矩平衡，该点的柯西应力张量是对称的。设柯西应力张量的主不变量定义为 $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$，$I_2 = \\tfrac{1}{2}\\!\\left[(\\operatorname{tr}\\boldsymbol{\\sigma})^2 - \\operatorname{tr}(\\boldsymbol{\\sigma}^2)\\right]$ 和 $I_3 = \\det(\\boldsymbol{\\sigma})$。在一个特定的材料点，测量和模型简化得到的不变量值为 $I_1 = 12$ 兆帕（MPa），$I_2 = 5$ MPa²，和 $I_3 = -150$ MPa³。\n\n仅从 (i) 意味着柯西应力张量对称的力矩平衡条件和 (ii) 上述主不变量的定义出发，通过求解相应的代数关系来重建三个主应力 $\\{\\sigma_i\\}$。然后，仅使用多项式系数和根之间经过充分检验的关系，确定表征存在重复主应力值（即重复的特征值）时 $I_1$、$I_2$ 和 $I_3$ 应满足的代数条件，并评估给定的不变量组是否满足该条件。\n\n将您的最终主应力表示为一个按升序排列的单行矩阵，并以兆帕 (MPa) 为单位表示每个条目。无需四舍五入；请给出精确值。", "solution": "该问题要求根据给定的柯西应力张量的主不变量来重建主应力，并评估是否存在重复的主应力。在无体力矩的假设下，由于力矩平衡，柯西应力张量 $\\boldsymbol{\\sigma}$ 是对称的。主应力（此处用 $\\sigma$ 表示）是 $\\boldsymbol{\\sigma}$ 的特征值。作为特征值，它们是张量特征方程的根：\n$$ \\det(\\boldsymbol{\\sigma} - \\sigma \\mathbf{I}) = 0 $$\n其中 $\\mathbf{I}$ 是单位张量。该方程可以展开为关于应力张量主不变量的三次多项式：\n$$ \\sigma^3 - I_1 \\sigma^2 + I_2 \\sigma - I_3 = 0 $$\n问题给出了不变量的值：\n$I_1 = 12 \\text{ MPa}$\n$I_2 = 5 \\text{ MPa}^2$\n$I_3 = -150 \\text{ MPa}^3$\n\n首先，我们通过求解特征方程来重建主应力。代入给定值（为使计算清晰，省略单位，但需知晓最终应力单位为 MPa）：\n$$ \\sigma^3 - (12)\\sigma^2 + (5)\\sigma - (-150) = 0 $$\n$$ \\sigma^3 - 12\\sigma^2 + 5\\sigma + 150 = 0 $$\n为了解这个三次方程，我们可以使用有理根定理来检验整数根。可能的有理根是常数项 $150$ 的整数约数。让我们测试多项式 $P(\\sigma) = \\sigma^3 - 12\\sigma^2 + 5\\sigma + 150$ 的几个值：\n测试 $\\sigma = -3$：\n$$ P(-3) = (-3)^3 - 12(-3)^2 + 5(-3) + 150 $$\n$$ P(-3) = -27 - 12(9) - 15 + 150 $$\n$$ P(-3) = -27 - 108 - 15 + 150 $$\n$$ P(-3) = -150 + 150 = 0 $$\n由于 $P(-3) = 0$，$\\sigma_1 = -3$ 是方程的一个根，因此是主应力之一。这意味着 $(\\sigma+3)$ 是多项式的一个因式。我们可以进行多项式除法来找到剩余的二次因式。\n$$ \\frac{\\sigma^3 - 12\\sigma^2 + 5\\sigma + 150}{\\sigma + 3} = \\sigma^2 - 15\\sigma + 50 $$\n所以，特征方程可以因式分解为：\n$$ (\\sigma + 3)(\\sigma^2 - 15\\sigma + 50) = 0 $$\n现在我们求解二次方程 $\\sigma^2 - 15\\sigma + 50 = 0$ 来找到另外两个主应力。这个二次方程可以通过观察来因式分解：\n$$ (\\sigma - 5)(\\sigma - 10) = 0 $$\n根是 $\\sigma = 5$ 和 $\\sigma = 10$。\n因此，三个主应力是 $\\sigma_1 = -3$ MPa，$\\sigma_2 = 5$ MPa 和 $\\sigma_3 = 10$ MPa。问题要求将这些值按升序排列成一个行矩阵：$\\{-3, 5, 10\\}$。\n\n接下来，我们必须确定存在重复主应力值的代数条件。这对应于特征多项式有重根。一个多项式有重根当且仅当其判别式 $\\Delta$ 等于零。对于三次方程 $\\sigma^3 - I_1\\sigma^2 + I_2\\sigma - I_3 = 0$，其判别式由系数推导出的标准公式给出：\n$$ \\Delta = I_1^2 I_2^2 - 4I_1^3 I_3 - 4I_2^3 - 27I_3^2 + 18I_1 I_2 I_3 $$\n因此，存在重复主应力值的代数条件是：\n$$ I_1^2 I_2^2 - 4I_1^3 I_3 - 4I_2^3 - 27I_3^2 + 18I_1 I_2 I_3 = 0 $$\n由于柯西应力张量是对称的，其特征值（主应力）必须全部为实数。三个实根的条件是 $\\Delta \\ge 0$。如果 $\\Delta = 0$，则有三个实根，其中至少有一个是重根。如果 $\\Delta > 0$，则有三个不同的实根。如果 $\\Delta < 0$，则有一个实根和一对共轭复根，这对于主应力来说在物理上是不可能的。\n\n最后，我们评估给定的不变量组是否满足此条件。我们将 $I_1 = 12$，$I_2 = 5$ 和 $I_3 = -150$ 代入判别式 $\\Delta$ 的表达式中：\n$$ I_1^2 I_2^2 = (12)^2 (5)^2 = 144 \\times 25 = 3600 $$\n$$ -4I_1^3 I_3 = -4(1728)^3 (-150) = 4(1728)(150) = 1036800 $$\n$$ -4I_2^3 = -4(5)^3 = -4(125) = -500 $$\n$$ -27I_3^2 = -27(-150)^2 = -27(22500) = -607500 $$\n$$ 18I_1 I_2 I_3 = 18(12)(5)(-150) = 1080(-150) = -162000 $$\n将这些项相加得到 $\\Delta$：\n$$ \\Delta = 3600 + 1036800 - 500 - 607500 - 162000 $$\n$$ \\Delta = (3600 - 500) + (1036800 - 607500 - 162000) $$\n$$ \\Delta = 3100 + (1036800 - 769500) $$\n$$ \\Delta = 3100 + 267300 = 270400 $$\n由于 $\\Delta = 270400 \\neq 0$，存在重复主应力值的条件不满足。$\\Delta > 0$ 这一事实证实了存在三个不同的实主应力，这与我们通过直接解三次方程得到的根 $\\{-3, 5, 10\\}$ 是一致的。", "answer": "$$\\boxed{\\begin{pmatrix} -3  5  10 \\end{pmatrix}}$$", "id": "3565204"}, {"introduction": "“不变量”一词意味着某些量在任何坐标系下都保持不变。本练习通过一个动手计算实践来证明这一关键概念。你将编写代码对应力张量进行刚体旋转，并数值验证：尽管应力张量的各个分量发生了变化，其偏应力不变量 $J_2$ 和 $J_3$ 却保持不变。这项实践对于理解为何材料模型常用不变量来表示至关重要——确保材料响应与观察者选择的坐标系无关。[@problem_id:3565176]", "problem": "已知对于无体力矩偶的静态连续体，角动量守恒意味着柯西应力张量是对称的。在计算岩土力学中，考虑一个在重力作用下处于静态平衡且无体力矩偶的颗粒柱。对于一个材料点上被建模为对称二阶张量 $\\sigma$ 的任意应力状态，定义偏应力 $s$ 为 $$s=\\sigma-\\tfrac{1}{3}I_1\\,\\mathbf{I},$$ 其中 $I_1=\\mathrm{tr}(\\sigma)$ 且 $\\mathbf{I}$ 是单位张量。$s$ 的第二和第三主不变量定义为 $$J_2=\\tfrac{1}{2}s:s=\\tfrac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3}s_{ij}s_{ij},\\qquad J_3=\\det(s)。$$ 在由正常正交张量 $R$（即 $RR^{\\mathsf{T}}=\\mathbf{I}$ 且 $\\det(R)=+1$）表示的刚性旋转下，应力变换如下 $$\\sigma' = R\\,\\sigma\\,R^{\\mathsf{T}}.$$ 目标是从第一性原理出发，数值验证：\n- $\\sigma$ 的对称性在刚性旋转下保持不变（角动量守恒的数值体现），以及\n- 偏应力不变量 $J_2$ 和 $J_3$ 在刚性旋转下不变。\n\n你的任务是编写一个完整的程序，对于每个指定的测试用例，使用罗德里格斯公式从一个轴-角对构建旋转矩阵 $R$，将其应用于给定的对称柯西应力张量 $\\sigma$，形成旋转前后的偏应力 $s$ 和 $s'$，计算两者的 $J_2$ 和 $J_3$，并使用指定的数值容差 $\\varepsilon$ 检查以下内容：\n- 应力对称性保持：$\\sigma'$ 的反对称部分的弗罗贝尼乌斯范数小于或等于 $\\varepsilon$，\n- $J_2$ 不变性：$\\lvert J_2' - J_2\\rvert \\le \\varepsilon$，\n- $J_3$ 不变性：$\\lvert J_3' - J_3\\rvert \\le \\varepsilon$。\n\n仅使用以下基础：连续体的线动量和角动量守恒、刚性旋转下柯西应力的张量变换法则、偏应力的定义以及主不变量 $J_2$ 和 $J_3$ 的定义。角度应解释为弧度。容差为 $\\varepsilon=10^{-10}$。\n\n通过罗德里格斯公式从单位旋转轴 $\\boldsymbol{a}=[a_x,a_y,a_z]^{\\mathsf{T}}$ 和旋转角 $\\theta$ 实现旋转矩阵 $R$：\n$$\nR=\\mathbf{I}+\\sin(\\theta)[\\boldsymbol{a}]_\\times+\\left(1-\\cos(\\theta)\\right)[\\boldsymbol{a}]_\\times^2,\\quad\n[\\boldsymbol{a}]_\\times=\\begin{bmatrix}\n0  -a_z  a_y\\\\\na_z  0  -a_x\\\\\n-a_y  a_x  0\n\\end{bmatrix}.\n$$\n在构建 $R$ 之前，确保 $\\boldsymbol{a}$ 已被归一化。\n\n测试套件（每个用例是一个三元组 $(\\sigma,\\boldsymbol{a},\\theta)$）：\n- 用例 $1$（一般各向异性、非共轴应力）：\n  $$\n  \\sigma=\\begin{bmatrix}\n  120.0  15.0  0.0\\\\\n  15.0  80.0  -5.0\\\\\n  0.0  -5.0  200.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\tfrac{1}{\\sqrt{3}}\\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix},\\quad\n  \\theta=\\tfrac{\\pi}{3}.\n  $$\n- 用例 $2$（静水压力，偏应力为零的边界情况）：\n  $$\n  \\sigma=\\begin{bmatrix}\n  100.0  0.0  0.0\\\\\n  0.0  100.0  0.0\\\\\n  0.0  0.0  100.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}0.0\\\\0.0\\\\1.0\\end{bmatrix},\\quad\n  \\theta=\\tfrac{\\pi}{2}.\n  $$\n- 用例 $3$（纯偏应力，迹为零）：\n  $$\n  \\sigma=\\begin{bmatrix}\n  30.0  20.0  10.0\\\\\n  20.0  10.0  -5.0\\\\\n  10.0  -5.0  -40.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}1.0\\\\0.0\\\\0.0\\end{bmatrix},\\quad\n  \\theta=\\pi.\n  $$\n- 用例 $4$（零旋转，边界情况）：\n  $$\n  \\sigma=\\begin{bmatrix}\n  50.0  0.0  0.0\\\\\n  0.0  40.0  0.0\\\\\n  0.0  0.0  30.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}0.0\\\\1.0\\\\0.0\\end{bmatrix},\\quad\n  \\theta=0.0.\n  $$\n\n对于每个测试用例，你的程序必须：\n- 从 $(\\boldsymbol{a},\\theta)$ 计算 $R$，\n- 计算 $\\sigma' = R\\,\\sigma\\,R^{\\mathsf{T}}$，\n- 通过将 $(\\sigma'-\\sigma'^{\\mathsf{T}})/2$ 的弗罗贝尼乌斯范数与 $\\varepsilon$ 进行比较来验证 $\\sigma'$ 的对称性，\n- 计算 $s$ 和 $s'$，\n- 计算 $J_2$、$J_2'$、$J_3$ 和 $J_3'$，\n- 每个用例返回三个布尔值，依次表示：对称性保持、$J_2$ 不变、$J_3$ 不变。\n\n最终输出格式：你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。按顺序连接所有用例的布尔值，使输出长度为 12，其中的条目隐式地按每个用例三元组分组，例如：$$[\\text{用例 }1\\ \\text{对称性},\\ \\text{用例 }1\\ J_2,\\ \\text{用例 }1\\ J_3,\\ \\dots,\\ \\text{用例 }4\\ \\text{对称性},\\ \\text{用例 }4\\ J_2,\\ \\text{用例 }4\\ J_3].$$ 角度必须以弧度为单位解释。输出中不需要物理单位，因为输出是布尔值。", "solution": "该问题要求在连续介质力学框架内，对柯西应力张量 $\\sigma$ 的两个基本性质进行数值验证。这些性质是：\n$1$. 在刚体旋转下，$\\sigma$ 的对称性保持不变。\n$2$. 在相同旋转下，偏应力张量 $s$ 的第二和第三主不变量 $J_2$ 和 $J_3$ 的不变性。\n\n该验证将针对一组指定的测试用例进行，每个用例由一个初始对称应力张量 $\\sigma$、一个旋转轴 $\\boldsymbol{a}$ 和一个旋转角 $\\theta$ 定义。解决方案的步骤是，从第一性原理出发实现指定的计算，并将结果与给定的数值容差 $\\varepsilon = 10^{-10}$ 进行核对。\n\n理论基础如下：\n- 柯西应力张量 $\\sigma$ 是一个描述材料点应力状态的二阶张量。在没有体力矩偶的情况下，角动量守恒要求 $\\sigma$ 是对称的，即 $\\sigma = \\sigma^{\\mathsf{T}}$。\n- 在由正常正交张量 $R$（其中 $RR^{\\mathsf{T}}=\\mathbf{I}$ 且 $\\det(R)=1$）描述的刚体旋转下，二阶张量按 $\\sigma' = R\\sigma R^{\\mathsf{T}}$ 变换。可以解析地证明，如果 $\\sigma$ 是对称的，那么 $\\sigma'$ 也是对称的：$(\\sigma')^{\\mathsf{T}} = (R\\sigma R^{\\mathsf{T}})^{\\mathsf{T}} = (R^{\\mathsf{T}})^{\\mathsf{T}}\\sigma^{\\mathsf{T}}R^{\\mathsf{T}} = R\\sigma R^{\\mathsf{T}} = \\sigma'$。\n- 偏应力张量 $s$ 定义为移除了静水压力分量的应力张量：$s = \\sigma - p\\mathbf{I}$，其中 $p = \\frac{1}{3}\\mathrm{tr}(\\sigma)$ 是平均应力。使用应力的第一主不变量 $I_1 = \\mathrm{tr}(\\sigma)$，这可以写成 $s = \\sigma - \\frac{1}{3}I_1\\mathbf{I}$。\n- 张量的主不变量是与坐标系无关的标量。对于偏应力张量 $s$，其第二和第三不变量 $J_2$ 和 $J_3$ 定义为 $J_2 = \\frac{1}{2}s:s = \\frac{1}{2}\\mathrm{tr}(s^2)$ 和 $J_3 = \\det(s)$。它们的不变性意味着，如果 $\\sigma$ 变换为 $\\sigma'$，则相应的偏应力张量 $s$ 变换为 $s'$，但从 $s$ 和 $s'$ 计算出的不变量保持不变，即 $J_2' = J_2$ 和 $J_3' = J_3$。\n\n每个测试用例 $(\\sigma, \\boldsymbol{a}, \\theta)$ 的数值步骤如下：\n\n**1. 构建旋转矩阵 $R$**\n旋转矩阵 $R$ 是根据旋转轴 $\\boldsymbol{a}$ 和角度 $\\theta$ 使用罗德里格斯公式构建的。首先，轴向量 $\\boldsymbol{a}$ 必须是单位向量 $\\hat{\\boldsymbol{a}}$。我们将其归一化：$\\hat{\\boldsymbol{a}} = \\boldsymbol{a} / ||\\boldsymbol{a}||$。然后，我们构造反对称矩阵 $[\\hat{\\boldsymbol{a}}]_\\times$：\n$$\n[\\hat{\\boldsymbol{a}}]_\\times = \\begin{bmatrix} 0  -\\hat{a}_z  \\hat{a}_y \\\\ \\hat{a}_z  0  -\\hat{a}_x \\\\ -\\hat{a}_y  \\hat{a}_x  0 \\end{bmatrix}\n$$\n然后旋转矩阵 $R$ 被组装为：\n$$\nR = \\mathbf{I} + \\sin(\\theta)[\\hat{\\boldsymbol{a}}]_\\times + (1-\\cos(\\theta))[\\hat{\\boldsymbol{a}}]_\\times^2\n$$\n此处，$\\mathbf{I}$ 是 $3 \\times 3$ 的单位矩阵。\n\n**2. 变换应力张量**\n初始应力张量 $\\sigma$ 使用标准张量变换法则变换到新坐标系中：\n$$\n\\sigma' = R\\sigma R^{\\mathsf{T}}\n$$\n其中 $R^{\\mathsf{T}}$ 是 $R$ 的转置。\n\n**3. 验证对称性保持**\n为了数值验证变换后的张量 $\\sigma'$ 保持对称，我们计算其反对称部分 $\\sigma'_{\\text{skew}}$：\n$$\n\\sigma'_{\\text{skew}} = \\frac{1}{2}(\\sigma' - (\\sigma')^{\\mathsf{T}})\n$$\n一个完全对称的张量其反对称部分应为零。由于浮点运算，结果可能是一个非常小的非零矩阵。我们使用弗罗贝尼乌斯范数 $||\\cdot||_F$ 来量化其大小，并检查它是否在指定的容差 $\\varepsilon$ 范围内：\n$$\n||\\sigma'_{\\text{skew}}||_F = \\sqrt{\\sum_{i=1}^{3}\\sum_{j=1}^{3} (\\sigma'_{\\text{skew}})_{ij}^2} \\le \\varepsilon\n$$\n该测试用例的第一个布尔值结果就是这次比较的结果。\n\n**4. 计算偏应力**\n我们计算与 $\\sigma$ 和 $\\sigma'$ 相对应的偏应力张量 $s$ 和 $s'$。\n- 首先，计算迹：$I_1 = \\mathrm{tr}(\\sigma)$ 和 $I'_1 = \\mathrm{tr}(\\sigma')$。\n- 然后，构造偏应力张量：\n$$\ns = \\sigma - \\frac{1}{3}I_1\\mathbf{I}\n$$\n$$\ns' = \\sigma' - \\frac{1}{3}I'_1\\mathbf{I}\n$$\n\n**5. 验证 $J_2$ 和 $J_3$ 的不变性**\n最后，我们计算两个偏应力张量的不变量，并检查它们的值是否保持不变。\n- **$J_2$ 不变性：** 第二偏应力不变量 $J_2$ 计算为张量分量平方和的一半：\n$$\nJ_2 = \\frac{1}{2}\\sum_{i,j} s_{ij}^2 \\qquad \\text{和} \\qquad J'_2 = \\frac{1}{2}\\sum_{i,j} (s'_{ij})^2\n$$\n通过将其绝对差与容差进行比较来检查不变性：\n$$\n|J'_2 - J_2| \\le \\varepsilon\n$$\n第二个布尔值结果是这次检查的结果。\n- **$J_3$ 不变性：** 第三偏应力不变量 $J_3$ 是偏应力张量的行列式：\n$$\nJ_3 = \\det(s) \\qquad \\text{和} \\qquad J'_3 = \\det(s')\n$$\n不变性以类似方式验证：\n$$\n|J'_3 - J_3| \\le \\varepsilon\n$$\n第三个布尔值结果由这次比较确定。\n\n将此完整过程应用于提供的四个测试用例中的每一个，共生成 12 个布尔值，然后将其格式化为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem by numerically validating\n    stress symmetry preservation and deviatoric invariant properties under\n    rigid rotations for a given set of test cases.\n    \"\"\"\n\n    # Define the tolerance for numerical comparisons.\n    epsilon = 1e-10\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, a, theta)\n    test_cases = [\n        (\n            np.array([[120.0, 15.0, 0.0],\n                      [15.0, 80.0, -5.0],\n                      [0.0, -5.0, 200.0]]),\n            np.array([1.0, 1.0, 1.0]) / np.sqrt(3),\n            np.pi / 3\n        ),\n        (\n            np.array([[100.0, 0.0, 0.0],\n                      [0.0, 100.0, 0.0],\n                      [0.0, 0.0, 100.0]]),\n            np.array([0.0, 0.0, 1.0]),\n            np.pi / 2\n        ),\n        (\n            np.array([[30.0, 20.0, 10.0],\n                      [20.0, 10.0, -5.0],\n                      [10.0, -5.0, -40.0]]),\n            np.array([1.0, 0.0, 0.0]),\n            np.pi\n        ),\n        (\n            np.array([[50.0, 0.0, 0.0],\n                      [0.0, 40.0, 0.0],\n                      [0.0, 0.0, 30.0]]),\n            np.array([0.0, 1.0, 0.0]),\n            0.0\n        ),\n    ]\n\n    results = []\n    for sigma, a, theta in test_cases:\n        # Step 1: Construct the Rotation Matrix R using Rodrigues' formula.\n        # Ensure the rotation axis 'a' is a unit vector.\n        norm_a = np.linalg.norm(a)\n        if norm_a > 0:\n            a_hat = a / norm_a\n        else:\n            # A zero vector axis is only meaningful for theta=0, where R is Identity.\n            # a_hat becomes [0,0,0], which correctly yields R=I in Rodrigues' formula.\n            a_hat = a\n\n        # Construct the skew-symmetric matrix [a_hat]_x\n        ax, ay, az = a_hat\n        a_cross = np.array([[0, -az, ay],\n                            [az, 0, -ax],\n                            [-ay, ax, 0]])\n        \n        # Identity matrix\n        I = np.identity(3)\n        \n        # Rodrigues' formula\n        R = I + np.sin(theta) * a_cross + (1 - np.cos(theta)) * (a_cross @ a_cross)\n\n        # Step 2: Transform the stress tensor\n        sigma_prime = R @ sigma @ R.T\n\n        # Step 3: Verify symmetry preservation of sigma_prime\n        skew_sigma_prime = 0.5 * (sigma_prime - sigma_prime.T)\n        norm_skew = np.linalg.norm(skew_sigma_prime, 'fro')\n        symmetry_preserved = norm_skew = epsilon\n        \n        # Step 4: Compute deviatoric stresses s and s'\n        I1 = np.trace(sigma)\n        s = sigma - (I1 / 3) * I\n        \n        I1_prime = np.trace(sigma_prime)\n        s_prime = sigma_prime - (I1_prime / 3) * I\n        \n        # Step 5: Verify invariance of J2 and J3\n        \n        # Calculate J2 and J2_prime\n        # J2 = 1/2 * s:s = 1/2 * sum(s_ij * s_ij)\n        J2 = 0.5 * np.sum(s * s)\n        J2_prime = 0.5 * np.sum(s_prime * s_prime)\n        \n        # Check J2 invariance\n        j2_invariant = np.abs(J2_prime - J2) = epsilon\n        \n        # Calculate J3 and J3_prime\n        # J3 = det(s)\n        J3 = np.linalg.det(s)\n        J3_prime = np.linalg.det(s_prime)\n        \n        # Check J3 invariance\n        j3_invariant = np.abs(J3_prime - J3) = epsilon\n\n        # Append the three boolean results for the current case\n        results.extend([symmetry_preserved, j2_invariant, j3_invariant])\n\n    # Final print statement in the exact required format.\n    # The map(str,...) converts Python booleans (True/False) to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3565176"}, {"introduction": "在实际的计算力学中，数值误差可能会给计算出的张量带来一些非物理特性，例如应力张量失去对称性。本练习将指导你构建一个稳健的应力分析程序，该程序首先强制施加物理对称性（以满足力矩平衡），然后执行谱分解以找到主应力。通过比较直接从张量分量计算的不变量与从所得特征值计算的不变量，你将学到一种验证数值工具自洽性和准确性的关键技术。[@problem_id:3565171]", "problem": "您的任务是设计并实现一个稳健的计算程序，用于对计算地质力学中使用的柯西应力张量进行谱分解。该程序必须在进行特征分析之前，强制满足柯西应力张量对称性的基本物理要求，验证力矩平衡的一致性，并针对复杂滑坡几何结构中出现的代表性应力状态，比较主不变量一致性与直接张量分量计算的结果。\n\n从以下基本原理开始：\n- 在没有体力偶的连续介质中，角动量守恒意味着柯西应力张量是对称的，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathsf{T}}$。\n- 对于实对称矩阵，谱定理保证了存在一个由特征向量构成的标准正交基。因此，存在一个正交矩阵 $\\boldsymbol{Q}$ 和一个对角矩阵 $\\boldsymbol{\\Lambda} = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$，使得 $\\boldsymbol{\\sigma} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}}$，其中 $\\lambda_i$ 是主应力。\n- $\\boldsymbol{\\sigma}$ 的主不变量定义为\n$$\nI_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}), \\quad\nI_2 = \\tfrac{1}{2}\\left[\\left(\\operatorname{tr}\\boldsymbol{\\sigma}\\right)^2 - \\operatorname{tr}\\left(\\boldsymbol{\\sigma}^2\\right)\\right], \\quad\nI_3 = \\det(\\boldsymbol{\\sigma}).\n$$\n- 偏应力为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{I_1}{3}\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量。其不变量为\n$$\nJ_2 = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}, \\quad\nJ_3 = \\det(\\boldsymbol{s}),\n$$\n并且由于 $\\boldsymbol{s}$ 与 $\\boldsymbol{\\sigma}$ 共享相同的特征向量，如果 $\\lambda_i$ 是主应力，则主偏应力为 $\\lambda_i' = \\lambda_i - \\tfrac{I_1}{3}$，且\n$$\nI_1 = \\lambda_1 + \\lambda_2 + \\lambda_3, \\quad\nI_2 = \\lambda_1\\lambda_2 + \\lambda_2\\lambda_3 + \\lambda_3\\lambda_1, \\quad\nI_3 = \\lambda_1\\lambda_2\\lambda_3,\n$$\n$$\nJ_2 = \\tfrac{1}{2}\\sum_{i=1}^3 (\\lambda_i')^2, \\quad\nJ_3 = \\lambda_1' \\lambda_2' \\lambda_3'.\n$$\n\n实现一个程序，该程序：\n1. 输入一个由 $3 \\times 3$ 实数矩阵 $\\boldsymbol{\\sigma}$ 组成的列表（单位为帕斯卡），每个矩阵代表复杂滑坡几何结构中的典型应力状态。\n2. 在进行特征分析之前，使用 $\\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\tfrac{1}{2}(\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}^{\\mathsf{T}})$ 来强制对称性，以满足力矩平衡。\n3. 对 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 进行谱分解，以获得 $\\lambda_1,\\lambda_2,\\lambda_3$ 和一个由主方向构成的标准正交矩阵 $\\boldsymbol{Q}$，并重构 $\\boldsymbol{\\sigma}_{\\mathrm{rec}} = \\boldsymbol{Q}\\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\boldsymbol{Q}^{\\mathsf{T}}$。\n4. 直接从张量分量计算不变量 $I_1, I_2, I_3$ 和 $J_2, J_3$，并独立地从主应力计算这些不变量。\n5. 为每个不变量计算无量纲归一化失配度量，公式如下\n$$\nr_{I_1} = \\frac{\\left|I_1^{\\text{direct}} - I_1^{\\text{eig}}\\right|}{\\max\\left(\\left|I_1^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{I_2} = \\frac{\\left|I_2^{\\text{direct}} - I_2^{\\text{eig}}\\right|}{\\max\\left(\\left|I_2^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{I_3} = \\frac{\\left|I_3^{\\text{direct}} - I_3^{\\text{eig}}\\right|}{\\max\\left(\\left|I_3^{\\text{direct}}\\right|,\\, 1\\right)},\n$$\n$$\nr_{J_2} = \\frac{\\left|J_2^{\\text{direct}} - J_2^{\\text{eig}}\\right|}{\\max\\left(\\left|J_2^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{J_3} = \\frac{\\left|J_3^{\\text{direct}} - J_3^{\\text{eig}}\\right|}{\\max\\left(\\left|J_3^{\\text{direct}}\\right|,\\, 1\\right)}.\n$$\n6. 计算重构残差和对称化后偏斜残差，公式如下\n$$\nr_{\\mathrm{rec}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{rec}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)}, \\quad\nr_{\\mathrm{skew}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)},\n$$\n其中 $\\|\\cdot\\|_{\\mathrm{F}}$ 表示弗罗贝尼乌斯范数。\n7. 对于每个测试用例，返回一个浮点数，该数等于七个无量纲归一化失配度量中的最大值\n$$\nm = \\max\\left(r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}, r_{\\mathrm{rec}}, r_{\\mathrm{skew}}\\right).\n$$\n\n单位：所有应力分量的单位均为帕斯卡；所有失配度量均为无量纲。\n\n角度单位：不适用。\n\n测试套件：\n- 情况 1（理想情况，对称的内部边坡应力）：\n$$\n\\boldsymbol{\\sigma}^{(1)} =\n\\begin{bmatrix}\n-120\\times 10^3  30\\times 10^3  0 \\\\\n30\\times 10^3  -80\\times 10^3  5\\times 10^3 \\\\\n0  5\\times 10^3  -20\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- 情况 2（近对称，带有微小的反对称离散化噪声）：\n$$\n\\boldsymbol{\\sigma}^{(2)} = \\boldsymbol{\\sigma}^{(1)} +\n\\begin{bmatrix}\n0  200  -100 \\\\\n-200  0  50 \\\\\n100  -50  0\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- 情况 3（近静水压缩状态，带有微小剪切）：\n$$\n\\boldsymbol{\\sigma}^{(3)} =\n\\begin{bmatrix}\n-100\\times 10^3  200  0 \\\\\n200  -100\\times 10^3  0 \\\\\n0  0  -100\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- 情况 4（病态量级，具有显著的剪切耦合）：\n$$\n\\boldsymbol{\\sigma}^{(4)} =\n\\begin{bmatrix}\n-1.0\\times 10^6  4.0\\times 10^4  -3.0\\times 10^4 \\\\\n4.0\\times 10^4  -5.0\\times 10^3  2.0\\times 10^4 \\\\\n-3.0\\times 10^4  2.0\\times 10^4  2.0\\times 10^4\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- 情况 5（强偏应力，零迹，顶部/拉剪混合）：\n$$\n\\boldsymbol{\\sigma}^{(5)} =\n\\begin{bmatrix}\n50\\times 10^3  10\\times 10^3  -5\\times 10^3 \\\\\n10\\times 10^3  -30\\times 10^3  8\\times 10^3 \\\\\n-5\\times 10^3  8\\times 10^3  -20\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如 $[m^{(1)},m^{(2)},m^{(3)},m^{(4)},m^{(5)}]$），其中每个 $m^{(i)}$ 是情况 $i$ 的最大无量纲归一化失配，并采用默认浮点格式。不允许有其他输出。", "solution": "该问题陈述是计算地质力学中一个适定且科学合理的问题。它要求实现一个数值程序来分析柯西应力张量，重点是验证其谱特性和不变量的一致性。所概述的所有定义、原理和程序在连续介质力学和数值线性代数中都是标准的。提供的测试用例是现实的，用于验证实现在不同应力状态下的稳健性。因此，该问题是有效的，有必要提供完整的解决方案。\n\n解决方案将按照问题陈述中指定的操作顺序进行开发。此任务的核心是实现并验证应力张量、其不变量及其谱分解之间的数学关系。\n\n1.  强制对称性：在没有体力偶的情况下，角动量守恒的基本原理规定柯西应力张量 $\\boldsymbol{\\sigma}$ 必须是对称的，即 $\\sigma_{ij} = \\sigma_{ji}$。由于离散化误差或特定的算法选择，数值模型有时会产生轻微不对称的应力张量。为了恢复物理一致性，任何给定的张量 $\\boldsymbol{\\sigma}$ 首先要进行对称化处理。任何张量 $\\boldsymbol{\\sigma}$ 的对称部分由 $\\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\frac{1}{2}(\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}^{\\mathsf{T}})$ 给出。此操作将张量从二阶张量的一般空间 ($\\mathbb{R}^{3 \\times 3}$) 投影到对称二阶张量的子空间上。所有后续分析都必须在 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 上进行。\n\n2.  谱分解：实对称矩阵的谱定理保证了 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 可以通过正交变换进行对角化。这表示为：\n    $$ \\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}} $$\n    其中：\n    - $\\boldsymbol{\\Lambda}$ 是一个对角矩阵，包含 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 的特征值 $\\lambda_1, \\lambda_2, \\lambda_3$。这些实数值的特征值就是主应力。\n    - $\\boldsymbol{Q}$ 是一个正交矩阵（$\\boldsymbol{Q}^{\\mathsf{T}}\\boldsymbol{Q} = \\boldsymbol{Q}\\boldsymbol{Q}^{\\mathsf{T}} = \\boldsymbol{I}$），其列是相应的标准正交特征向量。这些特征向量定义了应力状态的主方向。\n    将使用数值特征求解器（例如 `numpy.linalg.eigh` 提供的求解器）来计算 $\\boldsymbol{\\Lambda}$（作为特征值向量）和 $\\boldsymbol{Q}$。\n\n3.  不变量的计算：张量的主不变量是标量，其值不依赖于表示张量所用的坐标系。它们表征了应力状态的内在属性。我们将使用两种独立的方法来计算它们，以检查数值一致性。\n\n    a.  直接从张量分量计算：使用 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 的分量：\n        - 第一不变量（迹）：$I_1^{\\text{direct}} = \\operatorname{tr}(\\boldsymbol{\\sigma}_{\\mathrm{sym}}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33}$。\n        - 第二不变量：$I_2^{\\text{direct}} = \\frac{1}{2}\\left[\\left(\\operatorname{tr}\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right)^2 - \\operatorname{tr}\\left(\\boldsymbol{\\sigma}_{\\mathrm{sym}}^2\\right)\\right]$。\n        - 第三不变量（行列式）：$I_3^{\\text{direct}} = \\det(\\boldsymbol{\\sigma}_{\\mathrm{sym}})$。\n\n        为了找到偏应力不变量，我们首先计算偏应力张量 $\\boldsymbol{s}_{\\mathrm{sym}} = \\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\frac{I_1^{\\text{direct}}}{3}\\boldsymbol{I}$。然后：\n        - 第二偏应力不变量：$J_2^{\\text{direct}} = \\frac{1}{2}\\boldsymbol{s}_{\\mathrm{sym}}:\\boldsymbol{s}_{\\mathrm{sym}} = \\frac{1}{2}\\sum_{i,j} (s_{\\mathrm{sym}})_{ij}^2$。\n        - 第三偏应力不变量：$J_3^{\\text{direct}} = \\det(\\boldsymbol{s}_{\\mathrm{sym}})$。\n\n    b.  从特征值（主应力）计算：使用计算出的主应力 $\\lambda_1, \\lambda_2, \\lambda_3$：\n        - $I_1^{\\text{eig}} = \\lambda_1 + \\lambda_2 + \\lambda_3$。\n        - $I_2^{\\text{eig}} = \\lambda_1\\lambda_2 + \\lambda_2\\lambda_3 + \\lambda_3\\lambda_1$。\n        - $I_3^{\\text{eig}} = \\lambda_1\\lambda_2\\lambda_3$。\n\n        主偏应力为 $\\lambda_i' = \\lambda_i - \\frac{I_1^{\\text{eig}}}{3}$。然后：\n        - $J_2^{\\text{eig}} = \\frac{1}{2}\\sum_{i=1}^3 (\\lambda_i')^2$。\n        - $J_3^{\\text{eig}} = \\lambda_1'\\lambda_2'\\lambda_3'$。\n\n4.  验证与失配度量：最后一步是量化计算的数值准确性和一致性。\n\n    - 不变量失配：无量纲归一化差异（$r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}$）比较了直接计算法和基于特征值法的结果。对于完美的数值计算，这些失配将为零。实际上，它们将处于机器精度的量级。分母 $\\max(|\\text{value}|, 1)$ 能稳健地处理不变量为零或非常小的情况。\n\n    - 重构残差（$r_{\\mathrm{rec}}$）：此度量用于检查特征求解器本身的准确性。我们从其谱分量重构张量，即 $\\boldsymbol{\\sigma}_{\\mathrm{rec}} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}}$，并将其与原始对称张量 $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 进行比较。归一化后的差值的弗罗贝尼乌斯范数应接近于零。\n    \n    - 偏斜对称残差（$r_{\\mathrm{skew}}$）：此度量 $r_{\\mathrm{skew}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)}$ 作为对称化步骤的合理性检查。根据构造，$\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ 是完全对称的。因此，$\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}$ 是零矩阵，且 $r_{\\mathrm{skew}}$ 必须精确为零。这证实了对称化实现的正确性，并可作为其他数值误差的基准。\n\n最后，取这七个度量中的最大值 $m = \\max(r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}, r_{\\mathrm{rec}}, r_{\\mathrm{skew}})$，作为对每个测试用例整体数值质量的单一保守度量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the stress tensor analysis for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: happy path, symmetric interior slope stress\n        np.array([\n            [-120e3, 30e3, 0],\n            [30e3, -80e3, 5e3],\n            [0, 5e3, -20e3]\n        ]),\n        # Case 2: near-symmetric with small antisymmetric discretization noise\n        np.array([\n            [-120e3, 30e3 + 200, -100],\n            [30e3 - 200, -80e3, 5e3 + 50],\n            [100, 5e3 - 50, -20e3]\n        ]),\n        # Case 3: nearly hydrostatic compressive state with small shear\n        np.array([\n            [-100e3, 200, 0],\n            [200, -100e3, 0],\n            [0, 0, -100e3]\n        ]),\n        # Case 4: ill-conditioned magnitudes with significant shear coupling\n        np.array([\n            [-1.0e6, 4.0e4, -3.0e4],\n            [4.0e4, -5.0e3, 2.0e4],\n            [-3.0e4, 2.0e4, 2.0e4]\n        ]),\n        # Case 5: strongly deviatoric with zero trace, crest/tensile-shear mix\n        np.array([\n            [50e3, 10e3, -5e3],\n            [10e3, -30e3, 8e3],\n            [-5e3, 8e3, -20e3]\n        ])\n    ]\n\n    results = []\n    for sigma in test_cases:\n        m = analyze_stress_tensor(sigma)\n        results.append(m)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.16e}' for r in results)}]\")\n\ndef analyze_stress_tensor(sigma: np.ndarray) - float:\n    \"\"\"\n    Performs the complete analysis for a single 3x3 stress tensor.\n    \n    Args:\n        sigma: A 3x3 numpy array representing the Cauchy stress tensor.\n\n    Returns:\n        The maximum dimensionless normalized mismatch metric.\n    \"\"\"\n    # 1. Enforce symmetry\n    sigma_sym = 0.5 * (sigma + sigma.T)\n\n    # 2. Spectral decomposition of the symmetric tensor\n    # np.linalg.eigh is for hermitian/symmetric matrices, guaranteeing real eigenvalues\n    # and being more numerically stable for this case.\n    # The eigenvalues are not guaranteed to be sorted.\n    # The columns of eigvecs are the corresponding eigenvectors.\n    eigvals, eigvecs = np.linalg.eigh(sigma_sym)\n\n    # 3. Reconstruct the tensor to check eigensolver accuracy\n    sigma_rec = eigvecs @ np.diag(eigvals) @ eigvecs.T\n\n    # 4. Compute invariants directly from tensor components\n    I1_direct = np.trace(sigma_sym)\n    I2_direct = 0.5 * (np.trace(sigma_sym)**2 - np.trace(sigma_sym @ sigma_sym))\n    I3_direct = np.linalg.det(sigma_sym)\n    \n    s_sym = sigma_sym - (I1_direct / 3.0) * np.identity(3)\n    J2_direct = 0.5 * np.sum(s_sym**2)  # 0.5 * s:s\n    J3_direct = np.linalg.det(s_sym)\n\n    # Compute invariants from principal stresses (eigenvalues)\n    lambdas = eigvals\n    I1_eig = np.sum(lambdas)\n    # This formula is robust to the order of eigenvalues\n    I2_eig = lambdas[0]*lambdas[1] + lambdas[1]*lambdas[2] + lambdas[2]*lambdas[0]\n    I3_eig = np.prod(lambdas)\n\n    s_lambdas = lambdas - (I1_eig / 3.0)\n    J2_eig = 0.5 * np.sum(s_lambdas**2)\n    J3_eig = np.prod(s_lambdas)\n\n    # 5. Compute dimensionless normalized mismatch metrics for invariants\n    def mismatch(direct_val, eig_val):\n        numerator = np.abs(direct_val - eig_val)\n        denominator = np.maximum(np.abs(direct_val), 1.0)\n        return numerator / denominator\n\n    r_I1 = mismatch(I1_direct, I1_eig)\n    r_I2 = mismatch(I2_direct, I2_eig)\n    r_I3 = mismatch(I3_direct, I3_eig)\n    r_J2 = mismatch(J2_direct, J2_eig)\n    r_J3 = mismatch(J3_direct, J3_eig)\n\n    # 6. Compute reconstruction and skew residuals\n    norm_sigma_sym = np.linalg.norm(sigma_sym, 'fro')\n    \n    r_rec = np.linalg.norm(sigma_sym - sigma_rec, 'fro') / np.maximum(norm_sigma_sym, 1.0)\n    \n    # By construction, sigma_sym is symmetric, so this should be 0.0\n    r_skew = np.linalg.norm(sigma_sym - sigma_sym.T, 'fro') / np.maximum(norm_sigma_sym, 1.0)\n    \n    # 7. Find the maximum of all seven metrics\n    m = max(r_I1, r_I2, r_I3, r_J2, r_J3, r_rec, r_skew)\n    \n    return m\n\n# Execute the main function\nsolve()\n\n```", "id": "3565171"}]}