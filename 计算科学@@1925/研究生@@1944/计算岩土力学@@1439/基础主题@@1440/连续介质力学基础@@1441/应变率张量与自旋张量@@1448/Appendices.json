{"hands_on_practices": [{"introduction": "要掌握应变率张量和自旋张量的概念，最好的方法莫过于从一个具体的运动学场景出发进行直接计算。本练习将引导您从一个给定的二维速度场出发，通过基本的张量运算，分解出描述材料变形的应变率张量 $D$ 和描述材料刚体旋转的自旋张量 $W$。通过比较这两个张量的大小，您可以直观地判断运动是由剪切变形主导还是由旋转主导，从而将抽象的数学定义与真实的物理过程联系起来 [@problem_id:3563983]。", "problem": "在计算岩土力学的平面应变小应变运动学中，考虑一个由 $v(x,y)=\\big(\\kappa\\, y,\\ \\lambda\\, x\\big)$ 给出的二维速度场，其中 $\\kappa$ 和 $\\lambda$ 是单位为 $\\mathrm{s}^{-1}$ 的空间均匀常数。从速度梯度张量 $L$（其分量为 $L_{ij}=\\partial v_{i}/\\partial x_{j}$）的基本定义出发，利用 $L$ 对其对称和反对称部分的标准运动学分解，推导该运动的应变率张量 $D$ 和自旋张量 $W$。然后，使用由 $\\|A\\|_{F}=\\sqrt{\\sum_{i,j}A_{ij}^{2}}$ 定义的 Frobenius 范数，通过比较 $\\|D\\|_{F}$ 和 $\\|W\\|_{F}$，评估该运动是由剪切（由 $D$ 表示）主导还是由刚体旋转（由 $W$ 表示）主导。\n\n将单一标量比 $\\|W\\|_{F}/\\|D\\|_{F}$ 作为最终答案报告，该比值应为用 $\\kappa$ 和 $\\lambda$ 表示的闭式解析表达式。无需四舍五入，该比值为无量纲。请在计算过程中给出 $D$ 和 $W$ 以及解释性比较，但最终答案只需报告该标量比。", "solution": "该问题被认为是有效的。它科学地基于连续介质力学原理，特别是小应变运动学。该问题是适定的、客观的和自洽的，提供了推导唯一、有意义的解析解所需的所有必要定义和数据。不存在矛盾、歧义或违反物理定律的情况。\n\n给定的二维速度场为 $\\vec{v} = (v_1, v_2)$，其分量由下式给出：\n$$v_1(x_1, x_2) = \\kappa x_2$$\n$$v_2(x_1, x_2) = \\lambda x_1$$\n其中我们使用了记号 $x_1 = x$ 和 $x_2 = y$。参数 $\\kappa$ 和 $\\lambda$ 是常数。\n\n速度梯度张量 $L$ 由其分量 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$ 定义。我们计算这个二维流动的 $L$ 的四个分量：\n$$L_{11} = \\frac{\\partial v_1}{\\partial x_1} = \\frac{\\partial (\\kappa x_2)}{\\partial x_1} = 0$$\n$$L_{12} = \\frac{\\partial v_1}{\\partial x_2} = \\frac{\\partial (\\kappa x_2)}{\\partial x_2} = \\kappa$$\n$$L_{21} = \\frac{\\partial v_2}{\\partial x_1} = \\frac{\\partial (\\lambda x_1)}{\\partial x_1} = \\lambda$$\n$$L_{22} = \\frac{\\partial v_2}{\\partial x_2} = \\frac{\\partial (\\lambda x_1)}{\\partial x_2} = 0$$\n\n速度梯度张量 $L$ 的矩阵形式为：\n$$L = \\begin{pmatrix} 0  \\kappa \\\\ \\lambda  0 \\end{pmatrix}$$\n\n速度梯度张量可以分解为一个对称部分，即应变率张量 $D$，和一个反对称部分，即自旋张量 $W$，使得 $L = D + W$。\n\n应变率张量 $D$ 由 $D = \\frac{1}{2}(L + L^T)$ 给出。首先，我们求 $L$ 的转置，记为 $L^T$：\n$$L^T = \\begin{pmatrix} 0  \\lambda \\\\ \\kappa  0 \\end{pmatrix}$$\n现在，我们可以计算 $D$：\n$$D = \\frac{1}{2} \\left[ \\begin{pmatrix} 0  \\kappa \\\\ \\lambda  0 \\end{pmatrix} + \\begin{pmatrix} 0  \\lambda \\\\ \\kappa  0 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 0  \\kappa + \\lambda \\\\ \\kappa + \\lambda  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\kappa + \\lambda}{2} \\\\ \\frac{\\kappa + \\lambda}{2}  0 \\end{pmatrix}$$\n张量 $D$ 表示材料元的变形率（应变）。\n\n自旋张量 $W$ 由 $W = \\frac{1}{2}(L - L^T)$ 给出：\n$$W = \\frac{1}{2} \\left[ \\begin{pmatrix} 0  \\kappa \\\\ \\lambda  0 \\end{pmatrix} - \\begin{pmatrix} 0  \\lambda \\\\ \\kappa  0 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 0  \\kappa - \\lambda \\\\ \\lambda - \\kappa  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\kappa - \\lambda}{2} \\\\ -\\frac{\\kappa - \\lambda}{2}  0 \\end{pmatrix}$$\n张量 $W$ 表示材料元的刚体旋转率（涡量）。\n\n接下来，我们使用 Frobenius 范数（定义为 $\\|A\\|_{F} = \\sqrt{\\sum_{i,j}A_{ij}^2}$）来计算这些张量的大小。\n\n对于应变率张量 $D$：\n$$\\|D\\|_{F} = \\sqrt{D_{11}^2 + D_{12}^2 + D_{21}^2 + D_{22}^2}$$\n$$\\|D\\|_{F} = \\sqrt{0^2 + \\left(\\frac{\\kappa + \\lambda}{2}\\right)^2 + \\left(\\frac{\\kappa + \\lambda}{2}\\right)^2 + 0^2} = \\sqrt{2 \\left(\\frac{\\kappa + \\lambda}{2}\\right)^2} = \\sqrt{\\frac{(\\kappa + \\lambda)^2}{2}}$$\n$$\\|D\\|_{F} = \\frac{|\\kappa + \\lambda|}{\\sqrt{2}}$$\n这个标量代表了应变运动的总体强度。\n\n对于自旋张量 $W$：\n$$\\|W\\|_{F} = \\sqrt{W_{11}^2 + W_{12}^2 + W_{21}^2 + W_{22}^2}$$\n$$\\|W\\|_{F} = \\sqrt{0^2 + \\left(\\frac{\\kappa - \\lambda}{2}\\right)^2 + \\left(-\\frac{\\kappa - \\lambda}{2}\\right)^2 + 0^2} = \\sqrt{2 \\left(\\frac{\\kappa - \\lambda}{2}\\right)^2} = \\sqrt{\\frac{(\\kappa - \\lambda)^2}{2}}$$\n$$\\|W\\|_{F} = \\frac{|\\kappa - \\lambda|}{\\sqrt{2}}$$\n这个标量代表了旋转运动的总体强度。\n\n问题要求通过比较 $\\|D\\|_{F}$ 和 $\\|W\\|_{F}$ 来评估运动是由剪切（变形）主导还是由刚体旋转主导。\n- 如果 $\\|D\\|_{F}  \\|W\\|_{F}$，即 $|\\kappa + \\lambda|  |\\kappa - \\lambda|$，则运动由应变主导。当且仅当 $\\kappa \\lambda  0$ 时，此不等式成立。\n- 如果 $\\|W\\|_{F}  \\|D\\|_{F}$，即 $|\\kappa - \\lambda|  |\\kappa + \\lambda|$，则运动由旋转主导。当且仅当 $\\kappa \\lambda  0$ 时，此不等式成立。\n- 如果 $\\|W\\|_{F} = \\|D\\|_{F}$，即 $|\\kappa - \\lambda| = |\\kappa + \\lambda|$，则应变和旋转分量的大小相等。这种情况发生在 $\\kappa \\lambda = 0$ 时，对应于简单剪切流。\n\n最后的任务是计算无量纲标量比 $\\frac{\\|W\\|_{F}}{\\|D\\|_{F}}$。该比值提供了旋转相对于变形主导程度的定量度量。\n$$\\frac{\\|W\\|_{F}}{\\|D\\|_{F}} = \\frac{\\frac{|\\kappa - \\lambda|}{\\sqrt{2}}}{\\frac{|\\kappa + \\lambda|}{\\sqrt{2}}} = \\frac{|\\kappa - \\lambda|}{|\\kappa + \\lambda|}$$\n这可以更紧凑地写成：\n$$\\frac{\\|W\\|_{F}}{\\|D\\|_{F}} = \\left|\\frac{\\kappa - \\lambda}{\\kappa + \\lambda}\\right|$$\n该表达式是通解。只要分母不为零，即 $\\kappa + \\lambda \\neq 0$，它就是有定义的。如果 $\\kappa + \\lambda = 0$（意味着 $\\kappa = -\\lambda \\neq 0$），那么 $\\|D\\|_{F} = 0$ 而 $\\|W\\|_{F}  0$，对应于纯刚体旋转，此时该比值未定义（无穷大）。", "answer": "$$\\boxed{\\left|\\frac{\\kappa - \\lambda}{\\kappa + \\lambda}\\right|}$$", "id": "3563983"}, {"introduction": "理论概念在计算地球力学中必须转化为离散的数值算法。本练习将理论与实践相结合，演示了如何在有限元方法的框架内，根据单元节点的离散速度信息来计算单元内部任意点（如积分点）的速度梯度张量 $L$。这个过程是所有计算本构模型更新的基础，通过完成这个练习，您将深刻理解连续介质力学中的运动学量是如何在计算模型中被近似和应用的 [@problem_id:3564019]。", "problem": "在计算地质力学中，本构更新常常需要在有限元内的积分点上计算速度梯度、应变率张量和自旋张量。从第一性原理出发，为一个使用连续位移和速度插值（$C^{0}$连续性）的有限元，构建其在积分点处速度梯度的表达式。您的推导必须从速度场的定义和标准的有限元插值开始，并通过应用适当的微分算子，得到以节点速度和形函数梯度表示的速度梯度。然后，对于一个特定的二维线性三角形单元，计算其在形心积分点处的离散速度梯度。\n\n单元规格：\n- 节点物理坐标：$($节点 $1)$ $\\left(x_{1},y_{1}\\right)=\\left(0,0\\right)$，$($节点 $2)$ $\\left(x_{2},y_{2}\\right)=\\left(2,0\\right)$，以及$($节点 $3)$ $\\left(x_{3},y_{3}\\right)=\\left(0,1\\right)$。\n- 节点速度（单位：米/秒）：$($节点 $1)$ $\\boldsymbol{v}_{1}=\\left(0.1,-0.05\\right)$，$($节点 $2)$ $\\boldsymbol{v}_{2}=\\left(0.2,0.00\\right)$，以及$($节点 $3)$ $\\boldsymbol{v}_{3}=\\left(-0.05,0.15\\right)$。\n\n假设在单元形心处采用单点高斯积分，并使用标准的线性三角形形函数。在推导出通用表达式后，为给定单元计算其在形心处的离散速度梯度矩阵。此外，请识别速度梯度的对称和反对称部分，并讨论使用$C^{0}$插值对这些运动学度量的精度影响，包括离散梯度在单元内是精确的条件。\n\n将所有报告的数值分量四舍五入至四位有效数字。以 $\\mathrm{s}^{-1}$ 为单位表示速度梯度、应变率和自旋分量。对于最终答案，仅报告在形心处计算的离散速度梯度矩阵。", "solution": "该问题是有效的，因为它在科学上基于连续介质力学和有限元方法，问题设定良好且数据充分，并以客观、正式的语言表述。我们继续进行解答。\n\n推导从单个单元内速度场 $\\boldsymbol{v}$ 的有限元插值的基本原理开始。对于一个有 $n$ 个节点的有限元，单元内任意点 $\\boldsymbol{x}$ 的速度场 $\\boldsymbol{v}(\\boldsymbol{x})$ 可以通过使用形函数 $N_i(\\boldsymbol{x})$ 对节点速度 $\\boldsymbol{v}_i$ 进行插值来近似：\n$$\n\\boldsymbol{v}(\\boldsymbol{x}) = \\sum_{i=1}^{n} N_i(\\boldsymbol{x}) \\boldsymbol{v}_i\n$$\n其中 $\\boldsymbol{v}_i$ 是节点 $i$ 处的速度向量。对于二维问题，$\\boldsymbol{v} = (v_x, v_y)^T$ 且 $\\boldsymbol{x} = (x, y)^T$。\n\n速度梯度张量，记为 $\\boldsymbol{L}$，定义为速度场的空间梯度：\n$$\n\\boldsymbol{L} = \\nabla \\boldsymbol{v} = \\begin{pmatrix} \\frac{\\partial v_x}{\\partial x}  \\frac{\\partial v_x}{\\partial y} \\\\ \\frac{\\partial v_y}{\\partial x}  \\frac{\\partial v_y}{\\partial y} \\end{pmatrix}\n$$\n$\\boldsymbol{L}$ 的分量为 $L_{jk} = \\frac{\\partial v_j}{\\partial x_k}$。将梯度算子应用于插值速度场，得到：\n$$\n\\boldsymbol{L} = \\nabla \\left( \\sum_{i=1}^{n} N_i(\\boldsymbol{x}) \\boldsymbol{v}_i \\right) = \\sum_{i=1}^{n} (\\nabla N_i(\\boldsymbol{x})) \\otimes \\boldsymbol{v}_i\n$$\n其中 $\\otimes$ 表示外积。其分量形式为：\n$$\nL_{jk} = \\frac{\\partial v_j}{\\partial x_k} = \\frac{\\partial}{\\partial x_k} \\left( \\sum_{i=1}^{n} N_i(\\boldsymbol{x}) v_{ij} \\right) = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial x_k} v_{ij}\n$$\n其中 $v_{ij}$ 是节点 $i$ 处速度向量的第 $j$ 个分量。\n\n对于二维单元，速度梯度的分量为：\n$$\n\\frac{\\partial v_x}{\\partial x} = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial x} v_{ix}, \\quad \\frac{\\partial v_x}{\\partial y} = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial y} v_{ix}\n$$\n$$\n\\frac{\\partial v_y}{\\partial x} = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial x} v_{iy}, \\quad \\frac{\\partial v_y}{\\partial y} = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial y} v_{iy}\n$$\n这可以写成矩阵形式：\n$$\n\\boldsymbol{L} = \\begin{pmatrix} \\sum \\frac{\\partial N_i}{\\partial x} v_{ix}  \\sum \\frac{\\partial N_i}{\\partial y} v_{ix} \\\\ \\sum \\frac{\\partial N_i}{\\partial x} v_{iy}  \\sum \\frac{\\partial N_i}{\\partial y} v_{iy} \\end{pmatrix}\n$$\n该表达式依赖于形函数的梯度 $\\nabla N_i = (\\frac{\\partial N_i}{\\partial x}, \\frac{\\partial N_i}{\\partial y})^T$。\n\n对于特定的二维线性三角形单元（也称为常应变三角形单元，CST），形函数是空间坐标 $(x,y)$ 的线性函数。该单元的一个关键特性是其形函数的梯度在整个单元内是恒定的。因此，速度梯度张量 $\\boldsymbol{L}$ 在单元内也是恒定的。这意味着其值不依赖于计算点，因此在形心处的值与单元内任何其他点的值相同。\n\n对于节点坐标为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的线性三角形，其形函数梯度由下式给出：\n$$\n\\frac{\\partial N_1}{\\partial x} = \\frac{y_2 - y_3}{2A}, \\quad \\frac{\\partial N_1}{\\partial y} = \\frac{x_3 - x_2}{2A}\n$$\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{y_3 - y_1}{2A}, \\quad \\frac{\\partial N_2}{\\partial y} = \\frac{x_1 - x_3}{2A}\n$$\n$$\n\\frac{\\partial N_3}{\\partial x} = \\frac{y_1 - y_2}{2A}, \\quad \\frac{\\partial N_3}{\\partial y} = \\frac{x_2 - x_1}{2A}\n$$\n其中 $A$ 是单元的面积，计算公式为 $A = \\frac{1}{2} \\det \\begin{pmatrix} x_1  y_1  1 \\\\ x_2  y_2  1 \\\\ x_3  y_3  1 \\end{pmatrix}$。\n\n给定节点坐标：节点 $1: (0,0)$；节点 $2: (2,0)$；节点 $3: (0,1)$。\n面积 $A$ 为：\n$$\nA = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)| = \\frac{1}{2} |0(0-1) + 2(1-0) + 0(0-0)| = \\frac{1}{2}(2) = 1\n$$\n现在，我们计算形函数梯度：\n对于节点 1：\n$\\frac{\\partial N_1}{\\partial x} = \\frac{0 - 1}{2(1)} = -0.5$, $\\frac{\\partial N_1}{\\partial y} = \\frac{0 - 2}{2(1)} = -1.0$\n对于节点 2：\n$\\frac{\\partial N_2}{\\partial x} = \\frac{1 - 0}{2(1)} = 0.5$, $\\frac{\\partial N_2}{\\partial y} = \\frac{0 - 0}{2(1)} = 0.0$\n对于节点 3：\n$\\frac{\\partial N_3}{\\partial x} = \\frac{0 - 0}{2(1)} = 0.0$, $\\frac{\\partial N_3}{\\partial y} = \\frac{2 - 0}{2(1)} = 1.0$\n\n节点速度为：\n$\\boldsymbol{v}_{1} = (0.1, -0.05)^T \\ \\mathrm{m/s}$\n$\\boldsymbol{v}_{2} = (0.2, 0.00)^T \\ \\mathrm{m/s}$\n$\\boldsymbol{v}_{3} = (-0.05, 0.15)^T \\ \\mathrm{m/s}$\n\n现在我们可以计算速度梯度张量 $\\boldsymbol{L}$ 的分量，单位为 $\\mathrm{s}^{-1}$：\n$L_{11} = \\frac{\\partial v_x}{\\partial x} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial x} v_{ix} = (-0.5)(0.1) + (0.5)(0.2) + (0.0)(-0.05) = -0.05 + 0.1 = 0.05$\n$L_{12} = \\frac{\\partial v_x}{\\partial y} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial y} v_{ix} = (-1.0)(0.1) + (0.0)(0.2) + (1.0)(-0.05) = -0.1 - 0.05 = -0.15$\n$L_{21} = \\frac{\\partial v_y}{\\partial x} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial x} v_{iy} = (-0.5)(-0.05) + (0.5)(0.00) + (0.0)(0.15) = 0.025$\n$L_{22} = \\frac{\\partial v_y}{\\partial y} = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial y} v_{iy} = (-1.0)(-0.05) + (0.0)(0.00) + (1.0)(0.15) = 0.05 + 0.15 = 0.20$\n\n四舍五入至四位有效数字，在形心处（以及单元内各处）的离散速度梯度矩阵为：\n$$\n\\boldsymbol{L} = \\begin{pmatrix} 0.05000  -0.1500 \\\\ 0.02500  0.2000 \\end{pmatrix} \\ \\mathrm{s}^{-1}\n$$\n\n速度梯度张量 $\\boldsymbol{L}$ 分解为其对称部分（应变率张量 $\\boldsymbol{D}$）和反对称部分（自旋张量 $\\boldsymbol{W}$）：\n$\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^T)$\n$\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^T)$\n\n首先，我们求 $\\boldsymbol{L}$ 的转置：\n$$\n\\boldsymbol{L}^T = \\begin{pmatrix} 0.05000  0.02500 \\\\ -0.1500  0.2000 \\end{pmatrix}\n$$\n应变率张量 $\\boldsymbol{D}$ 为：\n$$\n\\boldsymbol{D} = \\frac{1}{2} \\begin{pmatrix} 0.05000+0.05000  -0.1500+0.02500 \\\\ 0.02500-0.1500  0.2000+0.2000 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0.1000  -0.1250 \\\\ -0.1250  0.4000 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{D} = \\begin{pmatrix} 0.05000  -0.06250 \\\\ -0.06250  0.2000 \\end{pmatrix} \\ \\mathrm{s}^{-1}\n$$\n自旋张量 $\\boldsymbol{W}$ 为：\n$$\n\\boldsymbol{W} = \\frac{1}{2} \\begin{pmatrix} 0.05000-0.05000  -0.1500-0.02500 \\\\ 0.02500-(-0.1500)  0.2000-0.2000 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0  -0.1750 \\\\ 0.1750  0 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{W} = \\begin{pmatrix} 0  -0.08750 \\\\ 0.08750  0 \\end{pmatrix} \\ \\mathrm{s}^{-1}\n$$\n\n**精度影响与精确性条件**\n使用$C^0$连续形函数，例如线性三角形单元中的形函数，确保了插值速度场在单元边界上是连续的。然而，其空间导数——速度梯度、应变率和自旋——则不连续。对于线性单元，这些量在每个单元内是常数，但在单元边界上会出现跳跃。这代表了对真实的、通常是光滑的梯度场的分段常数近似。这种低阶近似是模拟中离散化误差的主要来源。\n\n已知该单元在弯曲主导问题中表现不佳，并可能出现“闭锁”现象。解的精度通常通过网格细化（h-refinement，使用更小的单元）或使用高阶单元（p-refinement）来提高，高阶单元允许单元内的梯度为非常数。\n\n如此处计算的离散梯度在一个特定条件下是精确的：即真实的底层速度场在单元所覆盖的区域内是空间坐标的线性函数。线性速度场可以写为 $\\boldsymbol{v}(\\boldsymbol{x}) = \\boldsymbol{A} \\boldsymbol{x} + \\boldsymbol{b}$，其中 $\\boldsymbol{A}$ 是一个常数矩阵，$\\boldsymbol{b}$ 是一个常数向量。这样一个场的速度梯度是 $\\nabla \\boldsymbol{v} = \\boldsymbol{A}$，它是一个常数。线性有限元可以精确地表示一个线性场。如果给定的节点速度是从此类线性场中精确采样的，则有限元插值将精确地重现该场，并且计算出的常数速度梯度将是单元内各处的精确梯度。对于任何更高阶（例如二次）的速度场，线性单元的常数梯度仅仅是一种近似。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.05000  -0.1500 \\\\ 0.02500  0.2000 \\end{pmatrix}}\n$$", "id": "3564019"}, {"introduction": "在处理涉及大转动的岩土力学问题时，确保本构模型的客观性或坐标系无关性至关重要。本实践练习探讨了这一高级但核心的概念，要求您通过编程实现一个弹塑性本构更新算法，并对比使用客观应力率（Jaumann 率）和非客观应力率所产生的截然不同的结果。这个练习通过一个具体的数值实验，有力地证明了自旋张量 $W$ 在确保模拟结果物理真实性方面的关键作用，并揭示了忽略它可能导致的严重错误 [@problem_id:3564053]。", "problem": "设计并实现一个用于计算岩土力学中同旋本构更新的验证程序，该程序需突出应变率张量和自旋张量的作用。在三维空间中进行，假设小应变，但通过客观应力率考虑大转动。基本出发点必须是同旋框架下空间速度梯度的运动学定义和 Cauchy 应力率，并结合标准的各向同性线彈性和一个具有非关联塑性势的率无关 Drucker–Prager 塑性模型。\n\n您必须使用以下基本定义和事实作为唯一的出发点：\n- 空间速度梯度定义为 $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$，其对称部分为应变率张量 $\\boldsymbol{D} = \\tfrac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}})$，其反对称部分为自旋张量 $\\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}})$。\n- Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 必须使用客观（标架无关）的同旋应力率进行更新，特别是 Jaumann 率，其关系式定义为 $\\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} + \\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma}$。\n- 弹塑性本构关系以率形式表示为 $\\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\boldsymbol{D} - \\boldsymbol{D}^{\\mathrm{p}})$，其中 $\\mathbb{C}$ 是四阶各向同性弹性张量，其体积模量为 $K$，剪切模量为 $G$，而 $\\boldsymbol{D}^{\\mathrm{p}}$ 是变形率张量的塑性部分。\n- 对于率无关的 Drucker–Prager 塑性模型，屈服函数为 $f(\\boldsymbol{\\sigma}) = \\alpha I_1 + \\sqrt{J_2} - k$，其中 $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$ 且 $J_2 = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$，偏应力为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{I_1}{3}\\boldsymbol{I}$。非关联塑性势 $g(\\boldsymbol{\\sigma}) = \\alpha_{\\psi} I_1 + \\sqrt{J_2}$ 定义了流动方向 $\\boldsymbol{N} = \\partial g/\\partial \\boldsymbol{\\sigma}$。\n- 使用以内摩擦角 $\\varphi$（单位：弧度）、剪胀角 $\\psi$（单位：弧度）和内聚力 $c$ 表示的材料参数化：$\\alpha = \\dfrac{2\\sin \\varphi}{\\sqrt{3}\\,(3 - \\sin \\varphi)}$， $k = \\dfrac{6 c \\cos \\varphi}{\\sqrt{3}\\,(3 - \\sin \\varphi)}$，以及 $\\alpha_{\\psi} = \\dfrac{2\\sin \\psi}{\\sqrt{3}\\,(3 - \\sin \\psi)}$。\n\n实现一个显式时间步进算法，在每一步中，该算法会形成一个弹性试探应力增量，并且如果试探状态违反 $f \\le 0$，则应用 Drucker–Prager 返回修正。对于同旋算法，应力更新中必须包含 Jaumann 项。作为对比，实现一个未修正的算法，其中省略 Jaumann 项，并直接对原始物质时间导数 $\\dot{\\boldsymbol{\\sigma}}$ 进行积分。\n\n所有物理量必须按以下单位和约定处理：\n- 应力单位为千帕 (kPa)。\n- 时间单位为秒 ($\\mathrm{s}$)。\n- 角度单位为弧度。\n- 采用拉应力为正的标准符号约定；因此，压缩性静水围压的迹为负。\n\n您的程序必须执行以下测试套件并汇总结果。\n\n所有测试通用的材料参数：\n- 杨氏模量 (Young’s modulus) $E = 3.0\\times 10^{4}\\,\\mathrm{kPa}$，泊松比 (Poisson’s ratio) $\\nu = 0.3$，因此 $G = \\dfrac{E}{2(1+\\nu)}$ 且 $K = \\dfrac{E}{3(1 - 2\\nu)}$。\n- Drucker–Prager 参数：$\\varphi = 30\\,\\text{度}$，$\\psi = 5\\,\\text{度}$，$c = 5\\,\\mathrm{kPa}$，在计算 $\\alpha$、$\\alpha_{\\psi}$ 和 $k$ 之前将 $\\varphi$ 和 $\\psi$ 转换为弧度。\n\n测试 1（纯刚体旋转，客观性边界情况）：\n- 初始应力：$\\boldsymbol{\\sigma}_0 = \\operatorname{diag}(200,\\,100,\\,100)\\,\\mathrm{kPa}$。\n- 施加一个绕 $z$ 轴的纯自旋，角速度恒为 $\\omega = \\pi/2\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$，总时间为 $T = 1.0\\,\\mathrm{s}$，因此总转角为 $\\theta = \\pi/2$。使用时间步长 $\\Delta t = 0.005\\,\\mathrm{s}$。\n- 速度梯度为 $\\boldsymbol{L}(t) = \\boldsymbol{W}$，其中 $\\boldsymbol{W} = \\begin{bmatrix}0  -\\omega  0\\\\ \\omega  0  0\\\\ 0  0  0\\end{bmatrix}$ 且 $\\boldsymbol{D} = \\boldsymbol{0}$。\n- 使用同旋 (Jaumann) 算法计算最终数值应力 $\\boldsymbol{\\sigma}^{\\mathrm{obj}}(T)$，并使用未修正算法计算 $\\boldsymbol{\\sigma}^{\\mathrm{unc}}(T)$。同时计算精确的旋转后应力 $\\boldsymbol{\\sigma}^{\\mathrm{exact}}(T) = \\boldsymbol{R}(\\theta)\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{R}^{\\mathsf{T}}(\\theta)$，其中 $\\boldsymbol{R}(\\theta)$ 是绕 $z$ 轴旋转角度 $\\theta$ 的平面内旋转矩阵。报告比值 $r_1 = \\dfrac{\\lVert \\boldsymbol{\\sigma}^{\\mathrm{obj}}(T) - \\boldsymbol{\\sigma}^{\\mathrm{exact}}(T)\\rVert_{\\mathrm{F}}}{\\lVert \\boldsymbol{\\sigma}^{\\mathrm{unc}}(T) - \\boldsymbol{\\sigma}^{\\mathrm{exact}}(T)\\rVert_{\\mathrm{F}}}$，结果为一个无量纲浮点数，保留六位小数。\n\n测试 2（单剪，主应力路径旋转）：\n- 初始应力：各向同性围压状态 $\\boldsymbol{\\sigma}_0 = -100\\,\\boldsymbol{I}\\,\\mathrm{kPa}$。\n- 通过指定速度梯度 $\\boldsymbol{L} = \\begin{bmatrix}0  \\dot{\\gamma}  0\\\\ 0  0  0\\\\ 0  0  0\\end{bmatrix}$ 施加恒定的单剪率 $\\dot{\\gamma} = 0.01\\,\\mathrm{s}^{-1}$，持续时间 $T = 50\\,\\mathrm{s}$，时间步长 $\\Delta t = 0.1\\,\\mathrm{s}$。此时 $\\boldsymbol{D} = \\tfrac{1}{2}\\begin{bmatrix}0  \\dot{\\gamma}  0\\\\ \\dot{\\gamma}  0  0\\\\ 0  0  0\\end{bmatrix}$ 且 $\\boldsymbol{W} = \\tfrac{1}{2}\\begin{bmatrix}0  \\dot{\\gamma}  0\\\\ -\\dot{\\gamma}  0  0\\\\ 0  0  0\\end{bmatrix}$。\n- 使用和不使用 Jaumann 项分别对本构更新进行积分。报告最终的剪应力分量 $\\tau^{\\mathrm{obj}} = \\sigma^{\\mathrm{obj}}_{12}(T)$ 和 $\\tau^{\\mathrm{unc}} = \\sigma^{\\mathrm{unc}}_{12}(T)$，单位均为 $\\mathrm{kPa}$，保留六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[r_1,\\tau^{\\mathrm{obj}},\\tau^{\\mathrm{unc}}]$，例如“[0.012345,12.345678,-9.876543]”。每个数字必须保留六位小数。", "solution": "用户要求设计并实现一个计算岩土力学验证程序。该程序必须为一个由各向同性弹性和 Drucker-Prager 塑性控制的材料实现一个显式时间步进的本构更新。一个关键要求是，将使用 Jaumann 率的同旋应力更新与省略客观率项的未修正更新进行比较。这种比较突出了应变率张量 $\\boldsymbol{D}$ 和自旋张量 $\\boldsymbol{W}$ 的作用。\n\n首先，对问题陈述进行验证。所有必需的物理模型、材料参数、初始条件、加载路径和数值程序都已明确定义。这些模型（$\\boldsymbol{L} = \\boldsymbol{D} + \\boldsymbol{W}$、Jaumann 率 $\\overset{\\triangle}{\\boldsymbol{\\sigma}}$、Drucker-Prager 塑性）在连续介质力学中是标准的且科学上是合理的。这两个测试案例是经典的基准测试：纯刚体旋转用于测试标架无关性（客观性），单剪用于测试应变和旋转组合作用下的行为。测试 1 的初始应力状态 $\\boldsymbol{\\sigma}_0 = \\operatorname{diag}(200,\\,100,\\,100)\\,\\mathrm{kPa}$，对于给定的材料属性，违反了 Drucker-Prager 屈服准则。虽然这在物理上是异常的（这种状态会瞬时松弛），但在数值计算的背景下，它是一个有效但具有挑战性的输入。问题要求实现一个特定的算法（带有返回映射修正的显式前向欧拉法），其结果是这个定义明确的程序在给定数据上运行的输出。因此，该问题被认为是有效、完整且适定的。\n\n解决方案的算法核心是本构更新例程，它将 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 从时间 $t_n$推进到 $t_{n+1} = t_n + \\Delta t$。\n\n**1. 初步计算**\n提供的材料属性包括杨氏模量 $E$ 和泊松比 $\\nu$，以及 Drucker-Prager 参数：内摩擦角 $\\varphi$、剪胀角 $\\psi$ 和内聚力 $c$。首先，我们从这些属性推导出必要的计算参数：\n- 剪切模量：$G = \\dfrac{E}{2(1+\\nu)}$\n- 体积模量：$K = \\dfrac{E}{3(1 - 2\\nu)}$\n- Drucker-Prager 摩擦参数：$\\alpha = \\dfrac{2\\sin \\varphi}{\\sqrt{3}\\,(3 - \\sin \\varphi)}$\n- Drucker-Prager 内聚力参数：$k = \\dfrac{6 c \\cos \\varphi}{\\sqrt{3}\\,(3 - \\sin \\varphi)}$\n- Drucker-Prager 剪胀参数：$\\alpha_{\\psi} = \\dfrac{2\\sin \\psi}{\\sqrt{3}\\,(3 - \\sin \\psi)}$\n\n**2. 运动学分解**\n在每个时间步，给定的空间速度梯度 $\\boldsymbol{L}$ 被分解为其对称部分（变形率张量 $\\boldsymbol{D}$）和反对称部分（自旋张量 $\\boldsymbol{W}$）：\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}})\n$$\n$$\n\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}})\n$$\n\n**3. 弹性试探步**\n使用显式前向欧拉积分方案。第一步是计算一个弹性试探应力 $\\boldsymbol{\\sigma}_{n+1}^{\\text{trial}}$，该步骤假设材料在增量 $\\Delta t$ 内呈弹性行为。\n率形式的本构定律为 $\\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\boldsymbol{D} - \\boldsymbol{D}^{\\mathrm{p}})$。对于弹性试探步，我们假设塑性应变率 $\\boldsymbol{D}^{\\mathrm{p}} = \\boldsymbol{0}$，因此 $\\overset{\\triangle}{\\boldsymbol{\\sigma}}^{\\text{el}} = \\mathbb{C}:\\boldsymbol{D}$。对于各向同性弹性，这表示为：\n$$\n\\overset{\\triangle}{\\boldsymbol{\\sigma}}^{\\text{el}} = 2G \\left(\\boldsymbol{D} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I}\\right) + K \\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I}\n$$\n两种算法计算试探应力的方式不同：\n\n- **未修正算法：** 该算法直接对物质时间导数 $\\dot{\\boldsymbol{\\sigma}}$ 进行积分，并忽略自旋项。更新公式为：\n$$\n\\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\boldsymbol{\\sigma}_n + (\\mathbb{C}:\\boldsymbol{D}) \\Delta t\n$$\n\n- **同旋 (Jaumann) 算法：** 该算法使用客观的 Jaumann 率 $\\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} + \\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma}$。对物质时间导数进行整理得到 $\\dot{\\boldsymbol{\\sigma}} = \\overset{\\triangle}{\\boldsymbol{\\sigma}} - (\\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma})$。显式更新公式为：\n$$\n\\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\boldsymbol{\\sigma}_n + \\left( \\mathbb{C}:\\boldsymbol{D} - (\\boldsymbol{\\sigma}_n\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma}_n) \\right) \\Delta t\n$$\n在此，与自旋相关的项在时间 $t_n$ 进行评估。\n\n**4. 塑性校核与修正（返回映射）**\n根据 Drucker-Prager 屈服准则检查试探应力：$f(\\boldsymbol{\\sigma}) = \\alpha I_1 + \\sqrt{J_2} - k \\le 0$，其中 $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$ 且对于偏应力 $\\boldsymbol{s}$，$J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$。\n我们计算 $f^{\\text{trial}} = f(\\boldsymbol{\\sigma}_{n+1}^{\\text{trial}})$。\n- 如果 $f^{\\text{trial}} \\le 0$，则该步为弹性步，最终应力即为试探应力：$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}}$。\n- 如果 $f^{\\text{trial}}  0$，则试探应力位于屈服面之外，需要进行塑性修正。应力必须被“返回”到屈服面上。\n\n塑性应变率由非关联流动法则 $\\boldsymbol{D}^{\\mathrm{p}} = \\dot{\\lambda} \\boldsymbol{N}$ 给出，其中 $\\dot{\\lambda}$ 是塑性乘子率，$\\boldsymbol{N} = \\partial g/\\partial \\boldsymbol{\\sigma}$ 是从塑性势 $g(\\boldsymbol{\\sigma}) = \\alpha_{\\psi} I_1 + \\sqrt{J_2}$ 导出的流动方向。\n最终应力通过修正试探应力得到：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - \\Delta\\lambda (\\mathbb{C}:\\boldsymbol{N})\n$$\n其中 $\\Delta\\lambda = \\dot{\\lambda}\\Delta t$ 是塑性乘子增量。通过将此表达式代入屈服条件 $f(\\boldsymbol{\\sigma}_{n+1}) = 0$ 并求解 $\\Delta\\lambda$，我们得到乘子的显式表达式：\n$$\n\\Delta\\lambda = \\frac{f^{\\text{trial}}}{G + 9K\\alpha\\alpha_{\\psi}}\n$$\n然后计算修正后的应力：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - \\Delta\\lambda \\left( \\frac{G}{\\sqrt{J_2^{\\text{trial}}}} \\boldsymbol{s}^{\\text{trial}} + 3K\\alpha_{\\psi}\\boldsymbol{I} \\right)\n$$\n这样就完成了一个时间步的更新。在每个测试案例中，该过程会针对指定的步数重复执行。\n\n**测试执行**\n- **测试 1 (纯旋转):** 此处，$\\boldsymbol{D} = \\boldsymbol{0}$ 且 $\\boldsymbol{W} \\ne \\boldsymbol{0}$。未修正算法没有自旋项，预测应力没有变化，即 $\\boldsymbol{\\sigma}^{\\mathrm{unc}}(T) = \\boldsymbol{\\sigma}_0$。（注意：由于初始条件超出了屈服面，代码实际上会应用塑性修正，导致 $\\boldsymbol{\\sigma}^{\\mathrm{unc}}$ 收缩但不会旋转）。同旋算法正确地考虑了旋转，其结果应力 $\\boldsymbol{\\sigma}^{\\mathrm{obj}}(T)$ 应非常接近解析旋转应力 $\\boldsymbol{\\sigma}^{\\mathrm{exact}}(T) = \\boldsymbol{R}(\\theta)\\boldsymbol{\\sigma}_0\\boldsymbol{R}^{\\mathsf{T}}(\\theta)$。比值 $r_1$ 量化了客观公式的更高精度。客观情况下的非零误差源于显式积分方案以及由有问题的初始条件触发的伪塑性流动。\n- **测试 2 (单剪):** 此处，$\\boldsymbol{D} \\ne \\boldsymbol{0}$ 且 $\\boldsymbol{W} \\ne \\boldsymbol{0}$。材料初始为弹性，但随着剪应力的增加而屈服。两种算法都会预测塑性流动，但应力路径会发散。自旋张量持续旋转主应力轴，这是一个物理效应，Jaumann 率能捕捉到而未修正的率则忽略了，从而导致不同的最终剪应力值 $\\tau^{\\mathrm{obj}}$ 和 $\\tau^{\\mathrm{unc}}$。\n\n最终程序实现了这一逻辑，执行了两个测试，并按要求格式化输出。", "answer": "```python\n# language: Python\n# version: 3.12\n# libraries:\n#   name: numpy\n#   version: 1.23.5\n\nimport numpy as np\n\ndef calculate_material_params(E, nu, phi_deg, psi_deg, c):\n    \"\"\"\n    Calculates derived material parameters for the Drucker-Prager model.\n\n    Args:\n        E (float): Young's modulus in kPa.\n        nu (float): Poisson's ratio.\n        phi_deg (float): Friction angle in degrees.\n        psi_deg (float): Dilation angle in degrees.\n        c (float): Cohesion in kPa.\n\n    Returns:\n        tuple: G, K, alpha, k, alpha_psi\n    \"\"\"\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n    \n    G = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n    \n    sin_phi = np.sin(phi_rad)\n    cos_phi = np.cos(phi_rad)\n    alpha_denom = np.sqrt(3) * (3 - sin_phi)\n    alpha = (2 * sin_phi) / alpha_denom\n    k = (6 * c * cos_phi) / alpha_denom\n    \n    sin_psi = np.sin(psi_rad)\n    if np.abs(sin_psi) > 1e-9:\n        alpha_psi_denom = np.sqrt(3) * (3 - sin_psi)\n        alpha_psi = (2 * sin_psi) / alpha_psi_denom\n    else:\n        alpha_psi = 0.0\n\n    return G, K, alpha, k, alpha_psi\n\ndef constitutive_update(sigma_n, L, dt, use_jaumann, G, K, alpha, k, alpha_psi):\n    \"\"\"\n    Performs one step of the elastoplastic constitutive update.\n\n    Args:\n        sigma_n (np.ndarray): Stress tensor at the start of the step.\n        L (np.ndarray): Velocity gradient tensor.\n        dt (float): Time step size.\n        use_jaumann (bool): Flag to use the corotational (Jaumann) rate.\n        G, K, alpha, k, alpha_psi (float): Material parameters.\n\n    Returns:\n        np.ndarray: Updated stress tensor at the end of the step.\n    \"\"\"\n    \n    # 1. Decompose velocity gradient\n    D = 0.5 * (L + L.T)\n    W = 0.5 * (L - L.T)\n    \n    # 2. Elastic trial step\n    tr_D = np.trace(D)\n    D_dev = D - (tr_D / 3.0) * np.identity(3)\n    \n    sigma_dot_el = 2 * G * D_dev + K * tr_D * np.identity(3)\n    \n    if use_jaumann:\n        jaumann_term = sigma_n @ W - W @ sigma_n\n        sigma_trial = sigma_n + (sigma_dot_el - jaumann_term) * dt\n    else:\n        sigma_trial = sigma_n + sigma_dot_el * dt\n        \n    # 3. Plasticity check\n    I1_trial = np.trace(sigma_trial)\n    s_trial = sigma_trial - (I1_trial / 3.0) * np.identity(3)\n    J2_trial = 0.5 * np.sum(s_trial * s_trial)\n\n    sqrt_J2_trial = np.sqrt(J2_trial) if J2_trial > 1e-12 else 0.0\n      \n    f_trial = alpha * I1_trial + sqrt_J2_trial - k\n    \n    # 4. Plastic corrector (if needed)\n    if f_trial > 0:\n        hardening_param = G + 9 * K * alpha * alpha_psi\n        delta_lambda = f_trial / hardening_param if hardening_param > 1e-12 else 0.0\n        \n        if sqrt_J2_trial > 1e-12:\n            s_trial_norm_factor = G / sqrt_J2_trial\n        else:\n            s_trial_norm_factor = 0.0\n\n        sigma_corr = delta_lambda * (s_trial_norm_factor * s_trial + 3 * K * alpha_psi * np.identity(3))\n        sigma_next = sigma_trial - sigma_corr\n    else:\n        sigma_next = sigma_trial\n        \n    return sigma_next\n\ndef run_test1(params):\n    G, K, alpha, k, alpha_psi = params\n    \n    sigma0 = np.diag([200.0, 100.0, 100.0])\n    omega = np.pi / 2.0\n    T = 1.0\n    dt = 0.005\n    \n    L = np.array([[0, -omega, 0], [omega,  0, 0], [0, 0, 0]])\n    \n    sigma_obj = np.copy(sigma0)\n    sigma_unc = np.copy(sigma0)\n    \n    num_steps = int(round(T / dt))\n    for _ in range(num_steps):\n        sigma_obj = constitutive_update(sigma_obj, L, dt, True, G, K, alpha, k, alpha_psi)\n        sigma_unc = constitutive_update(sigma_unc, L, dt, False, G, K, alpha, k, alpha_psi)\n\n    theta = omega * T\n    R = np.array([\n        [np.cos(theta), -np.sin(theta), 0],\n        [np.sin(theta),  np.cos(theta), 0],\n        [0,              0,             1]\n    ])\n    sigma_exact = R @ sigma0 @ R.T\n    \n    norm_err_obj = np.linalg.norm(sigma_obj - sigma_exact, 'fro')\n    norm_err_unc = np.linalg.norm(sigma_unc - sigma_exact, 'fro')\n    \n    return norm_err_obj / norm_err_unc if norm_err_unc > 1e-9 else 0.0\n\ndef run_test2(params):\n    G, K, alpha, k, alpha_psi = params\n\n    sigma0 = -100.0 * np.identity(3)\n    gamma_dot = 0.01\n    T = 50.0\n    dt = 0.1\n    \n    L = np.array([[0, gamma_dot, 0], [0, 0, 0], [0, 0, 0]])\n    \n    sigma_obj = np.copy(sigma0)\n    sigma_unc = np.copy(sigma0)\n    \n    num_steps = int(round(T / dt))\n    for _ in range(num_steps):\n        sigma_obj = constitutive_update(sigma_obj, L, dt, True, G, K, alpha, k, alpha_psi)\n        sigma_unc = constitutive_update(sigma_unc, L, dt, False, G, K, alpha, k, alpha_psi)\n\n    tau_obj = sigma_obj[0, 1]\n    tau_unc = sigma_unc[0, 1]\n    \n    return tau_obj, tau_unc\n    \ndef solve():\n    \"\"\"Main solver function to execute the test suite and print results.\"\"\"\n    \n    # Material parameters common to all tests\n    E = 3.0e4  # kPa\n    nu = 0.3\n    phi_deg = 30.0\n    psi_deg = 5.0\n    c = 5.0  # kPa\n    \n    params = calculate_material_params(E, nu, phi_deg, psi_deg, c)\n    \n    # Run tests and collect results\n    r1 = run_test1(params)\n    tau_obj, tau_unc = run_test2(params)\n    \n    # Format results to six decimal places\n    results = [round(r1, 6), round(tau_obj, 6), round(tau_unc, 6)]\n    \n    # Print in the specified single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3564053"}]}