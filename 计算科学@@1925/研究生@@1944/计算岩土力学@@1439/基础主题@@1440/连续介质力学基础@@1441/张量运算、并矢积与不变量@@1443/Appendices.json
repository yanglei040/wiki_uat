{"hands_on_practices": [{"introduction": "张量不变量是描述张量内在性质的关键标量，它们不随坐标系的旋转而改变。在将这些概念应用于复杂的物理问题之前，掌握其基本计算方法至关重要。本练习将引导你从张量的分量出发，直接计算其三个主不变量 $I_1$、$I_2$ 和 $I_3$，为后续更深入的应用打下坚实的数学基础 [@problem_id:3567001]。", "problem": "在计算地质力学中，各向同性本构模型和屈服函数通常依赖于柯西应力张量的标量不变量。考虑一个无量纲的对称二阶张量 $T$，它表示在准静态加载下通过有限元计算获得的土单元的应力状态。主不变量是 $T$ 的特征多项式的标量系数，定义为\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3},\n$$\n其中 $I$ 是二阶单位张量。从该定义和标准张量运算出发，推导 $I_{1}$、$I_{2}$ 和 $I_{3}$ 关于 $T$ 的迹、行列式以及 $T$ 的平方的迹的表达式。你的推导必须仅依赖于 $T$ 的谱表示、迹算子的性质、并矢积和弗罗贝尼乌斯内积。\n\n然后，计算以下张量的不变量：\n$$\nT=\\begin{bmatrix}3  -1  0\\\\-1  2  1\\\\0  1  1\\end{bmatrix}.\n$$\n\n使用 LaTeX 的 $\\operatorname{pmatrix}$ 环境，将最终的三元组 $(I_{1},I_{2},I_{3})$ 表示为一个行矩阵。无需四舍五入，也无需物理单位。", "solution": "该问题经评估有效。它在科学上基于张量代数和连续介质力学，问题提法恰当、客观，并包含获得唯一解所需的所有信息。\n\n该问题包括两部分：首先，推导对称二阶张量 $T$ 的主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 关于其迹、行列式及其平方的迹的表达式；其次，为一特定张量计算这些不变量。\n\n### 第1部分：不变量的推导\n\n给定一个3维空间中二阶张量 $T$ 的特征多项式：\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3}\n$$\n该多项式的根 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 是 $T$ 的特征值。因此，特征多项式可以写成其因式分解形式：\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2})(\\lambda - \\lambda_{3})\n$$\n展开此因式分解形式可得：\n$$\np(\\lambda) = (\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda + \\lambda_{1}\\lambda_{2})(\\lambda - \\lambda_{3})\n$$\n$$\np(\\lambda) = \\lambda^{3} - \\lambda_{3}\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda^{2} + (\\lambda_{1} + \\lambda_{2})\\lambda_{3}\\lambda + \\lambda_{1}\\lambda_{2}\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n$$\np(\\lambda) = \\lambda^{3} - (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})\\lambda^{2} + (\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n通过将此展开多项式的系数与给定的定义进行比较，我们用特征值确定主不变量：\n$$\nI_{1} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n$$\nI_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1}\n$$\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n下一步是将这些表达式与指定的张量运算联系起来。张量 $T$ 被说明为对称的，这保证了它具有实特征值和一组标准正交的特征向量基 $\\{n_{1}, n_{2}, n_{3}\\}$。这使得 $T$ 可以进行谱表示：\n$$\nT = \\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\n$$\n其中 $\\otimes$ 表示并矢积。\n\n**$I_{1}$ 的推导：**\n第一不变量 $I_{1}$ 是特征值之和。根据定义，这是张量 $T$ 的迹，记作 $\\operatorname{tr}(T)$。我们可以使用谱表示和迹算子的性质来证明这一点。迹是线性算子，所以：\n$$\n\\operatorname{tr}(T) = \\operatorname{tr}\\left(\\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\\right) = \\sum_{i=1}^{3} \\lambda_{i} \\operatorname{tr}(n_{i} \\otimes n_{i})\n$$\n并矢积 $u \\otimes v$ 的迹是它们的标量积，$\\operatorname{tr}(u \\otimes v) = u \\cdot v$。由于特征向量 $\\{n_{i}\\}$ 构成标准正交基，所以 $n_{i} \\cdot n_{i} = \\|n_{i}\\|^{2} = 1$。因此，$\\operatorname{tr}(n_{i} \\otimes n_{i}) = 1$。\n$$\n\\operatorname{tr}(T) = \\sum_{i=1}^{3} \\lambda_{i} (1) = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n因此，第一不变量是张量的迹：\n$$\nI_{1} = \\operatorname{tr}(T)\n$$\n\n**$I_{3}$ 的推导：**\n第三不变量 $I_{3}$ 是特征值之积。这是张量行列式的一个基本性质。\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3} = \\det(T)\n$$\n\n**$I_{2}$ 的推导：**\n第二不变量 $I_{2}$ 的推导需要更多的代数操作。我们从考虑第一不变量的平方开始：\n$$\nI_{1}^{2} = (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})^{2} = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2} + 2(\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\n$$\n识别出 $I_{2}$ 和特征值平方和的表达式，我们可以写出：\n$$\nI_{1}^{2} = \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) + 2I_{2}\n$$\n对 $I_{2}$ 重新整理：\n$$\nI_{2} = \\frac{1}{2} \\left[ I_{1}^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right] = \\frac{1}{2} \\left[ (\\operatorname{tr}(T))^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right]\n$$\n现在我们必须将特征值的平方和 $\\sum_{i=1}^{3} \\lambda_{i}^{2}$ 与一个张量运算联系起来。让我们考虑张量 $T^{2} = T \\cdot T$。$T^{2}$ 的特征值是 $T$ 特征值的平方，即 $\\lambda_{1}^{2}, \\lambda_{2}^{2}, \\lambda_{3}^{2}$。因此，$T^{2}$ 的迹是其特征值之和：\n$$\n\\operatorname{tr}(T^{2}) = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\n按要求，这可以用弗罗贝尼乌斯内积（$A:B = \\operatorname{tr}(A^{T}B)$）更正式地证明。对于对称张量 $T$，$\\operatorname{tr}(T^{2}) = \\operatorname{tr}(T^{T}T) = T:T$。弗罗贝尼乌斯内积在标准正交基变换下是不变的。在特征向量的主基 $\\{n_i\\}$ 中，张量 $T$ 由一个对角矩阵表示，其对角元为 $\\lambda_1, \\lambda_2, \\lambda_3$。在此基中，弗罗贝尼乌斯内积就是对角元平方之和：\n$$\n\\operatorname{tr}(T^{2}) = T:T = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\n将此结果代入 $I_{2}$ 的表达式中：\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})]\n$$\n推导现已完成。\n\n### 第2部分：特定张量的计算\n\n给定张量：\n$$\nT=\\begin{bmatrix}3  -1  0\\\\-1  2  1\\\\0  1  1\\end{bmatrix}\n$$\n我们使用推导出的公式计算不变量。\n\n**计算 $I_{1}$：**\n第一不变量是 $T$ 的迹。\n$$\nI_{1} = \\operatorname{tr}(T) = 3 + 2 + 1 = 6\n$$\n\n**计算 $I_{3}$：**\n第三不变量是 $T$ 的行列式。\n$$\nI_{3} = \\det(T) = 3\\begin{vmatrix} 2  1 \\\\ 1  1 \\end{vmatrix} - (-1)\\begin{vmatrix} -1  1 \\\\ 0  1 \\end{vmatrix} + 0\\begin{vmatrix} -1  2 \\\\ 0  1 \\end{vmatrix}\n$$\n$$\nI_{3} = 3(2 \\cdot 1 - 1 \\cdot 1) + 1(-1 \\cdot 1 - 0 \\cdot 1) + 0 = 3(1) + 1(-1) = 3 - 1 = 2\n$$\n\n**计算 $I_{2}$：**\n为了计算 $I_{2}$，我们首先需要求出 $T^{2}$ 及其迹。\n$$\nT^{2} = T \\cdot T = \\begin{bmatrix}3  -1  0\\\\-1  2  1\\\\0  1  1\\end{bmatrix} \\begin{bmatrix}3  -1  0\\\\-1  2  1\\\\0  1  1\\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} (3)(3)+(-1)(-1)+(0)(0)  (3)(-1)+(-1)(2)+(0)(1)  (3)(0)+(-1)(1)+(0)(1) \\\\ (-1)(3)+(2)(-1)+(1)(0)  (-1)(-1)+(2)(2)+(1)(1)  (-1)(0)+(2)(1)+(1)(1) \\\\ (0)(3)+(1)(-1)+(1)(0)  (0)(-1)+(1)(2)+(1)(1)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} 9+1  -3-2  -1 \\\\ -3-2  1+4+1  2+1 \\\\ -1  2+1  1+1 \\end{bmatrix} = \\begin{bmatrix} 10  -5  -1 \\\\ -5  6  3 \\\\ -1  3  2 \\end{bmatrix}\n$$\n$T^{2}$ 的迹是：\n$$\n\\operatorname{tr}(T^{2}) = 10 + 6 + 2 = 18\n$$\n现在我们可以计算 $I_{2}$：\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})] = \\frac{1}{2} [6^{2} - 18] = \\frac{1}{2} [36 - 18] = \\frac{1}{2} [18] = 9\n$$\n主不变量为 $I_{1}=6$，$I_{2}=9$，以及 $I_{3}=2$。\n\n最终结果是三元组 $(I_{1}, I_{2}, I_{3})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6  9  2 \\end{pmatrix}}\n$$", "id": "3567001"}, {"introduction": "在掌握了主不变量的基本计算后，下一步是将其应用于岩土力学的核心概念——应力分析。应力张量通常被分解为引起体积变化的静水应力部分和引起形状变化的偏应力部分，这两种效应由不同的不变量来量化。本练习将带你计算平均应力 $p$ 和等效偏应力 $q$，这两个量是描述材料屈服和塑性流动的关键参数 [@problem_id:3567039]。", "problem": "在三维连续介质中，一个地质材料单元内的点具有柯西应力张量 $\\boldsymbol{\\sigma}$（单位为兆帕斯卡 (MPa)），其表达式为\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}\n50  5  0\\\\\n5  45  -4\\\\\n0  -4  40\n\\end{bmatrix}.\n$$\n从计算地质力学中使用的张量分析第一性原理出发，完成以下操作：\n- 使用平均（静水）应力 $p$ 的定义，即柯西应力第一不变量的三分之一，即 $p=\\frac{1}{3}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})$。\n- 将偏应力张量定义为 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量，并将偏应力第二不变量定义为 $J_{2}=\\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$。\n- 将临界状态土力学中常用的偏应力度量定义为 $q=\\sqrt{3\\,J_{2}}$。\n\n根据这些定义以及张量缩并和并矢积的性质，推导出计算给定 $\\boldsymbol{\\sigma}$ 的 $p$ 和 $q$ 所需的表达式，然后计算 $p$ 和 $q$ 的值。将您的最终结果以有序对 $(p,q)$ 的形式表示，单位为兆帕斯卡 (MPa)。$p$ 要求精确值，$q$ 要求精确解析形式（不要四舍五入）。将您的最终答案表示为单个行向量。", "solution": "该问题经核实具有科学依据、提法明确且客观。这是连续介质力学中的一个标准练习，特别是在计算地质力学领域，涉及柯西应力张量的分解及其不变量的计算。所有给定的数据和定义都是标准且一致的。因此，我们可以进行求解。\n\n问题要求针对给定的柯西应力张量 $\\boldsymbol{\\sigma}$，计算两个应力不变量：平均（静水）应力 $p$ 和 von Mises 等效应力 $q$。求解过程将遵循问题陈述中给出的定义。\n\n给定的柯西应力张量为：\n$$\n\\boldsymbol{\\sigma} = \\begin{bmatrix}\n50  5  0\\\\\n5  45  -4\\\\\n0  -4  40\n\\end{bmatrix} \\text{ MPa}\n$$\n该张量的分量在笛卡尔坐标系中为 $\\sigma_{ij}$。\n\n首先，我们计算平均应力 $p$。它被定义为柯西应力张量第一不变量（即其迹）的三分之一。二阶张量 $\\boldsymbol{A}$ 的迹，记作 $\\operatorname{tr}(\\boldsymbol{A})$，是其对角分量之和，即 $A_{ii} = A_{11} + A_{22} + A_{33}$。\n根据所提供的定义：\n$$\np = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3} (\\sigma_{11} + \\sigma_{22} + \\sigma_{33})\n$$\n代入给定应力张量的对角分量：\n$$\np = \\frac{1}{3} (50 + 45 + 40) = \\frac{1}{3} (135) = 45 \\text{ MPa}\n$$\n\n接下来，我们确定偏应力张量 $\\boldsymbol{s}$。偏应力表示应力张量中引起形状畸变（剪切）的部分。它被定义为总应力张量减去静水应力分量：\n$$\n\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量，其分量由克罗内克δ符号 $\\delta_{ij}$ 给出。\n$$\n\\boldsymbol{I} = \\begin{bmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{bmatrix}\n$$\n使用计算出的值 $p=45$，我们有：\n$$\np\\,\\boldsymbol{I} = 45 \\begin{bmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{bmatrix} = \\begin{bmatrix}\n45  0  0\\\\\n0  45  0\\\\\n0  0  45\n\\end{bmatrix}\n$$\n现在，我们从柯西应力张量 $\\boldsymbol{\\sigma}$ 中减去这个张量：\n$$\n\\boldsymbol{s} = \\begin{bmatrix}\n50  5  0\\\\\n5  45  -4\\\\\n0  -4  40\n\\end{bmatrix} - \\begin{bmatrix}\n45  0  0\\\\\n0  45  0\\\\\n0  0  45\n\\end{bmatrix} = \\begin{bmatrix}\n50-45  5-0  0-0\\\\\n5-0  45-45  -4-0\\\\\n0-0  -4-0  40-45\n\\end{bmatrix}\n$$\n这得到了偏应力张量：\n$$\n\\boldsymbol{s} = \\begin{bmatrix}\n5  5  0\\\\\n5  0  -4\\\\\n0  -4  -5\n\\end{bmatrix} \\text{ MPa}\n$$\n作为验证，偏应力张量的迹必须为零：$\\operatorname{tr}(\\boldsymbol{s}) = 5 + 0 + (-5) = 0$。这与其定义一致。\n\n下一步是计算偏应力张量的第二不变量 $J_2$。问题将其定义为：\n$$\nJ_2 = \\frac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}\n$$\n一个张量与其自身的双点积 $\\boldsymbol{s}:\\boldsymbol{s}$ 是其所有分量平方的总和：$\\boldsymbol{s}:\\boldsymbol{s} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} s_{ij}s_{ij}$。\n使用 $\\boldsymbol{s}$ 的分量：\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = s_{11}^2 + s_{12}^2 + s_{13}^2 + s_{21}^2 + s_{22}^2 + s_{23}^2 + s_{31}^2 + s_{32}^2 + s_{33}^2\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = (5)^2 + (5)^2 + (0)^2 + (5)^2 + (0)^2 + (-4)^2 + (0)^2 + (-4)^2 + (-5)^2\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = 25 + 25 + 0 + 25 + 0 + 16 + 0 + 16 + 25 = 132\n$$\n$\\boldsymbol{s}:\\boldsymbol{s}$ 的单位是 $\\text{MPa}^2$。\n现在，我们可以计算 $J_2$：\n$$\nJ_2 = \\frac{1}{2} (132) = 66 \\text{ MPa}^2\n$$\n\n最后，我们计算偏应力度量 $q$，它与 $J_2$ 的平方根成正比，并且是塑性理论中剪应力大小的常用度量。它被定义为：\n$$\nq = \\sqrt{3 J_2}\n$$\n代入 $J_2=66$ 的值：\n$$\nq = \\sqrt{3 \\times 66} = \\sqrt{198}\n$$\n为了以精确的解析形式表示，我们简化根式。$198$ 的质因数分解为 $2 \\times 99 = 2 \\times 9 \\times 11 = 2 \\times 3^2 \\times 11$：\n$$\nq = \\sqrt{3^2 \\times 22} = 3\\sqrt{22} \\text{ MPa}\n$$\n\n所需的计算已完成。有序对 $(p, q)$ 为 $(45, 3\\sqrt{22})$，两个值的单位均为兆帕斯卡 (MPa)。", "answer": "$$\n\\boxed{\\begin{pmatrix} 45  3\\sqrt{22} \\end{pmatrix}}\n$$", "id": "3567039"}, {"introduction": "理论的精髓不仅在于计算，更在于理解其不变性的深刻含义。不变量之所以重要，正是因为它们代表了不依赖于观测者坐标系的物理现实。本练习将从计算转向验证，要求你编写程序来数值检验不变量在坐标旋转下的恒定性。通过这种计算实践，你不仅能巩固对不变性原理的理解，还能掌握验证计算模型正确性的基本方法 [@problem_id:3567010]。", "problem": "构建一个完整、可运行的程序，该程序实现一个确定性的单元测试套件，用以验证三维 ($3$) 计算岩土力学中应力张量不变量的旋转不变性。令 $Q \\in \\mathrm{SO}(3)$ 为一个旋转，柯西 (Cauchy) 应力张量为一个实对称二阶张量 $\\sigma \\in \\mathbb{R}^{3 \\times 3}$。在通过 $Q$ 进行基变换时，应力变换为 $\\sigma \\mapsto \\sigma' = Q \\sigma Q^\\top$。根据第一性原理，不变量是由 $\\sigma$ 的特征值构造的、与基无关的量，因此它们在这种变换下应保持不变。\n\n您的程序必须：\n- 实现二阶张量 $\\sigma$ 的主不变量：\n  - $I_1 = \\mathrm{tr}(\\sigma)$,\n  - $I_2 = \\tfrac{1}{2}\\big(\\mathrm{tr}(\\sigma)^2 - \\mathrm{tr}(\\sigma^2)\\big)$,\n  - $I_3 = \\det(\\sigma)$.\n- 实现平均应力 $p$、偏应力张量的第二不变量 $J_2$、应力量度 $q$ 和洛德角 (Lode angle) $\\theta$：\n  - $p = \\tfrac{1}{3} I_1$,\n  - $s = \\sigma - p\\mathbf{I}$，其中 $\\mathbf{I}$ 为单位张量，\n  - $J_2 = \\tfrac{1}{2} s:s = \\tfrac{1}{2}\\mathrm{tr}(s^2)$,\n  - $q = \\sqrt{3J_2}$,\n  - $\\theta = \\tfrac{1}{3}\\arccos\\!\\Big( \\tfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}} \\Big)$，其中 $J_3 = \\det(s)$。使用约定：如果 $J_2$ 低于一个小的正阈值，则设 $q=0$ 和 $\\theta=0$。洛德角必须以弧度计算。\n\n您必须通过多个测试用例，在数值上验证 $I_1$、$I_2$、$I_3$、$p$、$q$ 和 $\\theta$ 在变换 $\\sigma \\mapsto Q \\sigma Q^\\top$ 下保持不变，其中 $Q \\in \\mathrm{SO}(3)$ 为随机采样。随机旋转 $Q$ 的采样必须遵循 $\\mathrm{SO}(3)$ 上的哈尔 (Haar) 测度呈均匀分布。一种数值稳定的方法是：抽取一个具有独立同分布的标准正态分布条目的随机矩阵，计算其正交三角分解（通常称为正交三角或 $QR$ 分解），然后如有必要，通过翻转其中一列的符号来强制使 $\\det(Q)=+1$。\n\n在比较浮点数时，使用相对容差 $r_{\\text{tol}} = 10^{-10}$ 和绝对容差 $a_{\\text{tol}} = 10^{-12}$。角度必须以弧度为单位，并使用相同的容差进行比较。所有随机采样必须通过给定的种子实现确定性。\n\n测试套件规范：\n- 每个测试用例必须返回一个布尔值，指示该用例的所有不变性检查是否都已通过。\n- 测试套件包含以下五个用例。在每个用例中，使用提供的旋转种子和旋转次数；对于生成随机应力的用例，使用提供的应力种子。对于使用静水压力或构造应力的任何用例，只有旋转采样是随机的。\n\n用例 A（一般随机对称应力，“理想路径”）：\n- 类型：随机对称。\n- 应力种子：$42$。\n- 旋转种子：$31415$。\n- 应力数量：$4$。\n- 每个应力的旋转次数：$8$。\n- 应力尺度：$1.0$。\n\n用例 B（纯静水应力，按约定 $q=0$ 且 $\\theta=0$）：\n- 类型：静水压力。\n- 静水压力 $p$（在 $p=\\tfrac{1}{3}I_1$ 的意义上）：$[-3.0, 0.0, 5.5]$。\n- 旋转种子：$27182$。\n- 每个应力的旋转次数：$8$。\n\n用例 C（纯剪切应力，其中 $J_3=0$）：\n- 类型：纯剪切，对于列出的每个 $\\tau$，$sigma = \\begin{bmatrix}0  \\tau  0\\\\ \\tau  0  0\\\\ 0  0  0\\end{bmatrix}$。\n- 剪切值 $\\tau$：$[0.7, -2.3]$。\n- 旋转种子：$16180$。\n- 每个应力的旋转次数：$8$。\n\n用例 D（具有极小偏应力部分的近静水应力，用于探测 $J_2 \\approx 0$ 附近的数值稳定性）：\n- 类型：近静水随机。\n- 应力种子：$123$。\n- 旋转种子：$14142$。\n- 应力数量：$3$。\n- 每个应力的旋转次数：$8$。\n- 偏应力幅值尺度 $\\varepsilon = 10^{-8}$。\n- 静水压力幅值界限：从 $[-10.0, 10.0]$ 中均匀抽取 $p$。\n\n用例 E（固定对角各向异性应力）：\n- 类型：对角。\n- 对角线元素：$\\{(9.0, -4.0, 2.0), (100.0, 0.01, -1.0)\\}$。\n- 旋转种子：$17320$。\n- 每个应力的旋转次数：$8$。\n\n对于每个测试用例，执行以下操作：构建指定的应力集，采样指定数量的随机旋转 $Q \\in \\mathrm{SO}(3)$，将每个应力变换为 $\\sigma' = Q \\sigma Q^\\top$，并使用容差 $r_{\\text{tol}}$ 和 $a_{\\text{tol}}$ 比较旋转前后的 $I_1$、$I_2$、$I_3$、$p$、$q$ 和 $\\theta$ 的值。当且仅当该用例中所有应力和所有旋转的所有比较都通过时，测试用例才算通过。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$，其中每个 $\\text{result}_k$ 是对应于 A、B、C、D、E 顺序的用例的布尔值。\n- 角度必须以弧度处理。输出中无需报告物理单位。", "solution": "经评估，用户提供的问题陈述是**有效的**。它在科学上植根于连续介质力学的原理，特别是应用于计算岩土力学的张量分析。该问题是适定的，提供了确定性和可验证解所需的所有必要定义、常数和参数。其语言客观且明确。它完全属于张量运算及其不变量的指定主题范畴。\n\n任务是构建一个 Python 单元测试套件，以数值方式验证柯西 (Cauchy) 应力张量 $\\sigma$ 的特定标量不变量在坐标系的正常正交变换（旋转）下保持不变。二阶张量的变换法则是 $\\sigma' = Q \\sigma Q^\\top$，其中 $Q$ 是一个旋转矩阵，即 $Q \\in \\mathrm{SO}(3)$，意味着 $Q Q^\\top = Q^\\top Q = \\mathbf{I}$ 且 $\\det(Q) = +1$。\n\n该解通过以下步骤实现：\n1.  **不变量计算的实现**：设计一个函数，用于为任何给定的 $3 \\times 3$ 对称应力张量 $\\sigma$ 计算六个指定的不变量。\n    - 主不变量 $I_1(\\sigma)$、$I_2(\\sigma)$ 和 $I_3(\\sigma)$ 直接根据其涉及迹和行列式的定义进行计算：\n        $$ I_1 = \\mathrm{tr}(\\sigma) $$\n        $$ I_2 = \\frac{1}{2}\\left( (\\mathrm{tr}(\\sigma))^2 - \\mathrm{tr}(\\sigma^2) \\right) $$\n        $$ I_3 = \\det(\\sigma) $$\n    - 其余量由这些量和偏应力张量 $s = \\sigma - p\\mathbf{I}$ 导出，其中 $p = \\frac{1}{3}I_1$ 是平均应力。\n        - 偏应力张量的第二不变量 $J_2$ 由下式给出：\n          $$ J_2 = \\frac{1}{2} s:s = \\frac{1}{2} \\mathrm{tr}(s^2) $$\n        - von Mises 等效应力 $q$ 定义为：\n          $$ q = \\sqrt{3 J_2} $$\n        - 洛德角 $\\theta$ 是根据 $J_2$ 和第三偏应力不变量 $J_3 = \\det(s)$ 定义的：\n          $$ \\theta = \\frac{1}{3}\\arccos\\left( \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}} \\right) $$\n    - 实现的一个关键部分是处理当 $J_2$ 接近零时（即对于近静水应力状态）$q$ 和 $\\theta$ 的数值稳定性。按照规定，如果 $J_2$ 低于一个小的正阈值，则 $q$ 和 $\\theta$ 都设置为零。此阈值的一个合适选择是用于比较的绝对容差 $a_{\\text{tol}} = 10^{-12}$。此外，$\\arccos$ 函数的参数被裁剪到区间 $[-1, 1]$ 内，以防止因浮点不精确而引起的定义域错误。\n\n2.  **随机旋转矩阵的生成**：为了测试不变性，我们需要生成在哈尔 (Haar) 测度上均匀分布的随机旋转矩阵 $Q \\in \\mathrm{SO}(3)$。问题指定了一种标准且数值稳定的方法：\n    - 生成一个 $3 \\times 3$ 矩阵 $A$，其条目从独立同分布的标准正态分布中抽取。\n    - 计算 $A$ 的 QR 分解，得到 $A = QR$，其中 $Q$ 是一个正交矩阵，$R$ 是一个上三角矩阵。\n    - 正交矩阵的行列式为 $+1$ 或 $-1$。为确保 $Q$ 是一个正常旋转（即 $\\det(Q) = +1$），我们检查其行列式。如果 $\\det(Q)  0$，我们将其中的一列（例如，最后一列）乘以 $-1$。这会翻转行列式的符号，同时保持正交性，从而得到一个矩阵 $Q \\in \\mathrm{SO}(3)$。\n    - 对所需数量的旋转重复此过程，并使用指定的随机种子以确保确定性可复现性。\n\n3.  **应力张量的生成**：对于每个测试用例，都构造一组特定的应力张量。这涉及：\n    - **随机对称张量（用例 A）**：生成一个随机 $3 \\times 3$ 矩阵 $M$，通过 $\\sigma = \\frac{1}{2}(M + M^\\top)$ 形成一个对称张量，然后进行缩放。\n    - **静水张量（用例 B）**：对于给定的压力 $p$，张量为 $\\sigma = p \\mathbf{I}$。\n    - **纯剪切张量（用例 C）**：这些张量直接构造为 $\\sigma = \\begin{pmatrix} 0  \\tau  0 \\\\ \\tau  0  0 \\\\ 0  0  0 \\end{pmatrix}$。\n    - **近静水张量（用例 D）**：应力张量形成为 $\\sigma = p\\mathbf{I} + s_{\\text{dev}}$，其中 $p$ 是一个随机静水压力，$s_{\\text{dev}}$ 是一个具有极小幅值的偏应力张量，由比例因子 $\\varepsilon = 10^{-8}$ 控制。这用于探测 $J_2=0$ 附近的数值行为。\n    - **对角张量（用例 E）**：这些张量直接由一组给定的主应力构造而成，$\\sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$。\n\n4.  **验证逻辑**：测试套件的核心是一个循环，它遍历每个指定的应力张量和每个生成的旋转矩阵。对于每对 $(\\sigma, Q)$：\n    - 为原始应力张量 $\\sigma$ 计算六个不变量。\n    - 应力张量被变换：$\\sigma' = Q \\sigma Q^\\top$。\n    - 为变换后的张量 $\\sigma'$ 计算六个不变量。\n    - 将每个原始不变量与其变换后的对应物进行比较。比较使用 `numpy.allclose`，并采用指定的相对容差 $r_{\\text{tol}} = 10^{-10}$ 和绝对容差 $a_{\\text{tol}} = 10^{-12}$。\n    - 只有当该用例中的所有应力张量和所有旋转的所有不变量比较都成功时，该测试用例才被标记为通过（`True`）。如果任何单个比较失败，则整个测试用例失败（`False`）。\n\n5.  **最终输出**：将五个测试用例（A、B、C、D、E）的布尔结果收集到一个列表中，并以指定格式打印到标准输出：`[result_A,result_B,result_C,result_D,result_E]`。\n\n这种系统化的方法确保了问题的所有要求都得到满足，为应力不变量的旋转不变性这一基本原则提供了稳健且确定性的验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a deterministic unit-test suite to verify the rotational\n    invariance of stress tensor invariants.\n    \"\"\"\n    \n    TOL_REL = 1e-10\n    TOL_ABS = 1e-12\n    J2_THRESHOLD = TOL_ABS\n\n    def generate_random_rotations(num_rotations, seed):\n        \"\"\"\n        Generates random rotation matrices Q in SO(3) using the QR decomposition method.\n        The distribution is uniform with respect to the Haar measure.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        rotations = []\n        for _ in range(num_rotations):\n            A = rng.normal(size=(3, 3))\n            Q, _ = np.linalg.qr(A)\n            # Ensure Q is a proper rotation matrix (det(Q) = +1)\n            if np.linalg.det(Q)  0:\n                Q[:, -1] *= -1\n            rotations.append(Q)\n        return rotations\n\n    def create_invariants_calculator(j2_threshold):\n        \"\"\"\n        Creates a callable function that calculates the six stress invariants.\n        The j2_threshold is captured by the closure.\n        \"\"\"\n        def calculate_invariants(sigma):\n            \"\"\"\n            Calculates the principal invariants (I1, I2, I3) and derived\n            invariants (p, q, theta) for a given stress tensor.\n            \"\"\"\n            # Principal invariants\n            I1 = np.trace(sigma)\n            I2 = 0.5 * (I1**2 - np.trace(sigma @ sigma))\n            I3 = np.linalg.det(sigma)\n\n            # Mean stress and deviatoric stress tensor\n            p = I1 / 3.0\n            s = sigma - p * np.identity(3)\n\n            # Deviatoric invariants and related quantities\n            J2 = 0.5 * np.trace(s @ s)\n\n            if J2  j2_threshold:\n                q = 0.0\n                theta = 0.0\n            else:\n                q = np.sqrt(3.0 * J2)\n                J3 = np.linalg.det(s)\n                \n                # Argument for arccos, can be slightly outside [-1, 1] due to float errors\n                arg = (3.0 * np.sqrt(3.0) / 2.0) * J3 / (J2**1.5)\n                arg = np.clip(arg, -1.0, 1.0)\n                \n                theta = (1.0 / 3.0) * np.arccos(arg)\n            \n            return (I1, I2, I3, p, q, theta)\n        return calculate_invariants\n\n    invariants_calculator = create_invariants_calculator(J2_THRESHOLD)\n\n    def generate_stresses(params):\n        \"\"\"\n        Generates a list of stress tensors based on the test case parameters.\n        \"\"\"\n        stresses = []\n        case_type = params['type']\n        \n        if case_type == 'random_symmetric':\n            rng = np.random.default_rng(params['stress_seed'])\n            for _ in range(params['num_stresses']):\n                M = rng.normal(size=(3, 3))\n                sigma = 0.5 * (M + M.T) * params['stress_scale']\n                stresses.append(sigma)\n        elif case_type == 'hydrostatic':\n            for p_val in params['pressures']:\n                stresses.append(p_val * np.identity(3))\n        elif case_type == 'pure_shear':\n            for tau in params['shear_values']:\n                sigma = np.array([[0.0, tau, 0.0], [tau, 0.0, 0.0], [0.0, 0.0, 0.0]])\n                stresses.append(sigma)\n        elif case_type == 'near_hydrostatic':\n            rng = np.random.default_rng(params['stress_seed'])\n            epsilon = params['dev_scale']\n            p_bound = params['p_bound']\n            for _ in range(params['num_stresses']):\n                p_val = rng.uniform(-p_bound, p_bound)\n                \n                # Generate a random deviatoric tensor and scale it\n                S_rand = rng.normal(size=(3, 3))\n                S_rand = 0.5 * (S_rand + S_rand.T) \n                s_dev_unscaled = S_rand - (np.trace(S_rand) / 3.0) * np.identity(3)\n                \n                norm = np.linalg.norm(s_dev_unscaled)\n                if norm  1e-15:  # Avoid division by zero if tensor is accidentally zero\n                    s_dev_unscaled = np.array([[1.0, 0.0, 0.0], [0.0, -1.0, 0.0], [0.0, 0.0, 0.0]])\n                    norm = np.linalg.norm(s_dev_unscaled)\n                    \n                s_dev = epsilon * s_dev_unscaled / norm\n                sigma = p_val * np.identity(3) + s_dev\n                stresses.append(sigma)\n        elif case_type == 'diagonal':\n            for d in params['diagonals']:\n                stresses.append(np.diag(d))\n                \n        return stresses\n\n    def run_test_case(params):\n        \"\"\"\n        Runs a single test case and returns True if all checks pass, False otherwise.\n        \"\"\"\n        stresses = generate_stresses(params)\n        rotations = generate_random_rotations(params['num_rotations'], params['rotation_seed'])\n\n        for sigma in stresses:\n            original_invariants = invariants_calculator(sigma)\n            for Q in rotations:\n                sigma_prime = Q @ sigma @ Q.T\n                transformed_invariants = invariants_calculator(sigma_prime)\n\n                for orig_inv, trans_inv in zip(original_invariants, transformed_invariants):\n                    if not np.allclose(orig_inv, trans_inv, rtol=TOL_REL, atol=TOL_ABS):\n                        return False\n        return True\n\n    test_cases_spec = [\n        # Case A\n        {'type': 'random_symmetric', 'stress_seed': 42, 'rotation_seed': 31415,\n         'num_stresses': 4, 'num_rotations': 8, 'stress_scale': 1.0},\n        # Case B\n        {'type': 'hydrostatic', 'pressures': [-3.0, 0.0, 5.5],\n         'rotation_seed': 27182, 'num_rotations': 8},\n        # Case C\n        {'type': 'pure_shear', 'shear_values': [0.7, -2.3],\n         'rotation_seed': 16180, 'num_rotations': 8},\n        # Case D\n        {'type': 'near_hydrostatic', 'stress_seed': 123, 'rotation_seed': 14142,\n         'num_stresses': 3, 'num_rotations': 8, 'dev_scale': 1e-8, 'p_bound': 10.0},\n        # Case E\n        {'type': 'diagonal', 'diagonals': [(9.0, -4.0, 2.0), (100.0, 0.01, -1.0)],\n         'rotation_seed': 17320, 'num_rotations': 8}\n    ]\n\n    results = [run_test_case(params) for params in test_cases_spec]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3567010"}]}