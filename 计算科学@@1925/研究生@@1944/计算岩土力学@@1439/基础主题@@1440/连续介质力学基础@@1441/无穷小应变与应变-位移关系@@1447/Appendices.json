{"hands_on_practices": [{"introduction": "这个练习是应用应变-位移关系的基本功。通过一个给定的线性位移场，你将直接推导无限小应变张量的所有分量。这个过程不仅能加深你对正应变和剪应变的物理意义的理解，还能帮助你从数学上区分导致材料变形的应变和不产生应变的刚体运动。[@problem_id:3533545]", "problem": "一个饱和土层的均质平面应变变形可由位移场 $u_{x}=\\alpha x+\\beta y$，$u_{y}=\\gamma x+\\delta y$，$u_{z}=0$ 理想化表示，其中 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 为均匀常数，$(x,y,z)$ 为笛卡尔坐标。假设为小（无穷小）应变，从位移梯度表示的无穷小应变定义出发，推导此变形的小应变张量 $\\epsilon$ 的所有分量。然后，从均匀正应变、材料线元的剪切变形、体积应变以及任何不对 $\\epsilon$ 产生贡献的刚体运动等方面，解释每个非零分量的物理意义。\n\n以完整的 $3\\times 3$ 张量 $\\epsilon$ 形式提供最终答案，其元素用 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 的符号表示。不要四舍五入；精确表示结果，不带单位。", "solution": "问题陈述经评估，科学上合理、提法恰当且客观。它是在连续介质力学中的一个标准练习，特别是在无穷小应变理论方面。所有必要信息均已提供，问题没有矛盾或歧义。因此，我们可以进行推导和分析。\n\n在笛卡尔坐标 $(x_1, x_2, x_3)$ 中，无穷小应变张量 $\\epsilon_{ij}$ 与位移矢量场 $u_i$ 之间的关系由应变-位移关系式给出：\n$$\n\\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\n其中 $i, j \\in \\{1, 2, 3\\}$。\n\n给定的位移场为：\n$u_x = u_1 = \\alpha x + \\beta y$\n$u_y = u_2 = \\gamma x + \\delta y$\n$u_z = u_3 = 0$\n\n在此，我们将坐标 $(x,y,z)$ 分别与 $(x_1, x_2, x_3)$ 对应。首先，我们计算位移梯度张量 $H_{ij} = \\frac{\\partial u_i}{\\partial x_j}$ 的分量：\n\n$\\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\frac{\\partial u_x}{\\partial y} = \\beta$\n$\\frac{\\partial u_x}{\\partial z} = 0$\n\n$\\frac{\\partial u_y}{\\partial x} = \\gamma$\n$\\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\frac{\\partial u_y}{\\partial z} = 0$\n\n$\\frac{\\partial u_z}{\\partial x} = 0$\n$\\frac{\\partial u_z}{\\partial y} = 0$\n$\\frac{\\partial u_z}{\\partial z} = 0$\n\n因此，位移梯度张量 $\\nabla \\mathbf{u}$ 为：\n$$\n\\nabla \\mathbf{u} =\n\\begin{pmatrix}\n\\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y}  \\frac{\\partial u_x}{\\partial z} \\\\\n\\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y}  \\frac{\\partial u_y}{\\partial z} \\\\\n\\frac{\\partial u_z}{\\partial x}  \\frac{\\partial u_z}{\\partial y}  \\frac{\\partial u_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha  \\beta  0 \\\\\n\\gamma  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n无穷小应变张量 $\\epsilon$ 是位移梯度张量的对称部分，$\\epsilon = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$。我们现在显式地计算其分量。\n\n对角分量（正应变）为：\n$\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = 0$\n\n非对角分量（剪应变）为：\n$\\epsilon_{xy} = \\epsilon_{yx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} (\\beta + \\gamma)$\n$\\epsilon_{xz} = \\epsilon_{zx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} \\right) = \\frac{1}{2} (0 + 0) = 0$\n$\\epsilon_{yz} = \\epsilon_{zy} = \\frac{1}{2} \\left( \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} \\right) = \\frac{1}{2} (0 + 0) = 0$\n\n将这些分量组合成一个 $3 \\times 3$ 矩阵，无穷小应变张量 $\\epsilon$ 为：\n$$\n\\epsilon =\n\\begin{pmatrix}\n\\alpha  \\frac{1}{2}(\\beta+\\gamma)  0 \\\\\n\\frac{1}{2}(\\beta+\\gamma)  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\n接下来，我们解释各分量及相关量的物理意义。\n\n**非零应变分量的物理解释：**\n- $\\epsilon_{xx} = \\alpha$：这是沿 $x$ 轴的正应变。它表示初始平行于 $x$ 轴的材料线元的长度变化率。\n- $\\epsilon_{yy} = \\delta$：这是沿 $y$ 轴的正应变，表示初始平行于 $y$ 轴的材料线元的长度变化率。\n- $\\epsilon_{xy} = \\frac{1}{2}(\\beta+\\gamma)$：这是 $x-y$ 平面内的张量剪应变分量。工程剪应变 $\\gamma_{xy}$ 度量了初始沿 $x$ 轴和 $y$ 轴的两个垂直线元之间角度的变化，其值为 $\\gamma_{xy} = 2 \\epsilon_{xy} = \\beta + \\gamma$。该分量量化了材料在 $x-y$ 平面内的剪切变形。\n\n值为零的分量（$\\epsilon_{zz}$、$\\epsilon_{xz}$、$\\epsilon_{yz}$）与“平面应变”条件一致，该条件规定在 $z$ 方向上或包含 $z$ 轴的平面内没有变形。\n\n**体积应变：**\n体积应变，或称体胀 $\\epsilon_V$，是应变张量的迹，$\\epsilon_V = \\text{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$。它度量了体积的变化率。对于此变形：\n$$\n\\epsilon_V = \\alpha + \\delta + 0 = \\alpha + \\delta\n$$\n这表明材料单元的体积会发生变化，除非 $\\alpha = -\\delta$，这种情况对应于 $x-y$ 平面内的等体积（体积保持不变）变形。\n\n**刚体运动：**\n位移梯度张量 $\\nabla \\mathbf{u}$ 可以分解为一个对称的应变张量 $\\epsilon$ 和一个反对称（或斜对称）的自旋（或旋转）张量 $\\Omega$：$\\nabla \\mathbf{u} = \\epsilon + \\Omega$。自旋张量 $\\Omega$ 描述了材料的局部无穷小刚体转动，这种转动不对应变产生贡献。其计算公式为 $\\Omega = \\frac{1}{2}(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^T)$。\n$$\n\\Omega = \\frac{1}{2} \\left[\n\\begin{pmatrix}\n\\alpha  \\beta  0 \\\\\n\\gamma  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n\\alpha  \\gamma  0 \\\\\n\\beta  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\right]\n=\n\\frac{1}{2}\n\\begin{pmatrix}\n0  \\beta - \\gamma  0 \\\\\n\\gamma - \\beta  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  \\frac{1}{2}(\\beta - \\gamma)  0 \\\\\n-\\frac{1}{2}(\\beta - \\gamma)  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n非零分量 $\\Omega_{xy} = \\frac{1}{2}(\\beta - \\gamma)$ 代表了绕 $z$ 轴的无穷小刚体转动。如果 $\\beta = \\gamma$，则流动是无旋的，该剪切被称为“纯剪切”。如果 $\\beta \\neq \\gamma$，则变形包含一个旋转分量。这种刚体转动是整体运动的一部分，但根据定义，它不会引起材料的任何应变。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha  \\frac{1}{2}(\\beta+\\gamma)  0 \\\\\n\\frac{1}{2}(\\beta+\\gamma)  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n}\n$$", "id": "3533545"}, {"introduction": "在掌握了基本关系之后，我们来探究一个重要的特定变形模式：纯剪切。这个问题将引导你计算一个处于纯剪切状态下的土体单元的主应变，即应变张量的特征值。通过验证其体积应变为零，你将加深对等容变形（isochoric deformation）的理解，这对于模拟不可压缩材料（如不排水条件下的饱和土）的行为至关重要。[@problem_id:3533567]", "problem": "考虑一个三维 (3D) 空间中的均质土单元，其经历了一个由位移场 $u_{x}(x,y,z)=\\kappa\\,y$，$u_{y}(x,y,z)=\\kappa\\,x$ 和 $u_{z}(x,y,z)=0$ 表征的运动学施加的变形，其中 $\\kappa0$ 是一个常数参数。在小应变情况下，该位移产生一种通常被称为“纯剪切”的状态，其剪应变分量 $ \\epsilon_{xy} $ 非零，而正应变分量 $ \\epsilon_{xx} $，$ \\epsilon_{yy} $ 和 $ \\epsilon_{zz} $ 为零。使用适用于计算岩土力学的无穷小应变和应变-位移关系，确定主应变并验证体积应变为零。按 $ \\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3} $ 的顺序给出三个主应变，然后给出体积应变 $ \\epsilon_{v} $。由于应变是无量纲的，请用不带单位的方式表示您的最终答案。无需进行数值舍入；请给出精确的符号值。将最终答案表示为包含按指定顺序排列的四个量的单行矩阵。", "solution": "合适的出发点是根据位移梯度定义无穷小（小）应变张量。对于分量为 $u_{i}$ 的位移场，无穷小应变张量的分量为\n$$\n\\epsilon_{ij}=\\frac{1}{2}\\left(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{j}}{\\partial x_{i}}\\right),\n$$\n且体积应变为应变张量的迹，\n$$\n\\epsilon_{v}=\\epsilon_{xx}+\\epsilon_{yy}+\\epsilon_{zz}.\n$$\n给定位移场 $u_{x}=\\kappa\\,y$，$u_{y}=\\kappa\\,x$ 和 $u_{z}=0$，我们计算所需的空间导数：\n$$\n\\frac{\\partial u_{x}}{\\partial x}=0,\\quad \\frac{\\partial u_{x}}{\\partial y}=\\kappa,\\quad \\frac{\\partial u_{x}}{\\partial z}=0,\n$$\n$$\n\\frac{\\partial u_{y}}{\\partial x}=\\kappa,\\quad \\frac{\\partial u_{y}}{\\partial y}=0,\\quad \\frac{\\partial u_{y}}{\\partial z}=0,\n$$\n$$\n\\frac{\\partial u_{z}}{\\partial x}=0,\\quad \\frac{\\partial u_{z}}{\\partial y}=0,\\quad \\frac{\\partial u_{z}}{\\partial z}=0.\n$$\n代入小应变定义，得到应变分量：\n$$\n\\epsilon_{xx}=\\frac{1}{2}\\left(\\frac{\\partial u_{x}}{\\partial x}+\\frac{\\partial u_{x}}{\\partial x}\\right)=0,\n$$\n$$\n\\epsilon_{yy}=\\frac{1}{2}\\left(\\frac{\\partial u_{y}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial y}\\right)=0,\n$$\n$$\n\\epsilon_{zz}=\\frac{1}{2}\\left(\\frac{\\partial u_{z}}{\\partial z}+\\frac{\\partial u_{z}}{\\partial z}\\right)=0,\n$$\n$$\n\\epsilon_{xy}=\\frac{1}{2}\\left(\\frac{\\partial u_{x}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial x}\\right)=\\frac{1}{2}\\left(\\kappa+\\kappa\\right)=\\kappa,\n$$\n且所有其他涉及 $z$ 的剪切分量均为零：\n$$\n\\epsilon_{xz}=\\frac{1}{2}\\left(\\frac{\\partial u_{x}}{\\partial z}+\\frac{\\partial u_{z}}{\\partial x}\\right)=0,\\quad\n\\epsilon_{yz}=\\frac{1}{2}\\left(\\frac{\\partial u_{y}}{\\partial z}+\\frac{\\partial u_{z}}{\\partial y}\\right)=0.\n$$\n因此，矩阵形式的应变张量为\n$$\n\\boldsymbol{\\epsilon}=\\begin{pmatrix}\n0  \\kappa  0 \\\\\n\\kappa  0  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n主应变是对称张量 $\\boldsymbol{\\epsilon}$ 的特征值。我们通过求解\n$$\n\\det\\!\\left(\\boldsymbol{\\epsilon}-\\lambda\\,\\mathbf{I}\\right)=0.\n$$\n来计算特征值。特征多项式由下式得到\n$$\n\\det\\!\\begin{pmatrix}\n-\\lambda  \\kappa  0 \\\\\n\\kappa  -\\lambda  0 \\\\\n0  0  -\\lambda\n\\end{pmatrix}\n=(-\\lambda)\\,\\det\\!\\begin{pmatrix}\n-\\lambda  \\kappa \\\\\n\\kappa  -\\lambda\n\\end{pmatrix}\n=(-\\lambda)\\left(\\lambda^{2}-\\kappa^{2}\\right).\n$$\n因此，特征值求解 $(-\\lambda)\\left(\\lambda^{2}-\\kappa^{2}\\right)=0$ 可得\n$$\n\\lambda\\in\\{\\kappa,\\,-\\kappa,\\,0\\}。\n$$\n由于 $\\kappa0$，将它们从大到小排序得到\n$$\n\\lambda_{1}=\\kappa,\\quad \\lambda_{2}=0,\\quad \\lambda_{3}=-\\kappa。\n$$\n最后，体积应变等于 $\\boldsymbol{\\epsilon}$ 的迹，\n$$\n\\epsilon_{v}=\\epsilon_{xx}+\\epsilon_{yy}+\\epsilon_{zz}=0+0+0=0,\n$$\n这验证了对于此剪切变形，体积应变为零。\n\n将所求的量按指定顺序（三个主应变按降序排列，后跟 $\\epsilon_{v}$）收集起来，我们得到行向量\n$$\n\\begin{pmatrix}\n\\kappa  0  -\\kappa  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\kappa  0  -\\kappa  0\\end{pmatrix}}$$", "id": "3533567"}, {"introduction": "从解析练习过渡到计算验证是计算地球力学的核心技能。本练习将通过一个经典的“分片检验”（patch test）来验证有限元（FEM）列式的正确性。你将通过编程检验一个由线性单元组成的网格能否精确再现一个恒定应变场，这是保证有限元方法收敛性的一个基本要求。[@problem_id:3533534]", "problem": "考虑在有限元方法 (FEM) 中使用线性三角形单元进行二维小应变分片检验。对于位移场分量为 $u(x,y)$ 和 $v(x,y)$ 的点，其无穷小应变张量由对称梯度定义：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right),\n$$\n其中位移向量为 $\\boldsymbol{u} = [u,v]^{\\mathsf{T}}$，应变分量为 $ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\ \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\ \\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$。常应变三角形 (CST) 单元是一种线性三角形单元，在线性位移场下，其形函数能在每个单元内产生一个常应变场。\n\n您必须为一个覆盖单位正方形、由 $2$ 个线性三角形单元组成的网格演示分片检验。节点坐标（单位：米）如下：\n- 节点 $1$：$(0,0)$，\n- 节点 $2$：$(1,0)$，\n- 节点 $3$：$(1,1)$，\n- 节点 $4$：$(0,1)$。\n\n单元连接关系为：\n- 单元 $1$：$(1,2,3)$，\n- 单元 $2$：$(1,3,4)$。\n\n对于一个分量为 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 的均匀目标小应变场、一个以米为单位的刚体平移 $\\boldsymbol{t} = (t_x, t_y)$ 以及一个以弧度为单位的小角度刚体转动 $\\theta$，通过叠加这些运动学贡献来定义节点位移场：\n$$\nu(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x, \\quad v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y.\n$$\n该场将对称应变与刚体部分（平移和转动）分离开来。在无穷小应变假设下，刚体部分不得对应变 $\\boldsymbol{\\varepsilon}$ 产生贡献。\n\n您的程序必须：\n- 使用从单元的线性形函数导出的应变-位移关系，计算每个单元中的应变。\n- 对每个测试用例，验证所计算的单元应变在每个单元的每个应变分量上均在绝对容差 $\\tau = 10^{-12}$ 内等于目标均匀应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$。\n- 为每个测试用例返回一个布尔值，指示分片中的两个单元是否都通过了检验（即，所有分量级比较都在容差范围内满足要求）。\n\n使用以下四个参数集设计测试套件：\n- 测试用例 $1$ (一般常应变，无刚体运动)：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$, $\\boldsymbol{t} = (0,0)$, $\\theta = 0$。\n- 测试用例 $2$ (一般常应变加刚体平移)：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$, $\\boldsymbol{t} = (3\\times 10^{-1}, -10^{-1})$, $\\theta = 0$。\n- 测试用例 $3$ (纯刚体转动，零应变)：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (0,0,0)$, $\\boldsymbol{t} = (0,0)$, $\\theta = 2\\times 10^{-2}$。\n- 测试用例 $4$ (极小常应变，无刚体运动)：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-12}, -10^{-12}, 5\\times 10^{-13})$, $\\boldsymbol{t} = (0,0)$, $\\theta = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是一个布尔值，指示测试用例 $i$ 是否通过了分片检验。", "solution": "该问题要求对一个由两个线性三角形单元组成的二维网格执行分片检验。分片检验是有限元方法 (FEM) 中的一个基本验证工具，用于确保单元列式能够精确再现常应变状态，这是收敛的一个必要条件。\n\n该检验的核心原理是在一个单元片上施加一个线性位移场。线性位移场对应于一个常应变场。然后使用 FEM 程序根据指定的节点位移计算每个单元内的应变。如果单元列式正确，每个单元中计算出的应变必须等于推导出位移时所用的常应变。只要运动与底层的小应变/小转动假设一致，无论网格几何形状和任何叠加的刚体运动（平移和转动）如何，这一结论都必须成立。\n\n问题将线性位移场 $(\\boldsymbol{u})$ 定义为一个常应变状态 $(\\boldsymbol{\\varepsilon})$ 和一个小刚体运动（平移 $\\boldsymbol{t}$ 和转动角 $\\theta$）的叠加。点 $(x,y)$ 处的位移分量 $u(x,y)$ 和 $v(x,y)$ 由以下公式给出：\n$$ u(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x $$\n$$ v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y $$\n此处，$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 是目标常应变张量的分量，$(t_x, t_y)$ 是刚体平移向量的分量，$\\theta$ 是小角度刚体转动角。从解析上讲，从此位移场导出的无穷小应变分量确实是 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\varepsilon_{xy}$，因为刚体运动项对应变没有贡献。\n\n解决方案通过实现常应变三角形 (CST) 单元（也称为线性三角形单元）的标准 FEM 应变计算来推进。对于一个节点 $i, j, k$ 坐标分别为 $(x_i, y_i)$、$(x_j, y_j)$ 和 $(x_k, y_k)$ 的 CST 单元，其内部的位移场由节点位移线性插值得到。这种线性插值导致整个单元内产生一个常应变场。\n\n单元的应变向量 $\\boldsymbol{\\varepsilon}^e$ 和其节点位移向量 $\\boldsymbol{d}^e$ 之间的关系由以下矩阵方程给出：\n$$ \\boldsymbol{\\varepsilon}^e = \\boldsymbol{B} \\boldsymbol{d}^e $$\n在我们的二维情况下，一个三节点单元的节点位移向量是 $\\boldsymbol{d}^e = [u_i, v_i, u_j, v_j, u_k, v_k]^{\\mathsf{T}}$。使用工程剪应变定义 $\\gamma_{xy} = 2\\varepsilon_{xy}$，应变向量为 $\\boldsymbol{\\varepsilon}^e = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$。应变-位移矩阵 $\\boldsymbol{B}$ 是节点坐标的函数：\n$$\n\\boldsymbol{B} = \\frac{1}{2A}\n\\begin{bmatrix}\ny_j-y_k  0  y_k-y_i  0  y_i-y_j  0 \\\\\n0  x_k-x_j  0  x_i-x_k  0  x_j-x_i \\\\\nx_k-x_j  y_j-y_k  x_i-x_k  y_k-y_i  x_j-x_i  y_i-y_j\n\\end{bmatrix}\n$$\n其中 $A$ 是单元的面积，计算公式为 $2A = x_i(y_j - y_k) + x_j(y_k - y_i) + x_k(y_i - y_j)$。为确保公式正确，节点 $i, j, k$ 必须按逆时针顺序排列。\n\n解决该问题的算法如下：\n1.  定义网格几何：存储节点 $1, 2, 3, 4$ 的节点坐标以及单元 $1$ 和 $2$ 的单元连接关系。给定的连接关系，单元 $1$ 为 $(1,2,3)$，单元 $2$ 为 $(1,3,4)$，均为逆时针顺序，确保面积计算为正。\n2.  遍历提供的四个测试用例。对每个用例：\n    a. 定义目标应变 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$、平移 $(t_x, t_y)$ 和转动 $\\theta$ 的参数。\n    b. 使用解析位移场方程计算网格中四个节点的精确节点位移 ($u_i, v_i$）。\n    c. 对于分片中的两个单元中的每一个：\n        i. 检索其三个节点的坐标。\n        ii. 使用这些坐标构建应变-位移矩阵 $\\boldsymbol{B}$。两个单元的面积 $A$ 均为 $0.5$ 平方米。\n        iii. 从预先计算的全局节点位移中组装单元的节点位移向量 $\\boldsymbol{d}^e$。\n        iv. 通过矩阵-向量乘积 $\\boldsymbol{B} \\boldsymbol{d}^e$ 计算单元内的常应变向量。这将得到工程应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})$。通过除以 $2$ 将工程剪应变 $\\gamma_{xy}$ 转换为张量剪应变 $\\varepsilon_{xy}$。\n        v. 将计算出的三个应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 与当前测试用例各自的目标值进行比较。比较使用绝对容差 $\\tau = 10^{-12}$。\n3.  只有当*两个*单元中的所有三个应变分量都在指定容差内与其目标值匹配时，测试用例才被视为“通过”(True)。如果任何比较失败，则该测试用例标记为“失败”(False)。\n4.  收集所有四个测试用例的布尔结果，并将其格式化为所需的输出字符串。\n\n此过程严格验证了 CST 单元列式能正确再现位移场中的常应变部分，同时对刚体运动不敏感，这是一个被称为 C0-完备性的关键属性，对于单元通过分片检验至关重要。该实现使用 `numpy` 库来高效处理矩阵和向量运算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a 2D patch test for a mesh of two linear triangular elements.\n    \"\"\"\n    # Global definitions for the mesh\n    nodal_coords = {\n        1: (0.0, 0.0),\n        2: (1.0, 0.0),\n        3: (1.0, 1.0),\n        4: (0.0, 1.0)\n    }\n\n    element_connectivity = {\n        1: (1, 2, 3),  # CCW order\n        2: (1, 3, 4)   # CCW order\n    }\n\n    # Test cases: (eps_xx, eps_yy, eps_xy, t_x, t_y, theta)\n    test_cases = [\n        (1e-2, -2e-2, 5e-3, 0.0, 0.0, 0.0),\n        (1e-2, -2e-2, 5e-3, 3e-1, -1e-1, 0.0),\n        (0.0, 0.0, 0.0, 0.0, 0.0, 2e-2),\n        (1e-12, -1e-12, 5e-13, 0.0, 0.0, 0.0)\n    ]\n\n    tolerance = 1e-12\n    results = []\n\n    def calculate_element_strain(element_node_ids, all_coords, all_displacements):\n        \"\"\"\n        Calculates the constant strain tensor for a single linear triangular element.\n        \"\"\"\n        # 1. Get nodal coordinates for the element\n        n_i, n_j, n_k = element_node_ids\n        (xi, yi), (xj, yj), (xk, yk) = all_coords[n_i], all_coords[n_j], all_coords[n_k]\n\n        # 2. Calculate 2 * Area. Given connectivity is CCW, so area is positive.\n        two_A = xi * (yj - yk) + xj * (yk - yi) + xk * (yi - yj)\n        if abs(two_A)  1e-15:\n            raise ValueError(\"Degenerate element with zero area.\")\n        \n        # 3. Form the strain-displacement matrix B\n        B_matrix = (1.0 / two_A) * np.array([\n            [yj - yk, 0, yk - yi, 0, yi - yj, 0],\n            [0, xk - xj, 0, xi - xk, 0, xj - xi],\n            [xk - xj, yj - yk, xi - xk, yk - yi, xj - xi, yi - yj]\n        ])\n\n        # 4. Form the element nodal displacement vector d_e\n        (ui, vi), (uj, vj), (uk, vk) = all_displacements[n_i], all_displacements[n_j], all_displacements[n_k]\n        d_e = np.array([ui, vi, uj, vj, uk, vk])\n\n        # 5. Calculate engineering strain vector [exx, eyy, gxy]\n        eng_strain = B_matrix @ d_e\n\n        # 6. Convert to tensor strain [exx, eyy, exy] and return\n        tensor_strain = np.array([eng_strain[0], eng_strain[1], eng_strain[2] / 2.0])\n        return tensor_strain\n\n    for case in test_cases:\n        eps_xx_target, eps_yy_target, eps_xy_target, tx, ty, theta = case\n        target_strain = np.array([eps_xx_target, eps_yy_target, eps_xy_target])\n\n        # Calculate displacements for all nodes based on the analytical field\n        all_nodal_displacements = {}\n        for node_id, (x, y) in nodal_coords.items():\n            u = eps_xx_target * x + eps_xy_target * y - theta * y + tx\n            v = eps_xy_target * x + eps_yy_target * y + theta * x + ty\n            all_nodal_displacements[node_id] = (u, v)\n\n        case_passed = True\n        for elem_id, node_ids in element_connectivity.items():\n            # Compute strain for the current element\n            computed_strain = calculate_element_strain(\n                node_ids, nodal_coords, all_nodal_displacements\n            )\n            \n            # Verify if computed strain matches target strain within tolerance\n            # Use rtol=0 because target strains can be zero.\n            if not np.allclose(computed_strain, target_strain, rtol=0, atol=tolerance):\n                case_passed = False\n                break  # If one element fails, the whole patch test case fails\n\n        results.append(case_passed)\n\n    # Format and print the final results as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3533534"}]}