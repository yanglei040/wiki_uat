{"hands_on_practices": [{"introduction": "物质导数的定义在本质上是独立于坐标系的，它描述了随物质点移动的物理量的变化率。然而，在解决实际问题时，我们经常需要在特定的坐标系（如柱坐标或球坐标）中表达它。本练习 [@problem_id:3542145] 将指导您从基本定义出发，在球坐标系中推导物质导数的表达式，并展示对称性假设如何极大地简化其形式，最终揭示其与一维笛卡尔坐标系下表达式的内在联系。", "problem": "考虑一个三维饱和多孔固体，其中存在球对称的径向渗流，其孔隙流体速度场为纯径向，由 $\\mathbf{v}(\\mathbf{x},t)=v_{r}(r,t)\\,\\mathbf{e}_{r}$ 给出，其中 $(r,\\theta,\\varphi)$ 是球坐标，$\\mathbf{e}_{r}$ 是径向单位向量，且 $r=|\\mathbf{x}|$。设 $\\phi(\\mathbf{x},t)$ 是随流体输运的孔隙流体的一种标量物质属性（例如，溶解示踪剂的浓度）。假设该标量场具有球对称性，因此 $\\phi(\\mathbf{x},t)=\\phi(r,t)$。\n\n仅从物质（或随体）时间导数的定义（即跟随一个物质粒子的时间变化率）\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t),\n$$\n以及用球坐标 $\\mathbf{x}(t)\\leftrightarrow\\big(r(t),\\theta(t),\\varphi(t)\\big)$ 表示的粒子轨迹运动学出发，完成以下任务：\n\n1. 使用链式法则和球坐标 $\\big(r,\\theta,\\varphi\\big)$，将 $\\frac{D\\phi}{Dt}$ 用 $\\frac{\\partial \\phi}{\\partial t}$、$\\phi$ 对 $r$、$\\theta$ 和 $\\varphi$ 的偏导数，以及坐标的时间变化率 $\\dot{r}$、$\\dot{\\theta}$ 和 $\\dot{\\varphi}$ 表示出来。\n\n2. 将你的表达式应用于给定的具有纯径向流的球对称设定，并从运动学角度论证哪些坐标的时间变化率沿着轨迹为零。然后，得到 $\\frac{D\\phi}{Dt}$ 关于 $\\frac{\\partial \\phi}{\\partial t}$、$v_{r}(r,t)$ 和 $\\frac{\\partial \\phi}{\\partial r}$ 的显式闭合形式表达式。\n\n3. 引入沿径向线的一维笛卡尔坐标映射 $s=r$、一维速度 $u(s,t)=v_{r}(r,t)$ 和标量场 $\\psi(s,t)=\\phi(r,t)$。使用这些定义，证明你在步骤2中得到的表达式与标量场的标准一维笛卡尔物质导数在形式上一致。\n\n将你的最终答案表示为 $\\frac{D\\phi}{Dt}$ 关于 $\\frac{\\partial \\phi}{\\partial t}$、$v_{r}$ 和 $\\frac{\\partial \\phi}{\\partial r}$ 的单个闭合形式解析表达式。无需单位，也无需进行数值计算。", "solution": "该问题是有效的，因为它在科学上基于连续介质力学，是适定、客观且内部一致的。它提出了一个在特定曲线坐标系和对称性约束下关于物质时间导数的标准推导练习。我将按顺序完成这三个任务来解答。\n\n第一个任务是在球坐标中推导物质（或随体）时间导数 $\\frac{D\\phi}{Dt}$ 的一般表达式。其定义是标量场 $\\phi$ 跟随物质粒子轨迹 $\\mathbf{x}(t)$ 的全时间导数：\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t)\n$$\n在球坐标 $(r, \\theta, \\varphi)$ 中，粒子的位置由时间函数描述，$\\mathbf{x}(t) \\leftrightarrow \\big(r(t), \\theta(t), \\varphi(t)\\big)$。标量场 $\\phi$ 通常是这些坐标和时间的函数，即 $\\phi = \\phi(r, \\theta, \\varphi, t)$。为了求出 $\\phi\\big(r(t), \\theta(t), \\varphi(t), t\\big)$ 关于时间 $t$ 的全导数，我们应用多元链式法则：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t}\\frac{dt}{dt} + \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{dt} + \\frac{\\partial \\phi}{\\partial \\theta}\\frac{d\\theta}{dt} + \\frac{\\partial \\phi}{\\partial \\varphi}\\frac{d\\varphi}{dt}\n$$\n鉴于 $\\frac{dt}{dt}=1$，并使用点记法表示坐标的时间导数，即 $\\dot{r} \\equiv \\frac{dr}{dt}$、$\\dot{\\theta} \\equiv \\frac{d\\theta}{dt}$ 和 $\\dot{\\varphi} \\equiv \\frac{d\\varphi}{dt}$，表达式变为：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\dot{r}\\frac{\\partial \\phi}{\\partial r} + \\dot{\\theta}\\frac{\\partial \\phi}{\\partial \\theta} + \\dot{\\varphi}\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\n这就是在球坐标中物质导数的一般表达式，从而完成了第一个任务。\n\n第二个任务要求将此表达式应用于给定的具有纯径向流的球对称设定。根据定义，流体速度矢量 $\\mathbf{v}$ 是粒子位置矢量的时间导数，即 $\\mathbf{v} = \\frac{d\\mathbf{x}}{dt}$。在球坐标中，速度矢量与坐标的时间变化率关系如下：\n$$\n\\mathbf{v} = \\dot{r}\\,\\mathbf{e}_{r} + (r\\dot{\\theta})\\,\\mathbf{e}_{\\theta} + (r\\sin\\theta\\,\\dot{\\varphi})\\,\\mathbf{e}_{\\varphi}\n$$\n其中 $\\mathbf{e}_{r}$、$\\mathbf{e}_{\\theta}$ 和 $\\mathbf{e}_{\\varphi}$ 是标准正交基矢量。问题陈述流是纯径向的，由 $\\mathbf{v}(\\mathbf{x}, t) = v_{r}(r,t)\\mathbf{e}_{r}$ 给出。为了从运动学上满足这个条件，我们必须将一般速度表达式的分量与给定的表达式分量等同起来：\n\\begin{itemize}\n    \\item 径向分量：$\\dot{r} = v_{r}(r,t)$。\n    \\item 极向分量：$r\\dot{\\theta} = 0$。\n    \\item 方位角分量：$r\\sin\\theta\\,\\dot{\\varphi} = 0$。\n\\end{itemize}\n对于不在原点的粒子（$r > 0$），条件 $r\\dot{\\theta} = 0$ 意味着 $\\dot{\\theta} = 0$。对于不在极轴（$z$轴，此处$\\sin\\theta = 0$）上的粒子，条件 $r\\sin\\theta\\,\\dot{\\varphi} = 0$ 意味着 $\\dot{\\varphi} = 0$。因此，从运动学上看，纯径向流要求运动中流体粒子的角坐标保持不变，所以它们的时间变化率 $\\dot{\\theta}$ 和 $\\dot{\\varphi}$ 为零。\n\n此外，标量场 $\\phi$ 也是球对称的，$\\phi(\\mathbf{x},t) = \\phi(r,t)$，这意味着它与 $\\theta$ 和 $\\varphi$ 无关。因此，它对角坐标的偏导数为零：$\\frac{\\partial\\phi}{\\partial\\theta} = 0$ 和 $\\frac{\\partial\\phi}{\\partial\\varphi} = 0$。\n\n将运动学结果 $\\dot{r} = v_{r}$、$\\dot{\\theta} = 0$ 和 $\\dot{\\varphi} = 0$ 代入 $\\frac{D\\phi}{Dt}$ 的一般表达式中：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r} + (0)\\frac{\\partial \\phi}{\\partial \\theta} + (0)\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\n表达式化简为所要求的闭合形式：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r}\n$$\n\n第三个任务是使用给定的映射：$s=r$、$u(s,t)=v_{r}(r,t)$ 和 $\\psi(s,t)=\\phi(r,t)$，证明这个结果与一维笛卡尔物质导数在形式上是等价的。在一个具有坐标 $s$ 和速度 $u(s,t)$ 的一维笛卡尔系统中，标量场 $\\psi(s,t)$ 的物质导数是：\n$$\n\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + u(s,t) \\frac{\\partial \\psi}{\\partial s}\n$$\n这种形式源于一般定义 $\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\psi$，其中在一维情况下，$\\mathbf{v} = u(s,t)\\mathbf{e}_{s}$ 且 $\\nabla = \\mathbf{e}_{s}\\frac{\\partial}{\\partial s}$。现在，我们将给定的映射应用于这个方程：\n\\begin{itemize}\n    \\item 由于 $\\psi(s,t) = \\phi(r(s),t)$ 且 $r=s$，保持 $s$ 不变等同于保持 $r$ 不变，所以 $\\frac{\\partial \\psi}{\\partial t} = \\frac{\\partial \\phi}{\\partial t}$。\n    \\item 根据定义，$u(s,t) = v_{r}(r,t)$。\n    \\item 根据链式法则，$\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{ds}$。因为 $s=r$，所以 $\\frac{dr}{ds}=1$，故 $\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}$。\n\\end{itemize}\n将这些等价关系代回 $\\frac{D\\psi}{Dt}$ 的一维笛卡尔表达式中，得到：\n$$\n\\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t) \\frac{\\partial \\phi}{\\partial r}\n$$\n这个结果与第二个任务中推导出的 $\\frac{D\\phi}{Dt}$ 表达式完全相同。这表明，纯径向流对球对称场的平流在数学上类似于沿直线的一维平流问题。最终要求的表达式是第二个任务的结果。", "answer": "$$\n\\boxed{\\frac{\\partial \\phi}{\\partial t} + v_{r} \\frac{\\partial \\phi}{\\partial r}}\n$$", "id": "3542145"}, {"introduction": "将运动学与材料本构关系联系起来的一个核心原则是客观性原理，即物理定律不应依赖于观察者的参考系。对于大变形问题，这意味着本构模型必须使用客观应力率，这些应力率旨在测量由材料变形引起的应力变化。本练习 [@problem_id:3542215] 通过分析一个纯刚体转动（无变形）的基准案例，要求您证明几个标准的客观应力率（如Zaremba–Jaumann率）为零，从而深刻理解物质导数在构造客观率和确保本构模型物理一致性中的关键作用。", "problem": "考虑一个模拟圆形隧道衬砌无变形旋转的刚体运动。设空间位置由$\\boldsymbol{x}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{X} + \\boldsymbol{c}(t)$给出，其中$\\boldsymbol{R}(t) \\in \\mathbb{R}^{3 \\times 3}$是一个满足$\\boldsymbol{R}(t)^{\\mathsf{T}}\\boldsymbol{R}(t) = \\boldsymbol{I}$和$\\det \\boldsymbol{R}(t) = 1$的真正交张量，$\\boldsymbol{c}(t) \\in \\mathbb{R}^{3}$是一个平移向量。将变形梯度记为$\\boldsymbol{F} = \\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}$，速度梯度记为$\\boldsymbol{L} = \\nabla \\boldsymbol{v}$，其对称部分记为$\\boldsymbol{D} = \\tfrac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}})$，其反对称部分记为$\\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}})$。假设为无变形的刚体旋转，因此$\\boldsymbol{D} = \\boldsymbol{0}$且$\\boldsymbol{L} = \\boldsymbol{W} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} \\equiv \\boldsymbol{\\Omega}$，其中$\\boldsymbol{\\Omega}$是自旋张量。设$\\boldsymbol{\\sigma}(t)$为柯西应力张量，其偏量部分为$\\boldsymbol{\\tau}(t) = \\boldsymbol{\\sigma}(t) - \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}(t))\\,\\boldsymbol{I}$。考虑应用于偏应力的三种客观应力率：Zaremba–Jaumann (ZJ)率、Green–Naghdi (GN)率和Truesdell (TR)率，每种都按其作为二阶张量客观率的标准定义来理解。\n\n您的任务是：\n\n1. 仅从物质时间导数、刚体运动以及运动学分解$\\boldsymbol{L} = \\boldsymbol{D} + \\boldsymbol{W}$的定义出发，对于固定在同转材料坐标系中的一个通用常数张量$\\boldsymbol{S}_0$，推导出空间柯西应力可以写为$\\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{S}_0\\,\\boldsymbol{R}(t)^{\\mathsf{T}}$，并且在刚体旋转下，其物质时间导数满足$\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{\\Omega}\\,\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\,\\boldsymbol{\\Omega}$。然后证明其偏量部分满足$\\dot{\\boldsymbol{\\tau}} = \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}})$。\n\n2. 仅使用 Zaremba–Jaumann (ZJ)率、Green–Naghdi (GN)率和 Truesdell (TR)率针对二阶张量的标准张量定义，并将其应用于$\\boldsymbol{D} = \\boldsymbol{0}$和$\\boldsymbol{L} = \\boldsymbol{W} = \\boldsymbol{\\Omega}$的刚体旋转情况，证明施加于$\\boldsymbol{\\tau}$的每种客观率都为零，即对于这三种率，均有$\\stackrel{\\diamond}{\\boldsymbol{\\tau}} = \\boldsymbol{0}$。\n\n3. 实现一个程序，对以下测试套件数值验证此结果。在每种情况下，给定同转坐标系中的材料应力$\\boldsymbol{S}_0$（单位为帕斯卡），由轴角对$(\\boldsymbol{a}, \\theta)$指定的瞬时旋转（其中$\\boldsymbol{a} \\in \\mathbb{R}^{3}$是单位向量，$\\theta \\in \\mathbb{R}$是以弧度为单位的角度），以及瞬时角速度向量$\\boldsymbol{\\omega} \\in \\mathbb{R}^{3}$（单位为弧度/秒）。使用$(\\boldsymbol{a}, \\theta)$通过 Rodrigues 公式得到$\\boldsymbol{Q}$，并构造空间应力$\\boldsymbol{\\sigma} = \\boldsymbol{Q}\\,\\boldsymbol{S}_0\\,\\boldsymbol{Q}^{\\mathsf{T}}$。使用 Levi–Civita 符号$\\varepsilon_{ijk}$，通过$W_{ij} = -\\varepsilon_{ijk}\\,\\omega_k$从$\\boldsymbol{\\omega}$构造自旋张量$\\boldsymbol{W}$。然后计算$\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{W}$，$\\boldsymbol{\\tau} = \\operatorname{dev}(\\boldsymbol{\\sigma})$和$\\dot{\\boldsymbol{\\tau}} = \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}})$。最后，评估$\\boldsymbol{\\tau}$在该瞬间的三种客观率，并检查它们的弗罗贝尼乌斯范数是否低于一个由问题相关量值缩放的容差。\n\n使用以下测试套件；所有应力单位为帕斯卡，角速度单位为弧度/秒，所有角度单位为弧度：\n\n- 测试 $1$：\n  - $\\boldsymbol{S}_0 = 100 \\times 10^{6}\\,\\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}$,\n  - $\\boldsymbol{a} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$, $\\theta = 0$,\n  - $\\boldsymbol{\\omega} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n\n- 测试 $2$：\n  - $\\boldsymbol{S}_0 = 50 \\times 10^{6}\\,\\begin{bmatrix} 2  -1  0 \\\\ -1  1  0 \\\\ 0  0  -3 \\end{bmatrix}$,\n  - $\\boldsymbol{a} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$, $\\theta = 1.2$,\n  - $\\boldsymbol{\\omega} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 10 \\end{bmatrix}$。\n\n- 测试 $3$：\n  - $\\boldsymbol{S}_0 = 10^{6}\\,\\begin{bmatrix} 80  20  -10 \\\\ 20  60  15 \\\\ -10  15  40 \\end{bmatrix}$,\n  - $\\boldsymbol{a} = \\dfrac{1}{\\sqrt{2}}\\,\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}$, $\\theta = 0.9$,\n  - $\\boldsymbol{\\omega} = \\begin{bmatrix} 0.21 \\\\ 0.20 \\\\ -0.049 \\end{bmatrix}$。\n\n- 测试 $4$：\n  - $\\boldsymbol{S}_0 = 10^{6}\\,\\begin{bmatrix} 5  -12  7 \\\\ -12  3  4 \\\\ 7  4  1 \\end{bmatrix}$,\n  - $\\boldsymbol{a} = \\dfrac{1}{\\sqrt{14}}\\,\\begin{bmatrix} 1 \\\\ 2 \\\\ 3 \\end{bmatrix}$, $\\theta = 3.0$,\n  - $\\boldsymbol{\\omega} = \\begin{bmatrix} 5 \\\\ -4 \\\\ 2 \\end{bmatrix}$。\n\n对于每个测试用例，计算$\\boldsymbol{\\tau}$的三种客观率中每一种的弗罗贝尼乌斯范数，并将其与阈值$\\varepsilon \\,\\Lambda$进行比较，其中$\\varepsilon = 10^{-10}$，$\\Lambda = \\max\\left( \\lVert \\boldsymbol{\\tau} \\rVert_{\\mathrm{F}} \\,\\lVert \\boldsymbol{W} \\rVert_{\\mathrm{F}},\\, 1 \\right)$，$\\lVert \\cdot \\rVert_{\\mathrm{F}}$是弗罗贝尼乌斯范数。每个测试报告三个布尔值，分别表示 Zaremba–Jaumann、Green–Naghdi 和 Truesdell 率是否低于阈值。要求的最终输出格式是包含一个布尔值列表的列表的单行，每个内部列表对应一个测试，顺序为$[\\text{ZJ}, \\text{GN}, \\text{TR}]$。例如，一个有效的输出行格式为$[[\\text{True},\\text{True},\\text{True}],[\\dots],\\dots]$。不应打印任何额外文本。角度必须解释为弧度。所有与应力相关的量必须以帕斯卡为单位，所有时间以秒为单位，率的范数隐式单位为帕斯卡/秒，但程序必须仅按规定输出布尔值。", "solution": "该问题要求三部分回答：首先，一组关于刚体旋转下应力张量的推导；其次，证明三种标准的偏应力客观率在这些条件下为零；第三，一个用于验证此结果的数值程序。\n\n我们首先按要求进行理论推导和证明。\n\n### 第1部分：刚体运动下应力的推导\n\n本节提供了刚体旋转下空间柯西应力及其物质时间导数的推导。\n\n**1. 从常数材料应力张量推导空间柯西应力**\n\n在物质描述中，一个二阶张量场$ \\boldsymbol{S}(\\boldsymbol{X}, t) $通过前推操作$ \\boldsymbol{\\sigma} = (\\det \\boldsymbol{F})^{-1} \\boldsymbol{F} \\boldsymbol{S} \\boldsymbol{F}^{\\mathsf{T}} $转换为其在空间描述中的对应物，即柯西应力$ \\boldsymbol{\\sigma}(\\boldsymbol{x}, t) $。问题描述了一个由$ \\boldsymbol{x}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{X} + \\boldsymbol{c}(t) $给出的刚体运动。变形梯度为$ \\boldsymbol{F} = \\partial \\boldsymbol{x}/\\partial \\boldsymbol{X} = \\boldsymbol{R}(t) $。由于$ \\boldsymbol{R}(t) $是一个真正交张量，其行列式为$ \\det \\boldsymbol{R}(t) = 1 $。\n\n问题指出$ \\boldsymbol{S}_0 $是-个固定在同转材料坐标系中的常数张量。这意味着在物质描述中，它相对于物质坐标$ \\boldsymbol{X} $和时间$ t $都是常数。将$ \\boldsymbol{F} = \\boldsymbol{R}(t) $，$ \\det \\boldsymbol{F} = 1 $和$ \\boldsymbol{S} = \\boldsymbol{S}_0 $代入前推公式，得到空间柯西应力：\n$$\n\\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{S}_0\\,\\boldsymbol{R}(t)^{\\mathsf{T}}\n$$\n这表明空间应力是通过用旋转张量$ \\boldsymbol{R}(t) $旋转常数材料应力张量$ \\boldsymbol{S}_0 $得到的。\n\n**2. 柯西应力的物质时间导数**\n\n$ \\boldsymbol{\\sigma}(t) $的物质时间导数可通过对上述表达式关于时间$ t $求导得到。使用乘积法则求导：\n$$\n\\dot{\\boldsymbol{\\sigma}}(t) = \\frac{d}{dt} \\left( \\boldsymbol{R}(t)\\,\\boldsymbol{S}_0\\,\\boldsymbol{R}(t)^{\\mathsf{T}} \\right) = \\dot{\\boldsymbol{R}}(t)\\,\\boldsymbol{S}_0\\,\\boldsymbol{R}(t)^{\\mathsf{T}} + \\boldsymbol{R}(t)\\,\\boldsymbol{S}_0\\,\\dot{\\boldsymbol{R}}(t)^{\\mathsf{T}}\n$$\n我们可以通过重排第一个方程将$ \\boldsymbol{S}_0 $表示为$ \\boldsymbol{\\sigma}(t) $的函数：$ \\boldsymbol{S}_0 = \\boldsymbol{R}(t)^{\\mathsf{T}}\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{R}(t) $。将其代入$ \\dot{\\boldsymbol{\\sigma}}(t) $的表达式中：\n$$\n\\dot{\\boldsymbol{\\sigma}}(t) = \\dot{\\boldsymbol{R}}(t)\\,(\\boldsymbol{R}(t)^{\\mathsf{T}}\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{R}(t))\\,\\boldsymbol{R}(t)^{\\mathsf{T}} + \\boldsymbol{R}(t)\\,(\\boldsymbol{R}(t)^{\\mathsf{T}}\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{R}(t))\\,\\dot{\\boldsymbol{R}}(t)^{\\mathsf{T}}\n$$\n利用正交性$ \\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{I} $，我们得到：\n$$\n\\dot{\\boldsymbol{\\sigma}}(t) = (\\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}})\\,\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\,(\\boldsymbol{R}\\dot{\\boldsymbol{R}}^{\\mathsf{T}})\n$$\n对于刚体运动，速度梯度为$ \\boldsymbol{L} = \\dot{\\boldsymbol{F}}\\boldsymbol{F}^{-1} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} $。问题给出$ \\boldsymbol{D}=\\boldsymbol{0} $，因此$ \\boldsymbol{L} = \\boldsymbol{W} = \\boldsymbol{\\Omega} $，其中$ \\boldsymbol{\\Omega} $是自旋张量。因此，$ \\boldsymbol{\\Omega} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} $。\n对恒等式$ \\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{I} $关于时间求导，得到$ \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} + \\boldsymbol{R}\\dot{\\boldsymbol{R}}^{\\mathsf{T}} = \\boldsymbol{0} $。这意味着$ \\boldsymbol{R}\\dot{\\boldsymbol{R}}^{\\mathsf{T}} = - \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} = -\\boldsymbol{\\Omega} $。\n将这些代入$ \\dot{\\boldsymbol{\\sigma}}(t) $的方程中：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{\\Omega}\\,\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\,\\boldsymbol{\\Omega}\n$$\n这个结果$ \\dot{\\boldsymbol{\\sigma}} = [\\boldsymbol{\\Omega}, \\boldsymbol{\\sigma}] $表明，柯西应力的物质导数是自旋张量和应力张量本身的李括号。\n\n**3. 偏应力的物质时间导数**\n\n偏应力张量$ \\boldsymbol{\\tau} $定义为$ \\boldsymbol{\\tau} = \\boldsymbol{\\sigma} - \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I} $。其物质时间导数为：\n$$\n\\dot{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\sigma}} - \\frac{d}{dt}\\left(\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}\\right) = \\dot{\\boldsymbol{\\sigma}} - \\frac{1}{3}\\frac{d}{dt}(\\operatorname{tr}(\\boldsymbol{\\sigma}))\\,\\boldsymbol{I}\n$$\n空间应力的迹为$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(\\boldsymbol{R}\\boldsymbol{S}_0\\boldsymbol{R}^{\\mathsf{T}}) $。利用迹的循环性质$ \\operatorname{tr}(\\boldsymbol{A}\\boldsymbol{B}\\boldsymbol{C}) = \\operatorname{tr}(\\boldsymbol{C}\\boldsymbol{A}\\boldsymbol{B}) $，我们有：\n$$\n\\operatorname{tr}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R}\\boldsymbol{S}_0) = \\operatorname{tr}(\\boldsymbol{I}\\boldsymbol{S}_0) = \\operatorname{tr}(\\boldsymbol{S}_0)\n$$\n由于$ \\boldsymbol{S}_0 $是一个常数张量，其迹为一个常数标量。因此，$ \\frac{d}{dt}(\\operatorname{tr}(\\boldsymbol{\\sigma})) = 0 $。这将$ \\dot{\\boldsymbol{\\tau}} $的表达式简化为：\n$$\n\\dot{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\sigma}}\n$$\n现在我们计算$ \\dot{\\boldsymbol{\\sigma}} $的偏量部分，记为$ \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}}) $：\n$$\n\\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}}) = \\dot{\\boldsymbol{\\sigma}} - \\frac{1}{3}\\operatorname{tr}(\\dot{\\boldsymbol{\\sigma}})\\,\\boldsymbol{I}\n$$\n我们计算$ \\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{\\Omega}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{\\Omega} $的迹。再次使用迹的循环性质：\n$$\n\\operatorname{tr}(\\dot{\\boldsymbol{\\sigma}}) = \\operatorname{tr}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{\\Omega}) = \\operatorname{tr}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}) - \\operatorname{tr}(\\boldsymbol{\\sigma}\\boldsymbol{\\Omega}) = \\operatorname{tr}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}) - \\operatorname{tr}(\\boldsymbol{\\Omega}\\boldsymbol{\\sigma}) = 0\n$$\n由于$ \\operatorname{tr}(\\dot{\\boldsymbol{\\sigma}}) = 0 $，其偏量部分就是其自身：$ \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}}) = \\dot{\\boldsymbol{\\sigma}} $。\n结合这些结果，我们有$ \\dot{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\sigma}} $和$ \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}}) = \\dot{\\boldsymbol{\\sigma}} $，这证明了$ \\dot{\\boldsymbol{\\tau}} = \\operatorname{dev}(\\dot{\\boldsymbol{\\sigma}}) $。\n\n### 第2部分：刚体旋转下的客观应力率\n\n我们现在证明，在刚体旋转的情况下，偏应力$ \\boldsymbol{\\tau} $的 Zaremba-Jaumann、Green-Naghdi 和 Truesdell 客观率均为零。在这种情况下，运动学条件是$ \\boldsymbol{D} = \\boldsymbol{0} $和$ \\boldsymbol{L} = \\boldsymbol{W} = \\boldsymbol{\\Omega} $。\n\n**1. Zaremba-Jaumann (ZJ)率**\n\n一个张量$ \\boldsymbol{A} $的 ZJ 率（也称为同转率）定义为$ \\stackrel{\\triangledown}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} - \\boldsymbol{W}\\boldsymbol{A} + \\boldsymbol{A}\\boldsymbol{W} $。将其应用于偏应力$ \\boldsymbol{\\tau} $：\n$$\n\\stackrel{\\triangledown}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{W}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{W}\n$$\n代入$ \\boldsymbol{W} = \\boldsymbol{\\Omega} $并使用第1部分的结果$ \\dot{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{\\Omega}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{\\Omega} $：\n$$\n\\stackrel{\\triangledown}{\\boldsymbol{\\tau}} = (\\boldsymbol{\\Omega}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{\\Omega}) - \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega}\n$$\n代入$ \\boldsymbol{\\sigma} = \\boldsymbol{\\tau} + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I} $：\n$$\n\\stackrel{\\triangledown}{\\boldsymbol{\\tau}} = \\boldsymbol{\\Omega}\\left(\\boldsymbol{\\tau} + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}\\right) - \\left(\\boldsymbol{\\tau} + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}\\right)\\boldsymbol{\\Omega} - \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega}\n$$\n展开各项：\n$$\n\\stackrel{\\triangledown}{\\boldsymbol{\\tau}} = \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\boldsymbol{\\Omega} - \\boldsymbol{\\tau}\\boldsymbol{\\Omega} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\boldsymbol{\\Omega} - \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega}\n$$\n合并同类项：\n$$\n\\stackrel{\\triangledown}{\\boldsymbol{\\tau}} = (\\boldsymbol{\\Omega}\\boldsymbol{\\tau} - \\boldsymbol{\\Omega}\\boldsymbol{\\tau}) + (-\\boldsymbol{\\tau}\\boldsymbol{\\Omega} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega}) + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})(\\boldsymbol{\\Omega} - \\boldsymbol{\\Omega}) = \\boldsymbol{0}\n$$\n因此，$ \\boldsymbol{\\tau} $的 ZJ 率为零。\n\n**2. Green-Naghdi (GN)率**\n\nGN 率使用自旋$ \\boldsymbol{\\Omega}_{\\text{polar}} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} $定义，该自旋源自变形梯度$ \\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U} $的极分解。对于刚体运动，$ \\boldsymbol{F}=\\boldsymbol{R} $，因此$ \\boldsymbol{U}=\\boldsymbol{I} $。极分解得到的旋转就是刚体旋转$ \\boldsymbol{R} $。相关的自旋为$ \\boldsymbol{\\Omega}_{\\text{polar}} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} $。\n如前所述，对于刚体运动，$ \\boldsymbol{L} = \\boldsymbol{W} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}} $，所以$ \\boldsymbol{\\Omega}_{\\text{polar}} = \\boldsymbol{W} = \\boldsymbol{\\Omega} $。\nGN 率的定义变为$ \\stackrel{\\triangle}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega} $，这与 ZJ 率相同。因此，根据相同的论证：\n$$\n\\stackrel{\\triangle}{\\boldsymbol{\\tau}} = \\boldsymbol{0}\n$$\n\n**3. Truesdell (TR)率**\n\nTR 率定义为$ \\stackrel{\\circ}{\\boldsymbol{A}} = \\dot{\\boldsymbol{A}} - \\boldsymbol{L}\\boldsymbol{A} - \\boldsymbol{A}\\boldsymbol{L}^{\\mathsf{T}} + \\operatorname{tr}(\\boldsymbol{L})\\boldsymbol{A} $。将其应用于$ \\boldsymbol{\\tau} $：\n$$\n\\stackrel{\\circ}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{L}\\boldsymbol{\\tau} - \\boldsymbol{\\tau}\\boldsymbol{L}^{\\mathsf{T}} + \\operatorname{tr}(\\boldsymbol{L})\\boldsymbol{\\tau}\n$$\n在刚体旋转下，$ \\boldsymbol{L} = \\boldsymbol{W} = \\boldsymbol{\\Omega} $。由于$ \\boldsymbol{W} $是一个反对称张量，我们有$ \\boldsymbol{L}^{\\mathsf{T}} = \\boldsymbol{W}^{\\mathsf{T}} = -\\boldsymbol{W} = -\\boldsymbol{L} $。此外，任何反对称张量的迹都为零，所以$ \\operatorname{tr}(\\boldsymbol{L}) = 0 $。\n将这些代入 TR 率的定义中：\n$$\n\\stackrel{\\circ}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{L}\\boldsymbol{\\tau} - \\boldsymbol{\\tau}(-\\boldsymbol{L}) + (0)\\boldsymbol{\\tau} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{L}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{L}\n$$\n由于$ \\boldsymbol{L} = \\boldsymbol{W} = \\boldsymbol{\\Omega} $，此表达式在这种特定情况下与 ZJ 和 GN 率相同。\n$$\n\\stackrel{\\circ}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} - \\boldsymbol{\\Omega}\\boldsymbol{\\tau} + \\boldsymbol{\\tau}\\boldsymbol{\\Omega} = \\boldsymbol{0}\n$$\n$ \\boldsymbol{\\tau} $的 Truesdell 率也为零，证明完毕。所有三种客观率都旨在测量由变形引起的应力变化率，因此，它们对于无变形的运动（即刚体旋转）为零是一个基本的一致性要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by numerically verifying that ZJ, GN, and TR objective\n    stress rates of the deviatoric stress are zero under rigid-body rotation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (100e6 * np.array([[1, 0, 0], [0, 1, 0], [0, 0, 1]]), \n         np.array([1, 0, 0]), 0.0, np.array([0, 0, 0])),\n        (50e6 * np.array([[2, -1, 0], [-1, 1, 0], [0, 0, -3]]),\n         np.array([0, 0, 1]), 1.2, np.array([0, 0, 10])),\n        (1e6 * np.array([[80, 20, -10], [20, 60, 15], [-10, 15, 40]]),\n         (1/np.sqrt(2)) * np.array([1, 1, 0]), 0.9, np.array([0.21, 0.20, -0.049])),\n        (1e6 * np.array([[5, -12, 7], [-12, 3, 4], [7, 4, 1]]),\n         (1/np.sqrt(14)) * np.array([1, 2, 3]), 3.0, np.array([5, -4, 2]))\n    ]\n\n    results = []\n    epsilon = 1e-10\n\n    def skew(v):\n        \"\"\"Returns the skew-symmetric matrix for a 3D vector v.\"\"\"\n        v = np.asarray(v).flatten()\n        return np.array([\n            [0, -v[2], v[1]],\n            [v[2], 0, -v[0]],\n            [-v[1], v[0], 0]\n        ])\n\n    for s0, a, theta, omega in test_cases:\n        # Step 1: Construct rotation matrix Q from axis-angle (a, theta)\n        # using Rodrigues' formula.\n        a = np.asarray(a)\n        if np.linalg.norm(a) > 1e-12: # Avoid division by zero if a is a zero vector\n            a = a / np.linalg.norm(a)\n        A = skew(a)\n        Q = np.eye(3) + np.sin(theta) * A + (1 - np.cos(theta)) * (A @ A)\n        \n        # Step 2: Construct spatial Cauchy stress sigma.\n        sigma = Q @ s0 @ Q.T\n        \n        # Step 3: Construct spin tensor W from angular velocity omega.\n        W = skew(omega)\n        \n        # Step 4: Compute material time derivative of sigma.\n        sigma_dot = W @ sigma - sigma @ W\n        \n        # Step 5: Compute deviatoric stress tau.\n        tau = sigma - (1/3) * np.trace(sigma) * np.eye(3)\n        \n        # Step 6: Compute material time derivative of tau.\n        # As shown in the derivation, tr(sigma_dot) = 0 for rigid rotation,\n        # so dev(sigma_dot) = sigma_dot. Also dot(tau) = dot(sigma).\n        # Thus, tau_dot = sigma_dot.\n        tau_dot = sigma_dot\n\n        # Step 7: Evaluate the three objective rates of tau.\n        \n        # Zaremba-Jaumann rate of tau\n        tau_rate_zj = tau_dot - (W @ tau - tau @ W)\n\n        # Green-Naghdi rate of tau (Omega_polar = W)\n        # For rigid-body motion, the GN rate is identical to the ZJ rate.\n        tau_rate_gn = tau_rate_zj\n\n        # Truesdell rate of tau (L=W, tr(L)=0, L^T=-W)\n        # The definition simplifies to be identical to the ZJ rate for this case.\n        tau_rate_tr = tau_dot - (W @ tau - tau @ W)\n        \n        # Step 8: Compare norms against the scaled threshold.\n        norm_tau = np.linalg.norm(tau, 'fro')\n        norm_W = np.linalg.norm(W, 'fro')\n        \n        Lambda = max(norm_tau * norm_W, 1.0)\n        threshold = epsilon * Lambda\n        \n        norm_zj = np.linalg.norm(tau_rate_zj, 'fro')\n        norm_gn = np.linalg.norm(tau_rate_gn, 'fro')\n        norm_tr = np.linalg.norm(tau_rate_tr, 'fro')\n        \n        case_results = [\n            norm_zj  threshold,\n            norm_gn  threshold,\n            norm_tr  threshold\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "3542215"}, {"introduction": "在计算岩土力学中，任意拉格朗日-欧拉（ALE）方法为模拟大变形问题提供了极大的灵活性，因为它允许计算网格独立于材料而运动。然而，这种灵活性也引入了对物理量（如物质导数）进行正确表述的挑战。本练习 [@problem_id:3542191] 要求您推导并数值验证物质导数的两种等效表达式：一种基于纯欧拉描述，另一种基于ALE描述，从而验证物质导数作为一个客观物理量的计算结果与网格运动无关。", "problem": "考虑计算岩土力学中用于大变形的任意拉格朗日-欧拉 (ALE) 设定。令空间坐标表示为 $x = (x_1, x_2) \\in \\mathbb{R}^2$，时间表示为 $t \\in \\mathbb{R}$。一个光滑的空间二阶张量场 $T(x,t) \\in \\mathbb{R}^{2 \\times 2}$ 的分量形式由下式给出\n$$\nT_{11}(x,t) = \\sin(\\alpha\\, t) + x_1^2 + x_2,\\quad\nT_{12}(x,t) = T_{21}(x,t) = \\tfrac{1}{2}\\cos(\\beta\\, t)\\, x_1 - \\tfrac{1}{4} x_2^2,\\quad\nT_{22}(x,t) = \\mathrm{e}^{\\mu\\, t} + x_1 x_2,\n$$\n其中 $\\alpha, \\beta, \\mu \\in \\mathbb{R}$ 为给定常数。\n\n物理运动由一个在空间上是仿射的空间速度场 $v^{m}(x,t) \\in \\mathbb{R}^2$ 描述，\n$$\nv^{m}(x,t) = B\\, x + c,\n$$\n其中 $B \\in \\mathbb{R}^{2 \\times 2}$ 和 $c \\in \\mathbb{R}^2$ 是不依赖于时间的常数。计算网格围绕原点进行刚性旋转，角速度为 $\\omega_g \\in \\mathbb{R}$，因此网格速度为\n$$\nv^{g}(x,t) = W_g\\, x,\\quad\\text{with}\\quad W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}.\n$$\n\n仅从基本定义出发，即空间张量场沿物理运动的物质时间导数是沿粒子轨迹所取的时间导数，以及描述之间的变量变换会引入带有适当输运速度的链式法则，完成以下任务：\n\n1. 推导 $T(x,t)$ 沿物理运动的物质时间导数的分量表达式，使用固定空间点的时间变化率和物理对流输运。将其完全用 $x$、$t$、固定 $x$ 处的 $\\partial T/\\partial t$、$T$ 的空间梯度以及 $v^{m}(x,t)$ 来表示。\n\n2. 使用固定网格坐标的时间变化率和相对对流输运，推导相同物质时间导数的分量表达式。将其完全用 $x$、$t$、固定网格坐标的时间变化率、$T$ 的空间梯度以及相对速度 $v^{r}(x,t) = v^{m}(x,t) - v^{g}(x,t)$ 来表示。\n\n3. 实现这两种表达式，并对下面的每个测试用例进行验证，确认即使在网格进行刚性旋转时，它们在数值容差 $\\delta = 10^{-10}$ 内仍然相等。此验证构成了对于给定物理运动，所计算的物质时间导数相对于刚性网格运动的客观性检验。\n\n使用以下参数值：\n- 场参数：$\\alpha = 0.8$，$\\beta = 1.3$，$\\mu = 0.4$。\n- 默认物理速度参数（除非在测试用例中被覆盖）：$B = \\begin{bmatrix} d  s \\\\ -s  d \\end{bmatrix}$，其中 $d = 0.15$，$s = 0.35$，以及 $c = \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix}$。\n\n测试套件：\n- 用例 1：$x = (0.3, -0.5)$，$t = 0.7$，$\\omega_g = 1.2$，使用默认的 $B$ 和 $c$。\n- 用例 2：$x = (-1.0, 2.0)$，$t = 0.25$，$\\omega_g = 0.0$，使用默认的 $B$ 和 $c$。\n- 用例 3：$x = (2.0, 2.0)$，$t = 1.5$，$\\omega_g = 50.0$，使用默认的 $B$ 和 $c$。\n- 用例 4：$x = (0.0, 0.0)$，$t = 1.0$，$\\omega_g = -3.5$，使用默认的 $B$ 和 $c$。\n- 用例 5（纯刚体物理运动）：$x = (1.2, -0.7)$，$t = 0.9$，$\\omega_g = 4.0$，$B = \\begin{bmatrix} 0  s_0 \\\\ -s_0  0 \\end{bmatrix}$，其中 $s_0 = 2.0$，以及 $c = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n\n对于每个用例，计算 $T$ 的物质时间导数的两种实现之间的最大绝对分量差，并返回一个布尔值，指示该差异是否严格小于 $\\delta$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述用例的顺序排列结果，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_k$ 是一个布尔值。", "solution": "该问题要求在一个任意拉格朗日-欧拉 (ALE) 框架中，推导并实现一个空间张量场物质时间导数的两种不同但等效的表达式。然后必须对这两种表达式的等效性进行数值验证。\n\n空间张量场，表示为 $T(x,t)$，是空间坐标 $x \\in \\mathbb{R}^2$ 和时间 $t \\in \\mathbb{R}$ 的函数。物质时间导数 $\\frac{DT}{Dt}$ 衡量的是一个随物质粒子运动的观察者所感受到的该场的变化率。粒子的路径由 $x = \\chi_p(X, t)$ 给出，其中 $X$ 是标识粒子的标签（例如，其在 $t=0$ 时的位置）。因此，物质的速度为 $v^m = \\frac{d\\chi_p}{dt}$。\n\n**1. 欧拉描述下的推导**\n\n第一种公式基于纯欧拉描述，其中观察者在空间中是固定的。根据定义，物质时间导数是 $T(x,t)$ 沿着粒子路径的全导数：\n$$\n\\frac{DT}{Dt} = \\frac{d}{dt} T(\\chi_p(X, t), t)\n$$\n应用多元链式法则，我们得到：\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T}{\\partial x_k} \\frac{dx_k}{dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m\n$$\n这里，$\\frac{\\partial T}{\\partial t}|_x$ 是在固定点 $x$ 的局部或空间时间导数，而 $(\\nabla_x T) \\cdot v^m$ 是对流项，表示由于粒子移动到具有不同 $T$ 值的新位置而引起的 $T$ 的变化。在分量表示法中，对于一个二阶张量 $T$，这表示为：\n$$\n\\left(\\frac{DT}{Dt}\\right)_{ij} = \\frac{\\partial T_{ij}}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T_{ij}}{\\partial x_k} v_k^m\n$$\n我们为给定的张量场 $T(x,t)$ 计算必要的项：\n$T_{11}(x,t) = \\sin(\\alpha t) + x_1^2 + x_2$\n$T_{12}(x,t) = T_{21}(x,t) = \\frac{1}{2}\\cos(\\beta t) x_1 - \\frac{1}{4} x_2^2$\n$T_{22}(x,t) = \\mathrm{e}^{\\mu t} + x_1 x_2$\n\n在固定空间点 $x$ 的时间偏导数为：\n$$\n\\frac{\\partial T_{11}}{\\partial t} = \\alpha \\cos(\\alpha t) \\quad ; \\quad\n\\frac{\\partial T_{12}}{\\partial t} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 \\quad ; \\quad\n\\frac{\\partial T_{22}}{\\partial t} = \\mu \\mathrm{e}^{\\mu t}\n$$\n空间梯度为：\n$$\n\\nabla_x T_{11} = \\begin{pmatrix} 2x_1 \\\\ 1 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{12} = \\begin{pmatrix} \\frac{1}{2}\\cos(\\beta t) \\\\ -\\frac{1}{2}x_2 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{22} = \\begin{pmatrix} x_2 \\\\ x_1 \\end{pmatrix}\n$$\n物理速度场为 $v^m(x,t) = Bx + c$。令 $v^m = (v_1^m, v_2^m)^T$。我们记为 $\\dot{T}^{(E)}$ 的第一种公式的分量为：\n$$\n\\dot{T}^{(E)}_{11} = \\alpha \\cos(\\alpha t) + 2x_1 v_1^m + v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{12} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + \\frac{1}{2}\\cos(\\beta t) v_1^m - \\frac{1}{2}x_2 v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{22} = \\mu \\mathrm{e}^{\\mu t} + x_2 v_1^m + x_1 v_2^m\n$$\n对称性成立，所以 $\\dot{T}^{(E)}_{21} = \\dot{T}^{(E)}_{12}$。\n\n**2. 任意拉格朗日-欧拉 (ALE) 描述下的推导**\n\nALE 描述引入了一个可以独立于物质运动的计算网格。网格运动由一个映射 $x = \\chi_g(\\xi, t)$ 描述，其中 $\\xi$ 是网格上的固定坐标。网格速度为 $v^g = \\frac{\\partial\\chi_g}{\\partial t}|_\\xi$。\n\n在固定网格坐标 $\\xi$ 处，场 $T$ 的时间导数为：\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_\\xi = \\frac{d}{dt} T(\\chi_g(\\xi, t), t) = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot \\frac{\\partial \\chi_g}{\\partial t}\\bigg|_\\xi = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g\n$$\n这个基本关系允许我们用基于网格的导数来表示局部时间导数 $\\frac{\\partial T}{\\partial t}|_x$：\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g\n$$\n将此式代入物质导数的欧拉表达式中：\n$$\n\\frac{DT}{Dt} = \\left( \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot v^m = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\n将物质与网格之间的相对速度定义为 $v^r = v^m - v^g$，我们得到物质导数的 ALE 公式：\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r\n$$\n这个表达式构成了第二种公式。为了实现它，我们必须首先计算项 $\\frac{\\partial T}{\\partial t}|_\\xi$ 和相对速度 $v^r$。对于给定的网格速度 $v^g(x,t) = W_g x$，其中 $W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}$，我们有 $v^g = (-\\omega_g x_2, \\omega_g x_1)^T$。$\\frac{\\partial T}{\\partial t}|_\\xi$ 的分量为：\n$$\n\\left(\\frac{\\partial T_{11}}{\\partial t}\\right)_\\xi = \\alpha \\cos(\\alpha t) + (2x_1)(-\\omega_g x_2) + (1)(\\omega_g x_1) = \\alpha \\cos(\\alpha t) + \\omega_g(x_1 - 2x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{12}}{\\partial t}\\right)_\\xi = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + (\\frac{1}{2}\\cos(\\beta t))(-\\omega_g x_2) + (-\\frac{1}{2}x_2)(\\omega_g x_1) = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 - \\frac{1}{2}\\omega_g(x_2\\cos(\\beta t) + x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{22}}{\\partial t}\\right)_\\xi = \\mu \\mathrm{e}^{\\mu t} + (x_2)(-\\omega_g x_2) + (x_1)(\\omega_g x_1) = \\mu \\mathrm{e}^{\\mu t} + \\omega_g(x_1^2 - x_2^2)\n$$\n然后，通过将相对对流项 $(\\nabla_x T_{ij}) \\cdot v^r$ 添加到这些表达式中，可以计算出第二种公式（记为 $\\dot{T}^{(ALE)}$）的分量。\n\n**3. 等效性验证**\n通过从 ALE 形式出发并代入 $\\frac{\\partial T}{\\partial t}|_\\xi$ 和 $v^r$ 的定义，可以证明两种公式的代数恒等性 $\\dot{T}^{(E)} = \\dot{T}^{(ALE)}$：\n$$\n\\dot{T}^{(ALE)} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r = \\left(\\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\n$$\n= \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g + (\\nabla_x T) \\cdot v^m - (\\nabla_x T) \\cdot v^g = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m = \\dot{T}^{(E)}\n$$\n这两个表达式在数学上是相同的。这证实了物质时间导数是一个客观量，其值不依赖于底层计算网格的运动。问题的数值部分旨在验证这两种不同计算路径的正确实现。它们的数值结果之间的差异应为零，受限于浮点精度。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and verifies two formulations of the material time derivative\n    for a given tensor field in an ALE setting.\n    \"\"\"\n    \n    # Field parameters\n    alpha = 0.8\n    beta = 1.3\n    mu = 0.4\n    \n    # Numerical tolerance\n    delta = 1e-10\n\n    # Default physical velocity parameters\n    d_def = 0.15\n    s_def = 0.35\n    B_def = np.array([[d_def, s_def], [-s_def, d_def]])\n    c_def = np.array([0.1, -0.2])\n\n    test_cases = [\n        {'x': np.array([0.3, -0.5]), 't': 0.7, 'omega_g': 1.2, 'B': B_def, 'c': c_def},\n        {'x': np.array([-1.0, 2.0]), 't': 0.25, 'omega_g': 0.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([2.0, 2.0]), 't': 1.5, 'omega_g': 50.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([0.0, 0.0]), 't': 1.0, 'omega_g': -3.5, 'B': B_def, 'c': c_def},\n        {'x': np.array([1.2, -0.7]), 't': 0.9, 'omega_g': 4.0, \n         'B': np.array([[0.0, 2.0], [-2.0, 0.0]]), 'c': np.array([0.0, 0.0])},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x, t, omega_g, B, c = case['x'], case['t'], case['omega_g'], case['B'], case['c']\n        x1, x2 = x[0], x[1]\n\n        # --- Calculate velocities ---\n        # Physical velocity: v^m = Bx + c\n        v_m = B @ x + c\n        \n        # Grid velocity: v^g = W_g * x\n        W_g = omega_g * np.array([[0, -1], [1, 0]])\n        v_g = W_g @ x\n        \n        # Relative velocity: v^r = v^m - v^g\n        v_r = v_m - v_g\n\n        # --- Calculate partial derivatives and gradients ---\n        # Partial time derivatives at fixed x\n        dT_dt = np.zeros((2, 2))\n        dT_dt[0, 0] = alpha * np.cos(alpha * t)\n        dT_dt[0, 1] = dT_dt[1, 0] = -0.5 * beta * np.sin(beta * t) * x1\n        dT_dt[1, 1] = mu * np.exp(mu * t)\n\n        # Spatial gradients\n        grad_T11 = np.array([2 * x1, 1.0])\n        grad_T12 = np.array([0.5 * np.cos(beta * t), -0.5 * x2])\n        grad_T22 = np.array([x2, x1])\n\n        # --- Formulation 1: Eulerian ---\n        # DT/Dt = dT/dt|_x + (grad_T) . v_m\n        DT_Dt_E = np.zeros((2, 2))\n        DT_Dt_E[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_m)\n        DT_Dt_E[0, 1] = DT_Dt_E[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_m)\n        DT_Dt_E[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_m)\n\n        # --- Formulation 2: ALE ---\n        # DT/Dt = dT/dt|_xi + (grad_T) . v_r\n        # First, find dT/dt|_xi = dT/dt|_x + (grad_T) . v_g\n        dT_dt_xi = np.zeros((2, 2))\n        dT_dt_xi[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_g)\n        dT_dt_xi[0, 1] = dT_dt_xi[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_g)\n        dT_dt_xi[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_g)\n        \n        # Now, compute the full ALE derivative\n        DT_Dt_ALE = np.zeros((2, 2))\n        DT_Dt_ALE[0, 0] = dT_dt_xi[0, 0] + np.dot(grad_T11, v_r)\n        DT_Dt_ALE[0, 1] = DT_Dt_ALE[1, 0] = dT_dt_xi[0, 1] + np.dot(grad_T12, v_r)\n        DT_Dt_ALE[1, 1] = dT_dt_xi[1, 1] + np.dot(grad_T22, v_r)\n\n        # --- Verification ---\n        # Compute maximum absolute component-wise difference\n        max_abs_diff = np.max(np.abs(DT_Dt_E - DT_Dt_ALE))\n        \n        results.append(max_abs_diff  delta)\n\n    # Print the results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3542191"}]}