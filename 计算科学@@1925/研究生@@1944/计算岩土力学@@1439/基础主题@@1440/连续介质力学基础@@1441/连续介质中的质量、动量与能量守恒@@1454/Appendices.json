{"hands_on_practices": [{"introduction": "连续介质力学中的一个基本概念是对物质运动的两种描述方法：空间（欧拉）描述和物质（拉格朗日）描述。本练习将挑战你从第一性原理出发，证明质量守恒的一个基本推论：在一个随材料一起移动和变形的物质控制体积内，其总质量是恒定的。通过应用雷诺输运定理和局部连续性方程，本练习将加深你对守恒律的积分形式和微分形式之间内在联系的理解。[@problem_id:3507662]", "problem": "考虑一个竖直的一维土柱，其横截面积 $A$ 为常数，空间坐标 $z$ 向上为正。连续介质密度为 $\\rho(z,t)$，物质速度场给定为 $v(z,t)=\\alpha\\, z$，其中 $\\alpha$ 是一个给定的常数，单位为时间的倒数。假设没有质量源或汇，并且所有场都足够光滑。\n\n定义一个随土柱伸展的控制体积：其下边界和上边界是物质点，在时间 $t=0$ 时初始位置为 $Z_{1}^{0}$ 和 $Z_{2}^{0}$，其当前位置分别为 $z_{1}(t)$ 和 $z_{2}(t)$，遵循运动学关系 $\\frac{dz_{1}}{dt}=v\\big(z_{1}(t),t\\big)$ 和 $\\frac{dz_{2}}{dt}=v\\big(z_{2}(t),t\\big)$。设该控制体积在时间 $t$ 的总质量为\n$$\nM(t)=\\int_{z_{1}(t)}^{z_{2}(t)} \\rho(z,t)\\,A\\,dz.\n$$\n\n仅从连续介质质量守恒的第一性原理和上述定义出发，推导该控制体积总质量变化率 $\\frac{dM}{dt}$ 的精确表达式，然后针对给定的速度场 $v(z,t)=\\alpha z$ 对其进行求值。请以单个简化表达式的形式给出最终结果。最终速率以千克/秒 (kg/s) 为单位表示。无需四舍五入。", "solution": "问题要求计算一维物质控制体积内总质量的变化率 $\\frac{dM}{dt}$。质量 $M(t)$ 由积分定义：\n$$\nM(t) = \\int_{z_{1}(t)}^{z_{2}(t)} \\rho(z,t)\\,A\\,dz\n$$\n其中 $A$ 是恒定的横截面积，$\\rho(z,t)$ 是连续介质密度，积分上下限 $z_{1}(t)$ 和 $z_{2}(t)$ 是物质点的位置，意味着它们的速度由物质速度场 $v(z,t)$ 给出。具体来说，$\\frac{dz_{1}}{dt} = v(z_{1}(t),t)$ 且 $\\frac{dz_{2}}{dt} = v(z_{2}(t),t)$。\n\n为了求得变化率 $\\frac{dM}{dt}$，我们必须对 $M(t)$ 的积分表达式关于时间 $t$ 求导。由于被积函数 $\\rho(z,t)$ 和积分上下限 $z_1(t)$ 和 $z_2(t)$ 都是时间的函数，我们必须应用莱布尼茨积分法则。面积 $A$ 是一个常数，可以从微分中提出。\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\left( A \\int_{z_{1}(t)}^{z_{2}(t)} \\rho(z,t) \\, dz \\right) = A \\frac{d}{dt} \\int_{z_{1}(t)}^{z_{2}(t)} \\rho(z,t) \\, dz\n$$\n应用莱布尼茨法则，即 $\\frac{d}{dt} \\int_{a(t)}^{b(t)} f(x,t) \\, dx = \\int_{a(t)}^{b(t)} \\frac{\\partial f}{\\partial t} \\, dx + f(b(t),t)\\frac{db}{dt} - f(a(t),t)\\frac{da}{dt}$，我们得到：\n$$\n\\frac{dM}{dt} = A \\left[ \\int_{z_{1}(t)}^{z_{2}(t)} \\frac{\\partial \\rho(z,t)}{\\partial t} \\, dz + \\rho(z_{2}(t),t) \\frac{dz_{2}}{dt} - \\rho(z_{1}(t),t) \\frac{dz_{1}}{dt} \\right]\n$$\n问题指明控制体积是物质体积，这意味着其边界随物质一起运动。边界的运动学关系给定为 $\\frac{dz_{1}}{dt} = v(z_{1}(t),t)$ 和 $\\frac{dz_{2}}{dt} = v(z_{2}(t),t)$。将这些关系代入 $\\frac{dM}{dt}$ 的表达式中：\n$$\n\\frac{dM}{dt} = A \\left[ \\int_{z_{1}(t)}^{z_{2}(t)} \\frac{\\partial \\rho}{\\partial t} \\, dz + \\rho(z_{2},t)v(z_{2},t) - \\rho(z_{1},t)v(z_{1},t) \\right]\n$$\n这个表达式是标量 $\\rho$ 的雷诺输运定理的一维形式。第一项表示固定体积内因密度变化引起的质量变化，而边界项表示穿过控制面的质量净通量。\n\n现在，我们引用连续介质质量守恒的第一性原理。在没有质量源或汇的情况下，该原理的局部或微分形式就是连续性方程。在一维情况下，连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho v)}{\\partial z} = 0\n$$\n这个方程是一个基本定律，必须在连续介质内的每个点 $(z,t)$ 都成立。\n\n让我们回到 $\\frac{dM}{dt}$ 的表达式。利用微积分基本定理，边界项可以改写为一个积分：\n$$\n\\rho(z_{2},t)v(z_{2},t) - \\rho(z_{1},t)v(z_{1},t) = \\int_{z_{1}(t)}^{z_{2}(t)} \\frac{\\partial}{\\partial z} \\left( \\rho(z,t)v(z,t) \\right) \\, dz\n$$\n将这个积分形式代回质量变化率的表达式中：\n$$\n\\frac{dM}{dt} = A \\left[ \\int_{z_{1}(t)}^{z_{2}(t)} \\frac{\\partial \\rho}{\\partial t} \\, dz + \\int_{z_{1}(t)}^{z_{2}(t)} \\frac{\\partial (\\rho v)}{\\partial z} \\, dz \\right]\n$$\n合并两个积分：\n$$\n\\frac{dM}{dt} = A \\int_{z_{1}(t)}^{z_{2}(t)} \\left( \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho v)}{\\partial z} \\right) \\, dz\n$$\n根据连续性方程，我们知道被积函数 $\\left( \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho v)}{\\partial z} \\right)$ 对所有 $z$ 和 $t$ 恒为零。因此，该积分为零。\n$$\n\\frac{dM}{dt} = A \\int_{z_{1}(t)}^{z_{2}(t)} 0 \\, dz = 0\n$$\n这个结果表明，物质控制体积内包含的总质量随时间保持不变，这是质量守恒原理的直接推论。该推导是通用的，对任何足够光滑的速度场 $v(z,t)$ 都成立，因为在得出最终结果的过程中并未使用速度场的具体形式。\n\n问题要求针对具体的速度场 $v(z,t) = \\alpha z$ 对此结果进行求值。由于我们推导出的 $\\frac{dM}{dt}$ 表达式为 $0$，与 $v(z,t)$ 的具体形式无关，因此对于这个特定情况，结果也是 $0$。最终速率为 $0$ 千克/秒。", "answer": "$$\n\\boxed{0}\n$$", "id": "3507662"}, {"introduction": "在岩土力学中，我们通常将如土壤和岩石之类的复杂材料建模为多相连续介质，并用孔隙度等宏观属性来描述它们。本练习将指导你推导在力学变形和化学反应共同作用下，多孔介质中孔隙度和宏观密度的演化规律。这个练习对于理解如何为耦合的热-水-力-化（THMC）过程建立本构模型至关重要，并且其中的编程部分将让你能够验证所推导方程的代数一致性。[@problem_id:3507660]", "problem": "考虑一个由固体骨架和孔隙填充流体组成的饱和多孔地质材料。设其体积质量密度由基于各相内在密度和孔隙度的混合法则定义。假设小应变运动学和明确定义的孔隙度场。采用以下定义和假设来构建您的推导和算法。\n\n定义：\n- 孔隙度用 $\\phi$ 表示，其中 $0 \\le \\phi \\le 1$，固体体积分数为 $1-\\phi$。\n- 固相内在质量密度为 $\\rho_s$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$），流体相内在质量密度为 $\\rho_f$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$）。\n- 体积质量密度为 $\\rho$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$）。\n- 塑性体积应变率为 $\\dot{\\varepsilon}_v^p$（单位 $\\mathrm{s}^{-1}$），定义为当骨架膨胀（体积增加）时为正。\n- 单位体积固相反应质量移除率为 $\\dot{m}_s^r$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）（溶解从体积中移除固体质量时为正）。\n- 固相内在密度变化率为 $\\dot{\\rho}_s$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）。\n- 假设在所考虑的时间尺度上，流体是不可压缩的或密度不变的，因此 $\\dot{\\rho}_f = 0$。\n\n基本出发点：\n- 体积质量密度的混合法则：$\\rho = (1-\\phi)\\rho_s + \\phi \\rho_f$。\n- 小应变下由于固体骨架的塑性体积变化和固相的反应性溶解引起的孔隙度变化的定义：通过结合固体分数的运动学体积变化以及使用固相内在密度 $\\rho_s$ 将单位体积的固体质量移除转化为等效的固体体积分数变化，从第一性原理推导 $\\dot{\\phi}$。\n\n任务：\n1. 基于上述基本原理，推导一个考虑塑性体积应变和反应性溶解的 $\\dot{\\phi}$ 表达式，该表达式用 $\\phi$、$\\dot{\\varepsilon}_v^p$、$\\dot{m}_s^r$ 和 $\\rho_s$ 表示。\n2. 从混合法则出发，通过一致地应用链式法则并结合上述假设，推导体积质量密度的时间变化率 $\\dot{\\rho}$。将此变化率表示为两种数学上等价的分解形式：一种是基于对 $\\rho = (1-\\phi)\\rho_s + \\phi \\rho_f$ 应用链式法则的形式，另一种是基于与 $\\phi$ 和 $\\rho_s$ 变化相关的分项贡献的形式，同时援引假设 $\\dot{\\rho}_f = 0$。证明对于任何允许的 $(\\phi, \\rho_s, \\rho_f, \\dot{\\phi}, \\dot{\\rho}_s)$，这两种分解是相同的。\n3. 实现一个程序，对于每个测试用例，计算任务1中的 $\\dot{\\phi}$，评估任务2中 $\\dot{\\rho}$ 的两种分解形式，并返回一个布尔值，指示它们的差值是否小于预设的容差。使用绝对容差 $\\tau = 10^{-12}$（无量纲）来判断相等性。如果绝对差值小于或等于 $\\tau$，则布尔值为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n单位和数据要求：\n- 使用无量纲的 $\\phi$。\n- 使用单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 的 $\\rho_s$ 和 $\\rho_f$。\n- 使用单位为 $\\mathrm{s}^{-1}$ 的 $\\dot{\\varepsilon}_v^p$。\n- 使用单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 的 $\\dot{m}_s^r$。\n- 使用单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 的 $\\dot{\\rho}_s$。\n\n测试套件：\n提供一个程序，评估以下五个涵盖典型、边缘和混合场景的案例：\n- 案例 A (典型): $\\phi = 0.25$, $\\rho_s = 2700\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_f = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\dot{\\varepsilon}_v^p = 2\\times 10^{-6}\\,\\mathrm{s}^{-1}$, $\\dot{m}_s^r = 1\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\dot{\\rho}_s = 0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n- 案例 B (近乎固体，沉淀和压实): $\\phi = 0.01$, $\\rho_s = 2650\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_f = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\dot{\\varepsilon}_v^p = 1\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $\\dot{m}_s^r = -1\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\dot{\\rho}_s = 1\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n- 案例 C (近乎流体，伴随溶解的膨胀): $\\phi = 0.99$, $\\rho_s = 2700\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_f = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\dot{\\varepsilon}_v^p = 5\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $\\dot{m}_s^r = 2\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\dot{\\rho}_s = 0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n- 案例 D (无反应的压实，固体可压缩性): $\\phi = 0.40$, $\\rho_s = 2700\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_f = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\dot{\\varepsilon}_v^p = -3\\times 10^{-6}\\,\\mathrm{s}^{-1}$, $\\dot{m}_s^r = 0\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\dot{\\rho}_s = 9\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n- 案例 E (混合岩性和盐水，强膨胀和溶解伴随密度降低): $\\phi = 0.60$, $\\rho_s = 2200\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_f = 1020\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\dot{\\varepsilon}_v^p = 1\\times 10^{-4}\\,\\mathrm{s}^{-1}$, $\\dot{m}_s^r = 5\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\dot{\\rho}_s = -2\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。\n\n最终输出规格：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\mathrm{True},\\mathrm{False},\\mathrm{True}]$）。对于上述五个案例，预期的输出列表包含按所列顺序（案例 A 到案例 E）排列的五个布尔值条目。", "solution": "用户在计算地质力学领域提供了一个科学上有效且定义明确的问题。该问题要求在饱和多孔介质中推导孔隙度和体积密度的关键演化方程，然后对推导出的表达式进行数值验证。推导将基于连续介质力学和混合物理论的基本原理，并遵循指定的假设。\n\n### 任务 1：孔隙度变化率（$\\dot{\\phi}$）的推导\n\n孔隙度 $\\phi$ 定义为孔隙体积 $V_p$ 与总体积 $V_b$ 之比，即 $\\phi = V_p / V_b$。孔隙度的变化率 $\\dot{\\phi}$ 源于问题中指定的两个不同物理过程：固体骨架的塑性变形和固相的反应性溶解或沉淀。我们在小应变假设下，分别推导每个过程的贡献，然后将它们组合起来。\n\n1.  **来自塑性体积应变（$\\dot{\\varepsilon}_v^p$）的贡献**：塑性体积应变率 $\\dot{\\varepsilon}_v^p$ 定义为归因于固体颗粒塑性重排的体积变化率。在此变形过程中，假设固体材料不可压缩。因此，由塑性变形引起的任何体积变化必须等于孔隙体积的变化，即 $\\dot{V}_b^p = \\dot{V}_p^p$。塑性体积应变率通过 $\\dot{\\varepsilon}_v^p = \\dot{V}_b^p / V_b$ 与体积变化相关。孔隙度的时间导数由商法则给出：\n    $$\n    \\dot{\\phi} = \\frac{d}{dt}\\left(\\frac{V_p}{V_b}\\right) = \\frac{\\dot{V}_p V_b - V_p \\dot{V}_b}{V_b^2} = \\frac{\\dot{V}_p}{V_b} - \\phi \\frac{\\dot{V}_b}{V_b}\n    $$\n    对于仅由塑性变形引起的变化，我们代入 $\\dot{V}_p = \\dot{V}_p^p$ 和 $\\dot{V}_b = \\dot{V}_b^p$：\n    $$\n    \\dot{\\phi}_{\\text{deform}} = \\frac{\\dot{V}_b^p}{V_b} - \\phi \\frac{\\dot{V}_b^p}{V_b} = \\dot{\\varepsilon}_v^p - \\phi \\dot{\\varepsilon}_v^p = (1-\\phi)\\dot{\\varepsilon}_v^p\n    $$\n    正的 $\\dot{\\varepsilon}_v^p$（膨胀）正确地导致孔隙度的增加。\n\n2.  **来自反应性质量传递（$\\dot{m}_s^r$）的贡献**：项 $\\dot{m}_s^r$ 表示单位体积的固体质量移除率（$\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）。除以固相内在密度 $\\rho_s$，得到单位体积的固体体积变化率：$\\dot{V}_s^r / V_b = -\\dot{m}_s^r/\\rho_s$。负号表示正的 $\\dot{m}_s^r$（溶解）会减小固体体积。在此过程中，移除的固体体积被孔隙流体替代，因此孔隙体积的变化与固体体积的变化大小相等，方向相反，即 $\\dot{V}_p^r = -\\dot{V}_s^r$。假设在此化学过程中，总体积保持不变，因此 $\\dot{V}_b^r = 0$。由此产生的孔隙度变化率为：\n    $$\n    \\dot{\\phi}_{\\text{react}} = \\frac{\\dot{V}_p^r}{V_b} - \\phi \\frac{\\dot{V}_b^r}{V_b} = \\frac{-\\dot{V}_s^r}{V_b} - 0 = \\frac{\\dot{m}_s^r}{\\rho_s}\n    $$\n\n3.  **总孔隙度变化率**：总孔隙度变化率是两个独立过程变化率的总和：\n    $$\n    \\dot{\\phi} = \\dot{\\phi}_{\\text{deform}} + \\dot{\\phi}_{\\text{react}} = (1-\\phi)\\dot{\\varepsilon}_v^p + \\frac{\\dot{m}_s^r}{\\rho_s}\n    $$\n    这是孔隙度变化率的最终表达式。\n\n### 任务 2：体积密度变化率（$\\dot{\\rho}$）的推导\n\n体积质量密度 $\\rho$ 由混合法则给出：\n$$\n\\rho = (1-\\phi)\\rho_s + \\phi \\rho_f\n$$\n我们被要求在假设流体不可压缩（$\\dot{\\rho}_f = 0$）的情况下，以两种等价形式推导其时间变化率 $\\dot{\\rho}$。\n\n**分解 1：逐项乘积法则**\n\n我们将体积密度视为两个乘积之和，$\\rho = [(1-\\phi)\\rho_s] + [\\phi\\rho_f]$，并对每一项应用乘积法则进行微分：\n$$\n\\dot{\\rho} = \\frac{d}{dt}[(1-\\phi)\\rho_s] + \\frac{d}{dt}[\\phi\\rho_f]\n$$\n$$\n\\dot{\\rho} = \\left[\\frac{d(1-\\phi)}{dt}\\rho_s + (1-\\phi)\\frac{d\\rho_s}{dt}\\right] + \\left[\\frac{d\\phi}{dt}\\rho_f + \\phi\\frac{d\\rho_f}{dt}\\right]\n$$\n代入变化率表示法和假设 $\\dot{\\rho}_f = 0$：\n$$\n\\dot{\\rho}_1 = [-\\dot{\\phi}\\rho_s + (1-\\phi)\\dot{\\rho}_s] + [\\dot{\\phi}\\rho_f + \\phi \\cdot 0]\n$$\n$$\n\\dot{\\rho}_1 = -\\dot{\\phi}\\rho_s + (1-\\phi)\\dot{\\rho}_s + \\dot{\\phi}\\rho_f\n$$\n\n**分解 2：多元链式法则**\n\n我们将体积密度 $\\rho$ 视为随时间变化的变量 $\\phi$、$\\rho_s$ 和 $\\rho_f$ 的函数，即 $\\rho(\\phi, \\rho_s, \\rho_f)$。其全时间导数由多元链式法则给出：\n$$\n\\dot{\\rho} = \\frac{\\partial \\rho}{\\partial \\phi}\\dot{\\phi} + \\frac{\\partial \\rho}{\\partial \\rho_s}\\dot{\\rho}_s + \\frac{\\partial \\rho}{\\partial \\rho_f}\\dot{\\rho}_f\n$$\n我们从 $\\rho$ 的定义计算偏导数：\n$$\n\\frac{\\partial \\rho}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi}((1-\\phi)\\rho_s + \\phi\\rho_f) = -\\rho_s + \\rho_f = -(\\rho_s - \\rho_f)\n$$\n$$\n\\frac{\\partial \\rho}{\\partial \\rho_s} = \\frac{\\partial}{\\partial \\rho_s}((1-\\phi)\\rho_s + \\phi\\rho_f) = 1-\\phi\n$$\n$$\n\\frac{\\partial \\rho}{\\partial \\rho_f} = \\frac{\\partial}{\\partial \\rho_f}((1-\\phi)\\rho_s + \\phi\\rho_f) = \\phi\n$$\n将这些偏导数代入链式法则表达式，并应用条件 $\\dot{\\rho}_f=0$：\n$$\n\\dot{\\rho}_2 = -(\\rho_s - \\rho_f)\\dot{\\phi} + (1-\\phi)\\dot{\\rho}_s + \\phi \\cdot 0\n$$\n$$\n\\dot{\\rho}_2 = (\\rho_f - \\rho_s)\\dot{\\phi} + (1-\\phi)\\dot{\\rho}_s\n$$\n\n**分解的等价性**\n\n为了证明两种分解是相同的，我们重新排列 $\\dot{\\rho}_1$ 的各项：\n$$\n\\dot{\\rho}_1 = -\\dot{\\phi}\\rho_s + (1-\\phi)\\dot{\\rho}_s + \\dot{\\phi}\\rho_f = \\dot{\\phi}(\\rho_f - \\rho_s) + (1-\\phi)\\dot{\\rho}_s\n$$\n这正是 $\\dot{\\rho}_2$ 的表达式。因此，$\\dot{\\rho}_1 \\equiv \\dot{\\rho}_2$，证明了它们对于任何允许的参数集在数学上是等价的。\n\n### 任务 3：算法实现\n\n提供的 Python 代码将为给定的测试用例实现这些推导出的公式。对于每个案例，算法将：\n1.  使用任务 1 中推导的表达式计算孔隙度变化率 $\\dot{\\phi}$。\n2.  使用任务 2 中推导的分解 1（$\\dot{\\rho}_1$）和分解 2（$\\dot{\\rho}_2$）计算体积密度变化率。\n3.  评估布尔条件 $|\\dot{\\rho}_1 - \\dot{\\rho}_2| \\le \\tau$，其中容差 $\\tau$ 为 $10^{-12}$。\n4.  收集所有测试用例的布尔结果，并以指定的列表格式打印。此检查在数值上确认了两种分解的代数恒等性，同时考虑了潜在的浮点表示差异。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the geomechanics problem by deriving and comparing expressions for bulk density rate.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (phi, rho_s, rho_f, dot_eps_vp, dot_ms_r, dot_rho_s)\n    # Units:\n    # phi: dimensionless\n    # rho_s, rho_f: kg/m^3\n    # dot_eps_vp: 1/s\n    # dot_ms_r: kg/m^3/s\n    # dot_rho_s: kg/m^3/s\n    test_cases = [\n        # Case A\n        (0.25, 2700.0, 1000.0, 2e-6, 1e-3, 0.0),\n        # Case B\n        (0.01, 2650.0, 1000.0, 1e-5, -1e-3, 1e-3),\n        # Case C\n        (0.99, 2700.0, 1000.0, 5e-5, 2e-4, 0.0),\n        # Case D\n        (0.40, 2700.0, 1000.0, -3e-6, 0.0, 9e-4),\n        # Case E\n        (0.60, 2200.0, 1020.0, 1e-4, 5e-3, -2e-3),\n    ]\n\n    # Prescribed tolerance for equality check\n    tolerance = 1e-12\n\n    results = []\n    for case in test_cases:\n        phi, rho_s, rho_f, dot_eps_vp, dot_ms_r, dot_rho_s = case\n\n        # Task 1: Calculate the rate of change of porosity, dot_phi\n        dot_phi = (1.0 - phi) * dot_eps_vp + dot_ms_r / rho_s\n\n        # Task 2: Calculate the rate of change of bulk density, dot_rho, using two decompositions.\n        # The assumption dot_rho_f = 0 is used.\n        \n        # Decomposition 1: Term-by-term product rule\n        # dot_rho = d/dt[(1-phi)*rho_s] + d/dt[phi*rho_f]\n        #         = [-dot_phi*rho_s + (1-phi)*dot_rho_s] + [dot_phi*rho_f + phi*dot_rho_f]\n        dot_rho_d1 = -dot_phi * rho_s + (1.0 - phi) * dot_rho_s + dot_phi * rho_f\n\n        # Decomposition 2: Multivariate chain rule\n        # dot_rho = (d_rho/d_phi)*dot_phi + (d_rho/d_rho_s)*dot_rho_s + (d_rho/d_rho_f)*dot_rho_f\n        #         = (rho_f - rho_s)*dot_phi + (1-phi)*dot_rho_s\n        dot_rho_d2 = (rho_f - rho_s) * dot_phi + (1.0 - phi) * dot_rho_s\n        \n        # Task 3: Compare the results of the two decompositions\n        # The two forms are algebraically identical, so any difference is due to\n        # floating point arithmetic. A tolerance check is appropriate.\n        is_equal = np.abs(dot_rho_d1 - dot_rho_d2) = tolerance\n        results.append(is_equal)\n\n    # Final print statement in the exact required format.\n    # np.bool_ is converted to Python's native bool for standard string representation.\n    print(f\"[{','.join(map(lambda x: str(bool(x)), results))}]\")\n\nsolve()\n```", "id": "3507660"}, {"introduction": "虽然连续介质的守恒定律是精确的，但其数值近似解可能会引入一些微妙的误差，从而影响模拟的物理真实性。这个高级练习旨在探讨孔隙弹塑性理论中的一个经典数值难题：在模拟近不可压缩材料的快速不排水加载时，可能出现的体积锁定和伪压力振荡。你将建立一个简化的离散模型，来量化这些非物理振荡所导致的局部质量守恒误差，从而深刻体会到选择稳定数值格式的重要性。[@problem_id:3507704]", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的一维饱和黏土杆承受快速轴向加载，加载期间的排水可忽略不计。该黏土被建模为线性孔隙弹性连续体，其基本定律和定义如下：\n\n- 孔隙流体质量守恒：$\\dfrac{d \\zeta}{dt} + \\nabla \\cdot \\mathbf{q} = 0$，其中 $\\zeta$ 是单位参考体积的流体含量增量，$\\mathbf{q}$ 是体积达西通量。\n- 多孔介质中流体流动的达西定律：$\\mathbf{q} = -\\dfrac{k}{\\mu} \\nabla p$，其中 $k$ 是固有渗透率，$\\mu$ 是孔隙流体的动力黏度，$p$ 是孔隙压力。\n- 孔隙弹性流体含量本构关系：$\\zeta = \\alpha \\varepsilon_v + c\\, p$，其中 $\\alpha$ 是 Biot 系数，$\\varepsilon_v$ 是体积应变，$c$ 是排出状态下多孔介质-流体系统的（有效）压缩性（量纲为压力的倒数）。\n- 准静态极限下的线性动量守恒：$\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$，其中 $\\boldsymbol{\\sigma}$ 是总应力张量，$\\mathbf{b}$ 是单位体积的体力；对于当前不计体力的一维杆，该方程简化为空间均匀的轴向应力 $\\sigma$。\n- 骨架的线弹性本构关系：$\\sigma' = K\\, \\varepsilon_v$，其中 $\\sigma'$ 是有效应力，$K$ 是骨架的排出状态体积模量；总应力为 $\\sigma = \\sigma' - \\alpha p$。\n\n在快速加载和近乎不透水的边界条件下，加载期间适用 $\\nabla \\cdot \\mathbf{q} \\approx 0$ 的假设，这反过来意味着 $\\dfrac{d \\zeta}{dt} \\approx 0$，并且不排水约束关联了体积应变增量和孔隙压力增量。您需要构建一个离散近似，以揭示不相容的离散选择（即位移和压力采用无稳定化的等阶插值）如何产生伪空间压力振荡（棋盘格模式），并导致局部质量守恒被违背，即使在全局不排水约束得到满足的情况下也是如此。\n\n离散模型与任务要求：\n\n1. 将杆离散为 $N$ 个均匀分布的节点，节点索引为 $i = 0, 1, \\dots, N-1$，节点间距均匀，为 $h = L/(N-1)$。\n2. 对不排水约束使用分段常数的单元平均表示，将 $N-1$ 个单元中的每一个与一个均匀的体积应变 $\\varepsilon_e$ 和一个单元平均孔隙压力 $p_e$ 相关联。假设压力表示为等阶（线性节点）形式，这使得单元平均压力 $p_e$ 等于单元两端两个节点压力的算术平均值。\n3. 在快速施加一个空间均匀的轴向应力增量 $\\Delta \\sigma$（因此准静态动量平衡适用且排水可忽略不计）的情况下，推导与上述基本定律一致的单元平均孔隙压力 $p_e$ 和相应的体积应变 $\\varepsilon_e$。\n4. 证明在使用等阶压力插值时，节点压力场 $p_i$ 由单元平均值决定是欠定的，并存在一个对应于棋盘格模式 $z_i = (-1)^i$ 的非平凡零空间。通过将振幅为 $\\gamma$ 的扰动叠加到均匀节点压力场上，来模拟伪压力振荡，即 $p_i = p_{\\text{uniform}} + \\gamma\\, (-1)^i$，其中 $p_{\\text{uniform}}$ 是单元平均压力的节点表示。假设扰动振幅与单元平均压力的量级以及代表数值误差的小扰动参数 $\\eta$ 成比例，并进一步允许一个简单的稳定化控制参数 $s \\ge 0$ 来抑制振荡，使得有效振幅为 $\\gamma_{\\text{eff}} = \\dfrac{\\eta\\, |p_e|}{1 + s}$。\n5. 将节点体积应变定义为相邻单元中的单元平均值 $\\varepsilon_e$，对于均匀杆和均匀加载，可以认为所有节点的该值都相同，即 $\\varepsilon_i = \\varepsilon_e$。\n6. 使用 $\\zeta_i = \\alpha \\varepsilon_i + c\\, p_i$ 计算每个节点的局部流体含量，并将由伪振荡引起的绝对流体质量违背量化为\n   $$\\Delta m_f^{\\text{abs}} = \\rho_f\\, A \\sum_{i=0}^{N-1} w_i\\, |\\zeta_i|,$$\n   其中 $\\rho_f$ 是孔隙流体的密度，$A$ 是杆的横截面积，$w_i$ 是梯形求积权重，其中 $w_0 = w_{N-1} = \\dfrac{h}{2}$ 且对于 $i = 1, \\dots, N-2$ 有 $w_i = h$。该量是局部流体含量绝对值在杆上的积分，乘以 $\\rho_f$ 转换为质量，并乘以 $A$ 以考虑横截面。\n7. 为与理论不排水响应进行比较，还应计算快速加载所隐含的体积应变 $\\varepsilon_e$，并注意当 $c$ 很小时，近乎不可压缩的条件应如何趋近于 $\\Delta \\varepsilon_v \\approx 0$。\n\n物理单位与最终输出要求：\n\n- $L$ 的单位为米，$A$ 的单位为平方米，$K$ 和 $\\Delta \\sigma$ 的单位为帕斯卡，$c$ 的单位为帕斯卡的倒数，$\\alpha$ 为无量纲，$\\rho_f$ 的单位为千克/立方米，并以千克为单位报告 $\\Delta m_f^{\\text{abs}}$。您可以将孔隙流体密度 $\\rho_f$ 视为给定参数。\n- 角度单位在此不适用。\n- 您的程序必须实现上述离散模型，为以下每个测试用例计算 $\\Delta m_f^{\\text{abs}}$，并生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n\n测试套件（每个用例是一个元组 $(N, L, A, K, \\alpha, c, \\Delta \\sigma, \\eta, s, \\rho_f)$）：\n\n- 用例1（具有中等压缩性和微小扰动的一般情况）：$(10, 1.0, 1.0, 5.0 \\times 10^{7}, 1.0, 1.0 \\times 10^{-9}, 1.0 \\times 10^{5}, 1.0 \\times 10^{-6}, 0.0, 1000.0)$\n- 用例2（近乎不可压缩的黏土，较大扰动，无稳定化）：$(10, 1.0, 1.0, 5.0 \\times 10^{7}, 1.0, 1.0 \\times 10^{-11}, 1.0 \\times 10^{5}, 1.0 \\times 10^{-3}, 0.0, 1000.0)$\n- 用例3（与用例2相同，但有稳定化抑制振荡）：$(10, 1.0, 1.0, 5.0 \\times 10^{7}, 1.0, 1.0 \\times 10^{-11}, 1.0 \\times 10^{5}, 1.0 \\times 10^{-3}, 10.0, 1000.0)$\n- 用例4（边界情况，具有非常快速的大应力增量，近乎不可压缩，无稳定化）：$(10, 1.0, 1.0, 5.0 \\times 10^{7}, 1.0, 1.0 \\times 10^{-11}, 5.0 \\times 10^{6}, 1.0 \\times 10^{-3}, 0.0, 1000.0)$\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_j$ 是相应测试用例的 $\\Delta m_f^{\\text{abs}}$ 值（以千克为单位），表示为浮点数。", "solution": "该问题要求计算一个数值伪影——局部流体质量违背——它源于孔隙弹性方程的不稳定离散化。任务的核心是基于指定的离散模型推导该违背的量级。\n\n推导过程如下。\n\n首先，我们确定不排水条件下的单元平均体积应变 $\\varepsilon_e$ 和孔隙压力 $p_e$。问题是针对快速加载增量提出的，其中流体总含量的变化 $\\zeta$ 为零。这提供了不排水约束。所有量都视为从零初始状态的增量。\n\n相关的本构方程和平衡方程是：\n1.  不排水约束（来自质量守恒）：$\\zeta = \\alpha \\varepsilon_v + c p = 0$。\n2.  骨架弹性响应：$\\sigma' = K \\varepsilon_v$。\n3.  总应力定义：$\\sigma = \\sigma' - \\alpha p$。\n\n在这里，$\\sigma$ 是总轴向应力，$\\sigma'$ 是有效轴向应力，$p$ 是孔隙压力，$\\varepsilon_v$ 是体积应变。材料参数是 Biot 系数 $\\alpha$、排出状态体积模量 $K$ 和压缩性 $c$。问题陈述施加了一个均匀的轴向应力增量 $\\Delta \\sigma$。遵循岩土力学中的标准惯例（拉为正），压应力为负。因此，我们设定总应力 $\\sigma = -\\Delta \\sigma$，其中 $\\Delta \\sigma$ 是测试用例中给出的正值。\n\n根据不排水约束(1)，我们用体积应变表示孔隙压力：\n$$p = -\\frac{\\alpha}{c} \\varepsilon_v$$\n将此式和骨架响应(2)代入总应力定义(3)：\n$$\\sigma = K \\varepsilon_v - \\alpha \\left( -\\frac{\\alpha}{c} \\varepsilon_v \\right)$$\n$$\\sigma = \\left( K + \\frac{\\alpha^2}{c} \\right) \\varepsilon_v$$\n这个组合表达式关联了不排水条件下的总应力和体积应变。项 $K_u = K + \\alpha^2/c$ 被称为不排水体积模量。\n\n由于这些方程对整体材料响应有效，因此它们在均匀应力 $\\sigma = -\\Delta \\sigma$ 下对单元平均量 $\\varepsilon_e$ 和 $p_e$ 也成立。我们现在可以求解 $\\varepsilon_e$：\n$$\\varepsilon_e = \\frac{\\sigma}{K + \\alpha^2/c} = \\frac{-\\Delta \\sigma}{K + \\alpha^2/c}$$\n这个结果是负值，对应于体积压缩，符合预期。\n\n接下来，我们求单元平均孔隙压力 $p_e$：\n$$p_e = -\\frac{\\alpha}{c} \\varepsilon_e = -\\frac{\\alpha}{c} \\left( \\frac{-\\Delta \\sigma}{K + \\alpha^2/c} \\right) = \\frac{\\alpha \\Delta \\sigma}{c K + \\alpha^2}$$\n这个压力是正值，表示由于压缩加载引起的孔隙压力增加。这些是正确的物理响应。\n\n然后，问题引入了一个伪压力振荡，即“棋盘格”模式，这是在数值模型中对位移和压力场使用等阶插值时已知的伪影。节点 $i$ 处的节点压力 $p_i$ 被建模为均匀单元平均压力 $p_e$ 与一个空间振荡分量的和：\n$$p_i = p_e + \\gamma_{\\text{eff}} (-1)^i$$\n其中振荡的有效振幅由下式给出：\n$$\\gamma_{\\text{eff}} = \\frac{\\eta |p_e|}{1 + s} = \\frac{\\eta p_e}{1 + s}$$\n我们使用 $|p_e| = p_e$，因为 $p_e$ 是正值。这里，$\\eta$ 是一个小扰动参数，$s$ 是一个稳定化参数。\n\n节点体积应变 $\\varepsilon_i$ 假定为均匀的，并等于单元平均应变，即 $\\varepsilon_i = \\varepsilon_e$。\n\n每个节点的局部流体含量 $\\zeta_i$ 使用孔隙弹性本构关系计算：\n$$\\zeta_i = \\alpha \\varepsilon_i + c p_i$$\n代入 $\\varepsilon_i$ 和 $p_i$ 的表达式：\n$$\\zeta_i = \\alpha \\varepsilon_e + c \\left( p_e + \\frac{\\eta p_e}{1 + s} (-1)^i \\right)$$\n$$\\zeta_i = (\\alpha \\varepsilon_e + c p_e) + c \\left( \\frac{\\eta p_e}{1 + s} \\right) (-1)^i$$\n由于单元平均不排水约束，项 $(\\alpha \\varepsilon_e + c p_e)$ 为零。因此，局部流体含量违背为：\n$$\\zeta_i = c \\left( \\frac{\\eta p_e}{1 + s} \\right) (-1)^i$$\n这个非零的 $\\zeta_i$ 代表由伪压力模式引起的局部质量守恒违背。\n\n最后的任务是通过对杆长度上的局部流体含量绝对值进行积分并转换为质量，来计算总绝对流体质量违背 $\\Delta m_f^{\\text{abs}}$。该积分使用梯形求积法通过求和来近似：\n$$\\Delta m_f^{\\text{abs}} = \\rho_f A \\sum_{i=0}^{N-1} w_i |\\zeta_i|$$\n其中 $\\rho_f$ 是流体密度，$A$ 是横截面积，$w_i$ 是梯形权重（$w_0 = w_{N-1} = h/2$，对于 $i=1, \\dots, N-2$ 有 $w_i = h$，其中 $h = L/(N-1)$）。\n\n局部流体含量的绝对值为：\n$$|\\zeta_i| = \\left| c \\left( \\frac{\\eta p_e}{1 + s} \\right) (-1)^i \\right| = c \\frac{\\eta p_e}{1 + s}$$\n这个值对所有节点都是常数，因为所有参数 $c, \\eta, p_e, s$ 都是非负的。\n\n求和变为：\n$$\\sum_{i=0}^{N-1} w_i |\\zeta_i| = \\left( c \\frac{\\eta p_e}{1 + s} \\right) \\sum_{i=0}^{N-1} w_i$$\n在整个域上，梯形权重的总和等于总长度 $L$：\n$$\\sum_{i=0}^{N-1} w_i = w_0 + \\sum_{i=1}^{N-2} w_i + w_{N-1} = \\frac{h}{2} + (N-2)h + \\frac{h}{2} = (N-1)h = (N-1) \\frac{L}{N-1} = L$$\n因此，积分的流体含量违背为 $L \\cdot |\\zeta_i|$。\n\n将此代回 $\\Delta m_f^{\\text{abs}}$ 的表达式：\n$$\\Delta m_f^{\\text{abs}} = \\rho_f A L \\left( c \\frac{\\eta p_e}{1 + s} \\right)$$\n最后，我们代入先前推导出的 $p_e$ 的表达式：\n$$\\Delta m_f^{\\text{abs}} = \\rho_f A L c \\frac{\\eta}{1 + s} \\left( \\frac{\\alpha \\Delta \\sigma}{c K + \\alpha^2} \\right)$$\n这简化为用于计算的最终公式：\n$$\\Delta m_f^{\\text{abs}} = \\frac{\\rho_f A L c \\alpha \\eta \\Delta \\sigma}{(c K + \\alpha^2)(1 + s)}$$\n该公式被实现用于每个测试用例，以计算所需结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelasticity problem for a series of test cases.\n    It calculates the fluid mass violation due to spurious pressure oscillations\n    in a discrete model of a saturated clay bar under rapid loading.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, L, A, K, alpha, c, delta_sigma, eta, s, rho_f)\n    test_cases = [\n        # Case 1 (general case with moderate compressibility and tiny perturbation)\n        (10, 1.0, 1.0, 5.0e7, 1.0, 1.0e-9, 1.0e5, 1.0e-6, 0.0, 1000.0),\n        # Case 2 (nearly incompressible clay, larger perturbation, no stabilization)\n        (10, 1.0, 1.0, 5.0e7, 1.0, 1.0e-11, 1.0e5, 1.0e-3, 0.0, 1000.0),\n        # Case 3 (same as Case 2 but with stabilization that damps oscillations)\n        (10, 1.0, 1.0, 5.0e7, 1.0, 1.0e-11, 1.0e5, 1.0e-3, 10.0, 1000.0),\n        # Case 4 (boundary case with very rapid large stress increment, nearly incompressible, no stabilization)\n        (10, 1.0, 1.0, 5.0e7, 1.0, 1.0e-11, 5.0e6, 1.0e-3, 0.0, 1000.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, L, A, K, alpha, c, delta_sigma, eta, s, rho_f = case\n\n        # The derivation in the solution text leads to the following closed-form expression\n        # for the absolute fluid mass violation (delta_m_f_abs). This formula\n        # directly implements the physics and numerical model described in the problem.\n        #\n        # delta_m_f_abs = rho_f * A * L * (c * alpha * eta * delta_sigma) / ((c * K + alpha**2) * (1 + s))\n        \n        # Numerator of the expression\n        numerator = rho_f * A * L * c * alpha * eta * delta_sigma\n        \n        # Denominator of the expression\n        denominator = (c * K + alpha**2) * (1 + s)\n        \n        # Calculate the fluid mass violation\n        delta_m_f_abs = numerator / denominator\n        \n        results.append(delta_m_f_abs)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3507704"}]}