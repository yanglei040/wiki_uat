{"hands_on_practices": [{"introduction": "第一个练习是 Cauchy 应力定理的一个基础应用。给定应力状态，你将计算作用在特定平面上的牵引力矢量。这个练习旨在强化 $\\boldsymbol{t} = \\boldsymbol{\\sigma} \\boldsymbol{n}$ 这一直接关系，并介绍将牵引力分解为法向和剪切分量的基本方法，这在许多地质力学分析中是至关重要的一步。[@problem_id:3568421]", "problem": "一个均匀的线弹性地质材料占据了三维欧几里得空间中的一个区域。考虑一个材料点，其内部应力状态由一个作用于有向面积微元上的二阶张量描述。从一个无穷小四面体上的局部线性动量平衡以及接触力可在表面上用连续分布表示的假设出发，推导在某点处，法向量为 $\\boldsymbol{n}$ 的平面上的面力矢量是 $\\boldsymbol{n}$ 的一个线性映射，该映射可用一个固定笛卡尔基下的二阶张量表示。利用局部角动量平衡的附加要求，确定该张量的对称性，并获得该基下面力矢量的分量形式的显式表示。\n\n然后，对于地质材料中某一特定的原位应力状态，在固定笛卡尔基 $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ 下某一点的柯西应力张量为\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n12  3  -2\\\\\n3  18  4\\\\\n-2  4  10\n\\end{pmatrix}\n\\;\\mathrm{MPa},\n$$\n且感兴趣的有向平面的单位法向量为\n$$\n\\boldsymbol{n} = \\frac{1}{3}\\,\\begin{pmatrix}2 \\\\ -1 \\\\ 2\\end{pmatrix}.\n$$\n\n使用你推导出的表示方法，计算：\n- 平面上的面力矢量 $\\boldsymbol{t}$，\n- 平面上的法向面力（有符号）$t_{n}$，以及\n- 平面上的剪切面力大小 $\\tau$，其定义为 $\\tau \\equiv \\sqrt{\\|\\boldsymbol{t}\\|^{2} - t_{n}^{2}}$。\n\n提供精确值，不要四舍五入。所有面力均以 $\\mathrm{MPa}$ 为单位表示。将你的最终答案以单行的形式报告，依次包含 $\\boldsymbol{t}$ 的三个分量，接着是 $t_{n}$，最后是 $\\tau$。", "solution": "该问题被评估为有效。它在科学上基于连续介质力学的原理，问题提出得当，提供了所有必要信息，并以客观、正式的语言陈述。该问题包含一个理论推导和一个数值应用，这是评估该领域理解程度的标准格式。\n\n问题的第一部分要求推导柯西应力定理，该定理通过一个二阶张量，即柯西应力张量 $\\boldsymbol{\\sigma}$，将任意平面上的面力矢量 $\\boldsymbol{t}$ 与该平面的单位法向量 $\\boldsymbol{n}$ 联系起来。该推导建立在无穷小体的线性动量平衡原理之上。第二部分要求证明角动量平衡导致应力张量的对称性。最后一部分是直接应用这些原理来计算特定量。\n\n**第1部分：面力矢量表示的推导**\n\n我们考虑一个无穷小四面体，其三个面与笛卡尔基矢量 $\\{\\boldsymbol{e}_1, \\boldsymbol{e}_2, \\boldsymbol{e}_3\\}$ 正交，第四个斜面具有向外的单位法向量 $\\boldsymbol{n}$。我们所考察的应力状态所在的点 $P$ 位于三个正交面相交的顶点。设斜面的面积为 $dA$。法向量为 $-\\boldsymbol{e}_1, -\\boldsymbol{e}_2, -\\boldsymbol{e}_3$ 的面的面积则分别为 $dA_1 = (\\boldsymbol{n} \\cdot \\boldsymbol{e}_1) dA = n_1 dA$，$dA_2 = n_2 dA$ 和 $dA_3 = n_3 dA$。\n\n斜面上的面力矢量记为 $\\boldsymbol{t}(\\boldsymbol{n})$，其他面上的面力矢量为 $\\boldsymbol{t}(-\\boldsymbol{e}_i)$。根据柯西公设（类似于牛顿第三定律在接触力上的应用），法向量为 $-\\boldsymbol{m}$ 的表面上的面力是法向量为 $\\boldsymbol{m}$ 的表面上面力的负值：$\\boldsymbol{t}(-\\boldsymbol{m}) = -\\boldsymbol{t}(\\boldsymbol{m})$。\n\n四面体的线性动量平衡由 $\\sum \\boldsymbol{F} = m\\boldsymbol{a}$ 给出。总力 $\\sum \\boldsymbol{F}$ 是表面力和体积力的总和。\n净表面力为：\n$$ \\boldsymbol{F}_s = \\boldsymbol{t}(\\boldsymbol{n}) dA + \\boldsymbol{t}(-\\boldsymbol{e}_1) dA_1 + \\boldsymbol{t}(-\\boldsymbol{e}_2) dA_2 + \\boldsymbol{t}(-\\boldsymbol{e}_3) dA_3 $$\n使用柯西公设和面积关系：\n$$ \\boldsymbol{F}_s = \\boldsymbol{t}(\\boldsymbol{n}) dA - \\boldsymbol{t}(\\boldsymbol{e}_1) n_1 dA - \\boldsymbol{t}(\\boldsymbol{e}_2) n_2 dA - \\boldsymbol{t}(\\boldsymbol{e}_3) n_3 dA = \\left( \\boldsymbol{t}(\\boldsymbol{n}) - \\sum_{i=1}^{3} n_i \\boldsymbol{t}(\\boldsymbol{e}_i) \\right) dA $$\n体积力为 $\\boldsymbol{F}_b = \\boldsymbol{b} dV$，其中 $\\boldsymbol{b}$ 是单位体积的体积力，$dV$ 是四面体的体积。体积为 $dV = \\frac{1}{3} h dA$，其中 $h$ 是从原点到斜面的高。质量为 $m = \\rho dV$，其中 $\\rho$ 是质量密度。\n\n运动方程为：\n$$ \\left( \\boldsymbol{t}(\\boldsymbol{n}) - \\sum_{i=1}^{3} n_i \\boldsymbol{t}(\\boldsymbol{e}_i) \\right) dA + \\boldsymbol{b} \\left(\\frac{1}{3} h dA\\right) = \\rho \\left(\\frac{1}{3} h dA\\right) \\boldsymbol{a} $$\n两边同除以 $dA$：\n$$ \\boldsymbol{t}(\\boldsymbol{n}) - \\sum_{i=1}^{3} n_i \\boldsymbol{t}(\\boldsymbol{e}_i) + \\frac{1}{3} h (\\boldsymbol{b} - \\rho\\boldsymbol{a}) = \\boldsymbol{0} $$\n为了求得点 $P$ 处的状态，我们将四面体缩小至零尺寸，即 $h \\to 0$。假设体积力 $\\boldsymbol{b}$ 和加速度 $\\boldsymbol{a}$ 是有界的，则与 $h$ 成正比的项消失。这就得到了柯西应力定理：\n$$ \\boldsymbol{t}(\\boldsymbol{n}) = \\sum_{j=1}^{3} n_j \\boldsymbol{t}(\\boldsymbol{e}_j) $$\n该方程表明，任何平面上的面力矢量都是坐标平面上面力矢量的线性组合。我们现在定义应力张量 $\\boldsymbol{\\sigma}$ 的分量。矢量 $\\boldsymbol{t}(\\boldsymbol{e}_j)$ 是法向量为 $\\boldsymbol{e}_j$ 的平面上的面力。它在基 $\\{\\boldsymbol{e}_i\\}$ 中的分量定义为 $\\sigma_{ij}$。即 $\\boldsymbol{t}(\\boldsymbol{e}_j) = \\sum_{i=1}^{3} \\sigma_{ij} \\boldsymbol{e}_i$。\n\n将此定义代入柯西定理：\n$$ \\boldsymbol{t}(\\boldsymbol{n}) = \\sum_{j=1}^{3} n_j \\left( \\sum_{i=1}^{3} \\sigma_{ij} \\boldsymbol{e}_i \\right) = \\sum_{i=1}^{3} \\left( \\sum_{j=1}^{3} \\sigma_{ij} n_j \\right) \\boldsymbol{e}_i $$\n因此，面力矢量 $\\boldsymbol{t}$ 的第 $i$ 个分量是 $t_i = \\sum_{j=1}^{3} \\sigma_{ij} n_j$。用矩阵表示法，这就是线性映射 $\\boldsymbol{t} = \\boldsymbol{\\sigma} \\boldsymbol{n}$。\n\n**第2部分：应力张量的对称性**\n\n应力张量的对称性 $\\sigma_{ij} = \\sigma_{ji}$ 是角动量平衡的结果，前提是假设不存在体力偶。考虑一个无穷小立方体微元。角动量平衡定律指出，净力矩等于角动量的变化率。在无穷小体积的极限下，并假设角加速度有界，净力矩必须为零。\n例如，绕 $\\boldsymbol{e}_3$ 轴的力矩分量是由立方体表面上的剪应力产生的。由应力分量 $\\sigma_{12}$ 在法向量为 $\\pm\\boldsymbol{e}_2$ 的面上产生的力形成一个力偶。同样，由 $\\sigma_{21}$ 在法向量为 $\\pm\\boldsymbol{e}_1$ 的面上产生的力形成另一个力偶。要使净力矩为零，这些力偶必须相互平衡，这要求 $\\sigma_{12} = \\sigma_{21}$。\n一个更正式的推导表明，对于任意体积 $V$ 的角动量平衡意味着 $\\int_V \\boldsymbol{A}(\\boldsymbol{\\sigma}^T) dV = \\boldsymbol{0}$，其中 $\\boldsymbol{A}$ 是 $\\boldsymbol{\\sigma}^T$ 的反对称部分的轴矢量。因为这对任意 $V$ 都必须成立，所以被积函数必须为零，这意味着 $\\boldsymbol{A}(\\boldsymbol{\\sigma}^T) = \\boldsymbol{0}$。这个条件等价于 $\\sigma_{ij} = \\sigma_{ji}$。因此，柯西应力张量是对称的。问题中给出的应力张量是对称的，这与这一基本原理是一致的。\n\n**第3部分：特定情况的计算**\n\n面力矢量的显式表示为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$。\n给定：\n$$ \\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n12  3  -2\\\\\n3  18  4\\\\\n-2  4  10\n\\end{pmatrix}\n\\;\\mathrm{MPa},\n\\quad\n\\boldsymbol{n} = \\frac{1}{3}\\,\\begin{pmatrix}2 \\\\ -1 \\\\ 2\\end{pmatrix}.\n$$\n\n1.  **计算面力矢量 $\\boldsymbol{t}$：**\n    $$\n    \\boldsymbol{t} = \\boldsymbol{\\sigma} \\boldsymbol{n} = \\frac{1}{3}\n    \\begin{pmatrix}\n    12  3  -2\\\\\n    3  18  4\\\\\n    -2  4  10\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    2 \\\\ -1 \\\\ 2\n    \\end{pmatrix}\n    = \\frac{1}{3}\n    \\begin{pmatrix}\n    (12)(2) + (3)(-1) + (-2)(2) \\\\\n    (3)(2) + (18)(-1) + (4)(2) \\\\\n    (-2)(2) + (4)(-1) + (10)(2)\n    \\end{pmatrix}\n    $$\n    $$\n    \\boldsymbol{t} = \\frac{1}{3}\n    \\begin{pmatrix}\n    24 - 3 - 4 \\\\\n    6 - 18 + 8 \\\\\n    -4 - 4 + 20\n    \\end{pmatrix}\n    = \\frac{1}{3}\n    \\begin{pmatrix}\n    17 \\\\ -4 \\\\ 12\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    \\frac{17}{3} \\\\ -\\frac{4}{3} \\\\ 4\n    \\end{pmatrix}\n    \\; \\mathrm{MPa}\n    $$\n    分量为 $t_1 = \\frac{17}{3}$，$t_2 = -\\frac{4}{3}$，以及 $t_3 = 4$。\n\n2.  **计算法向面力 $t_n$：**\n    法向面力是 $\\boldsymbol{t}$ 在 $\\boldsymbol{n}$ 上的标量投影：$t_n = \\boldsymbol{t} \\cdot \\boldsymbol{n}$。\n    $$\n    t_n =\n    \\begin{pmatrix}\n    \\frac{17}{3} \\\\ -\\frac{4}{3} \\\\ 4\n    \\end{pmatrix}\n    \\cdot\n    \\frac{1}{3}\n    \\begin{pmatrix}\n    2 \\\\ -1 \\\\ 2\n    \\end{pmatrix}\n    = \\frac{1}{9} \\left( (17)(2) + (-4)(-1) + (12)(2) \\right)\n    $$\n    $$\n    t_n = \\frac{1}{9} (34 + 4 + 24) = \\frac{62}{9} \\; \\mathrm{MPa}\n    $$\n\n3.  **计算剪切面力的大小 $\\tau$：**\n    剪切面力矢量是 $\\boldsymbol{t}_s = \\boldsymbol{t} - t_n \\boldsymbol{n}$。其大小 $\\tau$ 由 $\\tau = \\|\\boldsymbol{t}_s\\| = \\sqrt{\\|\\boldsymbol{t}\\|^2 - t_n^2}$ 给出。\n    首先，我们计算面力矢量大小的平方 $\\|\\boldsymbol{t}\\|^2$：\n    $$\n    \\|\\boldsymbol{t}\\|^2 = \\left(\\frac{17}{3}\\right)^2 + \\left(-\\frac{4}{3}\\right)^2 + (4)^2 = \\frac{289}{9} + \\frac{16}{9} + 16 = \\frac{305}{9} + \\frac{144}{9} = \\frac{449}{9}\n    $$\n    现在，我们计算 $\\tau^2$：\n    $$\n    \\tau^2 = \\|\\boldsymbol{t}\\|^2 - t_n^2 = \\frac{449}{9} - \\left(\\frac{62}{9}\\right)^2 = \\frac{449}{9} - \\frac{3844}{81}\n    $$\n    $$\n    \\tau^2 = \\frac{449 \\times 9}{81} - \\frac{3844}{81} = \\frac{4041 - 3844}{81} = \\frac{197}{81}\n    $$\n    因此，剪切面力的大小为：\n    $$\n    \\tau = \\sqrt{\\frac{197}{81}} = \\frac{\\sqrt{197}}{9} \\; \\mathrm{MPa}\n    $$\n所要求的最终答案依次包含 $\\boldsymbol{t}$ 的三个分量，接着是 $t_n$，然后是 $\\tau$。这些值为 $\\frac{17}{3}$、$-\\frac{4}{3}$、$4$、$\\frac{62}{9}$ 和 $\\frac{\\sqrt{197}}{9}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{17}{3}  -\\frac{4}{3}  4  \\frac{62}{9}  \\frac{\\sqrt{197}}{9} \\end{pmatrix}\n}\n$$", "id": "3568421"}, {"introduction": "这个计算练习旨在探索应力张量的一个深刻性质：其静水压力部分和偏量部分的不同作用。通过在给定的应力状态上增加一个静水压力，你将通过数值方法验证这种变换只影响法向牵引力，而剪切牵引力保持不变。这一原理对于理解材料行为至关重要，并且是地质力学软件中常用的验证测试。[@problem_id:3568373]", "problem": "要求您设计并实现一个用于三维连续体中静水应力平移的数值验证，作为计算地质力学中的代码验证步骤。从柯西应力原理出发：存在一个二阶张量 $\\boldsymbol{\\sigma}$，使得作用在具有单位法向量 $\\mathbf{n}$ 的平面上的面力矢量 $\\mathbf{t}(\\mathbf{n})$ 通过 $\\mathbf{t}(\\mathbf{n}) = \\boldsymbol{\\sigma}\\,\\mathbf{n}$ 线性依赖于 $\\mathbf{n}$。考虑应力张量经过一个标量压力 $p$ 乘以单位张量 $\\mathbf{I}$ 的静水应力平移，得到平移后的张量 $\\boldsymbol{\\sigma}^{\\prime} = \\boldsymbol{\\sigma} + p\\,\\mathbf{I}$。您的任务是针对几个给定的情况，系统地检验此平移对面力矢量及其相对于平面法线分解的影响。\n\n对于每种情况，执行以下操作：\n- 将每个给定的候选法向量 $\\mathbf{n}$ 归一化，以获得单位法向量 $\\widehat{\\mathbf{n}}$。\n- 计算 $\\mathbf{t}(\\widehat{\\mathbf{n}}) = \\boldsymbol{\\sigma}\\,\\widehat{\\mathbf{n}}$ 和 $\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) = \\boldsymbol{\\sigma}^{\\prime}\\,\\widehat{\\mathbf{n}}$。\n- 将面力分解为相对于 $\\widehat{\\mathbf{n}}$ 的法向和剪切部分：\n  - 法向分量：$t_{n} = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}(\\widehat{\\mathbf{n}})$ 和 $t_{n}^{\\prime} = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}})$。\n  - 剪切矢量：$\\mathbf{s} = \\mathbf{t}(\\widehat{\\mathbf{n}}) - t_{n}\\,\\widehat{\\mathbf{n}}$ 和 $\\mathbf{s}^{\\prime} = \\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) - t_{n}^{\\prime}\\,\\widehat{\\mathbf{n}}$。\n- 对该情况下的每个 $\\widehat{\\mathbf{n}}$ 验证两个条件：\n  1. 面力平移一致性：$\\left\\|\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) - \\left(\\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}}\\right)\\right\\|$ 在容差范围内。\n  2. 剪切不变量：$\\left\\|\\mathbf{s}^{\\prime} - \\mathbf{s}\\right\\|$ 在容差范围内。\n\n使用形式为 $\\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,S$ 的尺度感知容差，其中 $S$ 是被检查量的特征尺度。对于面力平移，使用 $S_{\\text{tr}} = \\max\\left(\\left\\|\\mathbf{t}(\\widehat{\\mathbf{n}})\\right\\| + |p|,\\,1\\right)$；对于剪切不变量，使用 $S_{\\text{sh}} = \\max\\left(\\left\\|\\mathbf{s}\\right\\|,\\,1\\right)$。使用 $\\varepsilon_{\\text{abs}} = 10^{-10}$ 和 $\\varepsilon_{\\text{rel}} = 10^{-10}$。所有计算都在三维空间中进行，其中柯西应力由一个对称的 $3\\times 3$ 张量表示。如果需要物理单位，可将应力和压力解释为以帕斯卡 (Pa) 为单位，但最终输出是无量纲的布尔值；无需打印任何单位。\n\n实现一个程序来评估以下测试套件。每个测试用例由一个应力张量 $\\boldsymbol{\\sigma}^{(k)}$、一个标量 $p^{(k)}$ 和一组候选法向量 $\\mathcal{N}^{(k)}$ 组成。您的程序必须为每个用例输出一个布尔值，当且仅当该用例中的所有法向量都满足两个验证条件时，该值为 $\\text{True}$。\n\n- 用例 $1$ (一般对称应力，非零平移):\n  $$\\boldsymbol{\\sigma}^{(1)} = \\begin{bmatrix} 12.3  -2.1  0.7 \\\\ -2.1  8.4  -1.3 \\\\ 0.7  -1.3  5.9 \\end{bmatrix},\\quad p^{(1)} = 5.0,$$\n  $$\\mathcal{N}^{(1)} = \\left\\{[1,\\,0,\\,0],\\;[1,\\,1,\\,1],\\;[0.2,\\,-0.9,\\,0.4]\\right\\}.$$\n\n- 用例 $2$ (平移后为纯静水应力，负压力):\n  $$\\boldsymbol{\\sigma}^{(2)} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix},\\quad p^{(2)} = -3.2,$$\n  $$\\mathcal{N}^{(2)} = \\left\\{[0,\\,0,\\,1],\\;[-1,\\,0,\\,0],\\;[0.5,\\,0.8660254037844386,\\,0]\\right\\}.$$\n\n- 用例 $3$ (非平凡应力，零平移):\n  $$\\boldsymbol{\\sigma}^{(3)} = \\begin{bmatrix} 1000.0  -200.0  50.0 \\\\ -200.0  500.0  30.0 \\\\ 50.0  30.0  800.0 \\end{bmatrix},\\quad p^{(3)} = 0.0,$$\n  $$\\mathcal{N}^{(3)} = \\left\\{[0.3,\\,0.4,\\,0.8660254037844386],\\;[-0.48,\\,0.56,\\,-0.672],\\;[0.1,\\,-0.3,\\,0.9473684210526315]\\right\\}.$$\n\n- 用例 $4$ (应力为静水应力，平移抵消之):\n  $$\\boldsymbol{\\sigma}^{(4)} = 7.7\\,\\mathbf{I},\\quad p^{(4)} = -7.7,$$\n  $$\\mathcal{N}^{(4)} = \\left\\{[1,\\,0,\\,0],\\;[0,\\,1,\\,0],\\;[0,\\,0,\\,1],\\;[-0.3,\\,0.6,\\,-0.7416198487095663]\\right\\}.$$\n\n- 用例 $5$ (大偏应力值，微小平移，法线接近坐标轴):\n  $$\\boldsymbol{\\sigma}^{(5)} = \\begin{bmatrix} 1.0\\times 10^{6}  2.0\\times 10^{4}  -3.0\\times 10^{4} \\\\ 2.0\\times 10^{4}  1.5\\times 10^{6}  1.0\\times 10^{4} \\\\ -3.0\\times 10^{4}  1.0\\times 10^{4}  0.9\\times 10^{6} \\end{bmatrix},\\quad p^{(5)} = 1.0\\times 10^{-12},$$\n  $$\\mathcal{N}^{(5)} = \\left\\{[1.0,\\,1.0\\times 10^{-12},\\,0.0],\\;[1.0\\times 10^{-12},\\,1.0,\\,0.0],\\;[0.0,\\,0.0,\\,1.0]\\right\\}.$$\n\n每个用例的判定规则：如果对于每个 $\\widehat{\\mathbf{n}}\\in \\mathcal{N}^{(k)}$，\n- 面力平移一致性残差受限于 $\\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,S_{\\text{tr}}$，并且\n- 剪切不变量残差受限于 $\\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,S_{\\text{sh}}$，则返回 $\\text{True}$。\n\n您的程序应生成单行输出，其中包含一个用逗号分隔并用方括号括起来的结果列表（例如，格式类似于 Python 列表：“[True,False,...]”）。不应打印任何额外文本。不涉及角度；不需要角度单位。所有数值比较必须使用指定的容差。", "solution": "用户提供的问题是计算地质力学领域的一项任务，具体是为一个代码设计数值验证测试。该验证涉及静水应力平移对面力矢量的影响，此影响由柯西应力原理推导得出。该问题在科学上是有效的，提法是适定的，并为完整解决方案提供了所有必要信息。\n\n问题的核心在于柯西应力张量在静水应力平移下的两个可解析推导的基本性质。我们将首先推导这些性质，然后描述用于验证它们的数值算法。\n\n设 $\\boldsymbol{\\sigma}$ 为一个对称的二阶柯西应力张量。根据柯西原理，作用在具有单位法向量 $\\widehat{\\mathbf{n}}$ 的表面上的面力矢量 $\\mathbf{t}$ 由以下线性变换给出：\n$$\n\\mathbf{t}(\\widehat{\\mathbf{n}}) = \\boldsymbol{\\sigma}\\,\\widehat{\\mathbf{n}}\n$$\n应力状态由标量压力 $p$ 引起的静水应力平移由以下变换定义：\n$$\n\\boldsymbol{\\sigma}^{\\prime} = \\boldsymbol{\\sigma} + p\\,\\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是二阶单位张量。新的应力张量 $\\boldsymbol{\\sigma}^{\\prime}$ 在同一表面上产生新的面力矢量 $\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}})$：\n$$\n\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) = \\boldsymbol{\\sigma}^{\\prime}\\,\\widehat{\\mathbf{n}}\n$$\n\n需要验证的两个性质是：\n1.  **面力平移一致性：** 原始面力 $\\mathbf{t}$ 与平移后面力 $\\mathbf{t}^{\\prime}$ 之间的关系。\n2.  **剪切不变量：** 静水应力平移对面力矢量剪切分量的影响。\n\n让我们推导这些性质的精确解析形式。\n\n**1. 面力平移一致性的推导**\n\n我们将 $\\boldsymbol{\\sigma}^{\\prime}$ 的定义代入 $\\mathbf{t}^{\\prime}$ 的方程中：\n$$\n\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) = (\\boldsymbol{\\sigma} + p\\,\\mathbf{I})\\,\\widehat{\\mathbf{n}}\n$$\n根据张量-矢量积的线性性质，我们可以分配 $\\widehat{\\mathbf{n}}$：\n$$\n\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) = \\boldsymbol{\\sigma}\\,\\widehat{\\mathbf{n}} + (p\\,\\mathbf{I})\\,\\widehat{\\mathbf{n}}\n$$\n注意到 $\\boldsymbol{\\sigma}\\,\\widehat{\\mathbf{n}} = \\mathbf{t}(\\widehat{\\mathbf{n}})$ 并且单位张量作用于任何矢量都得到该矢量本身（$\\mathbf{I}\\,\\widehat{\\mathbf{n}} = \\widehat{\\mathbf{n}}$），我们有：\n$$\n\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) = \\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}}\n$$\n这个方程表明，新的面力矢量就是原始面力矢量加上一个大小为 $p$ 且与表面法线 $\\widehat{\\mathbf{n}}$ 方向一致的矢量。第一个验证条件是对该恒等式的数值检验：\n$$\n\\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) - \\left(\\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}}\\right) = \\mathbf{0}\n$$\n\n**2. 剪切不变量的推导**\n\n面力矢量 $\\mathbf{t}$可以分解为一个法向分量 $t_n$（垂直于表面作用）和一个剪切矢量 $\\mathbf{s}$（与表面相切作用）。法向分量是 $\\mathbf{t}$ 在法向量 $\\widehat{\\mathbf{n}}$ 上的投影：\n$$\nt_n = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}(\\widehat{\\mathbf{n}})\n$$\n剪切矢量是面力矢量减去其法向部分后的剩余部分：\n$$\n\\mathbf{s} = \\mathbf{t}(\\widehat{\\mathbf{n}}) - t_n\\,\\widehat{\\mathbf{n}}\n$$\n类似地，对于平移后的应力状态，我们有一个新的法向分量 $t_n^{\\prime}$ 和一个新的剪切矢量 $\\mathbf{s}^{\\prime}$：\n$$\nt_n^{\\prime} = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}})\n$$\n$$\n\\mathbf{s}^{\\prime} = \\mathbf{t}^{\\prime}(\\widehat{\\mathbf{n}}) - t_n^{\\prime}\\,\\widehat{\\mathbf{n}}\n$$\n为了找到 $\\mathbf{s}$ 和 $\\mathbf{s}^{\\prime}$ 之间的关系，我们首先用原始量来表示 $t_n^{\\prime}$。使用面力平移推导的结果：\n$$\nt_n^{\\prime} = \\widehat{\\mathbf{n}} \\cdot (\\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}})\n$$\n利用点积的线性性质：\n$$\nt_n^{\\prime} = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}(\\widehat{\\mathbf{n}}) + \\widehat{\\mathbf{n}} \\cdot (p\\,\\widehat{\\mathbf{n}}) = t_n + p\\,(\\widehat{\\mathbf{n}} \\cdot \\widehat{\\mathbf{n}})\n$$\n由于 $\\widehat{\\mathbf{n}}$ 是一个单位矢量，$\\widehat{\\mathbf{n}} \\cdot \\widehat{\\mathbf{n}} = \\|\\widehat{\\mathbf{n}}\\|^2 = 1$。因此：\n$$\nt_n^{\\prime} = t_n + p\n$$\n法向应力分量恰好平移了所施加的压力 $p$。现在我们可以将 $\\mathbf{t}^{\\prime}$ 和 $t_n^{\\prime}$ 的表达式代入 $\\mathbf{s}^{\\prime}$ 的方程中：\n$$\n\\mathbf{s}^{\\prime} = (\\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}}) - (t_n + p)\\,\\widehat{\\mathbf{n}}\n$$\n分配各项可得：\n$$\n\\mathbf{s}^{\\prime} = \\mathbf{t}(\\widehat{\\mathbf{n}}) + p\\,\\widehat{\\mathbf{n}} - t_n\\,\\widehat{\\mathbf{n}} - p\\,\\widehat{\\mathbf{n}} = \\mathbf{t}(\\widehat{\\mathbf{n}}) - t_n\\,\\widehat{\\mathbf{n}}\n$$\n这恰好是原始剪切矢量 $\\mathbf{s}$ 的定义。因此，我们得到恒等式：\n$$\n\\mathbf{s}^{\\prime} = \\mathbf{s}\n$$\n这表明面力矢量的剪切分量在静水应力平移下是不变的。第二个验证条件是对该恒等式的数值检验：\n$$\n\\mathbf{s}^{\\prime} - \\mathbf{s} = \\mathbf{0}\n$$\n\n**数值实现算法**\n\n所给问题要求编写一个程序，为几个测试用例验证这两个恒等式。由于数字计算机使用浮点运算，这些恒等式只在一定的数值精度内成立。因此，验证过程必须检查这些方程的残差是否小于定义的容差。对于每个由应力张量 $\\boldsymbol{\\sigma}^{(k)}$、标量压力 $p^{(k)}$ 和一组候选法向量 $\\mathcal{N}^{(k)}$ 组成的测试用例，其算法如下：\n\n对于集合 $\\mathcal{N}^{(k)}$ 中的每个候选法向量 $\\mathbf{n}$：\n1.  **归一化：** 计算欧几里得范数 $\\|\\mathbf{n}\\|$ 并将该矢量归一化以获得单位法向量 $\\widehat{\\mathbf{n}} = \\mathbf{n} / \\|\\mathbf{n}\\|$。如果 $\\|\\mathbf{n}\\| = 0$，则该矢量无效，但此情况并未在测试套件中出现。\n2.  **面力计算：**\n    -   计算原始面力矢量 $\\mathbf{t} = \\boldsymbol{\\sigma}^{(k)}\\,\\widehat{\\mathbf{n}}$。\n    -   计算平移后的应力张量 $\\boldsymbol{\\sigma}^{\\prime} = \\boldsymbol{\\sigma}^{(k)} + p^{(k)}\\,\\mathbf{I}$。\n    -   计算平移后的面力矢量 $\\mathbf{t}^{\\prime} = \\boldsymbol{\\sigma}^{\\prime}\\,\\widehat{\\mathbf{n}}$。\n3.  **面力分解：**\n    -   计算原始法向分量 $t_n = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}$ 和剪切矢量 $\\mathbf{s} = \\mathbf{t} - t_n\\,\\widehat{\\mathbf{n}}$。\n    -   计算平移后的法向分量 $t_n^{\\prime} = \\widehat{\\mathbf{n}} \\cdot \\mathbf{t}^{\\prime}$ 和剪切矢量 $\\mathbf{s}^{\\prime} = \\mathbf{t}^{\\prime} - t_n^{\\prime}\\,\\widehat{\\mathbf{n}}$。\n4.  **验证条件 1 (面力平移)：**\n    -   计算残差矢量：$\\boldsymbol{\\delta}_{\\text{tr}} = \\mathbf{t}^{\\prime} - (\\mathbf{t} + p^{(k)}\\,\\widehat{\\mathbf{n}})$。\n    -   计算误差为残差的范数：$E_{\\text{tr}} = \\|\\boldsymbol{\\delta}_{\\text{tr}}\\|$。\n    -   计算尺度因子：$S_{\\text{tr}} = \\max(\\|\\mathbf{t}\\| + |p^{(k)}|,\\,1)$。\n    -   计算容差：$T_{\\text{tr}} = \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,S_{\\text{tr}}$，其中 $\\varepsilon_{\\text{abs}} = 10^{-10}$ 且 $\\varepsilon_{\\text{rel}} = 10^{-10}$。\n    -   检查是否 $E_{\\text{tr}} \\leq T_{\\text{tr}}$。\n5.  **验证条件 2 (剪切不变量)：**\n    -   计算残差矢量：$\\boldsymbol{\\delta}_{\\text{sh}} = \\mathbf{s}^{\\prime} - \\mathbf{s}$。\n    -   计算误差为残差的范数：$E_{\\text{sh}} = \\|\\boldsymbol{\\delta}_{\\text{sh}}\\|$。\n    -   计算尺度因子：$S_{\\text{sh}} = \\max(\\|\\mathbf{s}\\|,\\,1)$。\n    -   计算容差：$T_{\\text{sh}} = \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,S_{\\text{sh}}$。\n    -   检查是否 $E_{\\text{sh}} \\leq T_{\\text{sh}}$。\n6.  **用例判定：** 一个测试用例通过并返回 $\\text{True}$，当且仅当其集合 $\\mathcal{N}^{(k)}$ 中的所有法向量都满足两个条件。如果任何一个法向量的任何一个检查失败，则整个用例失败并返回 $\\text{False}$。\n\n该算法将针对五个指定的测试用例进行实现。鉴于解析推导，所有用例都预期会通过，从而成功地验证了数值实现与已知解析解的一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics verification problem.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"sigma\": np.array([\n                [12.3, -2.1, 0.7],\n                [-2.1, 8.4, -1.3],\n                [0.7, -1.3, 5.9]\n            ]),\n            \"p\": 5.0,\n            \"normals\": [\n                np.array([1., 0., 0.]),\n                np.array([1., 1., 1.]),\n                np.array([0.2, -0.9, 0.4])\n            ]\n        },\n        {\n            \"sigma\": np.array([\n                [0., 0., 0.],\n                [0., 0., 0.],\n                [0., 0., 0.]\n            ]),\n            \"p\": -3.2,\n            \"normals\": [\n                np.array([0., 0., 1.]),\n                np.array([-1., 0., 0.]),\n                np.array([0.5, 0.8660254037844386, 0.])\n            ]\n        },\n        {\n            \"sigma\": np.array([\n                [1000.0, -200.0, 50.0],\n                [-200.0, 500.0, 30.0],\n                [50.0, 30.0, 800.0]\n            ]),\n            \"p\": 0.0,\n            \"normals\": [\n                np.array([0.3, 0.4, 0.8660254037844386]),\n                np.array([-0.48, 0.56, -0.672]),\n                np.array([0.1, -0.3, 0.9473684210526315])\n            ]\n        },\n        {\n            \"sigma\": 7.7 * np.identity(3),\n            \"p\": -7.7,\n            \"normals\": [\n                np.array([1., 0., 0.]),\n                np.array([0., 1., 0.]),\n                np.array([0., 0., 1.]),\n                np.array([-0.3, 0.6, -0.7416198487095663])\n            ]\n        },\n        {\n            \"sigma\": np.array([\n                [1.0e6, 2.0e4, -3.0e4],\n                [2.0e4, 1.5e6, 1.0e4],\n                [-3.0e4, 1.0e4, 0.9e6]\n            ]),\n            \"p\": 1.0e-12,\n            \"normals\": [\n                np.array([1.0, 1.0e-12, 0.0]),\n                np.array([1.0e-12, 1.0, 0.0]),\n                np.array([0.0, 0.0, 1.0])\n            ]\n        }\n    ]\n\n    results = []\n    \n    eps_abs = 1e-10\n    eps_rel = 1e-10\n    I = np.identity(3)\n\n    for case in test_cases:\n        sigma = case[\"sigma\"]\n        p = case[\"p\"]\n        normals = case[\"normals\"]\n        \n        case_passes = True\n        for n_vec in normals:\n            # 1. Normalize the normal vector\n            norm_n = np.linalg.norm(n_vec)\n            if norm_n == 0:\n                # A zero vector cannot be a normal. This case automatically fails.\n                case_passes = False\n                break\n            n_hat = n_vec / norm_n\n\n            # 2. Compute original and shifted tractions\n            sigma_prime = sigma + p * I\n            t = sigma @ n_hat\n            t_prime = sigma_prime @ n_hat\n\n            # 3. Decompose tractions into normal and shear parts\n            t_n = np.dot(n_hat, t)\n            t_n_prime = np.dot(n_hat, t_prime)\n            s = t - t_n * n_hat\n            s_prime = t_prime - t_n_prime * n_hat\n\n            # 4. Verify traction shift consistency\n            # Analytically: t_prime = t + p * n_hat\n            residual_tr = t_prime - (t + p * n_hat)\n            norm_residual_tr = np.linalg.norm(residual_tr)\n            \n            S_tr = max(np.linalg.norm(t) + abs(p), 1.0)\n            tol_tr = eps_abs + eps_rel * S_tr\n\n            if norm_residual_tr > tol_tr:\n                case_passes = False\n                break\n\n            # 5. Verify shear invariance\n            # Analytically: s_prime = s\n            residual_sh = s_prime - s\n            norm_residual_sh = np.linalg.norm(residual_sh)\n\n            S_sh = max(np.linalg.norm(s), 1.0)\n            tol_sh = eps_abs + eps_rel * S_sh\n\n            if norm_residual_sh > tol_sh:\n                case_passes = False\n                break\n        \n        results.append(case_passes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3568373"}, {"introduction": "最后一个练习将抽象的应力概念与一个关键的工程应用——预测材料破坏联系起来。利用 Mohr-Coulomb 破坏准则，你将确定在给定应力状态下最容易发生破坏的平面的方位。这个练习展示了应力分析（特别是特征分解）在评估地质材料稳定性方面的强大作用。[@problem_id:3568425]", "problem": "一种均质地质材料在笛卡尔实验室坐标系中受到一个静态三维柯西应力张量 $\\boldsymbol{\\sigma}$ 的作用，其中拉伸应力为正。使用的莫尔-库仑强度准则形式为 $|\\tau| = c - \\sigma_{n} \\tan \\phi$，其中 $\\sigma_{n}$ 是潜在破坏面上的法向牵引力，$\\tau$ 是该平面上剪切牵引力的大小，$c$ 是内聚力，$\\phi$ 是摩擦角。给定以下数据：\n- 柯西应力张量为\n$$\n\\boldsymbol{\\sigma} = \n\\begin{pmatrix}\n-60  -20  0 \\\\\n-20  -60  0 \\\\\n0  0  -40\n\\end{pmatrix} \\text{ MPa}.\n$$\n- 摩擦角为 $\\phi = 0.523599$ 弧度。\n- 法向牵引力的符号约定为拉伸为正，因此压缩对应负的 $\\sigma_{n}$。\n\n从柯西应力原理（单位法向量为 $\\boldsymbol{n}$ 的平面上的牵引力矢量 $\\boldsymbol{t}(\\boldsymbol{n}) = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$）、法向牵引力的定义 $\\sigma_{n}(\\boldsymbol{n}) = \\boldsymbol{n}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$ 以及剪切牵引力大小的定义 $|\\tau(\\boldsymbol{n})| = \\sqrt{\\boldsymbol{t}\\!\\cdot\\!\\boldsymbol{t} - \\sigma_{n}^{2}}$ 的第一性原理出发，解析地确定在单调加载下首先满足莫尔-库仑等式 $|\\tau| = c - \\sigma_{n}\\tan\\phi$ 的平面的单位法向量方向 $\\boldsymbol{n}^{\\ast}$，即该方向能使标量函数 $h(\\boldsymbol{n}) = |\\tau(\\boldsymbol{n})| + \\sigma_{n}(\\boldsymbol{n}) \\tan \\phi$ 最大化。使用 $\\boldsymbol{\\sigma}$ 的特征分解将搜索范围缩减为一个单参数的平面法线族，并在原始实验室坐标系中明确地构造出 $\\boldsymbol{n}^{\\ast}$。\n\n然后，通过对该单参数族进行直接搜索，以数值方式验证您解析推导出的 $\\boldsymbol{n}^{\\ast}$ 确实能使 $h(\\boldsymbol{n})$ 最大化。\n\n说明：\n- 您引入的任何角度都用弧度表示。\n- 将最终单位法向量 $\\boldsymbol{n}^{\\ast}$ 的每个分量四舍五入到四位有效数字。\n- 最终答案应以 $\\boldsymbol{n}^{\\ast}$ 在原始实验室坐标基下的三个分量的形式提供。", "solution": "问题是根据莫尔-库仑准则，在给定的应力状态下，找到最容易破坏的平面的方向，该方向由其单位法向量 $\\boldsymbol{n}^{\\ast}$ 定义。这个平面就是使函数 $h(\\boldsymbol{n}) = |\\tau(\\boldsymbol{n})| + \\sigma_{n}(\\boldsymbol{n}) \\tan \\phi$ 最大化的平面。\n\n求解过程分为以下几个步骤：\n1.  求给定柯西应力张量 $\\boldsymbol{\\sigma}$ 的主应力（特征值）和主方向（特征向量）。\n2.  在主坐标系中表示法向牵引力 $\\sigma_n$ 和剪切牵引力大小 $|\\tau|$。\n3.  利用应力状态的对称性，将问题简化为单参数优化问题。\n4.  解析地求出使函数 $h$ 最大化的角度。\n5.  在原始实验室坐标系中构造单位法向量 $\\boldsymbol{n}^{\\ast}$。\n6.  对结果进行数值验证。\n\n**1. 应力张量的特征分解**\n\n给定的柯西应力张量为：\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n-60  -20  0 \\\\\n-20  -60  0 \\\\\n0  0  -40\n\\end{pmatrix} \\text{ MPa}\n$$\n主应力 $\\lambda$ 是 $\\boldsymbol{\\sigma}$ 的特征值，通过求解特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda \\boldsymbol{I}) = 0$ 得到：\n$$\n\\det\n\\begin{pmatrix}\n-60-\\lambda  -20  0 \\\\\n-20  -60-\\lambda  0 \\\\\n0  0  -40-\\lambda\n\\end{pmatrix} = (-40-\\lambda) [(-60-\\lambda)^2 - (-20)^2] = 0\n$$\n一个特征值立即可得 $\\lambda = -40$。其他特征值由 $(-60-\\lambda)^2 = 400$ 给出，解得 $-60-\\lambda = \\pm 20$。这给出 $\\lambda = -80$ 和 $\\lambda = -40$。\n主应力按照 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$ 排序为：\n$\\sigma_1 = -40 \\text{ MPa}$\n$\\sigma_2 = -40 \\text{ MPa}$\n$\\sigma_3 = -80 \\text{ MPa}$\n\n接下来，我们求相应的主方向（特征向量）。\n对于 $\\sigma_3 = -80 \\text{ MPa}$：\n$(\\boldsymbol{\\sigma} - (-80)\\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0} \\implies \\begin{pmatrix} 20  -20  0 \\\\ -20  20  0 \\\\ 0  0  40 \\end{pmatrix} \\boldsymbol{v} = \\boldsymbol{0}$。这给出 $v_1=v_2$ 和 $v_3=0$。归一化的特征向量为 $\\boldsymbol{e}_3 = \\frac{1}{\\sqrt{2}}(1, 1, 0)^{\\mathsf{T}}$。这是该应力状态的唯一对称轴。\n\n对于重特征值 $\\sigma_1 = \\sigma_2 = -40 \\text{ MPa}$：\n$(\\boldsymbol{\\sigma} - (-40)\\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0} \\implies \\begin{pmatrix} -20  -20  0 \\\\ -20  -20  0 \\\\ 0  0  0 \\end{pmatrix} \\boldsymbol{v} = \\boldsymbol{0}$。这给出 $v_1 = -v_2$，而 $v_3$ 是任意的。特征空间是一个平面。我们可以选择此平面中的任意两个正交单位向量。一个方便的选择是：\n$\\boldsymbol{e}_1 = \\frac{1}{\\sqrt{2}}(1, -1, 0)^{\\mathsf{T}}$\n$\\boldsymbol{e}_2 = (0, 0, 1)^{\\mathsf{T}}$\n这些向量构成了主方向的一组标准正交基 $\\{\\boldsymbol{e}_1, \\boldsymbol{e}_2, \\boldsymbol{e}_3\\}$。\n\n**2. 主基中的应力分量**\n\n设 $\\boldsymbol{n}$ 为一个单位法向量。在主基中，$\\boldsymbol{n} = n'_1 \\boldsymbol{e}_1 + n'_2 \\boldsymbol{e}_2 + n'_3 \\boldsymbol{e}_3$，其中 $(n'_1)^2+(n'_2)^2+(n'_3)^2=1$。\n由 $\\boldsymbol{n}$ 定义的平面上的法向牵引力 $\\sigma_n$ 和剪切牵引力大小 $|\\tau|$ 由下式给出：\n$\\sigma_n = \\boldsymbol{n}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\boldsymbol{n} = \\sigma_1(n'_1)^2 + \\sigma_2(n'_2)^2 + \\sigma_3(n'_3)^2$\n$|\\tau|^2 = (\\boldsymbol{\\sigma}\\boldsymbol{n})\\cdot(\\boldsymbol{\\sigma}\\boldsymbol{n}) - \\sigma_n^2 = (\\sigma_1^2(n'_1)^2 + \\sigma_2^2(n'_2)^2 + \\sigma_3^2(n'_3)^2) - (\\sigma_1(n'_1)^2 + \\sigma_2(n'_2)^2 + \\sigma_3(n'_3)^2)^2$\n\n**3. 简化为单参数问题**\n\n由于 $\\sigma_1 = \\sigma_2 = -40$ MPa，应力状态关于 $\\boldsymbol{e}_3$ 轴是轴对称的。$\\sigma_n$ 和 $|\\tau|$ 的值仅取决于 $\\boldsymbol{n}$ 和 $\\boldsymbol{e}_3$ 之间的夹角 $\\theta$。设此角为 $\\theta$，则 $n'_3 = \\cos\\theta$ 且 $(n'_1)^2+(n'_2)^2=\\sin^2\\theta$。\n表达式简化为：\n$\\sigma_n(\\theta) = \\sigma_1((n'_1)^2 + (n'_2)^2) + \\sigma_3(n'_3)^2 = \\sigma_1\\sin^2\\theta + \\sigma_3\\cos^2\\theta$\n$|\\tau|^2(\\theta) = \\sigma_1^2 \\sin^2\\theta + \\sigma_3^2 \\cos^2\\theta - (\\sigma_1\\sin^2\\theta + \\sigma_3\\cos^2\\theta)^2 = (\\sigma_1 - \\sigma_3)^2 \\sin^2\\theta \\cos^2\\theta$\n$|\\tau|(\\theta) = (\\sigma_1 - \\sigma_3)\\sin\\theta\\cos\\theta = \\frac{1}{2}(\\sigma_1-\\sigma_3)\\sin(2\\theta)$ （因为 $\\sigma_1 > \\sigma_3$ 且我们考虑 $\\theta \\in [0, \\pi/2]$）。\n\n使用三角恒等式，我们将 $\\sigma_n$ 用 $2\\theta$ 表示：\n$\\sigma_n(\\theta) = \\sigma_1\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) + \\sigma_3\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) = \\frac{\\sigma_1+\\sigma_3}{2} - \\frac{\\sigma_1-\\sigma_3}{2}\\cos(2\\theta)$\n\n**4. 解析最大化**\n\n我们需要最大化 $h(\\theta) = |\\tau(\\theta)| + \\sigma_n(\\theta) \\tan\\phi$：\n$$\nh(\\theta) = \\frac{1}{2}(\\sigma_1-\\sigma_3)\\sin(2\\theta) + \\left(\\frac{\\sigma_1+\\sigma_3}{2} - \\frac{\\sigma_1-\\sigma_3}{2}\\cos(2\\theta)\\right)\\tan\\phi\n$$\n为了找到最大值，我们对 $h(\\theta)$ 关于 $\\theta$求导，并令结果为零：\n$$\n\\frac{dh}{d\\theta} = \\frac{d}{d\\theta} \\left[ \\frac{1}{2}(\\sigma_1-\\sigma_3)\\sin(2\\theta) - \\frac{1}{2}(\\sigma_1-\\sigma_3)\\cos(2\\theta)\\tan\\phi \\right]\n$$\n$$\n\\frac{dh}{d\\theta} = (\\sigma_1-\\sigma_3)\\cos(2\\theta) - \\frac{1}{2}(\\sigma_1-\\sigma_3)(-2\\sin(2\\theta))\\tan\\phi = (\\sigma_1-\\sigma_3)[\\cos(2\\theta) + \\sin(2\\theta)\\tan\\phi]\n$$\n令 $\\frac{dh}{d\\theta}=0$ 且注意到 $\\sigma_1 \\neq \\sigma_3$，我们得到：\n$\\cos(2\\theta) + \\sin(2\\theta)\\tan\\phi = 0 \\implies \\cot(2\\theta) = -\\tan\\phi$\n使用恒等式 $-\\tan\\phi = \\cot(\\frac{\\pi}{2}+\\phi)$，我们有：\n$2\\theta = \\frac{\\pi}{2}+\\phi \\implies \\theta^{\\ast} = \\frac{\\pi}{4} + \\frac{\\phi}{2}$\n二阶导数 $\\frac{d^2h}{d\\theta^2} = 2(\\sigma_1-\\sigma_3)[-\\sin(2\\theta) + \\cos(2\\theta)\\tan\\phi]$ 在 $\\theta^\\ast$ 处为负，证实这是一个最大值。\n\n给定 $\\phi = 0.523599$ 弧度（其高精度值为 $\\pi/6$），最优角为：\n$\\theta^{\\ast} = \\frac{\\pi}{4} + \\frac{1}{2}\\left(\\frac{\\pi}{6}\\right) = \\frac{\\pi}{4} + \\frac{\\pi}{12} = \\frac{4\\pi}{12} = \\frac{\\pi}{3}$ 弧度。\n\n**5. 最优法向量 $\\boldsymbol{n}^{\\ast}$ 的构造**\n\n向量 $\\boldsymbol{n}^{\\ast}$ 与主轴 $\\boldsymbol{e}_3$ 成 $\\theta^{\\ast} = \\pi/3$ 角。由于轴对称性，任何这样的向量都是一个有效的解。存在一个由可能的 $\\boldsymbol{n}^{\\ast}$ 向量组成的锥面。我们可以通过选择它位于由 $\\boldsymbol{e}_1$ 和 $\\boldsymbol{e}_3$ 张成的平面内来构造一个特解。在主基中，此向量为 $\\boldsymbol{n}'^{\\ast} = (\\sin\\theta^\\ast, 0, \\cos\\theta^\\ast)^{\\mathsf{T}}$。\n$\\boldsymbol{n}'^{\\ast} = (\\sin(\\pi/3), 0, \\cos(\\pi/3))^{\\mathsf{T}} = (\\frac{\\sqrt{3}}{2}, 0, \\frac{1}{2})^{\\mathsf{T}}$\n\n我们将此向量变换回原始的实验室坐标系 $\\{ \\boldsymbol{i}, \\boldsymbol{j}, \\boldsymbol{k} \\}$：\n$\\boldsymbol{n}^{\\ast} = \\sin(\\theta^{\\ast}) \\boldsymbol{e}_1 + \\cos(\\theta^{\\ast}) \\boldsymbol{e}_3 = \\frac{\\sqrt{3}}{2} \\boldsymbol{e}_1 + \\frac{1}{2} \\boldsymbol{e}_3$\n$\\boldsymbol{n}^{\\ast} = \\frac{\\sqrt{3}}{2} \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1/\\sqrt{2} \\\\ 1/\\sqrt{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2\\sqrt{2}} + \\frac{1}{2\\sqrt{2}} \\\\ -\\frac{\\sqrt{3}}{2\\sqrt{2}} + \\frac{1}{2\\sqrt{2}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}+1}{2\\sqrt{2}} \\\\ \\frac{1-\\sqrt{3}}{2\\sqrt{2}} \\\\ 0 \\end{pmatrix}$\n\n对分量使用和角恒等式可以得到一个更优雅的简化形式：\n$n_x^{\\ast} = \\frac{1}{\\sqrt{2}}(\\sin\\theta^{\\ast} + \\cos\\theta^{\\ast}) = \\cos(\\theta^{\\ast}-\\pi/4) = \\cos(\\pi/3 - \\pi/4) = \\cos(\\pi/12)$.\n$n_y^{\\ast} = \\frac{1}{\\sqrt{2}}(-\\sin\\theta^{\\ast} + \\cos\\theta^{\\ast}) = \\cos(\\theta^{\\ast}+\\pi/4) = \\cos(7\\pi/12) = -\\sin(\\pi/12)$.\n\n使用给定值 $\\phi = 0.523599$ 弧度，因此 $\\phi/2 = 0.2617995$ 弧度。\n$n_x^{\\ast} = \\cos(0.2617995) = 0.9659258...$\n$n_y^{\\ast} = -\\sin(0.2617995) = -0.2588190...$\n$n_z^{\\ast} = 0$\n将每个分量四舍五入到四位有效数字，得到：\n$n_x^{\\ast} \\approx 0.9659$\n$n_y^{\\ast} \\approx -0.2588$\n$n_z^{\\ast} = 0.0000$\n\n**6. 数值验证**\n\n我们验证 $\\theta^{\\ast} = \\pi/3 \\approx 1.0472$ 弧度使 $h(\\theta)$ 最大化。我们计算此角度及其附近处的 $h(\\theta)$ 值。\n$\\sigma_1-\\sigma_3 = -40 - (-80) = 40$.\n$\\sigma_1+\\sigma_3 = -40 + (-80) = -120$.\n$\\sigma_n(\\theta) = \\frac{-120}{2} - \\frac{40}{2}\\cos(2\\theta) = -60 - 20\\cos(2\\theta)$.\n$|\\tau(\\theta)| = \\frac{40}{2}\\sin(2\\theta) = 20\\sin(2\\theta)$.\n$h(\\theta) = 20 \\sin(2\\theta) + \\left( -60 - 20\\cos(2\\theta) \\right) \\tan(0.523599)$\n$\\tan(0.523599) \\approx 0.57735$.\n$h(\\theta) \\approx 20 \\sin(2\\theta) - 11.547 \\cos(2\\theta) - 34.641$.\n\n我们测试三个 $\\theta$ 的值：$\\theta^{\\ast}$ 和两个邻近点。为了清晰起见，我们使用角度单位：$60^\\circ$ ($\\pi/3$)、$55^\\circ$ 和 $65^\\circ$。\n- 对于 $\\theta = 60^\\circ \\approx 1.0472$ 弧度 ($2\\theta = 120^\\circ$)：\n$h(60^\\circ) \\approx 20\\sin(120^\\circ) - 11.547\\cos(120^\\circ) - 34.641 = 20(0.8660) - 11.547(-0.5) - 34.641 = 17.32 + 5.7735 - 34.641 = -11.5475$ MPa。\n- 对于 $\\theta = 55^\\circ \\approx 0.9599$ 弧度 ($2\\theta = 110^\\circ$)：\n$h(55^\\circ) \\approx 20\\sin(110^\\circ) - 11.547\\cos(110^\\circ) - 34.641 = 20(0.9397) - 11.547(-0.3420) - 34.641 = 18.794 + 3.949 - 34.641 = -11.898$ MPa。\n- 对于 $\\theta = 65^\\circ \\approx 1.1345$ 弧度 ($2\\theta = 130^\\circ$)：\n$h(65^\\circ) \\approx 20\\sin(130^\\circ) - 11.547\\cos(130^\\circ) - 34.641 = 20(0.7660) - 11.547(-0.6428) - 34.641 = 15.32 + 7.422 - 34.641 = -11.899$ MPa。\n\n数值证实了 $h(\\theta)$ 在 $\\theta = \\theta^{\\ast} = \\pi/3$ 处有最大值。因此计算出的向量 $\\boldsymbol{n}^{\\ast}$ 是正确的。\n最终的向量是 $\\boldsymbol{n}^{\\ast} \\approx (0.9659, -0.2588, 0.0000)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9659  -0.2588  0.0000\n\\end{pmatrix}\n}\n$$", "id": "3568425"}]}