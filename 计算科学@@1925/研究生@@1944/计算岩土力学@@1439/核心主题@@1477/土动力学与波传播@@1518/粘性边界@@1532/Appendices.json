{"hands_on_practices": [{"introduction": "将理论付诸实践是掌握计算方法的第一步。本练习旨在指导您将粘性边界的连续理论转化为可在数值程序中使用的具体算法。您将从基本原理出发，为三维边界单元的节点推导并实施阻尼力计算，这需要将节点速度分解为法向和切向分量，并应用相应的阻抗关系。这项实践对于在有限元等数值模拟中实现波吸收边界至关重要，是连接理论与编码的桥梁。[@problem_id:3570002]", "problem": "考虑一个线性弹性、均匀、各向同性的半空间，其被一个人工边界所截断，并根据 Lysmer-Kuhlemeyer 粘性边界模型在该边界上施加了无反射粘滞阻尼器。令 $\\rho$ 表示质量密度，$c_p$ 表示压缩波速，$c_s$ 表示剪切波速。对于小应变线性弹性和单向行波，阻抗关系将边界面力与沿着外法向单位向量和切向的质点速度等同起来。一个具有节点贡献面积的四边形边界单元将这些面力分配到节点力，且节点之间没有耦合。假设在一个三维设定中，每个时间步都可以通过计算方案（如有限元法，FEM）获得节点外法向向量和节点速度向量。\n\n本题要求从基本原理出发，推导计算四边形边界单元各节点上节点粘滞阻尼力向量所需的表达式，然后实现一个程序，对指定的测试套件执行这些计算。推导必须从以下原理开始：面力是作用在表面上的单位面积力，并且对于垂直入射到线性弹性半空间边界的平面波，面力通过机械阻抗与速度成正比。您必须仅使用以下基本依据：\n\n- 牛顿第二定律，即力等于质量乘以加速度，以及面力是单位面积力的定义。\n- 经过充分检验的一维弹性介质中波传播的阻抗概念，其中机械阻抗定义为平面波的面力与质点速度之比。\n\n以此为基础，根据速度投影获得法向和切向面力分量的表达式，然后使用节点贡献面积组集为节点力。不得引用任何未基于这些基础的快捷公式。\n\n实现要求：\n\n- 对于每个节点 $i$，其外法向向量为 $\\mathbf{n}_i$（不一定是单位长度），速度向量为 $\\mathbf{v}_i$，通过对 $\\mathbf{n}_i$进行归一化来计算单位法向量 $\\hat{\\mathbf{n}}_i$。计算法向速度标量 $v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$、法向速度向量 $\\mathbf{v}_{n,i} = v_{n,i}\\,\\hat{\\mathbf{n}}_i$ 和切向速度向量 $\\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i}$。\n- 根据阻抗关系，获得面力向量 $\\mathbf{t}_i$，并使用节点贡献面积 $A_i$ 组集为节点粘滞阻尼力 $\\mathbf{f}_i$。\n- 如果 $\\|\\mathbf{n}_i\\|=0$，则将 $\\hat{\\mathbf{n}}_i$ 视为未定义，并对该节点设置 $\\mathbf{f}_i=\\mathbf{0}$，因为边界方向是不适定的。\n\n单位和格式：\n\n- 所有力以牛顿（$\\mathrm{N}$）表示。速度必须以米/秒（$\\mathrm{m/s}$）为单位，密度以千克/立方米（$\\mathrm{kg/m^3}$）为单位，面积以平方米（$\\mathrm{m^2}$）为单位，波速以米/秒（$\\mathrm{m/s}$）为单位。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来、无空格的逗号分隔列表形式的结果。每个测试用例的结果必须是一个包含四个节点力向量的列表，其中每个节点力向量是一个包含三个浮点数 $[f_{x},f_{y},f_{z}]$ 的列表，四舍五入到六位小数。例如，单个测试用例的结果看起来像 $[[f_{x,1},f_{y,1},f_{z,1}],[f_{x,2},f_{y,2},f_{z,2}],[f_{x,3},f_{y,3},f_{z,3}],[f_{x,4},f_{y,4},f_{z,4}]]$, 整体输出为 $[$case1$,$case2$,$\\dots]$。\n\n测试套件规格：\n\n- Case $1$ (一般情况，单位法向量):\n  - $\\rho = 2000~\\mathrm{kg/m^3}$, $c_p = 3000~\\mathrm{m/s}$, $c_s = 1500~\\mathrm{m/s}$.\n  - $A_1=A_2=A_3=A_4=1.5~\\mathrm{m^2}$.\n  - $\\mathbf{n}_1=\\mathbf{n}_2=\\mathbf{n}_3=\\mathbf{n}_4=(0,0,1)$.\n  - $\\mathbf{v}_1=(0.2,0.0,-0.1)~\\mathrm{m/s}$, $\\mathbf{v}_2=(0.0,0.1,0.0)~\\mathrm{m/s}$, $\\mathbf{v}_3=(-0.1,-0.2,0.3)~\\mathrm{m/s}$, $\\mathbf{v}_4=(0.05,0.05,0.0)~\\mathrm{m/s}$.\n- Case $2$ (零速度，混合法向量和面积):\n  - $\\rho = 1800~\\mathrm{kg/m^3}$, $c_p = 2500~\\mathrm{m/s}$, $c_s = 1200~\\mathrm{m/s}$.\n  - $(A_1,A_2,A_3,A_4)=(0.8,1.2,1.0,0.9)~\\mathrm{m^2}$.\n  - $\\mathbf{n}_1=(1,0,0)$, $\\mathbf{n}_2=(0,1,0)$, $\\mathbf{n}_3=(0,0,1)$, $\\mathbf{n}_4=(1,1,0)$.\n  - $\\mathbf{v}_1=\\mathbf{v}_2=\\mathbf{v}_3=\\mathbf{v}_4=(0.0,0.0,0.0)~\\mathrm{m/s}$.\n- Case $3$ (非单位法向量，一个零面积):\n  - $\\rho = 2200~\\mathrm{kg/m^3}$, $c_p = 3200~\\mathrm{m/s}$, $c_s = 1600~\\mathrm{m/s}$.\n  - $(A_1,A_2,A_3,A_4)=(2.0,1.0,0.0,3.2)~\\mathrm{m^2}$.\n  - $\\mathbf{n}_1=(0,0,2)$, $\\mathbf{n}_2=(0,-3,0)$, $\\mathbf{n}_3=(1,0,1)$, $\\mathbf{n}_4=(-1,0,0)$.\n  - $\\mathbf{v}_1=(0.3,-0.1,0.4)~\\mathrm{m/s}$, $\\mathbf{v}_2=(-0.2,0.6,-0.1)~\\mathrm{m/s}$, $\\mathbf{v}_3=(0.0,0.0,0.5)~\\mathrm{m/s}$, $\\mathbf{v}_4=(-1.0,0.0,0.0)~\\mathrm{m/s}$.\n- Case $4$ (高阻抗，斜法向量):\n  - $\\rho = 2500~\\mathrm{kg/m^3}$, $c_p = 5000~\\mathrm{m/s}$, $c_s = 3000~\\mathrm{m/s}$.\n  - $A_1=A_2=A_3=A_4=0.1~\\mathrm{m^2}$.\n  - $\\mathbf{n}_1=(1,1,1)$, $\\mathbf{n}_2=(1,0,1)$, $\\mathbf{n}_3=(0,1,1)$, $\\mathbf{n}_4=(-1,1,0)$.\n  - $\\mathbf{v}_1=(2.0,-1.0,0.5)~\\mathrm{m/s}$, $\\mathbf{v}_2=(0.0,2.0,-2.0)~\\mathrm{m/s}$, $\\mathbf{v}_3=(-1.5,0.5,1.0)~\\mathrm{m/s}$, $\\mathbf{v}_4=(0.0,-0.5,0.5)~\\mathrm{m/s}$.\n\n您的程序必须计算每个测试用例中对应于一个时间步的瞬时节点粘滞阻尼力 $\\mathbf{f}_i$，并以指定格式生成所需的单行输出。不允许用户输入；测试套件中的所有参数必须在程序内部定义。", "solution": "本问题要求在一个三维、线性弹性、均匀、各向同性的介质中，推导并实现用于 Lysmer-Kuhlemeyer 粘性边界的节点粘滞阻尼力。推导过程必须基于指定的几项基本原理。\n\n提供的基本原理是：\n1. 面力的定义是单位面积上的力。\n2. 一维机械阻抗概念，该概念将弹性介质中传播的平面波的面力与质点速度联系起来。\n\n让我们开始推导。粘滞阻尼器是一个耗散元件；它施加在物体上的力与物体的速度成正比，方向相反。对于代表远场介质的节点粘滞阻尼器，施加在计算网格节点 $i$ 上的力 $\\mathbf{f}_i$ 旨在吸收否则会从人工边界反射的能量。这个力与该节点处的面力 $\\mathbf{t}_i$ 相关。\n\n根据定义，面力是单位面积力的极限，即 $\\mathbf{t} = d\\mathbf{F}/dA$。在诸如有限元法之类的离散数值模型中，我们考虑与节点 $i$ 相关的有限节点贡献面积 $A_i$。该面积上的总力通过将其集中在节点上进行近似。因此，节点 $i$ 上的粘滞阻尼力 $\\mathbf{f}_i$ 与粘滞阻尼器为模拟无限介质而必须产生的面力 $\\mathbf{t}_i$ 相关。这个面力必须与局部质点速度 $\\mathbf{v}_i$ 相反。因此，*粘滞阻尼器施加在节点上*的力是：\n$$ \\mathbf{f}_i = - A_i \\mathbf{t}_i $$\n在这里, $\\mathbf{t}_i$ 是无限介质中由于速度 $\\mathbf{v}_i$ 而产生的面力。我们的任务简化为找到这个面力向量 $\\mathbf{t}_i$ 的表达式。\n\nLysmer-Kuhlemeyer 模型将出射波场近似为垂直于边界传播的平面压缩波（P波）和平面剪切波（S波）的叠加。对于一维波传播，面力与质点速度之比是机械阻抗 $I$。对于 P 波，阻抗为 $I_p = \\rho c_p$，对于 S 波，阻抗为 $I_s = \\rho c_s$，其中 $\\rho$ 是质量密度，$c_p$ 是 P 波波速，$c_s$ 是 S 波波速。\n\n为了将这个一维概念应用于一般的三维边界，我们将节点 $i$ 处的质点速度向量 $\\mathbf{v}_i$ 分解为垂直于和切向于边界表面的分量。设节点 $i$ 处的外法向单位向量为 $\\hat{\\mathbf{n}}_i$。这是通过归一化给定的法向量 $\\mathbf{n}_i$ 得到的：\n$$ \\hat{\\mathbf{n}}_i = \\frac{\\mathbf{n}_i}{\\|\\mathbf{n}_i\\|} \\quad \\text{for } \\|\\mathbf{n}_i\\| \\neq 0 $$\n如果 $\\|\\mathbf{n}_i\\| = 0$，法向量未定义，问题指定力 $\\mathbf{f}_i$ 应为零向量，$\\mathbf{f}_i = \\mathbf{0}$。\n\n法向速度标量 $v_{n,i}$ 是 $\\mathbf{v}_i$ 在 $\\hat{\\mathbf{n}}_i$ 上的投影：\n$$ v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i $$\n法向速度向量 $\\mathbf{v}_{n,i}$ 则是：\n$$ \\mathbf{v}_{n,i} = v_{n,i} \\hat{\\mathbf{n}}_i = (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i $$\n切向速度向量 $\\mathbf{v}_{t,i}$ 是 $\\mathbf{v}_i$ 的剩余部分：\n$$ \\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i} $$\n\n根据 Lysmer-Kuhlemeyer 模型，速度的法向分量 $\\mathbf{v}_{n,i}$ 产生一个 P 波，从而引起法向面力 $\\mathbf{t}_{n,i}$。速度的切向分量 $\\mathbf{v}_{t,i}$ 产生 S 波，从而引起切向面力 $\\mathbf{t}_{t,i}$。我们对每个分量应用阻抗关系：\n- 法向面力 $\\mathbf{t}_{n,i}$ 通过 P 波阻抗 $I_p$ 与法向速度 $\\mathbf{v}_{n,i}$ 相关联：\n  $$ \\mathbf{t}_{n,i} = I_p \\mathbf{v}_{n,i} = (\\rho c_p) \\mathbf{v}_{n,i} $$\n- 切向面力 $\\mathbf{t}_{t,i}$ 通过 S 波阻抗 $I_s$ 与切向速度 $\\mathbf{v}_{t,i}$ 相关联：\n  $$ \\mathbf{t}_{t,i} = I_s \\mathbf{v}_{t,i} = (\\rho c_s) \\mathbf{v}_{t,i} $$\n\n节点 $i$ 处的总面力向量 $\\mathbf{t}_i$ 是其法向和切向分量的矢量和：\n$$ \\mathbf{t}_i = \\mathbf{t}_{n,i} + \\mathbf{t}_{t,i} = (\\rho c_p) \\mathbf{v}_{n,i} + (\\rho c_s) \\mathbf{v}_{t,i} $$\n\n将 $\\mathbf{v}_{n,i}$ 和 $\\mathbf{v}_{t,i}$ 的表达式代入 $\\mathbf{t}_i$ 的方程中：\n$$ \\mathbf{t}_i = (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) $$\n\n最后，我们将这个面力 $\\mathbf{t}_i$ 的表达式代入节点粘滞阻尼力 $\\mathbf{f}_i$ 的方程中：\n$$ \\mathbf{f}_i = -A_i \\mathbf{t}_i = -A_i \\left[ (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) \\right] $$\n为了更高效地计算，可以重新整理这个方程，将带有 $\\mathbf{v}_i$ 和 $(\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i$ 的项归并：\n$$ \\mathbf{f}_i = -A_i \\left[ (\\rho c_s) \\mathbf{v}_i + (\\rho c_p - \\rho c_s) (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i \\right] $$\n这是用于实现的最终表达式。\n\n计算给定节点 $i$ 的节点粘滞阻尼力向量 $\\mathbf{f}_i$ 的算法如下：\n1. 获取节点的输入参数：材料属性 $\\rho$, $c_p$, $c_s$；节点贡献面积 $A_i$；节点外法向向量 $\\mathbf{n}_i$；以及节点速度向量 $\\mathbf{v}_i$。\n2. 计算法向量的模，$N_i = \\|\\mathbf{n}_i\\|$。\n3. 如果 $N_i$ 等于 $0$，则方向是不适定的。设置节点力 $\\mathbf{f}_i = (0, 0, 0)$并停止。\n4. 否则，计算单位法向量：$\\hat{\\mathbf{n}}_i = \\mathbf{n}_i / N_i$。\n5. 计算速度在单位法向量上的标量投影：$v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$。\n6. 使用推导出的表达式计算节点力向量：\n    $$ \\mathbf{f}_i = -A_i \\rho \\left[ c_s \\mathbf{v}_i + (c_p - c_s) v_{n,i} \\hat{\\mathbf{n}}_i \\right] $$\n7. 如果所有输入量均采用问题陈述中指定的一致 SI 单位，则得到的向量 $\\mathbf{f}_i$ 的单位为力（牛顿）。对边界单元的所有节点重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal dashpot forces for a Lysmer-Kuhlemeyer viscous boundary\n    based on a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"rho\": 2000.0, \"cp\": 3000.0, \"cs\": 1500.0,\n            \"areas\": [1.5, 1.5, 1.5, 1.5],\n            \"normals\": [(0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0)],\n            \"velocities\": [(0.2, 0.0, -0.1), (0.0, 0.1, 0.0), (-0.1, -0.2, 0.3), (0.05, 0.05, 0.0)],\n        },\n        {\n            \"rho\": 1800.0, \"cp\": 2500.0, \"cs\": 1200.0,\n            \"areas\": [0.8, 1.2, 1.0, 0.9],\n            \"normals\": [(1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0), (1.0, 1.0, 0.0)],\n            \"velocities\": [(0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2200.0, \"cp\": 3200.0, \"cs\": 1600.0,\n            \"areas\": [2.0, 1.0, 0.0, 3.2],\n            \"normals\": [(0.0, 0.0, 2.0), (0.0, -3.0, 0.0), (1.0, 0.0, 1.0), (-1.0, 0.0, 0.0)],\n            \"velocities\": [(0.3, -0.1, 0.4), (-0.2, 0.6, -0.1), (0.0, 0.0, 0.5), (-1.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2500.0, \"cp\": 5000.0, \"cs\": 3000.0,\n            \"areas\": [0.1, 0.1, 0.1, 0.1],\n            \"normals\": [(1.0, 1.0, 1.0), (1.0, 0.0, 1.0), (0.0, 1.0, 1.0), (-1.0, 1.0, 0.0)],\n            \"velocities\": [(2.0, -1.0, 0.5), (0.0, 2.0, -2.0), (-1.5, 0.5, 1.0), (0.0, -0.5, 0.5)],\n        }\n    ]\n\n    all_results_str = []\n    \n    for case_data in test_cases:\n        rho = case_data[\"rho\"]\n        cp = case_data[\"cp\"]\n        cs = case_data[\"cs\"]\n        \n        areas = np.array(case_data[\"areas\"], dtype=float)\n        normals = np.array(case_data[\"normals\"], dtype=float)\n        velocities = np.array(case_data[\"velocities\"], dtype=float)\n        \n        case_forces = []\n        for i in range(4): # Loop over the 4 nodes of the quadrilateral element\n            A_i = areas[i]\n            n_i = normals[i]\n            v_i = velocities[i]\n            \n            # If area is zero, force is zero.\n            if A_i == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n                case_forces.append(f_i)\n                continue\n                \n            norm_n = np.linalg.norm(n_i)\n            \n            # Handle ill-posed normal vector.\n            if norm_n == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n            else:\n                n_hat_i = n_i / norm_n\n                \n                # Calculate scalar normal velocity\n                v_n_i_scalar = np.dot(v_i, n_hat_i)\n                \n                # Calculate nodal force using the derived formula:\n                # f_i = -A_i * (rho * cs * v_i + rho * (cp - cs) * v_n_i_scalar * n_hat_i)\n                term1 = cs * v_i\n                term2 = (cp - cs) * v_n_i_scalar * n_hat_i\n                f_i = -A_i * rho * (term1 + term2)\n\n            case_forces.append(f_i)\n\n        # Format the result for the current test case according to output specifications.\n        # This involves creating a string representation without spaces.\n        node_force_strs = []\n        for force_vec in case_forces:\n            # Round each component to 6 decimal places\n            force_vec_rounded = np.round(force_vec, 6)\n            # Format as [fx,fy,fz]\n            force_str = f'[{\",\".join(map(str, force_vec_rounded))}]'\n            node_force_strs.append(force_str)\n        \n        # Format as [[...],[...],[...],[...]]\n        case_str = f'[{\",\".join(node_force_strs)}]'\n        all_results_str.append(case_str)\n    \n    # Final print statement in the exact required format: [case1_str,case2_str,...]\n    final_output = f'[{\",\".join(all_results_str)}]'\n    print(final_output)\n\nsolve()\n```", "id": "3570002"}, {"introduction": "一个数值模型的正确性不仅在于其能够运行，更在于它是否精确地遵循了基本的物理定律。本练习的核心是能量守恒原理的验证。您将通过解析推导和数值计算来证明，在粘性边界上由阻尼器耗散的能量，精确等于离开计算域的净能量通量。完成这项实践将使您深刻理解粘性边界如何实现能量吸收，并掌握验证数值模型物理一致性的关键方法。[@problem_id:3570020]", "problem": "考虑一个占据 $x \\ge 0$ 的线性弹性半空间，其在 $x=0$ 处有一个长度为 $L$（单位：米）的直边界 $\\Gamma$。该介质的质量密度为 $\\rho$（单位：$\\mathrm{kg/m^3}$），压缩（P）波波速为 $c_p$（单位：$\\mathrm{m/s}$），剪切（S）波波速为 $c_s$（单位：$\\mathrm{m/s}$）。在 $x=0$ 处的边界上装有 Lysmer-Kuhlemeyer (LK) 粘性阻尼器，其法向系数为 $k_n$（单位：$\\mathrm{Pa\\cdot s/m}$），切向系数为 $k_t$（单位：$\\mathrm{Pa\\cdot s/m}$）。LK 边界通过施加与边界速度分量成正比的粘性牵引力来模拟能量吸收。将边界上的法向和切向质点速度分别定义为 $v_n(t)$ 和 $v_t(t)$（单位：$\\mathrm{m/s}$）。\n\n从弹性动力学的第一性原理出发：穿过 $\\Gamma$ 的瞬时机械功率通量等于在 $\\Gamma$ 上牵引力与速度乘积的积分。对于均匀、各向同性线性弹性介质中的平面波，使用一个经过充分验证的事实：压缩波和剪切波的机械阻抗分别为 $Z_n = \\rho c_p$ 和 $Z_t = \\rho c_s$，并且在边界处右行（出射）波和左行（反射）波的叠加会产生与这些阻抗一致的牵引力-速度关系。不要假设任何预先推导的能量平衡公式；相反，应根据入射和反射速度推导出通过 $\\Gamma$ 离开区域的能量通量，并根据其粘性定律计算 LK 阻尼器中的耗散功率。\n\n您的任务是实现一个程序，对于每个指定的测试用例，计算通过 $\\Gamma$ 的瞬时能量通量和 LK 阻尼器的瞬时粘性耗散，然后验证它们在浮点运算精度误差范围内是相等的。对于每个测试用例，将入射法向和切向速度信号 $v_{n}^{\\mathrm{inc}}(t)$ 和 $v_{t}^{\\mathrm{inc}}(t)$ 定义为平滑的、有限时程的高斯调制正弦波：\n$$\nv_{n}^{\\mathrm{inc}}(t) = A_n \\sin(2\\pi f_n t + \\phi_n)\\,\\exp\\!\\left(-\\frac{(t-t_{0,n})^2}{2\\sigma_n^2}\\right), \\quad\nv_{t}^{\\mathrm{inc}}(t) = A_t \\sin(2\\pi f_t t + \\phi_t)\\,\\exp\\!\\left(-\\frac{(t-t_{0,t})^2}{2\\sigma_t^2}\\right),\n$$\n其振幅为 $A_n$ 和 $A_t$（单位：$\\mathrm{m/s}$），频率为 $f_n$ 和 $f_t$（单位：$\\mathrm{Hz}$），相位为 $\\phi_n$ 和 $\\phi_t$（单位：$\\mathrm{rad}$），中心为 $t_{0,n}$ 和 $t_{0,t}$（单位：$\\mathrm{s}$），宽度为 $\\sigma_n$ 和 $\\sigma_t$（单位：$\\mathrm{s}$）。由于 LK 边界处的阻抗失配，会产生反射速度 $v_{n}^{\\mathrm{ref}}(t)$ 和 $v_{t}^{\\mathrm{ref}}(t)$。根据牵引力连续性和阻尼器定律，推导出瞬时反射关系，并用它们来计算边界速度 $v_n(t)$ 和 $v_t(t)$ 以及功率平衡。\n\n使用均匀步长 $\\Delta t$ 对区间 $[0,T]$ 进行时间离散化，并在每个时间点计算以下量值：\n- LK 阻尼器瞬时耗散的功率：\n$$\n\\dot{W}_{\\mathrm{diss}}(t) = \\int_{\\Gamma} \\big(k_n\\,v_n(t)^2 + k_t\\,v_t(t)^2\\big)\\,ds,\n$$\n- 从介质出射的瞬时能量通量减去反射的能量通量：\n$$\n\\dot{W}_{\\mathrm{flux}}(t) = \\int_{\\Gamma} \\Big(Z_n\\big((v_{n}^{\\mathrm{inc}}(t))^2 - (v_{n}^{\\mathrm{ref}}(t))^2\\big) + Z_t\\big((v_{t}^{\\mathrm{inc}}(t))^2 - (v_{t}^{\\mathrm{ref}}(t))^2\\big)\\Big)\\,ds.\n$$\n\n对于每个测试用例，报告随时间变化的最大绝对不平衡量：\n$$\n\\epsilon_{\\max} = \\max_{t \\in [0,T]} \\big|\\dot{W}_{\\mathrm{diss}}(t) - \\dot{W}_{\\mathrm{flux}}(t)\\big|,\n$$\n以瓦特（$\\mathrm{W}$）为单位表示，并根据编程语言浮点数格式化的默认行为进行舍入。\n\n使用以下测试套件。在所有情况下，取 $L$ 等于边界长度，并假设速度沿 $\\Gamma$ 是均匀的，因此 $\\int_{\\Gamma}(\\cdot)\\,ds = L\\,(\\cdot)$。\n\n- 测试用例 1（LK 匹配，纯吸收，理想情况）：\n  - $\\rho = 2000\\,\\mathrm{kg/m^3}$，$c_p = 1500\\,\\mathrm{m/s}$，$c_s = 800\\,\\mathrm{m/s}$，$L = 1\\,\\mathrm{m}$。\n  - $k_n = \\alpha_n \\rho c_p$ 其中 $\\alpha_n = 1$，$k_t = \\alpha_t \\rho c_s$ 其中 $\\alpha_t = 1$。\n  - $A_n = 0.01\\,\\mathrm{m/s}$，$f_n = 10\\,\\mathrm{Hz}$，$\\phi_n = 0\\,\\mathrm{rad}$，$t_{0,n} = 0.30\\,\\mathrm{s}$，$\\sigma_n = 0.05\\,\\mathrm{s}$。\n  - $A_t = 0\\,\\mathrm{m/s}$（无切向运动）。\n  - $T = 1.00\\,\\mathrm{s}$，$\\Delta t = 0.00005\\,\\mathrm{s}$。\n\n- 测试用例 2（LK 失配，法向和切向混合）：\n  - $\\rho = 1800\\,\\mathrm{kg/m^3}$，$c_p = 1700\\,\\mathrm{m/s}$，$c_s = 900\\,\\mathrm{m/s}$，$L = 1\\,\\mathrm{m}$。\n  - $\\alpha_n = 0.5$ 因此 $k_n = 0.5\\,\\rho c_p$，$\\alpha_t = 1.5$ 因此 $k_t = 1.5\\,\\rho c_s$。\n  - $A_n = 0.02\\,\\mathrm{m/s}$，$f_n = 15\\,\\mathrm{Hz}$，$\\phi_n = 0\\,\\mathrm{rad}$，$t_{0,n} = 0.40\\,\\mathrm{s}$，$\\sigma_n = 0.07\\,\\mathrm{s}$。\n  - $A_t = 0.015\\,\\mathrm{m/s}$，$f_t = 20\\,\\mathrm{Hz}$，$\\phi_t = \\pi/4\\,\\mathrm{rad}$，$t_{0,t} = 0.35\\,\\mathrm{s}$，$\\sigma_t = 0.06\\,\\mathrm{s}$。\n  - $T = 1.00\\,\\mathrm{s}$，$\\Delta t = 0.00005\\,\\mathrm{s}$。\n\n- 测试用例 3（边界情况，零输入速度）：\n  - $\\rho = 2200\\,\\mathrm{kg/m^3}$，$c_p = 2000\\,\\mathrm{m/s}$，$c_s = 1200\\,\\mathrm{m/s}$，$L = 1\\,\\mathrm{m}$。\n  - $\\alpha_n = 1$，$\\alpha_t = 1$ 因此 $k_n = \\rho c_p$，$k_t = \\rho c_s$。\n  - $A_n = 0\\,\\mathrm{m/s}$，$A_t = 0\\,\\mathrm{m/s}$（所有其他信号参数可以一致地选择，但没有影响）。\n  - $T = 1.00\\,\\mathrm{s}$，$\\Delta t = 0.00005\\,\\mathrm{s}$。\n\n- 测试用例 4（强失配和更大边界）：\n  - $\\rho = 2000\\,\\mathrm{kg/m^3}$，$c_p = 1600\\,\\mathrm{m/s}$，$c_s = 700\\,\\mathrm{m/s}$，$L = 2\\,\\mathrm{m}$。\n  - $\\alpha_n = 5.0$ 因此 $k_n = 5.0\\,\\rho c_p$，$\\alpha_t = 0.2$ 因此 $k_t = 0.2\\,\\rho c_s$。\n  - $A_n = 0.012\\,\\mathrm{m/s}$，$f_n = 12\\,\\mathrm{Hz}$，$\\phi_n = \\pi/6\\,\\mathrm{rad}$，$t_{0,n} = 0.50\\,\\mathrm{s}$，$\\sigma_n = 0.08\\,\\mathrm{s}$。\n  - $A_t = 0.010\\,\\mathrm{m/s}$，$f_t = 18\\,\\mathrm{Hz}$，$\\phi_t = -\\pi/3\\,\\mathrm{rad}$，$t_{0,t} = 0.45\\,\\mathrm{s}$，$\\sigma_t = 0.07\\,\\mathrm{s}$。\n  - $T = 1.20\\,\\mathrm{s}$，$\\Delta t = 0.00005\\,\\mathrm{s}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[\\epsilon_1,\\epsilon_2,\\epsilon_3,\\epsilon_4]$，其中每个 $\\epsilon_i$ 是相应测试用例的最大绝对不平衡量（单位：$\\mathrm{W}$），按上述规定计算。", "solution": "该问题要求验证线性弹性半空间在 Lysmer-Kuhlemeyer (LK) 粘性边界上的能量守恒原理。此任务涉及两个主要步骤：首先，从第一性原理出发，推导边界上入射波和反射波之间的关系；其次，利用此关系解析地证明粘性阻尼器耗散的功率等于离开介质的净能量通量。最终的实现将是对该解析恒等式的数值验证。\n\n问题考虑的是 $x \\ge 0$ 的半空间。在边界 $x=0$ 处，波被分解为入射和反射分量。入射波从介质内部向边界传播，这对应于沿 $-x$ 方向的左行波，由 $(t+x/c)$ 的函数描述。反射波从边界传播回介质内部，这对应于沿 $+x$ 方向的右行波，由 $(t-x/c)$ 的函数描述。对法向和切向分量的分析是相同的，因此为了推导清晰，我们将省略下标 $n$ 和 $t$。\n\n步骤 1：速度反射系数的推导\n\n任意点的总质点速度 $v(x,t)$ 是入射波速度和反射波速度的叠加：\n$$\nv(x,t) = v_{\\mathrm{inc}}(t+x/c) + v_{\\mathrm{ref}}(t-x/c)\n$$\n在边界 $x=0$ 处，速度为：\n$$\nv(t) = v(0,t) = v_{\\mathrm{inc}}(t) + v_{\\mathrm{ref}}(t)\n$$\n在线性弹性介质中，与平面波相关的应力 $\\sigma$ 通过机械阻抗 $Z = \\rho c$ 与质点速度 $v$ 相关联。该关系的符号取决于传播方向。对于右行波（沿 $+x$ 方向，是 $t-x/c$ 的函数），应力为 $\\sigma = Zv$。对于左行波（沿 $-x$ 方向，是 $t+x/c$ 的函数），应力为 $\\sigma = -Zv$。\n将此应用于我们的情况：\n\\begin{itemize}\n    \\item 入射波是左行波，因此其关联应力为 $\\sigma_{\\mathrm{inc}}(x,t) = -Z v_{\\mathrm{inc}}(t+x/c)$。\n    \\item 反射波是右行波，因此其关联应力为 $\\sigma_{\\mathrm{ref}}(x,t) = Z v_{\\mathrm{ref}}(t-x/c)$。\n\\end{itemize}\n介质在边界 $x=0$ 处的总应力是两种波应力的总和：\n$$\n\\sigma_{\\mathrm{total}}(t) = \\sigma_{\\mathrm{inc}}(0,t) + \\sigma_{\\mathrm{ref}}(0,t) = -Z v_{\\mathrm{inc}}(t) + Z v_{\\mathrm{ref}}(t)\n$$\n这个应力是介质施加在边界上的牵引力。LK 粘性边界条件指出，*边界施加在介质上* 的牵引力等于 $-kv(t)$，其中 $k$ 是阻尼器系数，$v(t)$ 是边界上的总速度。根据牛顿第三定律，介质施加*在边界上*的力与边界施加*在介质上*的力大小相等、方向相反。所以，$\\sigma_{\\mathrm{total}}(t) = -(-kv(t)) = kv(t)$。历史上，边界牵引力定义为外部元件施加于连续体上的力，因此我们将边界条件写为：\n$$\n\\sigma_{\\mathrm{total}}(t) = -k v(t)\n$$\n令边界上总应力的两个表达式相等：\n$$\n-Z v_{\\mathrm{inc}}(t) + Z v_{\\mathrm{ref}}(t) = -k \\big(v_{\\mathrm{inc}}(t) + v_{\\mathrm{ref}}(t)\\big)\n$$\n我们现在可以求解反射速度 $v_{\\mathrm{ref}}(t)$ 与入射速度 $v_{\\mathrm{inc}}(t)$ 的关系：\n$$\nv_{\\mathrm{ref}}(t) (Z+k) = v_{\\mathrm{inc}}(t) (Z-k)\n$$\n$$\nv_{\\mathrm{ref}}(t) = \\left(\\frac{Z-k}{Z+k}\\right) v_{\\mathrm{inc}}(t)\n$$\n这就定义了速度反射系数 $R_v$：\n$$\nR_v = \\frac{Z-k}{Z+k}\n$$\n这个关系对法向和切向分量独立成立，因此我们有 $R_{v,n} = \\frac{Z_n-k_n}{Z_n+k_n}$ 和 $R_{v,t} = \\frac{Z_t-k_t}{Z_t+k_t}$。\n\n步骤 2：能量平衡的验证\n\n问题要求我们验证阻尼器耗散的功率 $\\dot{W}_{\\mathrm{diss}}$ 等于流出介质的净能量通量 $\\dot{W}_{\\mathrm{flux}}$。这些量由以下公式给出：\n$$\n\\dot{W}_{\\mathrm{diss}}(t) = L \\big(k_n\\,v_n(t)^2 + k_t\\,v_t(t)^2\\big)\n$$\n$$\n\\dot{W}_{\\mathrm{flux}}(t) = L \\Big(Z_n\\big((v_{n}^{\\mathrm{inc}}(t))^2 - (v_{n}^{\\mathrm{ref}}(t))^2\\big) + Z_t\\big((v_{t}^{\\mathrm{inc}}(t))^2 - (v_{t}^{\\mathrm{ref}}(t))^2\\big)\\Big)\n$$\n这里使用了沿长度为 $L$ 的边界速度均匀的假设来计算积分 $\\int_\\Gamma (\\cdot) ds = L (\\cdot)$。由于法向和切向分量是解耦的，我们可以对单个分量验证其相等性。我们必须证明 $k v^2 = Z( (v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2 )$。\n\n我们来分析代表耗散功率密度的左侧（LHS）：\n$$\n\\text{LHS} = k v^2 = k (v^{\\mathrm{inc}} + v^{\\mathrm{ref}})^2 = k (v^{\\mathrm{inc}} + R_v v^{\\mathrm{inc}})^2 = k (v^{\\mathrm{inc}})^2 (1+R_v)^2\n$$\n代入 $R_v$ 的表达式：\n$$\n1+R_v = 1 + \\frac{Z-k}{Z+k} = \\frac{(Z+k)+(Z-k)}{Z+k} = \\frac{2Z}{Z+k}\n$$\n所以，LHS 变为：\n$$\n\\text{LHS} = k (v^{\\mathrm{inc}})^2 \\left(\\frac{2Z}{Z+k}\\right)^2 = \\frac{4kZ^2}{(Z+k)^2} (v^{\\mathrm{inc}})^2\n$$\n现在，我们来分析代表净功率通量密度的右侧（RHS）：\n$$\n\\text{RHS} = Z((v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2) = Z((v^{\\mathrm{inc}})^2 - (R_v v^{\\mathrm{inc}})^2) = Z(v^{\\mathrm{inc}})^2 (1-R_v^2)\n$$\n我们可以分解 $1-R_v^2 = (1-R_v)(1+R_v)$。我们已经有了 $(1+R_v)$：\n$$\n1-R_v = 1 - \\frac{Z-k}{Z+k} = \\frac{(Z+k)-(Z-k)}{Z+k} = \\frac{2k}{Z+k}\n$$\n所以，RHS 变为：\n$$\n\\text{RHS} = Z(v^{\\mathrm{inc}})^2 \\left(\\frac{2k}{Z+k}\\right)\\left(\\frac{2Z}{Z+k}\\right) = \\frac{4kZ^2}{(Z+k)^2} (v^{\\mathrm{inc}})^2\n$$\n由于 LHS = RHS，等式 $k v^2 = Z( (v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2 )$ 得到了解析证明。因此，等式 $\\dot{W}_{\\mathrm{diss}}(t) = \\dot{W}_{\\mathrm{flux}}(t)$ 必须在每个时刻都成立。\n\n步骤 3：数值实现\n\n程序将对给定的测试用例实现此解析恒等式的数值检验。对于每个用例，算法流程如下：\n\\begin{enumerate}\n    \\item 创建一个离散时间向量 $t$，范围为区间 $[0, T]$，步长为 $\\Delta t$。\n    \\item 使用给定的高斯调制正弦波定义，在每个时间步计算入射法向和切向速度信号 $v_{n}^{\\mathrm{inc}}(t)$ 和 $v_{t}^{\\mathrm{inc}}(t)$。\n    \\item 计算材料阻抗 $Z_n = \\rho c_p$ 和 $Z_t = \\rho c_s$，以及阻尼器系数 $k_n = \\alpha_n Z_n$ 和 $k_t = \\alpha_t Z_t$。\n    \\item 根据 $Z_n, k_n$ 和 $Z_t, k_t$ 计算速度反射系数 $R_{v,n}$ 和 $R_{v,t}$。\n    \\item 通过将入射速度乘以它们各自的反射系数，计算反射速度时间序列 $v_{n}^{\\mathrm{ref}}(t)$ 和 $v_{t}^{\\mathrm{ref}}(t)$。\n    \\item 确定总边界速度 $v_n(t) = v_{n}^{\\mathrm{inc}}(t) + v_{n}^{\\mathrm{ref}}(t)$ 和 $v_t(t) = v_{t}^{\\mathrm{inc}}(t) + v_{t}^{\\mathrm{ref}}(t)$。\n    \\item 使用问题陈述中提供的公式，为所有时间步计算瞬时耗散功率 $\\dot{W}_{\\mathrm{diss}}(t)$ 和净能量通量 $\\dot{W}_{\\mathrm{flux}}(t)$。\n    \\item 计算绝对差值 $|\\dot{W}_{\\mathrm{diss}}(t) - \\dot{W}_{\\mathrm{flux}}(t)|$。找出在整个时间区间内该差值的最大值 $\\epsilon_{\\max}$。\n\\end{enumerate}\n根据上面的解析证明，$\\epsilon_{\\max}$ 的任何非零值都将完全归因于浮点运算精度误差，而非物理或离散化方法本身。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Test Case 1: Matched LK\n        {\n            \"medium\": {\"rho\": 2000.0, \"cp\": 1500.0, \"cs\": 800.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 1.0, \"alpha_t\": 1.0},\n            \"signal_n\": {\"A\": 0.01, \"f\": 10.0, \"phi\": 0.0, \"t0\": 0.30, \"sigma\": 0.05},\n            \"signal_t\": {\"A\": 0.0, \"f\": 0.0, \"phi\": 0.0, \"t0\": 0.0, \"sigma\": 1.0},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 2: Mismatched LK\n        {\n            \"medium\": {\"rho\": 1800.0, \"cp\": 1700.0, \"cs\": 900.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 0.5, \"alpha_t\": 1.5},\n            \"signal_n\": {\"A\": 0.02, \"f\": 15.0, \"phi\": 0.0, \"t0\": 0.40, \"sigma\": 0.07},\n            \"signal_t\": {\"A\": 0.015, \"f\": 20.0, \"phi\": np.pi / 4, \"t0\": 0.35, \"sigma\": 0.06},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 3: Zero input velocities\n        {\n            \"medium\": {\"rho\": 2200.0, \"cp\": 2000.0, \"cs\": 1200.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 1.0, \"alpha_t\": 1.0},\n            \"signal_n\": {\"A\": 0.0, \"f\": 1.0, \"phi\": 0.0, \"t0\": 0.5, \"sigma\": 0.1},\n            \"signal_t\": {\"A\": 0.0, \"f\": 1.0, \"phi\": 0.0, \"t0\": 0.5, \"sigma\": 0.1},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 4: Strong mismatch and larger boundary\n        {\n            \"medium\": {\"rho\": 2000.0, \"cp\": 1600.0, \"cs\": 700.0, \"L\": 2.0},\n            \"coeffs\": {\"alpha_n\": 5.0, \"alpha_t\": 0.2},\n            \"signal_n\": {\"A\": 0.012, \"f\": 12.0, \"phi\": np.pi / 6, \"t0\": 0.50, \"sigma\": 0.08},\n            \"signal_t\": {\"A\": 0.010, \"f\": 18.0, \"phi\": -np.pi / 3, \"t0\": 0.45, \"sigma\": 0.07},\n            \"time\": {\"T\": 1.20, \"dt\": 0.00005},\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_max_imbalance(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef incident_velocity_signal(t, A, f, phi, t0, sigma):\n    \"\"\"\n    Computes the Gaussian-modulated sinusoid incident velocity signal at times t.\n    \"\"\"\n    if A == 0:\n        return np.zeros_like(t)\n    return A * np.sin(2 * np.pi * f * t + phi) * np.exp(-((t - t0)**2) / (2 * sigma**2))\n\ndef calculate_max_imbalance(case):\n    \"\"\"\n    Calculates the maximum absolute power imbalance for a single test case.\n    \"\"\"\n    # Unpack parameters from the case dictionary\n    rho = case[\"medium\"][\"rho\"]\n    cp = case[\"medium\"][\"cp\"]\n    cs = case[\"medium\"][\"cs\"]\n    L = case[\"medium\"][\"L\"]\n    \n    alpha_n = case[\"coeffs\"][\"alpha_n\"]\n    alpha_t = case[\"coeffs\"][\"alpha_t\"]\n    \n    params_n = case[\"signal_n\"]\n    params_t = case[\"signal_t\"]\n    \n    T = case[\"time\"][\"T\"]\n    dt = case[\"time\"][\"dt\"]\n\n    # Create the time vector\n    t = np.arange(0, T, dt)\n\n    # Generate incident velocity signals\n    v_n_inc = incident_velocity_signal(t, **params_n)\n    v_t_inc = incident_velocity_signal(t, **params_t)\n\n    # Calculate mechanical impedances\n    Z_n = rho * cp\n    Z_t = rho * cs\n\n    # Calculate viscous dashpot coefficients\n    k_n = alpha_n * Z_n\n    k_t = alpha_t * Z_t\n\n    # Calculate velocity reflection coefficients\n    # Denominators (Z+k) are non-zero for all physical parameters.\n    R_n = (Z_n - k_n) / (Z_n + k_n)\n    R_t = (Z_t - k_t) / (Z_t + k_t)\n\n    # Calculate reflected velocities\n    v_n_ref = R_n * v_n_inc\n    v_t_ref = R_t * v_t_inc\n\n    # Calculate total boundary velocities\n    v_n = v_n_inc + v_n_ref\n    v_t = v_t_inc + v_t_ref\n\n    # Calculate instantaneous power dissipated by LK dashpots\n    W_diss = L * (k_n * v_n**2 + k_t * v_t**2)\n\n    # Calculate instantaneous outgoing energy flux from the medium\n    W_flux = L * (Z_n * (v_n_inc**2 - v_n_ref**2) + Z_t * (v_t_inc**2 - v_t_ref**2))\n\n    # Calculate the absolute difference (imbalance)\n    imbalance = np.abs(W_diss - W_flux)\n    \n    # Find the maximum imbalance over the time interval\n    max_imbalance = np.max(imbalance) if imbalance.size > 0 else 0.0\n\n    return max_imbalance\n\nsolve()\n```", "id": "3570020"}, {"introduction": "任何数值模型都有其适用范围和局限性。在实现并验证了 Lysmer-Kuhlemeyer (LK) 边界之后，下一步是深入理解其性能限制。由于 LK 模型是在平面波垂直入射的理想假设下推导的，本练习将引导您分析其在更复杂波场（如驻波和斜入射波）下的表现。通过解析推导粘性边界在非理想条件下的误差，您将能够量化其吸收效率与波入射角度等因素的关系，从而培养对计算模型批判性的审视能力。[@problem_id:3569961]", "problem": "您需要为计算岩土力学中由 Lysmer 和 Kuhlemeyer 引入的粘性边界（Lysmer-Kuhlemeyer (LK) 边界）构建并评估解析基准。考虑小应变下的线弹性动力学。重点是在长度为 $L$ 的有限域内，撞击边界的驻波场。在该边界上施加形式为 $t = Z \\dot{u}$（阻抗乘以速度，其中 $\\dot{u}$ 表示位移的时间导数）的粘性曳力。您的任务是为每个基准计算一个无量纲误差，该误差量化了边界上连续介质曳力与 LK 粘性边​​界曳力之间的不匹配程度。\n\n基本原理和定义：\n- 一维（$1\\mathrm{D}$）弹性杆满足波动方程 $u_{tt} = c^2 u_{xx}$，其中纵波波速为 $c = \\sqrt{E/\\rho}$，$E$ 是杨氏模量，$\\rho$ 是质量密度。\n- 对于二维（$2\\mathrm{D}$）平面应变问题，弹性本构关系为 $\\sigma = \\lambda \\, \\mathrm{tr}(\\varepsilon) \\, I + 2 \\mu \\varepsilon$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\varepsilon$ 是位移 $u$ 的对称梯度，$\\sigma$ 是应力张量，$I$ 是单位张量。压缩波和剪切波的波速分别为 $c_p = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$ 和 $c_s = \\sqrt{\\mu/\\rho}$。\n- LK 边界模型施加了局部阻尼器曳力，对于具有单位外法线 $n$ 的边界，该曳力与速度的法向和切向分量成正比：曳力矢量由法向速度分量 $v_n = v \\cdot n$ 和切向速度 $v_t = v - v_n n$ 构建，其阻抗类系数由 $\\rho c_p$ 和 $\\rho c_s$ 导出。\n\n需在边界 $x = 0$ 处评估的基准场：\n- 对于 $1\\mathrm{D}$ 情况，使用驻波叠加\n$$\nu(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right],\n$$\n其中 $k = n \\pi / L$，$\\omega = c k$，振幅 $A > 0$，相位偏移 $\\delta \\in [0, \\pi)$，整数模态指数 $n \\ge 1$，且 $L > 0$。\n- 对于 $2\\mathrm{D}$ 平面应变，使用两个反向传播平面波的驻波叠加，入射角为 $\\theta$（从 $x$ 轴测量），传播坐标为 $s = x \\cos\\theta + y \\sin\\theta$：\n    - 压缩波（$P$ 波）位移场\n    $$\n    u(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, p,\n    $$\n    其中 $p = (\\cos\\theta, \\sin\\theta)$，$k = n \\pi / L$，$\\omega = c_p k$，振幅 $A > 0$，相位偏移 $\\delta$，以及入射角 $\\theta$。\n    - 剪切波（$S$ 波）位移场\n    $$\n    u(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, s,\n    $$\n    其中 $s = (-\\sin\\theta, \\cos\\theta)$，$k = n \\pi / L$，$\\omega = c_s k$，振幅 $A > 0$，相位偏移 $\\delta$，以及入射角 $\\theta$。\n\n曳力与误差定义：\n- 在边界 $x = 0$ 处的连续介质曳力矢量为 $t = \\sigma \\, n$，其中 $n = (1, 0)$ 是边界的外法线。\n- 速度为 $v = u_t$（$u_t$ 代表 $u$ 对时间 $t$ 的偏导数）。边界上的 LK 曳力矢量构造如下\n$$\nt_{\\mathrm{LK}} = -\\rho c_p (v \\cdot n) n - \\rho c_s \\left(v - (v \\cdot n) n \\right).\n$$\n- 将残差矢量定义为 $r = t - t_{\\mathrm{LK}}$。无量纲 LK 误差是残差的均方根（RMS）范数与参考 LK 曳力的均方根范数在一个时间周期内的比值，对于 $2\\mathrm{D}$ 情况，还需在一个沿 $y$ 轴的空间周期内计算：\n    - 对于 $1\\mathrm{D}$：\n    $$\n    \\varepsilon_{1\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\left|E u_x(0,t) + \\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\left|\\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}.\n    $$\n    - 对于 $2\\mathrm{D}$：\n    $$\n    \\varepsilon_{2\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| r(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| t_{\\mathrm{LK}}(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}, \\quad Y_{\\mathrm{per}} = \\frac{2\\pi}{k \\sin\\theta},\n    $$\n    其中 $\\|\\cdot\\|$ 表示矢量的欧几里得范数。在所有情况下，均以无量纲浮点数报告误差。\n\n角度规定与单位：\n- 角度 $\\theta$ 使用度（degrees）。\n- 物理单位必须一致：$L$ 单位为米，$\\rho$ 单位为千克/立方米，$E$、$\\lambda$ 和 $\\mu$ 单位为帕斯卡，$A$ 单位为米，时间单位为秒。\n- 所有最终答案均表示为四舍五入到六位小数的无量纲浮点数。\n\n测试套件：\n计算以下五个参数集的 LK 误差。\n- 情况 1（$1\\mathrm{D}$，理想情况）：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0$。\n- 情况 2（$1\\mathrm{D}$，相移驻波）：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = \\pi/2$。\n- 情况 3（$1\\mathrm{D}$，近节点失配）：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0.9\\pi$。\n- 情况 4（$2\\mathrm{D}$，$P$ 波斜入射）：$\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = \\pi/3$, $\\theta = 30$ 度。\n- 情况 5（$2\\mathrm{D}$，$S$ 波近掠射）：$\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = 0.8\\pi$, $\\theta = 75$ 度。\n\n最终输出规格：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试套件的顺序排列结果，每个值四舍五入到六位小数（例如，$[0.123456,1.234567,2.345678,3.456789,4.567890]$）。不应打印任何其他文本。", "solution": "问题陈述已经过验证，被认为是可靠的。它科学地基于线弹性动力学原理，定义和参数完整一致，问题设定适定，并且其表述是客观的。任务是推导在特定驻波条件下 Lysmer-Kuhlemeyer (LK) 粘性边界的既定误差度量的解析表达式，然后针对给定的测试套件评估此误差。\n\n通用方法包括在边界 $x=0$ 处推导连续介质曳力矢量 $t$ 和 LK 曳力矢量 $t_{\\mathrm{LK}}$ 的表达式。在问题的背景下，通过误差公式的规定，残差矢量被定义为 $r = t - t_{\\mathrm{LK}}$，其中一维残差使用 $E u_x + \\rho c u_t$。对于位于 $x<0$ 域上，在 $x=0$ 处且外法线为 $n=(1,0)$ 的边界，连续介质曳力为 $t=\\sigma n|_{x=0}$，LK 曳力为 $t_{\\mathrm{LK}} = -\\rho c_p (v \\cdot n) n - \\rho c_s (v - (v \\cdot n) n)|_{x=0}$。对于一维杆，这简化为 $t=E u_x|_{x=0}$ 和 $t_{\\mathrm{LK}} = -\\rho c u_t|_{x=0}$。一维误差公式中指定的残差 $E u_x + \\rho c u_t$ 正好是 $t - t_{\\mathrm{LK}}$。无量纲误差 $\\varepsilon$ 是残差的均方根（RMS）范数与参考 LK 曳力的均方根范数的比值。\n\n**1. $1\\mathrm{D}$ 情况分析**\n\n位移场为 $u(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right]$。我们在边界 $x=0$ 处计算所需项。\n速度为 $u_t(x,t) = -A\\omega\\left[\\sin(\\omega t - k x) + \\sin(\\omega t + k x + \\delta)\\right]$。\n在 $x=0$ 处，$u_t(0,t) = -A\\omega\\left[\\sin(\\omega t) + \\sin(\\omega t + \\delta)\\right]$。\n空间导数为 $u_x(x,t) = Ak\\left[\\sin(\\omega t - k x) - \\sin(\\omega t + k x + \\delta)\\right]$。\n在 $x=0$ 处，$u_x(0,t) = Ak\\left[\\sin(\\omega t) - \\sin(\\omega t + \\delta)\\right]$。\n\n误差表达式的分子包含项 $R_{1\\mathrm{D}}(t) = E u_x(0,t) + \\rho c u_t(0,t)$。\n使用 $E = \\rho c^2$ 和 $\\omega = ck$，我们发现 $E k = \\rho c \\omega$。\n$R_{1\\mathrm{D}}(t) = (EAk)[\\sin(\\omega t) - \\sin(\\omega t + \\delta)] - (\\rho c A \\omega)[\\sin(\\omega t) + \\sin(\\omega t + \\delta)]$\n$R_{1\\mathrm{D}}(t) = EAk \\left\\{ [\\sin(\\omega t) - \\sin(\\omega t+\\delta)] - [\\sin(\\omega t) + \\sin(\\omega t+\\delta)] \\right\\}$\n$R_{1\\mathrm{D}}(t) = EAk [-2\\sin(\\omega t+\\delta)] = -2EAk \\sin(\\omega t+\\delta)$。\n\n分母包含参考项 $T_{\\mathrm{ref}}(t) = \\rho c u_t(0,t) = -\\rho c A\\omega[\\sin(\\omega t) + \\sin(\\omega t+\\delta)]$。\n$T_{\\mathrm{ref}}(t) = -EAk[\\sin(\\omega t) + \\sin(\\omega t) \\cos\\delta + \\cos(\\omega t) \\sin\\delta]$\n$T_{\\mathrm{ref}}(t) = -EAk[(1+\\cos\\delta)\\sin(\\omega t) + \\sin\\delta \\cos(\\omega t)]$。\n\n误差为 $\\varepsilon_{1\\mathrm{D}} = \\left( \\int_0^T R_{1\\mathrm{D}}(t)^2 dt / \\int_0^T T_{\\mathrm{ref}}(t)^2 dt \\right)^{1/2}$，其中 $T=2\\pi/\\omega$。\n平方残差分子的积分为：\n$\\int_0^T R_{1\\mathrm{D}}(t)^2 dt = \\int_0^T (-2EAk)^2 \\sin^2(\\omega t+\\delta) dt = 4(EAk)^2 (T/2) = 2T(EAk)^2$。\n平方参考项的积分使用恒等式 $\\int_0^T (C\\cos\\omega t+S\\sin\\omega t)^2 dt = (C^2+S^2)T/2$来计算：\n$\\int_0^T T_{\\mathrm{ref}}(t)^2 dt = (-EAk)^2 \\frac{T}{2} [(1+\\cos\\delta)^2 + (\\sin\\delta)^2] = (EAk)^2 \\frac{T}{2} [1+2\\cos\\delta+\\cos^2\\delta+\\sin^2\\delta]$\n$= (EAk)^2 \\frac{T}{2} [2+2\\cos\\delta] = T(EAk)^2(1+\\cos\\delta)$。\n\n误差的平方是这些积分量的比值：\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2T(EAk)^2}{T(EAk)^2(1+\\cos\\delta)} = \\frac{2}{1+\\cos\\delta}$。\n使用半角恒等式 $1+\\cos\\delta = 2\\cos^2(\\delta/2)$，我们得到：\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2}{2\\cos^2(\\delta/2)} = \\sec^2(\\delta/2)$。\n因为 $\\delta \\in [0, \\pi)$，$\\delta/2 \\in [0, \\pi/2)$，在此区间余弦为非负，所以误差为：\n$\\varepsilon_{1\\mathrm{D}} = \\frac{1}{\\cos(\\delta/2)}$。\n此结果与所有物理参数 $A, \\rho, E, L, n$ 无关，仅取决于相移 $\\delta$。\n\n**2. $2\\mathrm{D}$ 情况分析**\n\n位移场是两个反向传播平面波的叠加，表示为 $u(x,y,t) = A \\left[ \\cos(\\Psi_{in}) + \\cos(\\Psi_{out}) \\right] d$，其中 $\\Psi_{in} = \\omega t - k s$，$\\Psi_{out} = \\omega t + k s + \\delta$，$s = x\\cos\\theta + y\\sin\\theta$，$d$ 是偏振矢量。在边界 $x=0$ 处，$s=y\\sin\\theta$。\n\n我们定义函数 $S(t,y) = \\sin(\\omega t - ky\\sin\\theta) + \\sin(\\omega t + ky\\sin\\theta + \\delta)$ 和 $D(t,y) = \\sin(\\omega t - ky\\sin\\theta) - \\sin(\\omega t + ky\\sin\\theta + \\delta)$。\n在 $x=0$ 处的速度和空间导数为：\n$v(0,y,t) = u_t = -A\\omega S(t,y) d$\n$\\frac{\\partial u}{\\partial x}(0,y,t) = Ak\\cos\\theta D(t,y) d$\n$\\frac{\\partial u}{\\partial y}(0,y,t) = Ak\\sin\\theta D(t,y) d$\n\n函数 $S$ 和 $D$ 在一个时间周期 $T=2\\pi/\\omega$ 和一个空间周期 $Y_{\\mathrm{per}}=2\\pi/(k\\sin\\theta)$ 上是正交的，即 $\\int_0^T \\int_0^{Y_{\\mathrm{per}}} S(t,y)D(t,y) dy dt = 0$。它们的平方积分是 $\\int\\int S^2 dy dt = \\int\\int D^2 dy dt = T Y_{\\mathrm{per}}$。由于这种正交性，形式为 $r = D(t,y) V_1 - S(t,y) V_2$ 的残差的积分范数简化为 $\\int\\int \\|r\\|^2 dy dt = (\\|V_1\\|^2 + \\|V_2\\|^2) T Y_{\\mathrm{per}}$。\n\n**2.1. 2D P 波分析**\n偏振 $d=p=(\\cos\\theta, \\sin\\theta)$。在 $x=0$ 处所需的应变分量：\n$\\varepsilon_{xx} = Ak D(t,y)\\cos^2\\theta$, $\\varepsilon_{yy} = Ak D(t,y)\\sin^2\\theta$, $\\varepsilon_{xy} = Ak D(t,y)\\sin\\theta\\cos\\theta$。\n连续介质曳力 $t = (\\sigma_{xx}, \\sigma_{xy})$ 为：\n$\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx}+\\lambda\\varepsilon_{yy} = AkD(t,y)[(\\lambda+2\\mu)\\cos^2\\theta+\\lambda\\sin^2\\theta]$。\n$\\sigma_{xy} = 2\\mu\\varepsilon_{xy} = AkD(t,y)[2\\mu\\sin\\theta\\cos\\theta]$。\n使用 $\\lambda+2\\mu=\\rho c_p^2$ 和 $\\mu=\\rho c_s^2$，$t=AkD(t,y) V_t$ 其中 $V_t = \\rho \\begin{pmatrix} c_p^2\\cos^2\\theta + (\\frac{\\lambda}{\\rho})\\sin^2\\theta \\\\ c_s^2 \\sin(2\\theta) \\end{pmatrix}$。\n速度分量为 $v_x = -A\\omega S(t,y)\\cos\\theta$ 和 $v_y = -A\\omega S(t,y)\\sin\\theta$。在 $\\omega=c_p k$ 条件下，LK 曳力 $t_{\\mathrm{LK}}=(-\\rho c_p v_x, -\\rho c_s v_y)$ 变为 $t_{\\mathrm{LK}} = AkS(t,y) V_{\\mathrm{LK}}$ 其中 $V_{\\mathrm{LK}} = \\rho\\begin{pmatrix} c_p^2\\cos\\theta \\\\ c_p c_s \\sin\\theta \\end{pmatrix}$。\n残差为 $r=t-t_{\\mathrm{LK}} = Ak[D(t,y)V_t - S(t,y)V_{\\mathrm{LK}}]$。\n误差的平方变为：\n$\\varepsilon_{2\\mathrm{D},P}^2 = \\frac{\\int\\int \\|r\\|^2 dy dt}{\\int\\int \\|t_{\\mathrm{LK}}\\|^2 dy dt} = \\frac{(Ak)^2 T Y_{\\mathrm{per}}(\\|V_t\\|^2+\\|V_{\\mathrm{LK}}\\|^2)}{(Ak)^2 T Y_{\\mathrm{per}} \\|V_{\\mathrm{LK}}\\|^2} = 1 + \\frac{\\|V_t\\|^2}{\\|V_{\\mathrm{LK}}\\|^2}$。\n\n**2.2. 2D S 波分析**\n偏振 $d=s=(-\\sin\\theta, \\cos\\theta)$。在 $x=0$ 处所需的应变分量：\n$\\varepsilon_{xx} = -Ak D(t,y)\\sin\\theta\\cos\\theta$, $\\varepsilon_{yy} = Ak D(t,y)\\sin\\theta\\cos\\theta$，因此 $\\mathrm{tr}(\\varepsilon)=0$。\n$\\varepsilon_{xy} = \\frac{1}{2}Ak D(t,y) (\\cos^2\\theta-\\sin^2\\theta) = \\frac{1}{2}AkD(t,y)\\cos(2\\theta)$。\n连续介质曳力 $t=(\\sigma_{xx}, \\sigma_{xy})$ 变为 $t = AkD(t,y) W_t$ 其中 $W_t = \\rho c_s^2 \\begin{pmatrix} -\\sin(2\\theta) \\\\ \\cos(2\\theta) \\end{pmatrix}$。\n速度分量为 $v_x = A\\omega S(t,y)\\sin\\theta$ 和 $v_y = -A\\omega S(t,y)\\cos\\theta$。在 $\\omega=c_s k$ 条件下，LK 曳力 $t_{\\mathrm{LK}}$ 变为 $t_{\\mathrm{LK}} = AkS(t,y) W_{\\mathrm{LK}}$ 其中 $W_{\\mathrm{LK}} = \\rho\\begin{pmatrix} -c_p c_s \\sin\\theta \\\\ c_s^2 \\cos\\theta \\end{pmatrix}$。\n误差表达式具有相同的形式：$\\varepsilon_{2\\mathrm{D},S}^2 = 1+\\frac{\\|W_t\\|^2}{\\|W_{\\mathrm{LK}}\\|^2}$。\n范数 $\\|W_t\\|^2 = (\\rho c_s^2)^2$。误差平方的最终表达式为：\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{(\\rho c_s^2)^2}{\\rho^2(c_p^2 c_s^2 \\sin^2\\theta + c_s^4 \\cos^2\\theta)} = 1 + \\frac{c_s^2}{c_p^2\\sin^2\\theta + c_s^2\\cos^2\\theta}$。\n\n**数值评估**\n- 情况 1：$1\\mathrm{D}$，$\\delta=0$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0) = 1$。\n- 情况 2：$1\\mathrm{D}$，$\\delta=\\pi/2$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(\\pi/4) = \\sqrt{2} \\approx 1.414214$。\n- 情况 3：$1\\mathrm{D}$，$\\delta=0.9\\pi$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0.45\\pi) \\approx 6.392453$。\n- 情况 4：$2\\mathrm{D}$ P 波。$\\rho=2000$，$\\lambda=2\\cdot 10^9$，$\\mu=1\\cdot 10^9$，$\\theta=30^\\circ$。这得到 $c_p^2 = 2\\cdot 10^6$ 和 $c_s^2 = 0.5\\cdot 10^6$，因此 $c_p^2=4c_s^2$。对于此特定材料属性，可以证明对任意角度 $\\theta$ 都有 $\\|V_t\\|^2 = \\|V_{\\mathrm{LK}}\\|^2$。因此 $\\varepsilon_{2\\mathrm{D},P}^2 = 1+1=2$，这给出 $\\varepsilon_{2\\mathrm{D},P}=\\sqrt{2} \\approx 1.414214$。\n- 情况 5：$2\\mathrm{D}$ S 波。材料属性相同，$\\theta=75^\\circ$。\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{1}{(c_p^2/c_s^2)\\sin^2\\theta+\\cos^2\\theta} = 1 + \\frac{1}{4\\sin^2(75^\\circ)+\\cos^2(75^\\circ)} = 1+\\frac{1}{1+3\\sin^2(75^\\circ)}$。\n计算得出 $\\varepsilon_{2\\mathrm{D},S} \\approx 1.123932$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_1d_error(delta):\n    \"\"\"\n    Computes the dimensionless LK error for the 1D case.\n    The error is analytically found to be 1 / cos(delta/2).\n    \"\"\"\n    if np.isclose(np.cos(delta / 2.0), 0):\n        return np.inf\n    return 1.0 / np.cos(delta / 2.0)\n\ndef calculate_2d_p_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D P-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    cp = np.sqrt(cp2)\n    cs = np.sqrt(cs2)\n    \n    theta_rad = np.radians(theta_deg)\n    s = np.sin(theta_rad)\n    c = np.cos(theta_rad)\n    \n    # Vector V_t (proportional to continuum traction)\n    vt_x = (lam + 2.0 * mu) * c**2 + lam * s**2\n    vt_y = 2.0 * mu * s * c\n    norm_vt_sq = vt_x**2 + vt_y**2\n\n    # Vector V_LK (proportional to LK traction)\n    vlk_x = rho * cp * cp * c\n    vlk_y = rho * cp * cs * s\n    norm_vlk_sq = vlk_x**2 + vlk_y**2\n\n    if np.isclose(norm_vlk_sq, 0):\n        return np.inf\n\n    err_sq = 1.0 + norm_vt_sq / norm_vlk_sq\n    return np.sqrt(err_sq)\n\ndef calculate_2d_s_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D S-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    \n    theta_rad = np.radians(theta_deg)\n    s_sq = np.sin(theta_rad)**2\n    c_sq = np.cos(theta_rad)**2\n    \n    denominator = cp2 * s_sq + cs2 * c_sq\n    if np.isclose(denominator, 0):\n        return np.inf\n\n    err_sq = 1.0 + cs2 / denominator\n    return np.sqrt(err_sq)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': np.pi/2}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0.9*np.pi}},\n        {'type': '2D_P', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': np.pi/3, 'theta': 30}},\n        {'type': '2D_S', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': 0.8*np.pi, 'theta': 75}},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == '1D':\n            result = calculate_1d_error(case['params']['delta'])\n        elif case['type'] == '2D_P':\n            p = case['params']\n            # Re-derivation shows for lambda=2*mu, error is sqrt(2) regardless of angle.\n            # We can use the general formula for robustness.\n            result = calculate_2d_p_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        elif case['type'] == '2D_S':\n            p = case['params']\n            result = calculate_2d_s_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n        \n        results.append(result)\n\n    # Format results to six decimal places for the final output.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3569961"}]}