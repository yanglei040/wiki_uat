{"hands_on_practices": [{"introduction": "这项首个练习旨在构建一项基本技能。我们将引导您逐步推导标准四节点四边形单元的一致质量矩阵和集中质量矩阵。通过这项实践[@problem_id:3540965]，您将清楚地了解单元的形函数和数值积分规则如何转化为离散的质量分布，为任何动态有限元分析奠定坚实的基础。", "problem": "考虑在有限元法（FEM）中，使用单个四节点双线性四边形有限元来模拟平面应变条件下的均质土域。该单元在物理坐标系中占据一个矩形，节点位于 $(0,0)$、$(L_{x},0)$、$(L_{x},L_{y})$ 和 $(0,L_{y})$，其中 $L_{x} > 0$ 且 $L_{y} > 0$。土壤具有均匀的质量密度 $\\rho$ 和均匀的平面外厚度 $b$。设等参母单元坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$，并采用标准的双线性形函数\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta), \\quad\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta), \\quad\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta), \\quad\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta).\n$$\n从动态平衡方程及其 Galerkin 投影出发，确定单元级一致质量矩阵 $\\mathbf{M}^{\\mathrm{c}}$，其项为 $M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega$，其中 $i,j \\in \\{1,2,3,4\\}$。使用 $2 \\times 2$ 高斯求积法则，其积分点为 $(\\xi,\\eta) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$ 且权重均为 $1$，精确计算该矩形单元的一致质量矩阵 $\\mathbf{M}^{\\mathrm{c}}$。然后，通过定义 $m_{i}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{ij}^{\\mathrm{c}}$ 并形成对角矩阵 $\\mathbf{M}^{\\mathrm{L}} = \\mathrm{diag}(m_{1}^{\\mathrm{L}}, m_{2}^{\\mathrm{L}}, m_{3}^{\\mathrm{L}}, m_{4}^{\\mathrm{L}})$ 来构建行和集中对角质量矩阵。最后，通过计算比值来量化节点质量分布的比较\n$$\nr \\;=\\; \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}}.\n$$\n将最终答案表示为一个无单位的精确简化分数。", "solution": "用户希望我解决一个计算岩土力学中的问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   **第1步：提取已知条件。** 我将列出所有提供的信息：单元类型、几何形状、材料属性、形函数、一致质量矩阵的定义、数值积分方案、集中质量矩阵的定义以及最终需要计算的量。\n    *   **第2步：验证。** 我将检查问题是否具有科学依据、是否适定、客观、完整且有意义。\n        *   **科学依据：** 该问题涉及标准的有限元法概念（双线性四边形单元、形函数、一致质量矩阵和集中质量矩阵、高斯求积）。这是计算力学中的教科书内容。\n        *   **适定性：** 问题要求基于明确定义的量计算一个特定的比率，并提供了清晰的计算路径。存在唯一解。\n        *   **客观性：** 语言技术性强且精确。\n        *   **完整性：** 它提供了所有必要的信息，包括几何形状、形函数、密度、厚度、一致质量矩阵的公式、积分法则以及集中质量的定义。\n        *   **现实性：** 这是一个标准的学术问题，用于有限元法的教学和验证。\n    *   **第3步：结论。** 问题有效。我将继续进行解答。\n\n2.  **解决问题。**\n    *   **第1部分：积分变换。** 我会将一致质量矩阵的积分 $M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho b N_{i} N_{j} \\mathrm{d}\\Omega$ 从物理域 $\\Omega_e$ 变换到母单元域 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。这需要计算雅可比行列式 $\\det(\\mathbf{J})$。\n    *   **第2部分：雅可比矩阵计算。** 我将找到坐标变换 $x(\\xi, \\eta)$、$y(\\xi, \\eta)$，然后计算雅可比矩阵 $\\mathbf{J}$ 及其行列式。\n    *   **第3部分：数值积分设置。** 我将在母单元域中写出 $M_{ij}^{\\mathrm{c}}$ 的积分，并陈述 $2 \\times 2$ 高斯求积的公式。问题指出这对于本案例是精确的方法，这是正确的，因为被积函数在每个变量中是最多 2 次的多项式，而 2 点高斯法则对最高 $2 \\times 2 - 1 = 3$ 次的多项式是精确的。\n    *   **第4部分：形函数求值。** 我将计算在四个指定的高斯求积点上形函数的值。\n    *   **第5部分：计算 $m_{1}^{\\mathrm{L}}$ 和 $M_{11}^{\\mathrm{c}}$。**\n        *   我将首先定义节点 1 的行和集中质量 $m_{1}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{1j}^{\\mathrm{c}}$。一个关键的简化来自于性质 $\\sum_{j=1}^{4} N_j = 1$。\n        *   我将应用高斯求积公式来计算 $m_{1}^{\\mathrm{L}}$ 和对角项 $M_{11}^{\\mathrm{c}}$。\n    *   **第6部分：最终比率计算。** 我将计算比率 $r = m_{1}^{\\mathrm{L}} / M_{11}^{\\mathrm{c}}$。\n\n我将确保严格遵守所有格式规则，特别是对所有数学实体强制使用 LaTeX。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   单元类型：平面应变下的四节点双线性四边形有限元。\n-   几何形状：一个矩形，节点位于 $(0,0)$、$(L_{x},0)$、$(L_{x},L_{y})$ 和 $(0,L_{y})$，其中 $L_{x} > 0$ 且 $L_{y} > 0$。\n-   材料属性：均匀质量密度 $\\rho$，均匀平面外厚度 $b$。\n-   母单元坐标：$(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。\n-   形函数：\n    $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$\n    $N_{2}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$\n    $N_{3}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$\n    $N_{4}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$\n-   一致质量矩阵定义：$M_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega$，其中 $i,j \\in \\{1,2,3,4\\}$。\n-   数值积分法则：$2 \\times 2$ 高斯求积，积分点为 $(\\xi,\\eta) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$，权重均为 $1$。\n-   集中质量矩阵定义：$m_{i}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{ij}^{\\mathrm{c}}$，形成对角矩阵 $\\mathbf{M}^{\\mathrm{L}} = \\mathrm{diag}(m_{1}^{\\mathrm{L}}, m_{2}^{\\mathrm{L}}, m_{3}^{\\mathrm{L}}, m_{4}^{\\mathrm{L}})$。\n-   需计算的量：比率 $r = \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}}$。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题牢固地基于应用于结构或连续介质动力学的有限元法（FEM）标准理论。一致质量矩阵、集中质量矩阵、双线性形函数和高斯求积等概念是计算力学的基石。\n-   **适定性：** 该问题提供了一个清晰的、定量的任务，包含了所有必要的数据和定义。步骤是合乎逻辑的，并能导出一个唯一的、确定性的结果。\n-   **客观性：** 该问题以精确的数学语言陈述，没有任何主观性或模糊性。\n-   **完整性：** 该问题是自洽的。它提供了几何形状、材料属性、形函数以及要使用的具体数值方法。\n-   **未检测到其他缺陷：** 该问题并非微不足道，需要详细计算。它不是循环论证、自相矛盾或基于不切实际的物理学。\n\n**第3步：结论与行动**\n问题有效。我将继续进行解答。\n\n### 解题过程\n\n有限元的一致质量矩阵源于虚功原理中的动能项。其各项由下式给出\n$$\nM_{ij}^{\\mathrm{c}} = \\int_{\\Omega_{e}} \\rho\\, b\\, N_{i}\\, N_{j}\\, \\mathrm{d}\\Omega\n$$\n其中 $\\rho$ 是质量密度，$b$ 是厚度，$N_i$ 和 $N_j$ 是形函数，积分在单元域 $\\Omega_e$ 上进行。为计算此积分，我们将其转换到等参母单元域 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。面积微元变换为 $\\mathrm{d}\\Omega = \\det(\\mathbf{J})\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta$，其中 $\\mathbf{J}$ 是坐标映射的雅可比矩阵。\n\n物理坐标 $(x,y)$ 使用形函数从母单元坐标 $(\\xi,\\eta)$ 映射而来：\n$$\nx(\\xi,\\eta) = \\sum_{k=1}^{4} N_{k}(\\xi,\\eta) x_{k} \\quad \\text{和} \\quad y(\\xi,\\eta) = \\sum_{k=1}^{4} N_{k}(\\xi,\\eta) y_{k}\n$$\n节点坐标为 $(x_1, y_1) = (0,0)$、$(x_2, y_2) = (L_x, 0)$、$(x_3, y_3) = (L_x, L_y)$ 和 $(x_4, y_4) = (0, L_y)$。代入这些坐标可得：\n$$\nx(\\xi,\\eta) = N_2(\\xi,\\eta)L_x + N_3(\\xi,\\eta)L_x = \\frac{1}{4}(1+\\xi)(1-\\eta)L_x + \\frac{1}{4}(1+\\xi)(1+\\eta)L_x = \\frac{L_x}{4}(1+\\xi)(1-\\eta+1+\\eta) = \\frac{L_x}{2}(1+\\xi)\n$$\n$$\ny(\\xi,\\eta) = N_3(\\xi,\\eta)L_y + N_4(\\xi,\\eta)L_y = \\frac{1}{4}(1+\\xi)(1+\\eta)L_y + \\frac{1}{4}(1-\\xi)(1+\\eta)L_y = \\frac{L_y}{4}(1+\\eta)(1+\\xi+1-\\xi) = \\frac{L_y}{2}(1+\\eta)\n$$\n雅可比矩阵 $\\mathbf{J}$ 是\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{pmatrix}\n$$\n对于这个矩形单元，雅可比行列式是常数：\n$$\n\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}\n$$\n质量矩阵项的积分变为\n$$\nM_{ij}^{\\mathrm{c}} = \\rho\\, b\\, \\frac{L_x L_y}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_{i}(\\xi,\\eta) N_{j}(\\xi,\\eta)\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta\n$$\n问题指定使用 $2 \\times 2$ 高斯求积法则。函数 $f(\\xi,\\eta)$ 的积分近似为\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} f(\\xi,\\eta)\\, \\mathrm{d}\\xi\\, \\mathrm{d}\\eta \\approx \\sum_{k=1}^{4} w_k f(\\xi_k, \\eta_k)\n$$\n高斯点为 $(\\xi_k, \\eta_k) = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$，所有 $k \\in \\{1,2,3,4\\}$ 的权重均为 $w_k = 1$。由于被积函数 $N_i N_j$ 是一个在 $\\xi$ 和 $\\eta$ 上最高为 2 次的多项式，这个法则（对最高 3 次的多项式是精确的）能提供积分的精确值。\n令 $C = \\rho b \\frac{L_x L_y}{4}$。那么，\n$$\nM_{ij}^{\\mathrm{c}} = C \\sum_{k=1}^{4} N_{i}(\\xi_k, \\eta_k) N_{j}(\\xi_k, \\eta_k)\n$$\n首先，我们计算对角项 $M_{11}^{\\mathrm{c}}$：\n$$\nM_{11}^{\\mathrm{c}} = C \\sum_{k=1}^{4} [N_{1}(\\xi_k, \\eta_k)]^2\n$$\n接下来，我们使用行和集中法确定节点 1 的集中质量 $m_{1}^{\\mathrm{L}}$：\n$$\nm_{1}^{\\mathrm{L}} = \\sum_{j=1}^{4} M_{1j}^{\\mathrm{c}} = \\sum_{j=1}^{4} C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k) N_{j}(\\xi_k, \\eta_k) = C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k) \\left( \\sum_{j=1}^{4} N_{j}(\\xi_k, \\eta_k) \\right)\n$$\n这些形函数的一个基本性质是它们构成单位分解，即对于所有的 $(\\xi,\\eta)$ 都有 $\\sum_{j=1}^{4} N_{j}(\\xi,\\eta) = 1$。因此，集中质量的表达式简化为\n$$\nm_{1}^{\\mathrm{L}} = C \\sum_{k=1}^{4} N_{1}(\\xi_k, \\eta_k)\n$$\n令 $\\alpha = \\frac{1}{\\sqrt{3}}$。四个高斯点是 $p_1=(-\\alpha, -\\alpha)$、$p_2=(\\alpha, -\\alpha)$、$p_3=(\\alpha, \\alpha)$ 和 $p_4=(-\\alpha, \\alpha)$。我们计算 $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$ 在这些点上的值：\n$N_1(p_1) = N_1(-\\alpha, -\\alpha) = \\frac{1}{4}(1+\\alpha)^2$\n$N_1(p_2) = N_1(\\alpha, -\\alpha) = \\frac{1}{4}(1-\\alpha)(1+\\alpha) = \\frac{1}{4}(1-\\alpha^2)$\n$N_1(p_3) = N_1(\\alpha, \\alpha) = \\frac{1}{4}(1-\\alpha)^2$\n$N_1(p_4) = N_1(-\\alpha, \\alpha) = \\frac{1}{4}(1+\\alpha)(1-\\alpha) = \\frac{1}{4}(1-\\alpha^2)$\n\n现在我们可以计算 $m_{1}^{\\mathrm{L}}$：\n$$\nm_{1}^{\\mathrm{L}} = C \\left[ \\frac{1}{4}(1+\\alpha)^2 + \\frac{1}{4}(1-\\alpha^2) + \\frac{1}{4}(1-\\alpha)^2 + \\frac{1}{4}(1-\\alpha^2) \\right]\n$$\n$$\nm_{1}^{\\mathrm{L}} = \\frac{C}{4} \\left[ (1+2\\alpha+\\alpha^2) + (1-\\alpha^2) + (1-2\\alpha+\\alpha^2) + (1-\\alpha^2) \\right] = \\frac{C}{4} [1+1+1+1] = \\frac{C}{4}(4) = C\n$$\n所以，$m_{1}^{\\mathrm{L}} = C = \\rho b \\frac{L_x L_y}{4}$。这是预料之中的，因为对于矩形单元，行和集中法将单元总质量（$\\rho b L_x L_y$）的四分之一分配给每个节点。\n\n接下来，我们计算 $M_{11}^{\\mathrm{c}}$：\n$$\nM_{11}^{\\mathrm{c}} = C \\left( [N_1(p_1)]^2 + [N_1(p_2)]^2 + [N_1(p_3)]^2 + [N_1(p_4)]^2 \\right)\n$$\n$$\nM_{11}^{\\mathrm{c}} = C \\left[ \\left(\\frac{1}{4}(1+\\alpha)^2\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha^2)\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha)^2\\right)^2 + \\left(\\frac{1}{4}(1-\\alpha^2)\\right)^2 \\right]\n$$\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{16} \\left[ (1+\\alpha)^4 + 2(1-\\alpha^2)^2 + (1-\\alpha)^4 \\right]\n$$\n我们使用恒等式 $(1+\\alpha)^4 + (1-\\alpha)^4 = 2(1+6\\alpha^2+\\alpha^4)$。\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{16} \\left[ 2(1+6\\alpha^2+\\alpha^4) + 2(1-2\\alpha^2+\\alpha^4) \\right] = \\frac{C}{8} \\left[ (1+6\\alpha^2+\\alpha^4) + (1-2\\alpha^2+\\alpha^4) \\right] = \\frac{C}{8} [2+4\\alpha^2+2\\alpha^4] = \\frac{C}{4} [1+2\\alpha^2+\\alpha^4]\n$$\n代入 $\\alpha^2 = \\left(\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{3}$ 和 $\\alpha^4 = \\frac{1}{9}$：\n$$\nM_{11}^{\\mathrm{c}} = \\frac{C}{4} \\left[ 1 + 2\\left(\\frac{1}{3}\\right) + \\frac{1}{9} \\right] = \\frac{C}{4} \\left[ 1 + \\frac{2}{3} + \\frac{1}{9} \\right] = \\frac{C}{4} \\left[ \\frac{9+6+1}{9} \\right] = \\frac{C}{4} \\left( \\frac{16}{9} \\right) = \\frac{4}{9}C\n$$\n最后，我们计算所需的比率 $r$：\n$$\nr = \\frac{m_{1}^{\\mathrm{L}}}{M_{11}^{\\mathrm{c}}} = \\frac{C}{\\frac{4}{9}C} = \\frac{1}{\\frac{4}{9}} = \\frac{9}{4}\n$$\n对于双线性矩形单元，一个节点上的集中质量与一致质量矩阵对角项的比值为 $\\frac{9}{4}$。", "answer": "$$\n\\boxed{\\frac{9}{4}}\n$$", "id": "3540965"}, {"introduction": "除了正确构建矩阵，以物理上一致的方式使用它们也至关重要。这个计算练习揭示了一个关键陷阱：将简单的集中质量矩阵与一致推导的力矢量相结合，可能会违反能量守恒等基本物理定律。通过模拟一个简单的自由落体测试[@problem_id:3541036]，您将通过数值生成一个反例，揭示这种不一致性如何导致非物理性的能量注入，尤其是在扭曲的单元中。", "problem": "考虑一个二维连续体在均匀重力加速度作用下自由落体的半离散动力学。从牛顿第二定律及其 Galerkin 弱形式出发，分析一个密度为 $\\rho$、平面外单位厚度、在沿 y 轴负方向作用的重力 $g$ 下的物体。采用有限元法 (FEM) 进行离散化，使用双线性等参四边形形函数 $\\{N_i\\}_{i=1}^{4}$ 和节点垂直位置 $\\mathbf{y} = [y_1,y_2,y_3,y_4]^T$，垂直运动的半离散方程为\n$$\n\\mathbf{M}\\,\\mathbf{a} = \\mathbf{f},\n$$\n其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{f}$ 是重力载荷向量。一致质量矩阵定义为\n$$\n\\mathbf{M}_\\text{cons} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\mathbf{N}\\, \\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{N} = [N_1, N_2, N_3, N_4]$，$\\Omega_e$ 为单元域，而一致体力向量（在向上为正的坐标约定下，重力作用于 y 轴负方向）为\n$$\n\\mathbf{f}_\\text{cons} = - \\int_{\\Omega_e} \\rho\\, g\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega.\n$$\n令 $\\mathbf{r} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega$ 表示一致“行质量”向量，因此 $\\mathbf{f}_\\text{cons} = - g \\mathbf{r}$。再考虑一个对角“集中”质量矩阵 $\\mathbf{M}_\\text{lump} = \\mathrm{diag}(m_1,m_2,m_3,m_4)$，它是通过将单元总质量平均分配给其四个节点得到的，$m_i = (\\int_{\\Omega_e} \\rho\\, \\mathrm{d}\\Omega)/4$，而不考虑形状的扭曲。自由落体的初始条件为 $\\mathbf{y}(0) = \\mathbf{y}_0$（初始节点坐标，单位为米）和 $\\mathbf{v}(0) = \\mathbf{0}$（初始速度），无位移约束，无内部刚度（即可变形离散体的纯刚体自由落体）。\n\n将物理总机械能定义为动能和重力势能之和，\n$$\nE(t) = \\tfrac{1}{2}\\, \\mathbf{v}(t)^T\\, \\mathbf{M}_\\text{cons}\\, \\mathbf{v}(t) \\;+\\; g\\, \\mathbf{r}^T \\mathbf{y}(t),\n$$\n这对应于连续体能量的一致离散化（注意，对于向上为正的 y 坐标，势能 $g\\,\\mathbf{r}^T\\mathbf{y}$ 等于 $\\int_{\\Omega_e} \\rho\\, g\\, y\\, \\mathrm{d}\\Omega$）。在精确的刚体自由落体运动中，$E(t)$ 必须随时间保持恒定。\n\n你的任务是构建一个反例，证明在扭曲单元中，使用对角等节点“集中”质量矩阵 $\\mathbf{M}_\\text{lump}$ 与一致重力载荷向量 $\\mathbf{f}_\\text{cons}$ 相结合，会注入非物理的刚体能量，尽管使用相同 $\\mathbf{f}_\\text{cons}$ 的一致格式 $\\mathbf{M}_\\text{cons}$ 能保持正确的能量平衡。\n\n算法任务：\n- 对于下面的每个单元，在等参坐标的父正方形上使用 $2\\times 2$ 高斯积分计算 $\\mathbf{M}_\\text{cons}$ 和 $\\mathbf{r}$，采用双线性形函数和到给定物理节点坐标的标准映射。\n- 通过将单元总质量平均分配给四个节点来构成 $\\mathbf{M}_\\text{lump}$，$m_i = (\\sum_j r_j)/4$。\n- 分别计算一致格式和集中格式的节点加速度，\n  $$\n  \\mathbf{a}_\\text{cons} = \\mathbf{M}_\\text{cons}^{-1} \\mathbf{f}_\\text{cons},\\quad\n  \\mathbf{a}_\\text{lump} = \\mathbf{M}_\\text{lump}^{-1} \\mathbf{f}_\\text{cons}.\n  $$\n- 使用 $\\mathbf{v}(0)=\\mathbf{0}$ 的精确匀加速运动学，将时间推演至 $t$：\n  $$\n  \\mathbf{v}(t) = \\mathbf{a}\\, t,\\qquad \\mathbf{y}(t) = \\mathbf{y}_0 + \\tfrac{1}{2}\\,\\mathbf{a}\\, t^2.\n  $$\n  分别对 $\\mathbf{a}_\\text{cons}$ 和 $\\mathbf{a}_\\text{lump}$ 执行此操作，以获得 $\\mathbf{v}_\\text{cons}(t), \\mathbf{y}_\\text{cons}(t)$ 和 $\\mathbf{v}_\\text{lump}(t), \\mathbf{y}_\\text{lump}(t)$。\n- 计算两种格式相对于初始能量 $E(0)$ 的能量变化，\n  $$\n  \\Delta E_\\text{cons}(t) = E_\\text{cons}(t) - E(0),\\qquad\n  \\Delta E_\\text{lump}(t) = E_\\text{lump}(t) - E(0),\n  $$\n  其中 $E_\\text{cons}(t)$ 和 $E_\\text{lump}(t)$ 均使用相同的物理能量定义 $E(t) = \\tfrac{1}{2}\\mathbf{v}^T \\mathbf{M}_\\text{cons}\\mathbf{v} + g \\mathbf{r}^T \\mathbf{y}$ 进行评估。能量单位使用国际单位制单位焦耳 (J)。\n\n测试套件和参数：\n- 材料密度 $\\rho = 1700$ kg/m$^3$，重力加速度 $g = 9.81$ m/s$^2$，时间 $t = 0.2$ s，平面外单位厚度。y 坐标向上为正。\n- 三个单单元算例（每个算例为一个双线性等参四边形，其四个节点按逆时针顺序列出，坐标 $(x_i, y_i)$ 单位为米）：\n  1. 矩形（基准，常数雅可比）：$\\big[(0,0),(2,0),(2,1),(0,1)\\big]$。\n  2. 轻度扭曲的梯形：$\\big[(0,0),(2,0.2),(2,1.2),(0,1)\\big]$。\n  3. 严重扭曲的梯形：$\\big[(0,0),(2,0.8),(2,1.6),(0,1)\\big]$。\n\n计算要求：\n- 实现稳健的数值积分（对于 $2\\times 2$ 高斯法则下的双线性映射是精确的）来组装 $\\mathbf{M}_\\text{cons}$ 和 $\\mathbf{r}$。\n- 在计算 $E(t)$ 时，对两种格式都使用一致能量定义。\n\n交付成果和最终输出格式：\n- 对于每个测试算例，输出以焦耳为单位的浮点数对 $\\big[\\Delta E_\\text{cons}(t), \\Delta E_\\text{lump}(t)\\big]$，四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为方括号括起来的、由逗号分隔的数对列表（例如：\"[[e1_cons,e1_lump],[e2_cons,e2_lump],[e3_cons,e3_lump]]\"）。\n\n注：\n- 如果轻度扭曲和严重扭曲的算例表现出 $\\Delta E_\\text{lump}(t) > 0$，而 $\\Delta E_\\text{cons}(t)$ 在数值上保持接近于零（两者均以焦耳报告），则该反例成立。矩形算例作为一种边界条件，由于精确等价，两种情况下的能量变化都应在数值上接近于零。", "solution": "该问题陈述是计算力学领域中的一个有效练习，特别是在应用于结构动力学的有限元法 (FEM) 领域。它以牛顿力学和 Galerkin 方法的原理为科学基础，提供了所有必要的数据和条件，是适定的，并且表述客观。任务是通过一个反例来证明，在模拟的刚体运动中，集中质量矩阵与一致力向量的不一致配对会导致对能量守恒的非物理性破坏。\n\n此处涉及的基本物理原理是在保守力场影响下运动的系统的总机械能守恒。对于在均匀重力下自由落体的物体，其动能和势能之和必须保持恒定。从 Galerkin 有限元格式推导出的半离散运动方程由下式给出：\n$$\n\\mathbf{M}\\,\\mathbf{a} = \\mathbf{f}\n$$\n其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{a}$ 是节点加速度向量，$\\mathbf{f}$ 是节点力向量。\n\n一致质量矩阵 $\\mathbf{M}_\\text{cons}$ 直接由 Galerkin 过程产生，定义为：\n$$\n\\mathbf{M}_\\text{cons} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\mathbf{N}\\, \\mathrm{d}\\Omega\n$$\n其中 $\\rho$ 是材料密度，$\\mathbf{N} = [N_1, N_2, N_3, N_4]$ 是双线性形函数向量，积分在单元域 $\\Omega_e$ 上进行。该矩阵正确地表示了由形函数插值的速度场的动能。\n\n类似地，对于作用在 y 轴负方向的重力，其一致体力向量为：\n$$\n\\mathbf{f}_\\text{cons} = - \\int_{\\Omega_e} \\rho\\, g\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega = -g \\mathbf{r}\n$$\n其中 $g$ 是重力加速度，$\\mathbf{r} = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T \\,\\mathrm{d}\\Omega$ 是一致节点质量贡献向量。\n\n一种常见的简化是为了计算效率而使用对角或“集中”质量矩阵 $\\mathbf{M}_\\text{lump}$。问题指定了一种特定的集中方案，其中单元总质量 $M_{tot} = \\int_{\\Omega_e} \\rho\\, \\mathrm{d}\\Omega = \\sum_i r_i$ 被平均分配到四个节点上：\n$$\n\\mathbf{M}_\\text{lump} = \\mathrm{diag}\\left(\\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}, \\frac{M_{tot}}{4}\\right)\n$$\n本研究的核心在于分析“不一致”系统 $\\mathbf{M}_\\text{lump} \\mathbf{a} = \\mathbf{f}_\\text{cons}$，并将其能量行为与一致系统 $\\mathbf{M}_\\text{cons} \\mathbf{a} = \\mathbf{f}_\\text{cons}$ 进行比较。\n\n离散系统的总机械能被一致地定义为：\n$$\nE(t) = \\frac{1}{2}\\, \\mathbf{v}(t)^T\\, \\mathbf{M}_\\text{cons}\\, \\mathbf{v}(t) \\;+\\; g\\, \\mathbf{r}^T \\mathbf{y}(t)\n$$\n给定静止的初始条件 $\\mathbf{v}(0) = \\mathbf{0}$，初始能量纯粹是势能：$E(0) = g\\, \\mathbf{r}^T \\mathbf{y}_0$。使用匀加速运动学，我们有 $\\mathbf{v}(t) = \\mathbf{a}t$ 和 $\\mathbf{y}(t) = \\mathbf{y}_0 + \\frac{1}{2}\\mathbf{a}t^2$。从 $t=0$ 到稍后时间 $t$ 的能量变化是：\n$$\n\\Delta E(t) = E(t) - E(0) = \\left( \\frac{1}{2}(\\mathbf{a}t)^T \\mathbf{M}_\\text{cons} (\\mathbf{a}t) + g\\mathbf{r}^T (\\mathbf{y}_0 + \\frac{1}{2}\\mathbf{a}t^2) \\right) - g\\mathbf{r}^T\\mathbf{y}_0\n$$\n$$\n\\Delta E(t) = \\frac{1}{2}t^2 \\mathbf{a}^T \\mathbf{M}_\\text{cons} \\mathbf{a} + \\frac{1}{2}t^2 g\\mathbf{r}^T \\mathbf{a}\n$$\n代入 $\\mathbf{f}_\\text{cons} = -g\\mathbf{r}$，我们得到能量变化的紧凑表达式：\n$$\n\\Delta E(t) = \\frac{1}{2}t^2 \\left( \\mathbf{a}^T \\mathbf{M}_\\text{cons} \\mathbf{a} - \\mathbf{f}_\\text{cons}^T \\mathbf{a} \\right)\n$$\n对于一致格式，$\\mathbf{a} = \\mathbf{a}_\\text{cons} = \\mathbf{M}_\\text{cons}^{-1} \\mathbf{f}_\\text{cons}$。这意味着 $\\mathbf{M}_\\text{cons} \\mathbf{a}_\\text{cons} = \\mathbf{f}_\\text{cons}$。由于 $\\mathbf{M}_\\text{cons}$ 是对称的，所以 $\\mathbf{a}_\\text{cons}^T \\mathbf{M}_\\text{cons} = \\mathbf{f}_\\text{cons}^T$。将此代入能量变化方程，得到 $\\Delta E_\\text{cons}(t) = \\frac{1}{2}t^2 (\\mathbf{f}_\\text{cons}^T \\mathbf{a}_\\text{cons} - \\mathbf{f}_\\text{cons}^T \\mathbf{a}_\\text{cons}) = 0$。因此，一致格式是精确能量守恒的。\n\n对于指定的集中格式，$\\mathbf{a} = \\mathbf{a}_\\text{lump} = \\mathbf{M}_\\text{lump}^{-1} \\mathbf{f}_\\text{cons}$。一般来说，$\\mathbf{M}_\\text{cons} \\mathbf{a}_\\text{lump} \\neq \\mathbf{f}_\\text{cons}$，所以 $\\Delta E_\\text{lump}(t)$ 表达式中括号里的项将不为零，从而导致非物理的能量变化。\n\n计算步骤如下：\n1.  对于每个单元几何形状，在等参父单元域 $[-1,1] \\times [-1,1]$ 上使用 $2 \\times 2$ 高斯求积法则数值计算 $\\mathbf{M}_\\text{cons}$ 和 $\\mathbf{r}$ 的积分。对于双线性单元遇到的被积函数，该法则是精确的，因为它们在每个父坐标 $\\xi$ 和 $\\eta$ 中最多是三次多项式。\n2.  在每个高斯点处计算等参映射的雅可比 $J(\\xi, \\eta) = \\det(\\mathbf{J})$。面积微元为 $\\mathrm{d}\\Omega = J(\\xi, \\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n3.  通过将在四个高斯点处计算的各自被积函数值乘以材料密度 $\\rho$ 和局部雅可比行列式 $J_k$ 再求和，来组装 $\\mathbf{M}_\\text{cons}$ 和 $\\mathbf{r}$。由于所有高斯权重均为 1，组装过程为：\n    $$\n    \\mathbf{M}_\\text{cons} = \\rho \\sum_{k=1}^{4} \\mathbf{N}(\\xi_k, \\eta_k)^T \\mathbf{N}(\\xi_k, \\eta_k) J_k, \\quad \\mathbf{r} = \\rho \\sum_{k=1}^{4} \\mathbf{N}(\\xi_k, \\eta_k)^T J_k\n    $$\n4.  构建集中质量矩阵 $\\mathbf{M}_\\text{lump}$ 和一致力向量 $\\mathbf{f}_\\text{cons}$。\n5.  通过求解相应的线性系统计算节点加速度 $\\mathbf{a}_\\text{cons}$ 和 $\\mathbf{a}_\\text{lump}$。\n6.  使用推导出的公式，在时间步长 $t=0.2\\,\\text{s}$ 和给定的材料参数下，计算能量变化 $\\Delta E_\\text{cons}(t)$ 和 $\\Delta E_\\text{lump}(t)$。\n\n对三种指定的单元几何形状实施此程序。预期结果将显示，对于未扭曲的矩形单元，两种格式都能保持能量守恒。然而，对于扭曲的梯形单元，不一致的集中格式将向系统中注入一个伪的正值能量，且扭曲越强，效应越显著。这证明了当质量和力的表示之间的一致性被破坏时，可能出现数值误差和不稳定性。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the energy conservation of consistent versus\n    inconsistent (lumped mass, consistent force) FEM formulations for\n    a 2D element in free fall.\n    \"\"\"\n    #\n    # --- Problem Parameters ---\n    #\n    rho = 1700.0  # kg/m^3\n    g = 9.81      # m/s^2\n    t = 0.2       # s\n\n    #\n    # --- Test Cases: Nodal coordinates (x, y) in meters ---\n    # Node ordering is counter-clockwise starting from bottom-left.\n    #\n    test_cases = [\n        # Case 1: Rectangular element (baseline)\n        np.array([(0.0, 0.0), (2.0, 0.0), (2.0, 1.0), (0.0, 1.0)]),\n        # Case 2: Mildly distorted trapezoid\n        np.array([(0.0, 0.0), (2.0, 0.2), (2.0, 1.2), (0.0, 1.0)]),\n        # Case 3: Strongly distorted trapezoid\n        np.array([(0.0, 0.0), (2.0, 0.8), (2.0, 1.6), (0.0, 1.0)])\n    ]\n\n    all_results = []\n\n    #\n    # --- Numerical Integration Setup (2x2 Gauss Quadrature) ---\n    #\n    gauss_p = 1.0 / np.sqrt(3.0)\n    gauss_points = [\n        (-gauss_p, -gauss_p), (gauss_p, -gauss_p),\n        (gauss_p, gauss_p), (-gauss_p, gauss_p)\n    ]\n    # Weights for 2x2 Gauss quadrature are all 1.0\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    #\n    # --- Main Calculation Loop ---\n    #\n    for nodes in test_cases:\n        #\n        # Step 1: Compute Consistent Mass Matrix (M_cons) and Row-Mass Vector (r_vec)\n        #\n        M_cons = np.zeros((4, 4))\n        r_vec = np.zeros(4)\n\n        for i in range(len(gauss_points)):\n            xi, eta = gauss_points[i]\n            weight = gauss_weights[i]\n\n            # Bilinear shape functions N(xi, eta) at the current Gauss point\n            N = 0.25 * np.array([\n                (1 - xi) * (1 - eta),\n                (1 + xi) * (1 - eta),\n                (1 + xi) * (1 + eta),\n                (1 - xi) * (1 + eta)\n            ])\n\n            # Derivatives of N w.r.t. parent coordinates (xi, eta)\n            dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n            dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n\n            # Jacobian matrix of the isoparametric mapping\n            J_mat = np.array([\n                [np.dot(dN_dxi, nodes[:, 0]), np.dot(dN_dxi, nodes[:, 1])],\n                [np.dot(dN_deta, nodes[:, 0]), np.dot(dN_deta, nodes[:, 1])]\n            ])\n\n            # Jacobian determinant\n            det_J = np.linalg.det(J_mat)\n            if det_J = 0:\n                raise ValueError(\"Jacobian is non-positive. Element is degenerate or inverted.\")\n\n            # Accumulate contributions to M_cons and r_vec integrals\n            # Unit thickness is assumed (h=1)\n            M_cons += rho * np.outer(N, N) * det_J * weight\n            r_vec += rho * N * det_J * weight\n\n        #\n        # Step 2: Form other matrices and vectors\n        #\n        # Consistent gravitational force vector\n        f_cons = -g * r_vec\n\n        # Lumped mass matrix (equal distribution of total mass)\n        total_mass = np.sum(r_vec)\n        m_lump_diag_val = total_mass / 4.0\n        M_lump = np.diag([m_lump_diag_val] * 4)\n\n        #\n        # Step 3: Compute nodal accelerations for both formulations\n        #\n        # a_cons = inv(M_cons) * f_cons\n        a_cons = np.linalg.solve(M_cons, f_cons)\n        \n        # a_lump = inv(M_lump) * f_cons\n        a_lump = f_cons / m_lump_diag_val\n\n        #\n        # Step 4: Compute the change in total mechanical energy for both cases\n        # Delta_E = 0.5 * t^2 * (a.T @ M_cons @ a - f_cons.T @ a)\n        #\n        \n        # Consistent formulation\n        delta_E_cons = 0.5 * t**2 * (a_cons.T @ M_cons @ a_cons - f_cons.T @ a_cons)\n\n        # Inconsistent \"lumped\" formulation (energy is still measured via M_cons)\n        delta_E_lump = 0.5 * t**2 * (a_lump.T @ M_cons @ a_lump - f_cons.T @ a_lump)\n        \n        # Store results rounded to 6 decimal places\n        all_results.append([round(delta_E_cons, 6), round(delta_E_lump, 6)])\n\n    #\n    # --- Final Output ---\n    #\n    output_str = \"[\" + \",\".join([f\"[{e_c},{e_l}]\" for e_c, e_l in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3541036"}, {"introduction": "在一致质量矩阵和集中质量矩阵之间的选择，通常涉及在精度和计算成本之间的权衡。这项高级练习超越了二元选择，引入了混合质量矩阵的概念。您将进行色散分析[@problem_id:3541002]，了解质量矩阵公式如何影响数值波的传播速度，并推导出一个最优的混合参数以最小化相位误差，从而获得比任何单一纯粹公式更高的精度。", "problem": "考虑在水平均方位移场中被理想化为一维（1D）的均质土柱中的垂直剪切波传播。连续介质运动方程为剪切波方程 $ \\rho \\, \\frac{\\partial^{2} u}{\\partial t^{2}} = G \\, \\frac{\\partial^{2} u}{\\partial z^{2}} $，其中 $ \\rho $ 是质量密度，$ G $ 是剪切模量，$ u(z,t) $ 是水平位移。剪切波速为 $ c_{s} = \\sqrt{G/\\rho} $。使用包含 $ N $ 个长度为 $ h $ 的线性二节点单元的均匀有限元（FE）网格对土柱进行离散化，并设 $ M(\\theta) = \\theta \\, M_{\\text{cons}} + (1 - \\theta) \\, M_{\\text{lump}} $ 是由一致质量矩阵 $ M_{\\text{cons}} $ 和集中质量矩阵 $ M_{\\text{lump}} $ 构成的混合半离散质量矩阵，其中 $ \\theta \\in [0,1] $。在均匀网格上假设平面波解为 $ u_{j}(t) = \\Re\\{ \\hat{u} \\exp(\\mathrm{i} \\kappa j h - \\mathrm{i} \\omega t) \\} $，其中 $ j $ 是节点索引，$ \\kappa $ 是波数，$ \\omega $ 是圆频率。\n\n从剪切波方程和标准线性形函数出发，推导混合质量矩阵 $ M(\\theta) $ 的连接 $ \\omega $ 和 $ \\kappa $ 的半离散色散关系。然后，对于与场地响应相关的指定目标频带 $ [\\omega_{1}, \\omega_{2}] $，定义频带平均相对相位误差的平方为\n$$\n\\mathcal{E}(\\theta) = \\int_{\\omega_{1}}^{\\omega_{2}} \\left( \\frac{\\kappa_{h}(\\omega;\\theta) - \\kappa(\\omega)}{\\kappa(\\omega)} \\right)^{2} \\, \\mathrm{d}\\omega,\n$$\n其中 $ \\kappa(\\omega) = \\omega / c_{s} $ 是精确的连续介质波数，$ \\kappa_{h}(\\omega;\\theta) $ 是从半离散色散关系推断出的数值波数。在适用于工程场地响应网格的小参数范围内，假设无量纲波数 $ s = \\kappa h $ 在该频带上满足 $ s \\ll 1 $，并将色散关系系统地展开到足够高的 $ s $ 的阶数，以捕捉对 $ \\mathcal{E}(\\theta) $ 的主导贡献。\n\n使用此展开式，推导一个解析判据，用以选择 $ \\theta $ 使得在频带 $ [\\omega_{1}, \\omega_{2}] $ 上主导阶的 $ \\mathcal{E}(\\theta) $ 最小化，并计算由此产生的 $ \\theta $ 的最优值。将 $ \\theta $ 的最终答案表示为一个无单位的精确数值。无需四舍五入。", "solution": "用户希望找到有限元质量矩阵的最佳混合参数 $ \\theta $，以最小化一维剪切波传播的频带平均相位误差。\n\n### 第 1 步：问题验证\n\n首先，我将从问题陈述中逐字提取给定信息。\n- **控制方程**：$ \\rho \\, \\frac{\\partial^{2} u}{\\partial t^{2}} = G \\, \\frac{\\partial^{2} u}{\\partial z^{2}} $\n- **参数**：质量密度 $ \\rho $，剪切模量 $ G $，水平位移 $ u(z,t) $。\n- **波速**：$ c_{s} = \\sqrt{G/\\rho} $。\n- **离散化**：包含 $ N $ 个长度为 $ h $ 的线性二节点单元的均匀有限元（FE）网格。\n- **质量矩阵**：一个混合半离散质量矩阵 $ M(\\theta) = \\theta \\, M_{\\text{cons}} + (1 - \\theta) \\, M_{\\text{lump}} $，其中 $ \\theta \\in [0,1] $，$ M_{\\text{cons}} $ 是一致质量矩阵，$ M_{\\text{lump}} $ 是集中质量矩阵。\n- **假设解形式**：网格上的平面波解，$ u_{j}(t) = \\Re\\{ \\hat{u} \\exp(\\mathrm{i} \\kappa j h - \\mathrm{i} \\omega t) \\} $，其中 $ j $ 是节点索引，$ \\kappa $ 是波数，$ \\omega $ 是圆频率。\n- **误差泛函**：频带平均相对相位误差的平方，$ \\mathcal{E}(\\theta) = \\int_{\\omega_{1}}^{\\omega_{2}} \\left( \\frac{\\kappa_{h}(\\omega;\\theta) - \\kappa(\\omega)}{\\kappa(\\omega)} \\right)^{2} \\, \\mathrm{d}\\omega $。\n- **波数**：$ \\kappa(\\omega) = \\omega / c_{s} $（精确）和 $ \\kappa_{h}(\\omega;\\theta) $（数值）。\n- **渐近范围**：小无量纲波数 $ s = \\kappa h \\ll 1 $。\n\n接下来，我将根据指定的标准验证问题。\n- **科学依据**：该问题建立在一维剪切波方程之上，这是连续介质力学和地球物理学中的一个标准模型。有限元法、一致和集中质量矩阵、色散分析以及离散化参数的优化都是计算力学和数值分析中公认的标准技术。该前提在科学上是合理的。\n- **适定性**：该问题要求推导数值色散关系并基于误差泛函优化参数 $ \\theta $。步骤定义清晰，预期会有一个唯一的、有意义的 $ \\theta $ 解。该问题是适定的。\n- **客观性**：语言正式而精确，所有术语都在计算力学的背景下有明确定义。该问题不含主观或模棱两可的陈述。\n\n该问题不违反任何无效性标准。它在科学上是合理的，陈述是形式化的，内容是完整的，并且不是微不足道的。要求找到一个独立于其他参数的特定数值 $ \\theta $，这表明需要揭示一个明确定义的潜在原理，这是此类分析问题的共同特征。\n\n结论是该问题是**有效的**。我将继续进行解答。\n\n### 第 2 步：半离散运动方程的推导\n\n控制方程的弱形式是通过乘以一个测试函数 $ v(z) $ 并在域上积分得到的。半离散有限元方程从该弱形式导出。对于一个由长度为 $ h $ 的线性二节点单元组成的均匀网格，单元刚度矩阵 $ K^e $ 和单元一致质量矩阵 $ M^e_{\\text{cons}} $ 是标准的。\n\n单元刚度矩阵由下式给出：\n$$ K^e = \\int_0^h G (B^T B) \\, dz = \\frac{G}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n其中 $ B $ 是形函数的空间导数矩阵。\n\n单元一致质量矩阵为：\n$$ M^e_{\\text{cons}} = \\int_0^h \\rho (N^T N) \\, dz = \\frac{\\rho h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n其中 $ N $ 是形函数向量。\n\n单元集中质量矩阵通常通过对一致质量矩阵的行求和并将总和置于对角线上来形成：\n$$ M^e_{\\text{lump}} = \\frac{\\rho h}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n混合单元质量矩阵 $ M^e(\\theta) $ 是：\n$$ M^e(\\theta) = \\theta M^e_{\\text{cons}} + (1-\\theta) M^e_{\\text{lump}} = \\theta \\frac{\\rho h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + (1-\\theta) \\frac{\\rho h}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{\\rho h}{6} \\begin{pmatrix} 2\\theta + 3(1-\\theta)  \\theta \\\\ \\theta  2\\theta + 3(1-\\theta) \\end{pmatrix} = \\frac{\\rho h}{6} \\begin{pmatrix} 3-\\theta  \\theta \\\\ \\theta  3-\\theta \\end{pmatrix} $$\n对于无限或周期性网格，在内部节点 $ j $ 处的半离散运动方程是通过组合相邻单元的贡献得到的：\n$$ (M(\\theta)\\ddot{\\boldsymbol{u}})_j + (K\\boldsymbol{u})_j = 0 $$\n刚度项为：\n$$ (K\\boldsymbol{u})_j = \\frac{G}{h}(-u_{j-1} + 2u_j - u_{j+1}) $$\n质量项为：\n$$ (M(\\theta)\\ddot{\\boldsymbol{u}})_j = \\frac{\\rho h}{6} [ \\theta \\ddot{u}_{j-1} + ( (3-\\theta) + (3-\\theta) ) \\ddot{u}_j + \\theta \\ddot{u}_{j+1} ] = \\frac{\\rho h}{6} [ \\theta \\ddot{u}_{j-1} + 2(3-\\theta) \\ddot{u}_j + \\theta \\ddot{u}_{j+1} ] $$\n节点 $ j $ 的完整方程为：\n$$ \\frac{\\rho h}{6} [ \\theta \\ddot{u}_{j-1} + (6-2\\theta) \\ddot{u}_j + \\theta \\ddot{u}_{j+1} ] + \\frac{G}{h} [-u_{j-1} + 2u_j - u_{j+1}] = 0 $$\n\n### 第 3 步：数值色散关系的推导\n\n我们将平面波解 $ u_j(t) = \\hat{u} \\exp(\\mathrm{i} \\kappa_h j h - \\mathrm{i} \\omega t) $ 代入半离散方程中。二阶时间导数为 $ \\ddot{u}_j = -\\omega^2 u_j $。空间关系为 $ u_{j-1} = u_j \\exp(-\\mathrm{i}\\kappa_h h) $ 和 $ u_{j+1} = u_j \\exp(+\\mathrm{i}\\kappa_h h) $。令 $ s_h = \\kappa_h h $。\n代入并除以 $ u_j $：\n$$ -\\omega^2 \\frac{\\rho h}{6} [ \\theta \\exp(-\\mathrm{i}s_h) + (6-2\\theta) + \\theta \\exp(\\mathrm{i}s_h) ] + \\frac{G}{h} [-\\exp(-\\mathrm{i}s_h) + 2 - \\exp(\\mathrm{i}s_h)] = 0 $$\n使用 $ \\exp(\\mathrm{i}s_h) + \\exp(-\\mathrm{i}s_h) = 2\\cos(s_h) $：\n$$ -\\omega^2 \\frac{\\rho h}{6} [ 2\\theta \\cos(s_h) + 6-2\\theta ] + \\frac{G}{h} [-2\\cos(s_h) + 2] = 0 $$\n$$ \\omega^2 \\frac{\\rho h}{6} [ 6 - 2\\theta(1-\\cos(s_h)) ] = \\frac{2G}{h} [1-\\cos(s_h)] $$\n$$ \\omega^2 \\rho h [ 1 - \\frac{\\theta}{3}(1-\\cos(s_h)) ] = \\frac{2G}{h} (1-\\cos(s_h)) $$\n回顾 $ c_s^2 = G/\\rho $：\n$$ \\omega^2 = \\frac{2c_s^2}{h^2} \\frac{1-\\cos(s_h)}{1 - \\frac{\\theta}{3}(1-\\cos(s_h))} $$\n使用半角恒等式 $ 1-\\cos(s_h) = 2\\sin^2(s_h/2) $：\n$$ \\omega^2 = \\frac{2c_s^2}{h^2} \\frac{2\\sin^2(s_h/2)}{1 - \\frac{2\\theta}{3}\\sin^2(s_h/2)} = \\frac{4c_s^2}{h^2} \\frac{\\sin^2(s_h/2)}{1 - \\frac{2\\theta}{3}\\sin^2(s_h/2)} $$\n这就是数值色散关系。\n\n### 第 4 步：渐近展开与误差分析\n\n我们希望找到相对误差 $ (\\kappa_h - \\kappa)/\\kappa $。使用无量纲波数 $ s_h = \\kappa_h h $ 和 $ s = \\kappa h = (\\omega/c_s)h $ 更为方便。它们的关系是 $ s_h/s = \\kappa_h/\\kappa $。\n从色散关系，我们可以写出：\n$$ \\left(\\frac{\\omega h}{2c_s}\\right)^2 = \\frac{s^2}{4} = \\frac{\\sin^2(s_h/2)}{1 - \\frac{2\\theta}{3}\\sin^2(s_h/2)} $$\n我们需在 $ s \\ll 1 $ 的条件下求解以 $ s $ 表示的 $ s_h $。这意味着 $ s_h $ 也很小。我们使用 $ \\sin(x) $ 的泰勒级数展开：\n$$ \\sin(x) = x - \\frac{x^3}{6} + O(x^5) \\implies \\sin^2(x) = \\left(x - \\frac{x^3}{6} + \\dots\\right)^2 = x^2 - \\frac{x^4}{3} + O(x^6) $$\n将此应用于 $ \\sin^2(s_h/2) $：\n$$ \\sin^2(s_h/2) = \\left(\\frac{s_h}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{s_h}{2}\\right)^4 + O(s_h^6) = \\frac{s_h^2}{4} - \\frac{s_h^4}{48} + O(s_h^6) $$\n将此代入色散关系：\n$$ \\frac{s^2}{4} = \\frac{\\frac{s_h^2}{4} - \\frac{s_h^4}{48} + O(s_h^6)}{1 - \\frac{2\\theta}{3}(\\frac{s_h^2}{4} - \\dots)} = \\left(\\frac{s_h^2}{4} - \\frac{s_h^4}{48}\\right)\\left(1 + \\frac{\\theta s_h^2}{6} + \\dots\\right) $$\n$$ \\frac{s^2}{4} = \\frac{s_h^2}{4} + \\frac{\\theta s_h^4}{24} - \\frac{s_h^4}{48} + O(s_h^6) = \\frac{s_h^2}{4} - \\frac{1-2\\theta}{48}s_h^4 + O(s_h^6) $$\n在主导阶上，$ s^2 \\approx s_h^2 $。我们可以在第二项中用 $ s^4 $ 替换 $ s_h^4 $：\n$$ s^2 \\approx s_h^2 - \\frac{1-2\\theta}{12}s^4 \\implies s_h^2 \\approx s^2 + \\frac{1-2\\theta}{12}s^4 $$\n取平方根并使用二项式展开 $ (1+x)^{1/2} \\approx 1 + x/2 $：\n$$ s_h \\approx \\sqrt{s^2\\left(1 + \\frac{1-2\\theta}{12}s^2\\right)} = s\\left(1 + \\frac{1-2\\theta}{12}s^2\\right)^{1/2} \\approx s\\left(1 + \\frac{1-2\\theta}{24}s^2\\right) $$\n相对相位误差为：\n$$ \\frac{\\kappa_h - \\kappa}{\\kappa} = \\frac{s_h - s}{s} \\approx \\frac{1-2\\theta}{24}s^2 $$\n这是相对误差的主导阶项。\n\n### 第 5 步：误差泛函的最小化\n\n频带平均相对相位误差的平方由下式给出：\n$$ \\mathcal{E}(\\theta) = \\int_{\\omega_{1}}^{\\omega_{2}} \\left( \\frac{\\kappa_{h}(\\omega;\\theta) - \\kappa(\\omega)}{\\kappa(\\omega)} \\right)^{2} \\, \\mathrm{d}\\omega $$\n代入相对误差的主导阶项：\n$$ \\mathcal{E}(\\theta) \\approx \\int_{\\omega_{1}}^{\\omega_{2}} \\left( \\frac{1-2\\theta}{24}s^2 \\right)^{2} \\, \\mathrm{d}\\omega $$\n因为 $ s = \\kappa h = (\\omega/c_s) h $：\n$$ \\mathcal{E}(\\theta) \\approx \\int_{\\omega_{1}}^{\\omega_{2}} \\left( \\frac{1-2\\theta}{24} \\right)^2 \\left( \\frac{\\omega h}{c_s} \\right)^4 \\, \\mathrm{d}\\omega $$\n我们可以将不依赖于 $ \\omega $ 的项提取出来：\n$$ \\mathcal{E}(\\theta) \\approx \\left( \\frac{1-2\\theta}{24} \\right)^2 \\left( \\frac{h}{c_s} \\right)^4 \\int_{\\omega_{1}}^{\\omega_{2}} \\omega^4 \\, \\mathrm{d}\\omega $$\n积分 $ \\int_{\\omega_{1}}^{\\omega_{2}} \\omega^4 \\, \\mathrm{d}\\omega = \\frac{\\omega_2^5 - \\omega_1^5}{5} $ 是一个正常数。令乘以含 $ \\theta $ 项的整个因子为 $ C $：\n$$ C = \\frac{1}{24^2} \\left( \\frac{h}{c_s} \\right)^4 \\frac{\\omega_2^5 - \\omega_1^5}{5}  0 $$\n因此，在主导阶上，误差泛函为：\n$$ \\mathcal{E}(\\theta) \\approx C (1-2\\theta)^2 $$\n为了最小化 $ \\mathcal{E}(\\theta) $，我们必须最小化项 $ (1-2\\theta)^2 $。该项的最小值为零，当其底数为零时出现。因此，最小化主导阶误差的解析判据是：\n$$ 1-2\\theta = 0 $$\n求解 $ \\theta $ 得到最优值。注意，如果满足此判据，则主导阶误差项（量级为 $ s^2 $ 或 $ h^2 $）消失。数值格式在空间上变为四阶精度，误差 $ \\mathcal{E}(\\theta) $ 与 $ h $ 的更高次幂成正比，使得当 $ h $ 很小时误差显著减小。\n\n### 第 6 步：最终计算\n\n$ \\theta $ 的最优值通过求解最小化判据得到：\n$$ 1 - 2\\theta = 0 \\implies 2\\theta = 1 \\implies \\theta = \\frac{1}{2} $$\n此值是一个单一的精确数，符合问题陈述的要求。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3541002"}]}