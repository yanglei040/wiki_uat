{"hands_on_practices": [{"introduction": "在将任何数学模型应用于实际工程问题之前，深刻理解其参数的物理意义至关重要。本练习 [@problem_id:3515220] 将通过量纲分析，帮助您将瑞利阻尼中看似抽象的系数 $\\alpha$ 和 $\\beta$ 与基本的物理量纲联系起来。此外，本练习还将引导您思考这些系数在比例模型试验中的缩放规律，这对于连接实验岩土力学与数值模拟至关重要。", "problem": "一个饱和土层的线性弹性动力学有限元模型被用来模拟地震响应。物理坐标系下的半离散运动方程形式如下：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{f}(t),\n$$\n其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{C}$ 是阻尼矩阵，$\\mathbf{K}$ 是刚度矩阵，$\\mathbf{u}(t)$ 是位移向量。在此模型中，阻尼矩阵由质量矩阵和刚度矩阵的瑞利型线性组合构成，其标量系数为 $\\alpha$ 和 $\\beta$。给定组装矩阵的标准国际单位制（SI）单位：$[\\mathbf{M}]=\\mathrm{kg}$，$[\\mathbf{K}]=\\mathrm{N/m}$，$[\\mathbf{C}]=\\mathrm{N\\,s/m}$。\n\n(a) 根据这些SI单位以及运动方程中每一项都具有一致物理量纲的要求，确定瑞利系数在基本时间量纲符号 $T$ 中的时间幂次，即求出 $p_{\\alpha}$ 和 $p_{\\beta}$ 使得 $[\\alpha]=T^{p_{\\alpha}}$ 和 $[\\beta]=T^{p_{\\beta}}$。\n\n(b) 考虑一个原型和缩尺模型之间的相似性研究，其中所有几何和材料相似性条件都得到满足，从而使得无量纲运动方程保持不变。假设模型时间 $t_{\\mathrm{m}}$ 通过一个给定的时间比例因子 $\\lambda_{t}=t_{\\mathrm{m}}/t_{\\mathrm{p}}$ 与原型时间 $t_{\\mathrm{p}}$ 相关联。仅使用量纲一致性和无量纲控制方程的不变性，将比率 $\\alpha_{\\mathrm{m}}/\\alpha_{\\mathrm{p}}$ 和 $\\beta_{\\mathrm{m}}/\\beta_{\\mathrm{p}}$ 表示为 $\\lambda_{t}$ 的函数。\n\n你的最终答案必须是一个单行矩阵，按顺序包含四个条目 $\\left(p_{\\alpha},\\,p_{\\beta},\\,\\alpha_{\\mathrm{m}}/\\alpha_{\\mathrm{p}},\\,\\beta_{\\mathrm{m}}/\\beta_{\\mathrm{p}}\\right)$。不需要进行数值取整，最终答案中也不要包含单位。", "solution": "这个问题包含两个部分。第一部分要求对瑞利阻尼系数 $\\alpha$ 和 $\\beta$ 进行量纲分析。第二部分要求在相似性研究中确定这些系数的比例关系。\n\n(a) 部分：确定 $\\alpha$ 和 $\\beta$ 的时间幂次。\n\n分析始于线性弹性动力学系统的半离散运动方程：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{f}(t)\n$$\n为使此方程在物理上保持一致，每一项都必须具有相同的物理量纲，即力的量纲。让我们用 $M$、$L$ 和 $T$ 分别表示质量、长度和时间的基本量纲。力的量纲是 $[F] = M L T^{-2}$。\n\n运动学量的量纲如下：\n- 位移 $[\\mathbf{u}] = L$\n- 速度 $[\\dot{\\mathbf{u}}] = \\frac{d}{dt}[\\mathbf{u}] = L T^{-1}$\n- 加速度 $[\\ddot{\\mathbf{u}}] = \\frac{d^2}{dt^2}[\\mathbf{u}] = L T^{-2}$\n\n根据题目陈述，我们已知组装矩阵的国际单位制（SI）单位。我们可以将这些单位转换为基本量纲：\n- 质量矩阵 $[\\mathbf{M}] = \\mathrm{kg}$，对应于质量的量纲，因此 $[\\mathbf{M}] = M$。\n- 刚度矩阵 $[\\mathbf{K}] = \\mathrm{N/m}$。牛顿（$N$）是力的单位，其量纲为 $M L T^{-2}$。米（$m$）是长度的单位，量纲为 $L$。因此，$[\\mathbf{K}] = \\frac{M L T^{-2}}{L} = M T^{-2}$。\n- 阻尼矩阵 $[\\mathbf{C}] = \\mathrm{N\\,s/m}$。秒（$s$）是时间的单位，量纲为 $T$。因此，$[\\mathbf{C}] = \\frac{(M L T^{-2}) T}{L} = M T^{-1}$。\n\n我们可以验证运动方程中的每一项都具有力的量纲：\n- $[\\mathbf{M}\\,\\ddot{\\mathbf{u}}] = [\\mathbf{M}][\\ddot{\\mathbf{u}}] = M \\cdot (L T^{-2}) = M L T^{-2}$。\n- $[\\mathbf{C}\\,\\dot{\\mathbf{u}}] = [\\mathbf{C}][\\dot{\\mathbf{u}}] = (M T^{-1}) \\cdot (L T^{-1}) = M L T^{-2}$。\n- $[\\mathbf{K}\\,\\mathbf{u}}] = [\\mathbf{K}][\\mathbf{u}] = (M T^{-2}) \\cdot L = M L T^{-2}$。\n正如预期的那样，所有项在量纲上都与力一致。\n\n阻尼矩阵 $\\mathbf{C}$ 由瑞利阻尼模型定义：\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}\n$$\n根据量纲齐次性原理，一个和式中的所有项必须具有相同的量纲。因此，$\\mathbf{C}$ 的量纲必须等于 $\\alpha\\mathbf{M}$ 的量纲，也必须等于 $\\beta\\mathbf{K}$ 的量纲。\n$$\n[\\mathbf{C}] = [\\alpha \\mathbf{M}] = [\\alpha][\\mathbf{M}]\n$$\n$$\n[\\mathbf{C}] = [\\beta \\mathbf{K}] = [\\beta][\\mathbf{K}]\n$$\n我们可以求解 $\\alpha$ 和 $\\beta$ 的量纲：\n对于 $\\alpha$：\n$$\n[\\alpha] = \\frac{[\\mathbf{C}]}{[\\mathbf{M}]} = \\frac{M T^{-1}}{M} = T^{-1}\n$$\n题目定义了 $[\\alpha] = T^{p_{\\alpha}}$。通过比较，我们得到 $p_{\\alpha} = -1$。\n\n对于 $\\beta$：\n$$\n[\\beta] = \\frac{[\\mathbf{C}]}{[\\mathbf{K}]} = \\frac{M T^{-1}}{M T^{-2}} = T^{1} = T\n$$\n题目定义了 $[\\beta] = T^{p_{\\beta}}$。通过比较，我们得到 $p_{\\beta} = 1$。\n\n(b) 部分：确定 $\\alpha$ 和 $\\beta$ 的比例关系。\n\n这部分涉及比较原型（下标 $p$）和缩尺模型（下标 $m$）的相似性研究。关键原理是无量纲控制方程的不变性。我们已知时间比例因子 $\\lambda_t = t_m / t_p$。\n\n让我们对运动方程进行关于时间的无量纲化。我们可以通过将方程两边同时除以质量矩阵 $\\mathbf{M}$ 来重写方程：\n$$\n\\ddot{\\mathbf{u}} + \\mathbf{M}^{-1}(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\dot{\\mathbf{u}} + \\mathbf{M}^{-1}\\mathbf{K}\\mathbf{u} = \\mathbf{M}^{-1}\\mathbf{f}\n$$\n$$\n\\ddot{\\mathbf{u}} + (\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K})\\dot{\\mathbf{u}} + (\\mathbf{M}^{-1}\\mathbf{K})\\mathbf{u} = \\mathbf{M}^{-1}\\mathbf{f}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。设 $T_{char}$ 是一个特征时间。我们定义一个无量纲时间变量 $t^* = t/T_{char}$。时间导数变换如下：\n$$\n\\dot{\\mathbf{u}} = \\frac{d\\mathbf{u}}{dt} = \\frac{d\\mathbf{u}}{dt^*} \\frac{dt^*}{dt} = \\frac{1}{T_{char}} \\frac{d\\mathbf{u}}{dt^*}\n$$\n$$\n\\ddot{\\mathbf{u}} = \\frac{d^2\\mathbf{u}}{dt^2} = \\frac{1}{T_{char}^2} \\frac{d^2\\mathbf{u}}{dt^{*2}}\n$$\n将这些代入方程并乘以 $T_{char}^2$ 得到：\n$$\n\\frac{d^2\\mathbf{u}}{dt^{*2}} + T_{char}(\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K})\\frac{d\\mathbf{u}}{dt^*} + T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})\\mathbf{u} = T_{char}^2\\mathbf{M}^{-1}\\mathbf{f}\n$$\n无量纲群是导数项的系数。让我们检查阻尼项的系数矩阵：\n$$\n\\mathbf{D}^* = T_{char}(\\alpha\\mathbf{I} + \\beta\\mathbf{M}^{-1}\\mathbf{K}) = (\\alpha T_{char})\\mathbf{I} + (\\beta/T_{char})(T_{char}^2\\mathbf{M}^{-1}\\mathbf{K})\n$$\n项 $\\Pi_{\\alpha} = \\alpha T_{char}$ 是一个无量纲数，因为 $[\\alpha T_{char}] = T^{-1} \\cdot T = T^0$。\n项 $\\Pi_{\\beta} = \\beta / T_{char}$ 也是一个无量纲数，因为 $[\\beta / T_{char}] = T \\cdot T^{-1} = T^0$。\n矩阵 $T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})$ 也是无量纲的，因为 $[T_{char}^2(\\mathbf{M}^{-1}\\mathbf{K})] = T^2 \\cdot (M^{-1} \\cdot MT^{-2}) = T^2 \\cdot T^{-2} = T^0$。\n\n为了使无量纲运动方程保持不变，这些无量纲数 ($\\Pi$) 对于原型和模型必须是相同的。\n$$\n\\Pi_{\\alpha, m} = \\Pi_{\\alpha, p} \\implies \\alpha_m T_{char, m} = \\alpha_p T_{char, p}\n$$\n$$\n\\Pi_{\\beta, m} = \\Pi_{\\beta, p} \\implies \\frac{\\beta_m}{T_{char, m}} = \\frac{\\beta_p}{T_{char, p}}\n$$\n特征时间必须与时间变量成比例，所以 $\\frac{T_{char, m}}{T_{char, p}} = \\lambda_t$。\n\n根据 $\\alpha$ 的第一个不变性条件：\n$$\n\\frac{\\alpha_m}{\\alpha_p} = \\frac{T_{char, p}}{T_{char, m}} = \\left(\\frac{T_{char, m}}{T_{char, p}}\\right)^{-1} = \\lambda_t^{-1}\n$$\n\n根据 $\\beta$ 的第二个不变性条件：\n$$\n\\frac{\\beta_m}{\\beta_p} = \\frac{T_{char, m}}{T_{char, p}} = \\lambda_t\n$$\n\n所需的四个量是 $p_{\\alpha}$、$p_{\\beta}$、$\\alpha_m/\\alpha_p$ 和 $\\beta_m/\\beta_p$。\n综合我们的结果：\n- $p_{\\alpha} = -1$\n- $p_{\\beta} = 1$\n- $\\alpha_m/\\alpha_p = \\lambda_t^{-1}$\n- $\\beta_m/\\beta_p = \\lambda_t$\n\n最终答案以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} -1  1  \\lambda_t^{-1}  \\lambda_t \\end{pmatrix}}\n$$", "id": "3515220"}, {"introduction": "在理解了参数的物理基础后，下一步便是确定它们的取值以反映真实的材料行为，这是应用瑞利阻尼的核心任务。本练习 [@problem_id:3515209] 将引导您实践最经典的“双频点拟合”方法：通过精确匹配两个特定模态频率下的目标阻尼比 $\\xi$ 来求解系数 $\\alpha$ 和 $\\beta$。这个过程不仅能让您掌握基本的校准技术，还能揭示瑞利阻尼模型固有的频率依赖性及其局限。", "problem": "一个垂直传播剪切波的土柱在时域内使用线性弹性动力学运动方程进行建模，其比例阻尼构建为质量矩阵和刚度矩阵的线性组合。考虑一个具有位移向量 $u(t)$、质量矩阵 $M$、刚度矩阵 $K$ 和阻尼矩阵 $C$ 的有限元半离散系统，并假设采用瑞利（Rayleigh）模型形式的经典比例阻尼。振型阻尼比 $\\xi$ 是通过在振型坐标下将运动方程简化为单自由度系统来为每个振型定义的。该土柱被调整，使得在瑞利阻尼假设下，前两个自振振型（频率分别为 $f_{1}=3\\,\\mathrm{Hz}$ 和 $f_{2}=9\\,\\mathrm{Hz}$）的振型阻尼比均为 $\\xi=0.05$。使用角频率定义 $\\omega=2\\pi f$，确定实现此调谐的两个瑞利系数 $\\alpha$ 和 $\\beta$。然后，计算由这些系数决定的在频率 $f=0.5\\,\\mathrm{Hz}$ 和 $f=30\\,\\mathrm{Hz}$ 处的阻尼比。\n\n请以精确解析表达式的形式给出所有四个结果，不要四舍五入。将 $\\alpha$ 的单位表示为 $\\mathrm{s}^{-1}$，$\\beta$ 的单位表示为 $\\mathrm{s}$，阻尼比 $\\xi$ 表示为无量纲的小数或分数。在你最终的方框答案中，按照 $\\alpha$、$\\beta$、$\\xi(f=0.5\\,\\mathrm{Hz})$、$\\xi(f=30\\,\\mathrm{Hz})$ 的顺序列出这四个量。", "solution": "对于具有瑞利阻尼的系统，振型阻尼比 $\\xi_n$ 和振型角频率 $\\omega_n$ 之间的关系由下式给出：\n$$ \\xi_n = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega_n} + \\beta\\omega_n \\right) $$\n其中 $\\alpha$ 和 $\\beta$ 是瑞利阻尼系数。\n\n首先，我们使用公式 $\\omega = 2\\pi f$ 将给定的频率 $f_1$ 和 $f_2$ 转换为角频率 $\\omega_1$ 和 $\\omega_2$：\n$$ \\omega_1 = 2\\pi f_1 = 2\\pi (3\\,\\mathrm{Hz}) = 6\\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_2 = 2\\pi f_2 = 2\\pi (9\\,\\mathrm{Hz}) = 18\\pi\\,\\mathrm{rad/s} $$\n\n已知这两个振型的阻尼比均为 $\\xi = 0.05$。这为我们提供了求解两个未知数 $\\alpha$ 和 $\\beta$ 的两个线性方程组：\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{6\\pi} + \\beta(6\\pi) \\right) \\quad \\text{(1)} $$\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{18\\pi} + \\beta(18\\pi) \\right) \\quad \\text{(2)} $$\n\n将两个方程都乘以 $2$ 得：\n$$ 0.10 = \\frac{\\alpha}{6\\pi} + 6\\pi\\beta $$\n$$ 0.10 = \\frac{\\alpha}{18\\pi} + 18\\pi\\beta $$\n\n这是一个关于 $\\alpha$ 和 $\\beta$ 的线性方程组。对于具有相同阻尼比 $\\xi$ 的两个频率 $\\omega_i$ 和 $\\omega_j$，求解该方程组可得到 $\\alpha$ 和 $\\beta$ 的通用公式：\n$$ \\alpha = \\frac{2\\xi \\omega_i \\omega_j}{\\omega_i + \\omega_j} $$\n$$ \\beta = \\frac{2\\xi}{\\omega_i + \\omega_j} $$\n\n现在，我们将 $\\xi=0.05$、$\\omega_1=6\\pi$ 和 $\\omega_2=18\\pi$ 代入这些公式。对于 $\\beta$：\n$$ \\beta = \\frac{2(0.05)}{6\\pi + 18\\pi} = \\frac{0.1}{24\\pi} = \\frac{1}{240\\pi}\\,\\mathrm{s} $$\n对于 $\\alpha$：\n$$ \\alpha = \\frac{2(0.05)(6\\pi)(18\\pi)}{6\\pi + 18\\pi} = \\frac{0.1 \\cdot 108\\pi^2}{24\\pi} = \\frac{10.8\\pi}{24} $$\n为了将其表示为精确分数，我们将 $10.8$ 写为 $\\frac{108}{10}$：\n$$ \\alpha = \\frac{108\\pi}{10 \\cdot 24} = \\frac{108\\pi}{240} $$\n将分子和分母同时除以它们的最大公约数12：\n$$ \\alpha = \\frac{108 \\div 12}{240 \\div 12}\\pi = \\frac{9\\pi}{20}\\,\\mathrm{s}^{-1} $$\n因此，瑞利系数为 $\\alpha = \\frac{9\\pi}{20}$ 和 $\\beta = \\frac{1}{240\\pi}$。\n\n接下来，我们计算在 $f_3 = 0.5\\,\\mathrm{Hz}$ 和 $f_4 = 30\\,\\mathrm{Hz}$ 处的阻尼比。\n首先，我们求出相应的角频率：\n$$ \\omega_3 = 2\\pi f_3 = 2\\pi (0.5) = \\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_4 = 2\\pi f_4 = 2\\pi (30) = 60\\pi\\,\\mathrm{rad/s} $$\n\n现在，我们使用阻尼比公式 $\\xi(\\omega) = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega} + \\beta\\omega \\right)$以及我们计算出的 $\\alpha$ 和 $\\beta$ 值。\n\n对于 $f_3 = 0.5\\,\\mathrm{Hz}$ ($\\omega_3 = \\pi$)：\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{\\pi} + \\frac{1}{240\\pi} \\cdot \\pi \\right) $$\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{20} + \\frac{1}{240} \\right) $$\n为了将分数相加，我们找到一个公分母，即 $240$。\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9 \\cdot 12}{20 \\cdot 12} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{108}{240} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{109}{240} \\right) = \\frac{109}{480} $$\n\n对于 $f_4 = 30\\,\\mathrm{Hz}$ ($\\omega_4 = 60\\pi$)：\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{60\\pi} + \\frac{1}{240\\pi} \\cdot 60\\pi \\right) $$\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{20 \\cdot 60} + \\frac{60}{240} \\right) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{1}{4} \\right) $$\n为了将分数相加，我们找到一个公分母，即 $1200$。\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{300}{1200} \\right) = \\frac{1}{2} \\left( \\frac{309}{1200} \\right) = \\frac{309}{2400} $$\n这个分数可以通过将分子和分母同时除以它们的最大公约数 3 来进行简化。\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{309 \\div 3}{2400 \\div 3} = \\frac{103}{800} $$\n\n所要求的四个量是：\n1.  $\\alpha = \\frac{9\\pi}{20}$\n2.  $\\beta = \\frac{1}{240\\pi}$\n3.  $\\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{109}{480}$\n4.  $\\xi(f=30\\,\\mathrm{Hz}) = \\frac{103}{800}$", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{9\\pi}{20}  \\frac{1}{240\\pi}  \\frac{109}{480}  \\frac{103}{800} \\end{pmatrix}} $$", "id": "3515209"}, {"introduction": "正如上一个练习所揭示的，仅在两个频点上精确匹配阻尼比，可能导致在其他频率上出现显著的模拟误差。为了在更宽的频率范围内获得更可靠的模拟结果，我们需要更先进的校准方法。本项计算实践 [@problem_id:3515294] 引入了一种更为稳健的最小二乘优化技术。您将通过编程实现一个优化过程，寻找最优的 $\\alpha$ 和 $\\beta$ 值，使得瑞利阻尼曲线在整个目标频带上与实验数据达到最佳拟合，这是建立高保真度数值模型的关键一步。", "problem": "一个连续介质土样被离散化为一个二阶线性动力系统，其运动方程为 $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$，其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$C$ 是阻尼矩阵，$u$ 是位移向量，$f_{\\text{ext}}$ 是外力向量。假设采用经典瑞利阻尼模型，即 $C = a_0 M + a_1 K$，其中 $a_0$ 和 $a_1$ 是待确定的实标量。考虑计算岩土力学中标准的线性自由振动和模态分析假设。\n\n将目标土体阻尼比曲线 $\\zeta_{\\text{target}}(\\omega)$ 定义为圆频率 $\\omega$ (单位为 $\\mathrm{rad/s}$) 的标量函数，代表土体的小应变循环试验观测结果。在频带 $[\\omega_L,\\omega_H]$ 上，确定瑞利阻尼参数 $(a_0,a_1)$ ($a_0$ 的单位为 $\\mathrm{s^{-1}}$，$a_1$ 的单位为 $\\mathrm{s}$)，以最小化平方误差泛函\n$$\nJ(a_0,a_1) = \\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega,\n$$\n其中 $\\zeta_{\\text{Rayleigh}}(\\omega)$ 是在标准模态缩减下，由瑞利阻尼模型所隐含的模态阻尼比。你必须从运动方程、瑞利阻尼的定义以及圆频率为 $\\omega$ 的无阻尼模态的等效模态质量和刚度之间的模态关系出发，推导出 $\\zeta_{\\text{Rayleigh}}(\\omega)$。\n\n对于最优的 $(a_0,a_1)$，还需计算等贡献频率\n$$\n\\omega_{\\mathrm{eq}} = \\sqrt{\\frac{a_0}{a_1}},\n$$\n单位为 $\\mathrm{rad/s}$，定义为质量比例项和刚度比例项对瑞利模态阻尼比贡献相等的频率。如果 $a_0 \\le 0$ 或 $a_1 \\le 0$，则将 $\\omega_{\\mathrm{eq}}$ 设置为非数值。\n\n另外，通过计算以下指标来量化拟合优度：\n- 频带上的均方根误差，\n$$\ne_{\\mathrm{rms}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega},\n$$\n无量纲。\n- 频带上的最大绝对误差，定义为 $\\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|$ 在 $\\omega \\in [\\omega_L,\\omega_H]$ 上的上确界，在足够精细的网格上进行数值近似，无量纲。\n\n你的程序必须通过求解正规方程来解析地实现最小化，该正规方程源于将 $\\zeta_{\\text{target}}(\\omega)$ 最小二乘投影到由推导得出的频率相关瑞利基函数所张成的空间上，并且必须以足够的精度对必要的积分进行数值计算。\n\n使用以下测试套件。对于每种情况，都指定了目标阻尼曲线和频带。所有阻尼比均为无量纲；所有频率单位均为 $\\mathrm{rad/s}$。\n\n- 情况 1 (基准常数目标，宽频带):\n  - $\\zeta_{\\text{target}}(\\omega) = 0.05$,\n  - $\\omega_L = 1$, $\\omega_H = 100$.\n- 情况 2 (单调递增饱和目标，中等频带):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + (\\zeta_\\infty - \\zeta_0)\\frac{\\omega}{\\omega + \\omega_c}$，其中 $\\zeta_0 = 0.02$，$\\zeta_\\infty = 0.08$，$\\omega_c = 30$，\n  - $\\omega_L = 5$, $\\omega_H = 100$.\n- 情况 3 (峰值目标，宽低频带):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_{\\text{base}} + \\zeta_{\\text{amp}}\\frac{\\omega}{\\omega_p}\\exp\\!\\left(1 - \\frac{\\omega}{\\omega_p}\\right)$，其中 $\\zeta_{\\text{base}} = 0.02$，$\\zeta_{\\text{amp}} = 0.06$，$\\omega_p = 20$，\n  - $\\omega_L = 1$, $\\omega_H = 50$.\n- 情况 4 (窄频带，轻微变化目标):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + \\frac{\\beta}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^2}$，其中 $\\zeta_0 = 0.03$，$\\beta = 0.04$，$\\omega_c = 21$，\n  - $\\omega_L = 20$, $\\omega_H = 22$.\n\n对于每个测试用例，你的程序必须：\n- 基于基本关系推导并使用 $\\zeta_{\\text{Rayleigh}}(\\omega)$，\n- 计算最优的 $(a_0,a_1)$，单位分别为 $\\mathrm{s^{-1}}$ 和 $\\mathrm{s}$，\n- 计算 $\\omega_{\\mathrm{eq}}$，单位为 $\\mathrm{rad/s}$ (如果 $a_0 \\le 0$ 或 $a_1 \\le 0$，则设置为非数值)，\n- 计算 $e_{\\mathrm{rms}}$ (无量纲)，\n- 计算在 $[\\omega_L,\\omega_H]$ 上的最大绝对误差 (无量纲)。\n\n你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按以下顺序连接每个案例的五个值：\n$$\n[a_0^{(1)}, a_1^{(1)}, \\omega_{\\mathrm{eq}}^{(1)}, e_{\\mathrm{rms}}^{(1)}, e_{\\max}^{(1)}, a_0^{(2)}, a_1^{(2)}, \\omega_{\\mathrm{eq}}^{(2)}, e_{\\mathrm{rms}}^{(2)}, e_{\\max}^{(2)}, a_0^{(3)}, a_1^{(3)}, \\omega_{\\mathrm{eq}}^{(3)}, e_{\\mathrm{rms}}^{(3)}, e_{\\max}^{(3)}, a_0^{(4)}, a_1^{(4)}, \\omega_{\\mathrm{eq}}^{(4)}, e_{\\mathrm{rms}}^{(4)}, e_{\\max}^{(4)}],\n$$\n其中上标表示案例编号。所有 $a_0$ 条目的单位必须是 $\\mathrm{s^{-1}}$，所有 $a_1$ 条目的单位是 $\\mathrm{s}$，所有 $\\omega_{\\mathrm{eq}}$ 条目的单位是 $\\mathrm{rad/s}$，所有误差必须是无量纲的。角度(频率)单位为弧度/秒。最终的数值输出必须是浮点数。如果某个案例得出 $a_0 \\le 0$ 或 $a_1 \\le 0$，则该案例的 $\\omega_{\\mathrm{eq}}$ 应打印为 $\\mathrm{NaN}$。", "solution": "该问题要求通过在指定的频带 $[\\omega_L, \\omega_H]$ 上最小化目标阻尼比曲线 $\\zeta_{\\text{target}}(\\omega)$ 与瑞利阻尼曲线 $\\zeta_{\\text{Rayleigh}}(\\omega)$ 之间的积分平方误差，来确定最优的瑞利阻尼参数 $(a_0, a_1)$。这是结构动力学领域一个经典的最小二乘问题。\n\n首先，我们必须推导瑞利模态阻尼比 $\\zeta_{\\text{Rayleigh}}(\\omega)$ 的表达式。一个线性多自由度系统的运动方程为 $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$。在线性自由振动和模态分析的假设下，我们考虑无阻尼特征值问题 $K\\phi_i = \\omega_i^2 M\\phi_i$，其中 $\\omega_i$ 是第 $i$ 阶自振圆频率，$\\phi_i$ 是对应的振型。\n\n通过应用模态变换 $u(t) = \\sum_i \\phi_i q_i(t)$，并利用振型对于质量矩阵和刚度矩阵的正交性，耦合的方程组解耦为一组独立的单自由度 (SDOF) 方程，每个模态 $i$ 对应一个：\n$$\nM_i \\ddot{q}_i(t) + C_i \\dot{q}_i(t) + K_i q_i(t) = F_i(t)\n$$\n其中 $M_i = \\phi_i^T M \\phi_i$ 是模态质量，$K_i = \\phi_i^T K \\phi_i$ 是模态刚度，$C_i = \\phi_i^T C \\phi_i$ 是模态阻尼。模态刚度和模态质量通过 $K_i = \\omega_i^2 M_i$ 相关联。\n\n单自由度方程的标准形式是 $\\ddot{q}_i + 2\\zeta_i\\omega_i \\dot{q}_i + \\omega_i^2 q_i = F_i/M_i$。通过比较系数，模态阻尼比 $\\zeta_i$ 定义为：\n$$\n\\zeta_i = \\frac{C_i}{2\\omega_i M_i}\n$$\n问题指定了瑞利阻尼矩阵 $C = a_0 M + a_1 K$。将此代入模态阻尼系数 $C_i$ 的表达式中：\n$$\nC_i = \\phi_i^T (a_0 M + a_1 K) \\phi_i = a_0 (\\phi_i^T M \\phi_i) + a_1 (\\phi_i^T K \\phi_i) = a_0 M_i + a_1 K_i\n$$\n代入 $K_i = \\omega_i^2 M_i$，我们得到 $C_i = a_0 M_i + a_1 (\\omega_i^2 M_i) = (a_0 + a_1 \\omega_i^2) M_i$。\n现在，我们将这个 $C_i$ 的表达式代回模态阻尼比 $\\zeta_i$ 的公式中：\n$$\n\\zeta_i = \\frac{(a_0 + a_1 \\omega_i^2) M_i}{2\\omega_i M_i} = \\frac{a_0 + a_1 \\omega_i^2}{2\\omega_i} = \\frac{a_0}{2\\omega_i} + \\frac{a_1 \\omega_i}{2}\n$$\n问题将阻尼比视为频率 $\\omega$ 的连续函数，而不局限于离散的模态频率。因此，我们将模态阻尼比推广为 $\\omega$ 的函数：\n$$\n\\zeta_{\\text{Rayleigh}}(\\omega) = \\frac{a_0}{2\\omega} + \\frac{a_1 \\omega}{2}\n$$\n\n接下来，我们求解最小化问题。我们需要找到标量 $a_0$ 和 $a_1$ 来最小化泛函 $J(a_0, a_1)$：\n$$\nJ(a_0, a_1) = \\int_{\\omega_L}^{\\omega_H} \\left( \\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega = \\int_{\\omega_L}^{\\omega_H} \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega\n$$\n为了找到最小值，我们将 $J$ 对 $a_0$ 和 $a_1$ 的偏导数设为零，这就得出了最小二乘问题的正规方程。\n$$\n\\frac{\\partial J}{\\partial a_0} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{1}{2\\omega} \\right) \\mathrm{d}\\omega = 0\n$$\n$$\n\\frac{\\partial J}{\\partial a_1} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{\\omega}{2} \\right) \\mathrm{d}\\omega = 0\n$$\n简化并重排这两个方程，得到一个关于 $(a_0, a_1)$ 的线性系统：\n$$\na_0 \\left( \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega \\right) + a_1 \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega\n$$\n$$\na_0 \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) + a_1 \\left( \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n$$\n该系统可以写成矩阵形式 $A \\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = [a_0, a_1]^T$：\n$$\n\\begin{bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega  \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega  \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega\n\\end{bmatrix}\n\\begin{Bmatrix} a_0 \\\\ a_1 \\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n\\end{Bmatrix}\n$$\n构成系数矩阵 $A$ 的积分可以解析地计算：\n$A_{11} = \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega = \\left[-\\frac{1}{\\omega}\\right]_{\\omega_L}^{\\omega_H} = \\frac{1}{\\omega_L} - \\frac{1}{\\omega_H}$\n$A_{12} = A_{21} = \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega = [\\omega]_{\\omega_L}^{\\omega_H} = \\omega_H - \\omega_L$\n$A_{22} = \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega = \\left[\\frac{\\omega^3}{3}\\right]_{\\omega_L}^{\\omega_H} = \\frac{\\omega_H^3 - \\omega_L^3}{3}$\n\n右侧向量 $\\mathbf{b}$ 中的积分涉及目标函数 $\\zeta_{\\text{target}}(\\omega)$，由于它们通常没有简单的解析解，因此使用求积法进行数值计算。\n$b_1 = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega$\n$b_2 = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega$\n\n求解系统 $A \\mathbf{x} = \\mathbf{b}$ 以获得最优参数 $\\mathbf{x} = [a_0, a_1]^T$。一旦找到 $(a_0, a_1)$，就可以计算所需的指标：\n\n1.  等贡献频率 $\\omega_{\\mathrm{eq}}$ 是质量比例项 $\\frac{a_0}{2\\omega}$ 和刚度比例项 $\\frac{a_1\\omega}{2}$ 相等的频率。\n    $$\n    \\frac{a_0}{2\\omega_{\\mathrm{eq}}} = \\frac{a_1\\omega_{\\mathrm{eq}}}{2} \\implies \\omega_{\\mathrm{eq}}^2 = \\frac{a_0}{a_1} \\implies \\omega_{\\mathrm{eq}} = \\sqrt{\\frac{a_0}{a_1}}\n    $$\n    这仅在 $a_0 > 0$ 和 $a_1 > 0$ 时有定义。如果任一参数为非正数，则将 $\\omega_{\\mathrm{eq}}$ 设置为非数值 (NaN)。\n\n2.  均方根误差 $e_{\\mathrm{rms}}$ 由下式给出：\n    $$\n    e_{\\mathrm{rms}} = \\sqrt{\\frac{J(a_0, a_1)}{\\omega_H - \\omega_L}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega}\n    $$\n    该积分使用已确定的最优 $a_0$ 和 $a_1$ 进行数值计算。\n\n3.  最大绝对误差 $e_{\\max}$ 为：\n    $$\n    e_{\\max} = \\sup_{\\omega \\in [\\omega_L, \\omega_H]} \\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|\n    $$\n    通过在区间 $[\\omega_L, \\omega_H]$ 上一个精细的均匀频率网格上计算绝对误差，并找到其最大值来近似得到该值。\n\n实现将遵循这些步骤，使用数值求积法计算积分，并使用线性代数求解器求解正规方程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes optimal Rayleigh damping parameters and error metrics for a suite of test cases.\n    \"\"\"\n\n    def solve_case(zeta_target_func, omega_L, omega_H):\n        \"\"\"\n        Solves for a single test case.\n\n        Args:\n            zeta_target_func (callable): The target damping ratio function zeta_target(omega).\n            omega_L (float): The lower bound of the frequency band [rad/s].\n            omega_H (float): The upper bound of the frequency band [rad/s].\n\n        Returns:\n            tuple: A 5-tuple containing (a0, a1, omega_eq, e_rms, e_max).\n        \"\"\"\n        # 1. Analytically compute the coefficient matrix A for the normal equations.\n        # A_11 = integral(1/w^2) dw\n        A11 = 1.0 / omega_L - 1.0 / omega_H\n        # A_12 = A_21 = integral(1) dw\n        A12 = omega_H - omega_L\n        A21 = A12\n        # A_22 = integral(w^2) dw\n        A22 = (omega_H**3 - omega_L**3) / 3.0\n        \n        A = np.array([[A11, A12], [A21, A22]])\n\n        # 2. Numerically compute the right-hand side vector b.\n        # Integrands for b1 and b2\n        integrand_b1 = lambda w: 2.0 * zeta_target_func(w) / w\n        integrand_b2 = lambda w: 2.0 * w * zeta_target_func(w)\n\n        b1, _ = quad(integrand_b1, omega_L, omega_H, limit=200)\n        b2, _ = quad(integrand_b2, omega_L, omega_H, limit=200)\n        \n        b = np.array([b1, b2])\n\n        # 3. Solve the linear system A * x = b for x = [a0, a1].\n        try:\n            a0, a1 = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            # This should not happen for valid physical bands [omega_L, omega_H]\n            return (np.nan, np.nan, np.nan, np.nan, np.nan)\n\n        # 4. Calculate the equal-contribution frequency, omega_eq.\n        if a0  0 and a1  0:\n            omega_eq = np.sqrt(a0 / a1)\n        else:\n            omega_eq = np.nan\n\n        # 5. Define the resulting Rayleigh damping function.\n        zeta_rayleigh_func = lambda w: a0 / (2.0 * w) + a1 * w / 2.0\n\n        # 6. Calculate the root-mean-square error, e_rms.\n        squared_error_integrand = lambda w: (zeta_rayleigh_func(w) - zeta_target_func(w))**2\n        J, _ = quad(squared_error_integrand, omega_L, omega_H, limit=200)\n        e_rms = np.sqrt(J / (omega_H - omega_L))\n        \n        # 7. Calculate the maximum absolute error, e_max, on a fine grid.\n        # Use a sufficiently fine grid for numerical approximation of supremum.\n        num_points = 100001 \n        omega_grid = np.linspace(omega_L, omega_H, num_points)\n        error_values = np.abs(zeta_rayleigh_func(omega_grid) - zeta_target_func(omega_grid))\n        e_max = np.max(error_values)\n\n        return (a0, a1, omega_eq, e_rms, e_max)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"zeta_target\": lambda w: 0.05,\n            \"omega_L\": 1.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.02, zi=0.08, wc=30.0: z0 + (zi - z0) * w / (w + wc),\n            \"omega_L\": 5.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, zb=0.02, za=0.06, wp=20.0: zb + za * (w / wp) * np.exp(1.0 - w / wp),\n            \"omega_L\": 1.0,\n            \"omega_H\": 50.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.03, beta=0.04, wc=21.0: z0 + beta / (1.0 + (w / wc)**2),\n            \"omega_L\": 20.0,\n            \"omega_H\": 22.0,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = solve_case(case[\"zeta_target\"], case[\"omega_L\"], case[\"omega_H\"])\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3515294"}]}