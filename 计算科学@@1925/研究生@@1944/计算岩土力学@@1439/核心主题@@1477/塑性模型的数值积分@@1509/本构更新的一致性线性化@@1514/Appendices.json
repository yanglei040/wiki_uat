{"hands_on_practices": [{"introduction": "Drucker-Prager 模型是计算岩土力学中的基石。本练习将指导您完成一个核心的计算塑性流程：最近点投影返回映射算法。通过这个练习，您将从第一性原理出发，为关联流动的 Drucker-Prager 模型推导应力更新规则和至关重要的一致算法切线张量 $\\mathbb{C}^{\\text{alg}}$，这是实现隐式有限元方法的关键一步。[@problem_id:3508082]", "problem": "考虑一个用于岩土材料的小应变、率无关、各向同性弹塑性模型，该模型由 Drucker–Prager (DP) 屈服条件和关联流动法则控制。其弹性响应是线性和各向同性的，体积模量为 $K$，剪切模量为 $G$，并满足应变加法分解 $ \\epsilon = \\epsilon^{e} + \\epsilon^{p} $。令 Cauchy 应力表示为 $ \\sigma $，静水压力为 $ p = \\tfrac{1}{3} \\operatorname{tr}(\\sigma) $，偏应力为 $ s = \\sigma - p I $，其中 $I$ 是二阶单位张量。偏应力的第二不变量表示为 $ q = \\sqrt{\\tfrac{3}{2} s : s} $。Drucker–Prager 屈服函数为\n$$\nf(\\sigma) = q + \\alpha p - k,\n$$\n其中 $\\alpha > 0$ 和 $k > 0$ 是常数材料参数，关联塑性流动定义为 $ \\dot{\\epsilon}^{p} = \\dot{\\lambda}\\, \\partial f / \\partial \\sigma $，塑性乘子 $\\dot{\\lambda} \\ge 0$。假设为理想塑性（无硬化）。\n\n你需要在应力空间中进行全部计算，并使用最近点投影（在由弹性柔度张量诱导的度量下）在发生塑性加载时将弹性试探应力返回到屈服面上。从上述基本定义和线性弹性理论出发。不要假设任何不能从这些基础推导出的公式。\n\n本题数据：\n- 弹性模量：$K = 100$ MPa, $G = 40$ MPa。\n- Drucker–Prager 参数：$\\alpha = 0.2$, $k = 2$ MPa。\n- 一个荷载增量结束时的弹性试探应力：\n$$\n\\sigma^{\\mathrm{tr}} = \\begin{pmatrix} 10  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\text{ MPa}.\n$$\n\n任务：\n1. 将该模型的最近点投影问题在应力空间中表述为一个约束最小化问题，并推导定义返回映射的一阶最优性条件。利用这些条件，用 $ \\sigma^{\\mathrm{tr}} $ 和塑性乘子增量 $ \\Delta \\lambda $ 表示更新后的应力 $ \\sigma_{n+1} $，并通过施加一致性条件 $ f(\\sigma_{n+1}) = 0 $ 来获得关于 $ \\Delta \\lambda $ 的标量非线性方程。\n2. 求解一致性方程，得到关于不变量 $ p^{\\mathrm{tr}} $ 和 $ q^{\\mathrm{tr}} $ 的 $ \\Delta \\lambda $ 的闭式表达式，然后根据给定数据显式计算更新后的不变量 $ p_{n+1} $ 和 $ q_{n+1} $。\n3. 计算返回映射的线性化（一致算法切线），以获得更新后状态下的四阶算法模量张量 $ \\mathbb{C}^{\\mathrm{alg}} $。从你推导的最优性系统的线性化出发，用弹性张量、流动方向和适当的缩并来表示 $ \\mathbb{C}^{\\mathrm{alg}} $。然后，对于增量纯体积应变扰动（其中 $ \\epsilon_{v} = \\operatorname{tr}(\\epsilon) $），将算法体积模量 $ K^{\\mathrm{alg}} $ 定义为标量映射 $ K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\epsilon_{v} $，并对更新后状态下的 Drucker–Prager 模型，以闭式形式计算 $ K^{\\mathrm{alg}} $。\n4. 使用提供的数值数据，数值计算 $ K^{\\mathrm{alg}} $。将你的答案四舍五入到四位有效数字。最终结果以 MPa 表示。", "solution": "该问题具有科学依据，是适定的、客观的，并包含了唯一解所需的所有信息。这是计算塑性学中的一个标准问题。因此，该问题被认为是有效的。我们开始求解。\n\n### 任务 1：最近点投影公式\n\n问题在于找到更新后的应力状态 $\\sigma_{n+1}$，使其在满足屈服条件 $f(\\sigma_{n+1}) \\le 0$ 的同时，与弹性试探应力 $\\sigma^{\\mathrm{tr}}$ 最接近。“距离”是在由弹性刚度张量的逆 $\\mathbb{M}^e = (\\mathbb{C}^e)^{-1}$ 定义的能量范数下度量的。这是一个约束优化问题：\n$$\n\\text{最小化} \\quad \\frac{1}{2} (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) \\quad \\text{满足约束条件} \\quad f(\\sigma_{n+1}) \\le 0.\n$$\n对于塑性步，约束是激活的，即 $f(\\sigma_{n+1}) = 0$。该问题的拉格朗日函数为：\n$$\n\\mathcal{L}(\\sigma_{n+1}, \\Delta\\lambda) = \\frac{1}{2} (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) + \\Delta\\lambda f(\\sigma_{n+1})\n$$\n其中 $\\Delta\\lambda \\ge 0$ 是拉格朗日乘子，可被视为一致塑性乘子增量。一阶最优性条件为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\sigma_{n+1}} = \\mathbb{M}^e : (\\sigma_{n+1} - \\sigma^{\\mathrm{tr}}) + \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma_{n+1}} = \\mathbf{0}\n$$\n$$\nf(\\sigma_{n+1}) = 0\n$$\n从第一个条件，我们得到返回映射算法：\n$$\n\\sigma_{n+1} - \\sigma^{\\mathrm{tr}} = - \\Delta\\lambda (\\mathbb{M}^e)^{-1} : \\frac{\\partial f}{\\partial \\sigma_{n+1}} \\implies \\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : \\frac{\\partial f}{\\partial \\sigma_{n+1}}\n$$\n这个结构与从离散流动法则 $\\Delta\\epsilon^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma_{n+1}}$ 和应力更新 $\\sigma_{n+1} = \\mathbb{C}^e : (\\epsilon_{n+1} - \\epsilon^p_{n+1}) = \\sigma^{\\mathrm{tr}} - \\mathbb{C}^e : \\Delta\\epsilon^p$ 推导出的结构相同。\n\n为了继续，我们需要屈服函数 $f(\\sigma) = q + \\alpha p - k$ 的梯度。不变量的导数为：\n$$\n\\frac{\\partial p}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} \\left(\\frac{1}{3} I:\\sigma\\right) = \\frac{1}{3} I\n$$\n$$\n\\frac{\\partial q}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} \\left(\\sqrt{\\frac{3}{2} s:s}\\right) = \\sqrt{\\frac{3}{2}} \\frac{s}{\\sqrt{s:s}} = \\frac{3}{2} \\frac{s}{q}\n$$\n屈服函数的梯度，它定义了塑性流动的方向 $R$，为：\n$$\nR = \\frac{\\partial f}{\\partial \\sigma} = \\frac{3}{2} \\frac{s}{q} + \\frac{\\alpha}{3} I\n$$\n各向同性弹性张量为 $\\mathbb{C}^e = K I \\otimes I + 2G \\mathbb{P}_{\\mathrm{dev}}$，其中 $\\mathbb{P}_{\\mathrm{dev}} = \\mathbb{I} - \\frac{1}{3}I \\otimes I$ 是偏量投影张量。将此张量作用于 $R$：\n$$\n\\mathbb{C}^e : R = \\mathbb{C}^e : \\left(\\frac{3}{2} \\frac{s}{q}\\right) + \\mathbb{C}^e : \\left(\\frac{\\alpha}{3} I\\right)\n$$\n由于 $\\frac{s}{q}$ 是偏量部分，而 $I$ 是体积部分，我们得到：\n$$\n\\mathbb{C}^e : R = 2G \\left(\\frac{3}{2} \\frac{s}{q}\\right) + K (I \\otimes I) : \\left(\\frac{\\alpha}{3} I\\right) = 3G \\frac{s}{q} + \\alpha K I\n$$\n将此代入在 $\\sigma_{n+1}$ 处求值的返回映射方程：\n$$\n\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\left( 3G \\frac{s_{n+1}}{q_{n+1}} + \\alpha K I \\right)\n$$\n分解为静水压力部分和偏应力部分 ($s_{n+1} = \\sigma_{n+1} - p_{n+1}I$):\n$$\np_{n+1}I + s_{n+1} = p^{\\mathrm{tr}}I + s^{\\mathrm{tr}} - \\Delta\\lambda (\\alpha K I) - \\Delta\\lambda \\left( 3G \\frac{s_{n+1}}{q_{n+1}} \\right)\n$$\n令相应部分相等，得到不变量的更新法则：\n静水压力部分： $p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda$\n偏应力部分： $s_{n+1} = s^{\\mathrm{tr}} - 3G \\Delta\\lambda \\frac{s_{n+1}}{q_{n+1}} \\implies s_{n+1}\\left(1 + \\frac{3G \\Delta\\lambda}{q_{n+1}}\\right) = s^{\\mathrm{tr}}$。\n这意味着 $s_{n+1}$ 和 $s^{\\mathrm{tr}}$ 是共轴的。对偏应力方程取范数 $\\sqrt{\\frac{3}{2} \\cdot:\\cdot}$ 得到：\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$。\n\n通过施加一致性条件 $f(\\sigma_{n+1}) = 0$ 来获得 $\\Delta\\lambda$ 的标量方程：\n$$\nq_{n+1} + \\alpha p_{n+1} - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} - 3G \\Delta\\lambda) + \\alpha (p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda) - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k) - (3G + \\alpha^2 K) \\Delta\\lambda = 0\n$$\n这可以简化为 $f(\\sigma^{\\mathrm{tr}}) - (3G + \\alpha^2 K) \\Delta\\lambda = 0$。\n\n### 任务 2：求解 $\\Delta\\lambda$ 并计算更新后的不变量\n\n根据一致性方程，如果发生塑性加载（$f(\\sigma^{\\mathrm{tr}}) > 0$），塑性乘子增量为：\n$$\n\\Delta\\lambda = \\frac{f(\\sigma^{\\mathrm{tr}})}{3G + \\alpha^2 K} = \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha^2 K}\n$$\n首先，我们计算试探应力 $\\sigma^{\\mathrm{tr}} = \\begin{pmatrix} 10  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$ MPa 的不变量。\n试探压力：$p^{\\mathrm{tr}} = \\frac{1}{3}\\operatorname{tr}(\\sigma^{\\mathrm{tr}}) = \\frac{1}{3}(10+0+0) = \\frac{10}{3}$ MPa。\n试探偏应力：$s^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}} - p^{\\mathrm{tr}}I = \\begin{pmatrix} 20/3  0  0 \\\\ 0  -10/3  0 \\\\ 0  0  -10/3 \\end{pmatrix}$ MPa。\n试探偏应力不变量：\n$q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}s^{\\mathrm{tr}}:s^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2}\\left[\\left(\\frac{20}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2\\right]} = \\sqrt{\\frac{3}{2}\\frac{600}{9}} = \\sqrt{100} = 10$ MPa。\n\n接下来，我们用材料参数 $\\alpha=0.2$ 和 $k=2$ MPa 检查屈服条件：\n$f(\\sigma^{\\mathrm{tr}}) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k = 10 + 0.2 \\left(\\frac{10}{3}\\right) - 2 = 8 + \\frac{2}{3} = \\frac{26}{3}$ MPa。\n由于 $f(\\sigma^{\\mathrm{tr}}) > 0$，发生塑性加载。\n\n我们用 $G=40$ MPa 和 $K=100$ MPa 计算分母 $3G + \\alpha^2 K$：\n$3G + \\alpha^2 K = 3(40) + (0.2)^2(100) = 120 + 0.04(100) = 120 + 4 = 124$ MPa。\n塑性乘子为：\n$\\Delta\\lambda = \\frac{26/3}{124} = \\frac{26}{3 \\cdot 124} = \\frac{13}{186}$。\n\n最后，我们计算更新后的不变量 $p_{n+1}$ 和 $q_{n+1}$：\n$p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda = \\frac{10}{3} - (0.2)(100)\\left(\\frac{13}{186}\\right) = \\frac{10}{3} - \\frac{260}{186} = \\frac{620 - 260}{186} = \\frac{360}{186} = \\frac{60}{31}$ MPa。\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda = 10 - 3(40)\\left(\\frac{13}{186}\\right) = 10 - \\frac{1560}{186} = \\frac{1860 - 1560}{186} = \\frac{300}{186} = \\frac{50}{31}$ MPa。\n我们可以检查一致性：$q_{n+1} + \\alpha p_{n+1} - k = \\frac{50}{31} + 0.2\\left(\\frac{60}{31}\\right) - 2 = \\frac{50+12}{31} - 2 = \\frac{62}{31} - 2 = 2 - 2 = 0$。\n\n### 任务 3：算法切线和算法体积模量\n\n一致算法切线模量为 $\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\epsilon_{n+1}}$。对于总应变驱动问题，试探应力为 $\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : (\\epsilon_{n+1}-\\epsilon^{p}_n)$，所以 $\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : \\mathrm{d}\\epsilon_{n+1}$。因此，$\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\sigma^{\\mathrm{tr}}} : \\mathbb{C}^e$。\n\n对于塑性加载，状态由以下系统控制：\n$\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : R$\n$f(\\sigma_{n+1}) = 0$。\n其中 $R = \\frac{\\partial f}{\\partial\\sigma}\\Big|_{\\sigma_{n+1}}$。对于径向返回算法（如为 DP 推导的），流动向量的偏量部分在迭代过程中方向恒定，因此我们可以使用 $R \\approx R^{\\mathrm{tr}} = \\frac{\\partial f}{\\partial\\sigma}\\Big|_{\\sigma^{\\mathrm{tr}}}$。\n微分时，保持一致性条件 $d f(\\sigma_{n+1}) = R : d\\sigma_{n+1} = 0$：\n$R : (\\mathrm{d}\\sigma^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e : R) = 0 \\implies \\mathrm{d}(\\Delta\\lambda) = \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{R:\\mathbb{C}^e:R}$。\n我们计算了 $R:\\mathbb{C}^e:R = 3G + \\alpha^2 K$。\n将 $\\mathrm{d}(\\Delta\\lambda)$ 代回线性化的返回映射 $\\mathrm{d}\\sigma_{n+1} = \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e:R$：\n$$\n\\mathrm{d}\\sigma_{n+1} = \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:R) = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:R) \\otimes R}{3G+\\alpha^2K} \\right) : \\mathrm{d}\\sigma^{\\mathrm{tr}}\n$$\n由此，可以确定 $\\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\sigma^{\\mathrm{tr}}}$。算法切线为：\n$$\n\\mathbb{C}^{\\mathrm{alg}} = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:R) \\otimes R}{3G+\\alpha^2K} \\right) : \\mathbb{C}^e = \\mathbb{C}^e - \\frac{(\\mathbb{C}^e:R) \\otimes (\\mathbb{C}^e:R)}{3G+\\alpha^2K}\n$$\n\n算法体积模量是对于纯体积应变增量 $\\mathrm{d}\\epsilon = \\mathrm{d}\\epsilon_v \\frac{1}{3}I$ 的 $K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\epsilon_{v}$。这对应于一个试探应力增量 $\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\mathbb{C}^e : (\\mathrm{d}\\epsilon_v \\frac{1}{3}I) = K \\mathrm{d}\\epsilon_v I = \\mathrm{d}p^{\\mathrm{tr}} I$。\n压力的变化为 $\\mathrm{d}p_{n+1} = \\frac{1}{3} I : \\mathrm{d}\\sigma_{n+1}$。使用 $\\mathrm{d}\\sigma_{n+1}$ 的表达式：\n$$\n\\mathrm{d}p_{n+1} = \\frac{1}{3}I : \\left( \\mathrm{d}\\sigma^{\\mathrm{tr}} - \\frac{R:\\mathrm{d}\\sigma^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:R) \\right)\n$$\n对于 $\\mathrm{d}\\sigma^{\\mathrm{tr}} = K \\mathrm{d}\\epsilon_v I$：\n$\\frac{1}{3}I:\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\frac{1}{3}I:(K\\mathrm{d}\\epsilon_v I) = K\\mathrm{d}\\epsilon_v$。\n$R:\\mathrm{d}\\sigma^{\\mathrm{tr}} = \\left(\\frac{3}{2}\\frac{s^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\frac{\\alpha}{3} I\\right) : (K\\mathrm{d}\\epsilon_v I) = 0 + \\frac{\\alpha}{3}K\\mathrm{d}\\epsilon_v (I:I) = \\alpha K \\mathrm{d}\\epsilon_v$。\n$\\frac{1}{3}I:(\\mathbb{C}^e:R) = \\frac{1}{3}I:\\left(3G\\frac{s^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\alpha K I\\right) = 0 + \\frac{1}{3}\\alpha K (I:I) = \\alpha K$。\n将这些部分代回：\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\epsilon_v - \\frac{\\alpha K \\mathrm{d}\\epsilon_v}{3G+\\alpha^2K}(\\alpha K) = K\\mathrm{d}\\epsilon_v \\left(1 - \\frac{\\alpha^2 K}{3G+\\alpha^2K}\\right)\n$$\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\epsilon_v \\left(\\frac{3G+\\alpha^2K - \\alpha^2 K}{3G+\\alpha^2K}\\right) = K \\frac{3G}{3G+\\alpha^2K} \\mathrm{d}\\epsilon_v\n$$\n因此，算法体积模量为：\n$$\nK^{\\mathrm{alg}} = \\frac{\\mathrm{d}p_{n+1}}{\\mathrm{d}\\epsilon_v} = K \\frac{3G}{3G+\\alpha^2K}\n$$\n\n### 任务 4：算法体积模量的数值计算\n\n使用给定数据：$K = 100$ MPa, $G = 40$ MPa, $\\alpha=0.2$。\n$$\nK^{\\mathrm{alg}} = 100 \\frac{3(40)}{3(40) + (0.2)^2(100)} = 100 \\frac{120}{120 + 0.04(100)} = 100 \\frac{120}{120+4}\n$$\n$$\nK^{\\mathrm{alg}} = 100 \\frac{120}{124} = 100 \\frac{30}{31} = \\frac{3000}{31} \\approx 96.77419... \\text{ MPa}\n$$\n四舍五入到四位有效数字，结果为 $96.77$ MPa。", "answer": "$$\n\\boxed{96.77}\n$$", "id": "3508082"}, {"introduction": "在推导了离散时间步的算法切线后，一个自然而深刻的问题是：它与连续介质理论中的弹塑性切线有何关系？本练习通过一个特定的加载路径——纯体积应变增量——来探讨这个问题。您需要分别推导算法切线 $\\mathbb{C}^{\\text{alg}}$ 和连续弹塑性切线 $\\mathbb{C}^{\\text{ep}}$ 的体积分量，并对二者进行比较。[@problem_id:3508098] 通过这项实践，您将揭示“一致性”的深刻含义，并理解在何种条件下离散切线能够精确地再现连续介质在时间步末端的状态。", "problem": "考虑一个三维空间中的小应变、各向同性、弹塑性土体，其遵循关联流动的Drucker–Prager模型。设柯西应力为 $\\sigma$，线弹性模量为 $K$（体积模量）和 $G$（剪切模量），并定义静水压力 $p = \\tfrac{1}{3} \\operatorname{tr}(\\sigma)$（压为正）和第二不变量 $q = \\sqrt{\\tfrac{3}{2} \\, s:s}$，其中 $s = \\sigma - p \\, \\mathbb{I}$ 是偏应力，$\\mathbb{I}$ 是二阶单位张量。Drucker–Prager屈服函数为\n$$\nf(\\sigma,\\kappa) = q + \\eta \\, p - c(\\kappa),\n$$\n其中摩擦参数 $\\eta > 0$，黏聚力 $c(\\kappa) = c_{0} + H \\, \\kappa$，$H \\ge 0$ 是线性各向同性硬化模量，$\\kappa$ 是一个标量内变量。流动是关联的，因此塑性势等于屈服函数。弹性定律为 $\\sigma = 2 G \\, \\varepsilon^{e}_{\\text{dev}} + K \\, \\varepsilon^{e}_{v} \\, \\mathbb{I}$，其中 $\\varepsilon^{e}_{v} = \\operatorname{tr}(\\varepsilon^{e})$ 且 $\\varepsilon^{e}_{\\text{dev}} = \\varepsilon^{e} - \\tfrac{1}{3} \\varepsilon^{e}_{v} \\mathbb{I}$。\n\n给定一个从步骤 $n$ 到 $n+1$ 的单步后向欧拉本构更新，该更新在指定的纯体积应变增量下进行\n$$\n\\Delta \\varepsilon = \\frac{\\Delta \\varepsilon_{v}}{3} \\, \\mathbb{I},\n$$\n其中 $\\Delta \\varepsilon_{v}$ 是一个常数。假设偏流方向\n$$\nn := \\frac{s}{q}\n$$\n在步骤 $n$ 是良定义的（即 $q_{n} > 0$），并在增量过程中保持不变。该算法使用标准的弹性预测/塑性修正方法，塑性乘子增量为 $\\Delta \\gamma$，并更新 $c_{n+1} = c_{n} + H \\, \\Delta \\gamma$。\n\n1. 从这些定义和后向欧拉更新出发，推导算法一致性切线模量 $\\mathbb{C}^{\\text{alg}}$，并从中提取标量体积投影\n$$\nK^{\\text{alg}} := \\frac{1}{9} \\, \\mathbb{I} : \\mathbb{C}^{\\text{alg}} : \\mathbb{I} = \\frac{\\mathrm{d} p_{n+1}}{\\mathrm{d} (\\Delta \\varepsilon_{v})}.\n$$\n\n2. 独立地，在线性化连续介质中的率方程（无时间离散化）以获得相同状态下的连续弹塑性切线模量 $\\mathbb{C}^{\\text{ep}}$，并计算其体积投影\n$$\nK^{\\text{cont}} := \\frac{1}{9} \\, \\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I}.\n$$\n\n3. 计算量化比较\n$$\nr := \\frac{K^{\\text{alg}}}{K^{\\text{cont}}}.\n$$\n\n将最终答案表示为单个实数。无需四舍五入。由于 $r$ 是无量纲的，因此不需要单位。所有假设和步骤都必须根据给定的模型定义和标准的小应变弹塑性原理进行论证，不得引用任何未引入的简化公式。", "solution": "问题要求计算在纯体积应变增量下，Drucker-Prager材料的算法切线体积模量与连续介质切线体积模量的比值 $r = \\frac{K^{\\text{alg}}}{K^{\\text{cont}}}$。我们将依次推导每个量，然后计算它们的比值。\n\n第1部分：算法体积模量 $K^{\\text{alg}}$ 的推导\n\n算法更新遵循弹性预测/塑性修正方案。总应变增量为纯体积应变：$\\Delta \\varepsilon = \\frac{\\Delta \\varepsilon_{v}}{3} \\mathbb{I}$。\n\n弹性预测：\n假设为纯弹性增量，试探应力状态为：\n$$\n\\sigma^{\\text{trial}} = \\sigma_{n} + \\mathbb{C}^{e} : \\Delta\\varepsilon\n$$\n其中 $\\mathbb{C}^{e} = 2 G \\mathbb{I}^{\\text{dev}} + K \\mathbb{I} \\otimes \\mathbb{I}$ 是各向同性弹性刚度张量。对于给定的应变增量，应力增量是纯静水的：\n$$\n\\mathbb{C}^{e} : \\Delta\\varepsilon = (2 G \\mathbb{I}^{\\text{dev}} + K \\mathbb{I} \\otimes \\mathbb{I}) : (\\frac{\\Delta \\varepsilon_{v}}{3} \\mathbb{I}) = \\frac{K \\Delta \\varepsilon_{v}}{3} (\\mathbb{I}:\\mathbb{I}) = K \\Delta \\varepsilon_{v} \\mathbb{I}\n$$\n因此，试探应力为：\n$$\n\\sigma^{\\text{trial}} = \\sigma_{n} + K \\Delta \\varepsilon_{v} \\mathbb{I}\n$$\n我们将其分解为试探压力 $p^{\\text{trial}}$ 和试探偏应力 $s^{\\text{trial}}$：\n$$\np^{\\text{trial}} = \\frac{1}{3} \\operatorname{tr}(\\sigma^{\\text{trial}}) = \\frac{1}{3} \\operatorname{tr}(\\sigma_{n}) + \\frac{1}{3} \\operatorname{tr}(K \\Delta \\varepsilon_{v} \\mathbb{I}) = p_{n} + K \\Delta \\varepsilon_{v}\n$$\n$$\ns^{\\text{trial}} = \\sigma^{\\text{trial}} - p^{\\text{trial}} \\mathbb{I} = (\\sigma_{n} - p_{n}\\mathbb{I}) + (K \\Delta \\varepsilon_{v} \\mathbb{I} - K \\Delta \\varepsilon_{v} \\mathbb{I}) = s_{n}\n$$\n因此，试探第二不变量 $q^{\\text{trial}}$ 为：\n$$\nq^{\\text{trial}} = \\sqrt{\\frac{3}{2} s^{\\text{trial}}:s^{\\text{trial}}} = \\sqrt{\\frac{3}{2} s_{n}:s_{n}} = q_{n}\n$$\n在试探状态下，使用步骤 $n$ 的黏聚力 $c_n$ 来评估屈服函数：\n$$\nf^{\\text{trial}} = q^{\\text{trial}} + \\eta \\, p^{\\text{trial}} - c_{n} = q_{n} + \\eta (p_{n} + K \\Delta \\varepsilon_{v}) - c_{n} = (q_{n} + \\eta p_{n} - c_{n}) + \\eta K \\Delta \\varepsilon_{v}\n$$\n假设步骤 $n$ 的状态位于屈服面上，$f_{n} = q_{n} + \\eta p_{n} - c_{n} = 0$。这可将试探屈服值简化为：\n$$\nf^{\\text{trial}} = \\eta K \\Delta \\varepsilon_{v}\n$$\n如果 $f^{\\text{trial}} > 0$，则发生塑性加载。由于 $\\eta > 0$ 且 $K > 0$，这要求 $\\Delta \\varepsilon_{v} > 0$（体积压缩）。我们假设进入塑性阶段继续进行。\n\n塑性修正（返回映射）：\n后向欧拉更新法则是：\n$$\n\\sigma_{n+1} = \\sigma^{\\text{trial}} - \\Delta\\gamma \\, \\mathbb{C}^{e} : m_{n+1}\n$$\n$$\nc_{n+1} = c_{n} + H \\Delta\\gamma\n$$\n并满足一致性条件 $f(\\sigma_{n+1}, c_{n+1}) = 0$。塑性流动方向 $m$ 由屈服函数的导数给出（关联流动）：\n$$\nm = \\frac{\\partial f}{\\partial \\sigma} = \\frac{\\partial q}{\\partial \\sigma} + \\eta \\frac{\\partial p}{\\partial \\sigma}\n$$\n导数为 $\\frac{\\partial p}{\\partial \\sigma} = \\frac{1}{3} \\mathbb{I}$ 和 $\\frac{\\partial q}{\\partial \\sigma} = \\frac{3}{2} \\frac{s}{q} = \\frac{3}{2} n$。因此：\n$$\nm = \\frac{3}{2} n + \\frac{\\eta}{3} \\mathbb{I}\n$$\n问题陈述中提到 $n$ 在增量期间是固定的。这与我们的发现 $s^{\\text{trial}}=s_{n}$ 一致，这意味着偏应力的返回映射必须与 $s_{n}$ 共线，因此与 $n_n$ 共线，从而得到 $n_{n+1}=n_n=n$。\n我们使用 $m_{n+1} = \\frac{3}{2} n + \\frac{\\eta}{3} \\mathbb{I}$。应力修正项为：\n$$\n\\mathbb{C}^{e} : m_{n+1} = (2 G \\mathbb{I}^{\\text{dev}} + K \\mathbb{I} \\otimes \\mathbb{I}) : \\left(\\frac{3}{2}n + \\frac{\\eta}{3}\\mathbb{I}\\right) = 2G\\left(\\frac{3}{2}n\\right) + K\\left(\\frac{\\eta}{3}\\right)(\\mathbb{I}:\\mathbb{I}) = 3Gn + K\\eta\\mathbb{I}\n$$\n更新后的应力为：\n$$\n\\sigma_{n+1} = \\sigma^{\\text{trial}} - \\Delta\\gamma (3Gn + K\\eta\\mathbb{I})\n$$\n分解后得到更新的压力和偏应力：\n$$\np_{n+1} = p^{\\text{trial}} - \\Delta\\gamma K\\eta = p_{n} + K \\Delta\\varepsilon_{v} - K\\eta\\Delta\\gamma\n$$\n$$\ns_{n+1} = s^{\\text{trial}} - \\Delta\\gamma (3Gn) = s_{n} - 3G\\Delta\\gamma n = (q_{n} - 3G\\Delta\\gamma)n\n$$\n从 $s_{n+1}$ 的表达式中，我们得到 $q_{n+1} = q_{n} - 3G\\Delta\\gamma$，假设 $q_{n} > 3G\\Delta\\gamma$。\n现在，我们施加一致性条件 $q_{n+1} + \\eta p_{n+1} - c_{n+1} = 0$：\n$$\n(q_{n} - 3G\\Delta\\gamma) + \\eta(p_{n} + K\\Delta\\varepsilon_{v} - K\\eta\\Delta\\gamma) - (c_{n} + H\\Delta\\gamma) = 0\n$$\n重新整理并使用 $f_{n} = q_{n} + \\eta p_{n} - c_{n} = 0$：\n$$\n\\eta K \\Delta\\varepsilon_{v} = \\Delta\\gamma (3G + K\\eta^{2} + H)\n$$\n求解塑性乘子增量 $\\Delta\\gamma$：\n$$\n\\Delta\\gamma = \\frac{\\eta K \\Delta\\varepsilon_{v}}{3G + K\\eta^{2} + H}\n$$\n将其代回到 $p_{n+1}$ 的方程中：\n$$\np_{n+1} = p_{n} + K\\Delta\\varepsilon_{v} - K\\eta \\left( \\frac{\\eta K \\Delta\\varepsilon_{v}}{3G + K\\eta^{2} + H} \\right) = p_{n} + \\left( K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H} \\right) \\Delta\\varepsilon_{v}\n$$\n算法体积模量是 $p_{n+1}$ 相对于 $\\Delta\\varepsilon_{v}$ 的导数：\n$$\nK^{\\text{alg}} = \\frac{\\mathrm{d} p_{n+1}}{\\mathrm{d} (\\Delta \\varepsilon_{v})} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n\n第2部分：连续介质切线体积模量 $K^{\\text{cont}}$ 的推导\n\n连续介质切线模量关联了应力率和应变率，$\\dot{\\sigma} = \\mathbb{C}^{\\text{ep}} : \\dot{\\varepsilon}$。它由一致性条件 $\\dot{f}=0$ 推导得出。塑性状态的率方程为：\n$\\dot{\\varepsilon} = \\dot{\\varepsilon}^{e} + \\dot{\\varepsilon}^{p}$，其中 $\\dot{\\varepsilon}^{p} = \\dot{\\gamma} m$。\n$\\dot{\\sigma} = \\mathbb{C}^{e} : \\dot{\\varepsilon}^{e} = \\mathbb{C}^{e} : (\\dot{\\varepsilon} - \\dot{\\gamma}m)$。\n$\\dot{f} = \\frac{\\partial f}{\\partial \\sigma} : \\dot{\\sigma} + \\frac{\\partial f}{\\partial c} \\dot{c} = m : \\dot{\\sigma} - \\dot{c} = 0$。\n对于线性硬化，$\\dot{c}=H\\dot{\\kappa}=H\\dot{\\gamma}$。所以，$m : \\dot{\\sigma} - H\\dot{\\gamma} = 0$。\n\n将应力率代入一致性条件：\n$$\nm : [\\mathbb{C}^{e} : (\\dot{\\varepsilon} - \\dot{\\gamma}m)] - H\\dot{\\gamma} = 0\n$$\n$$\nm : \\mathbb{C}^{e} : \\dot{\\varepsilon} - \\dot{\\gamma} (m : \\mathbb{C}^{e} : m) - H\\dot{\\gamma} = 0\n$$\n求解塑性乘子率 $\\dot{\\gamma}$：\n$$\n\\dot{\\gamma} = \\frac{m : \\mathbb{C}^{e} : \\dot{\\varepsilon}}{m : \\mathbb{C}^{e} : m + H}\n$$\n项 $m : \\mathbb{C}^{e} : m$ 的计算如下：\n$$\nm : \\mathbb{C}^{e} : m = \\left(\\frac{3}{2}n + \\frac{\\eta}{3}\\mathbb{I}\\right) : \\left(3Gn + K\\eta\\mathbb{I}\\right) = \\frac{9}{2}G(n:n) + \\frac{K\\eta^{2}}{3}(\\mathbb{I}:\\mathbb{I}) = \\frac{9}{2}G\\left(\\frac{2}{3}\\right) + \\frac{K\\eta^{2}}{3}(3) = 3G + K\\eta^{2}\n$$\n代回以根据 $\\dot{\\varepsilon}$ 求解 $\\dot{\\sigma}$：\n$$\n\\dot{\\sigma} = \\mathbb{C}^{e} : \\dot{\\varepsilon} - \\dot{\\gamma} (\\mathbb{C}^{e} : m) = \\mathbb{C}^{e} : \\dot{\\varepsilon} - \\frac{(\\mathbb{C}^{e} : m) \\otimes (m : \\mathbb{C}^{e})}{m : \\mathbb{C}^{e} : m+H} : \\dot{\\varepsilon}\n$$\n连续弹塑性切线模量 $\\mathbb{C}^{\\text{ep}}$ 被确定为：\n$$\n\\mathbb{C}^{\\text{ep}} = \\mathbb{C}^{e} - \\frac{(\\mathbb{C}^{e} : m) \\otimes (m : \\mathbb{C}^{e})}{m : \\mathbb{C}^{e} : m + H} = \\mathbb{C}^{e} - \\frac{(3Gn + K\\eta\\mathbb{I}) \\otimes (3Gn + K\\eta\\mathbb{I})}{3G + K\\eta^{2} + H}\n$$\n连续介质切线体积模量为 $K^{\\text{cont}} = \\frac{1}{9} \\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I}$。\n$$\n\\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I} = \\mathbb{I} : \\mathbb{C}^{e} : \\mathbb{I} - \\frac{[\\mathbb{I} : (3Gn + K\\eta\\mathbb{I})] \\otimes [(3Gn + K\\eta\\mathbb{I}) : \\mathbb{I}]}{3G + K\\eta^{2} + H}\n$$\n我们计算投影项：\n$\\mathbb{I} : \\mathbb{C}^{e} : \\mathbb{I} = \\mathbb{I} : (3K\\mathbb{I}) = 3K(\\mathbb{I}:\\mathbb{I}) = 9K$。\n$\\mathbb{I} : (3Gn + K\\eta\\mathbb{I}) = 3G(\\mathbb{I}:n) + K\\eta(\\mathbb{I}:\\mathbb{I}) = 3G(0) + K\\eta(3) = 3K\\eta$。\n将这些代入 $\\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I}$ 的表达式中：\n$$\n\\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I} = 9K - \\frac{(3K\\eta)(3K\\eta)}{3G + K\\eta^{2} + H} = 9K - \\frac{9K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n最后，我们求得 $K^{\\text{cont}}$：\n$$\nK^{\\text{cont}} = \\frac{1}{9}(\\mathbb{I} : \\mathbb{C}^{\\text{ep}} : \\mathbb{I}) = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n\n第3部分：量化比较\n\n我们现在比较推导出的两个量：\n$$\nK^{\\text{alg}} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n$$\nK^{\\text{cont}} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n这两个表达式是相同的。这是一个特殊结果，源于应变增量的纯体积特性，这确保了偏应力方向 $n$ 在增量过程中不发生改变（因为 $s^{\\text{trial}} = s_{n}$）。在这种特定情况下，算法的精确线性化（算法切线模量）在体积投影上与连续介质切线模量一致。\n因此，比值为：\n$$\nr = \\frac{K^{\\text{alg}}}{K^{\\text{cont}}} = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3508098"}, {"introduction": "本章的最终实践将理论付诸于数值实现，旨在直观地展示一致线性化的实际效用。在一个耦合孔隙力学问题中，您需要实现牛顿法来求解非线性方程组。此练习的核心价值在于，通过编程实践，量化比较使用精确（一致）切线矩阵和简化（非一致）切线矩阵时的收敛性能。[@problem_id:3508087] 这项动手练习将有力地证明，为何一致线性化对于保证牛顿法的二次收敛速度、提升计算效率和稳健性至关重要。", "problem": "考虑一个由Biot孔隙力学理论控制的饱和多孔介质的一维限制压缩试验。设一个时间步结束时的未知量为固体骨架的体积应变 $e$ 和孔隙流体的孔隙压力 $p$。本分析在小应变、准静态、等温、单相流体的假设下进行。设轴向加载方向上的总柯西应力由 $\\sigma = \\sigma^{\\prime} - \\alpha\\,p$ 给出，其中 $\\sigma^{\\prime}$ 是骨架的有效应力，$\\alpha$ 是Biot系数。采用非线性弹性体积有效应力定律 $\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$，其中 $K_0 > 0$ 且 $\\beta \\ge 0$。假设流体质量平衡采用后向欧拉时间离散，其中储水系数为 $S$，并使用一个集总水力传导项 $\\ell$ 来表示向外部压力为零的储层的排水。在此设定中，所有物理量均为标量。\n\n基于以下两点，从第一性原理推导耦合的非线性残差向量 $\\boldsymbol{r}(e,p)$：\n- 与步末施加的轴向总应力 $\\sigma_{\\text{app}}$ 的总应力平衡，\n- 流体质量平衡的后向欧拉离散，包含储水项和与 $p$ 成正比的线性化排水项。\n\n此处，$e^n$ 和 $p^n$ 表示前一时间步的收敛值，$\\Delta t$ 是时间步长。\n\n然后，推导一致切线（雅可比）矩阵 $\\boldsymbol{K}_{\\text{cons}}(e,p)$，作为 $\\boldsymbol{r}(e,p)$ 相对于未知量 $(e,p)$ 的精确导数。同时定义一个非一致固体切线矩阵 $\\boldsymbol{K}_{\\text{incons}}(e,p)$，其通过将动量块中的导数 $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e$ 替换为常数 $K_0$（即忽略非线性项 $\\beta\\,e^3$ 的贡献）而得到，同时保持所有其他雅可比项精确。\n\n您的程序必须：\n- 实现牛顿法以求解 $\\boldsymbol{r}(e,p) = \\boldsymbol{0}$，分别使用一致切线和非一致切线。两种求解均使用相同的初始猜测 $(e^0,p^0) = (e^n,p^n)$。\n- 在牛顿更新上使用回溯线搜索，以确保稳健收敛，并对残差的欧几里得范数采用充分下降准则。\n- 当比率 $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2 \\le \\varepsilon$（其中 $\\varepsilon$ 为容差）或达到最大迭代次数时终止。如果初始残差为零，则返回零次迭代。\n- 对于每个测试用例，报告两个整数：使用一致切线和非一致切线的牛顿迭代次数，每次都是达到指定容差所执行的非线性迭代次数。如果方法在迭代上限内未能收敛，则为该方法返回上限值加一。\n\n您的推导应基于以下基本关系：\n- 有效应力原理：$\\sigma = \\sigma^{\\prime} - \\alpha\\,p$，\n- 体积非线性弹性定律：$\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$，切线为 $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e = K_0 + 3\\,\\beta\\,e^2$，\n- 与外部压力为零的储层进行质量交换的集总系统的后向欧拉流体质量平衡：$\\alpha\\,(e - e^n) + S\\,(p - p^n) + \\Delta t\\,\\ell\\,p = 0$。\n\n使用以下单位和数值要求：\n- 应力相关量以兆帕（MPa）表示，时间以秒（s）表示，应变为无量纲。\n- 储水系数 $S$ 的单位必须是 $\\text{MPa}^{-1}$，传导系数 $\\ell$ 的单位是 $\\text{MPa}^{-1}\\,\\text{s}^{-1}$，Biot系数 $\\alpha$ 是无量纲的。\n- 使用收敛容差 $\\varepsilon = 10^{-10}$，最大牛顿迭代次数 $N_{\\max} = 50$，Armijo参数 $c = 10^{-4}$，以及回溯因子 $\\gamma = 0.5$。\n\n测试套件：\n- 情况 A（近线性，理想情况）：$K_0 = 1000$，$\\beta = 0$，$\\alpha = 1.0$，$S = 10^{-3}$，$\\Delta t = 1.0$，$\\ell = 10^{-2}$，$\\sigma_{\\text{app}} = 10$，$e^n = 0$，$p^n = 0$。\n- 情况 B（中度非线性，中度耦合）：$K_0 = 1000$，$\\beta = 5\\times 10^{5}$，$\\alpha = 0.9$，$S = 10^{-3}$，$\\Delta t = 1.0$，$\\ell = 10^{-2}$，$\\sigma_{\\text{app}} = 100$，$e^n = 0$，$p^n = 0$。\n- 情况 C（强非线性，刚性耦合）：$K_0 = 1000$，$\\beta = 10^{6}$，$\\alpha = 0.9$，$S = 10^{-6}$，$\\Delta t = 5.0$，$\\ell = 10^{-1}$，$\\sigma_{\\text{app}} = 100$，$e^n = 0$，$p^n = 0$。\n\n以上所有数值均采用其指定单位。例如，$K_0$ 和 $\\beta$ 的单位是兆帕，$\\Delta t$ 的单位是秒。\n\n您的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起来，顺序如下：\n$[\\text{it}_{\\text{cons},A}, \\text{it}_{\\text{incons},A}, \\text{it}_{\\text{cons},B}, \\text{it}_{\\text{incons},B}, \\text{it}_{\\text{cons},C}, \\text{it}_{\\text{incons},C}]$，\n其中每个条目是一个整数，等于相应牛顿求解所用的迭代次数。如果某个求解在最多 $N_{\\max}$ 次迭代内未能收敛，则为该条目报告 $N_{\\max} + 1$。", "solution": "该问题要求推导控制方程，并为一个一维、准静态的孔隙力学系统实现数值解。在一个时间步结束时，系统的状态由两个标量未知量描述：固体骨架的体积应变 $e$ 和孔隙流体压力 $p$。我们将它们组合成一个状态向量 $\\boldsymbol{x} = [e, p]^T$。问题是找到 $\\boldsymbol{x}$ 以求解非线性方程组 $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$，其中 $\\boldsymbol{r}$ 是残差向量。\n\n残差向量源自两个基本物理原理：动量平衡（应力平衡）和流体质量平衡。\n\n首先，我们从动量平衡方程建立残差分量。在这个准静态的一维设定中，总应力 $\\sigma$ 必须与外部施加的应力 $\\sigma_{\\text{app}}$ 平衡。第一个残差方程 $r_1$ 表示这种平衡：\n$$r_1(e,p) = \\sigma - \\sigma_{\\text{app}} = 0$$\n问题给出了有效应力原理 $\\sigma = \\sigma^{\\prime} - \\alpha p$，其中 $\\sigma^{\\prime}$ 是有效应力，$\\alpha$ 是Biot系数。固体骨架的本构法则是有效应力与体积应变之间的非线性弹性关系：$\\sigma^{\\prime}(e) = K_0 e + \\beta e^3$。将这些关系代入平衡方程，得到残差向量的第一个分量：\n$$r_1(e,p) = (K_0 e + \\beta e^3) - \\alpha p - \\sigma_{\\text{app}}$$\n\n其次，我们从流体质量平衡建立残差分量。问题提供了使用后向欧拉法对此平衡方程进行时间离散的形式。该方程关联了在一个时间步 $\\Delta t$ 内应变的变化、压力的变化以及孔隙流体的排出。设 $e^n$ 和 $p^n$ 为前一时间步的收敛值。流体质量平衡给出如下：\n$$\\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p = 0$$\n其中 $S$ 是储水系数，$\\ell$ 是水力传导系数。第二个残差分量 $r_2$ 只是这个方程的重新排列：\n$$r_2(e,p) = \\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p$$\n我们可以将与当前未知量 $(e, p)$ 相关的项组合起来，写成：\n$$r_2(e,p) = \\alpha e + (S + \\Delta t \\, \\ell)p - (\\alpha e^n + S p^n)$$\n\n结合这两个分量，完整的残差向量 $\\boldsymbol{r}(e,p)$ 为：\n$$\\boldsymbol{r}(e,p) = \\begin{pmatrix} r_1(e,p) \\\\ r_2(e,p) \\end{pmatrix} = \\begin{pmatrix} K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}} \\\\ \\alpha(e - e^n) + (S + \\Delta t \\, \\ell)p - S p^n \\end{pmatrix}$$\n\n为了求解非线性系统 $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$，我们使用牛顿法。这种迭代方法需要一致切线矩阵，即残差向量相对于状态变量的雅可比矩阵，$\\boldsymbol{K}_{\\text{cons}} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\boldsymbol{x}}$。矩阵的分量是残差分量的偏导数：\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} \\frac{\\partial r_1}{\\partial e}  \\frac{\\partial r_1}{\\partial p} \\\\ \\frac{\\partial r_2}{\\partial e}  \\frac{\\partial r_2}{\\partial p} \\end{pmatrix}$$\n\n各个分量计算如下：\n$\\frac{\\partial r_1}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = K_0 + 3\\beta e^2$。此项是固体骨架的切线体积模量，$K_T(e)$。\n$\\frac{\\partial r_1}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = -\\alpha$。\n$\\frac{\\partial r_2}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = \\alpha$。\n$\\frac{\\partial r_2}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = S + \\Delta t \\, \\ell$。\n\n将这些组合起来，得到一致切线矩阵：\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} K_0 + 3\\beta e^2  -\\alpha \\\\ \\alpha  S + \\Delta t \\, \\ell \\end{pmatrix}$$\n\n问题还定义了一个非一致切线矩阵 $\\boldsymbol{K}_{\\text{incons}}$，它是通过将固体骨架的切线模量 $\\frac{\\mathrm{d}\\sigma^{\\prime}}{\\mathrm{d}e}$ 近似为其初始值 $K_0$ 而形成的。这意味着我们将一致雅可比矩阵中的项 $\\frac{\\partial r_1}{\\partial e}$ 替换为 $K_0$：\n$$\\boldsymbol{K}_{\\text{incons}}(e,p) = \\begin{pmatrix} K_0  -\\alpha \\\\ \\alpha  S + \\Delta t \\, \\ell \\end{pmatrix}$$\n只有当材料响应是线性的（$\\beta=0$）或者应变 $e$ 为零时，这个切线矩阵才是精确的。使用非一致切线通常会将牛顿法的收敛速度从二次降为线性。\n\n对于迭代 $k$ 的牛顿-拉弗森更新步骤涉及求解线性系统 $\\boldsymbol{K}(\\boldsymbol{x}_k) \\Delta \\boldsymbol{x}_k = -\\boldsymbol{r}(\\boldsymbol{x}_k)$ 以获得更新向量 $\\Delta \\boldsymbol{x}_k = [\\Delta e_k, \\Delta p_k]^T$。然后解按 $\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k$ 进行更新。步长 $\\eta_k$ 通过回溯线搜索确定，以确保残差范数有充分下降，防止发散。具体的Armijo条件是 $\\lVert \\boldsymbol{r}(\\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k) \\rVert_2 \\le (1 - c \\eta_k) \\lVert \\boldsymbol{r}(\\boldsymbol{x}_k) \\rVert_2$，其中常数 $c=10^{-4}$，回溯因子 $\\gamma=0.5$。迭代从初始猜测 $\\boldsymbol{x}_0 = [e^n, p^n]^T$ 开始，并在相对残差范数 $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2$ 低于容差 $\\varepsilon=10^{-10}$ 时终止。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef newton_solver(problem_params, initial_state, use_consistent_tangent):\n    \"\"\"\n    Solves the coupled nonlinear poromechanics problem using Newton's method.\n\n    Args:\n        problem_params (tuple): Physical and discretization parameters.\n        initial_state (tuple): Converged state from the previous step (e^n, p^n).\n        use_consistent_tangent (bool): Flag to use consistent or inconsistent tangent.\n\n    Returns:\n        int: Number of iterations to converge, or max_iter + 1 if failed.\n    \"\"\"\n    # Unpack parameters\n    K0, beta, alpha, S, dt, l, sigma_app = problem_params\n    e_n, p_n = initial_state\n\n    # Numerical solver settings\n    tol = 1e-10\n    max_iter = 50\n    c_armijo = 1e-4\n    gamma_bt = 0.5\n\n    # Initial guess for the state vector x = [e, p]\n    x = np.array([e_n, p_n], dtype=np.float64)\n\n    def compute_residual(x_vec):\n        \"\"\"Computes the residual vector r(x).\"\"\"\n        e, p = x_vec\n        r1 = K0 * e + beta * e**3 - alpha * p - sigma_app\n        r2 = alpha * (e - e_n) + S * (p - p_n) + dt * l * p\n        return np.array([r1, r2])\n\n    # Initial residual calculation\n    r0 = compute_residual(x)\n    norm_r0 = np.linalg.norm(r0)\n\n    # If initial guess is already the solution\n    if norm_r0 == 0.0:\n        return 0\n\n    # Main Newton iteration loop\n    for k in range(max_iter):\n        e_k, p_k = x\n        \n        # Calculate current residual and check for convergence\n        r_k = compute_residual(x)\n        norm_r_k = np.linalg.norm(r_k)\n        \n        if norm_r_k / norm_r0 = tol:\n            return k\n\n        # Compute the tangent matrix K\n        if use_consistent_tangent:\n            # Consistent tangent modulus\n            K11 = K0 + 3.0 * beta * e_k**2\n        else:\n            # Inconsistent (initial) tangent modulus\n            K11 = K0\n        \n        K = np.array([\n            [K11, -alpha],\n            [alpha, S + dt * l]\n        ], dtype=np.float64)\n\n        # Solve the linear system K * dx = -r for the update dx\n        try:\n            dx = np.linalg.solve(K, -r_k)\n        except np.linalg.LinAlgError:\n            # Matrix is singular, cannot proceed\n            return max_iter + 1\n\n        # Backtracking line search to find optimal step length eta\n        eta = 1.0\n        # Armijo condition: ||r(x + eta*dx)|| = (1 - c*eta) * ||r(x)||\n        # We perform a limited number of backtrackings to avoid infinite loops\n        max_backtrack_steps = 20\n        for _ in range(max_backtrack_steps):\n            x_trial = x + eta * dx\n            r_trial = compute_residual(x_trial)\n            norm_r_trial = np.linalg.norm(r_trial)\n            \n            if norm_r_trial = (1.0 - c_armijo * eta) * norm_r_k:\n                break  # Sufficient decrease, step is accepted\n            \n            eta *= gamma_bt\n        else:\n            # Line search failed to find a suitable step\n            return max_iter + 1\n\n        # Update the solution vector\n        x += eta * dx\n\n    # Final check after the loop completes (for convergence on the last iteration)\n    r_final = compute_residual(x)\n    if np.linalg.norm(r_final) / norm_r0 = tol:\n        return max_iter\n\n    # If loop finishes without convergence\n    return max_iter + 1\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: (K0, beta, alpha, S, dt, l, sigma_app, e_n, p_n)\n        (1000.0, 0.0, 1.0, 1e-3, 1.0, 1e-2, 10.0, 0.0, 0.0),\n        # Case B\n        (1000.0, 5e5, 0.9, 1e-3, 1.0, 1e-2, 100.0, 0.0, 0.0),\n        # Case C\n        (1000.0, 1e6, 0.9, 1e-6, 5.0, 1e-1, 100.0, 0.0, 0.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract problem parameters and initial state from the case tuple\n        problem_params = params[:7]\n        initial_state = params[7:]\n\n        # Solve with the consistent tangent\n        iters_cons = newton_solver(problem_params, initial_state, use_consistent_tangent=True)\n        results.append(iters_cons)\n\n        # Solve with the inconsistent tangent\n        iters_incons = newton_solver(problem_params, initial_state, use_consistent_tangent=False)\n        results.append(iters_incons)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3508087"}]}