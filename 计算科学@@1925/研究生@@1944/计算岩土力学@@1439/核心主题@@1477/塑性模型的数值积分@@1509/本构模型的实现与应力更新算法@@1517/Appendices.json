{"hands_on_practices": [{"introduction": "要将弹塑性理论付诸实践，核心在于掌握应力更新算法。本练习将指导你完成一个基本但至关重要的任务：针对经典的 $J_2$ 塑性模型，手动执行径向回归算法 ([@problem_id:3531837])。通过这个计算，你将深入理解弹塑性预测-校正流程的每一步，为后续更复杂的模型实现奠定坚实基础。", "problem": "考虑一个不排水、各向同性、率无关的材料，在小应变单剪作用下的响应。该材料采用基于偏应力第二不变量（通常称为 $J_2$ 塑性）的 von Mises 塑性模型，并带有线性各向同性硬化。材料的弹性响应遵循线性各向同性弹性规律，其剪切模量为 $G$，体积模量足够大，以至于在该增量步内体积应变可以忽略不计。该塑性模型采用相关联流动法则和硬化定律 $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$，其中 $\\sigma_y$ 是当前屈服应力，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是线性各向同性硬化模量，$\\kappa$ 是等效塑性应变。屈服函数定义为 $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa)$，其中 $\\boldsymbol{s}$ 是 Cauchy 应力的偏量部分，且 $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$。塑性流动方向为 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，塑性应变增量采用后向欧拉时间离散化，因此 $\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\lambda\\, \\boldsymbol{n}_{n+1}$ 且 $\\kappa_{n+1} = \\kappa_n + \\sqrt{2/3}\\,\\Delta \\lambda$，其中 $\\Delta \\lambda \\ge 0$ 是塑性乘子。\n\n从状态 $n$ 到 $n+1$ 施加一个单个应变增量，其中只有工程剪切应变增量 $\\Delta \\gamma$ 非零，使得小应变张量增量满足 $\\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\Delta \\gamma/2$，而 $\\Delta \\boldsymbol{\\varepsilon}$ 的所有其他分量均为零。材料参数和初始条件如下：\n- 剪切模量 $G = 25$ MPa。\n- 初始屈服应力 $\\sigma_{y0} = 0.2$ MPa。\n- 线性各向同性硬化模量 $H = 5$ MPa。\n- 初始等效塑性应变 $\\kappa_n = 0$。\n- 初始应力 $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$ 及初始塑性应变 $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$。\n- 工程剪切应变增量 $\\Delta \\gamma = 0.03$。\n\n对此单剪增量步，使用后向欧拉积分实现径向返回应力更新。计算更新后的偏剪切应力分量 $s_{12,n+1}$（在纯剪切中，其值等于 Cauchy 剪切应力 $\\sigma_{12,n+1}$）和塑性乘子 $\\Delta \\lambda$。$s_{12,n+1}$ 以 MPa 为单位表示，$\\Delta \\lambda$ 为无量纲。将两个结果均四舍五入至五位有效数字。以行矩阵 $\\begin{pmatrix} s_{12,n+1}  \\Delta \\lambda \\end{pmatrix}$ 的形式提供最终数值。", "solution": "该问题经验证具有科学依据、是适定的、客观且完整的。这是一个计算塑性力学中的标准问题，可以使用指定的径向返回算法求解。我们开始进行求解。\n\n求解过程包含一个用于应力更新的标准的预测-校正算法。首先，一个弹性预测步假设整个应变增量是弹性的，从而计算出一个试探应力。其次，根据屈服准则检查该试探应力。如果表明发生屈服，则应用一个塑性校正步，将应力状态拉回到更新后的屈服面上。\n\n在增量步 $n$ 的初始状态由以下给出：\n初始应力：$\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$，这意味着偏应力也为零，即 $\\boldsymbol{s}_n = \\boldsymbol{0}$。\n初始等效塑性应变：$\\kappa_n = 0$。\n\n对于工程剪切应变增量 $\\Delta \\gamma = 0.03$ 的单剪情况，施加的应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 由其非零分量给出：\n$$ \\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\frac{\\Delta \\gamma}{2} = \\frac{0.03}{2} = 0.015 $$\n由于应变增量张量的迹 $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}) = \\Delta\\varepsilon_{11} + \\Delta\\varepsilon_{22} + \\Delta\\varepsilon_{33} = 0$，该应变增量是纯偏量的。\n\n**第 1 步：弹性预测**\n\n在预测步中，假设整个应变增量是弹性的，因此 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$ 且 $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon}$。在增量步 $n+1$ 的试探偏应力（记为 $\\boldsymbol{s}^{\\text{trial}}_{n+1}$）使用弹性本构律计算：\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon}^e = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon} $$\n由于 $\\boldsymbol{s}_n = \\boldsymbol{0}$ 且 $G=25$ MPa：\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = 2(25 \\text{ MPa}) \\Delta\\boldsymbol{\\varepsilon} = 50 \\Delta\\boldsymbol{\\varepsilon} $$\n试探偏应力的唯一非零分量是：\n$$ s^{\\text{trial}}_{12,n+1} = s^{\\text{trial}}_{21,n+1} = 50 \\times 0.015 = 0.75 \\text{ MPa} $$\n试探偏应力的范数计算如下 $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{s_{ij}s_{ij}}$：\n$$ \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| = \\sqrt{(s^{\\text{trial}}_{12,n+1})^2 + (s^{\\text{trial}}_{21,n+1})^2} = \\sqrt{(0.75)^2 + (0.75)^2} = \\sqrt{2 \\times (0.75)^2} = 0.75\\sqrt{2} \\text{ MPa} $$\n数值上，$\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| \\approx 1.06066$ MPa。\n\n**第 2 步：屈服检查**\n\n我们检查该试探应力状态是否位于由屈服函数 $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa) \\le 0$ 定义的弹性域之外。检查使用增量步开始时的屈服应力 $\\sigma_y(\\kappa_n)$ 进行。\n硬化定律为 $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$。由于 $\\kappa_n=0$，$\\sigma_{y0}=0.2$ MPa 且 $H=5$ MPa：\n$$ \\sigma_y(\\kappa_n) = \\sigma_y(0) = \\sigma_{y0} = 0.2 \\text{ MPa} $$\n屈服函数的试探值为：\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_n) = 0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2) \\text{ MPa} $$\n数值上，$f^{\\text{trial}} \\approx 1.06066 - 0.81650 \\times 0.2 \\approx 1.06066 - 0.16330 = 0.89736$ MPa。\n由于 $f^{\\text{trial}} > 0$，弹性预测值违反了屈服条件，需要进行塑性校正。\n\n**第 3 步：塑性校正（径向返回）**\n\n对于塑性加载，塑性乘子 $\\Delta \\lambda$ 必须大于零。对于后向欧拉积分方案，$\\Delta \\lambda$ 可由一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$ 求得。这导出了 $\\Delta \\lambda$ 的以下表达式：\n$$ \\Delta \\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\sigma_y(\\kappa_n)}{2G + \\frac{2}{3}H} $$\n代入给定值：\n$$ \\Delta \\lambda = \\frac{0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2)}{2(25) + \\frac{2}{3}(5)} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{50 + 10/3} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{160/3} $$\n数值上：\n$$ \\Delta \\lambda = \\frac{1.060660 - 0.163299}{53.333333} = \\frac{0.897361}{53.333333} = 0.0168255 $$\n四舍五入到五位有效数字，我们得到 $\\Delta \\lambda = 0.016826$。\n\n**第 4 步：应力更新**\n\n最终的偏应力 $\\boldsymbol{s}_{n+1}$ 是通过将试探应力径向拉回到扩展后的屈服面上得到的。返回映射方程为：\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\lambda \\boldsymbol{n}_{n+1} $$\n其中 $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}_{n+1}/\\|\\boldsymbol{s}_{n+1}\\|$。对于径向返回，最终应力的方向与试探应力的方向相同，因此 $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1}/\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$。\n分量 $s_{12,n+1}$ 为：\n$$ s_{12,n+1} = s^{\\text{trial}}_{12,n+1} - 2G\\Delta\\lambda \\frac{s^{\\text{trial}}_{12,n+1}}{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|} $$\n代入 $s^{\\text{trial}}_{12,n+1}$ 和 $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$ 的值：\n$$ s_{12,n+1} = 0.75 - 2(25)\\Delta\\lambda \\frac{0.75}{0.75\\sqrt{2}} = 0.75 - \\frac{50}{\\sqrt{2}}\\Delta\\lambda $$\n使用计算出的 $\\Delta\\lambda = 0.0168255...$ 的值：\n$$ s_{12,n+1} = 0.75 - \\frac{50}{\\sqrt{2}}(0.0168255) = 0.75 - (35.355339)(0.0168255) = 0.75 - 0.594865 = 0.155135 \\text{ MPa} $$\n四舍五入到五位有效数字，我们得到 $s_{12,n+1} = 0.15513$ MPa。由于问题从零应力状态开始，且应变增量是纯偏量的，因此平均应力保持为零，所以 $\\sigma_{12,n+1} = s_{12,n+1}$。\n\n最终要求的值是 $s_{12,n+1}$ 和 $\\Delta \\lambda$。\n- $s_{12,n+1} = 0.15513$ MPa\n- $\\Delta \\lambda = 0.016826$\n我们按要求将它们以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.15513  0.016826 \\end{pmatrix}}\n$$", "id": "3531837"}, {"introduction": "土体和岩体等岩土材料的显著特征之一是其极低的抗拉强度。为了在数值模拟中准确捕捉这一特性，我们必须引入“无拉伸”或“拉伸截断”准则 ([@problem_id:3531831])。本练习将引导你通过主应力空间中的谱分解和投影，实现一个高效的拉伸截断算法，这是处理岩土工程中开挖等卸载问题的关键技术。", "problem": "实现一个针对土体的小应变应力更新算法，该算法带有拉伸截断功能，以防止在卸载（例如，开挖）过程中出现伪拉应力。使用以下假设和要求来推导并实现该算法。\n\n假设与基本原理：\n- 采用标准的对称应变张量 $\\boldsymbol{\\varepsilon}$ 和 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 的小应变运动学。\n- 弹性预测部分采用各向同性线弹性模型，其杨氏模量为 $E$，泊松比为 $\\nu$。弹性刚度由 Lamé 参数 $\\lambda$ 和 $\\mu$ 定义，其中 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$，$\\mu = \\dfrac{E}{2(1+\\nu)}$，并且 $\\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$，$\\mathbf{I}$ 是二阶单位张量，$\\text{tr}(\\cdot)$ 是迹。\n- 采用拉应力为正、压应力为负的符号约定。\n- 将土体建模为无拉伸材料：在增量步结束时，更新后的应力必须位于容许集 $\\mathcal{K}$ 内，该集合由所有主应力均为非正值（即张量为负半定）的要求定义。\n\n任务：\n- 给定前一时间步的应力状态 $\\boldsymbol{\\sigma}_n$ 和规定的应变增量 $\\Delta \\boldsymbol{\\varepsilon}$，计算弹性试探应力\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathbb{C}$ 是由 $E$ 和 $\\nu$ 决定的四阶各向同性弹性张量。\n- 通过将 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 返回（投影）到容许集 $\\mathcal{K}$ 来强制执行拉伸截断。该投影方式需与能量最小化一致，且不产生拉伸主应力。将该返回过程表述为 Frobenius 范数下的最近点投影：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2.\n$$\n- 计算 $\\boldsymbol{\\sigma}_{n+1}$ 的三个主应力，并按降序排序。\n\n物理和数值单位：\n- 所有应力必须以千帕（kPa）为单位报告。\n- 本问题不涉及角度。\n- 最终答案以浮点数表示，单位为 kPa，并四舍五入到三位小数。\n\n测试套件：\n所有算例均使用 $E = 50\\,\\text{MPa}$ 和 $\\nu = 0.3$。对于各向同性状态，使用单位张量 $\\mathbf{I}$；对于剪切，使用标准小应变关系，其中工程剪应变 $\\gamma$ 对应于 $\\varepsilon_{12} = \\varepsilon_{21} = \\gamma/2$。\n\n定义以下四个测试算例，每个算例由 $(\\boldsymbol{\\sigma}_n, \\Delta \\boldsymbol{\\varepsilon})$ 指定：\n\n- 测试算例 1（压缩加载，弹性容许）：\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$。\n\n- 测试算例 2（开挖型卸载至受拉，需要截断）：\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$。\n\n- 测试算例 3（从零应力开始的純剪切，混合主应力状态，需要截断）：\n  - $\\boldsymbol{\\sigma}_n = \\mathbf{0}$，\n  - 在 $1$-$2$ 平面内的工程剪应变 $\\gamma = 10^{-4}$，即 $\\Delta \\boldsymbol{\\varepsilon}_{12} = \\Delta \\boldsymbol{\\varepsilon}_{21} = \\gamma/2$，其他分量为零。\n\n- 测试算例 4（达到截断面的边界情况）：\n  - $\\boldsymbol{\\sigma}_n = -50\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含一个长度为 $4$ 的列表（每个测试算例对应一项）。\n- 每个条目是一个包含 $\\boldsymbol{\\sigma}_{n+1}$ 三个主应力的列表，单位为 kPa，四舍五入到三位小数，并按降序排列。\n- 确切格式为单行形式，如\n  $$\n  [ [s_{1,1}, s_{1,2}, s_{1,3}], [s_{2,1}, s_{2,2}, s_{2,3}], [s_{3,1}, s_{3,2}, s_{3,3}], [s_{4,1}, s_{4,2}, s_{4,3}] ]\n  $$\n  以 Python 列表字面量的形式打印，不含任何额外文本。", "solution": "该问题要求为一个受拉伸截断条件约束的各向同性线弹性材料实现一个应力更新算法。这是计算塑性力学中的一个经典问题，具体来说是针对 Rankine 模型或无拉伸材料模型，该模型常用于模拟如土或岩石这类抗拉强度可忽略不计的岩土材料。解决方案将基于返回映射算法进行推导和实现，该算法通过在应力空间中的最近点投影来强制执行本构约束。拉应力取为正值。\n\n**1. 本构框架**\n\n材料行为由两个部分描述：\n-   **弹性**：由各向同性线弹性定律控制。应力张量 $\\boldsymbol{\\sigma}$ 通过 Hooke 定律与应变张量 $\\boldsymbol{\\varepsilon}$ 相关联，该定律可用 Lamé 参数 $\\lambda$ 和 $\\mu$ 表示：\n    $$\n    \\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}\n    $$\n    其中 $\\mathbf{I}$ 是二阶单位张量。材料参数 $E=50\\,\\text{MPa} = 50000\\,\\text{kPa}$ 和 $\\nu=0.3$ 可得出：\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)} = \\frac{50000\\,\\text{kPa}}{2(1+0.3)} = \\frac{25000}{1.3} = \\frac{250000}{13}\\,\\text{kPa} \\approx 19230.769\\,\\text{kPa}\n    $$\n    $$\n    \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\frac{50000\\,\\text{kPa} \\cdot 0.3}{(1+0.3)(1-2 \\cdot 0.3)} = \\frac{15000}{1.3 \\cdot 0.4} = \\frac{15000}{0.52} = \\frac{375000}{13}\\,\\text{kPa} \\approx 28846.154\\,\\text{kPa}\n    $$\n\n-   **拉伸截断**：材料不能承受拉应力。这被表述为对更新后应力张量 $\\boldsymbol{\\sigma}_{n+1}$ 的一个约束。其主应力（记为 $\\sigma_1, \\sigma_2, \\sigma_3$）必须全部为非正值。这定义了容许应力集 $\\mathcal{K}$：\n    $$\n    \\mathcal{K} = \\{ \\boldsymbol{\\sigma} \\in \\mathbb{S}^3 \\, | \\, \\sigma_i(\\boldsymbol{\\sigma}) \\le 0, \\forall i=1,2,3 \\}\n    $$\n    其中 $\\mathbb{S}^3$ 是三维对称二阶张量空间。\n\n**2. 返回映射算法**\n\n应力更新分两步执行：弹性预测步和塑性修正步（返回映射）。\n\n-   **弹性预测**：给定增量步开始时的应力状态 $\\boldsymbol{\\sigma}_n$ 和应变增量 $\\Delta\\boldsymbol{\\varepsilon}$，我们首先计算一个弹性试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$。此步骤假设材料在该增量步内的响应是纯弹性的：\n    $$\n    \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}_n + \\lambda \\, \\text{tr}(\\Delta \\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\Delta \\boldsymbol{\\varepsilon}\n    $$\n\n-   **塑性修正**：如果 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 违反了拉伸截断条件（即 $\\boldsymbol{\\sigma}^{\\text{tr}} \\notin \\mathcal{K}$），则必须将其“返回”或“投影”到容许集 $\\mathcal{K}$ 上。问题将此投影指定为在 Frobenius 范数下使距离最小化的投影，这是一个确保能量一致性的标准选择：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2\n    $$\n    这是将 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 投影到凸集 $\\mathcal{K}$ 上的最近点投影。\n\n**3. 谱投影**\n\n解决此最小化问题的关键在于谱分解。Frobenius 范数和容许性条件都是应力张量的各向同性函数，这意味着它们仅依赖于其主值（特征值），而与主方向（特征向量）无关。因此，投影后的应力 $\\boldsymbol{\\sigma}_{n+1}$ 与试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 具有相同的主方向。\n\n设试探应力的谱分解为：\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\sum_{i=1}^3 \\sigma_i^{\\text{tr}} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n其中 $\\sigma_i^{\\text{tr}}$ 是 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力，$\\mathbf{n}_i$ 是对应的标准正交主方向。更新后的应力 $\\boldsymbol{\\sigma}_{n+1}$ 具有以下形式：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\sum_{i=1}^3 \\sigma_{i, n+1} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n该优化问题解耦为三个针对主应力的独立一维问题：\n$$\n\\sigma_{i, n+1} = \\operatorname*{arg\\,min}_{\\sigma_i \\le 0} (\\sigma_i - \\sigma_i^{\\text{tr}})^2 \\quad \\text{for } i=1,2,3\n$$\n其解是对非正实数轴的简单投影：\n-   如果 $\\sigma_i^{\\text{tr}} \\le 0$，试探值已在容许域内，因此 $\\sigma_{i, n+1} = \\sigma_i^{\\text{tr}}$。\n-   如果 $\\sigma_i^{\\text{tr}}  0$，试探值不在容许域内，最近的容许点是 $0$，因此 $\\sigma_{i, n+1} = 0$。\n\n这可以紧凑地表示为：\n$$\n\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)\n$$\n\n**算法总结：**\n1.  对每个测试算例，根据给定的 $\\boldsymbol{\\sigma}_n$ 和 $\\Delta\\boldsymbol{\\varepsilon}$，计算试探应力张量 $\\boldsymbol{\\sigma}^{\\text{tr}}$。\n2.  计算 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力（特征值），记为 $\\{\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}\\}$。\n3.  对每个主试探应力应用拉伸截断：$\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)$。\n4.  集合 $\\{\\sigma_{1, n+1}, \\sigma_{2, n+1}, \\sigma_{3, n+1}\\}$ 构成了最终更新应力 $\\boldsymbol{\\sigma}_{n+1}$ 的主应力。\n5.  将这些最终主应力按降序排序，并四舍五入到三位小数。\n\n**测试算例计算：**\n\n**算例 1：** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$，$\\Delta\\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = -3 \\times 10^{-4}$。应力增量是各向同性的：$\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (-3 \\times 10^{-4}) + 2\\mu \\cdot (-10^{-4}))\\mathbf{I} = -12.5\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} - 12.5\\,\\mathbf{I} = -112.5\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力为 $\\{-112.5, -112.5, -112.5\\}$。所有主应力均 $\\le 0$，因此无需投影。\n最终主应力，按降序排列：$[-112.500, -112.500, -112.500]$。\n\n**算例 2：** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$，$\\Delta\\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 9 \\times 10^{-3}$。应力增量为 $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (9 \\times 10^{-3}) + 2\\mu \\cdot (3 \\times 10^{-3}))\\mathbf{I} = 375\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} + 375\\,\\mathbf{I} = 275\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力为 $\\{275, 275, 275\\}$。所有主应力均 $ 0$。\n投影后的主应力为：$\\{\\min(275, 0), \\min(275, 0), \\min(275, 0)\\} = \\{0, 0, 0\\}$。\n最终主应力，按降序排列：$[0.000, 0.000, 0.000]$。\n\n**算例 3：** $\\boldsymbol{\\sigma}_n = \\mathbf{0}$，纯剪切 $\\gamma=10^{-4}$\n$\\Delta\\varepsilon_{12} = \\Delta\\varepsilon_{21} = 0.5 \\times 10^{-4}$，其他分量为零。$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})=0$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = 2\\mu\\Delta\\boldsymbol{\\varepsilon}$。唯一的非零分量是 $\\sigma^{\\text{tr}}_{12} = \\sigma^{\\text{tr}}_{21} = 2\\mu \\Delta\\varepsilon_{12} = \\mu \\gamma = \\frac{250000}{13} \\cdot 10^{-4} = \\frac{25}{13} \\approx 1.923\\,\\text{kPa}$。\n此纯剪切状态的主应力为 $\\{ \\sigma^{\\text{tr}}_{12}, 0, -\\sigma^{\\text{tr}}_{12} \\} = \\{25/13, 0, -25/13\\}$。\n投影后的主应力为：$\\{\\min(25/13, 0), \\min(0, 0), \\min(-25/13, 0)\\} = \\{0, 0, -25/13\\}$。\n最终主应力，按降序排列：$[0.000, 0.000, -1.923]$。\n\n**算例 4：** $\\boldsymbol{\\sigma}_n = -50\\,\\mathbf{I}$，$\\Delta\\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 12 \\times 10^{-4}$。应力增量为 $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (12 \\times 10^{-4}) + 2\\mu \\cdot (4 \\times 10^{-4}))\\mathbf{I} = 50\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -50\\,\\mathbf{I} + 50\\,\\mathbf{I} = \\mathbf{0}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力为 $\\{0, 0, 0\\}$。所有主应力均 $\\le 0$。无需投影。\n最终主应力，按降序排列：$[0.000, 0.000, 0.000]$。", "answer": "[[ -112.500, -112.500, -112.500], [0.000, 0.000, 0.000], [0.000, 0.000, -1.923], [0.000, 0.000, 0.000]]", "id": "3531831"}, {"introduction": "一个成功的本构模型实现不仅需要算法的准确性，还需要保证数值计算的稳定性，尤其是在显式动力分析或高速加载问题中。本练习探讨了显式应力更新算法的稳定性条件，要求你从第一性原理出发，推导出一个安全的时间步长上限 ([@problem_id:3531860])。这个过程将揭示本构关系的数学属性（通过算法切线刚度）如何直接决定整个数值模拟方案的成败。", "problem": "考虑在恒定高应变率加载下，一个亚塑性砂土模型的二维平面应变应力更新。令柯西应力向量表示为 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^{\\mathsf{T}}$。该亚塑性模型给定的应力率形式为 $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{h}(\\boldsymbol{\\sigma}, \\dot{\\boldsymbol{\\varepsilon}}, \\rho)$，其中 $\\dot{\\boldsymbol{\\varepsilon}}$ 是应变率张量，$\\rho$ 是密度。在一个快速单调加载且时间步内 $\\dot{\\boldsymbol{\\varepsilon}}$ 近似恒定、密度变化可忽略不计的情况下，关于当前状态 $(\\boldsymbol{\\sigma}_{n}, \\dot{\\boldsymbol{\\varepsilon}})$ 的一阶线性化给出\n$$\n\\dot{\\boldsymbol{\\sigma}} \\approx \\boldsymbol{A}\\,\\boldsymbol{\\sigma} + \\boldsymbol{c},\n$$\n其中 $\\boldsymbol{A} \\in \\mathbb{R}^{3 \\times 3}$ 是算法切线矩阵（即应力率函数在当前状态下对应力的雅可比矩阵），其元素的单位为 $\\mathrm{s}^{-1}$，而 $\\boldsymbol{c}$ 是一个取决于 $\\dot{\\boldsymbol{\\varepsilon}}$ 和当前状态的常向量。\n\n一个显式前向欧拉应力更新的实现方式为\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n},\n$$\n其中时间步长 $\\Delta t > 0$ 为常数。为了评估在线性化齐次动力学（即忽略 $\\boldsymbol{c}$）下扰动增长的稳定性，从线性化系统的齐次部分 $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}$ 出发，推导关于 $\\Delta t$ 的条件，以确保显式更新不会放大 $\\boldsymbol{\\sigma}$ 的任何模态分量。\n\n对于平面应变条件下一个代表性的密实亚塑性砂土状态，算法切线矩阵由下式给出\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200  300  0 \\\\\n-500  -800  0 \\\\\n0  0  -1600\n\\end{pmatrix}\n\\quad \\text{其元素的单位为 } \\mathrm{s}^{-1}.\n$$\n仅使用线性系统显式时间积分的线性稳定性第一性原理，确定应用于上述矩阵 $\\boldsymbol{A}$ 的前向欧拉应力更新的最大稳定时间步长 $\\Delta t_{\\max}$。你的推导应从显式更新映射和 $\\boldsymbol{A}$ 的特征结构出发，并应考虑到由非对称切线矩阵产生的潜在复特征值。\n\n报告 $\\Delta t_{\\max}$ 的最终值，四舍五入到四位有效数字，并以秒为单位表示。", "solution": "本问题要求确定一个线性化亚塑性本构模型的前向欧拉应力更新的最大稳定时间步长 $\\Delta t_{\\max}$。该分析基于常微分方程组(ODEs)数值积分的线性稳定性原理。\n\n为进行稳定性分析，忽略常数项 $\\boldsymbol{c}$，应力状态的演化由以下齐次线性常微分方程组控制：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}\n$$\n使用显式前向欧拉法在时间步长 $\\Delta t$ 内对该系统进行积分。从时刻 $t_n$ 的状态 $\\boldsymbol{\\sigma}_n$ 到时刻 $t_{n+1} = t_n + \\Delta t$ 的状态 $\\boldsymbol{\\sigma}_{n+1}$ 的更新法则如下：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n}\n$$\n代入控制微分方程，我们得到：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t(\\boldsymbol{A}\\,\\boldsymbol{\\sigma}_{n}) = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\,\\boldsymbol{\\sigma}_{n}\n$$\n其中 $\\boldsymbol{I}$ 是 $3 \\times 3$ 单位矩阵。矩阵 $\\boldsymbol{G} = \\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A}$ 被称为放大矩阵，因为它将解从一个时间步映射到下一个时间步。\n\n为使数值格式稳定，任何初始扰动都不能在后续的时间步中被放大。这要求放大矩阵的谱半径 $\\rho(\\boldsymbol{G})$ 不大于1。谱半径是 $\\boldsymbol{G}$ 的特征值模的最大值：\n$$\n\\rho(\\boldsymbol{G}) = \\max_{k} |\\lambda_k(\\boldsymbol{G})| \\le 1\n$$\n设 $\\lambda_k$ 是矩阵 $\\boldsymbol{A}$ 的一个特征值，其对应的特征向量为 $\\boldsymbol{v}_k$。则有 $\\boldsymbol{A}\\boldsymbol{v}_k = \\lambda_k \\boldsymbol{v}_k$。$\\boldsymbol{G}$ 对 $\\boldsymbol{v}_k$ 的作用为：\n$$\n\\boldsymbol{G}\\boldsymbol{v}_k = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\boldsymbol{v}_k = \\boldsymbol{v}_k + \\Delta t(\\boldsymbol{A}\\boldsymbol{v}_k) = \\boldsymbol{v}_k + \\Delta t(\\lambda_k \\boldsymbol{v}_k) = (1 + \\Delta t\\,\\lambda_k)\\boldsymbol{v}_k\n$$\n这表明 $\\boldsymbol{G}$ 的特征值与 $\\boldsymbol{A}$ 的特征值通过 $\\lambda_k(\\boldsymbol{G}) = 1 + \\Delta t\\,\\lambda_k$ 相关联。因此，稳定性条件变为：\n$$\n|1 + \\Delta t\\,\\lambda_k| \\le 1 \\quad \\text{对 } \\boldsymbol{A} \\text{ 的所有特征值 } \\lambda_k \\text{ 成立}\n$$\n这个不等式定义了前向欧拉法的稳定域。对于复数 $z = \\Delta t\\,\\lambda_k$，该区域是复平面上以 $(-1, 0)$ 为中心、半径为 1 的圆盘。我们必须找到最大的 $\\Delta t > 0$，使得对于所有特征值 $\\lambda_k$，都有 $z_k = \\Delta t\\,\\lambda_k$ 位于此圆盘内。\n\n下一步是计算给定算法切线矩阵 $\\boldsymbol{A}$ 的特征值：\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200  300  0 \\\\\n-500  -800  0 \\\\\n0  0  -1600\n\\end{pmatrix}\n$$\n该矩阵是块对角的。一个特征值可以直接从右下角的 $1 \\times 1$ 块中读出：\n$$\n\\lambda_1 = -1600 \\, \\mathrm{s}^{-1}\n$$\n另外两个特征值由左上角的 $2 \\times 2$ 块确定：\n$$\n\\boldsymbol{A}_{sub} =\n\\begin{pmatrix}\n-1200  300 \\\\\n-500  -800\n\\end{pmatrix}\n$$\n特征方程为 $\\det(\\boldsymbol{A}_{sub} - \\lambda \\boldsymbol{I}) = 0$：\n$$\n(-1200 - \\lambda)(-800 - \\lambda) - (300)(-500) = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 960000 + 150000 = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 1110000 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{2000^2 - 4(1)(1110000)}}{2} = \\frac{-2000 \\pm \\sqrt{4000000 - 4440000}}{2}\n$$\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{-440000}}{2} = \\frac{-2000 \\pm 200i\\sqrt{11}}{2} = -1000 \\pm 100i\\sqrt{11} \\, \\mathrm{s}^{-1}\n$$\n现在我们将稳定性条件应用于每个特征值。\n\n对于实特征值 $\\lambda_1 = -1600$：\n条件是 $|1 + \\Delta t(-1600)| \\le 1$。由于 $\\lambda_1$ 的实部为负，这等价于 $\\Delta t \\le -2/\\lambda_1$。\n$$\n\\Delta t \\le \\frac{-2}{-1600} = \\frac{2}{1600} = \\frac{1}{800} \\, \\mathrm{s}\n$$\n\n对于共轭复特征值对 $\\lambda_{2,3} = -1000 \\pm 100i\\sqrt{11}$：\n令 $\\lambda = x+iy$，其中 $x = -1000$ 且 $y = \\pm 100\\sqrt{11}$。稳定性条件为 $\\Delta t \\le -2x/(x^2+y^2)$。\n我们计算 $x^2+y^2 = |\\lambda|^2$：\n$$\n|\\lambda|^2 = (-1000)^2 + (100\\sqrt{11})^2 = 1000000 + 10000 \\times 11 = 1110000\n$$\n对 $\\Delta t$ 的约束是：\n$$\n\\Delta t \\le \\frac{-2(-1000)}{1110000} = \\frac{2000}{1110000} = \\frac{2}{1110} = \\frac{1}{555} \\, \\mathrm{s}\n$$\n整体的最大稳定时间步长 $\\Delta t_{\\max}$ 必须同时满足所有特征值的条件。因此，$\\Delta t_{\\max}$ 是各个上限中的最小值：\n$$\n\\Delta t_{\\max} = \\min \\left(\\frac{1}{800}, \\frac{1}{555}\\right)\n$$\n为了比较这两个分数，我们比较它们的分母。因为 $800 > 555$，所以 $\\frac{1}{800}  \\frac{1}{555}$。因此，最严格的条件是由实特征值 $\\lambda_1$ 施加的。\n$$\n\\Delta t_{\\max} = \\frac{1}{800} \\, \\mathrm{s} = 0.00125 \\, \\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} = 0.001250 \\, \\mathrm{s}\n$$", "answer": "$$\\boxed{0.001250}$$", "id": "3531860"}]}