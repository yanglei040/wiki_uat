{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的练习开始。这个练习将带你逐步完成一个标准的返回映射算法，应用于经典的 von Mises 屈服准则和线性硬化模型。通过这个练习，你将亲手计算弹塑性更新中的所有关键量，包括塑性乘子和塑性应变增量，从而牢固掌握“弹性预测-塑性修正”这一核心思想。[@problem_id:3556863]", "problem": "一种小应变、各向同性、相关联的弹塑性材料遵循 von Mises 屈服条件和线性各向同性硬化。考虑一个单一的隐式时间步，其中总应变增量为纯剪切。本构成分如下：\n- 线性各向同性弹性，其杨氏模量为 $E$，泊松比为 $\\nu$，剪切模量 $G=E/[2(1+\\nu)]$，偏应力-应变关系为 $\\boldsymbol{s}=2G\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}-2G\\,\\boldsymbol{\\varepsilon}^{p}$。\n- von Mises 屈服函数 $f(\\boldsymbol{\\sigma},\\kappa)=\\|\\boldsymbol{s}\\|-\\sqrt{\\frac{2}{3}}\\,\\sigma_{y}(\\kappa)$，其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 且 $\\|\\boldsymbol{s}\\|=\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$。\n- 相关联塑性流动 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$，以及硬化变量更新 $\\Delta\\kappa=\\sqrt{\\frac{2}{3}}\\,\\Delta\\lambda$（等效塑性应变增量）。\n- 线性各向同性硬化 $\\sigma_{y}(\\kappa)=\\sigma_{y0}+H\\,\\kappa$。\n- 隐式最近点投影（回映算法），在塑性修正中强制执行一致性条件 $f_{n+1}=0$。\n\n设材料参数为 $E=210\\times 10^{9}$，$\\nu=0.30$，$\\sigma_{y0}=0.45\\times 10^{9}$，以及 $H=2.5\\times 10^{9}$，单位均为帕斯卡。假设上一步是无应力且未发生塑性变形的，即 $\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$，$\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$，且 $\\kappa_{n}=0$。施加一个纯剪切应变增量，其中小应变张量只有一个非零分量 $\\Delta\\varepsilon_{xy}=0.01$（根据对称性 $\\Delta\\varepsilon_{yx}=\\Delta\\varepsilon_{xy}$），且 $\\Delta\\boldsymbol{\\varepsilon}$ 的所有法向分量均为零。\n\n从这些基础和上述定义出发，执行弹性预测，然后通过最近点投影进行塑性修正。根据一致性条件推导塑性乘子 $\\Delta\\lambda$，计算更新后的塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$，并计算硬化增量 $\\Delta\\kappa$。验证更新后的屈服函数满足 $f_{n+1}=0$。\n\n将最终答案表示为一个单行矩阵，按顺序包含 $\\Delta\\lambda$、单个非零分量 $\\Delta\\varepsilon^{p}_{xy}$、$\\Delta\\kappa$ 和 $f_{n+1}$ 这四个量。除 $f_{n+1}$ 的单位为帕斯卡外，所有条目均为无量纲。在最终的方框答案中不要包含单位。无需四舍五入；尽可能提供精确的闭式表达式。", "solution": "该问题将通过遵循弹塑性隐式回映算法的标准两步过程来解决：弹性预测和塑性修正。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n-   **本构模型**：小应变、各向同性、相关联弹塑性，遵循 von Mises 屈服条件和线性各向同性硬化。\n-   **弹性特性**：杨氏模量 $E=210\\times 10^{9}$ Pa，泊松比 $\\nu=0.30$。\n-   **塑性特性**：初始屈服应力 $\\sigma_{y0}=0.45\\times 10^{9}$ Pa，硬化模量 $H=2.5\\times 10^{9}$ Pa。\n-   **屈服函数**：$f(\\boldsymbol{\\sigma},\\kappa)=\\|\\boldsymbol{s}\\|-\\sqrt{\\frac{2}{3}}\\,\\sigma_{y}(\\kappa)$，其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 且 $\\|\\boldsymbol{s}\\|=\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$。\n-   **硬化定律**：$\\sigma_{y}(\\kappa)=\\sigma_{y0}+H\\,\\kappa$。\n-   **流动法则**：相关联流动 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。\n-   **硬化变量更新**：$\\Delta\\kappa=\\sqrt{\\frac{2}{3}}\\,\\Delta\\lambda$。\n-   **初始条件（在步骤 n）**：$\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$，$\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$，且 $\\kappa_{n}=0$。\n-   **施加的应变增量**：纯剪切应变，其中小应变张量 $\\Delta\\boldsymbol{\\varepsilon}$ 的唯一非零分量为 $\\Delta\\varepsilon_{xy}=0.01$（根据对称性，$\\Delta\\varepsilon_{yx}=\\Delta\\varepsilon_{xy}$）。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。\n-   **科学合理性**：该问题描述了一个经典的 J2（von Mises）塑性模型，具有线性各向同性硬化，并使用隐式回映算法实现。这是计算固体力学和岩土力学中的一个基本和标准课题。所有方程和概念都基于已建立的连续介质力学原理。\n-   **适定性**：该问题提供了所有必要的材料参数、初始条件和施加的载荷（应变增量）。其结构是有限元分析中一个典型时间步的结构，预期会有一个唯一解。\n-   **客观性**：语言精确，量值定义正式。没有主观或模棱两可的陈述。\n-   **相关性**：该问题是*回映算法（最近点投影）*在一个标准岩土力学材料模型上的直接应用。\n\n**1.3. 结论与行动**\n该问题有效。将提供完整的解决方案。\n\n### 步骤 2：求解推导\n\n首先，我们计算必要的弹性常数。剪切模量 $G$ 由下式给出：\n$$G = \\frac{E}{2(1+\\nu)} = \\frac{210 \\times 10^9}{2(1+0.30)} = \\frac{210 \\times 10^9}{2.6} = \\frac{1050}{13} \\times 10^9 \\, \\text{Pa}$$\n\n施加的应变增量张量 $\\Delta\\boldsymbol{\\varepsilon}$ 只有一个独立的非零分量 $\\Delta\\varepsilon_{xy}=0.01$。以矩阵形式表示：\n$$ \\Delta\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0 & 0.01 & 0 \\\\ 0.01 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n应变增量的迹为 $\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 0$。这意味着应变增量是纯偏的，即 $\\Delta\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\Delta\\boldsymbol{\\varepsilon}$。\n\n**2.1. 弹性预测**\n\n在预测步中，我们假设材料响应是纯弹性的。通过假设塑性应变增量为零 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$ 来计算试探状态。\n试探应力增量由胡克定律计算。由于应变是纯偏的，应力响应也将是纯偏的。偏应力-应变关系为 $\\boldsymbol{s} = 2G \\boldsymbol{\\varepsilon}^{\\text{dev}}$。\n试探偏应力 $\\boldsymbol{s}^{\\text{trial}}$ 为：\n$$\\boldsymbol{s}^{\\text{trial}} = 2G \\Delta\\boldsymbol{\\varepsilon}^{\\text{dev}} = 2G \\Delta\\boldsymbol{\\varepsilon}$$\n由于 $\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$，总试探应力为 $\\boldsymbol{\\sigma}^{\\text{trial}} = \\boldsymbol{s}^{\\text{trial}}$。唯一的非零分量是：\n$$ s^{\\text{trial}}_{xy} = s^{\\text{trial}}_{yx} = 2G \\Delta\\varepsilon_{xy} = 2 \\left(\\frac{1050}{13} \\times 10^9 \\right) (0.01) = \\frac{21}{13} \\times 10^9 \\, \\text{Pa} $$\n接下来，我们计算 von Mises 等效应力，即偏应力张量的范数，$\\|\\boldsymbol{s}^{\\text{trial}}\\|=\\sqrt{\\boldsymbol{s}^{\\text{trial}}:\\boldsymbol{s}^{\\text{trial}}}$：\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| = \\sqrt{\\sum_{i,j} (s^{\\text{trial}}_{ij})^2} = \\sqrt{(s^{\\text{trial}}_{xy})^2 + (s^{\\text{trial}}_{yx})^2} = \\sqrt{2 (s^{\\text{trial}}_{xy})^2} = \\sqrt{2} |s^{\\text{trial}}_{xy}| $$\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| = \\sqrt{2} \\left(\\frac{21}{13} \\times 10^9\\right) = \\frac{21\\sqrt{2}}{13} \\times 10^9 \\, \\text{Pa} $$\n我们通过评估试探状态下的屈服函数来检查是否发生屈服。由于 $\\kappa_n=0$，屈服应力为 $\\sigma_y(\\kappa_n)=\\sigma_{y0}$。\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}} \\sigma_{y0} $$\n使用给定值 $\\sigma_{y0}=0.45\\times 10^{9} = \\frac{9}{20} \\times 10^{9}$ Pa：\n$$ \\sqrt{\\frac{2}{3}} \\sigma_{y0} = \\sqrt{\\frac{2}{3}} \\left( \\frac{9}{20} \\times 10^9 \\right) = \\frac{3\\sqrt{6}}{20} \\times 10^9 \\, \\text{Pa} $$\n数值上，$\\|\\boldsymbol{s}^{\\text{trial}}\\| \\approx 2.284 \\times 10^9$ Pa 且 $\\sqrt{2/3}\\,\\sigma_{y0} \\approx 0.367 \\times 10^9$ Pa。\n由于 $\\|\\boldsymbol{s}^{\\text{trial}}\\| > \\sqrt{2/3}\\,\\sigma_{y0}$，我们有 $f^{\\text{trial}} > 0$。试探状态在屈服面之外，因此发生了塑性变形，需要进行塑性修正。\n\n**2.2. 塑性修正**\n\n塑性修正步骤将试探应力投影回更新后的屈服面上。在步骤 $n+1$ 处的更新应力由下式给出：\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} - 2G \\Delta\\boldsymbol{\\varepsilon}^p $$\n相关联流动法则是 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。对于 von Mises 屈服函数，这个导数是屈服面的单位法向量：\n$$ \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|} = \\boldsymbol{N} $$\n最近点投影算法表明塑性回映的方向是径向的，因此 $\\boldsymbol{N}_{n+1} = \\boldsymbol{N}^{\\text{trial}} = \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}$。于是：\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} - 2G \\Delta\\lambda \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|} = \\left(1 - \\frac{2G \\Delta\\lambda}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}\\right) \\boldsymbol{s}^{\\text{trial}} $$\n对该方程取范数可得：\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\|\\boldsymbol{s}^{\\text{trial}}\\| - 2G \\Delta\\lambda $$\n步骤 $n+1$ 处的一致性条件要求 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$，这意味着：\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_{n+1}) $$\n使用线性硬化定律 $\\sigma_y(\\kappa_{n+1}) = \\sigma_{y0} + H\\kappa_{n+1}$ 和硬化变量更新 $\\kappa_{n+1} = \\kappa_n + \\Delta\\kappa = 0 + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$，我们有：\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H\\sqrt{\\frac{2}{3}}\\Delta\\lambda \\right) = \\sqrt{\\frac{2}{3}}\\sigma_{y0} + \\frac{2}{3}H\\Delta\\lambda $$\n令 $\\|\\boldsymbol{s}_{n+1}\\|$ 的两个表达式相等，可以解出塑性乘子 $\\Delta\\lambda$：\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| - 2G \\Delta\\lambda = \\sqrt{\\frac{2}{3}}\\sigma_{y0} + \\frac{2}{3}H\\Delta\\lambda $$\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y0} = \\left( 2G + \\frac{2}{3}H \\right) \\Delta\\lambda $$\n左侧是试探屈服函数 $f^{\\text{trial}}$。所以，\n$$ \\Delta\\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y0}}{2G + \\frac{2}{3}H} $$\n现在我们代入数值的精确形式。\n分子：$f^{\\text{trial}} = \\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) \\times 10^9$ Pa。\n分母：使用 $H=2.5 \\times 10^9 = \\frac{5}{2} \\times 10^9$ Pa，\n$$ 2G + \\frac{2}{3}H = \\left( 2 \\cdot \\frac{1050}{13} + \\frac{2}{3} \\cdot \\frac{5}{2} \\right) \\times 10^9 = \\left( \\frac{2100}{13} + \\frac{5}{3} \\right) \\times 10^9 = \\left( \\frac{6300+65}{39} \\right) \\times 10^9 = \\frac{6365}{39} \\times 10^9 \\, \\text{Pa} $$\n现在，我们计算 $\\Delta\\lambda$：\n$$ \\Delta\\lambda = \\frac{\\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) \\times 10^9}{\\frac{6365}{39} \\times 10^9} = \\frac{39}{6365} \\left( \\frac{420\\sqrt{2} - 39\\sqrt{6}}{260} \\right) $$\n这个表达式很复杂。一个更直接的路径是：\n$$ \\Delta\\lambda = \\frac{39}{6365} \\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) = \\frac{3 \\cdot 21\\sqrt{2}}{6365} - \\frac{39 \\cdot 3\\sqrt{6}}{6365 \\cdot 20} = \\frac{63\\sqrt{2}}{6365} - \\frac{117\\sqrt{6}}{127300} $$\n创建一个公分母 $127300$：\n$$ \\Delta\\lambda = \\frac{20 \\cdot 63\\sqrt{2} - 117\\sqrt{6}}{127300} = \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} $$\n\n**2.3. 计算最终量**\n有了 $\\Delta\\lambda$，我们就可以求出其他要求的量。\n\n**塑性应变增量分量 $\\Delta\\varepsilon^{p}_{xy}$**：\n塑性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda \\boldsymbol{N}^{\\text{trial}} = \\Delta\\lambda \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}$。\n$$ \\boldsymbol{N}^{\\text{trial}} = \\frac{1}{\\sqrt{2}s^{\\text{trial}}_{xy}} \\begin{pmatrix} 0 & s^{\\text{trial}}_{xy} & 0 \\\\ s^{\\text{trial}}_{xy} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n所求的分量是：\n$$ \\Delta\\varepsilon^{p}_{xy} = \\Delta\\lambda \\frac{1}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}} \\left( \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} \\right) = \\frac{1260 - 117\\sqrt{3}}{127300} $$\n\n**硬化增量 $\\Delta\\kappa$**：\n更新由 $\\Delta\\kappa = \\sqrt{\\frac{2}{3}}\\Delta\\lambda$ 给出。\n$$ \\Delta\\kappa = \\sqrt{\\frac{2}{3}} \\left( \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} \\right) = \\frac{\\sqrt{2}}{\\sqrt{3}} \\frac{1260\\sqrt{2} - 117\\sqrt{3 \\cdot 2}}{127300} = \\frac{2520 - 117\\sqrt{2}\\sqrt{2}\\sqrt{3}}{127300\\sqrt{3}} $$\n$$ \\Delta\\kappa = \\frac{2520 - 234\\sqrt{3}}{127300\\sqrt{3}} = \\frac{\\sqrt{3}(2520 - 234\\sqrt{3})}{381900} = \\frac{2520\\sqrt{3} - 702}{381900} $$\n通过将分子和分母除以公因子（$2\\cdot3=6$）来简化：\n$$ \\Delta\\kappa = \\frac{420\\sqrt{3} - 117}{63650} $$\n\n**屈服条件 $f_{n+1}$ 的验证**：\n塑性乘子 $\\Delta\\lambda$ 是专门为满足一致性条件 $f_{n+1}=0$ 而推导的。根据构造，将推导出的 $\\Delta\\lambda$ 代回 $\\|\\boldsymbol{s}_{n+1}\\|$ 和 $\\sigma_y(\\kappa_{n+1})$ 的方程中，将得到 $\\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{2/3} \\sigma_y(\\kappa_{n+1})$。因此，$f_{n+1} = 0$ 必须精确成立。\n\n**结果总结**：\n1.  $\\Delta\\lambda = \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300}$\n2.  $\\Delta\\varepsilon^{p}_{xy} = \\frac{1260 - 117\\sqrt{3}}{127300}$\n3.  $\\Delta\\kappa = \\frac{420\\sqrt{3} - 117}{63650}$\n4.  $f_{n+1} = 0$\n\n这些表达式是精确的，不能进一步简化。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} & \\frac{1260 - 117\\sqrt{3}}{127300} & \\frac{420\\sqrt{3} - 117}{63650} & 0\n\\end{pmatrix}\n}\n$$", "id": "3556863"}, {"introduction": "在掌握了 J2 塑性的基本流程后，我们转向更符合岩土材料特性的压力相关模型，如 Drucker–Prager 模型。这个练习的重点是返回映射在平均应力 ($p$) 和偏应力 ($q$) 空间中的几何解释。你將推导出非关联流动法则下应力修正路径的性质，这对于直观理解土力学中常见的塑性剪胀或剪缩行为至关重要。[@problem_id:3556917]", "problem": "考虑一个处于三轴类应力状态下的小应变各向同性弹塑性土，其特征在于应力不变量 $p = \\tfrac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\sigma}$ 和 $q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$，其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$ 是偏应力。设弹性响应为线性各向同性，体积模量为 $K$，剪切模量为 $G$。塑性模型由一个屈服函数 $f(p,q;H)=0$ 和一个（可能非相关的）塑性势 $g(p,q)$ 定义，其增量塑性流动法则（Prandtl–Reuss 型）为 $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\partial g/\\partial \\boldsymbol{\\sigma}$，其中 $d\\lambda \\ge 0$ 是塑性乘子。标量塑性应变不变量为 $d\\varepsilon_{v}^{p} = \\mathrm{tr}\\,d\\boldsymbol{\\varepsilon}^{p}$ 和 $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$，其中 $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^{p} - \\tfrac{1}{3}d\\varepsilon_{v}^{p}\\boldsymbol{I}$。\n\n假设一个 Drucker–Prager 型屈服面 $f(p,q;H) = q + M\\,p - \\sigma_{y}(H)$（其中 $M>0$），以及一个非相关的线性塑性势 $g(p,q) = q + m\\,p$（其中 $m \\neq M$）。考虑一个位于屈服面外的试探状态 $(p_{\\mathrm{tr}},q_{\\mathrm{tr}})$，即 $f(p_{\\mathrm{tr}},q_{\\mathrm{tr}};H)>0$。一个单步回归映射修正步骤将应力通过 $\\Delta\\boldsymbol{\\sigma}$ 调整到一个满足 $f(p,q;H)=0$ 的状态 $(p,q)$，同时在修正过程中保持总应变不变。\n\n仅使用标准的小应变运动学、给定的弹性模量以及不变量和流动法则的定义（不使用其他专门公式），完成以下任务：\n\n1) 推导 $(p,q)$ 平面中应力修正量的方向，并证明当 $g\\neq f$ 时，$(p,q)$ 空间中的投影路径与屈服面的欧几里得法线是斜交的。具体来说，用 $K$、$G$ 以及偏导数 $\\partial g/\\partial p$ 和 $\\partial g/\\partial q$ 表示比值 $\\Delta q / \\Delta p$，并将其与 $f(p,q;H)=0$ 的欧几里得法线的分量进行比较。\n\n2) 对于给定的塑性势 $g(p,q) = q + m\\,p$，使用张量形式的流动法则和不变量的定义，计算塑性体积应变增量 $\\Delta \\varepsilon_{v}^{p}$ 和等效剪切应变增量 $\\Delta \\varepsilon_{s}^{p}$，并用塑性乘子增量 $\\Delta \\lambda$ 表示。\n\n将您的最终答案表示为包含 $\\Delta \\varepsilon_{v}^{p}$ 和 $\\Delta \\varepsilon_{s}^{p}$ 的单行矩阵。不需要数值。最终答案中不要包含单位。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 应力不变量：$p = \\tfrac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\sigma}$ 和 $q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$。\n- 偏应力：$\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$。\n- 弹性响应：线性各向同性，体积模量为 $K$，剪切模量为 $G$。\n- 塑性模型：屈服函数 $f(p,q;H)=0$，塑性势 $g(p,q)$。\n- 流动法则：$d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\partial g/\\partial \\boldsymbol{\\sigma}$，其中 $d\\lambda \\ge 0$。\n- 塑性应变不变量：$d\\varepsilon_{v}^{p} = \\mathrm{tr}\\,d\\boldsymbol{\\varepsilon}^{p}$ 和 $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$。\n- 偏塑性应变增量：$d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^{p} - \\tfrac{1}{3}d\\varepsilon_{v}^{p}\\boldsymbol{I}$。\n- 屈服函数：$f(p,q;H) = q + M\\,p - \\sigma_{y}(H)$，其中 $M>0$。\n- 塑性势：$g(p,q) = q + m\\,p$，其中 $m \\neq M$。\n- 试探状态：$(p_{\\mathrm{tr}},q_{\\mathrm{tr}})$ 位于屈服面外，$f(p_{\\mathrm{tr}},q_{\\mathrm{tr}};H)>0$。\n- 修正步骤：总应变保持不变，即总应变增量 $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{0}$。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述与计算岩土力学中使用的标准率无关小应变弹塑性理论一致。所有给定的定义，如应力不变量、流动法则以及 Drucker-Prager 屈服函数和塑性势的具体形式，都是该领域的标准内容。该任务涉及在这一已建立的框架内推导关系，这是一个可形式化且适定的科学问题。语言客观、精确。未检测到与科学合理性、完整性、客观性或可验证性相关的缺陷。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n---\n\n根据要求，解答分为两部分。\n\n### 第1部分：应力修正量的方向\n\n回归映射修正步骤在总应变恒定的条件下执行。这意味着总应变增量为零：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\mathbf{0}\n$$\n总应变增量是弹性和塑性增量之和：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{e} + \\Delta\\boldsymbol{\\varepsilon}^{p} = \\mathbf{0} \\implies \\Delta\\boldsymbol{\\varepsilon}^{e} = -\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n增量弹性应力-应变关系为 $\\Delta\\boldsymbol{\\sigma} = \\boldsymbol{C}^{e} : \\Delta\\boldsymbol{\\varepsilon}^{e}$，其中 $\\boldsymbol{C}^{e}$ 是各向同性弹性刚度张量。因此，应力修正量 $\\Delta\\boldsymbol{\\sigma}$ 为：\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\boldsymbol{C}^{e} : \\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n塑性应变增量由流动法则给出：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\n$$\n其中 $\\Delta\\lambda$ 是该步骤的有限塑性乘子增量。塑性势 $g$ 是应力不变量 $p$ 和 $q$ 的函数。使用链式法则，我们可以写出：\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial q}\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}\n$$\n不变量对应力张量 $\\boldsymbol{\\sigma}$ 的导数为：\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\boldsymbol{I} \\quad \\text{和} \\quad \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量，$\\boldsymbol{s}$ 是偏应力张量。\n因此，塑性流动方向张量为：\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\n$$\n那么应力修正量为：\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\Delta\\lambda\\,\\boldsymbol{C}^{e} : \\left( \\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s} \\right)\n$$\n对于各向同性弹性材料，$\\boldsymbol{C}^e$ 对二阶张量的作用可以使用体积模量 $K$ 和剪切模量 $G$ 表示为 $\\boldsymbol{C}^e : \\boldsymbol{I} = 3K \\cdot \\frac{1}{3}\\boldsymbol{I} = K\\boldsymbol{I}$ 和 $\\boldsymbol{C}^e : \\boldsymbol{s} = 2G\\boldsymbol{s}$。将这些代入 $\\Delta\\boldsymbol{\\sigma}$ 的表达式中，得出：\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\Delta\\lambda \\left( \\frac{\\partial g}{\\partial p} K\\boldsymbol{I} + \\frac{\\partial g}{\\partial q} \\frac{3}{2q} (2G\\boldsymbol{s}) \\right) = -\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\n$$\n平均应力的变化 $\\Delta p$ 是 $\\Delta\\boldsymbol{\\sigma}$ 的迹的三分之一：\n$$\n\\Delta p = \\frac{1}{3}\\mathrm{tr}(\\Delta\\boldsymbol{\\sigma}) = \\frac{1}{3}\\mathrm{tr}\\left[-\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\\right]\n$$\n因为 $\\mathrm{tr}(\\boldsymbol{I})=3$ 且 $\\mathrm{tr}(\\boldsymbol{s})=0$，该式简化为：\n$$\n\\Delta p = -\\frac{\\Delta\\lambda}{3} \\left( K \\frac{\\partial g}{\\partial p} \\cdot 3 \\right) = -K \\Delta\\lambda \\frac{\\partial g}{\\partial p}\n$$\n偏应力的变化 $\\Delta \\boldsymbol{s}$ 可通过从总应力变化中减去静水压力部分得到：$\\Delta \\boldsymbol{s} = \\Delta\\boldsymbol{\\sigma} - \\Delta p \\boldsymbol{I}$。\n$$\n\\Delta\\boldsymbol{s} = \\left[-\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\\right] - \\left(-K \\Delta\\lambda \\frac{\\partial g}{\\partial p}\\right)\\boldsymbol{I} = -\\Delta\\lambda \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s}\n$$\n偏应力不变量的变化 $\\Delta q$ 对于一个小步长可以近似为 $dq = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} : d\\boldsymbol{\\sigma} = \\frac{3}{2q}\\boldsymbol{s} : d\\boldsymbol{\\sigma}$。$d\\boldsymbol{\\sigma}$ 的偏量部分是 $d\\boldsymbol{s}$，所以 $dq = \\frac{3}{2q}\\boldsymbol{s} : d\\boldsymbol{s}$。将此应用于有限增量：\n$$\n\\Delta q \\approx \\frac{3}{2q}\\boldsymbol{s} : \\Delta\\boldsymbol{s} = \\frac{3}{2q}\\boldsymbol{s} : \\left(-\\Delta\\lambda \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s}\\right) = -\\frac{9G\\Delta\\lambda}{2q^2} \\frac{\\partial g}{\\partial q} (\\boldsymbol{s}:\\boldsymbol{s})\n$$\n使用定义 $q^2 = \\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}$，我们有 $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^2$。代入此式：\n$$\n\\Delta q = -\\frac{9G\\Delta\\lambda}{2q^2} \\frac{\\partial g}{\\partial q} \\left(\\frac{2}{3}q^2\\right) = -3G \\Delta\\lambda \\frac{\\partial g}{\\partial q}\n$$\n比值 $\\Delta q / \\Delta p$ 定义了 $(p,q)$ 平面中应力修正路径的斜率：\n$$\n\\frac{\\Delta q}{\\Delta p} = \\frac{-3G \\Delta\\lambda \\frac{\\partial g}{\\partial q}}{-K \\Delta\\lambda \\frac{\\partial g}{\\partial p}} = \\frac{3G}{K} \\frac{\\partial g / \\partial q}{\\partial g / \\partial p}\n$$\n屈服面 $f(p,q;H) = q + M p - \\sigma_y(H) = 0$ 的欧几里得法线由梯度向量 $\\nabla f = (\\frac{\\partial f}{\\partial p}, \\frac{\\partial f}{\\partial q}) = (M, 1)$ 给出。在 $(p,q)$ 平面中，法线方向的斜率为 $\\frac{1}{M}$。\n\n如果应力修正路径的斜率等于法线的斜率，则应力修正方向 $(\\Delta p, \\Delta q)$ 垂直于屈服面：\n$$\n\\frac{\\Delta q}{\\Delta p} = \\frac{1}{M} \\implies \\frac{3G}{K} \\frac{\\partial g / \\partial q}{\\partial g / \\partial p} = \\frac{1}{M}\n$$\n对于给定的塑性势 $g(p,q)=q+mp$，我们有 $\\partial g/\\partial p = m$ 和 $\\partial g/\\partial q = 1$。垂直条件变为：\n$$\n\\frac{3G}{K} \\frac{1}{m} = \\frac{1}{M} \\implies 3GM = Km\n$$\n问题指定了非相关流动法则，意味着 $m \\neq M$。此外，条件 $3G=K$ 是一个特定的材料属性关系，通常不成立。因此，条件 $3GM=Km$ 通常不满足。这表明对于非相关流动法则，$(p,q)$ 空间中的回归路径与屈服面的欧几里得法线是斜交的。\n\n### 第2部分：塑性应变增量\n\n我们需要计算塑性体积应变增量 $\\Delta \\varepsilon_{v}^{p}$ 和等效塑性剪切应变增量 $\\Delta \\varepsilon_{s}^{p}$。\n\n塑性体积应变增量定义为 $d\\varepsilon_{v}^{p} = \\mathrm{tr}(d\\boldsymbol{\\varepsilon}^{p})$。使用流动法则：\n$$\nd\\varepsilon_{v}^{p} = \\mathrm{tr}\\left(d\\lambda\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\right) = d\\lambda\\,\\mathrm{tr}\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right)\n$$\n$$\nd\\varepsilon_{v}^{p} = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{I}) + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\mathrm{tr}(\\boldsymbol{s})\\right) = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{3}{3} + 0\\right) = d\\lambda\\,\\frac{\\partial g}{\\partial p}\n$$\n对于给定的塑性势 $g(p,q) = q+mp$，我们有 $\\partial g/\\partial p = m$。因此，对于一个有限增量 $\\Delta\\lambda$：\n$$\n\\Delta \\varepsilon_{v}^{p} = m\\,\\Delta\\lambda\n$$\n等效塑性剪切应变增量为 $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$。首先，我们求出偏塑性应变增量 $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^p - \\tfrac{1}{3}d\\varepsilon_v^p\\boldsymbol{I}$：\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) - \\frac{1}{3}\\left(d\\lambda\\frac{\\partial g}{\\partial p}\\right)\\boldsymbol{I} = d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\n$$\n现在我们计算内积 $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}$：\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = \\left(d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) : \\left(d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{9}{4q^2} (\\boldsymbol{s}:\\boldsymbol{s})\n$$\n代入 $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^2$：\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{9}{4q^2} \\left(\\frac{2}{3}q^2\\right) = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{3}{2}\n$$\n最后，我们计算 $d\\varepsilon_{s}^{p}$：\n$$\nd\\varepsilon_{s}^{p} = \\sqrt{\\frac{2}{3}\\left[(d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{3}{2}\\right]} = \\sqrt{(d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2} = d\\lambda \\left|\\frac{\\partial g}{\\partial q}\\right|\n$$\n对于给定的塑性势 $g(p,q) = q+mp$，我们有 $\\partial g/\\partial q = 1$。因此，对于一个有限增量 $\\Delta\\lambda$：\n$$\n\\Delta\\varepsilon_{s}^{p} = \\Delta\\lambda\\,|1| = \\Delta\\lambda\n$$\n所求的两个量是 $\\Delta \\varepsilon_{v}^{p} = m\\,\\Delta\\lambda$ 和 $\\Delta \\varepsilon_{s}^{p} = \\Delta\\lambda$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nm\\,\\Delta\\lambda & \\Delta\\lambda\n\\end{pmatrix}\n}\n$$", "id": "3556917"}, {"introduction": "最后，我们将理论付诸实践，挑战一个更接近真实工程计算的编程任务。许多岩土模型（如带拉伸截止的 Mohr-Coulomb 模型）涉及多个屈服面，这要求算法能够智能地选择和更新“活动”的屈服面。这个练习将指导你设计并实现一个处理多面屈服面的“活动集”算法，将前面学到的概念整合成一个强大的计算工具。[@problem_id:3556874]", "problem": "考虑一个材料点层面上的小应变、率无关、相关联的多面塑性模型。应力矢量表示为 $\\boldsymbol{\\sigma} \\in \\mathbb{R}^n$，弹性刚度张量（此处以 Voigt 标记法表示为对称正定矩阵）表示为 $\\mathbf{C} \\in \\mathbb{R}^{n \\times n}$，屈服函数集合表示为 $\\{f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha})\\}_{i=1}^m$。内变量统一表示为 $\\boldsymbol{\\alpha}$。容许集定义为与各屈服函数相关的弹性域的交集，即 $\\mathcal{F} := \\{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n \\mid f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0 \\ \\text{for all} \\ i=1,\\dots,m\\}$。对于此计算任务，假设为理想塑性（无硬化），并考虑形式为 $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$ 的线性多面屈服函数，其中 $\\boldsymbol{a}_i \\in \\mathbb{R}^n$ 且 $c_i \\in \\mathbb{R}$。\n\n从微小应变线性弹性和带有关联塑性法向流动法则的基本原理出发，对于给定的弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，局部更新问题被定义为最近点投影问题：\n$$\n\\min_{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n} \\ \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}})^\\top \\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) \\quad \\text{subject to} \\quad f_i(\\boldsymbol{\\sigma}) \\le 0 \\quad \\text{for all} \\ i=1,\\dots,m.\n$$\nKarush–Kuhn–Tucker (KKT) 条件要求满足平稳性、原始可行性、对偶可行性和互补松弛性。算法设计必须选择并更新一个约束激活集，其等式定义了当前的投影，并且必须移除任何导致 KKT 条件中出现负塑性乘子的约束。\n\n您的任务是：\n- 从小应变线性弹性、关联塑性的法向流动法则以及 Kuhn–Tucker 条件的基本原理出发，构建局部问题。将该公式应用于理想塑性下的多面体情况 $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$，以获得一个可解的带线性不等式约束的二次规划问题。\n- 为最近点投影设计一个激活集选择方案，该方案：\n  1. 从弹性试探状态开始，\n  2. 检测违反屈服约束的情况，\n  3. 针对候选激活集求解简化的 KKT 系统，\n  4. 移除带有负拉格朗日乘子的约束，\n  5. 添加最严重违反的非激活约束，直到所有约束都得到满足且所有激活乘子均为非负。\n- 实现一个完整的程序，对于下面提供的每个测试用例，计算求解局部问题的投影应力 $\\boldsymbol{\\sigma}$，并返回收敛时的激活集索引（使用基于 1 的索引）。\n\n所有应力必须以帕斯卡（$\\mathrm{Pa}$）表示。不涉及角度。最终程序输出格式必须是单行文本，包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表，其中每个测试用例的结果是一个形如 $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$ 的列表，应力分量的单位为 $\\mathrm{Pa}$，激活索引为整数。\n\n使用 $n = 3$ 和以下测试套件。对于每个用例，使用指定的弹性刚度 $\\mathbf{C}$、屈服面法线 $\\boldsymbol{a}_i$、阈值 $c_i$ 和弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$：\n\n- 情况 1（理想路径，弹性）：\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [8.0\\times 10^7,9.0\\times 10^7,5.0\\times 10^7]^\\top$。\n\n- 情况 2（单一激活约束）：\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.5\\times 10^8,1.0\\times 10^8,4.0\\times 10^7]^\\top$。\n\n- 情况 3（多个激活约束）：\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.7\\times 10^8,1.5\\times 10^8,7.0\\times 10^7]^\\top$。\n\n- 情况 4（边界条件，零塑性修正）：\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.0\\times 10^8,9.0\\times 10^7,6.0\\times 10^7]^\\top$。\n\n- 情况 5（仅斜面激活）：\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [2.5\\times 10^8,2.5\\times 10^8,2.0\\times 10^7]^\\top$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表用方括号括起来，其中每个元素对应一个测试用例，并且本身是一个形式为 $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$ 的列表，应力单位为 $\\mathrm{Pa}$，激活索引为整数。", "solution": "关联多面塑性的局部应力更新可以从基本原理推导得出。在小应变线性弹性理论中，给定弹性刚度 $\\mathbf{C}$，弹性预测（试探）应力计算为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon}_n + \\Delta \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^p_n)$，其中 $\\boldsymbol{\\varepsilon}_n$ 是增量开始时的应变，$\\Delta \\boldsymbol{\\varepsilon}$ 是应变增量，$\\boldsymbol{\\varepsilon}^p_n$ 是增量开始时的塑性应变。如果 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 违反一个或多个屈服约束，则需要进行塑性修正。\n\n在关联塑性中，塑性流动方向由法向流动法则决定：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p = \\sum_{i=1}^m \\dot{\\lambda}_i \\frac{\\partial f_i}{\\partial \\boldsymbol{\\sigma}},\n$$\n其中 $\\dot{\\lambda}_i \\ge 0$ 是塑性乘子，而 $f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0$ 是屈服函数。Kuhn–Tucker 条件强制要求\n$$\n\\dot{\\lambda}_i \\ge 0,\\quad f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0,\\quad \\dot{\\lambda}_i \\, f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) = 0,\n$$\n确保塑性流动仅在屈服函数被激活且紧绷时发生。对于一个时间步内的率无关理想塑性，可以将增量更新表述为一个变分不等式，或等价地，一个投影问题：在由 $\\mathbf{C}^{-1}$ 诱导的度量下，找到最接近弹性预测值 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 的应力 $\\boldsymbol{\\sigma}$，并满足屈服约束。\n\n这引出了最近点投影问题：\n$$\n\\min_{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n} \\ \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}})^\\top \\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) \\quad \\text{s.t.} \\quad f_i(\\boldsymbol{\\sigma}) \\le 0 \\ \\forall i.\n$$\n对于线性多面屈服函数 $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$，约束定义了一个凸多面体（半空间的交集），且由于 $\\mathbf{C}$ 的正定性，目标函数是严格凸的。此二次规划问题的 KKT 条件为：\n- 平稳性：\n$$\n\\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) + \\sum_{i=1}^m \\lambda_i \\boldsymbol{a}_i = \\boldsymbol{0},\n$$\n其中 $\\lambda_i \\ge 0$ 是拉格朗日乘子。\n- 原始可行性：对所有 $i$，有 $f_i(\\boldsymbol{\\sigma}) \\le 0$。\n- 对偶可行性：对所有 $i$，有 $\\lambda_i \\ge 0$。\n- 互补松弛性：对所有 $i$，有 $\\lambda_i f_i(\\boldsymbol{\\sigma}) = 0$。\n\n从平稳性条件可得\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\sum_{i=1}^m \\lambda_i \\boldsymbol{a}_i.\n$$\n令 $\\mathcal{A} \\subset \\{1,\\dots,m\\}$ 表示激活集（紧绷的约束）。对于 $j \\in \\mathcal{A}$，我们施加 $\\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma} - c_j = 0$。代入平稳性表达式，得到关于激活乘子的线性系统：\n$$\n\\sum_{k \\in \\mathcal{A}} \\left(\\boldsymbol{a}_j^\\top \\mathbf{C} \\boldsymbol{a}_k \\right) \\lambda_k = \\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma}^{\\mathrm{tr}} - c_j, \\quad \\text{for all} \\ j \\in \\mathcal{A}.\n$$\n在矩阵形式中，如果 $\\mathbf{A}_{\\mathcal{A}}$ 按列收集激活的法线，则格拉姆矩阵 $\\mathbf{G}_{\\mathcal{A}}$ 的元素为 $G_{jk} = \\boldsymbol{a}_j^\\top \\mathbf{C} \\boldsymbol{a}_k$，右侧项为 $r_j = \\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma}^{\\mathrm{tr}} - c_j$。求解 $\\mathbf{G}_{\\mathcal{A}} \\boldsymbol{\\lambda}_{\\mathcal{A}} = \\boldsymbol{r}_{\\mathcal{A}}$ 即可得到激活乘子。然后投影应力可由下式得出\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\sum_{k \\in \\mathcal{A}} \\lambda_k \\boldsymbol{a}_k.\n$$\n\n一个激活集算法的流程如下：\n1. 根据 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 处最严重违反的约束初始化激活集 $\\mathcal{A}$，如果公差范围内没有违反，则从空集开始。\n2. 给定 $\\mathcal{A}$，求解关于 $\\boldsymbol{\\lambda}_{\\mathcal{A}}$ 的线性系统。\n3. 如果对于 $k \\in \\mathcal{A}$，有任何 $\\lambda_k  0$，则将负值最大的乘子所对应的约束从 $\\mathcal{A}$ 中移除并重新求解。这强制了对偶可行性。\n4. 使用计算出的 $\\boldsymbol{\\sigma}$，检查所有非激活约束。如果任何约束被违反，则将最严重违反的约束添加到 $\\mathcal{A}$ 中并重复。\n5. 当所有约束均得到满足（在数值容差内）且所有激活乘子均为非负时停止。此时，KKT 条件得到满足，解是唯一的极小值点。\n\n对于所提供的测试套件，每个用例都使用 $n = 3$ 个分量、一个对角弹性刚度 $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$ 和线性屈服面。该算法为每个用例输出最终应力分量 $\\sigma_1, \\sigma_2, \\sigma_3$（单位为 $\\mathrm{Pa}$）和收敛时基于 1 的激活集索引：\n- 情况 1（弹性）：没有约束被违反；投影是恒等变换，激活集为空。\n- 情况 2（单一面）：只有第一个面被违反；投影强制 $\\boldsymbol{a}_1^\\top \\boldsymbol{\\sigma} = c_1$，乘子为非负，仅更新第一个应力分量。\n- 情况 3（多个面）：前三个轴向面被违反；投影同时强制所有三个等式，每个等式都有一个非负乘子，产生一个位于三个平面交点上的应力。\n- 情况 4（边界）：试探应力位于一个或多个屈服面上，但未违反任何约束；KKT 条件允许零乘子，因此返回试探应力，激活集为空。\n- 情况 5（仅斜面）：轴向边界宽松（$c_i$ 值高），但斜面限制了前两个分量的平均值；只有斜面被激活并变为紧绷。\n\n程序实现了这种激活集方案，处理了数值容差，并打印包含五个测试用例结果的单行文本，每个结果形如 $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$，其中应力单位为 $\\mathrm{Pa}$，激活索引为整数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef closest_point_projection(C, a_list, c_list, sigma_tr, tol=1e-9):\n    \"\"\"\n    Active-set closest point projection for polyhedral yield surfaces.\n    Minimize 0.5*(sigma - sigma_tr)^T C^{-1} (sigma - sigma_tr)\n    subject to a_i^T sigma - c_i = 0.\n    \"\"\"\n    n = C.shape[0]\n    m = len(a_list)\n    \n    def fvals(sigma):\n        return np.array([a.dot(sigma) - c for a, c in zip(a_list, c_list)])\n\n    # Determine an absolute tolerance based on magnitudes present\n    f_tr = fvals(sigma_tr)\n    scale = max(np.max(np.abs(f_tr)), np.max(np.abs(c_list)), 1.0)\n    abstol = tol * scale\n\n    # If trial state is feasible within tolerance, return it\n    if np.all(f_tr = abstol):\n        return sigma_tr.copy(), []\n\n    # Active set initialization: add the most violated constraint\n    violated = np.where(f_tr > abstol)[0]\n    active = [int(violated[np.argmax(f_tr[violated])])]\n    sigma = sigma_tr.copy()\n\n    # Active-set iterations\n    max_iters = 2 * m\n    for _ in range(max_iters):\n        if not active:\n            break\n\n        # Build Gram matrix G and rhs for active set\n        A_active = [a_list[i] for i in active]\n        c_active = [c_list[i] for i in active]\n        p = len(active)\n        G = np.zeros((p, p))\n        rhs = np.zeros(p)\n        for j in range(p):\n            rhs[j] = A_active[j].dot(sigma_tr) - c_active[j]\n            for k in range(p):\n                G[j, k] = A_active[j].dot(C.dot(A_active[k]))\n\n        # Solve for lambda\n        try:\n            lam = np.linalg.solve(G, rhs)\n        except np.linalg.LinAlgError:\n            lam, *_ = np.linalg.lstsq(G, rhs, rcond=None)\n\n        # Dual feasibility: remove constraints with negative lambda\n        if lam.size > 0 and np.min(lam)  -abstol:\n            remove_idx_in_active = int(np.argmin(lam))\n            del active[remove_idx_in_active]\n            continue\n\n        # Update sigma from stationarity\n        correction = np.zeros(n)\n        for k in range(p):\n            correction += lam[k] * A_active[k]\n        sigma = sigma_tr - C.dot(correction)\n\n        # Primal feasibility: check for newly violated constraints\n        f = fvals(sigma)\n        inactive_mask = np.ones(m, dtype=bool)\n        inactive_mask[active] = False\n        violated_inactive = np.where((f > abstol)  inactive_mask)[0]\n        if violated_inactive.size > 0:\n            add_idx = int(violated_inactive[np.argmax(f[violated_inactive])])\n            if add_idx not in active:\n                active.append(add_idx)\n            continue\n        \n        # KKT conditions are met, convergence.\n        break\n\n    active_one_based = sorted([i + 1 for i in active])\n    return sigma, active_one_based\n\ndef format_output(results):\n    \"\"\"Formats the list of results into the required single-line string.\"\"\"\n    case_strings = []\n    for sigma, active_indices in results:\n        sigma_strs = [f\"{s:.15g}\" for s in sigma]\n        active_str = str(active_indices).replace(\" \", \"\")\n        case_strings.append(f\"[{','.join(sigma_strs)},{active_str}]\")\n    return f\"[{','.join(case_strings)}]\"\n\ndef solve():\n    \"\"\"Defines and runs all test cases, printing the final output.\"\"\"\n    C = np.diag([2.0e11, 1.5e11, 1.0e11])\n\n    test_suite = [\n        # Case 1\n        {\"a_list\": [np.array([1,0,0]), np.array([0,1,0]), np.array([0,0,1]), np.array([0.5,0.5,0])],\n         \"c_list\": [1.0e8, 1.2e8, 6.0e7, 2.0e8],\n         \"sigma_tr\": np.array([8.0e7, 9.0e7, 5.0e7])},\n        # Case 2\n        {\"a_list\": [np.array([1,0,0]), np.array([0,1,0]), np.array([0,0,1]), np.array([0.5,0.5,0])],\n         \"c_list\": [1.0e8, 1.2e8, 6.0e7, 2.0e8],\n         \"sigma_tr\": np.array([1.5e8, 1.0e8, 4.0e7])},\n        # Case 3\n        {\"a_list\": [np.array([1,0,0]), np.array([0,1,0]), np.array([0,0,1]), np.array([0.5,0.5,0])],\n         \"c_list\": [1.0e8, 1.2e8, 6.0e7, 2.0e8],\n         \"sigma_tr\": np.array([1.7e8, 1.5e8, 7.0e7])},\n        # Case 4\n        {\"a_list\": [np.array([1,0,0]), np.array([0,1,0]), np.array([0,0,1]), np.array([0.5,0.5,0])],\n         \"c_list\": [1.0e8, 1.2e8, 6.0e7, 2.0e8],\n         \"sigma_tr\": np.array([1.0e8, 9.0e7, 6.0e7])},\n        # Case 5\n        {\"a_list\": [np.array([1,0,0]), np.array([0,1,0]), np.array([0,0,1]), np.array([0.5,0.5,0])],\n         \"c_list\": [3.0e8, 3.0e8, 3.0e8, 2.0e8],\n         \"sigma_tr\": np.array([2.5e8, 2.5e8, 2.0e7])},\n    ]\n\n    all_results = []\n    for case in test_suite:\n        sigma, active = closest_point_projection(C, case[\"a_list\"], case[\"c_list\"], case[\"sigma_tr\"])\n        all_results.append((sigma, active))\n        \n    print(format_output(all_results))\n\nsolve()\n```", "id": "3556874"}]}