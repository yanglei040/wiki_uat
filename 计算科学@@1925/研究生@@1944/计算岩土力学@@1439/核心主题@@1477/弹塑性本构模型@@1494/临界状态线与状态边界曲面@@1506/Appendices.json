{"hands_on_practices": [{"introduction": "在计算岩土力学中，本构模型的建立通常不直接使用应力张量，而是基于其不变量。本练习旨在实践从一个三维有效应力张量出发，计算临界状态土力学中至关重要的三个应力不变量：平均有效应力 $p'$、广义剪应力 $q$ 和洛德角 $\\theta$。掌握这项基本计算技能，是将复杂应力状态定位到本构模型所在的海格-韦斯特加德（Haigh-Westergaard）应力空间的第一步，也是理解和应用状态边界面理论的基础。[@problem_id:3514410]", "problem": "在与实验室坐标系对齐的轴系中，一个土体单元承受对称的有效应力张量 $\\boldsymbol{\\sigma'}$（有效柯西应力），单位为千帕（kPa），其表达式为\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, .\n$$\n在 Haigh–Westergaard 应力空间中的临界状态线（CSL）和状态边界曲面（SBS）框架下，一个应力状态的位置由平均有效应力 $p'$、广义剪应力大小 $q$ 和参数化偏平面上位置的洛德角 $\\theta$ 来描述。从应力不变量和偏应力的核心定义出发，计算给定 $\\boldsymbol{\\sigma'}$ 的三元组 $(p', q, \\theta)$，其中 $p'$ 是 $\\boldsymbol{\\sigma'}$ 的第一不变量除以三， $q$ 是与 $\\boldsymbol{\\sigma'}$ 的第二偏应力不变量相关的剪应力大小，$\\theta$ 是与 SBS 偏平面的三维描述一致的有符号洛德角。使用土力学惯例，其中三轴压缩对应于 $\\theta = \\pi/6$，三轴拉伸对应于 $\\theta = -\\pi/6$，纯剪对应于 $\\theta = 0$。\n\n然后，使用 $\\theta$，通过比较与 $\\theta = \\pi/6$、$\\theta = -\\pi/6$ 和 $\\theta = 0$ 的绝对角距离，确定该应力状态最接近哪个子午线（三轴压缩、三轴拉伸或中间子午线）。\n\n报告 $p'$ 和 $q$ 的单位为 $\\mathrm{kPa}$，$\\theta$ 的单位为弧度。将 $p'$ 和 $q$ 四舍五入到四位有效数字，将 $\\theta$ 四舍五入到三位有效数字。在最终的方框答案中，仅按顺序呈现包含 $(p', q, \\theta)$ 的数值行矩阵，不带单位。在你的推理过程中提供子午线分类，但不要将其包含在方框答案中。", "solution": "题目要求计算给定有效应力张量 $\\boldsymbol{\\sigma'}$ 的应力不变量 $(p', q, \\theta)$。这些量分别是平均有效应力 $p'$、广义剪应力 $q$ 和洛德角 $\\theta$。\n\n给定的有效应力张量为：\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\n\n首先，我们计算平均有效应力 $p'$，它定义为应力张量第一不变量 $I_1(\\boldsymbol{\\sigma'})$ 的三分之一。第一不变量是张量的迹。\n$$\nI_1(\\boldsymbol{\\sigma'}) = \\mathrm{tr}(\\boldsymbol{\\sigma'}) = \\sigma'_{11} + \\sigma'_{22} + \\sigma'_{33}\n$$\n$$\nI_1(\\boldsymbol{\\sigma'}) = 450 + 380 + 310 = 1140 \\, \\mathrm{kPa}\n$$\n因此，平均有效应力为：\n$$\np' = \\frac{1}{3} I_1(\\boldsymbol{\\sigma'}) = \\frac{1140}{3} = 380 \\, \\mathrm{kPa}\n$$\n\n接下来，我们计算广义剪应力 $q$。这需要用到偏应力张量 $\\boldsymbol{s'}$，其定义为 $\\boldsymbol{s'} = \\boldsymbol{\\sigma'} - p'\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是 $3 \\times 3$ 单位矩阵。\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} - 380 \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450 - 380  35  -20 \\\\\n35  380 - 380  15 \\\\\n-20  15  310 - 380\n\\end{pmatrix} = \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\n广义剪应力 $q$ 由偏应力张量的第二不变量 $J_2$ 定义。\n$$\nJ_2 = \\frac{1}{2} \\mathrm{tr}(\\boldsymbol{s'}^2) = \\frac{1}{2} s'_{ij} s'_{ji} = \\frac{1}{2} \\left( (s'_{11})^2 + (s'_{22})^2 + (s'_{33})^2 + 2\\left((s'_{12})^2 + (s'_{23})^2 + (s'_{31})^2\\right) \\right)\n$$\n代入 $\\boldsymbol{s'}$ 的分量：\n$$\nJ_2 = \\frac{1}{2} \\left( 70^2 + 0^2 + (-70)^2 + 2(35^2 + 15^2 + (-20)^2) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} \\left( 4900 + 4900 + 2(1225 + 225 + 400) \\right) = \\frac{1}{2} \\left( 9800 + 2(1850) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} (9800 + 3700) = \\frac{13500}{2} = 6750 \\, \\mathrm{kPa}^2\n$$\n广义剪应力 $q$ 定义为：\n$$\nq = \\sqrt{3 J_2} = \\sqrt{3 \\times 6750} = \\sqrt{20250} = \\sqrt{2025 \\times 10} = 45\\sqrt{10} \\, \\mathrm{kPa}\n$$\n数值上，$q \\approx 142.3025 \\, \\mathrm{kPa}$。\n\n为了求洛德角 $\\theta$，我们首先计算偏应力张量的第三不变量，$J_3 = \\det(\\boldsymbol{s'})$。\n$$\nJ_3 = \\det \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix}\n$$\n$$\nJ_3 = 70(0 \\cdot (-70) - 15 \\cdot 15) - 35(35 \\cdot (-70) - 15 \\cdot (-20)) - 20(35 \\cdot 15 - 0 \\cdot (-20))\n$$\n$$\nJ_3 = 70(-225) - 35(-2450 + 300) - 20(525)\n$$\n$$\nJ_3 = -15750 - 35(-2150) - 10500 = -15750 + 75250 - 10500 = 49000 \\, \\mathrm{kPa}^3\n$$\n洛德角 $\\theta$ 的定义使其符合给定的三轴压缩 ($\\theta = \\pi/6$) 和三轴拉伸 ($\\theta = -\\pi/6$) 的惯例。合适的公式是：\n$$\n\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}}\n$$\n我们计算反正弦函数的参数：\n$$\n\\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}} = \\frac{3\\sqrt{3}}{2} \\frac{49000}{(6750)^{3/2}} = \\frac{3\\sqrt{3} \\times 49000}{2 \\times (6750 \\sqrt{6750})} = \\frac{147000\\sqrt{3}}{202500\\sqrt{30}} = \\frac{1470}{2025\\sqrt{10}}\n$$\n化简分数 $\\frac{1470}{2025} = \\frac{98}{135}$。\n$$\n\\sin(3\\theta) = \\frac{98}{135\\sqrt{10}} \\approx 0.2295535\n$$\n解出 $\\theta$：\n$$\n3\\theta = \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\arcsin(0.2295535) \\approx 0.231575 \\, \\mathrm{rad}\n$$\n$$\n\\theta = \\frac{1}{3} \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\frac{0.231575}{3} \\approx 0.077192 \\, \\mathrm{rad}\n$$\n将结果四舍五入到指定的精度：\n- $p'$ 保留四位有效数字：$380.0 \\, \\mathrm{kPa}$。\n- $q$ 保留四位有效数字：$142.3 \\, \\mathrm{kPa}$。\n- $\\theta$ 保留三位有效数字：$0.0772 \\, \\mathrm{rad}$。\n\n应力不变量三元组为 $(p', q, \\theta) \\approx (380.0, 142.3, 0.0772)$。\n\n最后，我们通过比较计算出的 $\\theta$ 与三轴压缩 ($\\theta_{TC} = \\pi/6$)、三轴拉伸 ($\\theta_{TE} = -\\pi/6$) 和纯剪 ($\\theta_{PS} = 0$) 子午线的绝对角距离，来确定该应力状态最接近哪个子午线。\n$$\n\\theta \\approx 0.0772 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TC} = \\frac{\\pi}{6} \\approx 0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TE} = -\\frac{\\pi}{6} \\approx -0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{PS} = 0 \\, \\mathrm{rad}\n$$\n绝对角距离为：\n- 到TC子午线的距离：$|\\theta - \\theta_{TC}| \\approx |0.0772 - 0.5236| = 0.4464 \\, \\mathrm{rad}$。\n- 到TE子午线的距离：$|\\theta - \\theta_{TE}| \\approx |0.0772 - (-0.5236)| = 0.6008 \\, \\mathrm{rad}$。\n- 到PS子午线的距离：$|\\theta - \\theta_{PS}| \\approx |0.0772 - 0| = 0.0772 \\, \\mathrm{rad}$。\n\n最小的距离是到纯剪子午线 ($\\theta = 0$) 的距离。因此，给定的应力状态最接近纯剪或中间子午线。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n380.0  142.3  0.0772\n\\end{pmatrix}\n}\n$$", "id": "3514410"}, {"introduction": "在掌握了应力不变量的计算后，下一步是运用临界状态线的核心概念进行预测。临界状态线定义了土体在恒定应力和恒定体积下能够持续变形的极限状态，该状态由应力关系 $q = M p'$ 和比容关系 $v = \\Gamma - \\lambda \\ln(p')$ 共同描述。本练习 [@problem_id:3514395] 通过一个理想化的排水三轴试验场景，要求您应用这些基本定义，来预测土样在特定应力路径下最终将达到的临界状态点，从而加深对临界状态线作为 $(p', q, v)$ 空间中一个“吸引子”的物理理解。", "problem": "在临界状态土力学 (CSSM) 和修正剑桥模型的框架内，考虑对饱和土试样进行轴对称排水三轴压缩试验。初始平均有效应力为 $p'_0$，初始比体积为 $v_0$。在整个加载过程中，三轴仪通过伺服控制使平均有效应力保持在 $p' = p'_0$。应力状态是轴对称的，因此大、小主有效应力分别为 $\\sigma_1'$ 和 $\\sigma_3'$，且 $\\sigma_2' = \\sigma_3'$。平均有效应力定义为 $p' = (\\sigma_1' + \\sigma_2' + \\sigma_3')/3$，偏应力定义为 $q = \\sigma_1' - \\sigma_3'$。对试样进行充分加载，使其响应达到临界状态。在临界状态下，应力比达到一个由无量纲参数 $M$ 表征的恒定值，而临界状态线上的比体积由参数 $\\Gamma$ 和 $\\lambda$ 表征。\n\n在状态边界面 (SBS) 内，临界状态子流形仅由不变量 $(p', q)$ 和与由 $(M, \\Gamma, \\lambda)$ 决定的临界状态线相关的比体积 $v$ 定义。仅使用上述定义、试验的轴对称性以及边界条件 $p' = p'_0$，确定在排水三轴压缩下达到的临界状态线上的目标三元组 $(p', q, v)$，该状态与初始状态 $(p'_0, v_0)$ 和所施加的边界条件相符。\n\n将应力 $p'$ 和 $q$ 以千帕 (kilopascal) 为单位表示，比体积 $v$ 为无量纲。以行矩阵的形式，给出关于 $p'_0$、$M$、$\\Gamma$ 和 $\\lambda$ 的 $(p', q, v)$ 的单一解析表达式作为最终答案。无需进行数值代入，也无需四舍五入。", "solution": "该问题要求确定一个承受特定排水三轴试验的土试样的最终状态，该状态由平均有效应力 $p'$、偏应力 $q$ 和比体积 $v$ 构成的三元组描述。规定最终状态位于临界状态线 (CSL) 上。求解过程需在临界状态土力学 (CSSM) 的框架内进行，且材料行为与修正剑桥模型一致。\n\n临界状态是 $(p', q, v)$ 空间中的一个状态轨迹，在此轨迹上，土体可以在应力和体积恒定不变的情况下持续变形。该轨迹由两个关键关系定义：\n1.  应力不变量 $p'$ 和 $q$ 之间的关系。在三轴应力空间中，这是临界状态应力比，由 $q = M p'$ 给出，其中 $M$ 是一个材料常数。\n2.  比体积 $v$ 和平均有效应力 $p'$ 之间的关系。这定义了 $v-\\ln(p')$ 平面中的临界状态线，其方程为 $v = \\Gamma - \\lambda \\ln(p')$，其中 $\\Gamma$ 和 $\\lambda$ 是材料常数。\n\n问题描述了一个特定的加载路径。一个初始状态为 $(p'_0, v_0)$ 的饱和土试样承受排水三轴压缩。施加了一个关键的边界条件：在整个加载过程中，平均有效应力 $p'$ 保持恒定。这意味着在 $(p', q, v)$ 空间中，应力路径被限制在平面 $p' = p'_0$ 上。\n\n试样被加载直至达到临界状态。因此，最终状态必须同时满足加载路径条件和临界状态条件。\n\n设最终状态表示为 $(p'_{final}, q_{final}, v_{final})$。\n\n首先，我们确定最终的平均有效应力 $p'_{final}$。根据题目描述，平均有效应力被伺服控制为恒定值，等于其初始值 $p'_0$。\n$$p' = p'_0$$\n因此，最终临界状态下的平均有效应力必须是：\n$$p'_{final} = p'_0$$\n\n其次，我们确定最终的偏应力 $q_{final}$。在临界状态下，应力不变量通过临界状态应力比相关联：\n$$q = M p'$$\n将最终平均有效应力值 $p'_{final} = p'_0$ 代入此方程，我们得到最终的偏应力：\n$$q_{final} = M p'_0$$\n\n第三，我们确定最终的比体积 $v_{final}$。临界状态线上任意一点的比体积是该点平均有效应力的唯一函数。该关系由 CSL 方程给出：\n$$v = \\Gamma - \\lambda \\ln(p')$$\n为了求得最终临界状态下的比体积，我们将最终平均有效应力 $p'_{final} = p'_0$ 代入此方程：\n$$v_{final} = \\Gamma - \\lambda \\ln(p'_0)$$\n\n初始比体积 $v_0$ 定义了状态路径的起点。差值 $(v_0 - v_{final})$ 的符号将决定土样在剪切达到临界状态的过程中是经历体积压缩（密实化，如果 $v_0  v_{final}$）还是体积膨胀（剪胀，如果 $v_0  v_{final}$）。然而，问题要求的是临界状态线上的目标点坐标，对于这个特定的应力路径 ($p' = p'_0$)，该坐标与初始比体积 $v_0$ 无关。\n\n综合这三个分量，临界状态线上的目标三元组 $(p', q, v)$ 为 $(p'_0, M p'_0, \\Gamma - \\lambda \\ln(p'_0))$。问题要求将此结果写成行矩阵的形式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np'_0  M p'_0  \\Gamma - \\lambda \\ln(p'_0)\n\\end{pmatrix}\n}\n$$", "id": "3514395"}, {"introduction": "任何本构模型的实用性都取决于其参数能否通过实验或数值模拟数据进行标定。本练习旨在模拟这一关键过程，引导您解决一个参数识别的逆问题。您需要首先根据设定的微观-宏观关系生成带有噪声的合成数据，该数据模仿了离散元法（DEM）等数值试验的结果，然后从第一性原理出发，推导并应用加权最小二乘法（WLS）和普通最小二乘法（OLS）来反演宏观模型参数 $M$ 和 $\\Gamma$ [@problem_id:3514412]。这项高级实践练习将理论与实际应用联系起来，不仅训练了模型标定的核心技能，还揭示了如何处理真实的测量噪声以及微观力学属性与宏观模型参数之间的联系。", "problem": "你的任务是构建并求解一个计算地质力学中的反问题，从代表离散元法 (DEM) 三轴模拟的合成数据中识别临界状态参数。宏观临界状态线和正常压缩关系在单元尺度上由临界状态土力学框架通过两个核心定义来确定：偏应力关系 $q = M p'$ 和比容关系 $v = \\Gamma - \\lambda \\ln p'$，其中 $q$ 和 $p'$ 是应力，$v$ 是比容，$M$ 和 $\\Gamma$ 是无量纲材料参数，$\\lambda$ 是正常压缩线在 $(v, \\ln p')$ 空间中的斜率。在此问题中，这些关系被视为本构定义，目标是从一个包含微观力学影响的正向模型生成的含噪声合成数据中恢复宏观参数 $M$ 和 $\\Gamma$。\n\n你必须从反问题和最小二乘估计的基本原理出发，考虑与数据生成过程一致的测量误差结构。你的算法必须能产生可复现且具有物理解释性的稳健估计。\n\n假设用于生成类 DEM 合成数据的正向模型具有以下假定：\n- 应力 $q$ 和 $p'$ 的单位是千帕 (kPa)。比容 $v$ 是无量纲的。参数 $M$ 和 $\\Gamma$ 是无量纲的。\n- 真实的基准宏观参数为 $M_0 = 1.2$，$\\Gamma_0 = 1.95$，$\\lambda = 0.12$。\n- 微观参数为颗粒摩擦系数 $\\mu$（无量纲）和法向接触刚度 $k_n$（单位：牛顿/米，N/m）。参考值为 $\\mu_{\\mathrm{ref}} = 0.5$ 和 $k_{\\mathrm{ref}} = 10^5$。\n- 微观到宏观的敏感性通过以下有效参数模型化为 $\\mu$ 的线性函数和 $k_n$ 的对数函数：\n  $$M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  $$\\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  其中敏感性系数为固定值 $s_\\mu = 0.6$，$s_k = 0.03$，$t_\\mu = -0.02$，$t_k = -0.01$。\n- 对于每个测试案例，在以下平均有效应力下生成 $N$ 个数据点：\n  $$p'_i \\in \\{50, 75, 100, 150, 200, 250, 300, 350, 400\\}\\ \\text{kPa},$$\n  形成一个包含 $N = 9$ 个值的数组（单位 kPa）。\n- 相应的无噪声宏观响应为：\n  $$q_i^{\\ast} = M_{\\mathrm{eff}}(\\mu, k_n)\\, p'_i,$$\n  $$v_i^{\\ast} = \\Gamma_{\\mathrm{eff}}(\\mu, k_n) - \\lambda \\ln p'_i.$$\n- 应用加性噪声以反映真实的异方差性：\n  $$q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2\\, (p'_i)^2\\right), \\quad \\sigma_q = 0.02,$$\n  $$v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right), \\quad \\sigma_v = 0.005.$$\n  所有随机性必须使用等于 $42$ 的固定种子确定性地生成，以保证可复现性。使用自然对数表示 $\\ln(\\cdot)$。\n\n你的任务：\n1. 对于每个测试案例，从基本原理出发，推导并实现一个 $M$ 的估计器。该估计器通过求解模型 $q_i \\approx M p'_i$ 的加权最小二乘问题得到，并应考虑到 $\\varepsilon_{q,i}$ 的非恒定方差。你的推导必须从最小化由噪声方差倒数加权的残差平方和这一原理开始，且不得假定任何现成的封闭形式解。将你最终实现的估计器表达为相应正规方程的解。\n2. 对于每个测试案例，从基本原理出发，推导并实现一个 $\\Gamma$ 的估计器。该估计器通过求解模型 $v_i \\approx \\Gamma - \\lambda \\ln p'_i$ 在 $\\varepsilon_{v,i}$ 方差恒定的假设下的普通最小二乘问题得到。展示如何将其转换为仅截距估计问题，并从最小化残差平方和推导出相应的估计器。\n\n测试套件：\n- 使用以下五个微观参数案例来探究宏观敏感性：\n  - 案例 A (参考)：$(\\mu, k_n) = (0.5, 10^5)$。\n  - 案例 B (低摩擦)：$(\\mu, k_n) = (0.3, 10^5)$。\n  - 案例 C (高摩擦)：$(\\mu, k_n) = (0.7, 10^5)$。\n  - 案例 D (低刚度)：$(\\mu, k_n) = (0.5, 3 \\times 10^4)$。\n  - 案例 E (高刚度)：$(\\mu, k_n) = (0.5, 10^6)$。\n\n计算要求：\n- 严格按照上述模型实现合成数据生成，使用提供的精确常数、kPa 的应力单位以及固定的随机种子 $42$。\n- 实现任务 $1$ 和 $2$ 中推导出的反问题估计器。不要使用黑盒回归程序；直接根据正规方程计算估计器。\n- 对于每个案例，以无量纲数的形式报告恢复的参数 $(\\widehat{M}, \\widehat{\\Gamma})$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含五个测试案例的结果，格式为用方括号括起来的逗号分隔列表。\n- 该列表必须按 $[\\widehat{M}_A, \\widehat{\\Gamma}_A, \\widehat{M}_B, \\widehat{\\Gamma}_B, \\widehat{M}_C, \\widehat{\\Gamma}_C, \\widehat{M}_D, \\widehat{\\Gamma}_D, \\widehat{M}_E, \\widehat{\\Gamma}_E]$ 的顺序包含 $10$ 个浮点数。\n- 每个数字必须四舍五入到 $5$ 位小数。\n- 所有报告的值都是无量纲的。不应打印任何其他文本。\n\n注意事项：\n- 通过遵守提供的 kPa 应力范围和使用指定的噪声结构来确保科学真实性。\n- 此问题不使用角度。\n- 不要将任何结果表示为百分比；所有输出必须是原始十进制数。\n程序必须完全自包含，无需任何输入。它必须确定性地执行，并严格按照规定生成最终输出行。", "solution": "该问题要求构建并求解一个反问题，以从合成数据中确定临界状态土模型的两个宏观参数 $M$ 和 $\\Gamma$。生成合成数据的目的是模拟离散元法 (DEM) 三轴模拟的输出，包括微观力学敏感性和真实的测量噪声。解决方案涉及从最小二乘估计的基本原理推导 $M$ 和 $\\Gamma$ 的估计器，并实现它们以恢复几个测试案例的参数。\n\n问题的结构如下：首先，一个正向模型为 $i=1, \\dots, N$ 生成合成数据 $(p'_i, q_i, v_i)$。这些数据将确定性的本构关系与随机噪声相结合。其次，将一个反向模型应用于这些含噪声数据，以估计本构参数。\n\n正向模型将有效的宏观参数 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$ 定义为微观参数 $\\mu$ 和 $k_n$ 的函数：\n$$ M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\n$$ \\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\n无噪声数据点 $(p'_i, q_i^*, v_i^*)$ 位于临界状态线和正常压缩线上：\n$$ q_i^{\\ast} = M_{\\mathrm{eff}} p'_i $$\n$$ v_i^{\\ast} = \\Gamma_{\\mathrm{eff}} - \\lambda \\ln p'_i $$\n最后，通过添加具有指定方差结构的零均值高斯噪声来生成含噪声的观测值 $q_i$ 和 $v_i$：\n$$ q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2 (p'_i)^2\\right) $$\n$$ v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right) $$\n\n反演任务是从含噪声数据集 $(p'_i, q_i)$ 和 $(p'_i, v_i)$ 中分别估计 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$。我们将估计器表示为 $\\widehat{M}$ 和 $\\widehat{\\Gamma}$。\n\n**1. 应力比参数 $M$ 的估计**\n\n偏应力模型为 $q_i \\approx M p'_i$。噪声项 $\\varepsilon_{q,i}$ 的方差为 $\\text{Var}(\\varepsilon_{q,i}) = \\sigma_q^2 (p'_i)^2$，它依赖于自变量 $p'_i$。此性质称为异方差性。对于此类线性模型，合适的估计方法是加权最小二乘法 (WLS)。WLS 的原理是最小化残差平方和，其中每个残差都由其误差方差的倒数加权。\n\n关于参数 $M$ 要最小化的目标函数是：\n$$ S(M) = \\sum_{i=1}^{N} w_i (q_i - M p'_i)^2 $$\n最优权重 $w_i$ 是误差方差的倒数：$w_i = 1/\\text{Var}(\\varepsilon_{q,i}) = 1/(\\sigma_q^2 (p'_i)^2)$。代入这些权重，目标函数变为：\n$$ S(M) = \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 $$\n为了找到最小化 $S(M)$ 的估计器 $\\widehat{M}$，我们将 $S(M)$ 对 $M$ 求导，并令结果为零：\n$$ \\frac{dS}{dM} = \\frac{d}{dM} \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} \\cdot 2(q_i - M p'_i) \\cdot (-p'_i) = 0 $$\n常数因子 $-2/\\sigma_q^2$ 可以消去，得到：\n$$ \\sum_{i=1}^{N} \\frac{p'_i}{(p'_i)^2} (q_i - M p'_i) = \\sum_{i=1}^{N} \\frac{1}{p'_i} (q_i - M p'_i) = 0 $$\n展开求和项并求解估计器 $\\widehat{M}$：\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\frac{\\widehat{M} p'_i}{p'_i} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\widehat{M} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - N \\widehat{M} = 0 $$\n这就得出了 $M$ 的 WLS 估计器的最终表达式：\n$$ \\widehat{M} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{q_i}{p'_i} $$\n这个结果可以从 WLS 的正规方程形式化推导出来。对于模型 $\\mathbf{q} = \\mathbf{X}\\beta + \\varepsilon$，其中 $\\mathbf{X} = [p'_1, \\dots, p'_N]^T$，$\\beta = [M]$，解为 $\\widehat{\\beta} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{q}$，其中 $\\mathbf{W} = \\text{diag}(w_i)$。上面展示的计算等价于求解该系统。实现时将计算比率 $q_i/p'_i$ 的简单算术平均值。\n\n**2. 比容参数 $\\Gamma$ 的估计**\n\n比容模型为 $v_i \\approx \\Gamma - \\lambda \\ln p'_i$。参数 $\\lambda$ 是一个给定的常数 ($\\lambda = 0.12$)。噪声项 $\\varepsilon_{v,i}$ 具有恒定方差 $\\text{Var}(\\varepsilon_{v,i}) = \\sigma_v^2$。这是一个同方差模型，适用普通最小二乘法 (OLS)。\n\n为了简化估计，我们可以重排模型以分离未知参数 $\\Gamma$。我们定义一个新的因变量 $y_i$：\n$$ y_i = v_i + \\lambda \\ln p'_i $$\n将其代入模型方程，我们得到一个仅截距模型：\n$$ y_i \\approx \\Gamma $$\n$y_i$ 的统计模型是 $y_i = \\Gamma + \\varepsilon_{v,i}$。任务简化为估计观测值 $y_i$ 的均值。OLS 估计器 $\\widehat{\\Gamma}$ 通过最小化残差平方和得到：\n$$ S(\\Gamma) = \\sum_{i=1}^{N} (y_i - \\Gamma)^2 $$\n对 $\\Gamma$ 求导并令结果为零，得到该问题的正规方程：\n$$ \\frac{dS}{d\\Gamma} = \\frac{d}{d\\Gamma} \\sum_{i=1}^{N} (y_i - \\Gamma)^2 = \\sum_{i=1}^{N} -2(y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} (y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} y_i - \\sum_{i=1}^{N} \\Gamma = 0 $$\n$$ \\sum_{i=1}^{N} y_i - N \\Gamma = 0 $$\n求解估计器 $\\widehat{\\Gamma}$：\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} y_i $$\n将 $y_i$ 的定义代回，得到最终的估计器：\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} (v_i + \\lambda \\ln p'_i) $$\n该估计器就是转换后变量 $y_i$ 的样本均值。实现时将为每个测试案例计算此均值。\n\n每个测试案例的总体算法是：\n1. 根据给定的微观参数 $(\\mu, k_n)$ 计算基准真相的有效参数 $M_{\\mathrm{eff}}$ 和 $\\Gamma_{\\mathrm{eff}}$。\n2. 在指定的应力水平 $p'_i$ 下，生成包含 $N=9$ 个点的无噪声数据集 $(q_i^*, v_i^*)$。\n3. 使用固定的随机种子以保证可复现性，向 $q_i^*$ 添加指定的异方差噪声，向 $v_i^*$ 添加同方差噪声。这会产生合成测量数据 $(q_i, v_i)$。\n4. 将推导出的估计器 $\\widehat{M} = \\frac{1}{N} \\sum (q_i/p'_i)$ 应用于 $(p'_i, q_i)$ 数据。\n5. 将推导出的估计器 $\\widehat{\\Gamma} = \\frac{1}{N} \\sum (v_i + \\lambda \\ln p'_i)$ 应用于 $(p'_i, v_i)$ 数据。\n6. 得到的参数对 $(\\widehat{M}, \\widehat{\\Gamma})$ 构成该测试案例的解。对所有五个案例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves an inverse problem to identify critical state parameters from synthetic data.\n    The solution involves generating synthetic data based on a forward model and then\n    recovering the parameters using Weighted Least Squares for M and Ordinary Least\n    Squares for Gamma, as derived from first principles.\n    \"\"\"\n\n    # --- 1. Define Constants and Forward Model Parameters ---\n    M0 = 1.2\n    Gamma0 = 1.95\n    lambda_val = 0.12\n    mu_ref = 0.5\n    k_ref = 1e5\n    s_mu = 0.6\n    s_k = 0.03\n    t_mu = -0.02\n    t_k = -0.01\n    sigma_q = 0.02\n    sigma_v = 0.005\n    RANDOM_SEED = 42\n\n    # Stress levels for data generation (in kPa)\n    p_prime = np.array([50., 75., 100., 150., 200., 250., 300., 350., 400.])\n    N = len(p_prime)\n\n    # Test suite of micro-parameters\n    test_cases = [\n        (0.5, 1e5),          # Case A (reference)\n        (0.3, 1e5),          # Case B (low friction)\n        (0.7, 1e5),          # Case C (high friction)\n        (0.5, 3e4),          # Case D (low stiffness)\n        (0.5, 1e6)           # Case E (high stiffness)\n    ]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    results = []\n    \n    # --- 2. Process Each Test Case ---\n    for mu, k_n in test_cases:\n        \n        # --- 2a. Generate Synthetic Data ---\n        \n        # Calculate effective macro-parameters based on micro-parameters\n        M_eff = M0 + s_mu * (mu - mu_ref) + s_k * np.log(k_n / k_ref)\n        Gamma_eff = Gamma0 + t_mu * (mu - mu_ref) + t_k * np.log(k_n / k_ref)\n        \n        # Generate noiseless data\n        q_star = M_eff * p_prime\n        v_star = Gamma_eff - lambda_val * np.log(p_prime)\n        \n        # Generate heteroscedastic noise for q\n        std_dev_q = sigma_q * p_prime\n        epsilon_q = rng.normal(0, std_dev_q, size=N)\n        \n        # Generate homoscedastic noise for v\n        epsilon_v = rng.normal(0, sigma_v, size=N)\n        \n        # Add noise to generate synthetic measurements\n        q_measured = q_star + epsilon_q\n        v_measured = v_star + epsilon_v\n        \n        # --- 2b. Inverse Problem: Estimate M and Gamma ---\n        \n        # Estimate M using the derived Weighted Least Squares estimator\n        # Model: q_i = M * p'_i\n        # Estimator: M_hat = (1/N) * sum(q_i / p'_i)\n        # This is the solution to the normal equations for the WLS problem.\n        M_hat = np.mean(q_measured / p_prime)\n        \n        # Estimate Gamma using the derived Ordinary Least Squares estimator\n        # Model: v_i = Gamma - lambda * ln(p'_i)\n        # Rearranged model: y_i = v_i + lambda * ln(p'_i) = Gamma\n        # Estimator: Gamma_hat = mean(y_i)\n        y = v_measured + lambda_val * np.log(p_prime)\n        Gamma_hat = np.mean(y)\n        \n        results.extend([M_hat, Gamma_hat])\n        \n    # --- 3. Format and Print Final Output ---\n    # The output format must be a list of 10 floats, rounded to 5 decimal places.\n    formatted_results = [f'{x:.5f}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3514412"}]}