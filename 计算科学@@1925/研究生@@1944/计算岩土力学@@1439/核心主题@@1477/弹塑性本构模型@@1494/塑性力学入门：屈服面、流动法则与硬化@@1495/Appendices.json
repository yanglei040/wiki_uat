{"hands_on_practices": [{"introduction": "在我们投入计算模型的实施之前，我们必须理解其参数如何从物理现实中获得。这项练习要求您设计一个科学合理的实验方案来校准弹塑性模型，从而促使您批判性地思考如何从实验室数据中解耦弹性、塑性流动和硬化行为。这项实践将理论与实际测量联系起来，为我们接下来要建立的本构模型提供了基本依据。[@problem_id:3534629]", "problem": "一个饱和黏土在等向固结后，于轴对称三轴仪中进行不排水条件下的测试。该材料旨在通过一个相关的、压力敏感的、带有内硬化变量的凸屈服面，在计算岩土力学程序中进行模拟。假设小应变、小孔隙水压力变化和率无关行为。您可以使用以下基本事实和定义：\n- 有效应力原理：有效应力张量为 $\\boldsymbol{\\sigma}'$，定义为 $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - u \\mathbf{I}$，其中 $\\boldsymbol{\\sigma}$ 是总应力， $u$ 是孔隙水压力， $\\mathbf{I}$ 是单位张量。\n- 应变率叠加性：$\\dot{\\boldsymbol{\\varepsilon}} = \\dot{\\boldsymbol{\\varepsilon}}^{e} + \\dot{\\boldsymbol{\\varepsilon}}^{p}$，上标 $e$ 和 $p$ 分别表示弹性和塑性部分。\n- 小应变下的不排水条件：总体积应变率为零，$\\dot{\\varepsilon}_{v} = \\operatorname{tr}(\\dot{\\boldsymbol{\\varepsilon}}) = \\dot{\\varepsilon}_{v}^{e} + \\dot{\\varepsilon}_{v}^{p} = 0$。\n- 在线性各向同性弹性中，弹性体积应变率与有效平均应力率的关系为 $\\dot{\\varepsilon}_{v}^{e} = \\dot{p}'/K$，其中 $p' = \\operatorname{tr}(\\boldsymbol{\\sigma}')/3$，$K$ 是弹性体积模量。\n\n您的目标是设计一个不排水三轴试验方案，该方案能够单独识别硬化与纯塑性流动，并概述一个在塑性加载过程中使用塑性一致性约束的参数识别方案。该程序将采用标准的返回映射算法，具有一致性、光滑的关联流动法则和各向同性硬化定律。\n\n以下哪个选项是用于实现以下目标的最科学合理、内部一致且实际可行的方案与计划：\n(i) 分离弹性响应，以估计在不排水条件下分离塑性流动与硬化所需的弹性参数，\n(ii) 在不排水剪切过程中识别流动方向与硬化率，以及\n(iii) 使用塑性一致性约束从观测到的不排水响应中回归硬化参数？\n\nA. 在不应少于 $3$ 个覆盖预期工作范围的不同初始有效平均应力 $p_{0}'$ 下，进行一系列固结各向同性不排水 (CIU) 三轴压缩试验。在每次试验中，在假定的弹性域内插入小幅值的卸载-再加载循环，利用从测量的 $\\boldsymbol{\\sigma}$ 和 $u$ 计算出的 $\\boldsymbol{\\sigma}'$ 的有效应力-应变斜率来估计 $K$ 和弹性剪切模量 $G$。在单调不排水剪切过程中，使用这些弹性常数和 $\\dot{\\varepsilon}_{v} = 0$ 来计算 $\\dot{\\varepsilon}_{v}^{p} = -\\dot{p}'/K$。通过塑性应变率不变量的比值（例如 $\\dot{\\varepsilon}_{v}^{p}/\\dot{\\varepsilon}_{q}^{p}$，其中 $\\varepsilon_{q}$ 是偏应变量）来估计塑性流动方向，并将其与测量的应力方向进行比较，以确认关联流动。然后，在每个塑性增量中，强制执行塑性一致性条件 $\\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}'}:\\dot{\\boldsymbol{\\sigma}}' + \\frac{\\partial f}{\\partial \\kappa}\\dot{\\kappa} = 0$，并结合流动法则 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\, \\partial f/\\partial \\boldsymbol{\\sigma}'$ 和一个可微的硬化定律 $\\dot{\\kappa} = h(\\kappa, \\boldsymbol{\\sigma}', \\boldsymbol{\\varepsilon}^{p})\\, \\dot{\\lambda}$ 来求解 $\\dot{\\lambda}$，并通过最小二乘法对所有试验回归硬化参数 $h(\\cdot)$。利用不排水响应随 $p_{0}'$ 的变化来区分纯塑性流动方向（$f$ 的几何形状）与硬化率（$\\kappa$ 的演化）。\n\nB. 在单个 $p_{0}'$ 下进行一次 CIU 三轴压缩试验，同时伺服控制总平均应力 $p = \\operatorname{tr}(\\boldsymbol{\\sigma})/3$ 保持恒定，并推断在不排水条件下 $\\dot{\\varepsilon}_{v}^{p} = 0$。直接从试验结束时的峰值计算硬化参数，并施加塑性一致性不等式 $\\dot{f}  0$ 以确保拟合过程中的稳定性。由于 $p$ 恒定，硬化率可以在不估计弹性模量的情况下找到。\n\nC. 用在多种围压下的排水三轴试验代替不排水试验，将峰值应力状态拟合到屈服面，并通过假设孔隙水压力影响可以忽略来识别硬化定律。使用峰值处的循环结束斜率来近似 $K$ 和 $G$。可以假设流动方向与应力同轴，因此参数识别不需要一致性条件。\n\nD. 使用真三轴仪施加恒定 Lode 角和恒定有效平均应力 $p'$ 下的不排水加载路径，并从不同偏应力幅值下达到的点轨迹中识别屈服面形状和硬化定律。通过最大熵滤波器平滑噪声测量值，并从滤波后的数据中拟合硬化参数，而不使用塑性一致性条件。弹性参数可从不排水加载下的初始切线斜率得出。\n\nE. 在单个 $p_{0}'$ 下进行单调 CIU 三轴压缩至大应变，不进行任何卸载-再加载循环，将观察到的应力路径直接拟合为屈服面，并推断屈服面尺寸的变化率与轴向塑性应变率成正比。由于不排水条件阻止了体积应变，因此无需明确使用弹性参数或一致性条件。", "solution": "用户提供了一个关于饱和黏土在不排水条件下弹塑性模型试验方案设计和参数识别方案的问题陈述。在进行解答之前，需要对问题陈述进行严格验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **材料与条件：** 饱和黏土，在等向固结后，于轴对称三轴仪中进行不排水条件下的测试。\n- **模型类型：** 相关的、压力敏感的、带有内硬化变量的凸屈服面。\n- **假设：** 小应变、小孔隙水压力变化、率无关行为。\n- **基本定义：**\n    - 有效应力原理：$\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - u \\mathbf{I}$。\n    - 应变率叠加性：$\\dot{\\boldsymbol{\\varepsilon}} = \\dot{\\boldsymbol{\\varepsilon}}^{e} + \\dot{\\boldsymbol{\\varepsilon}}^{p}$。\n    - 不排水条件：$\\dot{\\varepsilon}_{v} = \\operatorname{tr}(\\dot{\\boldsymbol{\\varepsilon}}) = \\dot{\\varepsilon}_{v}^{e} + \\dot{\\varepsilon}_{v}^{p} = 0$。\n    - 各向同性弹性：$\\dot{\\varepsilon}_{v}^{e} = \\dot{p}'/K$，其中 $p' = \\operatorname{tr}(\\boldsymbol{\\sigma}')/3$，$K$ 是弹性体积模量。\n- **计算背景：** 该模型用于一个采用标准返回映射算法、一致性、光滑关联流动法则和各向同性硬化定律的程序。\n- **目标：** 设计一个试验方案和识别方案以：\n    (i) 分离弹性响应并估计弹性参数。\n    (ii) 在不排水剪切过程中识别流动方向与硬化率。\n    (iii) 使用塑性一致性约束回归硬化参数。\n- **问题：** 在所提供的选项中，确定最科学合理、内部一致且实际可行的选项。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地建立在连续介质力学，特别是应用于岩土材料（土力学）的弹塑性理论的既定框架内。所有提供的原理——有效应力、应变分解、不排水约束、线性弹性、一致性条件——都是该领域标准和基础性的。该设定是科学合理的。\n- **适定性：** 该问题提供了明确的目标和足够的理论背景来评估所提议的方案。它要求评估“最科学合理、内部一致且实际可行”的选项，这对于该领域的专家来说是一项定义明确的任务。\n- **客观性：** 该问题以精确、技术性的语言陈述，没有主观性或模糊性。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。它是计算岩土力学中本构模型标定的一个标准挑战的全面且正确的表述。我现在将继续进行选项的推导和分析。\n\n### 求解推导与选项分析\n\n问题的核心是设计一个策略来确定弹塑性本构模型的参数。这样的模型由以下几点定义：\n1.  弹性定律，例如，由弹性模量如体积模量 $K$ 和剪切模量 $G$ 定义。\n2.  屈服面，$f(\\boldsymbol{\\sigma}', \\kappa) = 0$，其中 $\\kappa$ 是一个硬化变量。这个面的形状决定了引起塑性变形的应力状态。\n3.  流动法则，$\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}'}$，它给出了塑性应变的方向。对于关联模型，塑性势 $g$与屈服函数 $f$ 相同。\n4.  硬化定律，$\\dot{\\kappa} = h(\\kappa, \\boldsymbol{\\sigma}', \\boldsymbol{\\varepsilon}^{p})\\, \\dot{\\lambda}$，它描述了屈服面的演化。\n\n参数识别必须能够区分这些组成部分。在不排水条件下的一个关键挑战是有效應力变化与塑性流动之间的耦合。所给定的不排水条件 $\\dot{\\varepsilon}_{v} = 0$ 意味着 $\\dot{\\varepsilon}_{v}^{p} = -\\dot{\\varepsilon}_{v}^{e}$。使用弹性定律 $\\dot{\\varepsilon}_{v}^{e} = \\dot{p}'/K$，我们得到不排水塑性流动的一个基本关系式：\n$$ \\dot{\\varepsilon}_{v}^{p} = -\\frac{\\dot{p}'}{K} $$\n这个方程表明，在不排水剪切过程中，有效平均应力 $p'$ 的任何变化都通过弹性体积模量 $K$ 与塑性体积应变 $\\dot{\\varepsilon}_{v}^{p}$ 直接相关。因此，估计 $K$对于从测量的有效应力路径计算塑性体积应变分量至关重要。\n\n在塑性加载过程中，状态必须保持在屈服面上，这由一致性条件 $\\dot{f}=0$ 来保证。使用链式法则展开得到：\n$$ \\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}'} : \\dot{\\boldsymbol{\\sigma}}' + \\frac{\\partial f}{\\partial \\kappa} \\dot{\\kappa} = 0 $$\n这个方程连接了应力率 $\\dot{\\boldsymbol{\\sigma}}'$、流动方向（通过 $\\partial f / \\partial \\boldsymbol{\\sigma}'$）和硬化率（通过 $\\dot{\\kappa}$）。一个合理的参数识别方案必须利用这个关系。\n\n基于这些原理，我们现在可以评估每个选项。\n\n**选项A分析**\n- **试验方案：** 提议进行一系列固结各向同性不排水 (CIU) 试验，这些试验在多个初始有效平均应力 $p'_{0}$下进行。这是极好的做法。对于压力敏感材料，其行为依赖于围压。在多个压力下进行测试对于在相关应力范围内表征屈服面的形状和硬化的压力依赖性是必要的。\n- **弹性参数识别：** 建议使用小幅值卸载-再加载循环。这是在加载的各个阶段确定弹性模量（$K$ 和 $G$）的标准且最可靠的方法。它正确地认识到需要这些参数来将弹性应变从塑性应变中分离出来。\n- **塑性流动识别：** 正确使用推导出的关系式 $\\dot{\\varepsilon}_{v}^{p} = -\\dot{p}'/K$ 来计算塑性体积应变率。然后提议使用塑性应变率不变量的比值（如 $\\dot{\\varepsilon}_{v}^{p}/\\dot{\\varepsilon}_{q}^{p}$）来确定塑性流动矢量的方向。这是一种严谨的方法。将此方向与屈服面的法线方向（从应力状态估计）进行比较，从而可以验证关联流动法则。\n- **硬化识别：** 它正确地引用塑性一致性条件 $\\dot{f}=0$ 作为回归硬化参数的核心方程。所描述的方案——结合一致性条件、流动法则和硬化定律来求解塑性乘子 $\\dot{\\lambda}$，并通过最小二乘法对多个试验拟合硬化函数 $h(\\cdot)$ 的参数——正是当前最先进的方法论。\n- **总体：** 该选项提出了一个完整、连贯、理论上合理且实际可行的方法论，与现代计算塑性力学的原理完美契合。\n\n**A的结论：** **正确**。\n\n**选项B分析**\n- **试验方案：** 提议进行单次CIU试验。这不足以可靠地标定压力敏感模型。\n- **伺服控制：** 建议控制总平均应力 $p$ 保持恒定。由于 $p' = p-u$，恒定的 $p$ 并不意味着恒定的 $p'$，因为在不排水剪切过程中孔隙水压力 $u$ 会演化。因此，一般情况下 $\\dot{p}' = -\\dot{u} \\ne 0$。\n- **错误的推断：** 它错误地推断出 $\\dot{\\varepsilon}_{v}^{p} = 0$。这仅在 $\\dot{p}'=0$ 时才成立，而这在提议的试验中是无法保证的。这是一个基本的科学错误。\n- **参数拟合：** 从“试验结束时的峰值”拟合硬化参数是一种粗糙的方法，它忽略了连续的硬化过程。使用“一致性不等式 $\\dot{f}  0$”是错误的；在塑性加载期间，条件是 $\\dot{f}=0$。不等式 $\\dot{f}  0$ 描述的是弹性卸载，这与拟合硬化参数无关。\n- **结论：** 该选项在塑性理论和试验设计方面包含多个基本错误。\n\n**B的结论：** **不正确**。\n\n**选项C分析**\n- **试验方案：** 它用排水试验代替了所需的不排水试验。这未能解决模拟不排水行为的特定问题，而在不排水行为中孔隙水压力效应是主导的。\n- **孔隙水压力：** 它提议对于一个关于*饱和*黏土在*不排水*加载下的问题，假设孔隙水压力效应可以忽略。这是一个致命的矛盾。\n- **流动方向：** 假设流动方向“与应力同轴”是模糊的且通常是不正确的。流动方向垂直于塑性势面。\n- **一致性条件：** 它声称“参数识别不需要”一致性条件。这是一个深层次的理论错误。一致性条件是率无关塑性中塑性演化的控制方程，对于严格的标定是必不可少的。\n- **结论：** 该选项误解了问题背景，并错误地陈述了塑性力学的基本原理。\n\n**C的结论：** **不正确**。\n\n**选项D分析**\n- **试验方案：** 它提议使用真三轴仪，这与问题陈述中指定的“轴对称三轴仪”相矛盾。它建议在恒定 $p'$ 下施加不排水加载。这在试验上极难实现，因为它要求 $\\dot{\\varepsilon}_{v}^{p} = - \\dot{p}'/K = 0$。这意味着塑性流动必须是纯偏量的，这只在特定的应力状态下（例如在临界状态线上）发生，而不是在压力敏感材料从各向同性状态开始的普通不排水路径中发生。因此，所提议的路径与预期的材料响应在物理上不一致。\n- **一致性条件：** 与选项B和C一样，它错误地建议可以在“不使用塑性一致性条件”的情况下进行参数拟合。这从理论角度使整个方法失效。\n- **弹性参数：** 使用初始切线斜率是一种可行但不如卸载-再加载循环准确的方法。\n- **结论：** 该选项提出了一个物理上值得怀疑的试验路径，并且基于对一致性条件作用的严重理论误解。\n\n**D的结论：** **不正确**。\n\n**选项E分析**\n- **试验方案：** 单次单调试验是不够的。缺少卸载-再加载循环使得无法直接测量应变分解所需的弹性模量。\n- **屈服面与应力路径：** 它犯了一个经典错误，将*观测到的应力路径*与*屈服面*混为一谈。应力路径是屈服面上单个点随着其演化（硬化）的轨迹。屈服面本身是在给定时刻整个弹性域的边界。\n- **不排水约束：** 它错误地陈述说不排水条件“阻止了体积应变”，暗示是所有体积应变。条件是 $\\dot{\\varepsilon}_v = \\dot{\\varepsilon}_{v}^{e} + \\dot{\\varepsilon}_{v}^{p} = 0$，而不是 $\\dot{\\varepsilon}_{v}^{e}=0$ 和 $\\dot{\\varepsilon}_{v}^{p}=0$。如前所示，在不排水试验中，塑性体积应变通常非零。\n- **一致性条件：** 它再次提出了一个没有明确使用一致性条件的方案，这在根本上是有缺陷的。\n- **结论：** 该选项表明对塑性理论中的几个核心概念存在严重缺乏理解。\n\n**E的结论：** **不正确**。", "answer": "$$\\boxed{A}$$", "id": "3534629"}, {"introduction": "在本构层面选择的数值算法，可能对全局有限元模拟的效率和稳健性产生深远影响。这项练习要求您实现并比较两种常见的返回映射格式——精确的“最近点投影”算法和简化的“切平面”算法。通过这项实践，您将亲眼见证算法切线刚度的“一致性”如何影响牛顿-拉弗森（Newton-Raphson）求解器的收敛速度，这对于解决非线性问题至关重要。[@problem_id:3534631]", "problem": "考虑一种岩土材料的小应变弹塑性，该材料通过限制在三轴压缩条件下的 Mohr–Coulomb 准则进行理想化，并以压力–偏应力不变量进行表述。令 $p$ 表示平均正应力不变量，$q$ 表示等效剪应力不变量，$\\varepsilon_v$ 表示体积应变，$\\varepsilon_s$ 表示等效剪应变。假设以下基本依据、定义和建模选择。\n\n- 小应变加法分解与线性各向同性弹性：不变量形式的弹性定律为\n$$\ndp = K \\left(d\\varepsilon_v - d\\varepsilon_v^{p}\\right), \\quad dq = 3 G \\left(d\\varepsilon_s - d\\varepsilon_s^{p}\\right),\n$$\n其中 $K$ 是体积模量，$G$ 是剪切模量，上标 ${p}$ 表示塑性应变增量。\n\n- 三轴压缩分支上的 Mohr–Coulomb 屈服在 $p$–$q$ 平面中由一个具有粘聚力 $c$ 和摩擦角 $\\varphi$ 的单条线性段近似表示。该分支由一条类 Drucker–Prager 线表示\n$$\nf(p,q,\\kappa) = q + \\alpha(\\varphi)\\, p - k(\\kappa) \\le 0,\n$$\n其中 $\\alpha(\\varphi) = \\dfrac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ 以及初始粘聚力截距\n$$\nk(0) = k_0(\\varphi,c) = \\dfrac{6 c \\cos \\varphi}{3 - \\sin \\varphi}.\n$$\n此处 $\\kappa$ 是一个控制 $k(\\kappa)$ 硬化的标量内变量。\n\n- 非关联塑性流动由一个塑性势定义\n$$\ng(p,q) = q + \\alpha_g(\\psi) \\, p,\n$$\n其剪胀角为 $\\psi$，且 $\\alpha_g(\\psi) = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$。不变量形式的塑性流动增量满足\n$$\nd\\varepsilon_v^{p} = a\\, d\\lambda, \\quad d\\varepsilon_s^{p} = b\\, d\\lambda, \\quad a = \\dfrac{\\partial g}{\\partial p} = \\alpha_g(\\psi), \\quad b = \\dfrac{\\partial g}{\\partial q} = 1,\n$$\n其中 $d\\lambda \\ge 0$ 是塑性乘子。硬化定律为\n$$\nk(\\kappa) = k_0 + h \\, \\kappa^{m},\n$$\n其中 $h \\ge 0$ 且 $m \\ge 1$。在单调加载中，其率满足 $d\\kappa = d\\lambda$。\n\n- 对于一个应变增量的试算（弹性预测）由下式给出\n$$\np^{\\mathrm{tr}} = p_n + K \\, d\\varepsilon_v, \\quad q^{\\mathrm{tr}} = q_n + 3 G \\, d\\varepsilon_s,\n$$\n其中状态下标 $n$ 表示加载步的开始。\n\n需要实现两种算法塑性修正器以返回屈服面 $f=0$：\n- 应力空间中的最近点投影，对非线性硬化 $k(\\kappa)$ 强制执行一致性条件。\n- 切平面法，采用单一线性化修正，在加载步开始时评估硬化斜率，并且在修正过程中不更新该斜率。\n\n您必须从第一性原理推导算法剪切模量（$q$–$\\varepsilon_s$ 方向上的一致弹塑性切线），定义为\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg}} = \\frac{\\partial q}{\\partial \\varepsilon_s},\n$$\n对于上述模型下的每种算法。然后，您必须将本构更新嵌入到一个单自由度平衡问题中，该问题针对一个刚性条形基础，该基础被理想化为一个平面应变中的单点积分单元，具有单位厚度和仅限于纯剪切的运动学，$d\\varepsilon_v = 0$，$d\\varepsilon_s = du$，其中 $u$ 是标量全局自由度。内力为 $q(u)$，外力为 $Q_{\\mathrm{ext}}$。在试算位移 $u$ 处的平衡残差为\n$$\nr(u) = q(u) - Q_{\\mathrm{ext}}.\n$$\n使用 Newton–Raphson 方法，以算法切线作为雅可比矩阵，\n$$\n\\frac{dr}{du} = \\mathbb{C}_{22}^{\\mathrm{alg}},\n$$\n从 $u^{(0)} = 0$ 开始。迭代直到 $|r(u)|  \\tau$，其中绝对容差 $\\tau = 10^{-6}$ 千帕。将迭代次数上限设为 $50$。对于切平面算法，使用相应的切平面算法切线作为雅可比矩阵。计算每种算法收敛所需的迭代次数。\n\n角度输入必须以度为单位。应力和模量必须以千帕（kPa）为单位。应变为无量纲。将最终迭代次数表示为整数，算法切线差异表示为以千帕为单位的浮点数。\n\n实现一个完整、可运行的程序，该程序：\n- 在 $p$–$q$ 空间中实现两种返回映射算法，对于从零状态 $p_n = 0$, $q_n = 0$, $\\kappa_n = 0$ 开始的单个加载步，设定 $d\\varepsilon_v = 0$ 和 $d\\varepsilon_s = u$。\n- 对于给定的 $u$，计算每种算法的应力响应 $q(u)$ 和算法剪切切线 $\\mathbb{C}_{22}^{\\mathrm{alg}}(u)$。\n- 对每种算法独立使用 Newton–Raphson 方法求解 $r(u) = 0$。\n- 针对每个测试用例，报告最近点算法的迭代次数、切平面算法的迭代次数、最终 $\\mathbb{C}_{22}^{\\mathrm{alg}}$ 值的绝对差，以及最近点算法是否比切平面算法用更少的迭代次数收敛。\n\n使用以下测试套件，涵盖一般情况、弹性边界情况、无硬化情况以及强非线性硬化、轻微剪胀、非关联情况。所有角度单位为度，所有应力/模量单位为 kPa。\n- 情况 1（一般塑性，非线性硬化）：$K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 10$, $c = 10$, $h = 8000$, $m = 2$, $Q_{\\mathrm{ext}} = 150$。\n- 情况 2（弹性边界）：$K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 10$, $c = 10$, $h = 8000$, $m = 2$, $Q_{\\mathrm{ext}} = 10$。\n- 情况 3（无硬化，理想塑性）：$K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 0$, $c = 10$, $h = 0$, $m = 1$, $Q_{\\mathrm{ext}} = 60$。\n- 情况 4（非关联，强非线性硬化）：$K = 50000$, $G = 20000$, $\\varphi = 35$, $\\psi = 2$, $c = 5$, $h = 12000$, $m = 2.5$, $Q_{\\mathrm{ext}} = 80$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且必须是包含四个条目的列表，顺序为 [iterations_closest_point, iterations_cutting_plane, final_tangent_difference_kPa, closest_point_faster_boolean]。例如，两个用例的有效输出形式为\n$$\n\\left[ [i_1,j_1,\\Delta_1,b_1],[i_2,j_2,\\Delta_2,b_2] \\right].\n$$", "solution": "该问题经评估有效。它在科学上基于计算塑性力学的原理，定义了所有必要的参数和条件，问题设定良好，并且表述客观。它提出了一个在本构建模和非线性数值分析中标准但具有挑战性的问题。因此，提供一个完整的解决方案。\n\n问题的核心是在一个全局 Newton-Raphson (N-R) 程序中，实现并比较两种不同的塑性修正算法——最近点投影（CPP）和切平面（CP），以解决一个单自由度平衡问题。\n\n令加载增量开始时的状态为 $(p_n, q_n, \\kappa_n)$，结束时的状态为 $(p, q, \\kappa)$。问题指定从零初始状态开始的单个加载步，因此 $p_n=0$，$q_n=0$，且 $\\kappa_n=0$。运动学约束是纯剪切变形，在步长上积分得到总应变 $\\Delta\\varepsilon_v = 0$ 和 $\\Delta\\varepsilon_s = u$，其中 $u$ 是未知的位移自由度。\n\n试算状态是纯弹性的：\n$$\np^{\\mathrm{tr}} = p_n + K \\Delta\\varepsilon_v = 0 + K(0) = 0\n$$\n$$\nq^{\\mathrm{tr}} = q_n + 3 G \\Delta\\varepsilon_s = 0 + 3G u = 3Gu\n$$\n在试算状态下评估屈服函数，使用 $\\kappa_n=0$：\n$$\nf^{\\mathrm{tr}} = f(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}, \\kappa_n) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k(\\kappa_n) = 3Gu - k_0\n$$\n其中 $\\alpha = \\frac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ 且 $k_0 = \\frac{6 c \\cos \\varphi}{3 - \\sin \\varphi}$。\n\n如果 $f^{\\mathrm{tr}} \\le 0$，则该步为弹性。最终状态即为试算状态：$p=0$, $q=3Gu$。算法剪切模量为弹性模量，$\\mathbb{C}_{22}^{\\mathrm{alg}} = \\frac{\\partial q}{\\partial \\varepsilon_s} = \\frac{\\partial (3Gu)}{\\partial u} = 3G$。\n\n如果 $f^{\\mathrm{tr}} > 0$，则发生塑性变形。使用塑性乘子 $\\Delta\\lambda \\ge 0$ 更新状态变量：\n$$\np = p^{\\mathrm{tr}} - K \\Delta\\varepsilon_v^p = 0 - K \\alpha_g \\Delta\\lambda = -K\\alpha_g \\Delta\\lambda\n$$\n$$\nq = q^{\\mathrm{tr}} - 3G \\Delta\\varepsilon_s^p = 3Gu - 3G \\Delta\\lambda\n$$\n$$\n\\kappa = \\kappa_n + \\Delta\\lambda = \\Delta\\lambda\n$$\n其中 $\\alpha_g = \\frac{6 \\sin \\psi}{3 - \\sin \\psi}$。最终状态必须满足一致性条件 $f(p,q,\\kappa)=0$。\n\n**1. 最近点投影（CPP）算法**\n\n此算法精确地强制满足一致性条件。将更新后的状态变量代入屈服函数 $q + \\alpha p - k(\\kappa) = 0$：\n$$\n(3Gu - 3G\\Delta\\lambda) + \\alpha(-K\\alpha_g\\Delta\\lambda) - (k_0 + h(\\Delta\\lambda)^m) = 0\n$$\n整理后得到一个关于 $\\Delta\\lambda$ 的非线性标量方程：\n$$\nR(\\Delta\\lambda) = (3G + \\alpha K \\alpha_g)\\Delta\\lambda + h(\\Delta\\lambda)^m - f^{\\mathrm{tr}} = 0\n$$\n该方程使用局部 Newton-Raphson 方法求解 $\\Delta\\lambda$：$\\Delta\\lambda_{i+1} = \\Delta\\lambda_i - R(\\Delta\\lambda_i)/R'(\\Delta\\lambda_i)$，其中 $R'(\\Delta\\lambda) = (3G + \\alpha K \\alpha_g) + hm(\\Delta\\lambda)^{m-1}$。\n\n算法切线模量 $\\mathbb{C}_{22}^{\\mathrm{alg, CPP}} = \\frac{\\partial q}{\\partial u}$ 通过对定义最终状态的方程组关于 $u$ 求导得出。对一致性条件 $q + \\alpha p - k(\\kappa) = 0$ 求导得到：\n$$\n\\frac{\\partial q}{\\partial u} + \\alpha \\frac{\\partial p}{\\partial u} - \\frac{dk}{d\\kappa}\\frac{\\partial \\kappa}{\\partial u} = 0\n$$\n使用 $\\frac{\\partial p}{\\partial u} = -K\\alpha_g \\frac{\\partial\\Delta\\lambda}{\\partial u}$，$\\frac{\\partial q}{\\partial u} = 3G - 3G\\frac{\\partial\\Delta\\lambda}{\\partial u}$，$\\frac{\\partial\\kappa}{\\partial u} = \\frac{\\partial\\Delta\\lambda}{\\partial u}$，并定义硬化模量 $H_\\kappa = \\frac{dk}{d\\kappa} = hm\\kappa^{m-1} = hm(\\Delta\\lambda)^{m-1}$，我们可以求解 $\\frac{\\partial\\Delta\\lambda}{\\partial u}$：\n$$\n(3G - 3G\\frac{\\partial\\Delta\\lambda}{\\partial u}) + \\alpha(-K\\alpha_g\\frac{\\partial\\Delta\\lambda}{\\partial u}) - H_\\kappa \\frac{\\partial\\Delta\\lambda}{\\partial u} = 0 \\implies \\frac{\\partial\\Delta\\lambda}{\\partial u} = \\frac{3G}{3G + \\alpha K \\alpha_g + H_\\kappa}\n$$\n将此结果代回 $\\frac{\\partial q}{\\partial u}$ 的表达式中：\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg, CPP}} = 3G\\left(1 - \\frac{3G}{3G + \\alpha K \\alpha_g + H_\\kappa}\\right) = 3G \\frac{\\alpha K \\alpha_g + H_\\kappa}{3G + \\alpha K \\alpha_g + H_\\kappa}\n$$\n这是一致性切线模量。注意它通过 $H_\\kappa$ 依赖于最终状态。\n\n**2. 切平面（CP）算法**\n\n此算法基于加载步开始时硬化定律的线性化，对 $\\Delta\\lambda$ 使用显式更新。硬化模量在 $\\kappa_n=0$ 处评估：\n$$\nH_{\\kappa,n} = \\left. \\frac{dk}{d\\kappa} \\right|_{\\kappa_n=0} = \\begin{cases} h  \\text{if } m=1 \\\\ 0  \\text{if } m>1 \\end{cases}\n$$\n然后塑性乘子被显式计算为：\n$$\n\\Delta\\lambda = \\frac{f^{\\mathrm{tr}}}{3G + \\alpha K \\alpha_g + H_{\\kappa,n}}\n$$\n用这个 $\\Delta\\lambda$，计算最终应力 $q = 3Gu - 3G\\Delta\\lambda$。对于非线性硬化（$m>1$），所得状态通常不精确地位于屈服面上。\n\n相应的算法切线 $\\mathbb{C}_{22}^{\\mathrm{alg, CP}}$ 是应力函数 $q_{CP}(u)$ 的导数。由于 $\\Delta\\lambda$ 是 $f^{\\mathrm{tr}}$ 的线性函数，而 $f^{\\mathrm{tr}}$ 是 $u$ 的线性函数，所以对于塑性步，$q_{CP}(u)$ 的整个表达式是关于 $u$ 的线性函数。切线的推导与 CPP 情况类似，但使用恒定的初始硬化模量 $H_{\\kappa,n}$ 而不是状态相关的 $H_\\kappa$：\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg, CP}} = 3G \\frac{\\alpha K \\alpha_g + H_{\\kappa,n}}{3G + \\alpha K \\alpha_g + H_{\\kappa,n}}\n$$\n对于所有塑性状态（$u > k_0/(3G)$），此切线是恒定的。\n\n**3. 全局 Newton-Raphson 求解器**\n\n需要求解的平衡方程是 $r(u) = q(u) - Q_{\\mathrm{ext}} = 0$。N-R 格式为：\n$$\nu_{k+1} = u_k - \\frac{r(u_k)}{J(u_k)}\n$$\n其中 $u_k$ 是迭代值，$r(u_k) = q(u_k) - Q_{\\mathrm{ext}}$ 是残差，$J(u_k) = \\frac{\\partial q}{\\partial u}|_{u_k} = \\mathbb{C}_{22}^{\\mathrm{alg}}(u_k)$ 是雅可比矩阵。对于每个 N-R 迭代，用当前的 $u_k$ 调用相应算法（CPP 或 CP）的本构更新来获得应力 $q(u_k)$ 和切线 $J(u_k)$。\n\n在情况3中出现一个特殊情况（理想塑性，非剪胀），其中 $h=0$ 和 $\\psi=0$ ($\\alpha_g=0$)。对于塑性步，两种算法都给出算法切线 $\\mathbb{C}_{22}^{\\mathrm{alg}}=0$。当载荷 $Q_{\\mathrm{ext}}$ 超过屈服强度 $k_0$ 时，这个奇点会阻止 N-R 方法的收敛，因为残差无法减小到零，更新步也变得未定义。实现将检测到此情况并终止，达到最大迭代次数。\n\n对于此一维问题中的 CP 算法，由于塑性响应 $q_{CP}(u)$ 是关于 $u$ 的线性函数，使用相应切线的 N-R 方法将精确地在两次迭代内收敛（一次弹性猜测，一次塑性修正得到线性化问题的精确解）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general plastic, nonlinear hardening)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 10, 'c': 10, 'h': 8000, 'm': 2, 'Q_ext': 150},\n        # Case 2 (elastic boundary)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 10, 'c': 10, 'h': 8000, 'm': 2, 'Q_ext': 10},\n        # Case 3 (no hardening, perfectly plastic)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 0, 'c': 10, 'h': 0, 'm': 1, 'Q_ext': 60},\n        # Case 4 (non-associative, strong nonlinear hardening)\n        {'K': 50000, 'G': 20000, 'phi': 35, 'psi': 2, 'c': 5, 'h': 12000, 'm': 2.5, 'Q_ext': 80},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = _solve_for_case(case_params)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef _solve_for_case(params):\n    \"\"\"\n    Solves the equilibrium problem for a single set of parameters.\n    \"\"\"\n    K, G, phi_deg, psi_deg, c, h, m, Q_ext = params.values()\n\n    phi = np.deg2rad(phi_deg)\n    psi = np.deg2rad(psi_deg)\n\n    sin_phi, cos_phi = np.sin(phi), np.cos(phi)\n    sin_psi = np.sin(psi)\n    \n    alpha = (6 * sin_phi) / (3 - sin_phi)\n    k0 = (6 * c * cos_phi) / (3 - sin_phi)\n    alpha_g = (6 * sin_psi) / (3 - sin_psi)\n\n    # --- Closest-Point Projection (CPP) Solver ---\n    def constitutive_update_cpp(u):\n        q_tr = 3 * G * u\n        f_tr = q_tr - k0\n        \n        if f_tr = 1e-12:  # Elastic step\n            return q_tr, 3 * G\n        \n        # Plastic step: local N-R for delta_lambda\n        H_const = 3 * G + alpha * K * alpha_g\n        dl = 0.0\n        for _ in range(50):\n            dl = max(0, dl)\n            R = H_const * dl + h * np.power(dl, m) - f_tr\n            if abs(R)  1e-12: break\n            \n            H_kappa = h * m * np.power(dl, m - 1) if m > 1 or dl > 0 else (h if m == 1 else 0)\n            R_prime = H_const + H_kappa\n            if abs(R_prime)  1e-12: break\n            dl -= R / R_prime\n\n        q = q_tr - 3 * G * dl\n        kappa = dl\n        \n        H_kappa_final = h * m * np.power(kappa, m - 1) if m > 1 or kappa > 0 else (h if m == 1 else 0)\n        denominator = H_const + H_kappa_final\n        C22_alg = 3 * G * (alpha * K * alpha_g + H_kappa_final) / denominator if abs(denominator) > 1e-12 else 0.0\n\n        return q, C22_alg\n\n    u_cpp = 0.0\n    iters_cpp = 0\n    for i in range(1, 51):\n        q_cpp, J_cpp = constitutive_update_cpp(u_cpp)\n        r = q_cpp - Q_ext\n        iters_cpp = i\n        if abs(r)  1e-6: break\n        if abs(J_cpp)  1e-9:\n            iters_cpp = 50\n            break\n        u_cpp -= r / J_cpp\n    else: iters_cpp = 50\n    _, C22_cpp_final = constitutive_update_cpp(u_cpp)\n\n    # --- Cutting-Plane (CP) Solver ---\n    def constitutive_update_cp(u):\n        q_tr = 3 * G * u\n        f_tr = q_tr - k0\n        \n        if f_tr = 1e-12:  # Elastic step\n            return q_tr, 3 * G\n\n        H_kappa_n = h if m == 1 else 0.0\n        denominator = 3 * G + alpha * K * alpha_g + H_kappa_n\n        \n        dl = max(0, f_tr / denominator) if abs(denominator) > 1e-12 else (np.inf if f_tr > 0 else 0)\n        q = q_tr - 3 * G * dl\n        \n        C22_alg = 3 * G * (alpha * K * alpha_g + H_kappa_n) / denominator if abs(denominator) > 1e-12 else 0.0\n        return q, C22_alg\n\n    u_cp = 0.0\n    iters_cp = 0\n    for i in range(1, 51):\n        q_cp, J_cp = constitutive_update_cp(u_cp)\n        r = q_cp - Q_ext\n        iters_cp = i\n        if abs(r)  1e-6: break\n        if abs(J_cp)  1e-9:\n            iters_cp = 50\n            break\n        u_cp -= r / J_cp\n    else: iters_cp = 50\n    _, C22_cp_final = constitutive_update_cp(u_cp)\n\n    tangent_diff = abs(C22_cpp_final - C22_cp_final)\n    cpp_faster = bool(iters_cpp  iters_cp)\n\n    # Format each result entry to avoid scientific notation for integers\n    return [iters_cpp, iters_cp, tangent_diff, cpp_faster]\n\nsolve()\n```", "id": "3534631"}]}