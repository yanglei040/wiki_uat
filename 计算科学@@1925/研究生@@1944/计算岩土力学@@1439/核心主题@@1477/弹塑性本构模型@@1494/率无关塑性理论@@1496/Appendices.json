{"hands_on_practices": [{"introduction": "本练习将塑性理论简化到其在一维环境下的基本组成部分。通过分析一个简单的单轴杆，我们可以清晰地追踪从弹性到塑性行为的演化过程，从而对加法应变分解和一致性条件等概念建立基础性的理解。在处理复杂的三维模型之前，这种基于第一性原理的推导是至关重要的第一步。[@problem_id:3554857]", "problem": "考虑一根由均质岩土材料制成的棱柱形单轴杆，处于小应变、等温条件下。该材料遵循一维率无关理想塑性模型，其应变可加性分解为 $\\,\\epsilon = \\epsilon^{e} + \\epsilon^{p}\\,$，线性弹性关系为 $\\,\\sigma = E\\,\\epsilon^{e}\\,$，屈服函数为 $\\,f(\\sigma) = |\\sigma| - Y\\,$，其中屈服应力 $\\,Y > 0\\,$ 为常数。塑性流动是相关的且率无关的，满足库恩–塔克（Kuhn–Tucker）条件 $\\,\\lambda \\ge 0\\,$, $\\,f(\\sigma) \\le 0\\,$, $\\,\\lambda\\,f(\\sigma) = 0\\,$，塑性应变率为 $\\,\\dot{\\epsilon}^{p} = \\lambda\\,\\partial f/\\partial \\sigma\\,$。假设加载历史为单调拉伸应变，因此在塑性加载过程中 $\\,\\sigma \\ge 0\\,$ 且 $\\,\\partial f/\\partial \\sigma = 1\\,$。\n\n总应变被规定为 $\\,\\epsilon(t) = \\alpha\\,t\\,$，对于 $\\,t \\in [0,T]\\,$，且 $\\,\\epsilon(0) = 0\\,$. 参数为 $\\,E = 100\\,\\mathrm{MPa}\\,$, $\\,Y = 1\\,\\mathrm{MPa}\\,$, $\\,\\alpha = 0.005\\,\\mathrm{s}^{-1}\\,$ 及 $\\,T = 10\\,\\mathrm{s}\\,$。初始塑性应变为零，$\\,\\epsilon^{p}(0) = 0\\,$.\n\n仅使用上述定义和率无关塑性原理，从第一性原理推导：\n- 在 $\\,t \\in [0,T]\\,$ 区间上 $\\,\\epsilon^{e}(t)\\,$ 和 $\\,\\epsilon^{p}(t)\\,$ 的分段演化过程，\n- 塑性开始的时刻 $\\,t_{y}\\,$ 以及屈服时的一致性条件，\n- 然后计算最终塑性应变 $\\,\\epsilon^{p}(T)\\,$。\n\n将最终答案表示为单个数值 $\\,\\epsilon^{p}(T)\\,$（无量纲）。将您的答案四舍五入至四位有效数字。", "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n- **本构模型**：率无关、理想塑性、一维、小应变、等温条件。\n- **应变分解**：$\\epsilon = \\epsilon^{e} + \\epsilon^{p}$。\n- **弹性定律**：$\\sigma = E\\,\\epsilon^{e}$。\n- **屈服函数**：$f(\\sigma) = |\\sigma| - Y$，其中屈服应力 $Y > 0$ 为常数。\n- **流动法则（库恩–塔克条件）**：$\\lambda \\ge 0$, $f(\\sigma) \\le 0$, $\\lambda\\,f(\\sigma) = 0$。\n- **塑性应变率**：$\\dot{\\epsilon}^{p} = \\lambda\\,\\frac{\\partial f}{\\partial \\sigma}$。\n- **加载假设**：单调拉伸应变，意味着 $\\sigma \\ge 0$ 且因此 $\\frac{\\partial f}{\\partial \\sigma} = 1$。\n- **规定的总应变**：$\\epsilon(t) = \\alpha\\,t$，对于 $t \\in [0,T]$。\n- **初始条件**：$\\epsilon(0) = 0$，$\\epsilon^{p}(0) = 0$。\n- **参数**：$E = 100\\,\\mathrm{MPa}$，$Y = 1\\,\\mathrm{MPa}$，$\\alpha = 0.005\\,\\mathrm{s}^{-1}$，$T = 10\\,\\mathrm{s}$。\n- **目标**：推导 $\\epsilon^{e}(t)$ 和 $\\epsilon^{p}(t)$ 的演化过程，求出塑性开始的时刻 $t_{y}$，解释一致性条件，并计算最终塑性应变 $\\epsilon^{p}(T)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题定义明确且有科学依据。\n- **科学依据**：该问题描述了典型的一维弹塑性模型，这是固体力学和岩土力学中的一个基本概念。所有方程和条件（应变加性分解、胡克定律、一维的类冯·米塞斯屈服准则、相关流动法则、库恩–塔克条件）都是率无关塑性理论的标准组成部分。\n- **适定性**：该问题提供了一套完整的材料参数（$E, Y$）、一个明确定义的加载历史（$\\epsilon(t) = \\alpha t$）以及必要的初始条件（$\\epsilon^p(0) = 0$）。这确保了可以确定唯一的解。\n- **目标**：问题使用连续介质力学中精确、标准且明确的术语进行陈述。\n- **一致性**：所提供的数据在量纲和物理上是一致的。设置中不包含矛盾。\n\n### 步骤 3：结论与行动\n问题是有效的。将按要求从第一性原理推导求解。\n\n### 推导\n\n分析分为两个阶段：初始弹性阶段和随后的塑性阶段。\n\n**1. 弹性阶段：$t \\in [0, t_y]$**\n\n最初，材料不受应力。施加应变时，响应是纯弹性的。在此阶段，没有塑性变形，因此 $\\epsilon^{p}(t) = 0$ 及其速率 $\\dot{\\epsilon}^{p}(t) = 0$。\n\n根据流动法则，$\\dot{\\epsilon}^{p} = \\lambda\\,\\frac{\\partial f}{\\partial \\sigma}$。由于对于拉伸加载，$\\frac{\\partial f}{\\partial \\sigma} = 1$，我们得到 $\\dot{\\epsilon}^{p} = \\lambda$。因此，在弹性阶段 $\\lambda = 0$。\n库恩–塔克条件要求 $\\lambda\\,f(\\sigma) = 0$ 和 $f(\\sigma) \\le 0$。由于 $\\lambda = 0$，对于严格的弹性响应，条件必须是 $f(\\sigma) < 0$。对于拉伸加载（$\\sigma \\ge 0$），即为 $f(\\sigma) = \\sigma - Y < 0$，这意味着 $\\sigma < Y$。\n\n应变演化由以下公式决定：\n- 总应变（给定）：$\\epsilon(t) = \\alpha\\,t$。\n- 应变分解：$\\epsilon(t) = \\epsilon^{e}(t) + \\epsilon^{p}(t)$。由于 $\\epsilon^{p}(t) = 0$，我们有 $\\epsilon^{e}(t) = \\epsilon(t) = \\alpha\\,t$。\n- 弹性定律：$\\sigma(t) = E\\,\\epsilon^{e}(t) = E\\,\\alpha\\,t$。\n\n当应力达到屈服强度 $Y$ 时，弹性阶段结束，塑性屈服开始，此时的时刻为 $t_{y}$。\n$$ \\sigma(t_y) = Y $$\n$$ E\\,\\alpha\\,t_{y} = Y $$\n求解塑性开始的时刻 $t_{y}$：\n$$ t_{y} = \\frac{Y}{E\\,\\alpha} $$\n此时，总应变为屈服应变 $\\epsilon_y$：\n$$ \\epsilon_y = \\epsilon(t_y) = \\alpha\\,t_y = \\frac{Y}{E} $$\n对于 $t \\le t_y$，应变分量的演化过程为：\n$$ \\epsilon^{e}(t) = \\alpha\\,t $$\n$$ \\epsilon^{p}(t) = 0 $$\n\n**2. 塑性阶段：$t \\in [t_y, T]$**\n\n对于 $t > t_y$，材料发生塑性变形。根据库恩–塔克条件，如果发生塑性流动（$\\lambda > 0$），则必须持续满足屈服条件，即 $f(\\sigma) = 0$。对于拉伸加载，这意味着：\n$$ \\sigma(t) = Y \\quad \\text{对于所有 } t \\ge t_y $$\n这是理想塑性状态，在塑性流动期间，应力保持在屈服值不变。\n\n**一致性条件**要求在塑性加载期间，应力状态保持在屈服面上。用率形式表示，这意味着 $\\dot{f} = 0$。对于我们的问题，这意味着 $\\dot{\\sigma} = 0$。\n我们用这个条件来求应变率。对时间微分弹性定律得到 $\\dot{\\sigma} = E\\,\\dot{\\epsilon}^{e}$。由于在塑性阶段 $\\dot{\\sigma}=0$，因此可得：\n$$ \\dot{\\epsilon}^{e}(t) = 0 \\quad \\text{对于 } t > t_y $$\n这意味着弹性应变保持在屈服开始时的值不变：\n$$ \\epsilon^{e}(t) = \\epsilon^{e}(t_y) = \\frac{\\sigma(t_y)}{E} = \\frac{Y}{E} \\quad \\text{对于所有 } t \\ge t_y $$\n现在我们分析总应变率。规定的总应变为 $\\epsilon(t) = \\alpha\\,t$，所以其率是恒定的：\n$$ \\dot{\\epsilon}(t) = \\alpha $$\n使用应变率的加性分解，$\\dot{\\epsilon} = \\dot{\\epsilon}^{e} + \\dot{\\epsilon}^{p}$，我们可以求得塑性应变率：\n$$ \\alpha = 0 + \\dot{\\epsilon}^{p}(t) $$\n$$ \\dot{\\epsilon}^{p}(t) = \\alpha \\quad \\text{对于 } t > t_y $$\n为了求得塑性应变 $\\epsilon^{p}(t)$，我们从塑性开始的时刻 $t_{y}$（此时 $\\epsilon^{p}(t_{y})=0$）对其率进行积分：\n$$ \\epsilon^{p}(t) = \\int_{t_y}^{t} \\dot{\\epsilon}^{p}(\\tau) \\,d\\tau = \\int_{t_y}^{t} \\alpha \\,d\\tau = \\alpha(t - t_y) $$\n代入 $t_y$ 的表达式：\n$$ \\epsilon^{p}(t) = \\alpha\\,t - \\alpha\\,t_y = \\alpha\\,t - \\frac{Y}{E} $$\n此表达式对 $t \\ge t_y$ 有效。\n\n**对于 $t \\in [0, T]$ 的分段演化总结**：\n- 塑性开始的时刻为 $t_y = \\frac{Y}{E\\,\\alpha}$。\n- 对于 $t \\in [0, t_y]$ （弹性区域）：\n  $$ \\epsilon^{e}(t) = \\alpha\\,t $$\n  $$ \\epsilon^{p}(t) = 0 $$\n- 对于 $t \\in [t_y, T]$ （塑性区域）：\n  $$ \\epsilon^{e}(t) = \\frac{Y}{E} $$\n  $$ \\epsilon^{p}(t) = \\alpha \\left( t - t_y \\right) = \\alpha\\,t - \\frac{Y}{E} $$\n\n**3. 最终计算**\n\n我们需要计算最终塑性应变 $\\epsilon^{p}(T)$。首先，我们必须计算 $t_{y}$ 以确认在给定的时间区间 $T = 10\\,\\mathrm{s}$ 内确实发生了塑性。\n使用给定的参数：$E = 100\\,\\mathrm{MPa}$，$Y = 1\\,\\mathrm{MPa}$，$\\alpha = 0.005\\,\\mathrm{s}^{-1}$。\n$$ t_{y} = \\frac{1\\,\\mathrm{MPa}}{(100\\,\\mathrm{MPa}) \\times (0.005\\,\\mathrm{s}^{-1})} = \\frac{1}{0.5}\\,\\mathrm{s} = 2\\,\\mathrm{s} $$\n由于 $t_y = 2\\,\\mathrm{s} < T = 10\\,\\mathrm{s}$，材料确实进入了塑性区域。\n\n现在我们可以使用为塑性阶段推导的表达式来计算最终塑性应变 $\\epsilon^{p}(T)$：\n$$ \\epsilon^{p}(T) = \\alpha (T - t_{y}) $$\n代入数值：\n$$ \\epsilon^{p}(10) = 0.005\\,\\mathrm{s}^{-1} \\times (10\\,\\mathrm{s} - 2\\,\\mathrm{s}) $$\n$$ \\epsilon^{p}(10) = 0.005 \\times 8 $$\n$$ \\epsilon^{p}(10) = 0.04 $$\n最终塑性应变是一个无量纲量。问题要求将答案四舍五入到四位有效数字。精确值为 $0.04$。表示为四位有效数字即为 $0.04000$。", "answer": "$$\\boxed{0.04000}$$", "id": "3554857"}, {"introduction": "进入三维空间后，我们不仅要回答材料何时屈服，还要回答它如何发生塑性变形。本问题引入了非关联流动法则这一关键概念，这对于真实地模拟岩土材料（如剪胀性，即剪切过程中的体积变化）的行为至关重要。通过从给定的塑性势函数计算塑性应变增量的方向，您将深入了解应力状态与塑性变形模式之间的关系。[@problem_id:3554872]", "problem": "一个饱和土样在小应变条件下，采用Mohr–Coulomb (MC)率无关塑性模型进行建模。应力和应变均采用压缩为正的符号约定。考虑一个三轴压缩应力状态，其主有效应力为 $\\,\\sigma_{1}^{\\prime} = 400\\,\\mathrm{kPa}\\,$, $\\,\\sigma_{2}^{\\prime} = 100\\,\\mathrm{kPa}\\,$ 和 $\\,\\sigma_{3}^{\\prime} = 100\\,\\mathrm{kPa}\\,$，因此 $\\,\\sigma_{1}^{\\prime} > \\sigma_{2}^{\\prime} = \\sigma_{3}^{\\prime}\\,$。三轴压缩分支的非关联塑性势 $\\,g\\,$ 由应力不变量定义如下：\n$$\ng(p,q) = q - M_{\\psi}\\,p,\n$$\n其中 $\\,p = (\\sigma_{1}^{\\prime} + \\sigma_{2}^{\\prime} + \\sigma_{3}^{\\prime})/3\\,$ 为平均有效应力，$\\,\\boldsymbol{s} = \\boldsymbol{\\sigma}^{\\prime} - p\\,\\boldsymbol{I}\\,$ 为偏应力，$\\,q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}\\,$ 为第二偏应力不变量。剪胀参数 $\\,M_{\\psi}\\,$ 由剪胀角 $\\,\\psi\\,$ 通过以下公式定义：\n$$\nM_{\\psi} = \\frac{6\\,\\sin\\psi}{3 - \\sin\\psi},\n$$\n其中 $\\,\\psi = 10^{\\circ}\\,$ (角度单位为度)。塑性流动法则是非关联形式 $\\,\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda\\,\\partial g/\\partial \\boldsymbol{\\sigma}^{\\prime}\\,$，其中 $\\,\\mathrm{d}\\lambda \\ge 0\\,$ 是塑性乘子。\n\n仅使用上述定义和标准不变量关系，推导在该应力状态下塑性应变增量的主方向，并计算主塑性应变增量之比 $\\,\\mathrm{d}\\varepsilon^{p}_{1}/\\mathrm{d}\\varepsilon^{p}_{3}\\,$。将答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它在科学上基于连续介质力学和率无关塑性理论的原理，是适定的（具有足够的信息以获得唯一解），并且使用标准术语进行了客观地表述。\n\n目标是计算主塑性应变增量之比 $\\mathrm{d}\\varepsilon^{p}_{1}/\\mathrm{d}\\varepsilon^{p}_{3}$。根据所给的非关联塑性流动法则，塑性应变增量张量 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 由下式给出：\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}^{\\prime}}\n$$\n其中 $\\mathrm{d}\\lambda \\ge 0$ 是塑性乘子，$g$ 是塑性势函数，$\\boldsymbol{\\sigma}^{\\prime}$ 是有效应力张量。因此，塑性应变增量的主分量与塑性势函数相对于有效应力张量的梯度的各主分量成正比。所求的比值为：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = \\frac{\\mathrm{d}\\lambda \\left(\\frac{\\partial g}{\\partial \\sigma_{1}^{\\prime}}\\right)}{\\mathrm{d}\\lambda \\left(\\frac{\\partial g}{\\partial \\sigma_{3}^{\\prime}}\\right)} = \\frac{\\partial g/\\partial \\sigma_{1}^{\\prime}}{\\partial g/\\partial \\sigma_{3}^{\\prime}}\n$$\n\n塑性势 $g$ 是应力不变量 $p$ 和 $q$ 的函数，即 $g(p, q)$。为了计算梯度 $\\partial g/\\partial \\boldsymbol{\\sigma}^{\\prime}$，我们使用链式法则：\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}^{\\prime}} = \\frac{\\partial g}{\\partial p} \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}^{\\prime}} + \\frac{\\partial g}{\\partial q} \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}^{\\prime}}\n$$\n\n$g(p, q) = q - M_{\\psi}\\,p$ 对不变量的偏导数为：\n$$\n\\frac{\\partial g}{\\partial p} = -M_{\\psi}\n$$\n$$\n\\frac{\\partial g}{\\partial q} = 1\n$$\n\n接下来，我们求应力不变量 $p$ 和 $q$ 相对于应力张量 $\\boldsymbol{\\sigma}^{\\prime}$ 的梯度。\n对于平均有效应力 $p = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\prime})$，其梯度是一个标准结果：\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}^{\\prime}} = \\frac{1}{3}\\boldsymbol{I}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量。\n\n对于第二偏应力不变量 $q = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$，其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma}^{\\prime} - p\\,\\boldsymbol{I}$ 是偏应力张量。其梯度在连续介质力学中也是一个标准结果：\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}^{\\prime}} = \\frac{3}{2q}\\boldsymbol{s}\n$$\n\n将这些分量代回 $\\partial g/\\partial \\boldsymbol{\\sigma}^{\\prime}$ 的链式法则表达式中：\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}^{\\prime}} = (-M_{\\psi})\\left(\\frac{1}{3}\\boldsymbol{I}\\right) + (1)\\left(\\frac{3}{2q}\\boldsymbol{s}\\right) = \\frac{3}{2q}\\boldsymbol{s} - \\frac{M_{\\psi}}{3}\\boldsymbol{I}\n$$\n\n这是一个张量表达式。由于给定的应力状态由其主应力定义，且塑性势在应力上是各向同性的，$\\boldsymbol{\\sigma}^{\\prime}$ 和 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 的主方向重合。我们可以计算梯度的各主分量：\n$$\n\\frac{\\partial g}{\\partial \\sigma_{i}^{\\prime}} = \\frac{3}{2q}s_{i} - \\frac{M_{\\psi}}{3}\n$$\n其中 $s_i$ 是偏应力张量的主分量。\n\n首先，我们计算给定应力状态下不变量的数值：$\\sigma_{1}^{\\prime} = 400\\,\\mathrm{kPa}$，$\\sigma_{2}^{\\prime} = 100\\,\\mathrm{kPa}$，以及 $\\sigma_{3}^{\\prime} = 100\\,\\mathrm{kPa}$。\n平均有效应力 $p$ 为：\n$$\np = \\frac{\\sigma_{1}^{\\prime} + \\sigma_{2}^{\\prime} + \\sigma_{3}^{\\prime}}{3} = \\frac{400 + 100 + 100}{3} = \\frac{600}{3} = 200\\,\\mathrm{kPa}\n$$\n主偏应力 $s_i = \\sigma_{i}^{\\prime} - p$ 为：\n$$\ns_{1} = 400 - 200 = 200\\,\\mathrm{kPa}\n$$\n$$\ns_{2} = 100 - 200 = -100\\,\\mathrm{kPa}\n$$\n$$\ns_{3} = 100 - 200 = -100\\,\\mathrm{kPa}\n$$\n对于三轴压缩状态（$\\sigma_{1}^{\\prime} > \\sigma_{2}^{\\prime} = \\sigma_{3}^{\\prime}$），不变量 $q$ 简单地为 $q = \\sigma_{1}^{\\prime} - \\sigma_{3}^{\\prime}$：\n$$\nq = 400 - 100 = 300\\,\\mathrm{kPa}\n$$\n\n现在我们可以计算梯度的各主分量：\n$$\n\\frac{\\partial g}{\\partial \\sigma_{1}^{\\prime}} = \\frac{3}{2(300)}(200) - \\frac{M_{\\psi}}{3} = 1 - \\frac{M_{\\psi}}{3}\n$$\n$$\n\\frac{\\partial g}{\\partial \\sigma_{3}^{\\prime}} = \\frac{3}{2(300)}(-100) - \\frac{M_{\\psi}}{3} = -\\frac{1}{2} - \\frac{M_{\\psi}}{3}\n$$\n\n塑性应变增量之比为：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = \\frac{1 - M_{\\psi}/3}{-1/2 - M_{\\psi}/3}\n$$\n为了简化，我们将分子和分母同乘以 $6$：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = \\frac{6(1 - M_{\\psi}/3)}{6(-1/2 - M_{\\psi}/3)} = \\frac{6 - 2M_{\\psi}}{-3 - 2M_{\\psi}} = -\\frac{6 - 2M_{\\psi}}{3 + 2M_{\\psi}}\n$$\n\n剪胀参数 $M_{\\psi}$ 定义为 $M_{\\psi} = \\frac{6\\,\\sin\\psi}{3 - \\sin\\psi}$，其中 $\\psi = 10^{\\circ}$。将其代入比值的表达式中：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = -\\frac{6 - 2\\left(\\frac{6\\sin\\psi}{3 - \\sin\\psi}\\right)}{3 + 2\\left(\\frac{6\\sin\\psi}{3 - \\sin\\psi}\\right)}\n$$\n为了简化此表达式，我们将主分数的分子和分母同乘以 $(3 - \\sin\\psi)$：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = -\\frac{6(3 - \\sin\\psi) - 12\\sin\\psi}{3(3 - \\sin\\psi) + 12\\sin\\psi} = -\\frac{18 - 6\\sin\\psi - 12\\sin\\psi}{9 - 3\\sin\\psi + 12\\sin\\psi}\n$$\n$$\n= -\\frac{18 - 18\\sin\\psi}{9 + 9\\sin\\psi} = -\\frac{18(1 - \\sin\\psi)}{9(1 + \\sin\\psi)} = -2\\frac{1 - \\sin\\psi}{1 + \\sin\\psi}\n$$\n这为该模型在三轴压缩条件下的塑性应变增量比提供了一个简化的解析表达式。\n\n最后，我们代入剪胀角的值 $\\psi = 10^{\\circ}$：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} = -2\\frac{1 - \\sin(10^{\\circ})}{1 + \\sin(10^{\\circ})}\n$$\n使用数值 $\\sin(10^{\\circ}) \\approx 0.173648$：\n$$\n\\frac{\\mathrm{d}\\varepsilon^{p}_{1}}{\\mathrm{d}\\varepsilon^{p}_{3}} \\approx -2\\frac{1 - 0.173648}{1 + 0.173648} = -2\\frac{0.826352}{1.173648} \\approx -2(0.704085) \\approx -1.40817\n$$\n四舍五入到四位有效数字，比值为 $-1.408$。负号表示在主主应力方向上的压缩性塑性应变增量（$\\mathrm{d}\\varepsilon^{p}_{1} > 0$）伴随着在次主应力方向上的拉伸性塑性应变增量（$\\mathrm{d}\\varepsilon^{p}_{3} < 0$），这对应于剪胀行为。", "answer": "$$\\boxed{-1.408}$$", "id": "3554872"}, {"introduction": "最后一个实践练习将理论与计算联系起来，这是现代计算岩土力学的基石。您的任务是为Mohr-Coulomb模型实现一个返回映射算法，该算法是几乎所有涉及塑性的有限元模拟的核心。本练习将挑战您处理屈服面在角点和边上的非光滑特性，这要求您严格应用次微分理论，以确保数值解的稳健性和准确性。[@problem_id:3554851]", "problem": "您的任务是为计算岩土力学中的 Mohr–Coulomb 模型设计并实现一个率无关弹塑性的算法应力更新。该更新必须在主应力空间中进行，并通过屈服函数的次微分严格处理角点和顶点的非光滑性。您编写的程序必须为一组固定的测试用例生成更新后的主应力。\n\n从以下小应变弹塑性的基本理论出发：\n- 柯西应力张量表示为 $\\boldsymbol{\\sigma}$，其主值为 $(\\sigma_1,\\sigma_2,\\sigma_3)$。\n- 线性各向同性弹性通过四阶弹性张量 $\\mathbb{D} = K \\,\\boldsymbol{I}\\otimes\\boldsymbol{I} + 2G\\,\\mathbb{I}^{\\text{dev}}$ 将应力增量与弹性应变增量关联起来，其中 $K$ 是体积模量，$G$ 是剪切模量，$\\boldsymbol{I}$ 是二阶单位张量，$\\mathbb{I}^{\\text{dev}}$ 是四阶偏量投影算子。\n- 率无关塑性由 Karush–Kuhn–Tucker (KKT) 条件控制，包括一个屈服函数 $f(\\boldsymbol{\\sigma}) \\le 0$、一个塑性乘子 $\\lambda \\ge 0$、一致性条件 $\\lambda f(\\boldsymbol{\\sigma}) = 0$ 以及流动法则 $d\\boldsymbol{\\varepsilon}^{p} = \\lambda\\,\\partial g(\\boldsymbol{\\sigma})$，其中 $g(\\boldsymbol{\\sigma})$ 是塑性势，当 $g$ 非光滑时，$\\partial g$ 是其次微分。\n- 假设小应变、各向同性，并且在返回映射期间主方向保持共轴。\n\n在此基础上，推导并实现：\n- 一个在主应力空间 $(\\sigma_1,\\sigma_2,\\sigma_3)$ 中表示的 Mohr–Coulomb 屈服函数 $f(\\boldsymbol{\\sigma})$。该函数是分段线性的，并在定义角点和棱边的 Lode 角值处非光滑。将压缩视为正值。屈服取决于摩擦角 $\\varphi$ 和粘聚力 $c$。您必须将非光滑屈服显式表示为 $(\\sigma_1,\\sigma_2,\\sigma_3)$ 中有限个线性形式的逐点最大值，并通过激活线性形式（即达到最大值的形式）的梯度之凸包来构造其次微分 $\\partial f(\\boldsymbol{\\sigma})$。\n- 一个具有剪胀角 $\\psi$ 的非关联塑性势 $g(\\boldsymbol{\\sigma})$，其结构（逐面线性形式）与屈服函数相似，其梯度或次梯度提供塑性流动方向。\n\n算法要求：\n- 在主应力空间中实现一个激活集返回映射算法，将给定的弹性试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 修正到容许集 $f(\\boldsymbol{\\sigma}) \\le 0$ 内。使用来自 $\\partial g$ 的流动方向和弹性张量 $\\mathbb{D}$ 来推导应力修正 $\\Delta\\boldsymbol{\\sigma} = -\\lambda\\,\\mathbb{D}:\\boldsymbol{n}$，其中 $\\boldsymbol{n} \\in \\partial g(\\boldsymbol{\\sigma})$ 是与激活集一致的次梯度。对激活面强制执行屈服等式和 KKT 条件。在角点和顶点处，将 $\\boldsymbol{n}$ 视为激活面法向量的凸组合，并求解凸权重和 $\\lambda$，以使修正后的应力精确位于由激活面定义的交线上。使用鲁棒的容差来检测多个激活面。\n- 显式处理面（一个激活线性形式）、棱（两个激活线性形式）和顶点（所有主应力相等且有多个激活形式）的情况。在顶点处，将次微分辨认为所有面法向量的凸包，并确保即使在不需要塑性修正时算法仍保持良定义。\n\n您还必须通过偏应力的第二和第三不变量计算主应力的 Lode 角 $\\theta$，并确保激活集逻辑与 Lode 角边界处的非光滑性一致。角度单位必须是弧度。\n\n必须指定并一致地使用数值和物理单位：\n- 应力单位使用兆帕 (MPa)。\n- 角度单位使用弧度。\n\n测试套件和输出规范：\n- 实现您的算法，并将其应用于以下测试用例，所有用例均采用各向同性线弹性，并以压缩为正的符号约定：\n    1. 光滑面返回，参数：摩擦角 $\\varphi = \\pi/6$ (即 $0.5235987756$ 弧度)，剪胀角 $\\psi = \\pi/18$ (即 $0.1745329252$ 弧度)，粘聚力 $c = 5$ MPa，体积模量 $K = 5000$ MPa，剪切模量 $G = 3000$ MPa，试探主应力 $(\\sigma_1^{\\text{tr}},\\sigma_2^{\\text{tr}},\\sigma_3^{\\text{tr}}) = (150,90,30)$ MPa。\n    2. 棱边情况返回，两个主应力相等以触发两个激活面：摩擦角 $\\varphi = \\pi/6$，剪胀角 $\\psi = \\pi/18$，粘聚力 $c = 5$ MPa，体积模量 $K = 5000$ MPa，剪切模量 $G = 3000$ MPa，试探主应力 $(\\sigma_1^{\\text{tr}},\\sigma_2^{\\text{tr}},\\sigma_3^{\\text{tr}}) = (200,60,60)$ MPa。\n    3. 顶点边界情况，所有主应力相等（预计无塑性修正，但次微分必须良定义）：摩擦角 $\\varphi = \\pi/6$，剪胀角 $\\psi = \\pi/18$，粘聚力 $c = 0$ MPa，体积模量 $K = 5000$ MPa，剪切模量 $G = 3000$ MPa，试探主应力 $(\\sigma_1^{\\text{tr}},\\sigma_2^{\\text{tr}},\\sigma_3^{\\text{tr}}) = (80,80,80)$ MPa。\n- 对于每个测试用例，计算更新后的主应力 $(\\sigma_1,\\sigma_2,\\sigma_3)$，单位为 MPa。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个项目本身是更新后主应力的列表，四舍五入到三位小数，例如：$[\\,[\\sigma_1,\\sigma_2,\\sigma_3],\\,[\\sigma_1,\\sigma_2,\\sigma_3],\\,[\\sigma_1,\\sigma_2,\\sigma_3]\\,]$。\n\n确保科学真实性和数值鲁棒性，包括合理的停止容差和对退化情况的处理。不允许用户输入；所有参数和测试用例必须嵌入程序中。最终输出必须严格遵守指定格式。", "solution": "我们从具有各向同性线弹性的小应变率无关弹塑性理论开始。弹性张量为 $\\mathbb{D} = K \\,\\boldsymbol{I}\\otimes\\boldsymbol{I} + 2G\\,\\mathbb{I}^{\\text{dev}}$，因此对于任何对称二阶张量 $\\boldsymbol{A}$，$\\mathbb{D}$ 的作用是\n$$\n\\mathbb{D}:\\boldsymbol{A} = K\\,\\text{tr}(\\boldsymbol{A})\\,\\boldsymbol{I} + 2G\\left(\\boldsymbol{A} - \\tfrac{1}{3}\\text{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}\\right).\n$$\nMohr–Coulomb 屈服函数是非光滑的，可以在主应力空间中表示为捕捉摩擦破坏面的有限个线性形式的逐点最大值。在压缩为正的约定下，一个方便的表示是\n$$\nf(\\boldsymbol{\\sigma}) = \\max_{i\\neq j} \\left\\{\\, (1-\\sin\\varphi)\\,\\sigma_i - (1+\\sin\\varphi)\\,\\sigma_j - 2c\\cos\\varphi \\,\\right\\},\n$$\n其中 $(i,j)\\in\\{(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)\\}$。此形式在 $(\\sigma_1,\\sigma_2,\\sigma_3)$ 空间中编码了六个平面，整体屈服面是它们的上包络。当多个面同时被激活，即达到最大值时，就会出现不可微性。\n\n非关联流动的塑性势 $g(\\boldsymbol{\\sigma})$ 的定义类似，但用剪胀角 $\\psi$ 代替 $\\varphi$：\n$$\ng(\\boldsymbol{\\sigma}) = \\max_{i\\neq j} \\left\\{\\, (1-\\sin\\psi)\\,\\sigma_i - (1+\\sin\\psi)\\,\\sigma_j - 2c\\cos\\psi \\,\\right\\}.\n$$\n对于单个激活面 $(i,j)$，塑性势相对于主应力的梯度是向量\n$$\n\\boldsymbol{n}^{(i,j)} = \\left(n_1,n_2,n_3\\right),\\quad n_k =\n\\begin{cases}\n(1-\\sin\\psi)  \\text{if } k=i,\\\\\n-(1+\\sin\\psi)  \\text{if } k=j,\\\\\n0  \\text{otherwise.}\n\\end{cases}\n$$\n在非光滑点（棱和顶点），次微分 $\\partial g(\\boldsymbol{\\sigma})$ 是所有激活面梯度的凸包。如果两个面被激活，$\\partial g$ 中的任何 $\\boldsymbol{n}$ 都可以写成 $\\boldsymbol{n} = \\alpha\\,\\boldsymbol{n}^{(i_1,j_1)} + (1-\\alpha)\\,\\boldsymbol{n}^{(i_2,j_2)}$，其中 $\\alpha\\in[0,1]$。如果三个或更多个面被激活（当 $\\sigma_1=\\sigma_2=\\sigma_3$ 时的顶点情况），我们有 $\\boldsymbol{n} = \\sum_{r=1}^m \\alpha_r\\,\\boldsymbol{n}^{(i_r,j_r)}$，其中 $\\alpha_r\\ge 0$ 且 $\\sum_r \\alpha_r = 1$。\n\n率无关流动法则是 $d\\boldsymbol{\\varepsilon}^{p} = \\lambda\\,\\boldsymbol{n}$，其中 $\\boldsymbol{n}\\in\\partial g$。返回映射步骤中的应力修正是通过对弹性张量强制执行弹塑性一致性获得的。对于给定的试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$，修正后的应力为\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\lambda\\,\\mathbb{D}:\\boldsymbol{n}.\n$$\n写成主分量形式，并令 $t = \\text{tr}(\\boldsymbol{n})$，单位塑性乘子的主应力修正为\n$$\n\\Delta\\sigma_k' \\equiv \\frac{d\\sigma_k}{d\\lambda} = -\\left[\\,K\\,t + 2G\\left(n_k - \\tfrac{1}{3}t\\right)\\,\\right],\\quad k\\in\\{1,2,3\\}.\n$$\n对于单个激活面 $(i,j)$，弹塑性一致性要求 $f^{(i,j)}(\\boldsymbol{\\sigma})=0$，即\n$$\n(1-\\sin\\varphi)\\,\\sigma_i - (1+\\sin\\varphi)\\,\\sigma_j - 2c\\cos\\varphi = 0.\n$$\n代入 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{tr}} + \\lambda\\,\\Delta\\boldsymbol{\\sigma}'$ 我们得到一个关于 $\\lambda$ 的线性方程：\n$$\n(1-\\sin\\varphi)\\,\\sigma_i^{\\text{tr}} - (1+\\sin\\varphi)\\,\\sigma_j^{\\text{tr}} - 2c\\cos\\varphi + \\lambda\\left[(1-\\sin\\varphi)\\,\\Delta\\sigma_i' - (1+\\sin\\varphi)\\,\\Delta\\sigma_j'\\right] = 0,\n$$\n由此得出\n$$\n\\lambda = \\frac{(1-\\sin\\varphi)\\,\\sigma_i^{\\text{tr}} - (1+\\sin\\varphi)\\,\\sigma_j^{\\text{tr}} - 2c\\cos\\varphi}{-\\left[(1-\\sin\\varphi)\\,\\Delta\\sigma_i' - (1+\\sin\\varphi)\\,\\Delta\\sigma_j'\\right]}.\n$$\n在具有两个激活面 $(i_1,j_1)$ 和 $(i_2,j_2)$ 的棱上，我们构造 $\\boldsymbol{n}(\\alpha) = \\alpha\\,\\boldsymbol{n}^{(i_1,j_1)} + (1-\\alpha)\\,\\boldsymbol{n}^{(i_2,j_2)}$。单位乘子应力修正则为 $\\Delta\\boldsymbol{\\sigma}'(\\alpha) = \\alpha\\,\\Delta\\boldsymbol{\\sigma}'^{(1)} + (1-\\alpha)\\,\\Delta\\boldsymbol{\\sigma}'^{(2)}$，其中 $\\Delta\\boldsymbol{\\sigma}'^{(r)}$ 是从 $\\boldsymbol{n}^{(i_r,j_r)}$ 计算得出的。强制两个激活面屈服得到两个线性等式：\n$$\n(1-\\sin\\varphi)\\,\\sigma_{i_r}^{\\text{tr}} - (1+\\sin\\varphi)\\,\\sigma_{j_r}^{\\text{tr}} - 2c\\cos\\varphi + \\lambda\\left[(1-\\sin\\varphi)\\,\\Delta\\sigma_{i_r}'(\\alpha) - (1+\\sin\\varphi)\\,\\Delta\\sigma_{j_r}'(\\alpha)\\right] = 0,\\quad r=1,2.\n$$\n可以通过形成比率来组合这些等式以消除 $\\lambda$：\n$$\n\\frac{(1-\\sin\\varphi)\\,\\Delta\\sigma_{i_1}'(\\alpha) - (1+\\sin\\varphi)\\,\\Delta\\sigma_{j_1}'(\\alpha)}{(1-\\sin\\varphi)\\,\\Delta\\sigma_{i_2}'(\\alpha) - (1+\\sin\\varphi)\\,\\Delta\\sigma_{j_2}'(\\alpha)} = \\frac{(1-\\sin\\varphi)\\,\\sigma_{i_1}^{\\text{tr}} - (1+\\sin\\varphi)\\,\\sigma_{j_1}^{\\text{tr}} - 2c\\cos\\varphi}{(1-\\sin\\varphi)\\,\\sigma_{i_2}^{\\text{tr}} - (1+\\sin\\varphi)\\,\\sigma_{j_2}^{\\text{tr}} - 2c\\cos\\varphi}.\n$$\n左侧是关于 $\\alpha$ 的线性函数，因为 $\\Delta\\boldsymbol{\\sigma}'(\\alpha)$ 是关于 $\\boldsymbol{n}(\\alpha)$ 的线性函数，从而给出了一个简单的关于 $\\alpha$ 的线性方程。一旦找到 $\\alpha$，就可以从任一个面等式获得 $\\lambda$，然后修正后的应力为 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{tr}} + \\lambda\\,\\Delta\\boldsymbol{\\sigma}'(\\alpha)$。\n\n在顶点处，当 $\\sigma_1 = \\sigma_2 = \\sigma_3$ 时，所有面产生相等的值，次微分 $\\partial g$ 是所有面法向量的凸包。然而，对于没有“帽子”的 Mohr–Coulomb 模型，当 $c\\ge 0$ 时，静水压力状态通常是弹性的（面形式取决于主应力之差和由粘聚力引起的常数偏移），因此不需要塑性修正。算法必须仍然能够检测到多个激活面并保持良定义。\n\n为了严格处理特定 Lode 角值处的非光滑性，我们根据主应力计算 Lode 角 $\\theta$。设 $p = (\\sigma_1 + \\sigma_2 + \\sigma_3)/3$ 为平均应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$ 为偏应力张量。则\n$$\nJ_2 = \\tfrac{1}{2}\\left(s_1^2 + s_2^2 + s_3^2\\right),\\quad J_3 = s_1 s_2 s_3,\n$$\nLode 角定义为\n$$\n\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2}\\,\\frac{J_3}{J_2^{3/2}},\\quad \\theta = \\tfrac{1}{3}\\arcsin\\left(\\sin(3\\theta)\\right),\n$$\n需要理解的是，当 $J_2 \\to 0$ 时，在顶点处的 $\\theta$ 是不确定的。在实践中，$\\theta$ 接近 $\\pm \\pi/6$ 处的非光滑性对应于两个面被激活的棱；我们的激活集策略通过在容差范围内检测面最大值的并列情况来识别这些情况。\n\n算法设计：\n- 计算所有面值 $f^{(i,j)}(\\boldsymbol{\\sigma}^{\\text{tr}})$。\n- 如果在容差范围内 $\\max f^{(i,j)} \\le 0$，则状态是弹性的；返回 $\\boldsymbol{\\sigma}^{\\text{tr}}$。\n- 否则，将所有在容差范围内达到最大值的面形成激活集 $\\mathcal{A}$。如果 $|\\mathcal{A}|=1$，通过求解 $\\lambda$ 并更新 $\\boldsymbol{\\sigma}$ 来执行单面返回。如果 $|\\mathcal{A}|\\ge 2$，从 $\\mathcal{A}$ 中选择两个面，并如上所述求解凸权重 $\\alpha$ 和 $\\lambda$；如果计算出的 $\\alpha$ 超出 $[0,1]$ 范围或分母退化，则退回到主导的单面。迭代激活集更新：重新计算 $f^{(i,j)}(\\boldsymbol{\\sigma})$，更新 $\\mathcal{A}$，并重复此过程，直到最大面值在容差范围内被驱动到零或激活集稳定。在顶点处，要么不发生修正（弹性），要么算法因所有面值相等且非正而平凡终止。\n\n数值选择：\n- 使用 $10^{-9}$ 的容差进行并列检测和屈服满足。\n- 角度单位为弧度；应力单位为 MPa。\n- 在输出中将最终主应力四舍五入到三位小数。\n\n测试用例讨论：\n- 情况 1 主要在单个面上产生超应力；激活集算法找到一个激活面并执行单面返回。\n- 情况 2 中 $\\sigma_2 = \\sigma_3$，导致两个面 $(1,2)$ 和 $(1,3)$ 同等激活；算法计算面法向量的凸组合并返回到交线（棱）上。\n- 情况 3 中 $\\sigma_1 = \\sigma_2 = \\sigma_3$ 且 $c = 0$ MPa；所有面值相等且非正，因此状态是弹性的；算法检测到顶点并返回试探应力不变，同时保持次微分的良定义。\n\n所实现的程序为指定的测试套件执行这些步骤，并打印一行包含每个用例更新后主应力的结果，结果用括号括起并四舍五入到三位小数。", "answer": "[[142.106,90.584,37.309],[159.273,80.363,80.363],[80.000,80.000,80.000]]", "id": "3554851"}]}