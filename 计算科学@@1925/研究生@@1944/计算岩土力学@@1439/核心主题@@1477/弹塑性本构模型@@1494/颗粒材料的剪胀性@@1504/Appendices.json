{"hands_on_practices": [{"introduction": "这项实践提供了解析实验数据的基本练习。通过分析一个假想三轴试验中的应力和应变增量，您将学习如何将总变形分解为弹性和塑性部分。这个过程对于分离出塑性体积变化至关重要，它直接量化了材料的剪胀性，并允许计算瞬时剪胀角 $\\psi$。[@problem_id:3517370]", "problem": "考虑施加于一个致密颗粒材料（砂土）的排水轴对称三轴压缩增量，其第二主应力等于第三主应力，$\\sigma_{2}=\\sigma_{3}$。采用岩土力学符号约定，其中应力和应变的压缩均为正值。该材料的可恢复响应被建模为线弹性，其体积模量为 $K$，剪切模量为 $G$；其不可逆（塑性）响应被建模为非关联莫尔-库仑模型，其塑性势以应力不变量表示为 $g(p',q)=q-p' N_{\\psi}$，其中 $p'$ 是平均有效应力，$q$ 是三轴应力度量。参数 $N_{\\psi}$ 通过 $N_{\\psi}=\\dfrac{6\\sin\\psi}{3-\\sin\\psi}$ 与瞬时剪胀角 $\\psi$ 相关。在整个过程中，使用常规的三轴不变量 $p'=\\dfrac{\\sigma_{1}+\\sigma_{2}+\\sigma_{3}}{3}$ 和 $q=\\sigma_{1}-\\sigma_{3}$，以及功共轭应变不变量 $\\varepsilon_{v}=\\varepsilon_{1}+\\varepsilon_{2}+\\varepsilon_{3}$ 和 $\\varepsilon_{s}=\\dfrac{2}{3}\\left(\\varepsilon_{1}-\\varepsilon_{3}\\right)$。\n\n施加一个小的应力增量，$\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$ 且 $\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$，因此 $\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$。弹性模量为 $K=50~\\mathrm{MPa}$ 和 $G=20~\\mathrm{MPa}$。在此增量过程中，测得的主应变增量为 $\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$ 和 $\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$。根据轴对称性，取 $\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$。\n\n从应力和应变不变量的定义、线弹性关系式 $\\mathrm{d}p'=K\\,\\mathrm{d}\\varepsilon_{v}^{e}$ 和 $\\mathrm{d}q=3G\\,\\mathrm{d}\\varepsilon_{s}^{e}$，以及非关联流动法则 $\\mathrm{d}\\varepsilon_{ij}^{p}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\sigma_{ij}}$ 出发，计算：\n\n1) 总不变量应变增量 $\\mathrm{d}\\varepsilon_{v}$ 和 $\\mathrm{d}\\varepsilon_{s}$，\n\n2) 弹性部分 $\\mathrm{d}\\varepsilon_{v}^{e}$ 和 $\\mathrm{d}\\varepsilon_{s}^{e}$，\n\n3) 塑性部分 $\\mathrm{d}\\varepsilon_{v}^{p}$ 和 $\\mathrm{d}\\varepsilon_{s}^{p}$，\n\n然后利用这些结果求得与此增量对应的瞬时剪胀角 $\\psi$。\n\n以度为单位表示 $\\psi$ 的最终值，并将答案四舍五入到四位有效数字。", "solution": "首先对问题进行验证，以确保其具有科学依据、提法恰当且客观。\n\n**第1步：提取已知条件**\n- 本构模型：线弹性与非关联莫尔-库仑塑性。\n- 加载：排水轴对称三轴压缩增量，$\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}$。\n- 符号约定：应力和应变的压缩为正。\n- 应力增量分量：$\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$，$\\mathrm{d}\\sigma_{2}=0~\\mathrm{kPa}$，$\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$。\n- 应变增量分量：$\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$，$\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$，$\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$。\n- 弹性模量：体积模量 $K=50~\\mathrm{MPa}$，剪切模量 $G=20~\\mathrm{MPa}$。\n- 应力不变量：$p'=\\dfrac{\\sigma_{1}+\\sigma_{2}+\\sigma_{3}}{3}$，$q=\\sigma_{1}-\\sigma_{3}$。\n- 应变不变量：$\\varepsilon_{v}=\\varepsilon_{1}+\\varepsilon_{2}+\\varepsilon_{3}$，$\\varepsilon_{s}=\\dfrac{2}{3}\\left(\\varepsilon_{1}-\\varepsilon_{3}\\right)$。\n- 塑性势函数：$g(p',q)=q-p' N_{\\psi}$。\n- 剪胀参数定义：$N_{\\psi}=\\dfrac{6\\sin\\psi}{3-\\sin\\psi}$。\n- 弹性本构律增量：$\\mathrm{d}p'=K\\,\\mathrm{d}\\varepsilon_{v}^{e}$，$\\mathrm{d}q=3G\\,\\mathrm{d}\\varepsilon_{s}^{e}$。\n- 塑性流动法则：$\\mathrm{d}\\varepsilon_{ij}^{p}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\sigma_{ij}}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在经典土力学和本构模型的框架内定义明确。所提供的不变量、弹性定律和塑性势的方程均为标准形式。材料参数（$K$，$G$）对于砂土是物理上现实的，应力/应变增量的大小也是合理的。关于“致密颗粒材料”经历塑性剪胀（如计算所示）的描述与已知的土体行为一致。问题是自洽的，并提供了求解剪胀角 $\\psi$ 所需的所有信息。不存在科学缺陷、不一致或模糊之处。\n\n**结论：** 问题有效。\n\n**第3步：求解**\n\n求解过程首先计算不变量形式的总应变增量，然后计算不变量形式的应力增量。接着，确定应变增量的弹性部分。塑性部分通过从总量中减去弹性部分得到。最后，利用塑性应变不变量的比值来确定剪胀角 $\\psi$。符号约定是压应力和压应变为正。\n\n1.  **计算总不变量应变增量（$\\mathrm{d}\\varepsilon_{v}$ 和 $\\mathrm{d}\\varepsilon_{s}$）：**\n    主应变增量已知为 $\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$ 和 $\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$。由于轴对称性，$\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$。\n    体积应变增量 $\\mathrm{d}\\varepsilon_{v}$ 是主应变增量之和：\n    $$\n    \\mathrm{d}\\varepsilon_{v} = \\mathrm{d}\\varepsilon_{1} + \\mathrm{d}\\varepsilon_{2} + \\mathrm{d}\\varepsilon_{3} = (1.20 \\times 10^{-3}) + (-1.00 \\times 10^{-3}) + (-1.00 \\times 10^{-3}) = -0.80 \\times 10^{-3}\n    $$\n    偏应变增量 $\\mathrm{d}\\varepsilon_{s}$ 为：\n    $$\n    \\mathrm{d}\\varepsilon_{s} = \\frac{2}{3}(\\mathrm{d}\\varepsilon_{1} - \\mathrm{d}\\varepsilon_{3}) = \\frac{2}{3}(1.20 \\times 10^{-3} - (-1.00 \\times 10^{-3})) = \\frac{2}{3}(2.20 \\times 10^{-3}) = \\frac{4.4}{3} \\times 10^{-3}\n    $$\n\n2.  **计算不变量应力增量（$\\mathrm{d}p'$ 和 $\\mathrm{d}q$）：**\n    主应力增量为 $\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$ 和 $\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$。\n    平均有效应力增量 $\\mathrm{d}p'$ 为：\n    $$\n    \\mathrm{d}p' = \\frac{\\mathrm{d}\\sigma_{1} + \\mathrm{d}\\sigma_{2} + \\mathrm{d}\\sigma_{3}}{3} = \\frac{25~\\mathrm{kPa} + 0 + 0}{3} = \\frac{25}{3}~\\mathrm{kPa}\n    $$\n    三轴应力度量增量 $\\mathrm{d}q$ 为：\n    $$\n    \\mathrm{d}q = \\mathrm{d}\\sigma_{1} - \\mathrm{d}\\sigma_{3} = 25~\\mathrm{kPa} - 0 = 25~\\mathrm{kPa}\n    $$\n\n3.  **计算弹性不变量应变增量（$\\mathrm{d}\\varepsilon_{v}^{e}$ 和 $\\mathrm{d}\\varepsilon_{s}^{e}$）：**\n    弹性模量为 $K=50~\\mathrm{MPa} = 50 \\times 10^3~\\mathrm{kPa}$ 和 $G=20~\\mathrm{MPa} = 20 \\times 10^3~\\mathrm{kPa}$。\n    弹性体积应变增量为：\n    $$\n    \\mathrm{d}\\varepsilon_{v}^{e} = \\frac{\\mathrm{d}p'}{K} = \\frac{\\frac{25}{3}~\\mathrm{kPa}}{50 \\times 10^3~\\mathrm{kPa}} = \\frac{25}{150 \\times 10^3} = \\frac{1}{6 \\times 10^3} = \\frac{1}{6} \\times 10^{-3}\n    $$\n    弹性偏应变增量为：\n    $$\n    \\mathrm{d}\\varepsilon_{s}^{e} = \\frac{\\mathrm{d}q}{3G} = \\frac{25~\\mathrm{kPa}}{3 \\times (20 \\times 10^3~\\mathrm{kPa})} = \\frac{25}{60 \\times 10^3} = \\frac{5}{12 \\times 10^3} = \\frac{5}{12} \\times 10^{-3}\n    $$\n\n4.  **计算塑性不变量应变增量（$\\mathrm{d}\\varepsilon_{v}^{p}$ 和 $\\mathrm{d}\\varepsilon_{s}^{p}$）：**\n    总应变增量是其弹性和塑性部分之和：$\\mathrm{d}\\boldsymbol{\\varepsilon} = \\mathrm{d}\\boldsymbol{\\varepsilon}^e + \\mathrm{d}\\boldsymbol{\\varepsilon}^p$。这也适用于不变量。\n    塑性体积应变增量为：\n    $$\n    \\mathrm{d}\\varepsilon_{v}^{p} = \\mathrm{d}\\varepsilon_{v} - \\mathrm{d}\\varepsilon_{v}^{e} = -0.80 \\times 10^{-3} - \\frac{1}{6} \\times 10^{-3} = \\left(-\\frac{4}{5} - \\frac{1}{6}\\right) \\times 10^{-3} = \\left(\\frac{-24 - 5}{30}\\right) \\times 10^{-3} = -\\frac{29}{30} \\times 10^{-3}\n    $$\n    负号表示塑性剪胀（体积增加）。\n    塑性偏应变增量为：\n    $$\n    \\mathrm{d}\\varepsilon_{s}^{p} = \\mathrm{d}\\varepsilon_{s} - \\mathrm{d}\\varepsilon_{s}^{e} = \\frac{4.4}{3} \\times 10^{-3} - \\frac{5}{12} \\times 10^{-3} = \\left(\\frac{22}{15} - \\frac{5}{12}\\right) \\times 10^{-3} = \\left(\\frac{88 - 25}{60}\\right) \\times 10^{-3} = \\frac{63}{60} \\times 10^{-3} = \\frac{21}{20} \\times 10^{-3}\n    $$\n\n5.  **计算剪胀角（$\\psi$）：**\n    塑性应变增量通过流动法则从塑性势 $g$ 导出。不变量通过 $\\mathrm{d}\\varepsilon_v^p = \\dot{\\lambda} \\frac{\\partial g}{\\partial p'}$ 和 $\\mathrm{d}\\varepsilon_s^p = \\dot{\\lambda} \\frac{\\partial g}{\\partial q}$ 相关联。\n    对于 $g(p',q)=q-p' N_{\\psi}$，我们有 $\\dfrac{\\partial g}{\\partial p'} = -N_{\\psi}$ 和 $\\dfrac{\\partial g}{\\partial q} = 1$。\n    因此，$\\mathrm{d}\\varepsilon_{v}^{p} = -\\dot{\\lambda} N_{\\psi}$ 且 $\\mathrm{d}\\varepsilon_{s}^{p} = \\dot{\\lambda}$。\n    取其比值可以消去塑性乘子 $\\dot{\\lambda}$：\n    $$\n    \\frac{\\mathrm{d}\\varepsilon_{v}^{p}}{\\mathrm{d}\\varepsilon_{s}^{p}} = -N_{\\psi}\n    $$\n    现在我们可以根据计算出的塑性应变不变量值来计算 $N_{\\psi}$：\n    $$\n    N_{\\psi} = -\\frac{\\mathrm{d}\\varepsilon_{v}^{p}}{\\mathrm{d}\\varepsilon_{s}^{p}} = -\\frac{-\\frac{29}{30} \\times 10^{-3}}{\\frac{21}{20} \\times 10^{-3}} = \\frac{29}{30} \\times \\frac{20}{21} = \\frac{29 \\times 2}{3 \\times 21} = \\frac{58}{63}\n    $$\n    问题给出了 $N_{\\psi}$ 和剪胀角 $\\psi$ 之间的关系：\n    $$\n    N_{\\psi} = \\frac{6\\sin\\psi}{3-\\sin\\psi}\n    $$\n    代入计算出的 $N_{\\psi}$ 值：\n    $$\n    \\frac{58}{63} = \\frac{6\\sin\\psi}{3-\\sin\\psi}\n    $$\n    求解 $\\sin\\psi$：\n    $$\n    58(3 - \\sin\\psi) = 63(6\\sin\\psi)\n    $$\n    $$\n    174 - 58\\sin\\psi = 378\\sin\\psi\n    $$\n    $$\n    174 = (378 + 58) \\sin\\psi = 436\\sin\\psi\n    $$\n    $$\n    \\sin\\psi = \\frac{174}{436} = \\frac{87}{218}\n    $$\n    通过取反正弦函数可以得到以度为单位的剪胀角：\n    $$\n    \\psi = \\arcsin\\left(\\frac{87}{218}\\right)\n    $$\n    数值上，$\\psi \\approx 23.51953^\\circ$。四舍五入到四位有效数字得到 $\\psi=23.52^\\circ$。", "answer": "$$\\boxed{23.52}$$", "id": "3517370"}, {"introduction": "在量化剪胀概念的基础上，本练习将重点转移到经典本构模型内的理论预测。您将为修正剑桥模型（Modified Cam-Clay model）推导剪胀比，证明剪胀并非一个随意的输入参数，而是取决于当前应力状态相对于临界状态的演生行为。此推导将阐明材料在剪切过程中从塑性压缩到膨胀的物理转变过程。[@problem_id:3517401]", "problem": "一个饱和各向同性粒状材料在小应变条件下，使用修正剑桥 (MCC) 模型框架，并采用有效应力和应变的標準三轴不变量进行建模。令平均有效应力为 $p'$，偏应力为 $q$，先期固结压力为 $p'_{c}$，临界状态应力比为 $M$（一个由临界状态摩擦决定的材料常数）。以不变量表示的 MCC 屈服函数为\n$$\nf(p',q,p'_{c}) \\equiv q^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0,\n$$\n且塑性流动是相关的，因此塑性应变率张量满足\n$$\n\\dot{\\varepsilon}_{ij}^{p} = \\dot{\\lambda} \\, \\frac{\\partial f}{\\partial \\sigma'_{ij}},\n$$\n其中 $\\sigma'_{ij}$ 是有效应力张量，$\\dot{\\lambda} \\ge 0$ 是塑性乘子。定义塑性体积应变率为 $\\dot{\\varepsilon}_{v}^{p} \\equiv \\dot{\\varepsilon}_{kk}^{p}$，功共轭的塑性剪切应变率不变量为 $\\dot{\\varepsilon}_{s}^{p}$，使得单位体积的塑性耗散为\n$$\n\\sigma'_{ij} \\dot{\\varepsilon}_{ij}^{p} = p' \\, \\dot{\\varepsilon}_{v}^{p} + q \\, \\dot{\\varepsilon}_{s}^{p}.\n$$\n考虑屈服面上的一个三轴压缩状态，其测得的应力比为 $\\eta \\equiv q/p'  0$。仅使用上述模型要素和不变量定义，推导瞬时塑性剪胀\n$$\nD \\equiv \\frac{\\dot{\\varepsilon}_{v}^{p}}{\\dot{\\varepsilon}_{s}^{p}}\n$$\n为一个仅依赖于 $\\eta$ 和 $M$ 的闭式表达式。然后，根据岩土力学的常规符号约定（压应变为正），就塑性体积收缩或膨胀来解释 $D$ 的符号和大小。将您的最终答案表示为仅含 $\\eta$ 和 $M$ 的单一解析表达式。无需进行数值计算，$D$ 是无量纲的，因此不需要单位。", "solution": "该问题是有效的，因为它科学地基于临界状态土力学理论，问题阐述清晰、客观且内部一致。\n\n塑性剪胀 $D$ 定义为塑性体积应变率 $\\dot{\\varepsilon}_{v}^{p}$ 与塑性剪切应变率 $\\dot{\\varepsilon}_{s}^{p}$ 之比：\n$$\nD \\equiv \\frac{\\dot{\\varepsilon}_{v}^{p}}{\\dot{\\varepsilon}_{s}^{p}}\n$$\n问题指出塑性流动是相关的。对于一个屈服函数 $f$ 以应力不变量 $p'$ 和 $q$ 表示的各向同性材料，相关流动法则规定 $(p', q)$ 平面中的塑性应变率矢量垂直于屈服面。塑性应变率不变量 $\\dot{\\varepsilon}_{v}^{p}$ 和 $\\dot{\\varepsilon}_{s}^{p}$ 分别与应力不变量 $p'$ 和 $q$ 功共轭，这由塑性耗散表达式 $\\sigma'_{ij} \\dot{\\varepsilon}_{ij}^{p} = p' \\, \\dot{\\varepsilon}_{v}^{p} + q \\, \\dot{\\varepsilon}_{s}^{p}$ 确立。因此，相关流动法则可以用这些不变量表示为：\n$$\n\\dot{\\varepsilon}_{v}^{p} = \\dot{\\Lambda} \\frac{\\partial f}{\\partial p'}\n$$\n$$\n\\dot{\\varepsilon}_{s}^{p} = \\dot{\\Lambda} \\frac{\\partial f}{\\partial q}\n$$\n其中 $\\dot{\\Lambda}$ 是一个非负塑性乘子（与张量法则中的 $\\dot{\\lambda}$ 成比例）。\n\n比率 $D$ 于是可以写成屈服函数的偏导数之比，因为乘子 $\\dot{\\Lambda}$ 会被消掉：\n$$\nD = \\frac{\\dot{\\Lambda} \\frac{\\partial f}{\\partial p'}}{\\dot{\\Lambda} \\frac{\\partial f}{\\partial q}} = \\frac{\\frac{\\partial f}{\\partial p'}}{\\frac{\\partial f}{\\partial q}}\n$$\n我们已知修正剑桥 (MCC) 屈服函数：\n$$\nf(p',q,p'_{c}) = q^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0\n$$\n现在，我们计算 $f$ 所需的偏导数：\n关于偏应力 $q$ 的偏导数为：\n$$\n\\frac{\\partial f}{\\partial q} = 2q\n$$\n关于平均有效应力 $p'$ 的偏导数为：\n$$\n\\frac{\\partial f}{\\partial p'} = \\frac{\\partial}{\\partial p'} \\left( q^{2} + M^{2} (p')^{2} - M^{2} p' p'_{c} \\right) = 2 M^{2} p' - M^{2} p'_{c} = M^{2} (2p' - p'_{c})\n$$\n将这些导数代入 $D$ 的表达式中，我们得到：\n$$\nD = \\frac{M^{2} (2p' - p'_{c})}{2q}\n$$\n该表达式目前依赖于状态变量 $p'$、$q$ 和先期固结压力 $p'_{c}$。问题要求最终答案以应力比 $\\eta \\equiv q/p'$ 和材料常数 $M$ 来表示。为达到此目的，我们必须消去 $p'_{c}$。由于材料状态位于屈服面上，必须满足屈服条件 $f=0$。我们可以重排屈服函数来求解 $p'_{c}$：\n$$\nq^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0\n$$\n$$\nM^{2} p' \\left(p' - p'_{c}\\right) = -q^{2}\n$$\n假设 $p' \\neq 0$ 且 $M \\neq 0$：\n$$\np' - p'_{c} = -\\frac{q^{2}}{M^{2}p'}\n$$\n$$\np'_{c} = p' + \\frac{q^{2}}{M^{2}p'}\n$$\n现在，将这个 $p'_{c}$ 的表达式代回 $D$ 的方程中：\n$$\nD = \\frac{M^{2} \\left(2p' - \\left(p' + \\frac{q^{2}}{M^{2}p'}\\right)\\right)}{2q} = \\frac{M^{2} \\left(p' - \\frac{q^{2}}{M^{2}p'}\\right)}{2q}\n$$\n将分子中的 $M^{2}$ 项分配进去，得到：\n$$\nD = \\frac{M^{2}p' - \\frac{q^{2}}{p'}}{2q}\n$$\n为了用 $\\eta = q/p'$ 来表示，我们可以将分子和分母同时除以 $p'$：\n$$\nD = \\frac{M^{2} - \\frac{q^{2}}{(p')^{2}}}{2\\frac{q}{p'}}\n$$\n代入 $\\eta = q/p'$，得到剪胀的最终闭式表达式：\n$$\nD = \\frac{M^{2} - \\eta^{2}}{2\\eta}\n$$\n问题还要求解释 $D$ 的符号和大小。根据岩土力学中压应变为正的符号约定，并注意到对于三轴压缩 $\\eta  0$ 且剪切意味着 $\\dot{\\varepsilon}_{s}^{p}  0$， $D$ 的符号由塑性体积应变率 $\\dot{\\varepsilon}_{v}^{p}$ 的符号决定，而后者又由分子 $M^{2} - \\eta^{2}$ 的符号给出。\n1.  如果 $\\eta  M$：状态为“亚临界”状态或位于临界状态线的“湿侧”。在这种情况下，$M^{2} - \\eta^{2}  0$，所以 $D  0$。这意味着 $\\dot{\\varepsilon}_{v}^{p}  0$，表示塑性压缩（体积减小）。\n2.  如果 $\\eta  M$：状态为“超临界”状态或位于临界状态线的“干侧”。在这种情况下，$M^{2} - \\eta^{2}  0$，所以 $D  0$。这意味着 $\\dot{\\varepsilon}_{v}^{p}  0$，表示塑性剪胀（体积增大）。\n3.  如果 $\\eta = M$：状态处于“临界状态”。在这种情况下，$M^{2} - \\eta^{2} = 0$，所以 $D = 0$。这意味着 $\\dot{\\varepsilon}_{v}^{p} = 0$，表示等体积塑性剪切（净体积应变为零）。\n\n$D$ 的大小代表瞬时塑性体积变化与塑性剪切变形之比。当应力状态接近临界状态线时（$\\eta \\to M$），该比率趋近于零。", "answer": "$$\n\\boxed{\\frac{M^{2} - \\eta^{2}}{2\\eta}}\n$$", "id": "3517401"}, {"introduction": "这最后一个实践通过指导您实现一个数值模型，从而将理论与应用联系起来。您将为一个非关联莫尔-库仑模型（non-associated Mohr-Coulomb model）构建并编写一个返回映射算法（return-mapping algorithm），这是现代计算岩土力学的基石。该练习直接应用剪胀角 $\\psi$ 的概念来控制塑性流动向量，让您亲身体验本构律如何被转化为具有预测能力的模拟工具。[@problem_id:3517443]", "problem": "考虑计算岩土力学中的一个小应变、率无关、理想塑性、非关联 Mohr–Coulomb 模型，该模型以各向同性应力-应变不变量表示。使用以下基本假设：\n\n- 符号约定为压为正。定义平均（压力）应力不变量为 $p = \\left(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}\\right)/3$，偏应力不变量为 $q = \\sqrt{3\\,J_{2}}$，其中 $J_{2}$ 是 Cauchy 应力张量的第二偏不变量。\n- 弹性定律为线性各向同性，具有 Young 模量 $E$ 和 Poisson 比 $\\nu$。体积模量为 $K = \\dfrac{E}{3\\left(1 - 2\\nu\\right)}$，剪切模量为 $G = \\dfrac{E}{2\\left(1 + \\nu\\right)}$。\n- 在 $p$–$q$ 空间中，三轴压缩的 Mohr–Coulomb 屈服函数为\n$$\nf\\left(q,p\\right) = q - M_{\\varphi}\\,p - c_{0},\n$$\n其中对于任意角度 $\\alpha$，有 $M_{\\alpha} = \\dfrac{6\\sin\\alpha}{3 - \\sin\\alpha}$，$\\varphi$ 是摩擦角，$c$ 是黏聚力，且\n$$\nc_{0} = \\dfrac{6\\,c\\,\\cos\\varphi}{3 - \\sin\\varphi}.\n$$\n- 塑性势取为\n$$\ng\\left(q,p\\right) = q - M_{\\psi}\\,p,\n$$\n其中 $\\psi$ 为剪胀角。流动法则是非关联的，塑性应变增量根据功共轭不变量对定义为\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial p}, \\quad \\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial q},\n$$\n其中 $\\varepsilon_{v}^{p}$ 是塑性体积应变，$\\varepsilon_{s}^{p}$ 是等效塑性剪切应变，$\\lambda \\ge 0$ 是塑性乘子。\n- 对于给定的总应变增量，不变量形式的弹性预测（试探状态）为 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$。屈服时的应力修正是由从试探状态开始的弹性卸载和塑性流动共同决定的：\n$$\np = p^{\\mathrm{tr}} - K\\,\\mathrm{d}\\varepsilon_{v}^{p}, \\quad q = q^{\\mathrm{tr}} - 3\\,G\\,\\mathrm{d}\\varepsilon_{s}^{p}.\n$$\n\n任务 A。严格从上述基础出发，为此非关联 Mohr–Coulomb 模型建立一个不变量形式的返回映射算法。在不假设任何额外本构捷径的情况下，推导三轴压缩分支的塑性乘子增量 $\\lambda$ 的闭式表达式，并由此推导出以试探不变量 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ 和材料参数 $\\left(E,\\nu,\\varphi,\\psi,c\\right)$ 表示的塑性应变增量 $\\mathrm{d}\\varepsilon_{v}^{p}$ 和 $\\mathrm{d}\\varepsilon_{s}^{p}$ 的显式更新方程。说明如何在增量步结束时计算修正后的不变量 $\\left(p, q\\right)$。对于塑性加载，必须满足一致性条件 $f\\left(q,p\\right) = 0$。如果试探状态是容许的，即 $f\\left(q^{\\mathrm{tr}},p^{\\mathrm{tr}}\\right) \\le 0$，则该步为弹性步，塑性增量必须为零。\n\n任务 B。将推导出的返回映射算法实现为一个程序。对于每个提供的测试用例，该程序以 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$、$E$、$\\nu$、$\\varphi$、$\\psi$ 和 $c$ 作为输入，并为该用例输出四个量 $\\left[\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}, p, q\\right]$。使用以下要求：\n\n- 单位和角度：\n  - 所有应力 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}, p, q, c\\right)$ 必须以帕斯卡（Pa）表示。\n  - 所有角度 $\\left(\\varphi,\\psi\\right)$ 必须以弧度表示。\n  - 应变 $\\left(\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}\\right)$ 是无量纲的。\n- 数值输出格式：\n  - 将每个浮点输出表示为科学记数法的小数，小数点后恰好有 $10$ 位数字（例如，使用 $a.bbbbbbbbbe\\pm cc$ 这样的格式）。\n- 最终输出格式：\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容是按顺序连接的所有测试用例的结果。对于 $N$ 个测试用例，输出必须为\n  $$\n  \\left[\\mathrm{d}\\varepsilon_{v,1}^{p},\\mathrm{d}\\varepsilon_{s,1}^{p},p_{1},q_{1},\\dots,\\mathrm{d}\\varepsilon_{v,N}^{p},\\mathrm{d}\\varepsilon_{s,N}^{p},p_{N},q_{N}\\right].\n  $$\n\n测试套件。使用 $5$ 个用例，涵盖弹性、临界屈服和塑性响应，包括边界条件：\n\n- 用例 1 (弹性未屈服)：$E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$，$\\nu = 0.3$，$\\varphi = \\dfrac{\\pi}{6}$，$\\psi = \\dfrac{\\pi}{18}$，$c = 1.0\\times 10^{4}\\,\\mathrm{Pa}$，$p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$，$q^{\\mathrm{tr}} = 1.5\\times 10^{5}\\,\\mathrm{Pa}$。\n- 用例 2 (位于屈服面上)：相同的 $E$、$\\nu$、$\\varphi$、$\\psi$、$c$，$p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$，且 $q^{\\mathrm{tr}}$ 精确设置为 $q^{\\mathrm{tr}} = M_{\\varphi}\\,p^{\\mathrm{tr}} + c_{0}$。\n- 用例 3 (塑性，非关联)：相同的 $E$、$\\nu$、$\\varphi$、$\\psi$、$c$，$p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$，$q^{\\mathrm{tr}} = 4.0\\times 10^{5}\\,\\mathrm{Pa}$。\n- 用例 4 (塑性，零剪胀)：$E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$，$\\nu = 0.3$，$\\varphi = \\dfrac{\\pi}{6}$，$\\psi = 0$，$c = 0$，$p^{\\mathrm{tr}} = 1.0\\times 10^{5}\\,\\mathrm{Pa}$，$q^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$。\n- 用例 5 (黏性，无摩擦)：$E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$，$\\nu = 0.3$，$\\varphi = 0$，$\\psi = 0$，$c = 5.0\\times 10^{4}\\,\\mathrm{Pa}$，$p^{\\mathrm{tr}} = 5.0\\times 10^{4}\\,\\mathrm{Pa}$，$q^{\\mathrm{tr}} = 1.5\\times 10^{5}\\,\\mathrm{Pa}$。\n\n您的程序必须计算这些用例的返回映射结果，并打印包含扁平化列表的单行内容\n$$\n\\left[\\mathrm{d}\\varepsilon_{v,1}^{p},\\mathrm{d}\\varepsilon_{s,1}^{p},p_{1},q_{1},\\mathrm{d}\\varepsilon_{v,2}^{p},\\mathrm{dvarepsilon_{s,2}^{p},p_{2},q_{2},\\mathrm{d}\\varepsilon_{v,3}^{p},\\mathrm{d}\\varepsilon_{s,3}^{p},p_{3},q_{3},\\mathrm{d}\\varepsilon_{v,4}^{p},\\mathrm{d}\\varepsilon_{s,4}^{p},p_{4},q_{4},\\mathrm{d}\\varepsilon_{v,5}^{p},\\mathrm{d}\\varepsilon_{s,5}^{p},p_{5},q_{5}\\right]\n$$\n格式要求该行中任何地方都不能有空格。", "solution": "用户提供了一个计算岩土力学领域的定义明确的问题，要求推導并实现一个用于非关联 Mohr–Coulomb 塑性模型的返回映射算法。该问题在科学上是合理的、自洽的，并且所有给出的定义和参数都是该领域的标准。验证通过，我将开始解答。\n\n### 任务 A：返回映射算法的构建\n\n目标是推导一个闭式算法，用于在给定总应变增量（该增量导致试探应力状态 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$）的情况下更新应力状态。如果试探状态位于弹性域之外，更新必须确保最终应力状态 $\\left(p, q\\right)$ 满足 Mohr-Coulomb 屈服准则。\n\n**1. 初步定义**\n\n问题提供了以下关键关系：\n- 线性弹性模量：体积模量 $K = \\dfrac{E}{3\\left(1 - 2\\nu\\right)}$ 和剪切模量 $G = \\dfrac{E}{2\\left(1 + \\nu\\right)}$。\n- Mohr-Coulomb 屈服函数: $f\\left(q,p\\right) = q - M_{\\varphi}\\,p - c_{0} = 0$，其中 $M_{\\varphi} = \\dfrac{6\\sin\\varphi}{3 - \\sin\\varphi}$ 且 $c_{0} = \\dfrac{6c\\cos\\varphi}{3 - \\sin\\varphi}$。\n- 用于非关联流动的塑性势函数: $g\\left(q,p\\right) = q - M_{\\psi}\\,p$，其中 $M_{\\psi} = \\dfrac{6\\sin\\psi}{3 - \\sin\\psi}$。\n\n**2. 流动法则**\n\n塑性应变增量由流动法则给出，该法则从塑性势 $g$ 导出：\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial p}, \\quad \\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial q}\n$$\n其中 $\\lambda \\ge 0$ 是塑性乘子。我们计算 $g(q,p)$ 的偏导数：\n$$\n\\dfrac{\\partial g}{\\partial p} = -M_{\\psi}\n$$\n$$\n\\dfrac{\\partial g}{\\partial q} = 1\n$$\n将这些代入流动法则，得到以 $\\lambda$ 表示的塑性应变增量：\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = -\\lambda\\,M_{\\psi}\n$$\n$$\n\\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\n$$\n\n**3. 应力更新方程**\n\n总应变增量被加法分解为弹性和塑性两部分。应力状态从弹性预测（试探）状态 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ 开始更新，方法是减去与应变增量的塑性部分相对应的应力变化：\n$$\np = p^{\\mathrm{tr}} - K\\,\\mathrm{d}\\varepsilon_{v}^{p}\n$$\n$$\nq = q^{\\mathrm{tr}} - 3\\,G\\,\\mathrm{d}\\varepsilon_{s}^{p}\n$$\n将流动法则中的塑性应变增量表达式代入，得到作为塑性乘子 $\\lambda$ 函数的更新后应力：\n$$\np = p^{\\mathrm{tr}} - K \\left(-\\lambda\\,M_{\\psi}\\right) = p^{\\mathrm{tr}} + \\lambda K M_{\\psi}\n$$\n$$\nq = q^{\\mathrm{tr}} - 3\\,G \\left(\\lambda\\right) = q^{\\mathrm{tr}} - 3G\\lambda\n$$\n\n**4. 一致性条件与塑性乘子 $\\lambda$ 的推导**\n\n该过程受 Karush-Kuhn-Tucker (KKT) 加载/卸载条件约束：\n- $f(q, p) \\le 0$ (屈服条件)\n- $\\lambda \\ge 0$ (非负塑性功)\n- $\\lambda f(q,p) = 0$ (互补条件)\n\n我们首先在试探状态下计算屈服函数的值：\n$$\nf^{\\mathrm{tr}} = f\\left(q^{\\mathrm{tr}}, p^{\\mathrm{tr}}\\right) = q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}\n$$\n\n如果 $f^{\\mathrm{tr}} \\le 0$，则试探状态在屈服面内部或其上（容许状态）。该步为弹性步。KKT 条件意味着 $\\lambda = 0$。因此：\n- $\\mathrm{d}\\varepsilon_{v}^{p} = 0$\n- $\\mathrm{d}\\varepsilon_{s}^{p} = 0$\n- $p = p^{\\mathrm{tr}}$\n- $q = q^{\\mathrm{tr}}$\n\n如果 $f^{\\mathrm{tr}}  0$，则试探状态在屈服面之外（不容许状态）。必须发生塑性流动，因此 $\\lambda  0$。KKT 条件此时要求最终应力状态 $\\left(p, q\\right)$ 位于屈服面上，满足一致性条件 $f\\left(q, p\\right) = 0$。\n\n我们通过将 $p$ 和 $q$ 的更新方程代入屈服函数来满足此条件：\n$$\nf\\left(q,p\\right) = \\left(q^{\\mathrm{tr}} - 3G\\lambda\\right) - M_{\\varphi}\\left(p^{\\mathrm{tr}} + \\lambda K M_{\\psi}\\right) - c_{0} = 0\n$$\n现在，我们重排此方程以求解未知的塑性乘子 $\\lambda$：\n$$\nq^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0} = 3G\\lambda + \\lambda K M_{\\varphi} M_{\\psi}\n$$\n方程左侧恰好是在试探状态下计算的屈服函数值 $f^{\\mathrm{tr}}$。\n$$\nf^{\\mathrm{tr}} = \\lambda \\left(3G + K M_{\\varphi} M_{\\psi}\\right)\n$$\n这就得到了塑性乘子的闭式表达式：\n$$\n\\lambda = \\dfrac{f^{\\mathrm{tr}}}{3G + K M_{\\varphi} M_{\\psi}} = \\dfrac{q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}}{3G + K M_{\\varphi} M_{\\psi}}\n$$\n\n**5. 最终算法**\n\n完整的返回映射算法如下：\n\n1.  **输入**：试探应力不变量 $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ 和材料参数 $\\left(E, \\nu, \\varphi, \\psi, c\\right)$。\n2.  **计算常数**：\n    -   弹性模量：$K = \\dfrac{E}{3(1-2\\nu)}$，$G = \\dfrac{E}{2(1+\\nu)}$。\n    -   Mohr-Coulomb 参数：$M_{\\varphi} = \\dfrac{6\\sin\\varphi}{3-\\sin\\varphi}$，$M_{\\psi} = \\dfrac{6\\sin\\psi}{3-\\sin\\psi}$，$c_0 = \\dfrac{6c\\cos\\varphi}{3-\\sin\\varphi}$。\n3.  **检查塑性**：计算试探状态下的屈服函数值 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}$。\n4.  **计算最终状态**：\n    -   **如果 $f^{\\mathrm{tr}} \\le 0$ (弹性步)**：\n        -   $\\mathrm{d}\\varepsilon_{v}^{p} = 0.0$\n        -   $\\mathrm{d}\\varepsilon_{s}^{p} = 0.0$\n        -   $p = p^{\\mathrm{tr}}$\n        -   $q = q^{\\mathrm{tr}}$\n    -   **如果 $f^{\\mathrm{tr}}  0$ (塑性步)**：\n        -   计算塑性乘子：$\\lambda = \\dfrac{f^{\\mathrm{tr}}}{3G + K M_{\\varphi} M_{\\psi}}$。\n        -   计算塑性应变增量：$\\mathrm{d}\\varepsilon_{v}^{p} = -\\lambda M_{\\psi}$ 和 $\\mathrm{d}\\varepsilon_{s}^{p} = \\lambda$。\n        -   更新应力不变量：$p = p^{\\mathrm{tr}} + \\lambda K M_{\\psi}$ 和 $q = q^{\\mathrm{tr}} - 3G\\lambda$。\n5.  **输出**：四个量 $\\left[\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}, p, q\\right]$。\n\n任务 A 的推导到此结束。后续的实现基于此算法。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Mohr-Coulomb return-mapping algorithm.\n    \"\"\"\n\n    # Helper function to perform the return-mapping for a single case.\n    def compute_mohr_coulomb_return_map(p_tr, q_tr, E, nu, phi, psi, c):\n        \"\"\"\n        Computes the corrected stress state and plastic strain increments for a\n        non-associated Mohr-Coulomb model using a return-mapping algorithm.\n\n        Args:\n            p_tr (float): Trial mean stress (Pa).\n            q_tr (float): Trial deviatoric stress (Pa).\n            E (float): Young's modulus (Pa).\n            nu (float): Poisson's ratio.\n            phi (float): Friction angle (radians).\n            psi (float): Dilatancy angle (radians).\n            c (float): Cohesion (Pa).\n\n        Returns:\n            tuple: A tuple containing (d_eps_v_p, d_eps_s_p, p, q).\n        \"\"\"\n        # Step 1: Calculate elastic and material constants\n        if 1 - 2 * nu = 0: # Avoid division by zero or negative K\n             # For nu=0.5, material is incompressible. K would be infinite.\n             # This problem context assumes compressible elasticity.\n             raise ValueError(\"Poisson's ratio results in non-positive K.\")\n\n        K = E / (3.0 * (1.0 - 2.0 * nu))\n        G = E / (2.0 * (1.0 + nu))\n\n        sin_phi = np.sin(phi)\n        cos_phi = np.cos(phi)\n        sin_psi = np.sin(psi)\n        \n        # Handle cases where denominator might be zero if phi or psi are ill-defined\n        # For this problem, angles are within physical ranges.\n        den_phi = 3.0 - sin_phi\n        if den_phi == 0: raise ValueError(\"Friction angle definition issue.\")\n\n        M_phi = (6.0 * sin_phi) / den_phi\n        c0 = (6.0 * c * cos_phi) / den_phi\n\n        den_psi = 3.0 - sin_psi\n        if den_psi == 0: raise ValueError(\"Dilatancy angle definition issue.\")\n        M_psi = (6.0 * sin_psi) / den_psi\n\n        # Step 2: Check for plasticity\n        f_tr = q_tr - M_phi * p_tr - c0\n\n        # Step 3: Determine path (elastic or plastic)\n        if f_tr = 1e-9:  # Use a small tolerance for floating point comparison\n            # Elastic or on-yield-surface step\n            d_eps_v_p = 0.0\n            d_eps_s_p = 0.0\n            p = p_tr\n            q = q_tr\n        else:\n            # Plastic step: return mapping required\n            # Calculate the plastic multiplier lambda\n            denominator = 3.0 * G + K * M_phi * M_psi\n            if denominator == 0:\n                raise ValueError(\"Denominator for lambda calculation is zero.\")\n            \n            lam = f_tr / denominator\n\n            # Calculate plastic strain increments\n            d_eps_v_p = -lam * M_psi\n            d_eps_s_p = lam\n\n            # Update stress invariants\n            p = p_tr + K * lam * M_psi\n            q = q_tr - 3.0 * G * lam\n\n        return d_eps_v_p, d_eps_s_p, p, q\n\n    # Define the test suite from the problem statement.\n    E_base = 1.0e8\n    nu_base = 0.3\n    phi_base = np.pi / 6.0\n    psi_base = np.pi / 18.0\n    c_base = 1.0e4\n\n    # Case 2 requires q_tr to be exactly on the yield surface.\n    sin_phi_base = np.sin(phi_base)\n    M_phi_base = (6.0 * sin_phi_base) / (3.0 - sin_phi_base)\n    c0_base = (6.0 * c_base * np.cos(phi_base)) / (3.0 - sin_phi_base)\n    q_tr_case2 = M_phi_base * 2.0e5 + c0_base\n\n    test_cases = [\n        # Case 1 (elastic understrength)\n        (2.0e5, 1.5e5, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 2 (on yield surface)\n        (2.0e5, q_tr_case2, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 3 (plastic, non-associated)\n        (2.0e5, 4.0e5, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 4 (plastic, zero dilatancy)\n        (1.0e5, 2.0e5, 1.0e8, 0.3, np.pi/6.0, 0.0, 0.0),\n        # Case 5 (cohesive, frictionless)\n        (5.0e4, 1.5e5, 1.0e8, 0.3, 0.0, 0.0, 5.0e4),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        p_tr, q_tr, E, nu, phi, psi, c = case\n        result = compute_mohr_coulomb_return_map(p_tr, q_tr, E, nu, phi, psi, c)\n        all_results.extend(result)\n\n    # Format the results into the required string format.\n    formatted_results = [f\"{val:.10e}\" for val in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3517443"}]}