{"hands_on_practices": [{"introduction": "在深入研究复杂系统的组装之前，我们必须首先理解其最基本的构建单元——单个有限元。本练习 [@problem_id:3501532] 将带您从第一性原理出发，即虚功原理，为最简单的一维杆单元推导其单元刚度矩阵和节点力向量。通过这个过程，您将清晰地看到连续介质力学的控制方程如何被离散化为代数方程，这是整个计算力学大厦的基石。", "problem": "考虑一个用于棱柱形杆段一维轴向变形的双节点线性有限元。该杆段具有恒定的杨氏模量 $E$、恒定的横截面积 $A$ 和长度 $L$。设沿杆轴线 $x \\in [0,L]$ 的轴向位移场为 $u(x)$。一个单位体积上的均布体力 $b$ 沿轴向正方向作用。在右端 $x=L$ 处，一个给定的向外轴向牵引力 $\\bar{t}$（单位为应力）作用在端部横截面上，而在 $x=0$ 处没有外部牵引力作用。假设小应变和线性弹性，应力为 $\\sigma = E \\,\\varepsilon$，轴向应变为 $\\varepsilon = du/dx$。\n\n从一维线性动量平衡的强形式和虚功原理出发，通过在单元域和边界上进行精确积分，推导协调的二乘二单元刚度矩阵 $K_{e}$ 和协调的双分量单元外力向量 $f_{\\mathrm{ext},e}$。对 $u(x)$ 及其在母单元域上的虚变分使用标准的双节点等参线性插值，但在物理坐标 $x$ 中精确执行所有积分。\n\n然后，使用您推导出的 $K_{e}$ 和 $f_{\\mathrm{ext},e}$，将单元势能泛函\n$$\n\\Pi_{e}(u_{1},u_{2}) \\;=\\; \\tfrac{1}{2}\\, \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} K_{e} \\begin{bmatrix} u_{1} \\\\\nu_{2} \\end{bmatrix} \\;-\\; \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} f_{\\mathrm{ext},e},\n$$\n写成一个关于 $E$、$A$、$L$、$b$、$\\bar{t}$、$u_{1}$ 和 $u_{2}$ 的闭式解析表达式。\n\n您的最终答案必须是 $\\Pi_{e}(u_{1},u_{2})$ 的单个闭式解析表达式。不要将中间矩阵或向量作为最终答案。不需要进行数值计算。以无单位形式表示您的最终答案。", "solution": "该问题陈述经证实具有科学依据、是适定的、客观的、完整的，并且在数学上是可验证的。它代表了线性弹性静力学有限元法中的一个标准推导过程。所有给定的数据和定义（$E$、$A$、$L$、$b$、$\\bar{t}$）对于推导所要求的势能泛函是一致且充分的。不存在矛盾、歧义或违反物理原理之处。\n\n我们从一维弹性体的虚功原理 (PVW) 开始，该原理将内虚功与外虚功相等。对于给定的体积元 $V_e$ 和边界面 $\\partial V_e$，虚功原理为：\n$$\n\\int_{V_e} \\delta\\varepsilon \\, \\sigma \\, \\mathrm{d}V = \\int_{V_e} \\delta u \\, b \\, \\mathrm{d}V + \\int_{\\partial V_e} \\delta u \\, t \\, \\mathrm{d}S\n$$\n其中 $\\sigma$ 是轴向应力，$\\varepsilon$ 是轴向应变，$\\delta\\varepsilon$ 和 $\\delta u$ 分别是虚应变和虚位移，$b$ 是单位体积体力，$t$ 是表面牵引力。\n\n对于长度为 $L$、横截面积恒为 $A$ 的一维棱柱形杆，该式可简化。我们使用从 $0$ 到 $L$ 的物理坐标 $x$。体积元为 $\\mathrm{d}V = A \\, \\mathrm{d}x$。虚功原理变为：\n$$\n\\int_0^L \\delta\\varepsilon(x) \\, \\sigma(x) \\, A \\, \\mathrm{d}x = \\int_0^L \\delta u(x) \\, b \\, A \\, \\mathrm{d}x + \\left[ \\delta u(x) \\, t(x) \\, A \\right]_{x=0}^{x=L}\n$$\n问题指定在 $x=L$ 处有给定的向外牵引力 $\\bar{t}$，在 $x=0$ 处没有外部牵引力。因此，$t(L) = \\bar{t}$，且在 $x=0$ 处来自外界的牵引力为零。边界项变为 $A \\, \\bar{t} \\, \\delta u(L)$。使用线性本构关系 $\\sigma = E\\varepsilon$，虚功原理为：\n$$\n\\int_0^L \\delta\\varepsilon \\, A E \\varepsilon \\, \\mathrm{d}x = \\int_0^L \\delta u \\, A b \\, \\mathrm{d}x + A \\bar{t} \\, \\delta u(L)\n$$\n接下来，我们引入双节点单元上位移场 $u(x)$ 及其变分 $\\delta u(x)$ 的有限元近似。节点位于 $x_1=0$ 和 $x_2=L$，对应的节点位移为 $u_1$ 和 $u_2$。线性插值由下式给出：\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2\n$$\n其中 $N_1(x)$ 和 $N_2(x)$ 是线性形函数。它们必须满足 $N_1(0)=1$，$N_1(L)=0$，$N_2(0)=0$ 和 $N_2(L)=1$。唯一的线性函数是：\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\n用矩阵表示法，$u(x) = \\mathbf{N}(x) \\mathbf{u}_e$，其中 $\\mathbf{N}(x) = \\begin{bmatrix} N_1(x)  N_2(x) \\end{bmatrix}$ 且 $\\mathbf{u}_e = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$。虚位移遵循相同的插值：$\\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{u}_e$。\n\n应变 $\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$ 通过对形函数求导得到：\n$$\n\\varepsilon(x) = \\frac{\\mathrm{d}N_1}{\\mathrm{d}x} u_1 + \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} u_2 = \\left(-\\frac{1}{L}\\right) u_1 + \\left(\\frac{1}{L}\\right) u_2 = \\frac{u_2 - u_1}{L}\n$$\n用矩阵形式表示，$\\varepsilon(x) = \\mathbf{B} \\mathbf{u}_e$，其中应变-位移矩阵 $\\mathbf{B}$ 为：\n$$\n\\mathbf{B} = \\begin{bmatrix} \\frac{\\mathrm{d}N_1}{\\mathrm{d}x}  \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{bmatrix}\n$$\n虚应变为 $\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{u}_e$。将这些离散化形式代入虚功原理：\n$$\n\\int_0^L (\\mathbf{B} \\delta\\mathbf{u}_e)^T A E (\\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}x = \\int_0^L (\\mathbf{N} \\delta\\mathbf{u}_e)^T A b \\, \\mathrm{d}x + (\\mathbf{N}(L) \\delta\\mathbf{u}_e)^T A \\bar{t}\n$$\n使用矩阵转置性质，并提出恒定的节点位移向量 $\\mathbf{u}_e$ 和 $\\delta\\mathbf{u}_e$：\n$$\n\\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{B}^T A E \\mathbf{B} \\, \\mathrm{d}x \\right) \\mathbf{u}_e = \\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{N}^T A b \\, \\mathrm{d}x + \\mathbf{N}(L)^T A \\bar{t} \\right)\n$$\n由于此式必须对任意 $\\delta\\mathbf{u}_e$ 成立，我们得到单元方程组 $K_e \\mathbf{u}_e = \\mathbf{f}_{\\mathrm{ext},e}$，其中：\n$$\nK_e = \\int_0^L A E \\mathbf{B}^T \\mathbf{B} \\, \\mathrm{d}x \\quad \\text{和} \\quad \\mathbf{f}_{\\mathrm{ext},e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x + A \\bar{t} \\mathbf{N}(L)^T\n$$\n我们现在精确计算这些积分。对于刚度矩阵 $K_e$：\n$$\n\\mathbf{B}^T \\mathbf{B} = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} \\begin{bmatrix} -1/L  1/L \\end{bmatrix} = \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n由于 $A$、$E$、$L$ 是常数，被积函数是常数：\n$$\nK_e = A E \\left( \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\int_0^L \\mathrm{d}x = \\frac{AE}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} L = \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n对于外力向量 $\\mathbf{f}_{\\mathrm{ext},e}$，我们计算体力分量和牵引力分量。\n体力向量 $\\mathbf{f}_{b,e}$ 为：\n$$\n\\mathbf{f}_{b,e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x = A b \\int_0^L \\begin{bmatrix} 1 - x/L \\\\ x/L \\end{bmatrix} \\mathrm{d}x = Ab \\begin{bmatrix} [x - x^2/(2L)]_0^L \\\\ [x^2/(2L)]_0^L \\end{bmatrix} = Ab \\begin{bmatrix} L - L/2 \\\\ L/2 \\end{bmatrix} = \\frac{ALb}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n牵引力向量 $\\mathbf{f}_{t,e}$ 为：\n$$\n\\mathbf{f}_{t,e} = A \\bar{t} \\mathbf{N}(L)^T = A \\bar{t} \\begin{bmatrix} N_1(L) \\\\ N_2(L) \\end{bmatrix} = A \\bar{t} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n总外力向量是两者的和：\n$$\n\\mathbf{f}_{\\mathrm{ext},e} = \\mathbf{f}_{b,e} + \\mathbf{f}_{t,e} = \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\n最后，我们组装单元势能泛函 $\\Pi_{e}(u_{1},u_{2})$，其由下式给出：\n$$\n\\Pi_{e}(u_{1},u_{2}) = \\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e - \\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e}\n$$\n代入推导出的矩阵和向量：\n$$\n\\Pi_{e}(u_1, u_2) = \\frac{1}{2} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\left( \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} - \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\n我们分别计算这两项。第一项（应变能）是：\n$$\n\\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e = \\frac{1}{2} \\frac{AE}{L} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} u_1 - u_2 \\\\ -u_1 + u_2 \\end{bmatrix} = \\frac{AE}{2L} (u_1(u_1 - u_2) + u_2(-u_1 + u_2)) = \\frac{AE}{2L} (u_1^2 - 2u_1u_2 + u_2^2) = \\frac{AE}{2L}(u_2 - u_1)^2\n$$\n第二项（外力功势）是：\n$$\n\\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e} = u_1\\left(\\frac{ALb}{2}\\right) + u_2\\left(\\frac{ALb}{2} + A\\bar{t}\\right)\n$$\n结合这些结果，得到单元势能的最终闭式表达式：\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\left[ u_1 \\frac{ALb}{2} + u_2 \\left(\\frac{ALb}{2} + A\\bar{t}\\right) \\right]\n$$\n这个表达式可以通过展开各项来重写：\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\frac{ALb}{2}(u_1+u_2) - A\\bar{t}u_2\n$$\n两种形式是等价的。第一种形式突出了从推导出的力向量得到的贡献。为了清晰起见，我们将以展开形式给出最终答案。\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_1^2 - 2 u_1 u_2 + u_2^2) - \\frac{ALb}{2}u_1 - \\left(\\frac{ALb}{2} + A\\bar{t}\\right)u_2\n$$", "answer": "$$\n\\boxed{\\frac{AE}{2L}(u_2 - u_1)^2 - \\frac{ALb}{2}(u_1 + u_2) - A\\bar{t}u_2}\n$$", "id": "3501532"}, {"introduction": "在计算出各个单元的刚度矩阵后，下一步的关键是“组装”——将这些局部贡献整合成为一个庞大的全局方程组。本练习 [@problem_id:3501567] 专注于这一核心的“散点相加”(scatter-add) 过程，您将利用给定的单元连接性信息，手动将单元矩阵的项添加到全局矩阵的正确位置。这个实践旨在训练您对局部自由度与全局自由度之间映射关系的精确掌握，这是从理论走向编程实现的关键一步。", "problem": "考虑一个二维空间中的准静态小应变线性弹性问题，该问题由线动量平衡和线性弹性固体的本构关系控制。全局线性系统源于伽辽金弱形式，其中单元刚度矩阵由包含运动学矩阵和弹性张量的双线性形式定义，单元载荷向量由包含体力项的线性形式定义。有限元法 (FEM) 通过基于网格连接性的散点相加（scatter-add）程序，对每个单元的贡献求和，从而组装全局刚度矩阵和载荷向量。\n\n一个小网格由 $4$ 个节点和连接它们的 $2$ 个三节点三角形单元组成。每个节点具有 $2$ 个位移自由度 (DOF)，即水平位移 $u_{x}$ 和垂直位移 $u_{y}$。全局自由度的编号方式是：节点 $i$ 对应于全局自由度 $\\left(2i-1,\\,2i\\right)$。这些单元共享一条边，其节点连接性如下：\n- 单元 $1$：节点 $\\left(1,\\,2,\\,3\\right)$，\n- 单元 $2$：节点 $\\left(2,\\,4,\\,3\\right)$。\n\n每个单元的局部自由度排序为 $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$，其中 $\\left(n_{1},\\,n_{2},\\,n_{3}\\right)$ 是单元的节点标签。\n\n给定以下单元刚度矩阵和单元载荷向量，它们已经通过对弱形式积分进行适当的数值求积计算得出：\n$$\n\\mathbf{K}^{(1)} \\;=\\;\n\\begin{pmatrix}\n6  0  -3  0  -3  0 \\\\\n0  6  0  -3  0  -3 \\\\\n-3  0  6  0  -3  0 \\\\\n0  -3  0  6  0  -3 \\\\\n-3  0  -3  0  6  0 \\\\\n0  -3  0  -3  0  6\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(1)} \\;=\\;\n\\begin{pmatrix}\n2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 3 \\\\ 2\n\\end{pmatrix},\n$$\n$$\n\\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(2)} \\;=\\;\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 4 \\\\ -1\n\\end{pmatrix}.\n$$\n\n请根据所提供的连接性和自由度排序，通过散点相加单元贡献来组装大小为 $8 \\times 8$ 的全局刚度矩阵 $\\mathbf{K}$ 和大小为 $8$ 的全局载荷向量 $\\mathbf{f}$。作为工作的一部分，请验证由每个单元的连接性引起的非零模式的行和列索引对，并确认全局刚度矩阵的对称性。然后，确定单个全局刚度矩阵项 $K_{7,5}$。\n\n仅报告组装后得到的 $K_{7,5}$ 的数值。请用千牛顿每米 $\\left(\\mathrm{kN/m}\\right)$ 表示最终答案。无需四舍五入；请提供精确值。", "solution": "该问题要求在二维线性弹性问题的有限元法 (FEM) 背景下，从单元刚度矩阵 $\\mathbf{K}^{(e)}$ 组装全局刚度矩阵 $\\mathbf{K}$。具体任务是确定全局矩阵的元素 $K_{7,5}$ 的值。\n\n组装过程基于叠加原理。全局刚度矩阵 $\\mathbf{K}$ 初始化为适当大小的零矩阵。然后，对于每个单元 $e$，其局部刚度矩阵 $\\mathbf{K}^{(e)}$ 被加到全局矩阵中的相应项。局部自由度 (DOF) 与全局自由度之间的映射决定了 $\\mathbf{K}^{(e)}$ 的每个元素放置在何处。全局矩阵项 $K_{I,J}$ 的值是连接到全局自由度 $I$ 和全局自由度 $J$ 的所有单元贡献的总和。\n$$ K_{I,J} = \\sum_{e} K_{g^{(e)}(i), g^{(e)}(j)}^{(e)} = \\sum_{e} K_{i,j}^{(e)} \\quad \\text{其中 } I=g^{(e)}(i) \\text{ 且 } J=g^{(e)}(j) $$\n这里，$g^{(e)}$ 是单元 $e$ 的局部到全局自由度映射向量。\n\n首先，我们必须为这两个单元建立局部到全局的自由度映射。问题陈述总共有 $4$ 个节点，每个节点有 $2$ 个自由度 ($u_x, u_y$)。节点 $i$ 的全局自由度由 $(2i-1, 2i)$ 给出。\n- 节点 $1$：全局自由度 $(1, 2)$。\n- 节点 $2$：全局自由度 $(3, 4)$。\n- 节点 $3$：全局自由度 $(5, 6)$。\n- 节点 $4$：全局自由度 $(7, 8)$。\n全局自由度的总数为 $2 \\times 4 = 8$，因此全局刚度矩阵 $\\mathbf{K}$ 的大小为 $8 \\times 8$。\n\n具有节点 $(n_1, n_2, n_3)$ 的三节点单元的局部自由度排序为 $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$，对应于局部自由度索引 $(1, 2, 3, 4, 5, 6)$。\n\n对于单元 $1$，其连接性为节点 $(1, 2, 3)$。\n- 局部自由度 $1, 2$（来自节点 $1$）映射到全局自由度 $1, 2$。\n- 局部自由度 $3, 4$（来自节点 $2$）映射到全局自由度 $3, 4$。\n- 局部自由度 $5, 6$（来自节点 $3$）映射到全局自由度 $5, 6$。\n单元 $1$ 的局部到全局映射向量为 $g^{(1)} = (1, 2, 3, 4, 5, 6)$。\n\n对于单元 $2$，其连接性为节点 $(2, 4, 3)$。\n- 局部自由度 $1, 2$（来自节点 $2$）映射到全局自由度 $3, 4$。\n- 局部自由度 $3, 4$（来自节点 $4$）映射到全局自由度 $7, 8$。\n- 局部自由度 $5, 6$（来自节点 $3$）映射到全局自由度 $5, 6$。\n单元 $2$ 的局部到全局映射向量为 $g^{(2)} = (3, 4, 7, 8, 5, 6)$。\n\n我们需要找到全局刚度矩阵项 $K_{7,5}$ 的值。这是来自两个单元的贡献之和：\n$$ K_{7,5} = K_{7,5}^{\\text{来自 (1)}} + K_{7,5}^{\\text{来自 (2)}} $$\n\n来自单元 $1$ 的贡献：\n根据其映射向量 $g^{(1)}$，与单元 $1$ 关联的全局自由度为 $(1, 2, 3, 4, 5, 6)$。全局自由度 $7$ 与单元 $1$ 无关。因此，单元 $1$ 对全局矩阵 $\\mathbf{K}$ 的第 $7$ 行或第 $7$ 列中的任何项都没有贡献。\n$$ K_{7,5}^{\\text{来自 (1)}} = 0 $$\n\n来自单元 $2$ 的贡献：\n根据其映射向量 $g^{(2)}$，与单元 $2$ 关联的全局自由度为 $(3, 4, 7, 8, 5, 6)$。为了找到对 $K_{7,5}$ 的贡献，我们必须确定单元 $2$ 中与全局索引 $I=7$ 和 $J=5$ 对应的局部索引 $i$ 和 $j$。\n- 对于全局行索引 $I=7$，我们在映射向量 $g^{(2)} = (3, 4, 7, 8, 5, 6)$ 中寻找 $7$。它在第 $3$ 个位置。因此，局部行索引为 $i=3$。\n- 对于全局列索引 $J=5$，我们在映射向量 $g^{(2)}$ 中寻找 $5$。它在第 $5$ 个位置。因此，局部列索引为 $j=5$。\n来自单元 $2$ 的贡献是单元刚度矩阵 $\\mathbf{K}^{(2)}$ 中的项 $K_{i,j}^{(2)} = K_{3,5}^{(2)}$。\n给定：\n$$ \\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix}\n$$\n第 $3$ 行、第 $5$ 列的值为 $K_{3,5}^{(2)} = -3$。\n因此，$K_{7,5}^{\\text{来自 (2)}} = -3$。\n\n$K_{7,5}$ 的总值为各贡献之和：\n$$ K_{7,5} = 0 + (-3) = -3 $$\n\n作为对方法的验证并确认组装后矩阵的对称性，我们可以计算项 $K_{5,7}$。\n$$ K_{5,7} = K_{5,7}^{\\text{来自 (1)}} + K_{5,7}^{\\text{来自 (2)}} $$\n来自单元 $1$ 的贡献同样为 $0$，因为全局自由度 $7$ 不在其映射中。\n对于来自单元 $2$ 的贡献，我们找到与全局索引 $I=5$ 和 $J=7$ 对应的局部索引。\n- 对于 $I=5$，我们在 $g^{(2)} = (3, 4, 7, 8, 5, 6)$ 的第 $5$ 个位置找到 $5$，所以局部行索引是 $i=5$。\n- 对于 $J=7$，我们在 $g^{(2)}$ 的第 $3$ 个位置找到 $7$，所以局部列索引是 $j=3$。\n贡献是 $K_{5,3}^{(2)}$。从矩阵 $\\mathbf{K}^{(2)}$ 中，值为 $K_{5,3}^{(2)} = -3$。\n所以，$K_{5,7} = 0 + (-3) = -3$。\n由于 $K_{7,5} = K_{5,7} = -3$，对于这对索引，组装后的矩阵是对称的，这与单元刚度矩阵是对称的以及组装操作保持对称性这一事实是一致的。\n\n问题要求最终答案以千牛顿每米 $(\\mathrm{kN/m})$ 表示。给出的刚度矩阵数值没有单位。我们假设这些值已经是所需的单位 $\\mathrm{kN/m}$。\n\n因此，全局刚度矩阵项 $K_{7,5}$ 的数值为 $-3$。", "answer": "$$ \\boxed{-3} $$", "id": "3501567"}, {"introduction": "一个纯粹组装起来的全局系统往往是奇异的，并且未能反映模型中所有物理上的约束。因此，在求解之前必须施加边界条件和多点约束 (Multi-Point Constraints, MPCs) [@problem_id:3501515]。本练习将引导您探索两种主流的约束施加方法——消元法和罚函数法——来处理一个简单的自由度绑定约束。通过对比这两种方法的代数操作及其对系统矩阵性质的影响，您将对实际有限元分析中处理复杂约束的策略有更深刻的理解。", "problem": "一个由小应变岩土力学问题的有限元法 (FEM) 离散化产生的线性弹性离散系统，在全局层面由对称正定 (SPD) 刚度矩阵 $K \\in \\mathbb{R}^{3 \\times 3}$ 和全局力向量 $f \\in \\mathbb{R}^{3}$ 建模，给定如下：\n$$\nK \\;=\\; \\begin{bmatrix}\n10  -2  0\\\\\n-2  5  -1\\\\\n0  -1  3\n\\end{bmatrix}, \n\\qquad\nf \\;=\\; \\begin{bmatrix}\n1\\\\\n0\\\\\n0\n\\end{bmatrix}.\n$$\n设全局位移向量为 $u = [\\,u_{1},\\,u_{2},\\,u_{3}\\,]^{\\mathsf{T}}$。需要施加一个多点约束 (MPC)，通过 $u_{2} - u_{3} = 0$ 将两个位移自由度 (DOF) $u_{2}$ 和 $u_{3}$ 联系起来。\n\n仅使用基本变分原理（最小势能原理），不借助任何简化公式，执行以下操作。\n\n1. 从无约束的总势能出发\n$$\n\\Pi(u) \\;=\\; \\tfrac{1}{2}\\,u^{\\mathsf{T}} K\\, u \\;-\\; f^{\\mathsf{T}}u,\n$$\n写出驻值条件和相应的无约束线性系统。\n\n2. 使用消元法施加多点约束 $u_{2} - u_{3} = 0$。为此，引入一个降维向量 $\\hat{u} \\in \\mathbb{R}^{2}$ 和一个变换 $u = T\\,\\hat{u}$，该变换恒满足多点约束。通过对 $K$ 和 $f$ 进行显式变换来组装降维系统，并求解该降维系统得到 $\\hat{u}$。报告所得的约束解 $u^{\\mathrm{elim}}$。\n\n3. 使用罚函数法施加多点约束，通过将总势能增广一个形如\n$$\n\\frac{\\gamma}{2}\\,\\big(u_{2} - u_{3}\\big)^{2}\n$$\n的二次罚函数项，其中 $\\gamma  0$ 是罚参数。推导修正后的驻值条件和相应的罚线性系统，然后符号化求解该系统，以获得第一个分量 $u_{1}(\\gamma)$ 作为 $\\gamma$ 的闭式函数。\n\n4. 结合本问题中得到的具体矩阵，从组装和算子性质方面（例如，尺寸、稀疏模式、对称性和正定性），简要比较消元法和罚函数法如何修改全局系统矩阵。\n\n您的最终答案必须是第3项中罚函数法得到的 $u_{1}(\\gamma)$ 的闭式解析表达式。将最终结果表示为 $\\gamma$ 的简化有理函数。无需进行数值取整，最终表达式中也无需单位。", "solution": "该问题按要求分为四个部分进行分析，从最小势能原理出发。\n\n1. 从无约束的总势能出发\n$$\n\\Pi(u) \\;=\\; \\tfrac{1}{2}\\,u^{\\mathsf{T}} K\\, u \\;-\\; f^{\\mathsf{T}}u,\n$$\n平衡构型在势能取驻值时找到。驻值条件要求 $\\Pi(u)$ 对位移向量 $u$ 的一阶变分为零，这等同于将 $\\Pi(u)$ 对 $u$ 的梯度设为零：\n$$\n\\frac{\\partial \\Pi}{\\partial u} = 0.\n$$\n利用刚度矩阵 $K$ 的对称性，梯度计算如下：\n$$\n\\frac{\\partial \\Pi}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{1}{2} u^{\\mathsf{T}} K u \\right) - \\frac{\\partial}{\\partial u} \\left( f^{\\mathsf{T}} u \\right) = K u - f.\n$$\n将梯度设为零得到驻值条件，即无约束的全局线性方程组：\n$$\nK u = f.\n$$\n\n2. 使用消元法施加多点约束 (MPC) $u_{2} - u_{3} = 0$，即 $u_{2} = u_{3}$。我们选择一组降维的独立自由度 (DOF)。设独立自由度为 $u_{1}$ 和 $u_{2}$，相关自由度为 $u_{3}$。降维位移向量为 $\\hat{u} \\in \\mathbb{R}^{2}$，定义为 $\\hat{u} = [\\,u_{1}, u_{2}\\,]^{\\mathsf{T}}$。原始位移向量 $u$ 可以通过一个变换矩阵 $T$ 用 $\\hat{u}$ 表示：\n$$\nu = \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{3} \\end{bmatrix} = \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{2} \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} = T \\hat{u}.\n$$\n将 $u=T\\hat{u}$ 代入势能表达式，得到降维势能 $\\Pi(\\hat{u})$：\n$$\n\\Pi(\\hat{u}) = \\frac{1}{2} (T\\hat{u})^{\\mathsf{T}} K (T\\hat{u}) - f^{\\mathsf{T}} (T\\hat{u}) = \\frac{1}{2}\\hat{u}^{\\mathsf{T}} (T^{\\mathsf{T}} K T) \\hat{u} - (T^{\\mathsf{T}} f)^{\\mathsf{T}} \\hat{u}.\n$$\n这对应于一个降维系统 $\\hat{K}\\hat{u} = \\hat{f}$，其中 $\\hat{K} = T^{\\mathsf{T}} K T$ 且 $\\hat{f} = T^{\\mathsf{T}} f$。我们计算降维矩阵和向量：\n$$\n\\hat{K} = T^{\\mathsf{T}} K T = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 10  -2  0\\\\ -2  5  -1\\\\ 0  -1  3 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix}.\n$$\n$$\n\\hat{f} = T^{\\mathsf{T}} f = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n降维系统为：\n$$\n\\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n由第二个方程 $-2u_{1} + 6u_{2} = 0$，我们得到 $u_{1} = 3u_{2}$。将此代入第一个方程得到 $10(3u_{2}) - 2u_{2} = 1$，简化为 $28u_{2} = 1$，所以 $u_{2} = \\frac{1}{28}$。因此，$u_{1} = 3(\\frac{1}{28}) = \\frac{3}{28}$。降维系统的解是 $\\hat{u} = [\\,\\frac{3}{28}, \\frac{1}{28}\\,]^{\\mathsf{T}}$。通过回代找到完整的约束解 $u^{\\mathrm{elim}}$：\n$$\nu^{\\mathrm{elim}} = T\\hat{u} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 3/28 \\\\ 1/28 \\end{bmatrix} = \\begin{bmatrix} 3/28 \\\\ 1/28 \\\\ 1/28 \\end{bmatrix}.\n$$\n\n3. 对于罚函数法，总势能通过一个罚函数项进行增广：\n$$\n\\Pi_{\\gamma}(u) = \\Pi(u) + \\frac{\\gamma}{2}(u_{2} - u_{3})^{2} = \\frac{1}{2}u^{\\mathsf{T}} K u - f^{\\mathsf{T}}u + \\frac{\\gamma}{2} (u_{2} - u_{3})^{2},\n$$\n其中 $\\gamma  0$。罚函数项可以表示为二次矩阵形式 $\\frac{1}{2} u^{\\mathsf{T}} (\\gamma K_p) u$，其中 $K_p = \\begin{bmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{bmatrix}$。增广能量为：\n$$\n\\Pi_{\\gamma}(u) = \\frac{1}{2}u^{\\mathsf{T}}(K + \\gamma K_p)u - f^{\\mathsf{T}}u.\n$$\n驻值条件 $\\frac{\\partial \\Pi_{\\gamma}}{\\partial u} = 0$ 导出罚线性系统 $(K+\\gamma K_p)u(\\gamma) = f$。罚刚度矩阵 $K_{\\gamma} = K + \\gamma K_p$ 为：\n$$\nK_{\\gamma} = \\begin{bmatrix} 10  -2  0\\\\ -2  5  -1\\\\ 0  -1  3 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{bmatrix} = \\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}.\n$$\n需要求解的系统是：\n$$\n\\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{3} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\n我们使用克莱姆法则求解 $u_{1}(\\gamma)$：$u_{1}(\\gamma) = \\frac{\\det(K_{\\gamma,1})}{\\det(K_{\\gamma})}$。$K_{\\gamma}$ 的行列式为：\n$$\n\\det(K_{\\gamma}) = 10\\big((5+\\gamma)(3+\\gamma) - (-1-\\gamma)^{2}\\big) - (-2)\\big((-2)(3+\\gamma)\\big)\n$$\n$$\n= 10\\big(15+8\\gamma+\\gamma^{2} - (1+2\\gamma+\\gamma^{2})\\big) -4(3+\\gamma) = 10(14+6\\gamma) - 12 - 4\\gamma = 128 + 56\\gamma.\n$$\n矩阵 $K_{\\gamma,1}$ 是通过将 $K_{\\gamma}$ 的第一列替换为 $f$ 形成的：\n$$\nK_{\\gamma,1} = \\begin{bmatrix} 1  -2  0 \\\\ 0  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}.\n$$\n其行列式为 $\\det(K_{\\gamma,1}) = 1 \\cdot \\big((5+\\gamma)(3+\\gamma) - (-1-\\gamma)^{2}\\big) = 14+6\\gamma$。\n因此，$u_{1}(\\gamma)$ 的表达式为：\n$$\nu_{1}(\\gamma) = \\frac{14+6\\gamma}{128+56\\gamma} = \\frac{2(7+3\\gamma)}{8(16+7\\gamma)} = \\frac{7+3\\gamma}{4(16+7\\gamma)} = \\frac{3\\gamma+7}{28\\gamma+64}.\n$$\n\n4. 消元法和罚函数法以不同的方式修改全局系统矩阵。\n\n**消元法**:\n- **尺寸**: 系统尺寸减小。在本问题中，3x3矩阵 $K$ 被转换为 2x2 矩阵 $\\hat{K}$。\n- **组装**: 此方法需要进行非平凡的符号操作来定义变换 $T$，然后执行矩阵乘法以获得降维系统，对于复杂的约束条件，这可能很复杂。\n- **稀疏性**: 原始稀疏模式不一定保留。在这种情况下，$\\hat{K} = \\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix}$ 是一个稠密矩阵，K 的结构被破坏。\n- **对称性与正定性**: 这些性质得以保留。由于 $K$ 是对称正定 (SPD) 的，$\\hat{K} = T^{\\mathsf{T}} K T$ 也是 SPD 的。约束被精确满足。\n\n**罚函数法**:\n- **尺寸**: 系统尺寸保持不变 (3x3)。罚矩阵为 $K_{\\gamma} = \\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}$。\n- **组装**: 过程简单直接，仅涉及将缩放后的罚矩阵 $\\gamma K_p$ 加到 $K$ 上。这在实现简单性方面是一个显著优势。\n- **稀疏性**: 稀疏模式可能会改变。在这个具体问题中，$K_p$ 中非零元素的位置已经对应于 $K$ 中的非零元素，因此 $K_{\\gamma}$ 的稀疏模式与 $K$ 的相同。\n- **对称性与正定性**: 这些性质得以保留。对于 $\\gamma  0$，$K_{\\gamma}$ 是 SPD 的。然而，当 $\\gamma \\to \\infty$ 时，$K_{\\gamma}$ 的条件数也趋于无穷大，这会给求解器带来严重的数值困难。约束仅被近似满足，误差随着 $\\gamma$ 的增大而减小。", "answer": "$$\n\\boxed{\\frac{3\\gamma+7}{28\\gamma+64}}\n$$", "id": "3501515"}]}