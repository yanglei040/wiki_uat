{"hands_on_practices": [{"introduction": "在分析岩土体对任何工程活动的响应之前，我们必须首先确定其初始地应力状态。第一个练习将帮助你实践应用垂直向平衡和有效应力这两个基本原理，来计算一个简单、均质土层中的竖向和水平向应力。掌握这项基本计算 [@problem_id:3533868] 是解决任何岩土力学问题的关键第一步。", "problem": "一处竖向、饱和、横向广延的土体沉积，位于高程 $z=0$ 的平坦地表以下的半空间内，并延伸至 $z=50\\ \\text{m}$。该土柱是均匀、各向同性的，并在自重作用下保持静止，所有深度均无侧向变形，表现为静止地应力状态。该连续体受静力平衡和 Terzaghi 有效应力原理的控制，其中有效应力定义为总应力减去孔隙水压力。土体在整个深度范围内具有恒定的有效重度 $\\gamma' = 10\\ \\text{kN/m}^3$。静止土压力系数 (K₀) 不随深度变化，等于 $K_0=0.6$。\n\n以重力作用下连续体的竖向平衡为基本依据，并运用有效应力原理，推导该沉积土中的竖向有效应力分布 $\\sigma'_{v}(z)$ 以及由静止地应力条件所决定的相应水平有效应力分布 $\\sigma'_{h}(z)$。然后计算在深度 $z=10\\ \\text{m}$、$z=30\\ \\text{m}$ 和 $z=50\\ \\text{m}$ 处的 $\\sigma'_{v}$ 和 $\\sigma'_{h}$ 的值。\n\n所有应力值以千帕 (kPa) 表示。将您的数值结果四舍五入至四位有效数字。按顺序 $\\big[\\sigma'_{v}(10\\ \\text{m}),\\ \\sigma'_{h}(10\\ \\text{m}),\\ \\sigma'_{v}(30\\ \\text{m}),\\ \\sigma'_{h}(30\\ \\text{m}),\\ \\sigma'_{v}(50\\ \\text{m}),\\ \\sigma'_{h}(50\\ \\text{m})\\big]$ 将最终答案以单行矩阵的形式报告。", "solution": "用户的请求是岩土力学领域中一个关于确定初始地应力的适定问题。问题陈述科学依据充分、自洽且客观。它基于静力平衡和 Terzaghi 有效应力原理这两个土力学的基石。所有提供的数据在物理上都是现实的，并且足以推导出唯一解。因此，该问题被认为是有效的，并将提供完整的解答。\n\n主要目标是推导均匀土体沉积的竖向和水平有效应力分布 $\\sigma'_{v}(z)$ 和 $\\sigma'_{h}(z)$，然后计算它们在指定深度处的值。\n\n首先，我们推导竖向有效应力分布 $\\sigma'_{v}(z)$。我们从连续体在自重作用下的竖向静力平衡原理开始。我们考虑一个位于地表以下深度 $z$ 处、高为 $dz$、单位水平面积 $A=1$ 的无限小土体单元。$z$ 轴从 $z=0$ 的地表处竖直向下为正。根据岩土工程的符号约定，压应力为正。\n\n作用在该单元上的竖向力包括：\n$1$. 作用在顶面的向下的力，由总竖向应力 $\\sigma_v(z)$ 产生。\n$2$. 作用在底面的向上的力，由总竖向应力 $\\sigma_v(z+dz)$ 产生。\n$3$. 由单元自重产生的向下的力，即其体积 ($A \\cdot dz = dz$) 乘以土的总重度 $\\gamma_t$。\n\n为了达到静力平衡，竖向力的总和必须为零：\n$$ \\sigma_v(z) \\cdot A - \\sigma_v(z+dz) \\cdot A + \\gamma_t \\cdot A \\cdot dz = 0 $$\n两边同除以面积 $A$ 并整理得：\n$$ \\frac{\\sigma_v(z+dz) - \\sigma_v(z)}{dz} = \\gamma_t $$\n当 $dz \\to 0$ 时，这成为竖向平衡的微分方程：\n$$ \\frac{d\\sigma_v}{dz} = \\gamma_t $$\n为了求得总竖向应力 $\\sigma_v(z)$，我们将此方程从地表（$z=0$）积分到任意深度 $z$。边界条件是自由地表的应力为零，即 $\\sigma_v(0)=0$。\n$$ \\int_{\\sigma_v(0)}^{\\sigma_v(z)} d\\sigma_v = \\int_0^z \\gamma_t d\\zeta $$\n$$ \\sigma_v(z) - 0 = \\gamma_t z $$\n因此，任意深度 $z$ 处的总竖向应力为 $\\sigma_v(z) = \\gamma_t z$。\n\n接下来，我们应用 Terzaghi 的有效应力原理，该原理指出总应力是有效应力和孔隙水压力之和：$\\sigma = \\sigma' + u$。\n对于竖向应力，即为：\n$$ \\sigma_v(z) = \\sigma'_v(z) + u(z) $$\n土体是饱和的，并且处于静水压力条件下，因此深度 $z$ 处的孔隙水压力由 $u(z) = \\gamma_w z$ 给出，其中 $\\gamma_w$ 是水的重度。饱和土的总重度 $\\gamma_t$ 与有效（或浮）重度 $\\gamma'$ 的关系为 $\\gamma_t = \\gamma' + \\gamma_w$。将这些关系代入总应力方程：\n$$ \\sigma'_v(z) + \\gamma_w z = (\\gamma' + \\gamma_w) z $$\n求解竖向有效应力 $\\sigma'_v(z)$ 可得：\n$$ \\sigma'_v(z) = (\\gamma' + \\gamma_w) z - \\gamma_w z = \\gamma' z $$\n问题给出了恒定的有效重度 $\\gamma' = 10\\ \\text{kN/m}^3$。因此，竖向有效应力分布为：\n$$ \\sigma'_{v}(z) = 10z $$\n其中 $z$ 的单位是米，$\\sigma'_{v}(z)$ 的单位是千帕 (kPa)，因为 $1\\ \\text{kN/m}^2 = 1\\ \\text{kPa}$。\n\n其次，我们推导水平有效应力分布 $\\sigma'_{h}(z)$。问题陈述土体处于静止地应力状态，其特征为静止土压力系数 $K_0$。根据定义，$K_0$ 是水平有效应力与竖向有效应力之比：\n$$ K_0 = \\frac{\\sigma'_{h}}{\\sigma'_{v}} $$\n该条件源于在自重作用下的沉积和固结过程中侧向应变为零 ($\\epsilon_h=0$) 的约束。\n整理该定义，我们得到水平有效应力：\n$$ \\sigma'_{h}(z) = K_0 \\sigma'_{v}(z) $$\n代入推导出的 $\\sigma'_{v}(z)$ 表达式和给定的 $K_0 = 0.6$：\n$$ \\sigma'_{h}(z) = K_0 \\gamma' z = (0.6)(10)z = 6z $$\n同样，其中 $z$ 的单位是米，$\\sigma'_{h}(z)$ 的单位是千帕 (kPa)。\n\n最后，我们计算在指定深度 $z=10\\ \\text{m}$、$z=30\\ \\text{m}$ 和 $z=50\\ \\text{m}$ 处的所需应力值，并将结果四舍五入至四位有效数字。\n\n在深度 $z=10\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(10) = 10 \\times 10 = 100\\ \\text{kPa} $$\n$$ \\sigma'_{h}(10) = 0.6 \\times \\sigma'_{v}(10) = 0.6 \\times 100 = 60\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $100.0\\ \\text{kPa}$ 和 $60.00\\ \\text{kPa}$。\n\n在深度 $z=30\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(30) = 10 \\times 30 = 300\\ \\text{kPa} $$\n$$ \\sigma'_{h}(30) = 0.6 \\times \\sigma'_{v}(30) = 0.6 \\times 300 = 180\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $300.0\\ \\text{kPa}$ 和 $180.0\\ \\text{kPa}$。\n\n在深度 $z=50\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(50) = 10 \\times 50 = 500\\ \\text{kPa} $$\n$$ \\sigma'_{h}(50) = 0.6 \\times \\sigma'_{v}(50) = 0.6 \\times 500 = 300\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $500.0\\ \\text{kPa}$ 和 $300.0\\ \\text{kPa}$。\n\n最终答案是按指定顺序包含这六个值的行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 100.0  60.00  300.0  180.0  500.0  300.0 \\end{pmatrix}}\n$$", "id": "3533868"}, {"introduction": "地应力状态在地质历史中并非一成不变，它会随着加载和卸载历史而演化。本练习将静止土压力的概念扩展到在自然界中十分常见的超固结土。你将使用一个标准的经验关系式，来量化超固结比（OCR）如何增大侧向土压力 [@problem_id:3533903]，从而为许多实际工程场景提供一个更符合现实的初始应力场。", "problem": "考虑一个处于地静力条件下的水平分层黏土沉积层。静止土压力系数 $K_0$ 定义为 $K_0=\\sigma'_h/\\sigma'_v$，其中 $\\sigma'_h$ 和 $\\sigma'_v$ 分别是在零侧向应变条件下的有效水平应力和有效竖向应力。对于正常固结（NC）土，一个被广泛接受且经过充分检验的经验法则是通过 $K_0^{NC}=1-\\sin\\phi'$ 将 $K_0^{NC}$ 与有效应力摩擦角 $\\phi'$ 联系起来。当土体因卸荷而变为超固结（OC）状态时，地静力 $K_0$ 值相对于其正常固结值会增加。在计算岩土力学实践中，这种增加由一个单参数比例关系表示，该关系将 $K_0^{OC}$ 与 $K_0^{NC}$ 和超固结比（OCR）联系起来，这与零侧向应变下的一维卸荷相一致，并满足当 $\\mathrm{OCR}=1$ 时，超固结关系简化为正常固结状态的要求。\n\n假设一个均质黏土层，其有效应力摩擦角 $\\phi'=30^\\circ$（所有角度均使用度）。该土体已超固结，其 $\\mathrm{OCR}=4$。一个卸荷敏感性参数 $\\alpha$ 表征了由卸荷引起的刚度各向异性。从上述定义和经过检验的 $K_0^{NC}$ 关系式出发，并采用地静力初始化中用于超固结土的标准比例框架，推导出一个 $K_0^{OC}$ 关于 $K_0^{NC}$、$\\mathrm{OCR}$ 和 $\\alpha$ 的闭式表达式。然后计算当 $\\alpha=0.5$ 时 $K_0^{OC}$ 的数值。此外，通过推导适当的基于导数的敏感性度量，量化并讨论 $K_0^{OC}$ 对 $\\alpha$ 的敏感性。将您最终的 $K_0^{OC}$ 数值答案四舍五入到四位有效数字。$K_0$ 是无量纲的，因此不需要单位。", "solution": "该问题被评估为有效。它在科学上基于土力学原理，特别是土体在地静力应力条件下的行为。问题提法清晰，为所要求的推导、计算和分析提供了所有必要信息。所用术语和数值在岩土工程和计算岩土力学领域是标准且符合实际的。\n\n解答按要求分三部分进行：首先，推导超固结土中静止土压力系数 $K_0^{OC}$ 的表达式；其次，根据给定参数计算其数值；第三，对 $K_0^{OC}$ 关于卸荷参数 $\\alpha$ 进行敏感性分析。\n\n**第一部分：$K_0^{OC}$ 表达式的推导**\n\n问题首先给出了静止土压力系数 $K_0$ 的定义，即有效水平应力 $\\sigma'_h$ 与有效竖向应力 $\\sigma'_v$ 的比值：\n$$ K_0 = \\frac{\\sigma'_h}{\\sigma'_v} $$\n用有效应力（$\\sigma'$）表示，关系式为 $K_0 = \\sigma'_h / \\sigma'_v$，有效应力决定了土体的强度和刚度。这里假设孔隙水压力为零或沿深度均匀分布。\n\n对于正常固结（NC）土，问题给出了归功于 Jaky 的著名经验关系式：\n$$ K_0^{NC} = 1 - \\sin\\phi' $$\n其中 $\\phi'$ 是有效应力摩擦角。\n\n当土体因上覆荷载被移除而变为超固结（OC）状态时，地静力水平应力不会与竖向应力成比例减小。这导致 $K_0$ 值增加。问题指出，使用一个单参数比例定律来关联 $K_0^{OC}$ 与 $K_0^{NC}$ 和超固结比（OCR）。OCR 定义为最大历史有效竖向应力 $\\sigma'_{v,max}$ 与当前有效竖向应力 $\\sigma'_{v,current}$ 之比：$\\mathrm{OCR} = \\sigma'_{v,max} / \\sigma'_{v,current}$。\n\n与一维卸荷试验的实验观察结果一致，这个关系的标准、广泛采用的比例框架是一个幂律：\n$$ K_0^{OC} = K_0^{NC} (\\mathrm{OCR})^\\alpha $$\n在此，$\\alpha$ 是一个取决于土体类型及其塑性特性的参数。问题中称之为“卸荷敏感性参数”。这个表达式就是所要求的闭式关系。\n\n我们必须验证该表达式是否与给定条件一致，即当 $\\mathrm{OCR}=1$ 时，超固结关系简化为正常固结状态。根据定义，$\\mathrm{OCR}$ 为 $1$ 的土是正常固结土。将 $\\mathrm{OCR}=1$ 代入推导出的方程，得到：\n$$ K_0^{OC} = K_0^{NC} (1)^\\alpha = K_0^{NC} $$\n条件得到满足，这证实了选择此函数形式的合理性。该表达式将用于后续计算。\n\n**第二部分：$K_0^{OC}$ 的数值计算**\n\n问题提供了以下数据：\n- 有效应力摩擦角：$\\phi' = 30^\\circ$\n- 超固结比：$\\mathrm{OCR} = 4$\n- 卸荷敏感性参数：$\\alpha = 0.5$\n\n首先，我们计算正常固结状态下的静止土压力系数 $K_0^{NC}$。\n$$ K_0^{NC} = 1 - \\sin\\phi' = 1 - \\sin(30^\\circ) $$\n由于 $\\sin(30^\\circ) = 0.5$，我们有：\n$$ K_0^{NC} = 1 - 0.5 = 0.5 $$\n\n接下来，我们使用推导出的 $K_0^{OC}$ 表达式，并代入给定值：\n$$ K_0^{OC} = K_0^{NC} (\\mathrm{OCR})^\\alpha = 0.5 \\times (4)^{0.5} $$\n计算各项：\n$$ (4)^{0.5} = \\sqrt{4} = 2 $$\n$$ K_0^{OC} = 0.5 \\times 2 = 1.0 $$\n问题要求将答案四舍五入到四位有效数字。因此，数值为 $1.000$。\n\n**第三部分：敏感性分析**\n\n任务的最后一部分是量化并讨论 $K_0^{OC}$ 对参数 $\\alpha$ 的敏感性。敏感性的一个直接度量是 $K_0^{OC}$ 关于 $\\alpha$ 的偏导数。函数为：\n$$ K_0^{OC}(\\alpha) = K_0^{NC} (\\mathrm{OCR})^\\alpha $$\n为了求导数，我们将 $K_0^{NC}$ 和 $\\mathrm{OCR}$ 视为常数，并对 $\\alpha$ 求导。使用指数函数的求导法则 $\\frac{d}{dx}(a^x) = a^x \\ln(a)$，我们得到：\n$$ \\frac{\\partial K_0^{OC}}{\\partial \\alpha} = K_0^{NC} \\cdot \\frac{\\partial}{\\partial \\alpha} \\left( (\\mathrm{OCR})^\\alpha \\right) = K_0^{NC} (\\mathrm{OCR})^\\alpha \\ln(\\mathrm{OCR}) $$\n通过注意到 $K_0^{NC} (\\mathrm{OCR})^\\alpha$ 就是 $K_0^{OC}$，该表达式可以简化为：\n$$ \\frac{\\partial K_0^{OC}}{\\partial \\alpha} = K_0^{OC} \\ln(\\mathrm{OCR}) $$\n这就是基于导数的敏感性度量。它量化了 $K_0^{OC}$ 相对于 $\\alpha$ 的绝对变化率。\n\n现在我们可以计算在给定条件下（$K_0^{OC} = 1.0$，$\\mathrm{OCR} = 4$）该敏感性的数值：\n$$ \\frac{\\partial K_0^{OC}}{\\partial \\alpha} = 1.0 \\times \\ln(4) = \\ln(4) \\approx 1.3863 $$\n该值的解释是，对于给定状态，参数 $\\alpha$ 的一个大小为 $\\Delta\\alpha$ 的微小变化将导致 $K_0^{OC}$ 发生约 $1.3863 \\times \\Delta\\alpha$ 的变化。例如，$\\alpha$ 从 $0.5$ 增加到 $0.6$（变化量为 $0.1$）将使 $K_0^{OC}$ 增加约 $0.13863$。\n\n一个无量纲的相对敏感性度量 $S_{\\alpha}$ 通常更具洞察力。其定义为：\n$$ S_{\\alpha} = \\frac{\\alpha}{K_0^{OC}} \\frac{\\partial K_0^{OC}}{\\partial \\alpha} $$\n代入导数的表达式：\n$$ S_{\\alpha} = \\frac{\\alpha}{K_0^{OC}} \\left( K_0^{OC} \\ln(\\mathrm{OCR}) \\right) = \\alpha \\ln(\\mathrm{OCR}) $$\n数值上，对于 $\\alpha = 0.5$ 和 $\\mathrm{OCR} = 4$：\n$$ S_{\\alpha} = 0.5 \\times \\ln(4) = 0.5 \\times (2 \\ln 2) = \\ln 2 \\approx 0.6931 $$\n这意味着，$\\alpha$ 从其当前值 $0.5$ 变化 $1\\%$ 将导致 $K_0^{OC}$ 发生约 $0.6931\\%$ 的变化。敏感性为正，表明 $K_0^{OC}$ 随 $\\alpha$ 增加而增加，这是符合预期的，因为更高的 $\\alpha$ 意味着在卸荷过程中具有更大的刚度和压力保持能力。相对敏感性的量级（$1$）表明，在这些条件下 $K_0^{OC}$ 对 $\\alpha$ 是中等敏感的；其百分比变化小于参数 $\\alpha$ 的百分比变化。当参数 $\\alpha$ 的精度不高时，此信息对于评估计算模型中地静力应力初始化的不确定性至关重要。", "answer": "$$\\boxed{1.000}$$", "id": "3533903"}, {"introduction": "最终，地应力原理必须被转化为稳健的数值算法，以便在计算分析中使用。这最后一个练习将挑战你为一个具有随深度变化的$K_0$值的、普遍的多层土剖面设计并实现一个地应力初始化程序。这项练习 [@problem_id:3533886] 将平衡、变形协调和本构一致性等概念综合到一个实用的计算工具中，这是任何计算岩土力学专家都需具备的核心技能。", "problem": "您的任务是为重力作用下的竖向土柱构建一个一维地应力初始化，该初始化应能再现一个预设的随深度变化的静止土压力系数（K0）剖面，同时在每个深度都满足以下所有条件：(i) 平衡，(ii) 应变协调，以及 (iii) 在线性各向同性弹性范围内的本构一致性。竖向坐标用 $z$ 表示，从地表 $z=0$ 处向下测量。总深度为 $H$。材料按层定义，每层具有恒定的单位重量和弹性模量。目标静止土压力系数（K0）作为深度的函数给出，可以是常数或随 $z$ 线性变化。一个可选的均匀超载作用于地表。所有答案必须使用国际单位制（SI），应力单位为帕斯卡，位移单位为米。程序必须输出四舍五入到 $3$ 位小数的浮点数。\n\n您的设计必须从以下基本依据出发：\n- 连续介质力学的局部静态平衡：柯西动量平衡在竖直方向上简化为一个带重力体力的一维方程。\n- 一维小应变运动学：竖向应变是竖向位移对深度的导数，侧向应变受到静止条件的约束。\n- 线性各向同性弹性（胡克定律）：正应变通过杨氏模量和泊松比与正应力线性相关。\n\n您的目标是：\n- 强制在自重和任何指定地表超载下的竖向平衡，以确定带有地表边界条件的竖向应力剖面 $ \\sigma_v(z) $。\n- 通过设置与规定的 $ K_0(z) $ 和计算出的 $ \\sigma_v(z) $ 一致的水平应力 $ \\sigma_h(z) $，来强制目标静止土压力系数。\n- 通过静止状态下的零侧向应变来强制应变协调，并通过适当的局部弹性参数确保线性各向同性弹性内的本构一致性。\n- 计算满足运动协调性（$ w(0) = 0 $）的竖向应变 $ \\varepsilon_v(z) $ 和竖向位移 $ w(z) $。\n- 对于每个测试用例，报告由底部竖向应力 $ \\sigma_v(H) $、底部水平应力 $ \\sigma_h(H) $ 和底部竖向位移 $ w(H) $ 组成的三元组。\n\n数学和物理定义：\n- 设单位重量为 $ \\gamma(z) $（单位体积的力），弹性模量为 $ E(z) $，静止土压力系数为 $ K_0(z) $。在每一层中，$ \\gamma(z) $ 和 $ E(z) $ 是常数，$ K_0(z) $ 随深度为常数或线性变化。地表超载为 $ q_0 $（在 $ z=0 $ 处施加的均匀竖向应力）。\n- 重力体力作用下的竖向平衡方程由带地表边界条件的一维平衡给出。目标水平应力受 $ K_0(z) $ 的约束。\n- 应变协调要求静止状态下侧向应变为零，且竖向应变积分得到竖向位移。\n\n实现要求：\n- 您的数值方法必须沿 $ z $ 从 $ z=0 $ 到 $ z=H $ 积分竖向平衡方程，并使用给定的地表边界条件来获得 $ \\sigma_v(z) $。使用目标 $ K_0(z) $ 来局部确定 $ \\sigma_h(z) $。在线性各向同性弹性中强制协调性和本构一致性，以确定竖向应变 $ \\varepsilon_v(z) $ 和竖向位移 $ w(z) $。使用足够精细的深度离散化，以便为所提供的数据获得稳定且收敛的结果；$ z $ 方向上的均匀离散化是可以接受的。\n- 对于每个测试用例，仅报告三元组 $ [\\sigma_v(H), \\sigma_h(H), w(H)] $，所有三个数值均四舍五入到 $3$ 位小数。应力以帕斯卡表示，位移以米表示。\n\n测试套件：\n对于每个案例，土柱由 $N$ 层组成，厚度为 $h_i$（$i=1,\\dots,N$），使得 $ \\sum_{i=1}^N h_i = H $。在第 $i$ 层内，$ \\gamma(z)=\\gamma_i $ 且 $ E(z)=E_i $。目标 $ K_0(z) $ 为常数 $ K_0(z) = K_{0,c} $ 或线性 $ K_0(z) = K_{0,0} + a z $。所有参数如下：\n\n- 案例 $1$（两层，线性 $K_0$ 和非零超载）：\n  - $N = 2$，$[h_1,h_2] = [10, 15]$ 米，因此 $ H = 25 $ 米。\n  - $[\\gamma_1,\\gamma_2] = [19000, 21000]$ 牛顿每立方米。\n  - $[E_1,E_2] = [3.0\\times 10^7, 6.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.5 + 0.01 z $。\n  - $ q_0 = 50000 $ 帕斯卡。\n\n- 案例 $2$（单层，常数 $K_0$，零超载）：\n  - $N = 1$，$[h_1] = [20]$ 米，因此 $ H = 20 $ 米。\n  - $[\\gamma_1] = [20000]$ 牛顿每立方米。\n  - $[E_1] = [1.0\\times 10^8]$ 帕斯卡。\n  - $ K_0(z) = 0.4 $。\n  - $ q_0 = 0 $ 帕斯卡。\n\n- 案例 $3$（三层，常数低 $K_0$，非零超载）：\n  - $N = 3$，$[h_1,h_2,h_3] = [5, 5, 5]$ 米，因此 $ H = 15 $ 米。\n  - $[\\gamma_1,\\gamma_2,\\gamma_3] = [18000, 18000, 18000]$ 牛顿每立方米。\n  - $[E_1,E_2,E_3] = [5.0\\times 10^7, 5.0\\times 10^7, 5.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.05 $。\n  - $ q_0 = 10000 $ 帕斯卡。\n\n- 案例 $4$（单层，线性高 $K_0$，零超载）：\n  - $N = 1$, $[h_1] = [30]$ 米，因此 $ H = 30 $ 米。\n  - $[\\gamma_1] = [22000]$ 牛顿每立方米。\n  - $[E_1] = [8.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.6 + 0.004 z $。\n  - $ q_0 = 0 $ 帕斯卡。\n\n最终要求的输出格式：\n- 您的程序应生成一行输出，包含一个结果列表，每个测试用例一个结果，其中每个结果本身是所要求的三个值 $[\\sigma_v(H), \\sigma_h(H), w(H)]$ 的列表，四舍五入到 $3$ 位小数，打印值中不包含单位。例如：\n- $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$", "solution": "我们推导出一个一致的数值地应力初始化方法，该方法在满足平衡、协调和线弹性本构关系的同时，能够再现一个预设的静止土压力系数。\n\n设置竖向轴，使 $ z $ 向下增加，地表处为 $ z=0 $，基底处为 $ z=H $。设 $ \\gamma(z) $ 表示单位重量，$ E(z) $ 表示杨氏模量，$ K_0(z) $ 表示目标静止土压力系数。地表超载 $ q_0 $ 施加在 $ z=0 $ 处。\n\n步骤1：竖向应力平衡。\n在准静态条件下且无侧向体力时，柯西动量平衡在竖直方向上简化为\n$$\n\\frac{d \\sigma_v}{d z} = \\gamma(z),\n$$\n边界条件为\n$$\n\\sigma_v(0) = q_0.\n$$\n这是一个一阶常微分方程。给定按层分段常数的 $ \\gamma(z) $，我们从 $ z=0 $ 积分到 $ z=H $，得到\n$$\n\\sigma_v(z) = q_0 + \\int_0^z \\gamma(s) \\, ds.\n$$\n在数值上，我们在一个均匀的深度网格 $ z_k = k \\,\\Delta z $ 上通过前向欧拉累积来近似该积分\n$$\n\\sigma_v(z_{k+1}) \\approx \\sigma_v(z_k) + \\gamma(z_k) \\,\\Delta z.\n$$\n\n步骤2：目标静止水平应力。\n目标静止土压力系数被规定为一个函数 $ K_0(z) $，可以是常数 $ K_0(z)=K_{0,c} $ 或线性 $ K_0(z) = K_{0,0} + a z $。强制\n$$\n\\sigma_h(z) = K_0(z)\\,\\sigma_v(z).\n$$\n\n步骤3：协调性与本构一致性。\n采用小应变的线性各向同性弹性理论。在主方向上，正应变满足\n$$\n\\varepsilon_i = \\frac{1}{E}\\Big(\\sigma_i - \\nu (\\sigma_j + \\sigma_k)\\Big),\n$$\n对于 $ i\\neq j\\neq k\\in\\{x,y,z\\} $，其中 $ E $ 是杨氏模量，$ \\nu $ 是泊松比。对于一维土柱中的静止状态，侧向应变为零：\n$$\n\\varepsilon_x = 0,\\quad \\varepsilon_y = 0.\n$$\n施加 $ \\varepsilon_x = 0 $ 得到\n$$\n0 = \\frac{1}{E}\\Big(\\sigma_h - \\nu (\\sigma_h + \\sigma_v)\\Big) \\;\\Rightarrow\\; \\sigma_h = \\frac{\\nu}{1-\\nu}\\,\\sigma_v.\n$$\n因此，为了与目标静止条件 $ \\sigma_h=K_0 \\sigma_v $ 保持一致，我们必须强制\n$$\nK_0(z) = \\frac{\\nu(z)}{1-\\nu(z)} \\;\\Rightarrow\\; \\nu(z) = \\frac{K_0(z)}{1+K_0(z)}.\n$$\n这种对 $ \\nu(z) $ 的局部选择保证了侧向应变为零，并维持了在每个深度的静止应力比的本构一致性。因此，竖向应变为\n$$\n\\varepsilon_v(z) = \\frac{1}{E(z)}\\Big(\\sigma_v(z) - \\nu(z)\\big(\\sigma_h(z) + \\sigma_h(z)\\big)\\Big) = \\frac{1}{E(z)}\\Big(\\sigma_v(z) - 2\\,\\nu(z)\\,\\sigma_h(z)\\Big).\n$$\n给定 $ \\sigma_h(z) = K_0(z)\\,\\sigma_v(z) $ 和 $ \\nu(z) = \\dfrac{K_0(z)}{1+K_0(z)} $，这可以简化为\n$$\n\\varepsilon_v(z) = \\frac{\\sigma_v(z)}{E(z)} \\left(1 - 2\\,\\nu(z)\\,K_0(z)\\right),\n$$\n该式可逐点计算。\n\n步骤4：运动协调性与沉降。\n竖向应变是竖向位移 $ w(z) $ 的导数：\n$$\n\\varepsilon_v(z) = \\frac{d w}{d z},\\qquad w(0)=0.\n$$\n积分得到位移：\n$$\nw(z) = \\int_0^z \\varepsilon_v(s)\\, ds.\n$$\n在数值上，在相同的网格上，通过以下方式累积\n$$\nw(z_{k+1}) \\approx w(z_k) + \\varepsilon_v(z_k)\\,\\Delta z.\n$$\n\n算法总结：\n- 建立一个从 $ 0 $ 到 $ H $ 的均匀深度网格 $ z_k = k \\Delta z $；确定层指数以访问 $ \\gamma(z_k) $ 和 $ E(z_k) $。\n- 按规定（常数或线性）计算 $ K_0(z_k) $。\n- 初始化 $ \\sigma_v(0)=q_0 $ 和 $ w(0)=0 $。\n- 对于每个增量 $ k \\to k+1 $：\n  - 更新竖向应力：$ \\sigma_v(z_{k+1}) = \\sigma_v(z_k) + \\gamma(z_k)\\,\\Delta z $。\n  - 计算水平应力：$ \\sigma_h(z_k) = K_0(z_k)\\,\\sigma_v(z_k) $。\n  - 计算泊松比：$ \\nu(z_k) = K_0(z_k)/(1+K_0(z_k)) $。\n  - 计算竖向应变：$ \\varepsilon_v(z_k) = \\big(\\sigma_v(z_k) - 2\\,\\nu(z_k)\\,\\sigma_h(z_k)\\big)/E(z_k) $。\n  - 更新位移：$ w(z_{k+1}) = w(z_k) + \\varepsilon_v(z_k)\\,\\Delta z $。\n- 在 $ z=H $ 处，报告 $ \\sigma_v(H) $、$ \\sigma_h(H)=K_0(H)\\,\\sigma_v(H) $ 和 $ w(H) $。\n\n正确性：\n- 通过积分平衡方程 $ d \\sigma_v/dz=\\gamma $ 并施加地表边界条件 $ \\sigma_v(0)=q_0 $ 来构造 $ \\sigma_v $，从而满足平衡条件。\n- 通过 $ \\varepsilon_v = d w/d z $ 和 $ \\varepsilon_x=\\varepsilon_y=0 $ 满足协调性。\n- 通过使用局部泊松比 $ \\nu(z)=K_0(z)/(1+K_0(z)) $ 的线性各向同性弹性来满足本构一致性，确保 $ \\sigma_h = K_0 \\sigma_v $ 与零侧向应变所隐含的静止条件一致。\n\n测试套件的输出：\n对于每个案例，程序计算三元组 $ [\\sigma_v(H), \\sigma_h(H), w(H)] $，将每个值四舍五入到 $3$ 位小数，并打印包含三元组列表的单行。应力单位为帕斯卡，位移单位为米。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef k0_function_factory(kind, params):\n    \"\"\"\n    Create a K0(z) function.\n    kind: 'constant' or 'linear'\n    params: dict with keys depending on kind:\n        - constant: {'k0_c': value}\n        - linear: {'k0_0': value, 'a': slope}\n    Returns: callable K0(z)\n    \"\"\"\n    if kind == 'constant':\n        k0_c = params['k0_c']\n        return lambda z: k0_c\n    elif kind == 'linear':\n        k00 = params['k0_0']\n        a = params['a']\n        return lambda z: k00 + a * z\n    else:\n        raise ValueError(\"Unknown K0 kind\")\n\ndef make_layer_functions(layer_thicknesses, gammas, moduli):\n    \"\"\"\n    Given piecewise-constant layers, return functions gamma(z) and E(z),\n    and the total depth H.\n    \"\"\"\n    thicknesses = np.array(layer_thicknesses, dtype=float)\n    gamma_vals = np.array(gammas, dtype=float)\n    E_vals = np.array(moduli, dtype=float)\n    z_interfaces = np.concatenate(([0.0], np.cumsum(thicknesses)))\n    H = z_interfaces[-1]\n\n    def find_layer_index(z):\n        # For z in [0,H], return the layer index\n        # Handle z == H to belong to last layer\n        if z = H:\n            return len(thicknesses) - 1\n        # Find i such that z in [z_interfaces[i], z_interfaces[i+1])\n        i = np.searchsorted(z_interfaces, z, side='right') - 1\n        i = max(0, min(i, len(thicknesses)-1))\n        return i\n\n    def gamma_of_z(z):\n        i = find_layer_index(z)\n        return gamma_vals[i]\n\n    def E_of_z(z):\n        i = find_layer_index(z)\n        return E_vals[i]\n\n    return gamma_of_z, E_of_z, H\n\ndef geostatic_compute(layer_thicknesses, gammas, moduli, k0_kind, k0_params, q0,\n                      dz=0.01):\n    \"\"\"\n    Compute sigma_v(H), sigma_h(H), w(H) under the design outlined in the problem.\n    Units:\n      - gammas in N/m^3\n      - moduli in Pa\n      - q0 in Pa\n      - dz in m\n    Returns tuple (svH, shH, wH)\n    \"\"\"\n    gamma_z, E_z, H = make_layer_functions(layer_thicknesses, gammas, moduli)\n    K0 = k0_function_factory(k0_kind, k0_params)\n\n    # Depth grid\n    n_steps = int(np.ceil(H / dz))\n    # Ensure last point is exactly H\n    z = np.linspace(0.0, H, n_steps + 1)\n    dz_local = np.diff(z)  # size n_steps\n\n    # Initialize arrays\n    sigma_v = np.zeros_like(z)\n    w = np.zeros_like(z)\n\n    # Boundary conditions at surface\n    sigma_v[0] = q0\n    w[0] = 0.0\n\n    # March downwards\n    for k in range(n_steps):\n        zk = z[k]\n        dzk = dz_local[k]\n        gam = gamma_z(zk)\n        # Update vertical stress by equilibrium\n        sigma_v[k+1] = sigma_v[k] + gam * dzk\n\n        # Compute strains and update displacement using values at zk\n        k0_val = K0(zk)\n        # Ensure K0 is nonnegative and away from singularity for nu\n        # but per test suite it's in a safe range; still guard numerically\n        if k0_val  0:\n            k0_val = 0.0\n        nu = k0_val / (1.0 + k0_val)\n        sh = k0_val * sigma_v[k]\n        E = E_z(zk)\n        eps_v = (sigma_v[k] - 2.0 * nu * sh) / E\n        w[k+1] = w[k] + eps_v * dzk\n\n    # Bottom values\n    svH = sigma_v[-1]\n    k0H = K0(H)\n    shH = k0H * svH\n    wH = w[-1]\n    return svH, shH, wH\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Case 1\n    case1_layers = [10.0, 15.0]  # m\n    case1_gammas = [19000.0, 21000.0]  # N/m^3\n    case1_moduli = [3.0e7, 6.0e7]  # Pa\n    case1_k0_kind = 'linear'\n    case1_k0_params = {'k0_0': 0.5, 'a': 0.01}\n    case1_q0 = 50000.0  # Pa\n\n    # Case 2\n    case2_layers = [20.0]\n    case2_gammas = [20000.0]\n    case2_moduli = [1.0e8]\n    case2_k0_kind = 'constant'\n    case2_k0_params = {'k0_c': 0.4}\n    case2_q0 = 0.0\n\n    # Case 3\n    case3_layers = [5.0, 5.0, 5.0]\n    case3_gammas = [18000.0, 18000.0, 18000.0]\n    case3_moduli = [5.0e7, 5.0e7, 5.0e7]\n    case3_k0_kind = 'constant'\n    case3_k0_params = {'k0_c': 0.05}\n    case3_q0 = 10000.0\n\n    # Case 4\n    case4_layers = [30.0]\n    case4_gammas = [22000.0]\n    case4_moduli = [8.0e7]\n    case4_k0_kind = 'linear'\n    case4_k0_params = {'k0_0': 0.6, 'a': 0.004}\n    case4_q0 = 0.0\n\n    test_cases = [\n        (case1_layers, case1_gammas, case1_moduli, case1_k0_kind, case1_k0_params, case1_q0),\n        (case2_layers, case2_gammas, case2_moduli, case2_k0_kind, case2_k0_params, case2_q0),\n        (case3_layers, case3_gammas, case3_moduli, case3_k0_kind, case3_k0_params, case3_q0),\n        (case4_layers, case4_gammas, case4_moduli, case4_k0_kind, case4_k0_params, case4_q0),\n    ]\n\n    results = []\n    for layers, gammas, moduli, k0_kind, k0_params, q0 in test_cases:\n        svH, shH, wH = geostatic_compute(layers, gammas, moduli, k0_kind, k0_params, q0, dz=0.01)\n        results.append([svH, shH, wH])\n\n    # Format results to three decimals as required\n    formatted_cases = []\n    for triplet in results:\n        formatted_triplet = [f\"{x:.3f}\" for x in triplet]\n        formatted_cases.append(f\"[{','.join(formatted_triplet)}]\")\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```", "id": "3533886"}]}