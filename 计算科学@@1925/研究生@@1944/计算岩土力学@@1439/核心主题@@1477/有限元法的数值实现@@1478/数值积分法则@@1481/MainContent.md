## 引言
在计算岩土力学的广阔领域中，[有限元法](@entry_id:749389)（FEM）是分析复杂土体和岩石行为的基石。然而，将连续的物理问题转化为可解的[代数方程](@entry_id:272665)组，一个核心且不可回避的步骤是在单元上进行积分运算。由于被积函数的复杂性，解析积分往往遥不可及，因此，[数值积分法则](@entry_id:175061)成为驱动有限元引擎的关键部件。选择一个合适的积分方案并非简单的技术操作，而是一项深刻影响分析结果准确性、稳定性和[计算效率](@entry_id:270255)的建模决策。许多使用者将其视为一个“黑匣子”，却不了解不同法则背后的权衡与后果，这正是本文旨在弥合的知识鸿沟。

本文将系统地引导你穿越[数值积分](@entry_id:136578)的理论与实践迷雾。在 **“原理与机制”** 一章中，我们将从基本概念出发，剖析牛顿-科茨和高斯求积两大主流方法，揭示其精度和稳定性的来源。随后，在 **“应用与[交叉](@entry_id:147634)学科联系”** 一章中，我们将理论与工程实践紧密结合，探讨[减缩积分](@entry_id:167949)、闭锁现象、[沙漏控制](@entry_id:163812)以及在处理[非线性](@entry_id:637147)、奇异性问题时的应用策略。最后，通过 **“动手实践”** 一章中的精选问题，你将有机会亲手构建和应用积分法则，将理论知识转化为解决实际问题的能力。

## 原理与机制

在计算岩[土力学](@entry_id:180264)中，有限元法的核心在于将连续体力学问题离散化为[代数方程](@entry_id:272665)组。这一过程不可避免地涉及在每个单元域上计算积分，例如，用于组装[单元刚度矩阵](@entry_id:139369)、[质量矩阵](@entry_id:177093)和[内力向量](@entry_id:750751)。这些积分通常形式复杂，难以或无法获得解析解。因此，**数值积分 (numerical integration)**，也称为**[数值求积](@entry_id:136578) (numerical quadrature)**，成为有限元分析中一个不可或缺的计算工具。本章将深入探讨数值积分的基本原理、主要求积法则族及其在有限元分析中的关键应用和高级主题。

### [数值积分](@entry_id:136578)的基本概念

在有限元方法中，我们遇到的典型积分形式为对单元物理域 $\Omega_e$ 的积分。例如，在小应变线弹性问题中，[单元刚度矩阵](@entry_id:139369)的分量涉及如下[形式的积分](@entry_id:158607)：
$$
\int_{\Omega_e} \mathbf{B}(\mathbf{x})^{\top}\,\mathbf{D}(\mathbf{x})\,\mathbf{B}(\mathbf{x})\,\mathrm{d}\Omega
$$
其中 $\mathbf{B}$ 是[应变-位移矩阵](@entry_id:163451)，由形函数的导数构成；$\mathbf{D}$ 是[本构矩阵](@entry_id:164908)。为了方便计算，通常采用**[等参映射](@entry_id:173239) (isoparametric mapping)**，将物理坐标 $\mathbf{x}$ 的物理单元 $\Omega_e$ 映射到一个具有[局部坐标](@entry_id:181200) $\boldsymbol{\xi}$ 的标准参考单元 $\hat{\Omega}$（例如，一维的 $[-1,1]$ 区间或二维的 $[-1,1]^2$ 方块）。

#### [等参映射](@entry_id:173239)与坐标变换

通过映射 $\mathbf{x} = \mathbf{x}(\boldsymbol{\xi})$，积分变量得以转换。根据多元微积分中的[换元积分法](@entry_id:144683)则，物理域上的微元 $\mathrm{d}\Omega$ 与参考域上的微元 $\mathrm{d}\hat{\Omega}$ 通过雅可比行列式 $J(\boldsymbol{\xi})$ 联系起来：
$$
\mathrm{d}\Omega = \det(\mathbf{J}_{\xi})\,\mathrm{d}\hat{\Omega} = J(\boldsymbol{\xi})\,\mathrm{d}\hat{\Omega}
$$
其中 $\mathbf{J}_{\xi} = \partial \mathbf{x} / \partial \boldsymbol{\xi}$ 是映射的[雅可比矩阵](@entry_id:264467)。因此，原始积分被转换为在固定参考域 $\hat{\Omega}$ 上的积分：
$$
\int_{\Omega_e} f(\mathbf{x})\,\mathrm{d}\Omega = \int_{\hat{\Omega}} f(\mathbf{x}(\boldsymbol{\xi}))\,J(\boldsymbol{\xi})\,\mathrm{d}\hat{\Omega}
$$
这个变换是进行[数值积分](@entry_id:136578)的基础。例如，对于一个从 $[-1,1]$ 映射到 $[a,b]$ 的一维线性[等参单元](@entry_id:173863)，其映射为 $x(\xi) = \frac{a+b}{2} + \frac{b-a}{2}\xi$。其[雅可比行列式](@entry_id:137120)（在此为导数）是一个常数 $J(\xi) = \frac{dx}{d\xi} = \frac{b-a}{2}$[@problem_id:3546611]。[雅可比行列式](@entry_id:137120) $J(\boldsymbol{\xi})$ 的作用是描述从参考坐标到物理坐标的局部尺度变换，它解释了单元在物理空间中可能发生的拉伸、压缩或扭曲。

#### 求积法则、精度阶与[收敛阶](@entry_id:146394)

一个**[数值求积](@entry_id:136578)法则 (numerical quadrature rule)** 是用一个在特定**求积点 (quadrature points)** 或**节点 (nodes)** $\boldsymbol{\xi}_i$ 处函数值的加权和来近似[定积分](@entry_id:147612)的方法。其一般形式为：
$$
\int_{\hat{\Omega}} g(\boldsymbol{\xi})\,\mathrm{d}\hat{\Omega} \approx \sum_{i=1}^{n} w_i g(\boldsymbol{\xi}_i)
$$
其中，$\{(\boldsymbol{\xi}_i, w_i)\}_{i=1}^{n}$ 是求积法则的定义，包含 $n$ 个位于参考单元 $\hat{\Omega}$ 内的求积点 $\boldsymbol{\xi}_i$ 和相应的实数**权重 (weights)** $w_i$。

评估一个[求积法则](@entry_id:753909)性能的关键指标是其**精度阶 (degree of exactness)**，记为 $d$。它被定义为该求积法则能够精确计算（即误差为零）的最高次多项式的次数。换言之，如果一个求积法则的精度阶为 $d$，那么对于任意一个总次数不大于 $d$ 的多项式 $p(\boldsymbol{\xi})$，下式恒成立[@problem_id:3546589]：
$$
\int_{\hat{\Omega}} p(\boldsymbol{\xi})\,\mathrm{d}\hat{\Omega} = \sum_{i=1}^{n} w_i p(\boldsymbol{\xi}_i)
$$
并且至少存在一个 $d+1$ 次多项式使得上式不成立。从更根本的角度看，一个[求积法则](@entry_id:753909)在多项式空间 $\mathcal{P}_m$ 上精确的充要条件是它能精确匹配该空间[基函数](@entry_id:170178)（如单项式 $1, \xi, \xi^2, \dots, \xi^m$）的矩[@problem_id:3546598]。

必须将精度阶与[复合求积法则](@entry_id:634240)的**[收敛阶](@entry_id:146394) (order of convergence)** 区分开来。收敛阶描述的是当网格尺寸 $h$（例如单元最大直径）趋于零时，全局[积分误差](@entry_id:171351)的渐近衰减速率。如果[全局误差](@entry_id:147874) $E_{\text{global}}$ 满足 $|E_{\text{global}}| \le C h^q$，则称[收敛阶](@entry_id:146394)为 $q$。[收敛阶](@entry_id:146394) $q$ 不仅取决于[求积法则](@entry_id:753909)的[精度阶](@entry_id:145189) $d$（通常 $q$ 与 $d+1$ 相关），还依赖于被积函数和[几何映射](@entry_id:749852)的光滑性[@problem_id:3546589]。精度阶是求积法则自身的代数性质，而[收敛阶](@entry_id:146394)是其在网格细化过程中的渐近表现。

### 主要的[求积法则](@entry_id:753909)族

#### 牛顿-科茨法则 (Newton-Cotes Rules)

**牛顿-科茨法则**是一类基于**[等距节点](@entry_id:168260)**的**插值型求积法则 (interpolatory quadrature rule)**。其基本思想是用一个穿过 $p$ 个等距采样点的 $p-1$ 次[插值多项式](@entry_id:750764)来近似被积函数，然后对该多项式进行精确积分。

根据节点是否包含积分区间的端点，牛顿-科茨法则分为**闭合式 (closed)**和**开放式 (open)**两种[@problem_id:3546630]。
- **闭合式法则**：节点包含区间的两个端点。例如，梯形法则（2个节点）和[辛普森法则](@entry_id:142987)（3个节点）。
- **开放式法则**：所有节点都严格位于区间的内部。例如，[中点法则](@entry_id:177487)（1个节点）。

对于任意插值型[求积法则](@entry_id:753909)，其权重 $w_i$ 可以通过对相应的[拉格朗日基](@entry_id:751105)函数 $\ell_i(x)$ 进行积分得到，即 $w_i = \int_a^b \ell_i(x) dx$[@problem_id:3546630]。开放式法则的一个重要应用场景是处理在积分端点具有可积奇异性的被积函数（例如，在裂缝尖端分析中），因为它们可以避免在[奇点](@entry_id:137764)处求值[@problem_id:3546630]。

尽管牛顿-科茨法则在低阶时简单直观，但高阶闭合式法则存在严重的数值不稳定性。当节点数 $n$ 增大时（通常 $n \ge 8$），其权重会出现大幅度的正负交替现象。这种现象源于两个方面：首先，基于[等距节点](@entry_id:168260)的高次多项式插值本身在区间端点附近会产生剧烈[振荡](@entry_id:267781)，即**[龙格现象](@entry_id:142935) (Runge phenomenon)**。其次，用于确定权重的[矩匹配](@entry_id:144382)方程会形成一个病态的范德蒙德型[线性系统](@entry_id:147850)，其解（即权重）对微小扰动极其敏感，从而导致数值不稳定[@problem_id:3546676]。这种不稳定性体现在一个稳定性指标 $\Lambda_w = (\sum |w_i|) / (\sum w_i)$ 上，对于有负权的法则，该值会远大于1，表明存在严重的[舍入误差](@entry_id:162651)放大风险。因此，对于光滑但非多项式的被积函数，高阶牛顿-科茨法则的[积分误差](@entry_id:171351)可能不会收敛甚至会发散，这使得它们在通用有限元程序中很少被采用。

#### [高斯求积](@entry_id:146011)：黄金标准

与牛顿-科茨法则固定节点位置不同，**[高斯求积](@entry_id:146011) (Gaussian quadrature)** 通过优化选择节点位置和权重，以在给定节点数下达到最高的[精度阶](@entry_id:145189)。对于一个 $n$ 点的[求积法则](@entry_id:753909)，它有 $2n$ 个自由度（$n$ 个节点位置和 $n$ 个权重）。[高斯求积](@entry_id:146011)巧妙地利用了所有这些自由度，将精度阶提升至惊人的 $2n-1$。

这一卓越性质的关键在于**正交多项式 (orthogonal polynomials)**。对于在区间 $[-1,1]$ 上权重函数为 $w(\xi)=1$ 的积分（这是大多数有限元应用的场景），所用的正交多项式是**勒让德多项式 (Legendre polynomials)**, $P_n(\xi)$。勒让德多项式可以通过罗德里格斯公式定义：
$$
P_{n}(\xi)=\dfrac{1}{2^{n}n!}\dfrac{\mathrm{d}^{n}}{\mathrm{d}\xi^{n}}\!\left[(\xi^{2}-1)^{n}\right]
$$
它们在 $[-1,1]$ 上关于权重 $1$ 是正交的，即 $\int_{-1}^{1} P_m(\xi)P_n(\xi)\,\mathrm{d}\xi = 0$ 对 $m \neq n$ 成立。

**[高斯-勒让德求积](@entry_id:138201) (Gauss-Legendre quadrature)** 的构造如下[@problem_id:3546677]：
1.  **节点**：$n$ 个求积点 $\xi_i$ 被选为 $n$ 次勒让德多项式 $P_n(\xi)$ 的 $n$ 个实数根。这些根都位于 $(-1,1)$ 区间内且互不相同。
2.  **权重**：权重 $w_i$ 可以通过多种方式计算，例如公式 $w_{i}=\dfrac{2}{\bigl(1-\xi_{i}^{2}\bigr)\bigl[P_{n}'(\xi_{i})\bigr]^{2}}$。一个至关重要的性质是，所有[高斯-勒让德求积](@entry_id:138201)的权重都是正数。

这种构造确保了 $n$ 点[高斯求积法](@entry_id:146011)则的精度阶恰好为 $2n-1$[@problem_id:3546598]。正权重保证了数值稳定性，避免了高阶牛顿-科茨法则中的灾难性[误差抵消](@entry_id:749073)问题。由于其高精度和优良的稳定性，高斯求积成为计算力学中数值积分的首选方法。

### 有限元分析中的应用与高级主题

#### 如何选择恰当的[求积法则](@entry_id:753909)

在有限元实践中，选择合适的[求积法则](@entry_id:753909)至关重要。目标通常是使用足够精确的法则来准确计算单元矩阵，同时避免不必要的计算开销。

对于一个在参考域上的被积函数 $g(\boldsymbol{\xi}) = \hat{f}(\boldsymbol{\xi})J(\boldsymbol{\xi})$，如果它是一个多项式，我们可以选择能够精确积分它的最低阶高斯法则。例如，考虑一个从 $[1,3]$ 映射到 $[-1,1]$ 的一维线性单元，被积函数为 $f(x) = x^3 - 2x + 1$。经过坐标变换，$x(\xi) = 2+\xi$，$J(\xi)=1$，参考域上的被积函数为 $g(\xi) = (2+\xi)^3 - 2(2+\xi) + 1$，这是一个 3 次多项式。为了精确积分，我们需要一个精度阶至少为 3 的高斯法则。根据 $2n-1 \ge 3$，解得 $n \ge 2$。因此，最少需要使用 2 点高斯求积[@problem_id:3546611]。

然而，当单元发生**畸变 (distortion)** 时，情况变得复杂。
-   对于**质量矩阵**，其被积函数形式为 $\rho N_i N_j J$。对于一个[双线性](@entry_id:146819)[四边形单元](@entry_id:176937)，即使其形状严重畸变（只要雅可比行列式 $J$ 处处为正），$N_i N_j$ 是一个次数最高为 $2 \times 2$ 的多项式，而 $J$ 是一个次数为 $1 \times 1$ 的多项式，因此总的被积函数仍然是一个多项式（次数最高为 $3 \times 3$）。一个 $2 \times 2$ 的高斯法则（精度阶为 $3 \times 3$）足以精确积分[@problem_id:3546605]。
-   对于**[刚度矩阵](@entry_id:178659)**，情况则完全不同。其被积函数包含梯度项，而物理坐标下的梯度 $\nabla_{\mathbf{x}}N_i$ 是通过 $\nabla_{\mathbf{x}}N_i = (\mathbf{J}_{\xi}^{\top})^{-1} \nabla_{\boldsymbol{\xi}}N_i$ 计算的。这引入了雅可比矩阵的逆，即 $J^{-1}$ 因子。因此，即使对于最简单的畸变单元，刚度矩阵的被积函数也变成了**有理函数**（多项式之比），而不再是多项式。这意味着高斯求积将无法再提供精确的积分结果，只会产生近似值[@problem_id:3546605]。

在先进应用中，可以设计**[自适应求积](@entry_id:144088) (adaptive quadrature)** 方案。例如，通过对[雅可比行列式](@entry_id:137120) $J(\boldsymbol{\xi})$ 进行勒让德多项式谱展开，可以量化其高频成分（即畸变程度）。然后根据这些高频成分的“能量”是否超过某个阈值来动态调整求积阶数，以在保证精度的前提下优化计算效率[@problem_id:3546605]。

#### [高斯点](@entry_id:170251)在[非线性](@entry_id:637147)分析中的核心作用

在[非线性](@entry_id:637147)问题（如[弹塑性](@entry_id:193198)）中，[高斯点](@entry_id:170251)扮演了远比积分采样点更重要的角色。它们是**状态变量的存储点**。在每个[高斯点](@entry_id:170251)，程序会存储应力、塑性应变、[硬化](@entry_id:177483)参数等局部[状态变量](@entry_id:138790)[@problem_id:3546610]。

在一个增量步的计算中，对于每个单元的每个[高斯点](@entry_id:170251)，计算流程如下：
1.  根据节点位移增量计算该点的应变增量 $\Delta\boldsymbol{\varepsilon}$。
2.  执行[本构模型](@entry_id:174726)更新，这通常是一个**[返回映射算法](@entry_id:168456) (Return Mapping Algorithm)**。首先计算一个**弹性试探应力 (elastic trial stress)**。
3.  检查试探应力是否超出了[屈服面](@entry_id:175331)。如果未超出，则该增量步为弹性；如果超出，则发生塑性流动。
4.  若发生塑性，则通过求解[一致性条件](@entry_id:637057)来计算塑性乘子，将应力“[拉回](@entry_id:160816)”到更新后的屈服面上，并更新塑性应变和硬化变量。
5.  最终，单元的[内力向量](@entry_id:750751) $\mathbf{f}_{\text{int}}$ 通过对所有[高斯点](@entry_id:170251)的应力贡献进行加权求和来组装：
    $$
    \mathbf{f}_{\text{int}} \approx \sum_{i=1}^{n_{gp}} w_i J(\boldsymbol{\xi}_i) \, \mathbf{B}(\boldsymbol{\xi}_i)^{\mathsf{T}} \boldsymbol{\sigma}(\boldsymbol{\xi}_i)
    $$
    其中 $\boldsymbol{\sigma}(\boldsymbol{\xi}_i)$ 是在该[高斯点](@entry_id:170251)更新后的应力状态[@problem_id:3546610]。此外，为了在全局牛顿迭代中获得二次收敛性，还需要计算与该[返回映射算法](@entry_id:168456)相一致的**[一致切线模量](@entry_id:168075) (consistent tangent modulus)**。

#### [减缩积分](@entry_id:167949)及其后果：闭锁与沙漏

在某些情况下，使用能够精确积分（或高精度积分）的**完全积分 (full integration)** 反而会导致灾难性的结果。一个典型的例子是模拟[近不可压缩材料](@entry_id:752388)（如排水条件下的饱和黏土，[泊松比](@entry_id:158876) $\nu \to 0.5$）时出现的**体积闭锁 (volumetric locking)**。

低阶单元（如[双线性](@entry_id:146819)四边形）的运动模式有限，当完全积分（例如 $2 \times 2$ 高斯法则）在所有四个[高斯点](@entry_id:170251)上强制施加体积不变（$\text{tr}(\boldsymbol{\varepsilon}) \approx 0$）的约束时，会过度约束单元的变形能力，导致其表现得异常刚硬，无法给出正确的位移和应力解[@problem_id:3546606]。

为解决此问题，一种常用技术是**[减缩积分](@entry_id:167949) (reduced integration)**，即故意使用阶数不足的[求积法则](@entry_id:753909)。例如，对[双线性](@entry_id:146819)[四边形单元](@entry_id:176937)使用单个[高斯点](@entry_id:170251)（$1 \times 1$ 法则）。这相当于只在单元中心施加体积约束，极大地放松了约束，从而有效缓解了体积闭锁。类似地，在梁和板单元中，[减缩积分](@entry_id:167949)也被用来克服**剪切闭锁 (shear locking)**[@problem_id:3546606]。

然而，[减缩积分](@entry_id:167949)是一把双刃剑。其主要副作用是可能引入**[伪零能模式](@entry_id:755267) (spurious zero-energy modes)**，通常称为**[沙漏模式](@entry_id:174855) (hourglass modes)**。这些是单元的特定变形模式，它们在单个[减缩积分](@entry_id:167949)点处的应变为零，因此不产生任何[应变能](@entry_id:162699)。这意味着单元对这些变形模式没有抵抗力，它们可以在网格中不受控制地传播，污染整个解[@problem_id:3546606]。

一种更稳健的策略是**[选择性减缩积分](@entry_id:168281) (selective reduced integration, SRI)**。其思想是将[刚度矩阵](@entry_id:178659)积分分解为易于闭锁的体积部分和不易闭锁的偏量（剪切）部分。然后，对体积部分采用[减缩积分](@entry_id:167949)（如 $1 \times 1$），而对偏量部分仍采用完全积分（如 $2 \times 2$）。这样既能缓解闭锁，又能通过完全积分偏量部分来惩罚[沙漏模式](@entry_id:174855)，从而控制其增长[@problem_id:3546619][@problem_id:3546606]。

需要强调的是，一个单元无论采用何种积分方案，都必须通过**[分片检验](@entry_id:162864) (patch test)**，即在一个单元片上能够精确再现常应变状态。这是保证单元收敛性的基本要求。幸运的是，对于[仿射映射](@entry_id:746332)（即物理单元为平行四边形）的单元，即使是 $1 \times 1$ [减缩积分](@entry_id:167949)也能通过常应变[分片检验](@entry_id:162864)[@problem_id:3546606]。

最后，值得注意的是，[数值积分](@entry_id:136578)方案的选择是针对特定问题的。例如，在混合单元（如孔隙[弹塑性](@entry_id:193198)中的$u-p$单元）中，可能存在因位移和压力[插值函数](@entry_id:262791)空间选择不当而违反 LBB（Ladyzhenskaya–Babuška–Brezzi）稳定条件，导致压[力场](@entry_id:147325)出现棋盘状[伪振荡](@entry_id:152404)。修改刚度矩阵的积分方案无法解决这类与插值空间选择相关的稳定性问题[@problem_id:3546619]。