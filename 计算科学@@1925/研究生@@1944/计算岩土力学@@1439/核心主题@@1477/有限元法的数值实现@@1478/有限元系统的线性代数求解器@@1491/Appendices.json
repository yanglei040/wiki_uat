{"hands_on_practices": [{"introduction": "对于有限元法产生的稀疏线性系统，直接求解器虽然稳健，但其计算成本和内存消耗受“填充”（fill-in）现象的显著影响。本练习旨在通过一个具体的非结构网格案例，让学生亲手实践和对比自然排序与近似最小度（Approximate Minimum Degree, AMD）排序在Cholesky分解过程中的填充模式和计算量差异 [@problem_id:3538782]。通过这个练习，你将直观地理解排序算法如何从图论的角度优化直接求解器的效率。", "problem": "考虑一个来自计算岩土力学中标量扩散问题（例如，稳态渗流）的小型非结构化二维三角形网格，在使用线性有限元对内部节点进行离散化，并施加狄利克雷(Dirichlet)边界条件后，组装得到的全局刚度矩阵 $K$ 是实、对称、正定的。设有 $7$ 个内部节点，标记为 $1$ 到 $7$，其单元连接关系由以下三角形给出：\n- $(1,2,3)$, $(1,3,4)$, $(1,4,5)$, $(1,5,6)$, $(1,6,7)$, $(1,7,2)$。\n假设每个节点只有一个自由度。在标准有限元组装下，$K$ 的对称稀疏模式由节点在单元中的共属关系确定：如果两个节点同时出现在至少一个三角形中，则 $K$ 中对应的非对角线元素在结构上是非零的。\n\n仅使用基本定义（$K$ 的图、用于Cholesky填充的对称消去图模型，以及节点消去会引入边使其当前邻居成为一个团(clique)的思想），执行以下操作：\n\n1) 推导由上述连接关系所隐含的 $K$ 的对称稀疏（邻接）图。然后，在自然顺序 $1,2,\\dots,7$ 下，通过依次消去节点 $1$ 到 $7$ 来执行符号Cholesky消去（图填充）。识别所有出现的填充边，并对于每个消去步骤 $j$，确定节点 $j$ 在其被消去时，在尚未被消去的节点中的邻居数量 $l_j$。\n\n2) 通过在演化中的消去图上应用最小度启发式算法，构建一个近似最小度（AMD）排序，并通过选择索引最小的节点来打破平局。在此AMD排序下重复符号消去，列出引入的填充边，并确定在该排列顺序下的 $l_j$ 值序列。\n\n3) 使用基于消去的外积观点对稀疏Cholesky分解进行的第一性原理运算计数估计，证明主要的乘加运算次数与 $\\sum_{j=1}^{7} l_j^2$ 成正比。令 $S_{\\mathrm{nat}}$ 表示自然顺序下的该总和，$S_{\\mathrm{amd}}$ 表示AMD下的总和。计算精确比值 $S_{\\mathrm{amd}}/S_{\\mathrm{nat}}$ 并将其表示为最简分数。不需要四舍五入，也不需要报告单位。你的最终答案必须是单个数字。", "solution": "该问题是良定的，有科学依据，并包含了得到唯一解所需的所有必要信息。我们首先将问题设置形式化。\n\n内部节点集合为 $V = \\{1, 2, 3, 4, 5, 6, 7\\}$。刚度矩阵 $K$ 的对称稀疏模式由一个无向图 $G = (V, E)$ 表示，其中如果节点 $i$ 和 $j$ 出现在同一个三角形单元中，则存在一条边 $(i, j) \\in E$。给定的单元连接关系为：$(1,2,3)$、$(1,3,4)$、$(1,4,5)$、$(1,5,6)$、$(1,6,7)$ 和 $(1,7,2)$。\n\n首先，我们构建初始邻接图 $G_0 = (V, E_0)$。边是通过取每个三角形内的所有节点对形成的：\n- 从 $(1,2,3)$：边 $(1,2), (1,3), (2,3)$。\n- 从 $(1,3,4)$：边 $(1,3), (1,4), (3,4)$。\n- 从 $(1,4,5)$：边 $(1,4), (1,5), (4,5)$。\n- 从 $(1,5,6)$：边 $(1,5), (1,6), (5,6)$。\n- 从 $(1,6,7)$：边 $(1,6), (1,7), (6,7)$。\n- 从 $(1,7,2)$：边 $(1,7), (1,2), (7,2)$。\n\n唯一的边集合 $E_0$ 是 $\\{(1,2), (1,3), (1,4), (1,5), (1,6), (1,7), (2,3), (3,4), (4,5), (5,6), (6,7), (7,2)\\}$。该图是一个轮图 $W_7$，其中节点 $1$ 为中心枢纽，节点 $2$ 到 $7$ 形成一个环作为外圈。节点的初始度数为：\n- $d(1) = 6$\n- $d(2) = d(3) = d(4) = d(5) = d(6) = d(7) = 3$\n\n对于被消去的节点 $j$，数量 $l_j$ 是其在当前消去图中，仅考虑尚未被消去的节点集合时的邻居数量。节点 $j$ 的符号消去会向图中添加填充边，使得 $j$ 的邻居形成一个团。\n\n**1) 自然顺序消去**\n\n自然顺序是 $(1, 2, 3, 4, 5, 6, 7)$。我们对 $G_0$ 执行符号消去。\n\n- **消去节点 $j=1$**：尚未消去的节点是 $\\{1, 2, 3, 4, 5, 6, 7\\}$。节点 $1$ 的邻居是 $\\{2, 3, 4, 5, 6, 7\\}$。因此，$l_1 = 6$。消去节点 $1$ 使其邻居成为一个团。这些邻居形成一个环 $2-3-4-5-6-7-2$。为了使其成为一个团（$K_6$），我们必须添加所有的弦。引入的填充边是：$(2,4)$, $(2,5)$, $(2,6)$, $(3,5)$, $(3,6)$, $(3,7)$, $(4,6)$, $(4,7)$ 和 $(5,7)$。共有 $9$ 条填充边。在剩余节点 $\\{2, ..., 7\\}$ 上得到的消去图是一个完全图 $K_6$。\n\n- **消去节点 $j=2$**：尚未消去的节点是 $\\{2, 3, 4, 5, 6, 7\\}$，它们构成一个 $K_6$。节点 $2$ 的邻居是 $\\{3, 4, 5, 6, 7\\}$。因此，$l_2 = 5$。由于这些节点是 $K_6$ 的一部分，它们已经构成一个团（$K_5$）。没有引入新的填充边。\n\n- **消去节点 $j=3$**：尚未消去的节点是 $\\{3, 4, 5, 6, 7\\}$，构成一个 $K_5$。节点 $3$ 的邻居是 $\\{4, 5, 6, 7\\}$。因此，$l_3 = 4$。没有引入填充边。\n\n- **消去节点 $j=4$**：尚未消去的节点构成一个 $K_4$。节点 $4$ 的邻居是 $\\{5, 6, 7\\}$。因此，$l_4 = 3$。无填充。\n\n- **消去节点 $j=5$**：尚未消去的节点构成一个 $K_3$。节点 $5$ 的邻居是 $\\{6, 7\\}$。因此，$l_5 = 2$。无填充。\n\n- **消去节点 $j=6$**：尚未消去的节点构成一个 $K_2$。节点 $6$ 的唯一邻居是 $\\{7\\}$。因此，$l_6 = 1$。无填充。\n\n- **消去节点 $j=7$**：节点 $7$ 是最后一个节点。它在尚未消去的节点中没有邻居。因此，$l_7 = 0$。\n\n对于自然顺序，邻居数量的序列是 $(l_1, l_2, l_3, l_4, l_5, l_6, l_7) = (6, 5, 4, 3, 2, 1, 0)$。\n\n**2) 近似最小度（AMD）排序消去**\n\n我们对演化中的消去图应用最小度启发式算法，选择当前尚未消去的节点中度数最小的节点。通过选择索引最小的节点来打破平局。\n\n- **步骤 1**：在 $G_0$ 中，最小度为 $3$，由节点 $\\{2, 3, 4, 5, 6, 7\\}$ 共享。我们选择节点 $2$。排序中的第一个节点是 $p_1 = 2$。$l_2 = 3$。其邻居是 $\\{1, 3, 7\\}$。一条填充边 $(3,7)$ 被添加到图中。\n\n- **步骤 2**：尚未消去的节点是 $\\{1, 3, 4, 5, 6, 7\\}$。在更新后的图中，度数为 $d(1)=5$，以及 $d(3)=d(4)=d(5)=d(6)=d(7)=3$。最小度为 $3$，由 $\\{3, 4, 5, 6, 7\\}$ 共享。我们选择节点 $3$。第二个节点是 $p_2 = 3$。$l_3 = 3$。其邻居是 $\\{1, 4, 7\\}$。一条填充边 $(4,7)$ 被添加。\n\n- **步骤 3**：尚未消去的节点是 $\\{1, 4, 5, 6, 7\\}$。度数为 $d(1)=4$，以及 $d(4)=d(5)=d(6)=d(7)=3$。最小度为 $3$，由 $\\{4, 5, 6, 7\\}$ 共享。我们选择节点 $4$。第三个节点是 $p_3 = 4$。$l_4 = 3$。其邻居是 $\\{1, 5, 7\\}$。一条填充边 $(5,7)$ 被添加。\n\n- **步骤 4**：尚未消去的节点是 $\\{1, 5, 6, 7\\}$。在更新后的图中，由于之前的填充，所有这些节点 $\\{1, 5, 6, 7\\}$ 的度数现在都是 $3$。我们根据打破平局的规则选择节点 $1$。第四个节点是 $p_4 = 1$。$l_1 = 3$。其邻居 $\\{5, 6, 7\\}$ 已经是一个团（边 $(5,6)$ 和 $(6,7)$ 是原始的，而 $(5,7)$ 是上一步的填充边）。没有引入新的填充边。\n\n- **步骤 5**：尚未消去的节点是 $\\{5, 6, 7\\}$，它们构成一个团（$K_3$）。它们的度数都是 $2$。我们选择节点 $5$。第五个节点是 $p_5 = 5$。$l_5 = 2$。无新填充。\n\n- **步骤 6**：尚未消去的节点是 $\\{6, 7\\}$，构成一个 $K_2$。它们的度数都是 $1$。我们选择节点 $6$。第六个节点是 $p_6 = 6$。$l_6 = 1$。无新填充。\n\n- **步骤 7**：最后一个节点是 $p_7 = 7$。$l_7 = 0$。\n\nAMD排序为 $(2, 3, 4, 1, 5, 6, 7)$。引入的填充边是 $(3,7)$、$(4,7)$ 和 $(5,7)$，总计 $3$ 条边。在此排序下，每个节点 $j$ 在其被消去时的邻居数量 $l_j$ 为：\n$l_1=3$, $l_2=3$, $l_3=3$, $l_4=3$, $l_5=2$, $l_6=1$, $l_7=0$。\n\n**3) 运算计数与比值**\n\n运算计数与 $\\sum_{j=1}^{n} l_j^2$ 成正比的理由来自Cholesky分解的外积形式。在步骤 $j$，算法消去节点 $j$。这对应于对与节点 $j$ 的邻居相关联的子矩阵进行一次秩-1更新。在填充后的图中，这 $l_j$ 个邻居形成一个团，对应一个大小为 $l_j \\times l_j$ 的稠密子矩阵。执行此更新所需的浮点运算（乘加）次数与该子矩阵中的元素数量成正比，其数量级为 $l_j^2$。对所有消去步骤求和，得到的总运算计数与 $\\sum_{j=1}^{n} l_j^2$ 成正比。\n\n现在，我们计算两种排序的总和。\n\n对于自然顺序：\n$$S_{\\mathrm{nat}} = \\sum_{j=1}^{7} l_j^2 = 6^2 + 5^2 + 4^2 + 3^2 + 2^2 + 1^2 + 0^2 = 36 + 25 + 16 + 9 + 4 + 1 + 0 = 91$$\n\n对于AMD排序，使用第2部分确定的 $l_j$ 值：\n$$S_{\\mathrm{amd}} = \\sum_{j=1}^{7} l_j^2 = l_1^2 + l_2^2 + l_3^2 + l_4^2 + l_5^2 + l_6^2 + l_7^2$$\n$$S_{\\mathrm{amd}} = 3^2 + 3^2 + 3^2 + 3^2 + 2^2 + 1^2 + 0^2 = 9 + 9 + 9 + 9 + 4 + 1 + 0 = 41$$\n\n比值为：\n$$\\frac{S_{\\mathrm{amd}}}{S_{\\mathrm{nat}}} = \\frac{41}{91}$$\n数字 $41$ 是质数。$91$ 的质因数分解是 $7 \\times 13$。由于 $41$ 不能被 $7$ 或 $13$ 整除，该分数为最简分数。", "answer": "$$\\boxed{\\frac{41}{91}}$$", "id": "3538782"}, {"introduction": "与直接求解器不同，共轭梯度等迭代方法通过一系列近似解来逼近真实解，这就引出了一个核心问题：我们应该在何时停止迭代？通常，求解器监控的是代数残差，但工程上我们更关心解的物理误差，例如位移误差的能量范数。本练习将引导你推导一个重要的不等式，它将预处理残差范数与位移误差的能量范数联系起来 [@problem_id:3538755]，这对于在实际计算中设定有意义的收敛准则至关重要。", "problem": "考虑有界 Lipschitz 域上的小应变线性弹性问题，通过有限元方法 (FEM) 进行离散化。在齐次 Dirichlet 边界条件下，离散平衡方程可以写为线性系统 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 刚度矩阵，通过虚功原理从线性弹性的标准双线性形式组合而成，$u \\in \\mathbb{R}^{n}$ 是节点位移向量，$b \\in \\mathbb{R}^{n}$ 是一致载荷向量。设 $u^{\\star}$ 表示系统的精确离散解，$u_{k}$ 是由 Krylov 求解器（如共轭梯度 (CG) 法）生成的迭代解。定义位移误差 $e_{k} = u^{\\star} - u_{k}$ 和代数残差 $r_{k} = b - A u_{k}$。考虑由刚度矩阵诱导的能量范数 $\\|v\\|_{A} = \\sqrt{v^{\\top} A v}$，以及由 SPD 预条件子 $M \\in \\mathbb{R}^{n \\times n}$ 定义的预处理残差范数 $\\|w\\|_{M^{-1}} = \\sqrt{w^{\\top} M^{-1} w}$。假设预条件子与刚度矩阵在谱意义上等价，即存在正常数 $\\alpha$ 和 $\\beta$，使得对于所有 $v \\in \\mathbb{R}^{n}$，\n$$\n\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v.\n$$\n在实践中通常使用基于残差范数的停止准则 $\\|r_{k}\\|_{M^{-1}} \\leq \\varepsilon$，而应用驱动的验证则倾向于控制位移误差的能量范数 $\\|e_{k}\\|_{A}$。仅从上述基本定义和事实出发，推导最佳常数 $C$（仅用 $\\alpha$ 和 $\\beta$ 表示），使得不等式\n$$\n\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}\n$$\n对所有迭代解 $u_{k}$ 和所有右端项 $b$ 均成立。你的最终答案必须是 $C$ 关于 $\\alpha$ 和 $\\beta$ 的单个封闭形式解析表达式。无需进行数值计算，也不涉及单位。", "solution": "问题要求推导最佳常数 $C$，使得 $\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}$。我们首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **线性系统**：$A u = b$，其中 $A$ 是 $\\mathbb{R}^{n \\times n}$ 中的对称正定 (SPD) 矩阵。\n- **精确解**：$u^{\\star}$，满足 $A u^{\\star} = b$。\n- **迭代解**：$u_{k}$。\n- **位移误差**：$e_{k} = u^{\\star} - u_{k}$。\n- **代数残差**：$r_{k} = b - A u_{k}$。\n- **能量范数**：$\\|v\\|_{A} = \\sqrt{v^{\\top} A v}$。\n- **预条件子**：$M \\in \\mathbb{R}^{n \\times n}$ 是一个 SPD 矩阵。\n- **预处理残差范数**：$\\|w\\|_{M^{-1}} = \\sqrt{w^{\\top} M^{-1} w}$。注意，因为 $M$ 是 SPD，所以 $M^{-1}$ 也是 SPD，因此该范数是良定义的。\n- **谱等价性**：存在正常数 $\\alpha$ 和 $\\beta$，使得对于所有 $v \\in \\mathbb{R}^{n}$，以下不等式成立：\n$$\n\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v.\n$$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。它是有限元方法迭代求解器分析中的一个标准问题。给定的信息是自洽且数学上一致的。范数、矩阵和谱等价的定义在数值线性代数和计算力学中是标准的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题有效。我们继续求解。\n\n我们寻求满足不等式 $\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}$ 的最小常数 $C$，该不等式对所有可能的迭代解 $u_k$ 和右端项 $b$ 都成立。处理范数的平方更为方便。该不等式等价于找到最小的 $C^2$，使得 $\\|e_{k}\\|_{A}^2 \\leq C^2 \\, \\|r_{k}\\|_{M^{-1}}^2$。这个常数 $C^2$ 可以表示为平方范数之比在所有可能的非零误差和残差上的上确界：\n$$\nC^2 = \\sup_{u_k \\neq u^{\\star}} \\frac{\\|e_{k}\\|_{A}^2}{\\|r_{k}\\|_{M^{-1}}^2}\n$$\n首先，我们建立误差 $e_k$ 和残差 $r_k$ 之间的关系。根据它们的定义：\n$$\nr_{k} = b - A u_{k}\n$$\n由于 $b = A u^{\\star}$，我们可以将其代入残差的表达式中：\n$$\nr_{k} = A u^{\\star} - A u_{k} = A (u^{\\star} - u_{k}) = A e_{k}\n$$\n这个基本关系式 $r_k = A e_k$ 将残差与误差联系起来。由于刚度矩阵 $A$ 是可逆的（因为它是 SPD），我们也可以写成 $e_k = A^{-1} r_k$。\n\n现在，让我们用残差 $r_k$ 来表示误差的能量范数平方 $\\|e_{k}\\|_{A}^2$：\n$$\n\\|e_{k}\\|_{A}^2 = e_{k}^{\\top} A e_{k} = (A^{-1} r_{k})^{\\top} A (A^{-1} r_{k}) = r_{k}^{\\top} (A^{-1})^{\\top} A A^{-1} r_{k}\n$$\n由于 $A$ 是对称的，其逆矩阵 $A^{-1}$ 也是对称的，所以 $(A^{-1})^{\\top} = A^{-1}$。表达式简化为：\n$$\n\\|e_{k}\\|_{A}^2 = r_{k}^{\\top} A^{-1} A A^{-1} r_{k} = r_{k}^{\\top} A^{-1} r_{k}\n$$\n预处理残差范数的平方由其定义给出：\n$$\n\\|r_{k}\\|_{M^{-1}}^2 = r_{k}^{\\top} M^{-1} r_{k}\n$$\n将这些表达式代入 $C^2$ 的公式中：\n$$\nC^2 = \\sup_{r_{k} \\neq 0} \\frac{r_{k}^{\\top} A^{-1} r_{k}}{r_{k}^{\\top} M^{-1} r_{k}}\n$$\n注意，如果 $u_k \\neq u^{\\star}$，那么 $e_k \\neq 0$，并且由于 $A$ 是可逆的，$r_k = A e_k \\neq 0$。因此，上确界是在所有非零残差向量 $r_k \\in \\mathbb{R}^n$ 上取值的。\n\n$C^2$ 的表达式是矩阵 $A^{-1}$ 和 $M^{-1}$ 的广义瑞利商。该商的上确界是广义特征值问题 的最大特征值 $\\lambda_{\\max}$：\n$$\nA^{-1} w = \\lambda M^{-1} w\n$$\n由于 $M^{-1}$ 是 SPD 因而可逆，我们可以左乘 $M$：\n$$\nM A^{-1} w = \\lambda w\n$$\n这表明 $C^2$ 是矩阵 $M A^{-1}$ 的最大特征值。我们现在必须将 $M A^{-1}$ 的特征值与给定的谱等价常数 $\\alpha$ 和 $\\beta$ 联系起来。\n\n谱等价条件 $\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v$ 等价于陈述广义特征值问题 $M v = \\gamma A v$ 的特征值位于区间 $[\\alpha, \\beta]$ 内。让我们来证明这种联系。矩阵对 $(M, A)$ 的特征值 $\\gamma$ 与矩阵 $A^{-1/2} M A^{-1/2}$ 的特征值相同，因为 $Mv = \\gamma Av$ 等价于 $(A^{-1/2}MA^{-1/2})(A^{1/2}v) = \\gamma(A^{1/2}v)$。在给定不等式中令 $v = A^{-1/2}x$，可得 $\\alpha x^\\top x \\leq x^\\top (A^{-1/2} M A^{-1/2}) x \\leq \\beta x^\\top x$，根据对称矩阵 $A^{-1/2} M A^{-1/2}$ 的瑞利商原理，这证实了其特征值在 $[\\alpha, \\beta]$ 内。\n\n现在，考虑我们感兴趣的矩阵的特征值问题 $M A^{-1} w = \\lambda w$。我们定义一个新向量 $v = A^{-1} w$。由于 $A$ 可逆，任何向量 $v$ 都可以这样表示。将 $w = A v$ 代入特征方程得：\n$$\nM A^{-1} (A v) = \\lambda (A v)\n$$\n$$\nM v = \\lambda A v\n$$\n这正是矩阵对 $(M, A)$ 的广义特征值问题。这表明矩阵 $M A^{-1}$ 的特征值 $\\lambda$ 与矩阵对 $(M, A)$ 的广义特征值 $\\gamma$ 完全相同。\n\n因此，$M A^{-1}$ 的特征值包含在区间 $[\\alpha, \\beta]$ 内。因此，$M A^{-1}$ 的最大特征值的上界是 $\\beta$：\n$$\n\\lambda_{\\max}(M A^{-1}) \\leq \\beta\n$$\n这意味着 $C^2 = \\sup_{r_{k} \\neq 0} \\frac{r_{k}^{\\top} A^{-1} r_{k}}{r_{k}^{\\top} M^{-1} r_{k}} = \\lambda_{\\max}(M A^{-1}) \\leq \\beta$。\n\n要成为“最佳”常数，上确界必须是可达的。谱等价的定义意味着，对于任何给定的 $\\alpha, \\beta > 0$，可以构造矩阵 $A$ 和 $M$，使得相关的广义特征值问题 $Mv = \\lambda Av$ 的谱恰好覆盖区间 $[\\alpha, \\beta]$。在这种情况下，最大特征值将精确地是 $\\beta$。因此，$\\lambda_{\\max}(M A^{-1})$ 的最紧上界是 $\\beta$。\n\n我们得出结论，最佳常数 $C^2$ 是 $\\beta$。\n$$\nC^2 = \\beta\n$$\n取平方根得到常数 $C$：\n$$\nC = \\sqrt{\\beta}\n$$\n这个常数保证了对于任何满足给定条件的问题，都有 $\\|e_{k}\\|_{A} \\leq \\sqrt{\\beta} \\, \\|r_{k}\\|_{M^{-1}}$ 成立，并且没有更小的常数能提供同样的普适保证。", "answer": "$$\n\\boxed{\\sqrt{\\beta}}\n$$", "id": "3538755"}, {"introduction": "求解器的高效性不仅取决于算法本身，更深层次上受到有限元列式方式的影响。通过混合-杂交等方法，可以将一个大规模的、性质不佳的线性系统，转化为一个规模更小且结构优良（如对称正定）的舒尔补系统。本练习将带领你完成一个完整的推导过程：从一维弹性问题的基本定律出发，构建一个杂交混合格式，最终得到定义在单元边界上的舒尔补系统 ([@problem_id:3538745])。通过证明该系统的对称正定性并为其设计多重网格策略，你将深刻体会到如何通过巧妙的物理建模来构建一个易于高效求解的代数问题。", "problem": "考虑在定义域 $[0,L]$ 上的均匀杆的小应变一维线性弹性问题，其杨氏模量为 $E$。令 $u(x)$ 表示位移，$\\sigma(x)$ 表示正应力。控制关系为平衡律 $\\frac{d\\sigma}{dx} + b(x) = 0$ 和本构律 $\\sigma = E\\,\\frac{du}{dx}$，为简化起见，体力 $b(x)$ 取为零。将 $[0,L]$ 划分为 $N$ 个长度为 $h = L/N$ 的均匀单元。在每个单元上，将 $\\sigma$ 和 $u$ 视为局部未知量，并在单元界面处引入拉格朗日乘子 $\\lambda$ 以在混合化框架中强制迹的连续性，从而建立一个混合系统。假设采用最低阶设置，其中每个单元上的局部应力是常数，局部位移是仿射的；拉格朗日乘子表示节点处位移的迹。\n\n从基本平衡律和本构律出发，推导混合化的混合弱形式，构建以单元端点上的拉格朗日乘子为狄利克雷数据的单元级局部问题，并消去局部单元未知量 $\\sigma$ 和 $u$ 以获得关于迹未知量 $\\lambda$ 的全局舒尔补。从第一性原理证明该舒尔补在迹空间上是对称正定（SPD）的。然后，对于均匀网格和迹空间上的周期性边界条件的情况，推导组装后的迹空间上舒尔补算子的无量纲傅里叶符号 $s(\\theta)$（其中 $\\theta$ 以弧度度量），该符号由刚度标度 $E/h$ 归一化，使得 $s(\\theta)$ 是无量纲的。最后，概述一个完全在迹空间上定义的两层多重网格策略，指定限制、延拓和光滑子的容许选择，并论证为何SPD性质支持所述多重网格方案的收敛性。\n\n你的最终答案必须是无量纲傅里叶符号 $s(\\theta)$ 作为 $\\theta$ 的函数的单一闭式解析表达式。无需四舍五入。最终表达式中不得使用物理单位。角度必须以弧度表示。", "solution": "该问题要求对一维弹性问题推导和分析一种混合化的混合有限元格式。任务包括推导舒尔补系统，证明其性质，求其傅里叶符号，并概述一种多重网格求解器。\n\n**1. 弱形式和局部单元问题**\n均匀弹性杆的控制方程是平衡律和本构律：\n$$ \\frac{d\\sigma}{dx} = 0 $$\n$$ \\sigma = E \\frac{du}{dx} $$\n问题指定了一种混合格式，其中应力 $\\sigma$ 和位移 $u$ 在每个长度为 $h=L/N$ 的单元 $K_e = [x_e, x_{e+1}]$ 上被视为局部未知量。指定的逼近空间是常数应力 $\\sigma_e \\in P_0(K_e)$ 和仿射位移 $u_e \\in P_1(K_e)$。\n\n在混合化方法中，单元 $K_e$ 上的局部问题由本构关系定义，并受单元边界 $\\partial K_e$ 上拉格朗日乘子 $\\lambda$ 值的约束。乘子 $\\lambda$ 代表位移场的迹。对于单元 $K_e$，给定节点值 $\\lambda_e$ 和 $\\lambda_{e+1}$。局部位移场 $u_e(x)$ 必须在单元端点处匹配这些值：\n$$ u_e(x_e) = \\lambda_e $$\n$$ u_e(x_{e+1}) = \\lambda_{e+1} $$\n由于 $u_e(x)$ 是仿射（线性）的，它由其在两点处的值唯一确定。使用线性拉格朗日基函数 $N_e(x) = \\frac{x_{e+1}-x}{h}$ 和 $N_{e+1}(x) = \\frac{x-x_e}{h}$：\n$$ u_e(x) = \\lambda_e N_e(x) + \\lambda_{e+1} N_{e+1}(x) = \\lambda_e \\frac{x_{e+1}-x}{h} + \\lambda_{e+1} \\frac{x-x_e}{h} $$\n局部应力场 $\\sigma_e(x)$ 由本构律确定：\n$$ \\sigma_e(x) = E \\frac{du_e}{dx} = E \\left( -\\frac{\\lambda_e}{h} + \\frac{\\lambda_{e+1}}{h} \\right) = \\frac{E}{h} (\\lambda_{e+1} - \\lambda_e) $$\n该表达式表明 $\\sigma_e$ 在单元上是常数，与 $P_0$ 逼近空间一致。这一步通过将局部未知量 $u_e$ 和 $\\sigma_e$ 完全用未知迹 $\\lambda_e$ 和 $\\lambda_{e+1}$ 表示，从而消去了它们。\n\n**2. 全局舒尔补系统**\n迹变量 $\\underline{\\lambda} = (\\lambda_0, \\lambda_1, \\dots, \\lambda_N)^T$ 的全局系统是通过在每个节点弱形式地施加平衡来推导的。平衡方程 $\\frac{d\\sigma}{dx}=0$ 的弱形式意味着通量的连续性，在一维情况下通量即为 $\\sigma$。在任何内部节点 $x_j$（即单元 $e-1=[x_{j-1}, x_j]$ 和单元 $e=[x_j, x_{j+1}]$ 之间的界面），通量之和必须为零。\n从单元 $e-1$ 在其右端点 $x_j$ 的通量为 $\\sigma_{e-1}(x_j) \\cdot n = \\sigma_{e-1} \\cdot (+1)$。\n从单元 $e$ 在其左端点 $x_j$ 的通量为 $\\sigma_e(x_j) \\cdot n = \\sigma_e \\cdot (-1)$。\n节点 $x_j$ 处的通量平衡方程为：\n$$ \\sigma_{e-1} - \\sigma_e = 0 $$\n将应力关于 $\\lambda$ 变量的表达式代入：\n$$ \\sigma_{e-1} = \\frac{E}{h}(\\lambda_j - \\lambda_{j-1}) $$\n$$ \\sigma_e = \\frac{E}{h}(\\lambda_{j+1} - \\lambda_j) $$\n节点 $x_j$ 处的方程变为：\n$$ \\frac{E}{h}(\\lambda_j - \\lambda_{j-1}) - \\frac{E}{h}(\\lambda_{j+1} - \\lambda_j) = 0 $$\n$$ \\frac{E}{h}(-\\lambda_{j-1} + 2\\lambda_j - \\lambda_{j+1}) = 0 $$\n这个方程组定义了作用于迹未知量向量 $\\underline{\\lambda}$ 上的全局舒尔补算子 $S$。$S$ 的矩阵表示是 $\\frac{E}{h}$ 乘以一维离散拉普拉斯矩阵。\n\n对全局系统的单元级贡献可以通过单元舒尔补矩阵 $S_e$ 来表示。单元 $e$ 端点处的通量向量是 $\\underline{\\lambda}_e = (\\lambda_e, \\lambda_{e+1})^T$ 的线性函数。\n$x_e$ 处的通量：$\\sigma_e \\cdot (-1) = -\\frac{E}{h}(\\lambda_{e+1}-\\lambda_e) = \\frac{E}{h}(\\lambda_e - \\lambda_{e+1})$。\n$x_{e+1}$ 处的通量：$\\sigma_e \\cdot (+1) = \\frac{E}{h}(\\lambda_{e+1}-\\lambda_e)$。\n这可以写作：\n$$ \\begin{pmatrix} \\text{Flux at } x_e \\\\ \\text{Flux at } x_{e+1} \\end{pmatrix} = \\frac{E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} \\lambda_e \\\\ \\lambda_{e+1} \\end{pmatrix} $$\n矩阵 $S_e = \\frac{E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 是单元舒尔补。全局矩阵 $S$ 是所有 $S_e$ 的标准有限元组装。\n\n**3. 对称正定（SPD）性质的证明**\n必须证明舒尔补矩阵 $S$ 在迹空间上是对称正定的。\n**对称性**：每个单元矩阵 $S_e = \\frac{E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 都是对称的。全局矩阵 $S$ 是由这些对称单元矩阵求和形成的，因此 $S$ 也是对称的。\n\n**正定性**：我们考察二次型 $\\underline{\\lambda}^T S \\underline{\\lambda}$。这可以通过对单元级贡献求和来计算：\n$$ \\underline{\\lambda}^T S \\underline{\\lambda} = \\sum_{e=0}^{N-1} \\underline{\\lambda}_e^T S_e \\underline{\\lambda}_e $$\n其中 $\\underline{\\lambda}_e = (\\lambda_e, \\lambda_{e+1})^T$ 对应于跨越 $[x_e, x_{e+1}]$ 的单元。\n$$ \\underline{\\lambda}_e^T S_e \\underline{\\lambda}_e = \\begin{pmatrix} \\lambda_e  \\lambda_{e+1} \\end{pmatrix} \\frac{E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} \\lambda_e \\\\ \\lambda_{e+1} \\end{pmatrix} = \\frac{E}{h} (\\lambda_e^2 - 2\\lambda_e \\lambda_{e+1} + \\lambda_{e+1}^2) = \\frac{E}{h} (\\lambda_{e+1} - \\lambda_e)^2 $$\n总二次型为：\n$$ \\underline{\\lambda}^T S \\underline{\\lambda} = \\sum_{e=0}^{N-1} \\frac{E}{h} (\\lambda_{e+1} - \\lambda_e)^2 $$\n由于杨氏模量 $E>0$ 且单元长度 $h>0$，和中的每一项都是非负的。因此，$\\underline{\\lambda}^T S \\underline{\\lambda} \\ge 0$，且 $S$ 是半正定的。\n要使二次型为零，和中的每一项都必须为零：\n$$ \\frac{E}{h}(\\lambda_{e+1} - \\lambda_e)^2 = 0 \\quad \\forall e \\in \\{0, \\dots, N-1\\} $$\n这意味着对所有 $e$ 都有 $\\lambda_{e+1} = \\lambda_e$，因此 $\\lambda_0 = \\lambda_1 = \\dots = \\lambda_N$。这意味着 $S$ 的零空间由常数向量构成，即 $\\text{ker}(S) = \\text{span}\\{(1, 1, \\dots, 1)^T\\}$。这对应于整个杆的刚体平移，它不产生应力，因此应变能为零。\n矩阵 $S$ 仅在与常数向量正交的迹向量子空间上是严格正定（SPD）的，或者通过边界条件（例如，设置 $\\lambda_0=0$）来移除刚体运动。有了这个标准的限定条件，我们认为该算子在相关的解空间上是SPD的。\n\n**4. 无量纲傅里叶符号**\n对于具有周期性边界条件（$\\lambda_{j+N} = \\lambda_j$）的均匀网格，我们对组装的舒尔补算子进行傅里叶分析。作用于 $\\lambda_j$ 的算子模板由节点 $j$ 处的方程给出：\n$$ (S \\underline{\\lambda})_j = \\frac{E}{h} (2\\lambda_j - \\lambda_{j-1} - \\lambda_{j+1}) $$\n我们分析此算子对傅里叶模式 $\\lambda_j = \\exp(i k x_j) = \\exp(i k j h)$ 的作用，其中 $k$ 是波数。\n\\begin{align*} (S \\underline{\\lambda})_j = \\frac{E}{h} (2 e^{ikjh} - e^{ik(j-1)h} - e^{ik(j+1)h}) \\\\ = \\frac{E}{h} e^{ikjh} (2 - e^{-ikh} - e^{ikh}) \\\\ = \\frac{E}{h} e^{ikjh} (2 - 2\\cos(kh)) \\end{align*}\n此模式下算子的特征值为 $\\hat{S}(k) = \\frac{E}{h} (2 - 2\\cos(kh))$。这就是算子 $S$ 的傅里叶符号。\n问题要求的是由刚度标度 $E/h$ 归一化的无量纲符号 $s(\\theta)$，其中无量纲波数为 $\\theta=kh$。\n$$ s(\\theta) = \\frac{\\hat{S}(k)}{E/h} = 2 - 2\\cos(\\theta) $$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，这也可以写成 $s(\\theta) = 4\\sin^2(\\theta/2)$。形式 $2 - 2\\cos(\\theta)$ 是分析的直接结果。\n\n**5. 两层多重网格策略**\n求解迹空间系统 $S\\underline{\\lambda} = \\underline{f}$ 的两层多重网格策略包括以下几个组成部分：\n*   **粗网格**：迹节点的子采样网格，通常间距为 $H=2h$。粗网格算子 $S_H$ 通过伽辽金投影 $S_H = R S P$ 形成，其中 $R$ 是限制算子，$P$ 是延拓算子。\n*   **限制(R)**：将细网格残差向量 $r_h$ 转移到粗网格残差 $r_H$。对于以节点为中心的数据，一个标准的选择是全加权限制，在一维中由模板 $[\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}]$ 给出。\n*   **延拓(P)**：将粗网格校正量 $e_H$ 插值到细网格校正量 $e_h$。标准选择是线性插值，即全加权限制的转置（$P=R^T$）。粗网格值被注入到对应的细网格节点上，而中间细网格节点的值是其粗网格邻居的平均值。\n*   **光滑子**：一种用于衰减误差高频分量的迭代方法。由于 $S$ 是SPD的，可以使用简单高效的光滑子：\n    *   **加权雅可比法**：一个具有良好并行性的简单选择。迭代公式为 $\\underline{\\lambda}^{(k+1)} = \\underline{\\lambda}^{(k)} + \\omega D^{-1}(\\underline{f} - S\\underline{\\lambda}^{(k)})$，其中 $D$ 是 $S$ 的对角线。\n    *   **红黑高斯-赛德尔法**：一种用于离散拉普拉斯算子的优秀光滑子。节点被划分为“红”集和“黑”集。所有红节点同时更新，然后所有黑节点同时更新。这提供了更快的平滑效果，并且在相同颜色的节点上也是可并行的。\n\n**收敛性论证**：$S$ 的SPD性质是多重网格成功的根本。\n1.  **光滑子收敛性**：SPD性质保证了像加权雅可比法和高斯-赛德尔法这样的简单迭代方法是收敛的，使它们能够作为有效的光滑子来衰减高频误差。\n2.  **粗网格算子**：使用 $P=R^T$ 的伽辽金构造 $S_H = R S P$ 确保了如果 $S$ 是SPD的，那么 $S_H$ 也是SPD的。这允许多重网格V循环可以递归应用。\n3.  **两重网格分析**：多重网格的收敛性依赖于平滑和粗网格校正之间的相互作用。光滑子有效地减少了相对于网格的高频误差分量，而粗网格校正有效地减少了剩余的低频分量（这些分量在更粗的网格上表现为高频）。对于所推导出的这类SPD椭圆算子，这种相互作用导致收敛因子与网格尺寸 $h$ 无关，从而得到一个最优的 $O(N)$ 求解方法，其中 $N$ 是迹未知量的数量。", "answer": "$$\\boxed{2 - 2\\cos(\\theta)}$$", "id": "3538745"}]}