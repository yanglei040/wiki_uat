{"hands_on_practices": [{"introduction": "在计算岩土力学中，源自线弹性本构的离散系统通常具有对称正定（SPD）的刚度矩阵。对于这类问题，Cholesky 分解是最为高效和数值稳定的直接求解方法。本练习 [@problem_id:3517762] 将引导你手动完成一个小型 SPD 系统的 Cholesky 分解及求解过程，通过正向和反向替换，让你深入理解这一核心算法的力学原理和计算步骤。", "problem": "一个三自由度线性系统源于计算岩土力学中对一个小应变、线性弹性一维杆段的有限元离散化。根据最小势能原理和弹性双线性形式的矫顽性，组装后的刚度矩阵是对称正定的。给定刚度矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和载荷向量 $b \\in \\mathbb{R}^{3}$：\n$$\nA \\;=\\; \\begin{pmatrix}\n4  2  0 \\\\\n2  10  6 \\\\\n0  6  5\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n8 \\\\\n40 \\\\\n27\n\\end{pmatrix}.\n$$\n请仅使用 Cholesky 分解的定义 $A = L L^{\\top}$（其中 $L$ 是一个对角线元素为正的下三角矩阵）来分解 $A$，然后通过前向和后向代入法求解线性系统 $A x = b$。报告解向量 $x$ 的第三个分量 $x_{3}$。最终答案请表示为精确数。不包含单位。无需四舍五入。", "solution": "本题要求解线性系统 $A x = b$，其中未知向量为 $x \\in \\mathbb{R}^3$，矩阵 $A$ 和向量 $b$ 如下所示：\n$$\nA \\;=\\; \\begin{pmatrix}\n4  2  0 \\\\\n2  10  6 \\\\\n0  6  5\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n8 \\\\\n40 \\\\\n27\n\\end{pmatrix}.\n$$\n指定的求解方法是 Cholesky 分解。\n\n首先，对题目陈述进行验证。题目提供了所有必要的数据（$A$ 和 $b$）并指定了一个清晰、客观的任务。其背景在科学上是合理的。一个关键前提是矩阵 $A$ 是对称正定（SPD）的，这是存在唯一 Cholesky 分解的充分必要条件。\n\n我们验证这个前提。\n对称性：矩阵 $A$ 是对称的，因为对于所有的 $i, j \\in \\{1, 2, 3\\}$ 都有 $A_{ij} = A_{ji}$。例如，$A_{12} = 2 = A_{21}$ 且 $A_{23} = 6 = A_{32}$。\n\n正定性：我们检查 $A$ 的顺序主子式。\n第一顺序主子式为 $\\Delta_1 = |4| = 4 > 0$。\n第二顺序主子式为 $\\det\\begin{pmatrix} 4  2 \\\\ 2  10 \\end{pmatrix} = (4)(10) - (2)(2) = 40 - 4 = 36 > 0$。\n第三顺序主子式是 $A$ 的行列式：\n$$\n\\det(A) = 4 \\det\\begin{pmatrix} 10  6 \\\\ 6  5 \\end{pmatrix} - 2 \\det\\begin{pmatrix} 2  6 \\\\ 0  5 \\end{pmatrix} + 0 = 4(50 - 36) - 2(10 - 0) = 4(14) - 20 = 56 - 20 = 36 > 0.\n$$\n由于所有顺序主子式都为正，矩阵 $A$ 确实是对称正定的。该问题是有效的。\n\n我们接下来求 Cholesky 分解 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素为正的下三角矩阵：\n$$\nL = \\begin{pmatrix} l_{11}  0  0 \\\\ l_{21}  l_{22}  0 \\\\ l_{31}  l_{32}  l_{33} \\end{pmatrix}\n$$\n方程 $A = L L^{\\top}$ 为：\n$$\n\\begin{pmatrix} 4  2  0 \\\\ 2  10  6 \\\\ 0  6  5 \\end{pmatrix} = \\begin{pmatrix} l_{11}  0  0 \\\\ l_{21}  l_{22}  0 \\\\ l_{31}  l_{32}  l_{33} \\end{pmatrix} \\begin{pmatrix} l_{11}  l_{21}  l_{31} \\\\ 0  l_{22}  l_{32} \\\\ 0  0  l_{33} \\end{pmatrix} = \\begin{pmatrix} l_{11}^2  l_{11}l_{21}  l_{11}l_{31} \\\\ l_{21}l_{11}  l_{21}^2+l_{22}^2  l_{21}l_{31}+l_{22}l_{32} \\\\ l_{31}l_{11}  l_{31}l_{21}+l_{32}l_{22}  l_{31}^2+l_{32}^2+l_{33}^2 \\end{pmatrix}\n$$\n将 $A$ 的元素与 $L L^{\\top}$ 的元素一一对应相等：\n\n对于 $L$ 的第一列：\n$l_{11}^2 = 4 \\implies l_{11} = \\sqrt{4} = 2$。\n$l_{11}l_{21} = 2 \\implies 2 l_{21} = 2 \\implies l_{21} = 1$。\n$l_{11}l_{31} = 0 \\implies 2 l_{31} = 0 \\implies l_{31} = 0$。\n\n对于 $L$ 的第二列：\n$l_{21}^2 + l_{22}^2 = 10 \\implies 1^2 + l_{22}^2 = 10 \\implies l_{22}^2 = 9 \\implies l_{22} = \\sqrt{9} = 3$。\n$l_{21}l_{31} + l_{22}l_{32} = 6 \\implies (1)(0) + (3)l_{32} = 6 \\implies 3l_{32} = 6 \\implies l_{32} = 2$。\n\n对于 $L$ 的第三列：\n$l_{31}^2 + l_{32}^2 + l_{33}^2 = 5 \\implies 0^2 + 2^2 + l_{33}^2 = 5 \\implies 4 + l_{33}^2 = 5 \\implies l_{33}^2 = 1 \\implies l_{33} = \\sqrt{1} = 1$。\n\n因此，Cholesky 因子 $L$ 为：\n$$\nL = \\begin{pmatrix} 2  0  0 \\\\ 1  3  0 \\\\ 0  2  1 \\end{pmatrix}\n$$\n线性系统 $A x = b$ 变为 $L L^{\\top} x = b$。我们分两步求解。首先，令 $y = L^{\\top} x$，并使用前向代入法求解下三角系统 $L y = b$ 以得到 $y$。\n$$\n\\begin{pmatrix} 2  0  0 \\\\ 1  3  0 \\\\ 0  2  1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 40 \\\\ 27 \\end{pmatrix}\n$$\n第一个方程给出 $2y_1 = 8 \\implies y_1 = 4$。\n第二个方程给出 $y_1 + 3y_2 = 40 \\implies 4 + 3y_2 = 40 \\implies 3y_2 = 36 \\implies y_2 = 12$。\n第三个方程给出 $2y_2 + y_3 = 27 \\implies 2(12) + y_3 = 27 \\implies 24 + y_3 = 27 \\implies y_3 = 3$。\n所以，中间向量为 $y = \\begin{pmatrix} 4 \\\\ 12 \\\\ 3 \\end{pmatrix}$。\n\n其次，我们使用后向代入法求解上三角系统 $L^{\\top} x = y$ 以得到 $x$。\n$$\nL^{\\top} = \\begin{pmatrix} 2  1  0 \\\\ 0  3  2 \\\\ 0  0  1 \\end{pmatrix}\n$$\n该系统为：\n$$\n\\begin{pmatrix} 2  1  0 \\\\ 0  3  2 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 12 \\\\ 3 \\end{pmatrix}\n$$\n第三个方程给出 $x_3 = 3$。\n第二个方程给出 $3x_2 + 2x_3 = 12 \\implies 3x_2 + 2(3) = 12 \\implies 3x_2 + 6 = 12 \\implies 3x_2 = 6 \\implies x_2 = 2$。\n第一个方程给出 $2x_1 + x_2 = 4 \\implies 2x_1 + 2 = 4 \\implies 2x_1 = 2 \\implies x_1 = 1$。\n\n解向量为 $x = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$。\n题目要求解向量的第三个分量，即 $x_3$。\n其值为 $x_3 = 3$。", "answer": "$$\\boxed{3}$$", "id": "3517762"}, {"introduction": "实际工程问题的有限元网格通常是稀疏的，这意味着刚度矩阵中大部分元素为零。直接求解器（如 Cholesky 分解）的计算效率和内存消耗很大程度上取决于处理这种稀疏性的能力。本练习 [@problem_id:3517776] 将让你从图论的视角出发，通过对节点进行重排序来最小化矩阵的“轮廓”和“填充”，从而揭示节点编号顺序对求解效率的关键影响。", "problem": "在计算地质力学中，对平面应变条件下的准静态线性弹性体进行有限元离散化，会得到一个对称正定刚度矩阵 $A$。其稀疏结构由网格邻接图决定：顶点表示节点未知数，无向边表示因共享单元而产生的耦合。对未知数进行置换的选择会影响直接求解（如 Cholesky 分解）过程中的矩阵包络、带宽和填充。考虑一个小型网格，其邻接图 $G$ 的顶点集为 $V=\\{1,2,3,4,5,6\\}$，边集为\n$$\nE=\\{(1,2),(2,3),(3,4),(4,1),(2,5),(4,6)\\}.\n$$\n这是一个无弦环 $\\{1,2,3,4\\}$，带有两个分别连接到顶点 $2$ 和 $4$ 的叶节点 $\\{5\\}$ 和 $\\{6\\}$。由该网格产生的对称正定矩阵 $A$ 的非零模式对应于边集 $E$ 以及对角线。\n\n对于 $\\{1,2,3,4,5,6\\}$ 的一个置换 $\\pi$，定义置换后的矩阵 $P A P^{\\top}$，其中 $P$ 是与 $\\pi$ 相关联的置换矩阵。矩阵轮廓 $\\mathcal{P}(\\pi)$ 定义为\n$$\n\\mathcal{P}(\\pi)=\\sum_{i=1}^{6}\\left(i-\\ell_{i}(\\pi)\\right),\n$$\n其中 $\\ell_{i}(\\pi)=\\min\\{\\,j \\,\\mid\\, (P A P^{\\top})_{i j}\\neq 0\\,\\}$ 是第 $i$ 行中非零元素（包括对角线元素）的最左侧列索引。定义半带宽 $\\beta(\\pi)$ 为\n$$\n\\beta(\\pi)=\\max\\{|i-j| \\,\\mid\\, (P A P^{\\top})_{i j}\\neq 0\\}.\n$$\n考虑使用由 $\\pi$ 给出的消去顺序对 $P A P^{\\top}$ 进行 Cholesky 分解（无主元选择），并令 $F(\\pi)$ 为 Cholesky 因子 $L$ 中，在 $P A P^{\\top}$ 对应位置为零的次对角线填充项的总数。\n\n从图诱导稀疏性和消去图的基本定义出发，确定一个置换 $\\pi^{\\star}$，使得给定图 $G$ 的矩阵轮廓 $\\mathcal{P}(\\pi)$ 最小，并为该置换计算：\n- 最小化的矩阵轮廓 $\\mathcal{P}(\\pi^{\\star})$，\n- 半带宽 $\\beta(\\pi^{\\star})$，以及\n- $L$ 中的填充数 $F(\\pi^{\\star})$。\n\n将最终答案表示为一个包含 $\\mathcal{P}(\\pi^{\\star})$、$\\beta(\\pi^{\\star})$ 和 $F(\\pi^{\\star})$ 的行矩阵。最终答案无需四舍五入，也不涉及单位。", "solution": "用户要求我解决一个与计算地质力学相关的稀疏矩阵问题。\n\n### 第 1 步：问题验证\n\n首先，我将验证所提供的问题陈述。\n\n#### 第 1.1 步：提取已知信息\n\n-   **上下文**：平面应变下准静态线性弹性体的有限元离散化。\n-   **矩阵**：一个 $6 \\times 6$ 的对称正定 (SPD) 刚度矩阵 $A$。\n-   **图**：$A$ 的稀疏模式对应于一个邻接图 $G$，其具有：\n    -   顶点集 $V=\\{1,2,3,4,5,6\\}$。\n    -   边集 $E=\\{(1,2),(2,3),(3,4),(4,1),(2,5),(4,6)\\}$。\n    -   $A$ 的非零模式由 $i=j$ 或 $(i,j) \\in E$ 定义。\n-   **置换**：$\\{1,2,3,4,5,6\\}$ 的一个置换 $\\pi$ 定义了置换后的矩阵 $P A P^{\\top}$。\n-   **矩阵轮廓**：$\\mathcal{P}(\\pi)=\\sum_{i=1}^{6}\\left(i-\\ell_{i}(\\pi)\\right)$，其中 $\\ell_{i}(\\pi)=\\min\\{j \\mid (P A P^{\\top})_{i j}\\neq 0\\,\\}$。\n-   **半带宽**：$\\beta(\\pi)=\\max\\{|i-j| \\mid (P A P^{\\top})_{i j}\\neq 0\\}$。\n-   **填充**：$F(\\pi)$ 是 $P A P^{\\top}$ 的 Cholesky 因子 $L$ 中，在其对应位置为零的次对角线项的数量。\n\n#### 第 1.2 步：使用提取的已知信息进行验证\n\n-   **科学依据**：该问题基于数值线性代数这一成熟领域，特别是有限元分析中使用的稀疏矩阵技术。所有概念（刚度矩阵、稀疏性、Cholesky 分解、轮廓、带宽、填充、重排算法）都是标准的、科学合理的。\n-   **良定性**：该问题是良定的。它要求在一个有限的置换集合上找到一个使目标函数（$\\mathcal{P}(\\pi)$）最小化的置换，然后计算其他明确定义的量。最小值保证存在。\n-   **客观性**：语言精确且数学化，没有主观或模糊的术语。\n-   **结论**：问题陈述有效。它科学合理、良定、客观且完整。\n\n### 第 2 步：求解\n\n问题要求找到一个使矩阵轮廓 $\\mathcal{P}(\\pi)$ 最小化的置换 $\\pi^\\star$，并为该置换计算轮廓 $\\mathcal{P}(\\pi^\\star)$、半带宽 $\\beta(\\pi^\\star)$ 和填充数 $F(\\pi^\\star)$。\n\n#### 寻找最优置换 $\\pi^\\star$\n\n最小化矩阵轮廓是稀疏矩阵重排中的一个经典问题。虽然一般情况下寻找绝对最小值是一个 NP 完全问题，但逆 Cuthill-McKee (RCM) 算法是为此目的而广泛使用且有效的启发式算法。对于像本题这样的小型结构化图，RCM 很有可能产生最优排序。\n\nRCM 算法涉及从一个外围节点开始的广度优先搜索 (BFS)。外围节点是具有最大离心率的顶点，其中离心率是指从该顶点到图中任何其他顶点的最大最短距离。\n\n1.  **分析图 $G$**：该图由一个 4-环 $\\{1,2,3,4\\}$ 和两个分别连接到顶点 $2$ 和 $4$ 的悬挂顶点 $\\{5\\}$ 和 $\\{6\\}$ 组成。我们来计算所有顶点的离心率。距离 $d(u,v)$ 是 $u$ 和 $v$ 之间最短路径的长度。\n    -   $d(1,v)$: $\\{d(1,1), d(1,2), ..., d(1,6)\\} = \\{0, 1, 2, 1, 2, 2\\}$。离心率 $e(1)=2$。\n    -   $d(2,v)$: $\\{1, 0, 1, 2, 1, 3\\}$。离心率 $e(2)=3$。\n    -   $d(3,v)$: $\\{2, 1, 0, 1, 2, 2\\}$。离心率 $e(3)=2$。\n    -   $d(4,v)$: $\\{1, 2, 1, 0, 3, 1\\}$。离心率 $e(4)=3$。\n    -   $d(5,v)$: $\\{2, 1, 2, 3, 0, 4\\}$。离心率 $e(5)=4$。\n    -   $d(6,v)$: $\\{2, 3, 2, 1, 4, 0\\}$。离心率 $e(6)=4$。\n    图的直径为 $\\max(e(v)) = 4$。外围节点是 $\\{5, 6\\}$。\n\n2.  **应用 Cuthill-McKee (CM) 算法**：我们从一个外围节点（比如 5）开始进行 BFS。在 BFS 的每一层，节点都按度数递增的顺序排列。\n    -   各顶点的度数：$\\deg(1)=2$, $\\deg(2)=3$, $\\deg(3)=2$, $\\deg(4)=3$, $\\deg(5)=1$, $\\deg(6)=1$。\n    -   第 0 层：$\\{5\\}$ (队列: $[5]$)\n    -   第 1 层：$5$ 的邻居是 $\\{2\\}$。(队列: $[2]$)\n    -   第 2 层：$2$ 的邻居是 $\\{1,3,5\\}$。$5$ 已访问。添加 $\\{1,3\\}$。两者度数均为 2。按数字顺序添加：$1, 3$。(队列: $[1,3]$)\n    -   第 3 层：$1$ 和 $3$ 的邻居。$1$ 的邻居是 $\\{2,4\\}$，$2$ 已访问。添加 $4$。$3$ 的邻居是 $\\{2,4\\}$，均已访问。添加 $\\{4\\}$。(队列: $[4]$)\n    -   第 4 层：$4$ 的邻居是 $\\{1,3,6\\}$。$1,3$ 已访问。添加 $\\{6\\}$。(队列: $[6]$)\n    CM 排序为 $\\pi_{CM} = (5, 2, 1, 3, 4, 6)$。\n\n3.  **逆 Cuthill-McKee (RCM) 算法**：RCM 排序是 CM 排序的逆序。\n    $$\n    \\pi^\\star = \\text{reverse}(\\pi_{CM}) = (6, 4, 3, 1, 2, 5)\n    $$\n    这个置换意味着我们重新标记顶点，使得原始顶点 6 成为新顶点 1，原始顶点 4 成为新顶点 2，以此类推。由于图的对称性，从外围节点 6 开始会产生一个等效的排序，例如 $(5, 2, 1, 3, 4, 6)$，它对所需的度量指标会给出相同的结果。我们将使用 $\\pi^\\star = (6, 4, 3, 1, 2, 5)$ 进行计算。\n\n#### 计算 $\\pi^\\star$ 的度量指标\n\n我们用 $A' = PAP^\\top$ 表示置换后的矩阵。其结构由新标记的顶点的邻接关系决定。\n-   新 1 (旧 6) 与 旧 4 (新 2) 相邻。\n-   新 2 (旧 4) 与 旧 {1,3,6} (新 {4,3,1}) 相邻。\n-   新 3 (旧 3) 与 旧 {2,4} (新 {5,2}) 相邻。\n-   新 4 (旧 1) 与 旧 {2,4} (新 {5,2}) 相邻。\n-   新 5 (旧 2) 与 旧 {1,3,5} (新 {4,3,6}) 相邻。\n-   新 6 (旧 5) 与 旧 2 (新 5) 相邻。\n\n$A'$ 的非零非对角线结构由以下边（对称）给出：\n$(1,2), (2,3), (2,4), (3,5), (4,5), (5,6)$。\n\n##### 1. 最小化的矩阵轮廓 $\\mathcal{P}(\\pi^\\star)$\n\n轮廓为 $\\mathcal{P}(\\pi^\\star) = \\sum_{i=1}^{6}(i - \\ell_i(\\pi^\\star))$，其中 $\\ell_i$ 是 $A'$ 第 $i$ 行中第一个非零元素的列索引。\n-   第 1 行 (旧 6)：与新 2 相邻。第一个非零元在对角线上。$\\ell_1 = 1$。\n-   第 2 行 (旧 4)：与新 {1,3,4} 相邻。第一个非零元在第 1 列。$\\ell_2 = 1$。\n-   第 3 行 (旧 3)：与新 {2,5} 相邻。第一个非零元在第 2 列。$\\ell_3 = 2$。\n-   第 4 行 (旧 1)：与新 {2,5} 相邻。第一个非零元在第 2 列。$\\ell_4 = 2$。\n-   第 5 行 (旧 2)：与新 {3,4,6} 相邻。第一个非零元在第 3 列。$\\ell_5 = 3$。\n-   第 6 行 (旧 5)：与新 5 相邻。第一个非零元在第 5 列。$\\ell_6 = 5$。\n轮廓为：\n$$\n\\mathcal{P}(\\pi^\\star) = (1-1) + (2-1) + (3-2) + (4-2) + (5-3) + (6-5) = 0 + 1 + 1 + 2 + 2 + 1 = 7\n$$\n\n##### 2. 半带宽 $\\beta(\\pi^\\star)$\n\n半带宽为 $\\beta(\\pi^\\star) = \\max\\{|i-j| \\mid A'_{ij} \\neq 0\\}$。我们检查新标记下所有边的索引绝对差：\n-   边 (1,2): $|1-2| = 1$。\n-   边 (2,3): $|2-3| = 1$。边 (2,4): $|2-4| = 2$。\n-   边 (3,5): $|3-5| = 2$。\n-   边 (4,5): $|4-5| = 1$。\n-   边 (5,6): $|5-6| = 1$。\n最大差值为 2。\n$$\n\\beta(\\pi^\\star) = 2\n$$\n\n##### 3. 填充数 $F(\\pi^\\star)$\n\nCholesky 分解 ($A' = LL^\\top$) 过程中的填充可以使用消去图模型来确定。我们按照自然顺序 $1, 2, ..., 6$ 处理 $A'$ 的图中的顶点。当一个顶点 $k$ 被消去时，它在剩余图中的邻居必须形成一个团。为完成这个团而添加的任何边都是一个填充。\n\n-   **消去顶点 1**：其唯一的邻居是顶点 2。这是一个平凡团。不产生填充。\n-   **消去顶点 2**：其在当前图中的邻居是 $\\{3,4\\}$。边 $(3,4)$ 在 $A'$ 的原始图中不存在。因此，必须添加一条边 $(3,4)$ 以使 $\\{3,4\\}$ 成为一个团。这产生一个填充项，对应于 $L_{43}$（次对角线项）。\n-   **消去顶点 3**：其在当前图中的邻居是 $\\{2,5\\}$（来自原始图）和 $\\{4\\}$（来自填充）。由于顶点 2 已被消去，其邻居是 $\\{4,5\\}$。边 $(4,5)$ 已存在于 $A'$ 的图中。因此，邻居集 $\\{4,5\\}$ 已经是一个团。不产生填充。\n-   **消去顶点 4**：其在当前图中的邻居是 $\\{2,5\\}$（原始）和 $\\{3\\}$（填充）。顶点 2 和 3 已被消去。唯一剩下的邻居是 $\\{5\\}$。这是一个平凡团。不产生填充。\n-   **消去顶点 5**：其在当前图中的邻居是 $\\{3,4,6\\}$。顶点 3 和 4 已被消去。唯一剩下的邻居是 $\\{6\\}$。这是一个平凡团。不产生填充。\n\n消去过程恰好引入一条新边 $(3,4)$。这对应于一个次对角线填充项。\n$$\nF(\\pi^\\star) = 1\n$$\n\n总之，对于最优置换 $\\pi^\\star=(6, 4, 3, 1, 2, 5)$，计算出的值为：最小轮廓 $\\mathcal{P}(\\pi^\\star)=7$，半带宽 $\\beta(\\pi^\\star)=2$，以及填充数 $F(\\pi^\\star)=1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7  2  1\n\\end{pmatrix}\n}\n$$", "id": "3517776"}, {"introduction": "当问题规模变得非常大时，迭代求解器成为比直接求解器更具吸引力的选择。共轭梯度（CG）法是求解对称正定系统的首选迭代方法，但其收敛速度与系统矩阵的谱特性（尤其是条件数 $\\kappa$）密切相关。本练习 [@problem_id:3517795] 将通过分析一个典型一维弹性杆模型的刚度矩阵特征值，让你定量地估算 CG 方法的收敛迭代次数，从而深刻理解问题本身的物理性质如何决定了迭代求解的计算成本。", "problem": "一根长度为 $L$、杨氏模量 $E$ 和横截面积 $A$ 均为常数的一维均质弹性柱两端固定，并承受体力荷载，但在当前的特征分析中无需考虑这些荷载。小应变、线弹性的轴向位移场 $u(x)$ 通过 $N_{e}$ 个等长的、双节点、线性有限元进行离散化。在两端施加本质（狄利克雷）边界条件后，针对内部自由度的全局刚度矩阵是对称正定的。对于单元长度为 $h = L/N_{e}$ 的均匀网格，为内部节点组装的刚度矩阵具有标准的三对角形式\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h} \\,\\mathbf{T}, \\quad \\text{其中} \\quad \\mathbf{T} \\in \\mathbb{R}^{n \\times n}, \\; n = N_{e}-1,\n$$\n并且 $\\mathbf{T}$ 是一个 $n \\times n$ 的三对角托普利茨矩阵，其主对角线元素为 $2$，第一亚对角线和第一超对角线元素为 $-1$。\n\n考虑具体数据 $L = 6\\,\\mathrm{m}$，$E = 50 \\times 10^{6}\\,\\mathrm{Pa}$，$A = 0.20\\,\\mathrm{m}^{2}$，以及 $N_{e} = 6$，因此 $h = 1\\,\\mathrm{m}$ 且 $n = 5$。于是 $\\mathbf{K} \\in \\mathbb{R}^{5 \\times 5}$ 是一个三对角矩阵，其形式为\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h}\\begin{bmatrix}\n2  -1  0  0  0\\\\\n-1  2  -1  0  0\\\\\n0  -1  2  -1  0\\\\\n0  0  -1  2  -1\\\\\n0  0  0  -1  2\n\\end{bmatrix}.\n$$\n\n任务：\n- 显式计算 $\\mathbf{K}$ 的所有特征值。\n- 使用共轭梯度（CG）法在无预处理情况下求解对称正定系统的经典最坏情况收敛界，估计为使误差的相对 $\\mathbf{K}$-范数减小一个因子 $\\varepsilon = 10^{-8}$（即确保 $\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}} / \\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}} \\le \\varepsilon$）所需的最小整数迭代次数 $m$。此估计应与初始误差 $\\mathbf{e}_{0}$ 无关。请勿使用任何预处理。\n\n请将您的最终答案表示为所需的共轭梯度法最小整数迭代次数 $m$（无量纲）。最终答案中不应报告任何其他量。如果需要任何中间数值，请在可能的情况下进行精确计算；如果无法避免数值近似，请仅在最后对中间值进行四舍五入，以避免累积误差。最终答案是整数，因此不需要按有效数字进行四舍五入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 柱的长度：$L = 6\\,\\mathrm{m}$\n- 杨氏模量：$E = 50 \\times 10^{6}\\,\\mathrm{Pa}$\n- 横截面积：$A = 0.20\\,\\mathrm{m}^{2}$\n- 有限元数量：$N_{e} = 6$\n- 内部自由度数量：$n = N_{e}-1 = 5$\n- 单元长度：$h = L/N_{e} = 1\\,\\mathrm{m}$\n- 内部自由度的全局刚度矩阵：$\\mathbf{K} = \\frac{EA}{h} \\mathbf{T}$，其中 $\\mathbf{T}$ 是 $n \\times n$ 的三对角托普利茨矩阵，主对角线元素为2，第一亚对角线和第一超对角线元素为-1。\n对于 $n=5$ 的具体矩阵形式为：\n$$\n\\mathbf{K} \\;=\\; \\frac{EA}{h}\\begin{bmatrix}\n2  -1  0  0  0\\\\\n-1  2  -1  0  0\\\\\n0  -1  2  -1  0\\\\\n0  0  -1  2  -1\\\\\n0  0  0  -1  2\n\\end{bmatrix}\n$$\n- 共轭梯度（CG）法要求的误差减小量：$\\varepsilon = 10^{-8}$\n- 收敛条件：$\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}} / \\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}} \\le \\varepsilon$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据充分：** 该问题描述了有限元法（FEM）在一维线弹性问题（轴向受载杆）中的一个标准应用。所得到的刚度矩阵是一个众所周知的结构（对称正定三对角托普利茨矩阵）。通过矩阵条件数分析共轭梯度法的收敛性是数值线性代数和科学计算中的一个基本课题。该问题牢固地植根于计算力学和数值分析的既定原则。\n- **适定的：** 计算特征值和所需CG迭代次数的所有必要数据都已提供。任务陈述清晰。问题是自洽的，在数学上是一致的。例如，给定的值 $L=6$ 和 $N_e=6$ 正确地得出 $h=1$，而 $N_e=6$ 正确地得出 $n=5$。矩阵形式对于所描述的物理系统和离散化是正确的。\n- **客观的：** 问题的表述精确、客观且定量。它没有任何主观论断或含糊不清之处。\n\n未发现任何缺陷。该问题不存在科学上不合理、不可形式化、不完整、不现实、不适定、过于简单或无法验证等问题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题过程\n根据问题陈述的要求，解题过程分为两部分。\n\n#### 第一部分：计算 $\\mathbf{K}$ 的特征值\n刚度矩阵 $\\mathbf{K}$ 由 $\\mathbf{K} = \\frac{EA}{h} \\mathbf{T}$ 给出，其中 $\\mathbf{T}$ 是一个 $n \\times n$ 的矩阵：\n$$\n\\mathbf{T} = \\begin{bmatrix}\n2  -1  0  \\dots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  \\ddots  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  2  -1 \\\\\n0  \\dots  0  -1  2\n\\end{bmatrix}\n$$\n$\\mathbf{K}$ 的特征值（记为 $\\lambda_j(\\mathbf{K})$）与 $\\mathbf{T}$ 的特征值（记为 $\\lambda_j(\\mathbf{T})$）通过标量乘子 $\\frac{EA}{h}$ 相关联。\n$$\n\\lambda_j(\\mathbf{K}) = \\frac{EA}{h} \\lambda_j(\\mathbf{T})\n$$\n对于这种特定的 $n \\times n$ 三对角托普利茨矩阵 $\\mathbf{T}$，其特征值是众所周知的，由以下公式给出：\n$$\n\\lambda_j(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{j\\pi}{n+1}\\right), \\quad j = 1, 2, \\dots, n\n$$\n在本问题中，$n = N_{e}-1 = 6-1 = 5$。因此，$n+1 = 6$。$\\mathbf{T}$ 的特征值为：\n$$\n\\lambda_j(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{j\\pi}{6}\\right), \\quad j = 1, 2, 3, 4, 5\n$$\n我们显式计算每个特征值：\n- 对于 $j=1$：$\\lambda_1(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{\\pi}{6}\\right) = 2 - 2\\left(\\frac{\\sqrt{3}}{2}\\right) = 2 - \\sqrt{3}$\n- 对于 $j=2$：$\\lambda_2(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{2\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{\\pi}{3}\\right) = 2 - 2\\left(\\frac{1}{2}\\right) = 1$\n- 对于 $j=3$：$\\lambda_3(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{3\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{\\pi}{2}\\right) = 2 - 2(0) = 2$\n- 对于 $j=4$：$\\lambda_4(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{4\\pi}{6}\\right) = 2 - 2\\cos\\left(\\frac{2\\pi}{3}\\right) = 2 - 2\\left(-\\frac{1}{2}\\right) = 3$\n- 对于 $j=5$：$\\lambda_5(\\mathbf{T}) = 2 - 2\\cos\\left(\\frac{5\\pi}{6}\\right) = 2 - 2\\left(-\\frac{\\sqrt{3}}{2}\\right) = 2 + \\sqrt{3}$\n\n接下来，我们计算标量前置因子 $\\frac{EA}{h}$：\n$$\n\\frac{EA}{h} = \\frac{(50 \\times 10^{6}\\,\\mathrm{Pa})(0.20\\,\\mathrm{m}^{2})}{1\\,\\mathrm{m}} = 10 \\times 10^{6}\\,\\frac{\\mathrm{N}}{\\mathrm{m}} = 10^{7}\\,\\frac{\\mathrm{N}}{\\mathrm{m}}\n$$\n因此，刚度矩阵 $\\mathbf{K}$ 的特征值为：\n- $\\lambda_1(\\mathbf{K}) = 10^{7}(2 - \\sqrt{3})$\n- $\\lambda_2(\\mathbf{K}) = 10^{7}(1) = 10^{7}$\n- $\\lambda_3(\\mathbf{K}) = 10^{7}(2) = 2 \\times 10^{7}$\n- $\\lambda_4(\\mathbf{K}) = 10^{7}(3) = 3 \\times 10^{7}$\n- $\\lambda_5(\\mathbf{K}) = 10^{7}(2 + \\sqrt{3})$\n\n#### 第二部分：CG迭代次数的估计\n对于对称正定系统，共轭梯度（CG）法的经典最坏情况收敛界将误差的 $\\mathbf{K}$-范数减小量与迭代次数 $m$ 和矩阵 $\\mathbf{K}$ 的谱条件数 $\\kappa(\\mathbf{K})$ 联系起来：\n$$\n\\frac{\\lVert \\mathbf{e}_{m} \\rVert_{\\mathbf{K}}}{\\lVert \\mathbf{e}_{0} \\rVert_{\\mathbf{K}}} \\le 2 \\left(\\frac{\\sqrt{\\kappa(\\mathbf{K})} - 1}{\\sqrt{\\kappa(\\mathbf{K})} + 1}\\right)^m\n$$\n我们需要找到最小的整数 $m$，使得该比率小于或等于 $\\varepsilon = 10^{-8}$。\n\n首先，我们计算条件数 $\\kappa(\\mathbf{K})$，即 $\\mathbf{K}$ 的最大特征值与最小特征值之比：\n$$\n\\kappa(\\mathbf{K}) = \\frac{\\lambda_{\\max}(\\mathbf{K})}{\\lambda_{\\min}(\\mathbf{K})} = \\frac{\\lambda_5(\\mathbf{K})}{\\lambda_1(\\mathbf{K})} = \\frac{10^{7}(2 + \\sqrt{3})}{10^{7}(2 - \\sqrt{3})} = \\frac{2 + \\sqrt{3}}{2 - \\sqrt{3}}\n$$\n为了简化这个表达式，我们将分子和分母同乘以分母的共轭：\n$$\n\\kappa(\\mathbf{K}) = \\frac{2 + \\sqrt{3}}{2 - \\sqrt{3}} \\times \\frac{2 + \\sqrt{3}}{2 + \\sqrt{3}} = \\frac{(2 + \\sqrt{3})^2}{2^2 - (\\sqrt{3})^2} = \\frac{4 + 4\\sqrt{3} + 3}{4 - 3} = 7 + 4\\sqrt{3}\n$$\n现在我们计算 $\\sqrt{\\kappa(\\mathbf{K})}$：\n$$\n\\sqrt{\\kappa(\\mathbf{K})} = \\sqrt{7 + 4\\sqrt{3}}\n$$\n我们可以通过识别出 $(2+\\sqrt{3})^2 = 2^2 + 2(2)(\\sqrt{3}) + (\\sqrt{3})^2 = 4 + 4\\sqrt{3} + 3 = 7 + 4\\sqrt{3}$ 来化简这个复合根式。\n因此：\n$$\n\\sqrt{\\kappa(\\mathbf{K})} = 2 + \\sqrt{3}\n$$\n接下来，我们计算收敛因子中的项：\n$$\n\\frac{\\sqrt{\\kappa(\\mathbf{K})} - 1}{\\sqrt{\\kappa(\\mathbf{K})} + 1} = \\frac{(2 + \\sqrt{3}) - 1}{(2 + \\sqrt{3}) + 1} = \\frac{1 + \\sqrt{3}}{3 + \\sqrt{3}}\n$$\n从分母中提出因子 $\\sqrt{3}$ 得到：\n$$\n\\frac{1 + \\sqrt{3}}{\\sqrt{3}(\\sqrt{3} + 1)} = \\frac{1}{\\sqrt{3}}\n$$\n将此结果代回收敛不等式，我们需要求解 $m$：\n$$\n2 \\left(\\frac{1}{\\sqrt{3}}\\right)^m \\le 10^{-8}\n$$\n我们整理并对两边取自然对数：\n$$\n\\left(\\frac{1}{\\sqrt{3}}\\right)^m \\le \\frac{10^{-8}}{2} = 0.5 \\times 10^{-8}\n$$\n$$\n\\ln\\left((\\sqrt{3})^{-m}\\right) \\le \\ln(0.5 \\times 10^{-8})\n$$\n$$\n-m \\ln(\\sqrt{3}) \\le \\ln(0.5) + \\ln(10^{-8})\n$$\n$$\n-\\frac{m}{2} \\ln(3) \\le -\\ln(2) - 8\\ln(10)\n$$\n两边乘以 $-2$ 会使不等号反向：\n$$\nm \\ln(3) \\ge 2\\ln(2) + 16\\ln(10)\n$$\n$$\nm \\ge \\frac{2\\ln(2) + 16\\ln(10)}{\\ln(3)}\n$$\n现在，我们代入对数的数值（$\\ln(2) \\approx 0.693147$，$\\ln(3) \\approx 1.098612$，$\\ln(10) \\approx 2.302585$）：\n$$\nm \\ge \\frac{2(0.693147) + 16(2.302585)}{1.098612}\n$$\n$$\nm \\ge \\frac{1.386294 + 36.84136}{1.098612}\n$$\n$$\nm \\ge \\frac{38.227654}{1.098612} \\approx 34.7951\n$$\n由于迭代次数 $m$ 必须是整数，我们取满足此条件的最小整数值：\n$$\nm = 35\n$$\n因此，为保证所需的误差减小，至少需要35次CG迭代。", "answer": "$$\\boxed{35}$$", "id": "3517795"}]}