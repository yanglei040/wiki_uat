{"hands_on_practices": [{"introduction": "在构建复杂的数值模型之前，理解物理过程的特征时间尺度至关重要。本练习将引导你使用量纲分析这一强大工具，从完全耦合位移-压力 ($u-p$) 公式的基本控制参数中推导出固结过程的特征时间。这有助于将抽象的材料属性（如渗透率 $k$、流体粘度 $\\mu_f$ 和Biot模量 $M$）与可观测的物理现象（固结时间）直接联系起来，从而建立深刻的物理直觉。[@problem_id:3526898]", "problem": "一个饱和、均质、各向同性的多孔弹性层在小应变下使用完全耦合的位移-压力公式（通常称为 $u$–$p$ 公式）进行建模。孔隙流体是牛顿流体。控制要素包括：\n- 固体骨架的线性动量平衡，其中总应力通过 Biot 框架分解为有效应力和孔隙压力。\n- 流体的质量守恒，其储存由 Biot 模量 $M$ 描述（由线性化的流体含量关系 $\\dot{\\zeta} = \\alpha \\dot{\\varepsilon}_{v} + \\dot{p}/M$ 定义，其中 $\\zeta$ 是流体含量，$\\alpha$ 是 Biot 系数，$\\varepsilon_{v}$ 是骨架的体积应变， $p$ 是孔隙压力）。\n- Darcy 定律，其中包含固有渗透率 $k$ 和流体动力粘度 $\\mu_{f}$。\n\n考虑一个特征排水路径长度为 $H_{d}$ 的土层，在双面排水和准静态力学平衡（无惯性）条件下的一维主固结。假设材料响应是线性的，并且 $M$ 是此设置中与多孔弹性耦合相关的储存模量，因此，为了进行量纲分析，控制固结时间尺度的唯一材料参数是固有渗透率 $k$、流体动力粘度 $\\mu_{f}$ 和 Biot 模量 $M$，以及唯一的几何长度尺度 $H_{d}$。\n\n任务：\n1) 使用 Buckingham Pi 定理和上述物理设置，推导特征固结时间尺度 $t_{c}$ 作为 $k$、$\\mu_{f}$、$M$ 和 $H_{d}$ 的函数。您的推导必须从 $u$–$p$ 控制方程的量纲内容开始，不应引用任何预先组合好的固结公式。\n2) Terzaghi 的一维固结理论引入了一个无量纲时间因子 $T_{v}$，对于双面排水，在平均固结度为 $50\\%$（即 $U=0.5$）的状态下，其查表值为 $T_{v,50} = 0.197$。利用这一事实，通过要求第 (1) 部分得到的时间尺度与经典的基于 $T_{v}$ 的描述之间的一致性，将达到 $50\\%$ 固结度的时间 $t_{50}$ 表示为 $k$、$\\mu_{f}$、$M$ 和 $H_{d}$ 的函数。\n\n以秒为单位，为 $t_{50}$ 提供一个单一的闭式代数表达式作为最终答案。不需要进行数值代入，也无需四舍五入。所有符号必须如上定义；最终表达式中不要引入除 $k$、$\\mu_{f}$、$M$ 和 $H_{d}$ 之外的新的有量纲参数。", "solution": "我们从线性多孔弹性在小应变、准静态条件下的完全耦合位移-压力（$u$–$p$）公式的耦合结构开始：\n- 骨架的线性动量平衡为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b} = \\boldsymbol{0}$，其中总应力 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\prime} - \\alpha p \\boldsymbol{I}$，$\\boldsymbol{\\sigma}^{\\prime}$ 是有效应力，$\\alpha$ 是 Biot 系数。有效应力与位移的对称应变呈线性关系，例如，对于弹性张量 $\\mathbb{C}$，有 $\\boldsymbol{\\sigma}^{\\prime} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$。\n- 流体质量守恒使用流体含量 $\\zeta = \\alpha \\varepsilon_{v} + p/M$，因此在没有源项的情况下，$\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{q} = 0$，即，\n$$\n\\alpha \\dot{\\varepsilon}_{v} + \\frac{\\dot{p}}{M} + \\nabla \\cdot \\boldsymbol{q} = 0 .\n$$\n- 在各向同性多孔介质中，牛顿流体的 Darcy 定律为 $\\boldsymbol{q} = - \\dfrac{k}{\\mu_{f}} \\nabla p$，其中 $k$ 是固有渗透率，$\\mu_{f}$ 是流体动力粘度。\n\n在准静态条件下，力学平衡提供了 $p$ 与弹性场之间的瞬时关系；固结过程中的时间依赖性因此源于 $p$ 通过 Darcy 流的扩散以及通过 $M$ 和弹性耦合的储存。对于量纲分析，特征固结时间尺度的相关有量纲输入是固有渗透率 $k$、流体动力粘度 $\\mu_{f}$、储存模量 $M$ 以及与排水路径相关的特征长度 $H_{d}$。\n\n我们应用 Buckingham Pi 定理。首先，列出变量及其以质量 $M_{dim}$、长度 $L$ 和时间 $T$ 表示的量纲（使用 $M_{dim}$ 避免与Biot模量 $M$ 混淆）：\n- 目标时间尺度 $t_{c}$ 的量纲为 $[t_{c}] = T$。\n- 固有渗透率的量纲为 $[k] = L^{2}$。\n- 动力粘度的量纲为 $[\\mu_{f}] = M_{dim} L^{-1} T^{-1}$ (因为 $\\mathrm{Pa \\cdot s} = \\mathrm{N \\cdot s/m^{2}} = M_{dim} L^{-1} T^{-1}$)。\n- Biot 模量的量纲为 $[M] = \\mathrm{Pa} = M_{dim} L^{-1} T^{-2}$。\n- 几何长度的量纲为 $[H_{d}] = L$。\n\n我们寻求一个单项式组合\n$$\nt_{c} \\propto k^{a} \\, \\mu_{f}^{b} \\, M^{c} \\, H_{d}^{d}\n$$\n使得结果的量纲为 $T$。写出量纲方程：\n$$\n[k]^{a} [\\mu_{f}]^{b} [M]^{c} [H_{d}]^{d} = \\left(L^{2}\\right)^{a} \\left(M_{dim} L^{-1} T^{-1}\\right)^{b} \\left(M_{dim} L^{-1} T^{-2}\\right)^{c} \\left(L\\right)^{d} = M_{dim}^{b+c} \\, L^{2a - b - c + d} \\, T^{-b - 2c}.\n$$\n我们要求这与 $T^{1}$ 匹配，即 $M_{dim}^{0} L^{0} T^{1}$。因此，我们求解\n$$\n\\begin{cases}\nb + c = 0, \\\\\n2a - b - c + d = 0, \\\\\n-b - 2c = 1.\n\\end{cases}\n$$\n从 $b + c = 0$ 我们得到 $b = -c$。第三个方程给出 $-(-c) - 2c = 1 \\Rightarrow c - 2c = 1 \\Rightarrow -c = 1 \\Rightarrow c = -1$。因此 $b = 1$。第二个方程给出 $2a - b - c + d = 0 \\Rightarrow 2a - 1 - (-1) + d = 0 \\Rightarrow 2a + d = 0 \\Rightarrow d = -2a$。还剩下一个自由参数。我们选择 $a = -1$ 以消除时间上的负指数（这是将 $k$ 放在前因子分母中的常规选择）。那么 $d = -2(-1) = 2$。因此，一个可接受的表示形式是\n$$\nt_{c} \\sim \\frac{\\mu_{f}}{k \\, M} \\, H_{d}^{2}.\n$$\n根据 Buckingham Pi 定理，在唯一的剩余无量纲群下等价的任何其他表示形式都相差一个无量纲的乘法常数，该常数由几何形状和边界条件确定。因此我们写出\n$$\nt_{c} = C_{g} \\, \\frac{\\mu_{f}}{k \\, M} \\, H_{d}^{2},\n$$\n其中 $C_{g}$ 是一个无量纲几何因子，它取决于排水配置和为定义特征时间而选择的固结度。\n\n为了将其与 Terzaghi 的一维固结理论联系起来，回想一下 Terzaghi 引入了一个无量纲时间因子 $T_{v}$（用于线性响应和双面排水下的一维主固结），并且在平均固结度为 $50\\%$ 时，查表值为 $T_{v,50} = 0.197$。在 Terzaghi 的框架中，固结时间和排水路径仅通过无量纲群 $T_{v}$ 进入，因此与上述标度律的一致性要求\n$$\nt = \\frac{T_{v}}{c_{v}} \\, H_{d}^{2},\n$$\n其中 $c_{v}$ 是固结扩散系数，量纲分析预测其标度关系必须为\n$$\nc_{v} \\sim \\frac{k \\, M}{\\mu_{f}}.\n$$\n确定常数以匹配典型的一维解，从而固定了所选固结状态的几何因子。具体来说，对于双面排水下的 $U = 0.5$，$T_{v,50} = 0.197$，因此达到 $50\\%$ 固结度的时间为\n$$\nt_{50} = \\frac{T_{v,50} \\, H_{d}^{2}}{c_{v}} = 0.197 \\, \\frac{\\mu_{f}}{k \\, M} \\, H_{d}^{2}.\n$$\n\n该表达式显示了所要求的依赖关系：时间随流体粘度 $\\mu_{f}$ 呈线性增长，随排水路径的平方 $H_{d}^{2}$ 增长，并随固有渗透率 $k$ 和 Biot 模量 $M$ 减小。无量纲因子 $0.197$ 包含了几何形状、边界条件和所选的平均固结度。当 $\\mu_{f}$ 的单位为 $\\mathrm{Pa \\cdot s}$，$k$ 的单位为 $\\mathrm{m^{2}}$，$M$ 的单位为 $\\mathrm{Pa}$，$H_{d}$ 的单位为 $\\mathrm{m}$ 时，时间的单位为秒。", "answer": "$$\\boxed{0.197\\,\\frac{\\mu_{f}}{k\\,M}\\,H_{d}^{2}}$$", "id": "3526898"}, {"introduction": "从物理洞察转向数值实现，我们需要关注一个关键细节：对于瞬态耦合问题，不同场（如位移和压力）的初始条件不能随意设定。本练习旨在揭示并解决这一问题，你将推导并验证初始位移场和压力场之间必须满足的相容性条件。通过亲手实践，你将学会如何避免在模拟开始时出现虚假的、非物理性的瞬态响应，确保数值解的准确性。[@problem_id:3526928]", "problem": "考虑一个长度为 $L$ 的一维多孔弹性杆，其承受小应变，位移场为 $u(x,t)$，孔隙压力场为 $p(x,t)$。该杆的空间坐标为 $x \\in [0,L]$，时间为 $t \\ge 0$。该材料是线性各向同性弹性的，其 Lamé 模量为 $\\lambda$ 和 $G$，Biot 系数为 $\\alpha$，Biot 模量为 $M$。孔隙流体遵循 Darcy 定律，其固有渗透率为 $k$，动力粘度为 $\\mu$。控制方程如下，作为基本出发点：\n\n- 线性动量平衡（准静态）：$\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$。\n- 带孔隙压力耦合的线弹性应力：$\\boldsymbol{\\sigma} = 2G\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\varepsilon_v\\,\\boldsymbol{I} - \\alpha\\,p\\,\\boldsymbol{I}$。\n- 流体质量守恒：$\\dfrac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = s$，其中流体含量 $\\zeta = \\alpha\\,\\varepsilon_v + \\dfrac{p}{M}$，Darcy 通量 $\\boldsymbol{q} = -\\dfrac{k}{\\mu}\\,\\nabla p$。\n- 运动学关系：$\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top\\right)$ 且 $\\varepsilon_v = \\nabla \\cdot \\boldsymbol{u}$。\n\n在一维 $x$ 方向上，假设体力为零，且为平面应变，其中 $\\varepsilon_v = \\dfrac{\\partial u}{\\partial x}$。力学边界条件为对所有 $t$，$u(0,t) = 0$ 和 $u(L,t) = 0$。水力边界条件为无流动，即对所有 $t$，$\\dfrac{\\partial p}{\\partial x}(0,t) = 0$ 和 $\\dfrac{\\partial p}{\\partial x}(L,t) = 0$。没有体积源，因此 $s=0$。\n\n令 $p_0(x)$ 和 $u_0(x)$ 表示 $t=0$ 时的初始条件。已知如果 $p_0(x)$ 和 $u_0(x)$ 与本构方程和平衡方程不相容，早期可能会出现伪孔隙压力瞬变，这是由不一致性而非物理扩散引起的伪影。\n\n您的任务：\n\n1. 仅使用上面列出的基本陈述，推导出一个相容性准则。在给定的边界条件下，为了避免在 $t=0^+$ 时出现非物理瞬变，$p_0(x)$ 和 $u_0(x)$ 必须满足该准则。请用体积应变 $\\varepsilon_0(x) = \\dfrac{\\partial u_0}{\\partial x}$ 和空间平均值 $\\overline{p_0} = \\dfrac{1}{L}\\int_0^L p_0(x)\\,dx$ 来表示该准则。\n\n2. 基于您的推导，定义一个局部伪不匹配指标 $\\delta\\zeta(x)$，用以量化 $t=0$ 时 $(p_0,u_0)$ 的不相容性。然后定义一个单一标量度量，即 $\\delta\\zeta(x)$ 在 $x \\in [0,L]$ 上的均方根（RMS）。\n\n3. 在给定的边界条件和本构耦合下，推导 $p(x,t)$ 的简化演化方程，并实现一个短时隐式时间步进格式，以计算在一个短暂时间区间 $[0,t_{\\mathrm{end}}]$ 内的最大绝对孔隙压力变化 $\\max_x |p(x,t_{\\mathrm{end}}) - p_0(x)|$。\n\n物理单位和报告要求：\n\n- 长度单位必须是米（m），压力单位是帕斯卡（Pa），时间单位是秒（s），渗透率单位是平方米（$\\mathrm{m}^2$），粘度单位是帕斯卡-秒（Pa·s），模量单位是帕斯卡（Pa），RMS不匹配度是无量纲的。\n- 您的程序必须评估一个指定的测试套件，并为每个测试用例输出三元组 $[\\text{compatibility\\_boolean}, \\text{RMS\\_mismatch}, \\text{max\\_pressure\\_change}]$，其中布尔值为 $1$（如果相容性准则在数值容差内精确满足）或 $0$（否则），RMS不匹配度是一个浮点数（无量纲），最大压力变化是一个以 $\\mathrm{Pa}$ 为单位的浮点数。\n\n数值实现细节：\n\n- 用 $N$ 个等距节点离散化空间区间，并通过离散 Neumann 算子施加无流动边界条件。\n- 为您推导的压力扩散型演化方程使用隐式 Euler 步，时间步长为均匀的 $\\Delta t$，总步数为 $n_{\\mathrm{steps}}$，即 $t_{\\mathrm{end}} = n_{\\mathrm{steps}}\\,\\Delta t$。\n- 对于相容性布尔值，对推导出的相容应变与 $\\varepsilon_0(x)$ 之间的逐点差异使用 $10^{-10}$ 的严格数值容差。\n\n测试套件和参数：\n\n使用以下五个案例。在所有案例中，取 $L = 10\\,\\mathrm{m}$，$N = 201$，$\\mu = 10^{-3}\\,\\mathrm{Pa\\cdot s}$，$\\Delta t = 1\\,\\mathrm{s}$，以及 $n_{\\mathrm{steps}} = 5$。\n\n- 案例 1（相容的正弦对）：\n  - $\\alpha = 0.9$, $\\lambda = 7\\times 10^9\\,\\mathrm{Pa}$, $G = 5\\times 10^9\\,\\mathrm{Pa}$, $M = 10^{10}\\,\\mathrm{Pa}$, $k = 10^{-18}\\,\\mathrm{m}^2$。\n  - 定义 $\\varepsilon_0(x) = A_\\varepsilon \\sin\\left(\\dfrac{2\\pi x}{L}\\right)$，其中 $A_\\varepsilon = 2\\times 10^{-5}$，并相应地选择 $u_0(x)$ 以满足 $u(0)=u(L)=0$。\n  - 令 $\\overline{p_0} = P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$，并设置 $p_0(x)$ 以满足您使用给定的 $\\varepsilon_0(x)$ 和 $P_{\\mathrm{avg}}$ 推导出的相容性。\n\n- 案例 2（不相容的压力梯度，零初始应变）：\n  - $\\alpha$、$\\lambda$、$G$、$M$、$k$ 与案例 1 相同。\n  - $u_0(x) \\equiv 0$ 因此 $\\varepsilon_0(x) \\equiv 0$。\n  - $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$，其中 $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ 且 $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$。\n\n- 案例 3（不相容的应变，均匀初始压力）：\n  - $\\alpha$、$\\lambda$、$G$、$M$、$k$ 与案例 1 相同。\n  - $\\varepsilon_0(x) = A_\\varepsilon \\sin\\left(\\dfrac{2\\pi x}{L}\\right)$，其中 $A_\\varepsilon = 2\\times 10^{-5}$，并选择 $u_0(x)$ 以满足 $u(0)=u(L)=0$。\n  - $p_0(x) \\equiv P_{\\mathrm{avg}}$，其中 $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$。\n\n- 案例 4（边界情况：极低渗透率）：\n  - $\\alpha$、$\\lambda$、$G$、$M$ 与案例 1 相同，但 $k = 10^{-20}\\,\\mathrm{m}^2$。\n  - $u_0(x) \\equiv 0$, $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$，其中 $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ 且 $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$。\n\n- 案例 5（边界情况：骨架刚度大得多）：\n  - $\\alpha = 0.9$, $\\lambda = 8\\times 10^{10}\\,\\mathrm{Pa}$, $G = 5\\times 10^{10}\\,\\mathrm{Pa}$, $M = 10^{10}\\,\\mathrm{Pa}$, $k = 10^{-18}\\,\\mathrm{m}^2$。\n  - $u_0(x) \\equiv 0$, $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$，其中 $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ 且 $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含五个案例结果的列表，每个结果都是三元组 $[\\text{compatibility\\_boolean}, \\text{RMS\\_mismatch}, \\text{max\\_pressure\\_change}]$。整个输出必须是包含在方括号中的单个逗号分隔列表，例如 $[\\,[1,0.0,0.0],\\,[0,0.123,456.0],\\,\\dots\\,]$。RMS不匹配度是无量纲的，最大压力变化必须报告为以 $\\mathrm{Pa}$ 为单位的浮点数。", "solution": "问题陈述是有效的。它在科学上基于线性多孔弹性理论，是适定的、客观的，并为进行严格的数学和数值分析提供了全套信息。我们开始进行求解。\n\n该分析基于所提供的一维多孔弹性介质的控制方程，在准静态条件下，具有特定的边界和初始条件。\n\n**任务 1：相容性准则的推导**\n\n针对一维情况，假设体力为零（$\\boldsymbol{b}=\\boldsymbol{0}$），所提供的基本方程为：\n1.  线性动量平衡：$\\dfrac{d \\sigma_{xx}}{dx} = 0$。\n2.  线弹性应力-压力耦合：$\\sigma_{xx} = (\\lambda + 2G)\\varepsilon_v - \\alpha p$。术语 $\\lambda + 2G$ 是平面应变 P 波模量，下文表示为 $P_v$。\n3.  体积应变：$\\varepsilon_v = \\dfrac{du}{dx}$。\n\n从动量平衡方程，我们推断总应力 $\\sigma_{xx}$ 在空间上必须是常数，尽管它可能随时间变化：$\\sigma_{xx}(x,t) = C(t)$。代入本构关系，我们得到：\n$$P_v \\dfrac{du}{dx}(x,t) - \\alpha p(x,t) = C(t)$$\n这个关系式必须对所有时间 $t \\ge 0$ 和所有 $x \\in [0, L]$ 成立。为了确定函数 $C(t)$，我们在空间域 $[0, L]$ 上对该方程进行积分：\n$$\\int_0^L \\left( P_v \\dfrac{du}{dx} - \\alpha p \\right) dx = \\int_0^L C(t) dx$$\n$$P_v \\int_0^L \\dfrac{du}{dx} dx - \\alpha \\int_0^L p(x,t) dx = C(t)L$$\n力学边界条件为 $u(0,t) = 0$ 和 $u(L,t) = 0$。这意味着应变在整个域上的积分为零：\n$$\\int_0^L \\dfrac{du}{dx} dx = u(L,t) - u(0,t) = 0 - 0 = 0$$\n将此结果用于积分后的方程，得到：\n$$0 - \\alpha (L \\cdot \\overline{p}(t)) = C(t)L$$\n其中 $\\overline{p}(t) = \\frac{1}{L}\\int_0^L p(x,t) dx$ 是孔隙压力的空间平均值。我们发现 $C(t) = -\\alpha \\overline{p}(t)$。\n\n将 $C(t)$ 的表达式代回应力平衡方程，得到一个在任何时候对于相容状态都必须成立的应变和压力之间的一般关系：\n$$P_v \\dfrac{du}{dx}(x,t) = \\alpha (p(x,t) - \\overline{p}(t))$$\n对于一个初始状态 $(u_0(x), p_0(x))$，要使其在 $t=0$ 时与控制方程和边界条件相容，它必须满足这个关系。令 $\\varepsilon_0(x) = \\frac{du_0}{dx}$ 和 $\\overline{p_0} = \\frac{1}{L}\\int_0^L p_0(x)dx$，则相容性准则为：\n$$P_v \\varepsilon_0(x) = \\alpha (p_0(x) - \\overline{p_0})$$\n该准则建立了初始体积应变场与初始孔隙压力偏离其空间平均值之间的直接联系。\n\n**任务 2：伪不匹配指标和 RMS 度量**\n\n初始场 $(\\varepsilon_0(x), p_0(x))$ 之间的不相容性会导致在 $t=0^+$ 时发生非物理的瞬时调整。这可以通过检查流体含量 $\\zeta = \\alpha \\varepsilon_v + \\frac{p}{M}$ 来量化。这种不相容性代表了一种不平衡状态，数值模型将试图解决这种不平衡，表现为伪压力瞬变。\n\n我们将局部伪不匹配指标 $\\delta\\zeta(x)$ 定义为初始流体含量变化中不满足相容性推导关系的部分。它是实际初始流体含量波动与相容状态下 *应有* 的波动之间的差值。\n\n根据相容性准则，对于给定的压力场 $p_0(x)$，一个相容的应变 $\\varepsilon_{c,0}(x)$ 将是 $\\varepsilon_{c,0}(x) = \\frac{\\alpha}{P_v}(p_0(x) - \\overline{p_0})$。相应的相容流体含量是 $\\zeta_{c,0}(x) = \\alpha \\varepsilon_{c,0}(x) + \\frac{p_0(x)}{M}$。实际的初始流体含量是 $\\zeta_0(x) = \\alpha \\varepsilon_0(x) + \\frac{p_0(x)}{M}$。其差值为：\n$$\\delta\\zeta(x) = \\zeta_0(x) - \\zeta_{c,0}(x) = \\alpha(\\varepsilon_0(x) - \\varepsilon_{c,0}(x))$$\n$$\\delta\\zeta(x) = \\alpha \\varepsilon_0(x) - \\alpha \\left( \\frac{\\alpha}{P_v}(p_0(x) - \\overline{p_0}) \\right) = \\frac{\\alpha}{P_v} \\left( P_v \\varepsilon_0(x) - \\alpha(p_0(x) - \\overline{p_0}) \\right)$$\n这个指标 $\\delta\\zeta(x)$ 与相容性准则的残差成正比，并且当且仅当初始状态相容时为零。由于 $\\alpha$、$\\varepsilon_v$、$p$、$M$ 和 $P_v$ 是无量纲的或具有压力量纲，$\\zeta$ 和 $\\delta\\zeta$ 是无量纲的。\n\n总不匹配的标量度量是 $\\delta\\zeta(x)$ 在整个域上的均方根（RMS）：\n$$\\text{RMS Mismatch} = \\sqrt{\\frac{1}{L} \\int_0^L [\\delta\\zeta(x)]^2 dx}$$\n\n**任务 3：简化演化方程和数值格式**\n\n为了推导压力的演化方程，我们从流体质量守恒方程开始，源项为零（$s=0$）：\n$$\\dfrac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = 0$$\n在一维情况下，其中 $\\zeta = \\alpha \\varepsilon_v + \\frac{p}{M}$ 且 Darcy 通量为 $q_x = -\\frac{k}{\\mu}\\frac{\\partial p}{\\partial x}$，方程变为：\n$$\\dfrac{\\partial}{\\partial t}\\left(\\alpha \\varepsilon_v + \\frac{p}{M}\\right) - \\dfrac{\\partial}{\\partial x}\\left(\\frac{k}{\\mu}\\frac{\\partial p}{\\partial x}\\right) = 0$$\n我们将应变的相容性关系 $\\varepsilon_v(x,t) = \\frac{\\alpha}{P_v} (p(x,t) - \\overline{p}(t))$ 代入守恒方程：\n$$\\dfrac{\\partial}{\\partial t}\\left[\\alpha \\left(\\frac{\\alpha}{P_v}(p - \\overline{p})\\right) + \\frac{p}{M}\\right] - \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\n$$\\dfrac{\\partial}{\\partial t}\\left[\\left(\\frac{\\alpha^2}{P_v} + \\frac{1}{M}\\right)p - \\frac{\\alpha^2}{P_v}\\overline{p}\\right] - \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\n令 $1/M' = \\frac{\\alpha^2}{P_v} + \\frac{1}{M}$，其中 $M'$ 是约束排水模量。方程变为：\n$$\\frac{1}{M'}\\frac{\\partial p}{\\partial t} - \\frac{\\alpha^2}{P_v}\\frac{d\\overline{p}}{dt} - \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\n在 $[0, L]$ 上对该方程积分，并应用无流动边界条件（在 $x=0,L$ 处 $\\frac{\\partial p}{\\partial x} = 0$），可以得出 $\\frac{1}{M}\\frac{d\\overline{p}}{dt} = 0$，这意味着平均压力 $\\overline{p}(t)$ 不随时间变化，即 $\\overline{p}(t) = \\overline{p_0}$。\n因此，$\\frac{d\\overline{p}}{dt}$ 项消失，我们得到一个标准的压力扩散方程：\n$$\\frac{1}{M'}\\frac{\\partial p}{\\partial t} = \\frac{k}{\\mu}\\frac{\\partial^2 p}{\\partial x^2} \\quad \\implies \\quad \\frac{\\partial p}{\\partial t} = c \\frac{\\partial^2 p}{\\partial x^2}$$\n其中 $c = \\frac{k M'}{\\mu}$ 是水力扩散系数。\n\n该方程使用隐式 Euler 时间步进格式在一个包含 $N$ 个节点的均匀网格上进行数值求解。空间域 $x \\in [0,L]$被离散化为 $N-1$ 个大小为 $\\Delta x = L/(N-1)$ 的区间。二阶空间导数使用中心有限差分格式进行近似。无流动 Neumann 边界条件通过使用幽灵节点来实现，从而得到在每个时间步长从 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 需要求解的以下离散系统：\n$$(\\boldsymbol{I} - c \\Delta t \\boldsymbol{D}) \\boldsymbol{p}^{n+1} = \\boldsymbol{p}^{n}$$\n其中 $\\boldsymbol{p}^n$ 是时间 $t_n$ 的节点压力向量，$\\boldsymbol{I}$ 是单位矩阵，$\\boldsymbol{D}$ 是包含了边界条件的离散 Laplacian 算子矩阵。该线性系统被重复求解 $n_{\\mathrm{steps}}$ 次以得到 $\\boldsymbol{p}^{n+1}$。模拟从给定的初始压力分布 $p_0(x)$ 开始。然后计算最大绝对压力变化为 $\\max_{i} |\\boldsymbol{p}^{\\text{final}}_i - \\boldsymbol{p}^0_i|$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic compatibility and transient problem for a suite of test cases.\n    \"\"\"\n\n    def process_case(params):\n        \"\"\"\n        Processes a single test case.\n        \"\"\"\n        # Unpack parameters\n        L, N, mu, dt, n_steps = params['geom']['L'], params['geom']['N'], params['geom']['mu'], params['geom']['dt'], params['geom']['n_steps']\n        alpha, lam, G, M, k = params['material']['alpha'], params['material']['lam'], params['material']['G'], params['material']['M'], params['material']['k']\n        eps0_func, p0_func = params['initial']['eps0_func'], params['initial']['p0_func']\n\n        # 1. Setup grid and derived constants\n        Pv = lam + 2 * G\n        M_prime = 1.0 / (alpha**2 / Pv + 1.0 / M)\n        c_diff = k * M_prime / mu\n        dx = L / (N - 1)\n        x = np.linspace(0, L, N)\n\n        # 2. Define initial fields\n        eps0 = eps0_func(x=x, L=L, A_eps=params.get('A_eps', 0))\n        p0 = p0_func(x=x, L=L, Pv=Pv, alpha=alpha, P_avg=params.get('P_avg', 0), P_amp=params.get('P_amp', 0), A_eps=params.get('A_eps', 0))\n\n        # 3. Compatibility check (using tension-positive convention: Pv*eps = alpha*(p-p_bar))\n        p0_bar = np.mean(p0)\n        eps_c = (alpha / Pv) * (p0 - p0_bar)\n        is_compatible = np.all(np.abs(eps0 - eps_c)  1e-10)\n\n        # 4. RMS mismatch calculation\n        delta_zeta = alpha * eps0 - (alpha**2 / Pv) * (p0 - p0_bar)\n        rms_mismatch = np.sqrt(np.mean(delta_zeta**2))\n\n        # 5. Time evolution via implicit Euler\n        beta = c_diff * dt / dx**2\n        \n        # Assemble the system matrix A for (I - c*dt*D)p_next = p_current\n        A = np.zeros((N, N))\n        \n        # Main diagonal\n        A.flat[::N + 1] = 1 + 2 * beta\n        # Off-diagonals for interior points\n        A.flat[1::N + 1] = -beta\n        A.flat[N::N + 1] = -beta\n        \n        # Correct for Neumann boundary conditions (no-flow)\n        A[0, 1] = -2 * beta\n        A[N - 1, N - 2] = -2 * beta\n        \n        p_current = np.copy(p0)\n        for _ in range(n_steps):\n            p_next = np.linalg.solve(A, p_current)\n            p_current = p_next\n        \n        p_final = p_current\n\n        # 6. Calculate maximum pressure change\n        max_p_change = np.max(np.abs(p_final - p0))\n\n        return [int(is_compatible), rms_mismatch, max_p_change]\n\n    # Define test suite parameters\n    common_geom = {'L': 10.0, 'N': 201, 'mu': 1e-3, 'dt': 1.0, 'n_steps': 5}\n    P_avg_val = 1.0e6\n    A_eps_val = 2.0e-5\n    P_amp_val = 3.0e5\n\n    # Initial condition lambda functions (based on tension-positive convention)\n    eps0_sin = lambda x, L, A_eps, **kwargs: A_eps * np.sin(2 * np.pi * x / L)\n    eps0_zero = lambda x, **kwargs: np.zeros_like(x)\n    p0_compat = lambda x, L, Pv, alpha, P_avg, A_eps, **kwargs: P_avg + (Pv / alpha) * A_eps * np.sin(2 * np.pi * x / L)\n    p0_sin = lambda x, L, P_avg, P_amp, **kwargs: P_avg + P_amp * np.sin(2 * np.pi * x / L)\n    p0_uniform = lambda x, P_avg, **kwargs: P_avg * np.ones_like(x)\n\n    test_cases_defs = [\n        { # Case 1\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_sin, 'p0_func': p0_compat},\n            'P_avg': P_avg_val, 'A_eps': A_eps_val\n        },\n        { # Case 2\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        },\n        { # Case 3\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_sin, 'p0_func': p0_uniform},\n            'P_avg': P_avg_val, 'A_eps': A_eps_val\n        },\n        { # Case 4\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-20},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        },\n        { # Case 5\n            'material': {'alpha': 0.9, 'lam': 8e10, 'G': 5e10, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        }\n    ]\n\n    results = []\n    for case_def in test_cases_defs:\n        # Add common geometry to each case definition\n        case_def['geom'] = common_geom\n        # Run the simulation for the case\n        result = process_case(case_def)\n        results.append(result)\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3526928"}, {"introduction": "在掌握了如何建立一个自洽的初始状态后，下一步是探索如何随时间求解这个耦合方程组。本练习将对比两种主流的求解策略：整体法（Monolithic）和交错法（Staggered）。通过在一个具有挑战性的快速注入场景中比较它们的性能，你将量化它们在精度（如压力超调）和鲁棒性上的关键差异，为在实际应用中选择合适的求解器提供依据。[@problem_id:3526900]", "problem": "考虑一个长度为 $L$ 的一维饱和多孔杆，其左边界 $x=0$ 处受到快速流体注入，右边界 $x=L$ 处为排水边界。该杆使用完全耦合的位移-压力（记为 $u$–$p$）格式进行建模，该格式基于准静态 Biot 孔隙弹性理论。目标是比较快速注入条件下交错和整体 $u$–$p$ 格式；量化压力超调、位移误差范数 $\\|u\\|$ 以及在不同渗透率反差下的鲁棒性。\n\n基本理论和建模假设：\n- 准静态条件下的线性动量守恒：$\\dfrac{\\partial \\sigma}{\\partial x} = 0$。\n- 总应力的线性孔隙弹性本构关系：$\\sigma = K_s \\dfrac{\\partial u}{\\partial x} - \\alpha p$，其中 $K_s$ 是骨架的排水刚度，$\\alpha$ 是 Biot 系数，$u$ 是位移，$p$ 是孔隙压力。\n- 流体质量守恒：$\\alpha \\dfrac{\\partial \\varepsilon}{\\partial t} + S \\dfrac{\\partial p}{\\partial t} - \\dfrac{\\partial}{\\partial x}\\!\\left( \\dfrac{k(x)}{\\mu} \\dfrac{\\partial p}{\\partial x} \\right) = 0$，其中 $\\varepsilon = \\dfrac{\\partial u}{\\partial x}$ 是一维体积应变，$S$ 是储水系数，$k(x)$ 是空间变化的固有渗透率，$\\mu$ 是动力粘度。\n- 流体通量的 Darcy 定律：$q(x,t) = -\\dfrac{k(x)}{\\mu} \\dfrac{\\partial p}{\\partial x}$。\n- 力学边界条件：$u(0,t)=0$（左端固定）和 $\\sigma(L,t)=0$（右端无牵引）。\n- 水力边界条件：在 $x=0$ 处给定注入通量等于 $q_0$（在 $t=0$ 时刻阶跃后为常数）以及排水边界 $p(L,t)=0$。\n\n在这些假设下，空间上均匀的无牵引状态意味着 $\\sigma(x,t) \\equiv 0$，这使得 $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p$。对于 $p(L)=0$ 和恒定通量 $q_0$ 的情况，精确的稳态压力分布满足 $k(x) \\dfrac{\\partial p}{\\partial x} = - \\mu q_0$，从而得到 $p(x) = \\mu q_0 \\int_x^L \\dfrac{1}{k(s)} \\, ds$。此稳态参考用于定义压力超调。\n\n您必须实现并比较以下两种时间积分格式：\n- 整体格式：一种完全耦合的隐式更新，它将耦合项一致地包含在瞬态质量平衡中。在 $\\sigma \\equiv 0$ 条件下，有效储水系数变为 $S_{\\text{eff}} = S + \\dfrac{\\alpha^2}{K_s}$，并且一个隐式步长使用 $S_{\\text{eff}}$ 来推进 $p$。\n- 交错格式：一种顺序更新，它仅使用 $S$ 来推进 $p$（即，在瞬态项中滞后了力学耦合），然后根据新的 $p$ 通过 $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p$ 更新 $u$。\n\n离散化要求：\n- 将杆离散化为 $N$ 个大小为 $\\Delta x = L/N$ 的均匀单元，渗透率 $k(x)$ 在每个单元内为分段常数。对 $-\\dfrac{\\partial}{\\partial x}\\!\\left( \\dfrac{k(x)}{\\mu} \\dfrac{\\partial p}{\\partial x} \\right)$ 使用保守的空间离散化方法，该方法与跨单元界面的可变 $k(x)$ 相容。时间上使用后向欧拉法，时间步长为 $\\Delta t$。\n- 将 $x=0$ 处的注入通量作为 Neumann 边界条件强制执行，为最左侧的控制体积提供一个恒定的流入量 $q_0$。在 $x=L$ 处通过 $p(L,t)=0$ 强制执行排水边界。\n- 计算出 $p^{n+1}$ 后，通过从 $u(0)=0$ 开始积分 $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p^{n+1}$ 来获得 $u^{n+1}$。\n\n每个测试案例需要计算的指标：\n1. 压力超调量，单位为帕斯卡（Pa）：$p(x,t) - p_{\\text{steady}}(x)$ 在空间和时间上的最大正值，其中 $p_{\\text{steady}}(x) = \\mu q_0 \\int_x^L \\dfrac{1}{k(s)} \\, ds$。\n2. 位移误差范数 $\\|u\\|$，单位为米（m）：最终时刻交错格式和整体格式位移之差的 $L^2$ 范数，作为在杆上的空间积分范数计算。\n3. 每种格式的鲁棒性指标（布尔值）：将鲁棒性定义为相对于稳态尺度没有过大的超调；具体来说，如果 $\\dfrac{\\text{overshoot}}{\\max_x p_{\\text{steady}}(x)} \\le 0.1$ 且所有计算场都保持有限，则该格式是鲁棒的。\n\n物理单位：\n- 压力必须以帕斯卡（Pa）表示。\n- 位移必须以米（m）表示。\n- 时间必须以秒（s）表示。\n- 渗透率以平方米（$\\text{m}^2$）表示。\n- 动力粘度以帕斯卡-秒（Pa·s）表示。\n- 注入通量以米/秒（m/s）表示。\n\n测试套件和参数：\n使用以下三个案例来探究不同的渗透率反差。除非另有说明，所有其他参数在各案例中均相同。\n\n- 通用参数：$L=10\\,\\text{m}$, $N=100$, $\\Delta t=2.5\\,\\text{s}$, 步数 $N_t=400$ (最终时间 $T=1000\\,\\text{s}$), $q_0=1\\times 10^{-7}\\,\\text{m/s}$, $\\mu=1\\times 10^{-3}\\,\\text{Pa·s}$, $S=1\\times 10^{-9}\\,\\text{Pa}^{-1}$, $\\alpha=0.9$, $K_s=5\\times 10^{8}\\,\\text{Pa}$。\n\n- 案例 A（均匀，中等渗透率）：$k(x) \\equiv 1\\times 10^{-14}\\,\\text{m}^2$。\n- 案例 B（两层反差）：$x \\in [0,L/2)$ 时 $k(x)=1\\times 10^{-12}\\,\\text{m}^2$，$x \\in [L/2,L]$ 时 $k(x)=1\\times 10^{-16}\\,\\text{m}^2$。\n- 案例 C（均匀，极低渗透率）：$k(x) \\equiv 1\\times 10^{-18}\\,\\text{m}^2$。\n\n最终输出格式：\n您的程序应生成单行输出，包含三个测试案例的结果列表。每个测试案例的结果是一个包含五个条目的列表，顺序如下：\n- 交错格式的压力超调（Pa）（浮点数）。\n- 整体格式的压力超调（Pa）（浮点数）。\n- 最终时刻的位移 $L^2$ 误差范数（m）（浮点数）。\n- 交错格式的鲁棒性（布尔值）。\n- 整体格式的鲁棒性（布尔值）。\n\n例如，输出应如下所示：\n[[overshoot_staggered_caseA,overshoot_monolithic_caseA,u_error_caseA,robust_staggered_caseA,robust_monolithic_caseA],[...caseB...],[...caseC...]]", "solution": "用户提供的问题是计算地质力学中一个定义明确的练习，要求实现并比较一个一维孔隙弹性问题的两种数值格式。该问题科学上基于准静态 Biot 理论，在数学上是一致的，并提供了所有必要的参数、方程和边界条件。因此，该问题被判定为有效。\n\n求解过程如下：\n\n首先，我们建立孔隙压力 $p$ 的控制偏微分方程（PDE）。问题陈述了准静态动量平衡 $\\frac{\\partial \\sigma}{\\partial x} = 0$，其中总应力为 $\\sigma = K_s \\frac{\\partial u}{\\partial x} - \\alpha p$。边界条件 $\\sigma(L,t) = 0$ 意味着总应力在整个域内恒等于零，即 $\\sigma(x,t) \\equiv 0$。这简化了本构关系为 $K_s \\frac{\\partial u}{\\partial x} = \\alpha p$，这意味着应变 $\\varepsilon = \\frac{\\partial u}{\\partial x}$ 与压力成正比，$\\varepsilon = \\frac{\\alpha}{K_s} p$。\n\n将此关系代入流体质量守恒方程 $\\alpha \\frac{\\partial \\varepsilon}{\\partial t} + S \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{k(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0$，得到：\n$$\n\\alpha \\frac{\\partial}{\\partial t}\\left(\\frac{\\alpha p}{K_s}\\right) + S \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{k(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0\n$$\n$$\n\\left(S + \\frac{\\alpha^2}{K_s}\\right) \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{k(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0\n$$\n这是一个关于压力 $p(x,t)$ 的抛物型扩散方程。项 $C = S + \\frac{\\alpha^2}{K_s}$ 是有效储水系数 $S_{\\text{eff}}$，它在简化的应力条件下同时考虑了流体和固体骨架的可压缩性。整体格式使用这个完整的系数 $C = S_{\\text{eff}}$。根据定义，交错格式滞后了力学耦合项，这意味着它在时间导数项中仅使用流体储水系数 $C = S$。\n\n接下来，我们对该偏微分方程进行离散化。我们使用单元中心的有限体积法，在一个包含 $N$ 个单元的均匀网格上进行，每个单元的大小为 $\\Delta x = L/N$。压力 $p_i$ 位于单元 $i$ 的中心。我们采用后向欧拉法进行时间积分，时间步长为 $\\Delta t$。\n\n在时间步 $n+1$，内部单元 $i$（对于 $i=1, \\dots, N-2$）的离散方程为：\n$$\nC \\Delta x \\frac{p_i^{n+1} - p_i^n}{\\Delta t} + q_{i+1/2} - q_{i-1/2} = 0\n$$\n其中 $p_i^n = p(x_i, t^n)$。单元间的通量 $q$ 使用两点通量近似法进行估算，并对单元间的导水系数使用调和平均，以处理分段常数的渗透率 $k(x)$。单元 $i$ 和单元 $i+1$ 之间的通量为：\n$$\nq_{i+1/2} = -D_{i+1/2} \\frac{p_{i+1}^{n+1} - p_i^{n+1}}{\\Delta x}, \\quad \\text{其中 } D_{i+1/2} = \\frac{2 (k_i/\\mu)(k_{i+1}/\\mu)}{(k_i/\\mu)+(k_{i+1}/\\mu)}\n$$\n边界条件按如下方式引入：\n1.  在左边界（$x=0$），给定恒定的注入通量 $q_0$。这成为单元 $0$ 的源项：$q_{-1/2} = q_0$。\n2.  在右边界（$x=L$），施加排水条件 $p(L,t)=0$。这将最右侧节点的压力设为零，并影响最后一个单元 $N-1$ 的通量计算。流出通量近似为 $q_{N-1/2} \\approx -\\frac{k_{N-1}}{\\mu} \\frac{p(L,t) - p_{N-1}^{n+1}}{\\Delta x / 2} = \\frac{2 k_{N-1}}{\\mu \\Delta x} p_{N-1}^{n+1}$。\n\n这些离散方程在每个时间步形成一个关于未知压力向量 $p^{n+1}$ 的三对角线性方程组：$A p^{n+1} = b$。矩阵 $A$ 取决于几何、材料属性和储水系数 $C$，而向量 $b$ 包含前一时间步的压力 $p^n$ 和边界源项 $q_0$。该系统可以使用三对角求解器高效求解，具体为 `scipy.linalg.solve_banded`。\n\n模拟通过从 $t=0$ 到最终时间 $T = N_t \\Delta t$ 迭代求解整体格式（$C=S_{\\text{eff}}$）和交错格式（$C=S$）的 $p^{n+1}$ 来进行。\n\n时间步循环结束后，计算所需的指标：\n1.  **压力超调**：在模拟过程中，我们跟踪所有单元 $i$ 和时间步 $n$ 上 $p(x_i, t^n) - p_{\\text{steady}}(x_i)$ 的最大值。稳态压力分布 $p_{\\text{steady}}(x)$ 通过积分稳态关系 $\\frac{dp}{dx} = -\\frac{\\mu q_0}{k(x)}$ 并结合边界条件 $p(L)=0$ 来预先计算。\n2.  **位移误差范数**：两种格式的最终位移 $u_{\\text{staggered}}$ 和 $u_{\\text{monolithic}}$，通过使用最终压力场和条件 $u(0)=0$ 对关系 $\\frac{\\partial u}{\\partial x} = \\frac{\\alpha}{K_s} p$ 进行空间积分来计算。然后，使用梯形法则在节点位移差上计算差值的 $L^2$ 范数 $\\|u_{\\text{staggered}} - u_{\\text{monolithic}}\\|$。\n3.  **鲁棒性**：对于每种格式，鲁棒性由两个条件确定：最大压力超调是否小于或等于最大稳态压力的 $10\\%$，以及解是否保持数值稳定（即没有产生 `NaN` 或 `inf` 值）。\n\n此过程应用于三个测试案例中的每一个，这些案例探究了不同渗透率反差下格式的行为。然后，将所有案例收集到的指标格式化为所需的最终输出字符串。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n    # Common parameters for all test cases\n    common_params = {\n        'L': 10.0,              # m\n        'N': 100,               # number of cells\n        'dt': 2.5,              # s\n        'Nt': 400,              # number of time steps\n        'q0': 1.0e-7,           # m/s\n        'mu': 1.0e-3,           # Pa.s\n        'S': 1.0e-9,            # Pa^-1\n        'alpha': 0.9,\n        'Ks': 5.0e8             # Pa\n    }\n\n    # Definition of the three test cases with varying permeability\n    test_cases = [\n        {'case_id': 'A', 'k_profile': 'uniform', 'k_values': [1.0e-14]},\n        {'case_id': 'B', 'k_profile': 'layered', 'k_values': [1.0e-12, 1.0e-16]},\n        {'case_id': 'C', 'k_profile': 'uniform', 'k_values': [1.0e-18]},\n    ]\n    \n    final_results = []\n\n    for case in test_cases:\n        # Merge common and case-specific parameters\n        params = {**common_params, **case}\n        \n        # Setup grid and material properties\n        N = params['N']\n        L = params['L']\n        dx = L / N\n        x_nodes = np.linspace(0, L, N + 1)\n        x_centers = x_nodes[:-1] + dx / 2\n\n        k_vals = np.zeros(N)\n        if params['k_profile'] == 'uniform':\n            k_vals[:] = params['k_values'][0]\n        elif params['k_profile'] == 'layered':\n            k_high, k_low = params['k_values']\n            k_vals[x_centers  L / 2] = k_high\n            k_vals[x_centers >= L / 2] = k_low\n\n        # Calculate steady-state pressure profile\n        p_steady_nodes = np.zeros(N + 1)\n        # Integrate from right (p(L)=0) to left\n        for j in range(N - 1, -1, -1):\n            p_steady_nodes[j] = p_steady_nodes[j + 1] + params['q0'] * params['mu'] * dx / k_vals[j]\n        \n        # Cell-centered steady pressure for comparison with computed values\n        p_steady_cell = (p_steady_nodes[:-1] + p_steady_nodes[1:]) / 2\n        max_p_steady = p_steady_nodes[0]\n        if max_p_steady == 0:  # Avoid division by zero\n             max_p_steady = 1.0\n\n        # Define effective storage coefficients for each scheme\n        C_mono = params['S'] + params['alpha']**2 / params['Ks']\n        C_stag = params['S']\n\n        results_per_scheme = {}\n        for scheme_name, C_eff in [('staggered', C_stag), ('monolithic', C_mono)]:\n            \n            # Assemble the tridiagonal matrix (constant in time)\n            beta = k_vals / params['mu']\n            # Harmonic mean for interface hydraulic conductivity\n            beta_interface = np.zeros(N-1)\n            if N > 1:\n                beta_interface = 2 * beta[:-1] * beta[1:] / (beta[:-1] + beta[1:])\n            \n            # Matrix in banded format for scipy.linalg.solve_banded\n            # ab[0,:] = super-diagonal, ab[1,:] = main-diagonal, ab[2,:] = sub-diagonal\n            ab = np.zeros((3, N))\n            gamma = C_eff * dx / params['dt']\n\n            # Super-diagonal (u)\n            if N > 1:\n                ab[0, 1:] = -beta_interface / dx\n            # Sub-diagonal (l)\n            if N > 1:\n                ab[2, :-1] = -beta_interface / dx\n            # Main diagonal (d)\n            if N > 1:\n                ab[1, 0] = gamma + beta_interface[0] / dx\n                ab[1, 1:-1] = gamma + (beta_interface[:-1] + beta_interface[1:]) / dx\n                ab[1, -1] = gamma + beta_interface[-1] / dx + 2 * beta[-1] / dx\n            else: # N=1 case\n                ab[1, 0] = gamma + 2 * beta[0] / dx\n            \n            # Time stepping loop\n            p = np.zeros(N) # Initial condition p(x,0)=0\n            max_overshoot = 0.0\n            is_finite = True\n            \n            for _ in range(params['Nt']):\n                # Construct Right-Hand-Side vector\n                b = gamma * p\n                b[0] += params['q0']\n                \n                p_new = solve_banded((1, 1), ab, b)\n                \n                if not np.all(np.isfinite(p_new)):\n                    is_finite = False\n                    break\n                \n                p = p_new\n                \n                # Update max overshoot (max positive value of p - p_steady)\n                current_overshoot = np.max(p - p_steady_cell)\n                if current_overshoot > max_overshoot:\n                    max_overshoot = current_overshoot\n            \n            results_per_scheme[scheme_name] = {\n                'p_final': p,\n                'max_overshoot': max(0.0, max_overshoot), # Ensure non-negative\n                'is_finite': is_finite\n            }\n\n        # Compute Final Metrics\n        overshoot_stag = results_per_scheme['staggered']['max_overshoot']\n        overshoot_mono = results_per_scheme['monolithic']['max_overshoot']\n\n        p_final_stag = results_per_scheme['staggered']['p_final']\n        p_final_mono = results_per_scheme['monolithic']['p_final']\n        \n        u_stag = np.zeros(N + 1)\n        u_mono = np.zeros(N + 1)\n        \n        const = dx * params['alpha'] / params['Ks']\n        for j in range(N):\n            u_stag[j+1] = u_stag[j] + const * p_final_stag[j]\n            u_mono[j+1] = u_mono[j] + const * p_final_mono[j]\n            \n        u_diff_sq = (u_stag - u_mono)**2\n        # Compute L2 norm of displacement difference using trapezoidal rule\n        u_error_norm = np.sqrt(np.trapz(u_diff_sq, x=x_nodes))\n        \n        robust_stag = (overshoot_stag / max_p_steady = 0.1) and results_per_scheme['staggered']['is_finite']\n        robust_mono = (overshoot_mono / max_p_steady = 0.1) and results_per_scheme['monolithic']['is_finite']\n\n        final_results.append([\n            overshoot_stag,\n            overshoot_mono,\n            u_error_norm,\n            robust_stag,\n            robust_mono\n        ])\n\n    # Format the results into the required single-line string\n    formatted_results = []\n    for res_list in final_results:\n        str_list = [f\"{v:.6e}\" if isinstance(v, float) else str(v).lower() for v in res_list]\n        formatted_results.append(f\"[{','.join(str_list)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3526900"}]}