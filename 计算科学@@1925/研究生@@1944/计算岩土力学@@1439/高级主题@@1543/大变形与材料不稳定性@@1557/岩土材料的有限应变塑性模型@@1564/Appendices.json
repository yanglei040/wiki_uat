{"hands_on_practices": [{"introduction": "在应用任何塑性模型之前，我们必须首先准确地描述材料的应力状态。这通常通过应力不变量来完成，它们是独立于坐标系的度量。本练习将重点关注岩土力学中三个关键的应力不变量：平均应力 $p$、偏应力 $q$ 和洛德角 $\\theta$。通过从一个给定的柯西应力张量计算这些值，您将深入理解它们各自的物理意义——静水压力、剪切强度和应力路径类型——这是进行任何塑性分析的基础。[@problem_id:3525005]", "problem": "考虑一个正在经历有限变形的均质地质材料，其应力量度为柯西应力张量。假设压应力为正，且柯西应力张量是对称的。给定当前构型下的柯西应力张量\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80  20  0 \\\\\n20  80  0 \\\\\n0  0  60\n\\end{pmatrix}\n\\ \\text{MPa}.\n$$\n使用计算岩土力学中柯西应力的标准应力不变量，计算平均应力 $p$、偏应力量度 $q$ 以及与偏应力相关的洛德角 $\\theta$。然后将加载路径分类为三轴压缩、三轴拉伸或纯剪切。对于该分类，请根据以下约定报告一个数值代码 $C$：三轴压缩为 $C=+1$，三轴拉伸为 $C=-1$，纯剪切为 $C=0$。\n\n以 $\\text{MPa}$ 为单位表示 $p$ 和 $q$，以弧度为单位表示 $\\theta$。无需四舍五入；如果自然得出精确值，请提供精确值。请将您的最终答案表示为一个单行矩阵，按顺序包含 $p$、$q$、$\\theta$ 和 $C$。", "solution": "柯西应力张量 $\\boldsymbol{\\sigma}$ 是对称且实值的，因此它存在一组标准正交的特征向量和实数特征值，这些特征值即为主应力。对于一个形如下式的对称分块矩阵\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80  20  0 \\\\\n20  80  0 \\\\\n0  0  60\n\\end{pmatrix},\n$$\n左上方的 $2\\times 2$ 子块的特征值可以通过求解下式得到\n$$\n\\det\\!\\left(\\begin{pmatrix}80  20 \\\\ 20  80\\end{pmatrix} - \\lambda \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}\\right) = 0,\n$$\n可得 $(80-\\lambda)^2 - 20^2 = 0$，因此 $\\lambda = 100$ 和 $\\lambda = 60$。解耦的 $(3,3)$ 分量是 $60$。因此，主应力为\n$$\n\\sigma_{1} = 100,\\quad \\sigma_{2} = 60,\\quad \\sigma_{3} = 60\n$$\n单位为 $\\text{MPa}$，按 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\sigma_{3}$ 排序。\n\n平均应力 $p$ 定义为 $\\boldsymbol{\\sigma}$ 的第一不变量的三分之一，\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{\\sigma_{1} + \\sigma_{2} + \\sigma_{3}}{3} = \\frac{100 + 60 + 60}{3} = \\frac{220}{3}.\n$$\n\n为了得到偏应力量度 $q$，我们首先构建偏应力张量 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$，其主分量为\n$$\ns_{1} = \\sigma_{1} - p = 100 - \\frac{220}{3} = \\frac{80}{3},\\quad\ns_{2} = \\sigma_{2} - p = 60 - \\frac{220}{3} = -\\frac{40}{3},\\quad\ns_{3} = \\sigma_{3} - p = 60 - \\frac{220}{3} = -\\frac{40}{3}.\n$$\n这些分量按要求满足 $s_{1} + s_{2} + s_{3} = 0$。$\\boldsymbol{s}$ 的第二不变量是\n$$\nJ_{2} = \\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{2}\\left(s_{1}^{2} + s_{2}^{2} + s_{3}^{2}\\right) = \\frac{1}{2}\\left(\\left(\\frac{80}{3}\\right)^{2} + 2\\left(\\frac{40}{3}\\right)^{2}\\right) = \\frac{1600}{3}.\n$$\n则偏应力量度 $q$ 为\n$$\nq = \\sqrt{3\\,J_{2}} = \\sqrt{3 \\cdot \\frac{1600}{3}} = \\sqrt{1600} = 40.\n$$\n\n洛德角 $\\theta$ 表征了在偏平面上的位置。根据本文中定义的洛德角：\n$$\n\\cos(3\\theta) = \\frac{3\\sqrt{3}}{2}\\frac{J_3}{J_2^{3/2}}\n$$\n其中 $J_3$ 是 $\\boldsymbol{s}$ 的第三不变量，\n$$\nJ_{3} = \\det(\\boldsymbol{s}) = s_{1}\\,s_{2}\\,s_{3} = \\left(\\frac{80}{3}\\right)\\left(-\\frac{40}{3}\\right)\\left(-\\frac{40}{3}\\right) = \\frac{128000}{27}.\n$$\n计算 $J_2^{3/2}$：\n$$\nJ_2^{1/2} = \\sqrt{\\frac{1600}{3}} = \\frac{40}{\\sqrt{3}},\\quad\nJ_2^{3/2} = J_2 J_2^{1/2} = \\frac{1600}{3}\\cdot \\frac{40}{\\sqrt{3}} = \\frac{64000}{3\\sqrt{3}}.\n$$\n因此，\n$$\n\\cos(3\\theta) = \\frac{3\\sqrt{3}}{2}\\,\\frac{\\frac{128000}{27}}{\\frac{64000}{3\\sqrt{3}}}\n= \\frac{3\\sqrt{3}}{2}\\cdot \\frac{128000}{27}\\cdot \\frac{3\\sqrt{3}}{64000}\n= \\frac{9}{2}\\cdot \\frac{2}{27} \\cdot \\frac{27}{9} = 1.\n$$\n由此可得 $3\\theta = 0$，所以 $\\theta = 0$。\n\n分类可根据洛德角得出：$\\theta = 0$ 对应于轴对称压缩（三轴压缩）状态，因为两个较小的主应力相等（$\\sigma_{2} = \\sigma_{3}$），且洛德角达到了其范围的下限。因此，分类代码为 $C = +1$。\n\n按要求的顺序和单位收集结果，我们得到 $p = \\frac{220}{3}\\ \\text{MPa}$，$q = 40\\ \\text{MPa}$，$\\theta = 0\\ \\text{rad}$，以及 $C = +1$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{220}{3}  40  0  1\\end{pmatrix}}$$", "id": "3525005"}, {"introduction": "知道了应力状态后，下一步是判断材料是否屈服，如果屈服，它将如何塑性变形。这一过程由塑性理论的基本原则——库恩-塔克（Kuhn–Tucker）条件——所支配。这个练习 [@problem_id:3524975] 提供了一个具体的场景，让您能够亲手验证加载和卸载情况下的这些条件，并计算力学耗散。理解耗散对于掌握不可逆过程的热力学至关重要，也是塑性流动的核心。", "problem": "一个颗粒状地质材料在有限应变下通过变形梯度的乘法分解进行建模，$\\mathbf{F} = \\mathbf{F}^{e}\\mathbf{F}^{p}$，其中 $\\mathbf{F}^{e}$ 是弹性部分，$\\mathbf{F}^{p}$ 是塑性部分。采用功共轭的应力和应变率度量，使得机械耗散率为 $D = \\boldsymbol{\\tau} : \\mathbf{d}^{p}$，其中 $\\boldsymbol{\\tau}$ 是 Kirchhoff 应力，$\\mathbf{d}^{p}$ 是塑性变形率张量。该材料遵循一个率无关的非关联 Drucker–Prager 型模型，其屈服函数为 $f(\\boldsymbol{\\tau}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})} - k \\le 0$，塑性势函数为 $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$。此处，$I_{1}(\\boldsymbol{\\tau}) = \\operatorname{tr}(\\boldsymbol{\\tau})$，$J_{2}(\\boldsymbol{\\tau}) = \\tfrac{1}{2}\\,\\mathbf{s}:\\mathbf{s}$，其中 $\\mathbf{s} = \\boldsymbol{\\tau} - \\tfrac{1}{3}I_{1}(\\boldsymbol{\\tau})\\,\\mathbf{I}$ 是偏 Kirchhoff 应力，$\\mathbf{I}$ 是二阶单位张量。正交流动法则为 $\\mathbf{d}^{p} = \\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\tau}}$，其中 $\\dot{\\lambda}$ 是塑性乘子。Kuhn–Tucker 条件为 $\\dot{\\lambda} \\ge 0$，$f \\le 0$ 和 $\\dot{\\lambda}\\,f = 0$。\n\n考虑单个时间增量内的两个瞬时应力状态：\n- 状态 A (卸载候选状态)：$\\boldsymbol{\\tau}^{A} = \\operatorname{diag}(50,\\,50,\\,50)\\,\\text{MPa}$，材料参数为 $\\alpha = 0.1$, $\\alpha_{g} = 0.08$ 和 $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$。设 $\\dot{\\lambda}^{A} = 0$。\n- 状态 B (加载候选状态)：$\\boldsymbol{\\tau}^{B} = \\operatorname{diag}(90,\\,60,\\,60)\\,\\text{MPa}$，材料参数与状态 A 相同，为 $\\alpha = 0.1$, $\\alpha_{g} = 0.08$ 和 $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$。塑性乘子为 $\\dot{\\lambda}^{B} = 0.015\\,\\text{s}^{-1}$。从状态 A到状态 B 的应力增量为 $\\Delta\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{B} - \\boldsymbol{\\tau}^{A}$。\n\n任务：\n1. 仅使用所提供的定义，计算状态 B 的机械耗散率 $D^{B} = \\boldsymbol{\\tau}^{B} : \\mathbf{d}^{p,B}$。\n2. 对状态 A 和状态 B 验证 Kuhn–Tucker 条件 $\\dot{\\lambda} \\ge 0$，$f \\le 0$ 和 $\\dot{\\lambda}\\,f = 0$。\n3. 基于您的验证，说明状态 A 是否对应卸载，状态 B 是否对应加载，并通过确认状态 A 严格位于屈服面内部而状态 B 位于屈服面上来检查一致性。\n\n以千瓦每立方米 ($\\text{kW/m}^{3}$) 为单位表示最终耗散率 $D^{B}$，并将您的答案四舍五入至四位有效数字。最终答案必须是单个实数值。", "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于连续介质力学和计算塑性力学的原理，是适定的，提供了所有必要的信息，并以客观、正式的语言表述。不存在矛盾、歧义或不切实际的条件。因此，我们可以进行完整解答。\n\n解答需要在非关联 Drucker–Prager 塑性模型的框架内分析状态 A 和状态 B 这两个应力状态。我们将首先验证每个状态的 Kuhn–Tucker 条件，以确定它们是对应弹性行为还是塑性行为（任务2和3），然后计算塑性状态下的机械耗散（任务1）。\n\n屈服函数由 $f(\\boldsymbol{\\tau}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})} - k$ 给出，塑性势函数是 $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$。率无关塑性的 Kuhn–Tucker 条件是：\n1.  塑性乘子非负性： $\\dot{\\lambda} \\ge 0$\n2.  屈服条件： $f \\le 0$\n3.  一致性条件： $\\dot{\\lambda}\\,f = 0$\n\n材料参数给定为 $\\alpha = 0.1$，$\\alpha_{g} = 0.08$ 和 $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$。\n\n**状态 A (卸载候选状态) 的验证**\n\n对于状态 A，Kirchhoff 应力张量为 $\\boldsymbol{\\tau}^{A} = \\operatorname{diag}(50,\\,50,\\,50)\\,\\text{MPa}$。塑性乘子给定为 $\\dot{\\lambda}^{A} = 0$。\n\n1.  **检查 Kuhn–Tucker 条件：**\n    -   条件 $\\dot{\\lambda}^{A} \\ge 0$ 满足，因为 $\\dot{\\lambda}^{A} = 0$。\n    -   一致性条件 $\\dot{\\lambda}^{A}\\,f(\\boldsymbol{\\tau}^{A}) = 0$ 满足，因为 $0 \\cdot f(\\boldsymbol{\\tau}^{A}) = 0$。\n    -   我们必须验证屈服条件 $f(\\boldsymbol{\\tau}^{A}) \\le 0$。为此，我们计算 $\\boldsymbol{\\tau}^{A}$ 的应力不变量。\n        -   应力第一不变量是 $I_{1}(\\boldsymbol{\\tau}^{A}) = \\operatorname{tr}(\\boldsymbol{\\tau}^{A}) = 50 + 50 + 50 = 150\\,\\text{MPa}$。\n        -   平均应力是 $p^{A} = \\frac{1}{3}I_{1}(\\boldsymbol{\\tau}^{A}) = \\frac{150}{3} = 50\\,\\text{MPa}$。\n        -   偏应力张量是 $\\mathbf{s}^{A} = \\boldsymbol{\\tau}^{A} - p^{A}\\mathbf{I} = \\operatorname{diag}(50, 50, 50) - 50\\,\\operatorname{diag}(1, 1, 1) = \\mathbf{0}$。\n        -   偏应力第二不变量是 $J_{2}(\\boldsymbol{\\tau}^{A}) = \\frac{1}{2}\\mathbf{s}^{A}:\\mathbf{s}^{A} = 0$。\n        -   现在我们计算屈服函数的值：\n            $$f(\\boldsymbol{\\tau}^{A}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}^{A}) + \\sqrt{J_{2}(\\boldsymbol{\\tau}^{A})} - k$$\n            $$f(\\boldsymbol{\\tau}^{A}) = 0.1 \\cdot (150) + \\sqrt{0} - (21 + 10\\sqrt{3}) = 15 - 21 - 10\\sqrt{3} = -6 - 10\\sqrt{3}\\,\\text{MPa}$$\n    -   由于 $\\sqrt{3} > 0$， $f(\\boldsymbol{\\tau}^{A}) = -6 - 10\\sqrt{3}$ 是严格为负的。因此，条件 $f(\\boldsymbol{\\tau}^{A}) \\le 0$ 得到满足。\n\n2.  **状态 A 的结论：**\n    所有 Kuhn–Tucker 条件均得到满足。由于 $f(\\boldsymbol{\\tau}^{A})  0$ 且 $\\dot{\\lambda}^{A} = 0$，状态 A 代表一个弹性状态，其应力点严格位于屈服面内部。这与“卸载候选状态”的描述一致。\n\n**状态 B (加载候选状态) 的验证**\n\n对于状态 B，Kirchhoff 应力张量为 $\\boldsymbol{\\tau}^{B} = \\operatorname{diag}(90,\\,60,\\,60)\\,\\text{MPa}$。塑性乘子给定为 $\\dot{\\lambda}^{B} = 0.015\\,\\text{s}^{-1}$。\n\n1.  **检查 Kuhn–Tucker 条件：**\n    -   条件 $\\dot{\\lambda}^{B} \\ge 0$ 满足，因为 $\\dot{\\lambda}^{B} = 0.015 > 0$。\n    -   为了在 $\\dot{\\lambda}^{B} > 0$ 的情况下使一致性条件 $\\dot{\\lambda}^{B}\\,f(\\boldsymbol{\\tau}^{B}) = 0$ 成立，必须有 $f(\\boldsymbol{\\tau}^{B}) = 0$。这也将满足屈服条件 $f(\\boldsymbol{\\tau}^{B}) \\le 0$。让我们来验证这一点。\n        -   应力第一不变量是 $I_{1}(\\boldsymbol{\\tau}^{B}) = \\operatorname{tr}(\\boldsymbol{\\tau}^{B}) = 90 + 60 + 60 = 210\\,\\text{MPa}$。\n        -   平均应力是 $p^{B} = \\frac{1}{3}I_{1}(\\boldsymbol{\\tau}^{B}) = \\frac{210}{3} = 70\\,\\text{MPa}$。\n        -   偏应力张量是 $\\mathbf{s}^{B} = \\boldsymbol{\\tau}^{B} - p^{B}\\mathbf{I} = \\operatorname{diag}(90, 60, 60) - 70\\,\\operatorname{diag}(1, 1, 1) = \\operatorname{diag}(20, -10, -10)\\,\\text{MPa}$。\n        -   偏应力第二不变量是：\n            $$J_{2}(\\boldsymbol{\\tau}^{B}) = \\frac{1}{2}\\mathbf{s}^{B}:\\mathbf{s}^{B} = \\frac{1}{2} \\left( (20)^{2} + (-10)^{2} + (-10)^{2} \\right) = \\frac{1}{2}(400 + 100 + 100) = 300\\,\\text{MPa}^{2}$$\n        -   因此，$\\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} = \\sqrt{300} = 10\\sqrt{3}\\,\\text{MPa}$。\n        -   现在我们计算屈服函数的值：\n            $$f(\\boldsymbol{\\tau}^{B}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}^{B}) + \\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} - k$$\n            $$f(\\boldsymbol{\\tau}^{B}) = 0.1 \\cdot (210) + 10\\sqrt{3} - (21 + 10\\sqrt{3}) = 21 + 10\\sqrt{3} - 21 - 10\\sqrt{3} = 0$$\n    -   由于 $f(\\boldsymbol{\\tau}^{B})=0$，屈服条件 $f \\le 0$ 和一致性条件 $\\dot{\\lambda}^{B}\\,f(\\boldsymbol{\\tau}^{B}) = 0.015 \\cdot 0 = 0$ 均得到满足。\n\n2.  **状态 B 的结论：**\n    所有 Kuhn–Tucker 条件均得到满足。由于 $f(\\boldsymbol{\\tau}^{B}) = 0$ 且 $\\dot{\\lambda}^{B} > 0$，状态 B 代表一个塑性加载状态，其应力点位于屈服面上，并且正在发生塑性变形。这与“加载候选状态”的描述一致。因此，任务3要求的一致性检查得到确认：状态 A 是严格位于屈服面内的弹性状态，状态 B 是位于屈服面上的塑性状态。\n\n**状态 B 机械耗散率的计算 (任务1)**\n\n机械耗散率由 $D = \\boldsymbol{\\tau} : \\mathbf{d}^{p}$ 给出。对于状态 B，这是 $D^{B} = \\boldsymbol{\\tau}^{B} : \\mathbf{d}^{p,B}$。\n塑性变形率张量 $\\mathbf{d}^{p,B}$ 由非关联正交流动法则定义：\n$$\\mathbf{d}^{p,B} = \\dot{\\lambda}^{B}\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}\\bigg|_{\\boldsymbol{\\tau}=\\boldsymbol{\\tau}^{B}}$$\n因此，耗散率可以写为：\n$$D^{B} = \\dot{\\lambda}^{B} \\left( \\boldsymbol{\\tau}^{B} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}\\bigg|_{\\boldsymbol{\\tau}=\\boldsymbol{\\tau}^{B}} \\right)$$\n让我们计算内积项。塑性势函数 $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$ 关于 $\\boldsymbol{\\tau}$ 的梯度为：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\,\\frac{\\partial I_{1}}{\\partial \\boldsymbol{\\tau}} + \\frac{\\partial \\sqrt{J_{2}}}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\mathbf{I} + \\frac{1}{2\\sqrt{J_{2}}}\\frac{\\partial J_{2}}{\\partial \\boldsymbol{\\tau}}$$\n使用标准结果 $\\frac{\\partial J_{2}}{\\partial \\boldsymbol{\\tau}} = \\mathbf{s}$，我们得到：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\mathbf{I} + \\frac{\\mathbf{s}}{2\\sqrt{J_{2}}}$$\n现在，我们计算张量缩并 $\\boldsymbol{\\tau} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}$：\n$$\\boldsymbol{\\tau} : \\left( \\alpha_{g}\\mathbf{I} + \\frac{\\mathbf{s}}{2\\sqrt{J_{2}}} \\right) = \\alpha_{g}(\\boldsymbol{\\tau}:\\mathbf{I}) + \\frac{\\boldsymbol{\\tau}:\\mathbf{s}}{2\\sqrt{J_{2}}}$$\n我们知道 $\\boldsymbol{\\tau}:\\mathbf{I} = I_{1}$ 且 $\\boldsymbol{\\tau} = \\mathbf{s} + \\frac{1}{3}I_{1}\\mathbf{I}$。因此，$\\boldsymbol{\\tau}:\\mathbf{s} = (\\mathbf{s} + \\frac{1}{3}I_{1}\\mathbf{I}):\\mathbf{s} = \\mathbf{s}:\\mathbf{s} + \\frac{1}{3}I_{1}(\\mathbf{I}:\\mathbf{s})$。由于 $\\mathbf{I}:\\mathbf{s} = \\operatorname{tr}(\\mathbf{s}) = 0$，我们有 $\\boldsymbol{\\tau}:\\mathbf{s} = \\mathbf{s}:\\mathbf{s} = 2J_{2}$。\n将此代回，我们得到：\n$$\\boldsymbol{\\tau} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}I_{1} + \\frac{2J_{2}}{2\\sqrt{J_{2}}} = \\alpha_{g}I_{1} + \\sqrt{J_{2}} = g(\\boldsymbol{\\tau})$$\n所以，耗散就是简单的 $D^{B} = \\dot{\\lambda}^{B}\\,g(\\boldsymbol{\\tau}^{B})$。\n我们现在可以代入状态 B 的值：$\\alpha_g=0.08$，$I_{1}(\\boldsymbol{\\tau}^{B}) = 210\\,\\text{MPa}$ 和 $\\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} = 10\\sqrt{3}\\,\\text{MPa}$。\n$$g(\\boldsymbol{\\tau}^{B}) = 0.08 \\cdot (210) + 10\\sqrt{3} = 16.8 + 10\\sqrt{3}\\,\\text{MPa}$$\n耗散率为：\n$$D^{B} = \\dot{\\lambda}^{B} \\, g(\\boldsymbol{\\tau}^{B}) = 0.015\\,\\text{s}^{-1} \\cdot (16.8 + 10\\sqrt{3})\\,\\text{MPa}$$\n$$D^{B} = (0.015 \\cdot 16.8 + 0.015 \\cdot 10\\sqrt{3})\\,\\text{MPa}\\cdot\\text{s}^{-1} = (0.252 + 0.15\\sqrt{3})\\,\\text{MPa}\\cdot\\text{s}^{-1}$$\n为了得到数值：\n$$D^{B} \\approx 0.252 + 0.15 \\cdot 1.73205 = 0.252 + 0.2598075 = 0.5118075\\,\\text{MPa}\\cdot\\text{s}^{-1}$$\n题目要求答案以千瓦每立方米 ($\\text{kW/m}^{3}$) 为单位。单位换算是：\n$$1\\,\\text{MPa}\\cdot\\text{s}^{-1} = 10^{6}\\,\\text{Pa}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{N}}{\\text{m}^{2}}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{J}}{\\text{m}^{3}}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{W}}{\\text{m}^{3}} = 1000\\,\\frac{\\text{kW}}{\\text{m}^{3}}$$\n因此，\n$$D^{B} \\approx 0.5118075 \\times 1000\\,\\frac{\\text{kW}}{\\text{m}^{3}} = 511.8075\\,\\frac{\\text{kW}}{\\text{m}^{3}}$$\n四舍五入到四位有效数字，我们得到 $D^{B} = 511.8\\,\\text{kW/m}^{3}$。", "answer": "$$\\boxed{511.8}$$", "id": "3524975"}, {"introduction": "理论学习的最终目标是能够将这些概念整合到一个可工作的计算算法中。本练习 [@problem_id:3525032] 将指导您构建一个弹塑性“预测·校正”格式，这是现代计算塑性力学的基石。通过这个练习，您将把超弹性、有限应变运动学、屈服准则和返回映射算法结合起来，从而在模拟本构模型的实现方面获得一次全面的、总括性的实践体验。", "problem": "考虑一个各向同性岩土材料，其由嵌入在有限应变框架内的 Drucker–Prager 塑性面建模，该框架包含一个超弹性预测步和一个在压力-偏应力不变量空间中的塑性修正步。变形是一个单一的有限简单剪切步，变形梯度 $F \\in \\mathbb{R}^{3 \\times 3}$ 从初始无应力、未变形状态施加。该算法应从一个可压缩超弹性模型计算弹性试探应力，根据 Cauchy 应力的不变量 $p$ 和 $q$ 评估 Drucker–Prager 屈服函数，如果发生屈服，则通过使用后向欧拉算法和线性各向同性硬化，在 $(p,q)$ 平面上投影回 Drucker–Prager 锥面，执行返回映射（塑性修正）。内变量为累积等效塑性应变 $r$ 和塑性体积应变 $\\varepsilon_v^p$。\n\n使用以下基本基底和定义。\n\n- 运动学：有限简单剪切步由变形梯度表示\n$$\nF = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix},\n$$\n其中剪切参数 $\\gamma \\ge 0$ (无量纲)。对于此 $F$，雅可比行列式为 $J = \\det F = 1$，左 Cauchy-Green 张量为 $b = F F^\\top$。\n\n- 弹性预测步：使用由剪切模量 $\\mu$ 和体积模量 $K$ 定义的可压缩 Neo-Hookean 超弹性模型。定义等容左 Cauchy-Green 张量 $\\bar b = J^{-2/3} b$。Kirchhoff 应力为\n$$\n\\tau^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(\\bar b) + K \\ln J \\, \\mathbf{I},\n$$\nCauchy 应力为 $\\sigma^{\\mathrm{tr}} = \\tau^{\\mathrm{tr}}/J$。因为对于给定的简单剪切，$J = 1$，所以 $\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)$。材料常数与杨氏模量 $E$ 和泊松比 $\\nu$ 的关系为\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}.\n$$\n\n- 应力不变量和符号约定：根据 Cauchy 应力 $\\sigma$ 定义压力 $p$ (压为正) 和偏应力不变量 $q$\n$$\np = -\\frac{1}{3} \\mathrm{tr}(\\sigma), \\qquad s = \\sigma + p \\mathbf{I}, \\qquad q = \\sqrt{\\frac{3}{2}\\, s:s}.\n$$\n\n- 带有线性各向同性硬化的 Drucker–Prager 屈服函数：\n$$\nf(p,q,r) = q + \\beta\\, p - \\left(c_0 + H\\, r\\right),\n$$\n其中 $\\beta = \\dfrac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ 取决于摩擦角 $\\varphi$ (弧度)，$c_0 \\ge 0$ 是初始黏聚力 (兆帕)，$H \\ge 0$ 是线性硬化模量 (兆帕)，$r$ 是累积等效塑性应变 (无量纲)。流动法则是非关联的，其塑性势为 $g(p,q) = q + \\beta_g p$，其中 $\\beta_g = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$ 取决于剪胀角 $\\psi$ (弧度)。内变量通过后向欧拉法更新\n$$\nr_{n+1} = r_n + \\Delta \\lambda, \\qquad \\varepsilon_{v,n+1}^p = \\varepsilon_{v,n}^p + \\beta_g\\, \\Delta \\lambda,\n$$\n其中塑性乘子 $\\Delta \\lambda \\ge 0$。\n\n- $(p,q)$ 空间中的弹性预测·塑性修正步：从弹性预测值 $(p^{\\mathrm{tr}},q^{\\mathrm{tr}})$ 开始，在 $(p,q)$ 空间中应用后向欧拉返回映射，\n$$\np_{n+1} = p^{\\mathrm{tr}} - K\\, \\beta_g\\, \\Delta \\lambda, \\qquad q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu\\, \\Delta \\lambda,\n$$\n并满足一致性条件 $f(p_{n+1},q_{n+1},r_{n+1}) = 0$。求解 $\\Delta \\lambda$ 得\n$$\n\\Delta \\lambda =\n\\begin{cases}\n0,  \\text{若 } f^{\\mathrm{tr}} \\le 0,\\\\\n\\dfrac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H},  \\text{若 } f^{\\mathrm{tr}}  0,\n\\end{cases}\n\\quad \\text{其中 } f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - \\left(c_0 + H r_n\\right).\n$$\n返回映射过程中偏应力方向保持不变，即如果 $q^{\\mathrm{tr}}  0$，则 $s_{n+1} = \\dfrac{q_{n+1}}{q^{\\mathrm{tr}}} s^{\\mathrm{tr}}$；否则 $s_{n+1} = \\mathbf{0}$。该步结束时的 Cauchy 应力为 $\\sigma_{n+1} = s_{n+1} - p_{n+1} \\mathbf{I}$。\n\n您的任务是实现一个程序，对下列每个测试用例执行上述的弹性预测·塑性修正算法，用于单个简单剪切步，并返回修正后的最终 $(p,q)$ 值。\n\n在三角函数中使用角度时，单位必须是弧度。在测试用例中，输入的摩擦角和剪胀角将以度为单位指定；请在程序内部将其转换为弧度。所有应力、模量和黏聚力/硬化参数的单位均为兆帕 (MPa)。剪切参数 $\\gamma$ 是无量纲的。以兆帕 (MPa) 为单位表示最终输出 $p$ 和 $q$。将每个输出值四舍五入到六位小数。\n\n测试套件：\n为以下情况提供结果，每种情况均从 $r_n = 0$ 和 $\\varepsilon_{v,n}^p = 0$ 开始：\n\n- 情况 1 (弹性检验)：$E = 10000$ MPa, $\\nu = 0.30$, $\\varphi = 30$ 度, $\\psi = 0$ 度, $c_0 = 150$ MPa, $H = 100$ MPa, $\\gamma = 0.01$。\n- 情况 2 (塑性，非关联)：$E = 5000$ MPa, $\\nu = 0.30$, $\\varphi = 30$ 度, $\\psi = 5$ 度, $c_0 = 5$ MPa, $H = 50$ MPa, $\\gamma = 0.10$。\n- 情况 3 (理想塑性，有摩擦，零黏聚力)：$E = 10000$ MPa, $\\nu = 0.20$, $\\varphi = 35$ 度, $\\psi = 0$ 度, $c_0 = 0$ MPa, $H = 0$ MPa, $\\gamma = 0.20$。\n- 情况 4 (屈服边界，无摩擦)：$E = 6000$ MPa, $\\nu = 0.25$, $\\varphi = 0$ 度, $\\psi = 0$ 度, $c_0 = 41.568$ MPa, $H = 0$ MPa, $\\gamma = 0.01$。\n- 情况 5 (极大硬化，近弹性响应)：$E = 8000$ MPa, $\\nu = 0.30$, $\\varphi = 25$ 度, $\\psi = 10$ 度, $c_0 = 1$ MPa, $H = 1000000$ MPa, $\\gamma = 0.20$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果，顺序为 $[p_1,q_1,p_2,q_2,\\dots,p_5,q_5]$，其中 $p_i$ 和 $q_i$ 是情况 $i$ 的最终修正值。每个数字必须四舍五入到六位小数，并以 MPa 表示。", "solution": "用户提供了一个计算岩土力学领域的问题，要求为一个 Drucker-Prager 材料模型实现一个有限应变弹性预测·塑性修正算法。任务是计算在单个有限简单剪切步后，以压力 $p$ 和偏应力不变量 $q$ 表示的最终应力状态。以下阐述了根据所提供问题陈述推导出的方法论。\n\n该算法主要分三个阶段进行：\n1.  根据基本属性计算材料参数。\n2.  弹性预测步，该步骤假设纯弹性行为，计算试探应力状态。\n3.  塑性修正步，该步骤检查是否发生屈服，如果发生，则将试探应力状态返回至屈服面。\n\n所有步骤都针对初始未变形、无应力的材料执行，因此内变量（累积等效塑性应变 $r_n$ 和塑性体积应变 $\\varepsilon_{v,n}^p$）的初始值均为零。\n\n**1. 材料参数计算**\n\n本构行为由一组材料参数定义。杨氏模量 $E$ 和泊松比 $\\nu$ 用于定义弹性剪切模量 $\\mu$ 和体积模量 $K$：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}\n$$\nDrucker-Prager 屈服面和塑性势分别由摩擦角 $\\varphi$ 和剪胀角 $\\psi$ 定义。这些角用于计算无量纲参数 $\\beta$ 和 $\\beta_g$：\n$$\n\\beta = \\frac{6 \\sin \\varphi}{3 - \\sin \\varphi}, \\qquad \\beta_g = \\frac{6 \\sin \\psi}{3 - \\sin \\psi}\n$$\n输入的以度为单位的角度必须首先转换为弧度，才能在三角函数中使用。该模型还包括初始黏聚力 $c_0$ 和线性硬化模量 $H$。\n\n**2. 弹性预测步**\n\n变形是一个单一的有限简单剪切步，由变形梯度 $F$ 和剪切参数 $\\gamma$ 定义：\n$$\nF = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}\n$$\n$F$ 的行列式为 $J = \\det(F) = 1$，表示等容（体积保持）变形。左 Cauchy-Green 张量 $b$ 计算为 $b = F F^\\top$：\n$$\nb = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}\n\\begin{bmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix}\n= \\begin{bmatrix} 1+\\gamma^2  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix}\n$$\n弹性预测应力由可压缩 Neo-Hookean 模型给出。由于 $J=1$，Kirchhoff 应力 $\\tau^{\\mathrm{tr}}$ 和 Cauchy 应力 $\\sigma^{\\mathrm{tr}}$ 是相同的，并简化为：\n$$\n\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)\n$$\n其中 $\\mathrm{dev}(b) = b - \\frac{1}{3}\\mathrm{tr}(b)\\mathbf{I}$。$b$ 的迹为 $\\mathrm{tr}(b) = (1+\\gamma^2) + 1 + 1 = 3 + \\gamma^2$。\n$$\n\\mathrm{dev}(b) = \\begin{bmatrix} 1+\\gamma^2  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix} - \\frac{3+\\gamma^2}{3}\\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{pmatrix} \\frac{2}{3}\\gamma^2  \\gamma  0 \\\\ \\gamma  -\\frac{1}{3}\\gamma^2  0 \\\\ 0  0  -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\n因此，试探 Cauchy 应力为：\n$$\n\\sigma^{\\mathrm{tr}} = \\mu \\begin{pmatrix} \\frac{2}{3}\\gamma^2  \\gamma  0 \\\\ \\gamma  -\\frac{1}{3}\\gamma^2  0 \\\\ 0  0  -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\n根据该试探应力，我们计算试探应力不变量：压力 $p^{\\mathrm{tr}}$ 和偏应力不变量 $q^{\\mathrm{tr}}$。\n试探压力 $p^{\\mathrm{tr}}$ 为：\n$$\np^{\\mathrm{tr}} = -\\frac{1}{3} \\mathrm{tr}(\\sigma^{\\mathrm{tr}}) = -\\frac{\\mu}{3} \\left( \\frac{2}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 \\right) = 0\n$$\n由于 $p^{\\mathrm{tr}}=0$，试探偏应力张量 $s^{\\mathrm{tr}}$ 等于试探应力 $\\sigma^{\\mathrm{tr}}$ 本身。试探偏应力不变量 $q^{\\mathrm{tr}}$ 为：\n$$\nq^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} s^{\\mathrm{tr}}:s^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} \\sum_{i,j} (\\sigma^{\\mathrm{tr}}_{ij})^2} = \\sqrt{\\frac{3}{2} \\mu^2 \\left[ (\\frac{2}{3}\\gamma^2)^2 + \\gamma^2 + \\gamma^2 + (-\\frac{1}{3}\\gamma^2)^2 + (-\\frac{1}{3}\\gamma^2)^2 \\right]}\n$$\n$$\nq^{\\mathrm{tr}} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{4}{9}\\gamma^4 + 2\\gamma^2 + \\frac{2}{9}\\gamma^4 \\right]} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{2}{3}\\gamma^4 + 2\\gamma^2 \\right]} = \\mu \\sqrt{\\gamma^4 + 3\\gamma^2} = \\mu \\gamma \\sqrt{\\gamma^2 + 3}\n$$\n因此，对于给定的简单剪切变形，试探状态就是 $(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}) = (0, \\mu \\gamma \\sqrt{\\gamma^2 + 3})$。\n\n**3. 屈服检查和塑性修正步**\n\n我们在试探状态下评估 Drucker-Prager 屈服函数 $f$：\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - (c_0 + H r_n)\n$$\n鉴于 $p^{\\mathrm{tr}} = 0$ 和初始条件 $r_n=0$，这简化为：\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} - c_0\n$$\n- 如果 $f^{\\mathrm{tr}} \\le 0$，材料响应是弹性的。试探状态即为最终状态：\n  $$ p_{n+1} = p^{\\mathrm{tr}} = 0, \\qquad q_{n+1} = q^{\\mathrm{tr}} $$\n- 如果 $f^{\\mathrm{tr}}  0$，试探状态位于屈服面之外，发生塑性流动。需要进行塑性修正。塑性修正的大小由塑性乘子 $\\Delta\\lambda$ 决定，其计算公式为：\n  $$\n  \\Delta \\lambda = \\frac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H}\n  $$\n  最终的应力不变量 $(p_{n+1}, q_{n+1})$ 通过使用后向欧拉算法将试探状态返回至屈服面来找到：\n  $$\n  p_{n+1} = p^{\\mathrm{tr}} - K \\beta_g \\Delta\\lambda = - K \\beta_g \\Delta\\lambda\n  $$\n  $$\n  q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu \\Delta\\lambda\n  $$\n内变量也同样更新，虽然最终输出 $(p,q)$ 并不需要它们：\n$$\nr_{n+1} = r_n + \\Delta\\lambda = \\Delta\\lambda\n$$\n\n这个完整的算法被应用于问题陈述中指定的每个测试用例。计算每个用例的 $p_{n+1}$ 和 $q_{n+1}$ 的最终值，四舍五入到六位小数，并以要求的格式呈现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    This function implements an elastic-predictor, plastic-corrector algorithm\n    for a Drucker-Prager material model under a single finite simple shear step.\n    It calculates the final stress state (p, q) for each test case.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (elastic check)\n        {'E': 10000, 'nu': 0.30, 'phi': 30, 'psi': 0, 'c0': 150, 'H': 100, 'gamma': 0.01},\n        # Case 2 (plastic, non-associative)\n        {'E': 5000, 'nu': 0.30, 'phi': 30, 'psi': 5, 'c0': 5, 'H': 50, 'gamma': 0.10},\n        # Case 3 (perfectly plastic, frictional with zero cohesion)\n        {'E': 10000, 'nu': 0.20, 'phi': 35, 'psi': 0, 'c0': 0, 'H': 0, 'gamma': 0.20},\n        # Case 4 (boundary on yield, frictionless)\n        {'E': 6000, 'nu': 0.25, 'phi': 0, 'psi': 0, 'c0': 41.568, 'H': 0, 'gamma': 0.01},\n        # Case 5 (very large hardening, near-elastic response)\n        {'E': 8000, 'nu': 0.30, 'phi': 25, 'psi': 10, 'c0': 1, 'H': 1000000, 'gamma': 0.20},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_final, q_final = calculate_stress_state(case)\n        # Round to six decimal places as required\n        results.extend([round(p_final, 6), round(q_final, 6)])\n\n    # Format the final output string\n    # Using format specifier to avoid scientific notation and ensure standard decimal representation\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_stress_state(params):\n    \"\"\"\n    Performs the elastic-predictor plastic-corrector calculation for one case.\n\n    Args:\n        params (dict): A dictionary containing all material and loading parameters.\n\n    Returns:\n        tuple: A tuple containing the final pressure (p) and deviatoric invariant (q).\n    \"\"\"\n    # Unpack parameters\n    E = params['E']\n    nu = params['nu']\n    phi_deg = params['phi']\n    psi_deg = params['psi']\n    c0 = params['c0']\n    H = params['H']\n    gamma = params['gamma']\n    \n    # --- 1. Material Parameter Calculation ---\n\n    # Elastic moduli\n    mu = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n\n    # Convert angles to radians\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n    \n    sin_phi = np.sin(phi_rad)\n    sin_psi = np.sin(psi_rad)\n\n    # Drucker-Prager parameters\n    # The denominator 3-sin(phi) cannot be zero since sin(phi) is in [-1, 1]\n    beta = (6 * sin_phi) / (3 - sin_phi) if (3 - sin_phi) != 0 else 0\n    beta_g = (6 * sin_psi) / (3 - sin_psi) if (3 - sin_psi) != 0 else 0\n\n    # --- 2. Elastic Predictor Step ---\n    \n    # For finite simple shear, the trial stress invariants are:\n    p_tr = 0.0\n    q_tr = mu * gamma * np.sqrt(gamma**2 + 3)\n\n    # --- 3. Yield Check ---\n\n    # Initial internal variable state\n    r_n = 0.0\n    \n    # Evaluate trial yield function\n    f_tr = q_tr + beta * p_tr - (c0 + H * r_n)\n\n    # --- 4. Plastic Corrector Step (if needed) ---\n    \n    if f_tr = 0:\n        # Elastic step: final state is the trial state\n        p_final = p_tr\n        q_final = q_tr\n    else:\n        # Plastic step: perform return mapping\n        \n        # Calculate plastic multiplier\n        denominator = 3 * mu + K * beta * beta_g + H\n        if denominator == 0:\n            # Avoid division by zero, although physically unlikely with H=0\n            # For H=0, mu0, K0, phi=psi=0, this is positive\n            delta_lambda = 0\n        else:\n            delta_lambda = f_tr / denominator\n        \n        # Update stress invariants\n        p_final = p_tr - K * beta_g * delta_lambda\n        q_final = q_tr - 3 * mu * delta_lambda\n\n    return p_final, q_final\n\n# Execute the solver\nsolve()\n```", "id": "3525032"}]}