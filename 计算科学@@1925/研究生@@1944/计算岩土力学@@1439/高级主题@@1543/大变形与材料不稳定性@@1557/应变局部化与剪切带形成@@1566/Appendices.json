{"hands_on_practices": [{"introduction": "理解应变局部化的第一步是掌握其作为材料不稳定性的起源。第一个实践将材料软化这一本构特性与控制方程的椭圆性丧失联系起来，展示了这种局部失效如何表现为整体结构的突弹失稳（snap-back）。通过推导和实现一维响应，您将建立一个基础性的理解，即为什么标准的塑性模型会导致不适定问题。", "problem": "考虑一根长度为 $L$、均匀横截面积为 $A$ 的一维直杆，在小应变运动学条件下承受单调拉伸末端位移。杆件材料遵循各向同性线弹性，弹性模量为 $E$，以及与速率无关的偏应力第二不变量（$J_2$）塑性，并具有相关联的流动法则和线性各向同性硬化/软化定律。初始屈服应力为 $\\sigma_{y0}$，硬化/软化模量为 $H$（负值代表软化）。假设为等温、准静态条件，并忽略体力。\n\n从基本定律和核心定义出发，推导在比例单轴拉伸下的一维荷载-位移响应，并将全局不稳定性（回弹）与局部椭圆性丧失联系起来：\n\n1) 运动学与平衡：在小应变和单轴拉伸条件下，轴向工程应变为 $\\varepsilon = u/L$，其中 $u$ 是施加的末端位移。棱柱杆的力平衡意味着沿杆的轴向应力 $\\sigma$ 是均匀的，因此末端反作用力为 $F = \\sigma A$。\n\n2) 弹塑性本构结构：\n- 弹性定律：$\\mathrm{d}\\sigma = E \\, \\mathrm{d}\\varepsilon^{e}$，且 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$，其中 $\\varepsilon^{e}$ 是弹性应变，$\\varepsilon^{p}$ 是塑性应变。\n- $J_2$ 塑性的屈服函数：$f(\\boldsymbol{\\sigma}, \\kappa) = \\sqrt{3 J_2(\\boldsymbol{\\sigma})} - (\\sigma_{y0} + H \\kappa)$，其中 $\\kappa$ 是累积塑性应变。对于单轴拉伸（$\\sigma \\ge 0$），利用 $\\sqrt{3 J_2(\\boldsymbol{\\sigma})} = \\sigma$ 这一事实，且相关联的流动法则意味着 $\\mathrm{d}\\varepsilon^{p} = \\mathrm{d}\\lambda$，其中 $\\mathrm{d}\\lambda \\ge 0$。\n- Kuhn-Tucker 条件：$f \\le 0$，$\\mathrm{d}\\lambda \\ge 0$，$\\mathrm{d}\\lambda \\, f = 0$，以及当 $\\mathrm{d}\\lambda > 0$ 时的一致性条件 $\\mathrm{d}f = 0$。\n\n3) 通过结合弹性关系、流动法则、硬化定律 $\\mathrm{d}\\sigma_{y} = H \\, \\mathrm{d}\\kappa$ 和一致性条件，推导塑性区域内的一维算法（增量）切线：\n- 在单轴拉伸中，使用 $\\mathrm{d}\\sigma = E (\\mathrm{d}\\varepsilon - \\mathrm{d}\\varepsilon^{p}) = E (\\mathrm{d}\\varepsilon - \\mathrm{d}\\lambda)$ 和 $\\mathrm{d}f = \\mathrm{d}\\sigma - H \\, \\mathrm{d}\\lambda = 0$。\n- 证明 $\\mathrm{d}\\lambda = \\dfrac{E}{E + H} \\, \\mathrm{d}\\varepsilon$ 且塑性算法切线为 $E_{t} = \\dfrac{E H}{E + H}$，因此在塑性区域内 $\\mathrm{d}\\sigma = E_{t} \\, \\mathrm{d}\\varepsilon$。\n\n4) 比例加载下的分段应力-应变响应：\n- 弹性区域，当 $\\varepsilon \\le \\varepsilon_{y}$ 且 $\\varepsilon_{y} = \\sigma_{y0}/E$ 时：$\\sigma(\\varepsilon) = E \\varepsilon$。\n- 塑性区域，当 $\\varepsilon \\ge \\varepsilon_{y}$ 时：$\\sigma(\\varepsilon) = \\sigma_{y0} + E_{t} (\\varepsilon - \\varepsilon_{y})$。\n- 反作用力为 $F(u) = A \\, \\sigma(u/L)$。\n- 全局切线刚度为 $\\dfrac{\\mathrm{d}F}{\\mathrm{d}u} = \\dfrac{A}{L} \\times \\begin{cases} E  \\text{对于 } u \\le u_{y}, \\\\ E_{t}  \\text{对于 } u \\ge u_{y}, \\end{cases}$，其中 $u_{y} = \\varepsilon_{y} L$。\n\n5) 声学张量和椭圆性丧失：对于小应变增量本构行为，单位方向向量 $\\boldsymbol{n}$ 的声学张量为 $Q(\\boldsymbol{n}) = \\boldsymbol{n} \\cdot \\mathbb{C}_{ep} \\cdot \\boldsymbol{n}$，其中 $\\mathbb{C}_{ep}$ 是弹塑性切线算子。在沿杆轴的一维拉伸中，这简化为 $Q = E_{t}$。当 $Q \\le 0$ 时，即当 $E_{t} \\le 0$ 时，发生局部椭圆性丧失。证明负的 $E_{t}$ 意味着负的全局切线刚度，这会在位移控制下的荷载-位移曲线上产生一个回弹段，并确定首次发生椭圆性丧失时的位移。\n\n你的程序必须：\n- 在上述 $J_2$ 塑性假设下，实现分段单轴应力响应。\n- 通过在 $0$ 到 $u_{\\max}$ 范围内以 $N$ 个步长（包括端点）均匀采样 $u$，为每个测试用例生成离散的力-位移曲线 $F(u)$。\n- 对每个测试用例计算峰值反作用力 $F_{\\text{peak}}$（单位：牛顿）、首次出现此峰值时的位移 $u_{\\text{peak}}$（单位：米）、一个布尔值用于指示是否存在回弹（定义为存在至少一个区间满足 $\\Delta u > 0$ 和 $\\Delta F < 0$），以及首次发生局部椭圆性丧失时的位移 $u_{\\text{ell}}$（单位：米）（定义为如果 $H \\le 0$，则 $u_{\\text{ell}} = u_{y}$，否则不适用；不适用表示为 $-1.0$）。\n- 使用以下科学上合理的测试套件参数，以国际单位制表示：\n    1) $E = 2.0 \\times 10^{11} \\, \\text{Pa}$，$H = 1.0 \\times 10^{9} \\, \\text{Pa}$，$\\sigma_{y0} = 4.0 \\times 10^{8} \\, \\text{Pa}$，$A = 1.0 \\times 10^{-4} \\, \\text{m}^{2}$，$L = 1.0 \\, \\text{m}$，$u_{\\max} = 2 u_{y}$，$N = 201$。\n    2) $E = 2.0 \\times 10^{11} \\, \\text{Pa}$，$H = 0.0 \\, \\text{Pa}$，$\\sigma_{y0} = 4.0 \\times 10^{8} \\, \\text{Pa}$，$A = 1.0 \\times 10^{-4} \\, \\text{m}^{2}$，$L = 1.0 \\, \\text{m}$，$u_{\\max} = 2 u_{y}$，$N = 201$。\n    3) $E = 2.0 \\times 10^{11} \\, \\text{Pa}$，$H = -2.0 \\times 10^{9} \\, \\text{Pa}$，$\\sigma_{y0} = 4.0 \\times 10^{8} \\, \\text{Pa}$，$A = 1.0 \\times 10^{-4} \\, \\text{m}^{2}$，$L = 1.0 \\, \\text{m}$，$u_{\\max} = 2 u_{y}$，$N = 201$。\n    4) $E = 2.0 \\times 10^{11} \\, \\text{Pa}$，$H = -1.0 \\times 10^{11} \\, \\text{Pa}$，$\\sigma_{y0} = 4.0 \\times 10^{8} \\, \\text{Pa}$，$A = 1.0 \\times 10^{-4} \\, \\text{m}^{2}$，$L = 1.0 \\, \\text{m}$，$u_{\\max} = 2 u_{y}$，$N = 201$。\n\n你的程序应产生单行输出，包含所有测试用例的汇总结果，格式为用方括号括起来的、以逗号分隔的列表的列表，每个内部列表按以下顺序排列：\n$[F_{\\text{peak}} \\, \\text{（牛顿）}, u_{\\text{peak}} \\, \\text{（米）}, \\text{snap\\_back} \\, \\text{（布尔值）}, u_{\\text{ell}} \\, \\text{（米）}]$。\n例如，总体输出格式为 $[[\\dots],[\\dots],[\\dots],[\\dots]]$。", "solution": "该问题要求推导拉伸状态下一维杆的弹塑性响应并分析其稳定性，然后进行数值实现。该问题在科学上是合理的、适定的，并且提供了所有必要的参数。我们可以开始求解。\n\n该分析基于准静态、等温条件下的一维系统的连续介质力学基本原理。问题的核心在于推导材料的切线响应，并将其与结构稳定性联系起来。\n\n首先，我们建立控制方程。在均匀单轴拉伸下，运动学关系通过 $\\varepsilon = u/L$ 将杆的末端位移 $u$ 与工程应变 $\\varepsilon$ 联系起来，其中 $L$ 是杆的初始长度。对于横截面积为 $A$ 的棱柱杆，力平衡要求轴向应力 $\\sigma$ 均匀分布，从而产生反作用力 $F = \\sigma A$。\n\n材料行为由一个具有线性各向同性硬化/软化的速率无关 $J_2$ 塑性模型描述。总应变率 $\\mathrm{d}\\varepsilon$ 被加法分解为一个弹性部分 $\\mathrm{d}\\varepsilon^{e}$ 和一个塑性部分 $\\mathrm{d}\\varepsilon^{p}$：\n$$\n\\mathrm{d}\\varepsilon = \\mathrm{d}\\varepsilon^{e} + \\mathrm{d}\\varepsilon^{p}\n$$\n弹性响应由胡克定律 $\\mathrm{d}\\sigma = E \\, \\mathrm{d}\\varepsilon^{e}$ 控制，其中 $E$ 是杨氏模量。\n\n塑性流动由屈服函数 $f$、一个流动法则、一个硬化定律以及 Kuhn-Tucker 加载/卸载条件控制。对于单轴拉伸，屈服函数 $f(\\boldsymbol{\\sigma}, \\kappa) = \\sqrt{3 J_2(\\boldsymbol{\\sigma})} - (\\sigma_{y0} + H \\kappa)$ 得以简化。等效应力 $\\sqrt{3 J_2(\\boldsymbol{\\sigma})}$ 变为轴向应力 $\\sigma$（对于 $\\sigma \\ge 0$），并且在单调加载下，累积塑性应变 $\\kappa$ 等同于单轴塑性应变 $\\varepsilon^p$。因此，屈服条件为：\n$$\nf(\\sigma, \\varepsilon^p) = \\sigma - \\sigma_y(\\varepsilon^p) = \\sigma - (\\sigma_{y0} + H \\varepsilon^p) \\le 0\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力， $H$ 是硬化/软化模量。相关联的流动法则 $\\mathrm{d}\\varepsilon^{p} = \\mathrm{d}\\lambda \\frac{\\partial f}{\\partial \\sigma}$ 简化为 $\\mathrm{d}\\varepsilon^{p} = \\mathrm{d}\\lambda$，其中 $\\mathrm{d}\\lambda \\ge 0$ 是塑性乘子。\n\n我们现在为塑性区域推导一维塑性切线模量 $E_t = \\mathrm{d}\\sigma / \\mathrm{d}\\varepsilon$。在此区域中，应力状态位于屈服面上（$f=0$）且发生塑性加载（$\\mathrm{d}\\lambda > 0$）。必须强制执行一致性条件 $\\mathrm{d}f=0$，以将应力状态维持在演化的屈服面上。对屈服函数取全微分：\n$$\n\\mathrm{d}f = \\frac{\\partial f}{\\partial \\sigma} \\mathrm{d}\\sigma + \\frac{\\partial f}{\\partial \\varepsilon^p} \\mathrm{d}\\varepsilon^p = 0\n$$\n对于 $f = \\sigma - (\\sigma_{y0} + H \\varepsilon^p)$，这变为：\n$$\n\\mathrm{d}\\sigma - H \\, \\mathrm{d}\\varepsilon^p = 0\n$$\n使用流动法则 $\\mathrm{d}\\varepsilon^p = \\mathrm{d}\\lambda$，我们得到一个关键关系：\n$$\n\\mathrm{d}\\sigma = H \\, \\mathrm{d}\\lambda\n$$\n接下来，我们使用弹性定律 $\\mathrm{d}\\sigma = E \\, \\mathrm{d}\\varepsilon^e$，并代入来自应变分解的弹性应变率 $\\mathrm{d}\\varepsilon^e = \\mathrm{d}\\varepsilon - \\mathrm{d}\\varepsilon^p = \\mathrm{d}\\varepsilon - \\mathrm{d}\\lambda$：\n$$\n\\mathrm{d}\\sigma = E (\\mathrm{d}\\varepsilon - \\mathrm{d}\\lambda)\n$$\n我们现在有一个关于未知增量 $\\mathrm{d}\\sigma$ 和 $\\mathrm{d}\\lambda$ 的两个线性方程组。令 $\\mathrm{d}\\sigma$ 的两个表达式相等：\n$$\nH \\, \\mathrm{d}\\lambda = E (\\mathrm{d}\\varepsilon - \\mathrm{d}\\lambda)\n$$\n用总应变增量 $\\mathrm{d}\\varepsilon$ 求解塑性乘子 $\\mathrm{d}\\lambda$：\n$$\nH \\, \\mathrm{d}\\lambda + E \\, \\mathrm{d}\\lambda = E \\, \\mathrm{d}\\varepsilon \\implies (E+H) \\mathrm{d}\\lambda = E \\, \\mathrm{d}\\varepsilon\n$$\n$$\n\\mathrm{d}\\lambda = \\frac{E}{E+H} \\mathrm{d}\\varepsilon\n$$\n该表达式在 $E+H \\ne 0$ 的条件下有效。将其代回关系式 $\\mathrm{d}\\sigma = H \\, \\mathrm{d}\\lambda$ 中，得到应力增量和总应变增量之间的关系：\n$$\n\\mathrm{d}\\sigma = H \\left( \\frac{E}{E+H} \\mathrm{d}\\varepsilon \\right) = \\frac{EH}{E+H} \\mathrm{d}\\varepsilon\n$$\n根据定义，塑性切线模量为 $E_t = \\mathrm{d}\\sigma / \\mathrm{d}\\varepsilon$。因此：\n$$\nE_t = \\frac{EH}{E+H}\n$$\n对增量应力-应变关系进行积分，可得到分段响应。弹性区域（$\\sigma \\le \\sigma_{y0}$）由 $\\sigma(\\varepsilon) = E \\varepsilon$ 控制。屈服开始于应变 $\\varepsilon_y = \\sigma_{y0}/E$。对于应变 $\\varepsilon \\ge \\varepsilon_y$，响应是塑性的：\n$$\n\\int_{\\sigma_{y0}}^{\\sigma} \\mathrm{d}\\sigma' = \\int_{\\varepsilon_y}^{\\varepsilon} E_t \\, \\mathrm{d}\\varepsilon' \\implies \\sigma - \\sigma_{y0} = E_t(\\varepsilon - \\varepsilon_y)\n$$\n$$\n\\sigma(\\varepsilon) = \\sigma_{y0} + E_t(\\varepsilon - \\varepsilon_y) \\quad \\text{for } \\varepsilon \\ge \\varepsilon_y\n$$\n力-位移曲线 $F(u)$ 可以通过代入 $\\varepsilon=u/L$ 得到：$F(u) = A \\sigma(u/L)$。杆的全局切线刚度为 $K_T = \\mathrm{d}F/\\mathrm{d}u = (A/L)(\\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon)$。这在弹性区域得到 $K_T = AE/L$，在塑性区域得到 $K_T = AE_t/L$。\n\n最后，我们将其与材料稳定性联系起来。当声学张量不再是正定时，控制运动的偏微分方程会丧失椭圆性。对于一维问题，声学张量 $Q$ 简化为标量切线模量 $Q = E_t$。当 $Q \\le 0$ 时发生椭圆性丧失，这等价于 $E_t \\le 0$。\n$E_t = EH/(E+H)$ 的符号取决于 $H$ 和 $E+H$ 的符号。由于 $E > 0$，对于材料不是非常脆以至于 $H \\le -E$ 的典型情况，分母 $E+H$ 是正的。因此，$E_t$ 的符号由 $H$ 的符号决定。\n-   **硬化 ($H > 0$)：** $E_t > 0$。材料是稳定的。\n-   **理想塑性 ($H = 0$)：** $E_t = 0$。在塑性流动开始时丧失椭圆性。\n-   **软化 ($H < 0$)：** $E_t < 0$。在塑性流动开始时丧失椭圆性。\n\n因此，当且仅当 $H \\le 0$ 时，椭圆性的丧失首次发生在对应于屈服开始的位移 $u_y = \\varepsilon_y L$ 处。\n\n全局结构稳定性由切线刚度 $K_T = AE_t/L$ 的符号控制。负的切线刚度 $K_T < 0$ 标志着“回弹”不稳定性，即力随着施加位移的增加而减小。由于 $A > 0$ 和 $L > 0$，$K_T$ 的符号与 $E_t$ 的符号相同。因此，在这个简单的均质系统中，局部材料不稳定性（椭圆性丧失，$E_t \\le 0$）与全局结构不稳定性（$K_T \\le 0$）直接相关。具体来说，当且仅当材料软化（$H < 0$，导致 $E_t < 0$）时，才会发生回弹（$K_T < 0$）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D elastoplastic bar problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite parameters in SI units\n    # (E, H, sigma_y0, A, L, u_max_factor, N)\n    test_cases = [\n        (2.0e11, 1.0e9, 4.0e8, 1.0e-4, 1.0, 2.0, 201),\n        (2.0e11, 0.0, 4.0e8, 1.0e-4, 1.0, 2.0, 201),\n        (2.0e11, -2.0e9, 4.0e8, 1.0e-4, 1.0, 2.0, 201),\n        (2.0e11, -1.0e11, 4.0e8, 1.0e-4, 1.0, 2.0, 201),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, H, sigma_y0, A, L, u_max_factor, N = case\n\n        # Calculate key parameters\n        eps_y = sigma_y0 / E\n        u_y = eps_y * L\n\n        # Handle the case of E+H=0, though not present in test cases\n        if E + H == 0:\n            # This corresponds to a singularity (infinite tangent modulus)\n            # which implies catastrophic failure. We can't proceed.\n            # For this problem, we can assume E+H is never zero.\n            E_t = np.inf \n        else:\n            E_t = (E * H) / (E + H)\n\n        # Generate displacement and strain arrays\n        u_max = u_max_factor * u_y\n        u_vec = np.linspace(0, u_max, N)\n        eps_vec = u_vec / L\n\n        # Calculate stress array using piecewise definition\n        # Elastic part\n        sigma_elastic = E * eps_vec\n        # Plastic part\n        sigma_plastic = sigma_y0 + E_t * (eps_vec - eps_y)\n        # Combine using np.where\n        sigma_vec = np.where(eps_vec = eps_y, sigma_elastic, sigma_plastic)\n\n        # Calculate force array\n        F_vec = A * sigma_vec\n\n        # Compute required outputs\n        # 1. Peak reaction force and the displacement at which it first occurs\n        F_peak = np.max(F_vec)\n        u_peak_index = np.argmax(F_vec)\n        u_peak = u_vec[u_peak_index]\n\n        # 2. Boolean indicating if snap-back is present\n        # Snap-back is present if the force decreases at any point.\n        # np.diff calculates F[i+1]-F[i]. If any difference is negative, snap-back occurs.\n        snap_back = np.any(np.diff(F_vec)  0)\n\n        # 3. Displacement at which local loss of ellipticity first occurs\n        # This happens at the onset of yielding if H = 0.\n        if H = 0:\n            u_ell = u_y\n        else:\n            u_ell = -1.0\n\n        results.append([F_peak, u_peak, bool(snap_back), u_ell])\n\n    # Format and print the final output\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3563667"}, {"introduction": "在建立了不稳定性的理论基础后，我们现在来探讨其在数值模拟中的实际后果。这个综合性的编程练习将指导您首先重现局部软化模型的病态网格依赖性，在这种模型中，剪切带会随着网格的细化而不符合物理规律地收缩 [@problem_id:3563718]。接着，您将实现一个梯度塑性模型来对问题进行正则化，观察内部长度尺度如何通过设定有限的剪切带厚度来恢复解的客观性。", "problem": "考虑一个无量纲长度为 $L=1$ 的一维小应变拉伸杆，该杆使用线性两节点单元进行离散，并通过有限元法（FEM）求解，其左端固定，右端采用位移控制。该杆遵循线性各向同性弹塑性及线性软化规律，其中弹性模量 $E$、初始屈服应力 $\\sigma_{y0}$ 和软化模量 $H$ 在每个单元内均为常数。软化定义为 $H0$。为触发局部化，在杆的中心引入一个单单元缺陷，该缺陷使该单元的初始屈服应力降低一小部分。一维准静态条件下的线性动量守恒控制方程为 $\\frac{d\\sigma}{dx}=0$，小应变定义为 $\\varepsilon=\\frac{du}{dx}$。本构模型为 $\\sigma=E(\\varepsilon-\\varepsilon_p)$，采用关联流动法则，屈服函数用累积塑性应变类变量 $\\kappa$ 和有效屈服抗力 $\\sigma_y(\\bar{\\kappa})=\\sigma_{y0}+H\\,\\bar{\\kappa}$ 表示。在局部模型中，非局部对应量简化为 $\\bar{\\kappa}=\\kappa$。在梯度正则化模型中，$\\bar{\\kappa}$ 通过求解亥姆霍茲型（Helmholtz-type）平滑方程来定义：\n$$\n\\bar{\\kappa}-l^2\\frac{d^2\\bar{\\kappa}}{dx^2}=\\kappa,\n$$\n边界条件为在 $x=0$ 和 $x=L$ 处的齐次诺伊曼（Neumann）边界条件 $d\\bar{\\kappa}/dx=0$，其中 $l0$ 是内禀长度尺度。单调拉伸的弹塑性更新必须满足标准的 Karush-Kuhn-Tucker (KKT) 条件，并应在一维单调加载假设下使用一致的返回映射（return-mapping）算法：如果弹性预测值违反屈服条件 $\\sigma\\le \\sigma_y(\\bar{\\kappa})$，则强制执行塑性一致性并更新 $\\varepsilon_p$，使得应力回到屈服面上，同时在一次迭代中保持 $\\bar{\\kappa}$ 固定。\n\n你的任务是编写一个完整、可运行的程序，该程序能够：\n- 为位移问题组集全局有限元刚度矩阵，其中 $u(0)=0$ 且 $u(L)=U$，$U$ 以增量方式增加到最终位移 $U_{\\text{end}}$，并在荷载步中推进求解。\n- 在每个荷载步内，执行交错迭代，交替进行以下操作：\n  1. 使用当前单元切线刚度求解位移的全局线性系统。\n  2. 计算单元应变，使用当前的 $\\bar{\\kappa}$ 执行一维返回映射以更新 $\\varepsilon_p$ 和 $\\kappa$，然后通过求解离散的亥姆霍兹方程来更新 $\\bar{\\kappa}$。将局部模型视为 $l=0$ 的特例。\n- 使用中心单元凹口作为缺陷：将中心单元的初始屈服应力降低为原来的 $0.95$ 倍。\n- 在最后一个荷载步之后，通过以下方式测量形成的剪切带厚度：\n  - 识别 $\\kappa$ 达到其最大值的单元索引 $i_{\\max}$。\n  - 定义一个阈值 $\\kappa_{\\text{th}}=\\alpha\\max_i \\kappa_i$，其中 $\\alpha=0.2$。\n  - 从 $i_{\\max}$ 开始向左和向右扩展，只要 $\\kappa_i\\ge \\kappa_{\\text{th}}$，并将此带中包含的单元数量乘以单元尺寸 $h=L/N$ 作为连续宽度进行计算。\n- 将所有量视为无量纲，并将带厚度表示为无量纲长度。\n\n在你的程序中使用以下固定的材料和加载参数：$E=1$，$\\sigma_{y0}=0.2$，$H=-0.4$，$U_{\\text{end}}=0.02$，$N_{\\text{iter}}=3$ 次交错迭代/荷载步，以及 $N_{\\text{steps}}=200$ 个荷载步。对弹性单元使用单元切线模量 $E$，对塑性化单元使用一个较小的值 $E_{\\min}=10^{-6}E$，以保持全局求解的数值稳定性，同时在一次迭代中固定 $\\bar{\\kappa}$ 的情况下，遵守返回映射的一致性。使用二阶中心差分和齐次诺伊曼边界条件，为以单元为中心的自由度上的 $\\bar{\\kappa}$ 构建离散的亥姆霍즈算子。\n\n测试套件：\n- 情况1（局部模型，粗网格）：$N=40, l=0$。\n- 情况2（局部模型，细网格）：$N=160, l=0$。\n- 情况3（梯度模型，粗网格，小内禀长度）：$N=40, l=0.02$。\n- 情况4（梯度模型，细网格，相同内禀长度）：$N=160, l=0.02$。\n- 情况5（梯度模型, 细网格，较大内禀长度）：$N=160, l=0.05$。\n- 情况6（梯度模型, 粗网格, $l  h$ 的边缘情况）：$N=40, l=0.005$。", "solution": "所给问题是计算塑性力学中一个适定（well-posed）且标准的练习，旨在演示具有软化行为的材料中的应变局部化现象以及梯度增强的正则化效应。该问题具有科学依据，无需不可验证的假设，并包含唯一数值解所需的所有必要信息。因此，该问题被认定为有效。\n\n解决方案涉及开发一个一维有限元法（FEM）代码，以模拟拉伸杆的准静态响应。材料模型为线性弹塑性伴随线性软化。局部软化模型的病态（ill-posed）性质通过梯度塑性方法进行正则化，该方法引入了一个内禀长度尺度。耦合方程组使用交错迭代格式求解。\n\n### 1. 力学问题的有限元离散化\n\n长度为 $L=1$ 的杆被离散为 $N$ 个尺寸均匀的线性两节点有限元，单元尺寸 $h = L/N$。位移场 $u(x)$ 被近似为由节点位移 $\\mathbf{u} = \\{u_0, u_1, \\dots, u_N\\}^T$ 定义的分段线性函数。每个单元 $i$ 内的应变 $\\varepsilon$ 是恒定的，由其节点的位移给出：\n$$\n\\varepsilon_i = \\frac{u_{i+1} - u_i}{h}\n$$\n准静态问题的控制方程是线性动量守恒方程 $\\frac{d\\sigma}{dx}=0$。其弱形式导出标准的有限元矩阵系统：\n$$\n\\mathbf{K}\\mathbf{u} = \\mathbf{f}\n$$\n其中 $\\mathbf{K}$ 是全局刚度矩阵，$\\mathbf{u}$ 是节点位移向量，$\\mathbf{f}$ 是外部节点力向量。对于连接节点 $i$ 和 $i+1$ 的单元 $i$，其单元刚度矩阵为：\n$$\n\\mathbf{k}^{(i)} = \\frac{E_{\\text{tan}}^{(i)}}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n此处，$E_{\\text{tan}}^{(i)}$ 是单元的切线模量。全局剛度矩阵 $\\mathbf{K}$ 通过将所有单元矩阵的贡献相加来组集。\n\n问题指定了位移边界条件：$u(0)=0$ 和 $u(L)=U$。这意味着 $u_0=0$ 和 $u_N=U$。求解方程组以获得未知的内部节点位移 $\\{u_1, \\dots, u_{N-1}\\}$。通过对全局矩阵进行分区，可以获得这些自由度的缩减系统。施加的位移 $u_N=U$ 会对系统施加一个力。缩减系统为 $\\mathbf{K}_{\\text{red}}\\mathbf{u}_{\\text{red}} = \\mathbf{f}_{\\text{red}}$，其中 $\\mathbf{K}_{\\text{red}}$ 是 $\\mathbf{K}$ 中对应于自由节点的子矩阵，而 $\\mathbf{f}_{\\text{red}}$ 是由 $u_N$ 处的约束产生的力向量。对于此一维设置，$\\mathbf{f}_{\\text{red}}$ 是一个零向量，除了其最后一个分量为 $-K_{N-1,N}U = \\frac{E_{\\text{tan}}^{(N-1)}}{h}U$。\n\n### 2. 本构模型与返回映射算法\n\n材料行为由一个一维线性弹塑性模型伴随线性软化所控制。应力 $\\sigma$ 通过以下公式与总应变 $\\varepsilon$ 和塑性应变 $\\varepsilon_p$ 相关：\n$$\n\\sigma = E(\\varepsilon - \\varepsilon_p)\n$$\n当应力达到屈服应力 $\\sigma_y$ 时，发生塑性变形。屈服条件为 $\\sigma \\le \\sigma_y(\\bar{\\kappa})$，其中屈服应力随正则化的内禀变量 $\\bar{\\kappa}$ 演化：\n$$\n\\sigma_y(\\bar{\\kappa}) = \\sigma_{y0} + H\\bar{\\kappa}\n$$\n此处，$\\sigma_{y0}$ 是初始屈服应力，$H0$ 是软化模量。内禀变量 $\\kappa$ 代表累积塑性应变，对于单调拉伸加载，其增量等于塑性应变增量，即 $\\Delta\\kappa = \\Delta\\varepsilon_p$。\n\n在交錯求解格式的每一步中，应力和内禀变量都使用返回映射算法进行更新。对于给定的总应变 $\\varepsilon_i$ 和来自上一次迭代的状态 $(\\varepsilon_{p,i}^{\\text{old}}, \\bar{\\kappa}_i^{\\text{old}})$，算法流程如下：\n1.  **试算步**：计算弹性试算应力：\n    $$\n    \\sigma_i^{\\text{trial}} = E(\\varepsilon_i - \\varepsilon_{p,i}^{\\text{old}})\n    $$\n2.  **屈服检查**：将试算应力与当前屈服面进行比较，在交错格式中，屈服面由 $\\bar{\\kappa}_i^{\\text{old}}$ 固定。屈服函数为 $\\phi_i = \\sigma_i^{\\text{trial}} - (\\sigma_{y0,i} + H\\bar{\\kappa}_i^{\\text{old}})$。\n3.  **更新**：\n    *   若 $\\phi_i \\le 0$，则该步为弹性步。除应力外，状态保持不变：$\\sigma_i = \\sigma_i^{\\text{trial}}$，$\\varepsilon_{p,i}^{\\text{new}} = \\varepsilon_{p,i}^{\\text{old}}$，$\\kappa_i^{\\text{new}} = \\kappa_i^{\\text{old}}$。\n    *   若 $\\phi_i  0$，则该步为塑性步。计算塑性增量 $\\Delta\\gamma_i$ 以强制执行一致性条件 $\\sigma_i^{\\text{new}} = \\sigma_{y0,i} + H\\bar{\\kappa}_i^{\\text{old}}$。\n        $$\n        \\sigma_i^{\\text{new}} = E(\\varepsilon_i - (\\varepsilon_{p,i}^{\\text{old}} + \\Delta\\gamma_i)) = \\sigma_i^{\\text{trial}} - E\\Delta\\gamma_i\n        $$\n        求解 $\\Delta\\gamma_i$ 得：\n        $$\n        \\Delta\\gamma_i = \\frac{\\sigma_i^{\\text{trial}} - (\\sigma_{y0,i} + H\\bar{\\kappa}_i^{\\text{old}})}{E} = \\frac{\\phi_i}{E}\n        $$\n        然后更新局部状态变量：$\\kappa_i^{\\text{new}} = \\kappa_i^{\\text{old}} + \\Delta\\gamma_i$ 和 $\\varepsilon_{p,i}^{\\text{new}} = \\varepsilon_{p,i}^{\\text{old}} + \\Delta\\gamma_i$。\n\n### 3. 梯度正则化\n\n局部模型（$l=0$）设定 $\\bar{\\kappa}=\\kappa$，这会导致病态的网格依赖性，即局部化区域收缩到单个单元的尺寸。梯度正则化模型引入了一个特征长度 $l0$，并通过亥姆霍兹型平滑方程将 $\\bar{\\kappa}$ 与 $\\kappa$ 联系起来：\n$$\n\\bar{\\kappa} - l^2\\frac{d^2\\bar{\\kappa}}{dx^2} = \\kappa\n$$\n边界条件为在 $x=0, L$ 处的齐次诺伊曼边界条件 $\\frac{d\\bar{\\kappa}}{dx}=0$。我们根据刚计算出的 $\\kappa_i$ 值，求解此方程以得到以单元为中心的 $\\bar{\\kappa}_i$ 值。在单元中心网格上（单元尺寸为 $h$）使用中心有限差分法离散化二阶导数，得到：\n$$\n\\bar{\\kappa}_i - \\frac{l^2}{h^2}(\\bar{\\kappa}_{i-1} - 2\\bar{\\kappa}_i + \\bar{\\kappa}_{i+1}) = \\kappa_i\n$$\n诺伊曼边界条件通过使用虚点（ghost points）来施加，这导致边界单元 $i=0$ 和 $i=N-1$ 的方程被修正。这导出一个对称三对角线性方程组 $\\mathbf{A}\\mathbf{\\bar{\\kappa}} = \\mathbf{\\kappa}$，求解该方程组可得到更新后的 $\\mathbf{\\bar{\\kappa}}$ 值。矩阵 $\\mathbf{A}$ 定义为：\n$$\n\\mathbf{A} = \\mathbf{I} + \\left(\\frac{l}{h}\\right)^2 \\begin{pmatrix}\n1  -1    \\\\\n-1  2  -1   \\\\\n \\ddots  \\ddots  \\ddots  \\\\\n  -1  2  -1 \\\\\n   -1  1\n\\end{pmatrix}\n$$\n\n### 4. 通过交错格式的耦合求解\n\n力学边值问题与正则化/本构更新是耦合的。在每个荷载增量步，采用交错（staggered）或算子分裂（operator-split）格式来求解该系统。对于施加位移 $U$ 的每个增量，重复以下步骤进行 $N_{\\text{iter}}$ 次迭代：\n\n1.  **全局力学求解**：为每个单元分配一个切线模量 $E_{\\text{tan}}^{(i)}$。按照规定，我们对弹性单元（$\\kappa_i=0$）使用 $E_{\\text{an}}^{(i)} = E$，对塑性单元（$\\kappa_i0$）使用 $E_{\\text{tan}}^{(i)} = E_{\\min} = 10^{-6}E$。为塑性单元设置的这个小的正值确保了全局刚度矩阵保持正定和可逆。组集并求解全局系统 $\\mathbf{K}\\mathbf{u}=\\mathbf{f}$，以获得新的位移场 $\\mathbf{u}$。\n\n2.  **局部状态更新与正则化**：对每个单元，从 $\\mathbf{u}$ 计算新的总应变 $\\varepsilon_i$。然后执行返回映射算法来更新局部变量 $\\varepsilon_{p,i}$ 和 $\\kappa_i$。随后，求解亥姆霍兹方程以获得整个正则化变量场 $\\bar{\\kappa}_i$。\n\n这个由两部分组成的过程构成一次交错迭代。重复 $N_{\\text{iter}}$ 次后，当前荷载步的解被视为收敛，然后开始下一个荷载步。\n\n### 5. 剪切带厚度测量\n\n在最后一个荷载步之后，计算局部化带的厚度。首先，确定具有最大累积塑性应变 $\\kappa_{\\max} = \\max_i \\kappa_i$ 的单元 $i_{\\max}$。定义一个阈值 $\\kappa_{\\text{th}} = \\alpha \\kappa_{\\max}$，其中 $\\alpha = 0.2$。剪切带被定义为围绕 $i_{\\max}$ 的、满足 $\\kappa_i \\ge \\kappa_{\\text{th}}$ 的连续单元集合。厚度计算为该集合中的单元数量乘以单元尺寸 $h$。此过程量化了剧烈塑性变形的空间范围。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as solve_linear_system\nfrom scipy.linalg import solve_banded\n\n#\n# Professor's Note:\n# This code implements a one-dimensional Finite Element Method (FEM) solver for a bar\n# under tension, incorporating an elastoplastic constitutive model with linear softening.\n# It demonstrates strain localization and regularization using a gradient-plasticity model.\n# The solution follows a staggered (operator-split) scheme, alternating between a global\n# mechanical solve and local constitutive updates coupled with a regularization step.\n#\n# Scientific Correctness  Implementation Choices:\n# - The FEM assembly for a 1D bar is standard.\n# - Boundary conditions are applied by solving a reduced system for free DOFs.\n# - The return-mapping algorithm correctly implements the plastic update for a fixed\n#   yield surface, as dictated by the staggered scheme.\n# - The use of a small positive tangent modulus (E_min) for plastic elements is a\n#   stabilization technique for the staggered scheme, preventing a singular global\n#   stiffness matrix that would arise from the negative physical tangent modulus (E+H0 is not the case here, but H0 can cause issues).\n# - The Helmholtz equation is discretized with a second-order central difference scheme and\n#   homogeneous Neumann boundary conditions are correctly implemented, yielding a\n#   symmetric tridiagonal system.\n# - All quantities are non-dimensional as per the problem statement.\n#\n\ndef run_simulation(N, l_param, E, sigma_y0, H, U_end, N_steps, N_iter):\n    \"\"\"\n    Runs a single simulation for a given set of parameters.\n    \"\"\"\n    #\n    # 1. Initialization\n    #\n    L = 1.0\n    h = L / N\n    E_min = 1e-6 * E\n    alpha_threshold = 0.2\n\n    # Mesh and DOFs\n    # N elements, N+1 nodes.\n    # Nodes are numbered 0 to N. Elements are 0 to N-1.\n    nodes = np.linspace(0, L, N + 1)\n    \n    # State variables\n    u = np.zeros(N + 1)          # Nodal displacements\n    eps = np.zeros(N)            # Element total strain\n    eps_p = np.zeros(N)          # Element plastic strain\n    kappa = np.zeros(N)          # Element accumulated plastic strain\n    k_bar = np.zeros(N)          # Element regularized plastic strain\n\n    # Introduce imperfection\n    sigma_y0_elements = np.full(N, sigma_y0)\n    imperfection_index = N // 2\n    if N % 2 == 0:\n      imperfection_index = N // 2 -1\n    sigma_y0_elements[imperfection_index] *= 0.95\n\n    # Helmholtz operator for gradient regularization\n    A_helm = None\n    if l_param > 0:\n        c = (l_param / h)**2\n        main_diag = np.full(N, 1.0 + 2.0 * c)\n        main_diag[0] = 1.0 + c\n        main_diag[-1] = 1.0 + c\n        off_diag = np.full(N - 1, -c)\n        # SciPy's solve_banded expects the matrix in a specific format\n        A_helm = np.zeros((3, N))\n        A_helm[0, 1:] = off_diag\n        A_helm[1, :] = main_diag\n        A_helm[2, :-1] = off_diag\n\n    #\n    # 2. Load Stepping\n    #\n    U_incr = U_end / N_steps\n    for step in range(N_steps):\n        U = (step + 1) * U_incr\n        \n        # Store state for staggered iterations\n        kappa_old_iter = np.copy(kappa)\n        k_bar_old_iter = np.copy(k_bar)\n        eps_p_old_iter = np.copy(eps_p)\n\n        for it in range(N_iter):\n            #\n            # 2a. Global Mechanical Solve\n            #\n            K_global = np.zeros((N + 1, N + 1))\n            E_tan = np.where(kappa_old_iter > 1e-12, E_min, E)\n            \n            for i in range(N):\n                k_elem = (E_tan[i] / h) * np.array([[1, -1], [-1, 1]])\n                K_global[i:i+2, i:i+2] += k_elem\n\n            # Apply BCs and solve for free DOFs u_1, ..., u_{N-1}\n            K_reduced = K_global[1:N, 1:N]\n            f_reduced = np.zeros(N - 1)\n            # Force from prescribed displacement u_N = U\n            f_reduced[-1] = (E_tan[-1] / h) * U\n            \n            try:\n                # Use solve_banded for the tridiagonal system\n                K_banded = np.zeros((3, N - 1))\n                K_banded[0, 1:] = np.diag(K_reduced, k=1)\n                K_banded[1, :] = np.diag(K_reduced, k=0)\n                K_banded[2, :-1] = np.diag(K_reduced, k=-1)\n                u_reduced = solve_banded((1, 1), K_banded, f_reduced)\n            except np.linalg.LinAlgError:\n                # Fallback to general solver if banded fails, though unlikely\n                u_reduced = solve_linear_system(K_reduced, f_reduced)\n            \n            u[1:N] = u_reduced\n            u[N] = U\n\n            #\n            # 2b. Local State Update  Regularization\n            #\n            # Update total strain\n            eps = (u[1:] - u[:-1]) / h\n\n            # Return mapping\n            sigma_trial = E * (eps - eps_p_old_iter)\n            yield_stress = sigma_y0_elements + H * k_bar_old_iter\n            phi = sigma_trial - yield_stress\n\n            is_plastic = phi > 0\n            d_gamma = np.zeros(N)\n            d_gamma[is_plastic] = phi[is_plastic] / E\n\n            kappa = kappa_old_iter + d_gamma\n            eps_p = eps_p_old_iter + d_gamma\n\n            # Update regularized field\n            if l_param == 0:\n                k_bar = np.copy(kappa)\n            else:\n                k_bar = solve_banded((1, 1), A_helm, kappa)\n            \n            # Update for next staggered iteration\n            kappa_old_iter = np.copy(kappa)\n            k_bar_old_iter = np.copy(k_bar)\n            eps_p_old_iter = np.copy(eps_p)\n    \n    #\n    # 3. Post-Processing: Measure Band Thickness\n    #\n    if np.max(kappa) == 0:\n        return 0.0\n\n    kappa_max = np.max(kappa)\n    kappa_th = alpha_threshold * kappa_max\n    \n    i_max = np.argmax(kappa)\n    \n    count = 1\n    # Expand left\n    i_left = i_max - 1\n    while i_left >= 0 and kappa[i_left] >= kappa_th:\n        count += 1\n        i_left -= 1\n        \n    # Expand right\n    i_right = i_max + 1\n    while i_right  N and kappa[i_right] >= kappa_th:\n        count += 1\n        i_right += 1\n        \n    band_thickness = count * h\n    return band_thickness\n\ndef solve():\n    #\n    # Fixed Parameters\n    #\n    E = 1.0\n    sigma_y0 = 0.2\n    H = -0.4\n    U_end = 0.02\n    N_iter = 3\n    N_steps = 200\n\n    #\n    # Test Suite\n    #\n    test_cases = [\n        # Case 1: local, coarse mesh\n        {'N': 40, 'l': 0.0},\n        # Case 2: local, fine mesh\n        {'N': 160, 'l': 0.0},\n        # Case 3: gradient, coarse mesh, small internal length\n        {'N': 40, 'l': 0.02},\n        # Case 4: gradient, fine mesh, same internal length\n        {'N': 160, 'l': 0.02},\n        # Case 5: gradient, fine mesh, larger internal length\n        {'N': 160, 'l': 0.05},\n        # Case 6: gradient, coarse mesh, l  h edge case\n        {'N': 40, 'l': 0.005},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        l_param = case['l']\n        \n        thickness = run_simulation(N, l_param, E, sigma_y0, H, U_end, N_steps, N_iter)\n        results.append(thickness)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3563718"}, {"introduction": "为巩固正则化的概念，本实践将从完整的数值模拟转向一种更具侧重的分析方法。通过对梯度增强连续体进行线性稳定性分析，您将推导出一个关于新生剪切带厚度的封闭解表达式 [@problem_id:3563673]。这个练习提供了直接的数学证明，表明模型中引入的内部长度尺度决定了局部化区域的宽度，从而验证了前一个实践中的数值观测结果。", "problem": "考虑一个长条带的一维剪切变形，该变形受小应变运动学、线弹性理论以及一个具有线性软化的梯度增强塑性模型控制。设剪应变表示为 $\\gamma(x)$，塑性剪应变表示为 $\\gamma_p(x)$。剪应力由线性弹性关系 $\\tau(x) = G\\left(\\gamma(x) - \\gamma_p(x)\\right)$ 给出，其中 $G$ 是剪切模量。梯度塑性通过一个包含内禀长度尺度 $l$ 的微观力平衡引入，因此驱动微观力包含了塑性应变的拉普拉斯算子。假设屈服应力遵循线性软化定律，形式为 $\\tau_y(\\kappa) = \\tau_0 - H \\kappa$，其中 $\\tau_0$ 是初始屈服应力，$\\kappa$ 是累积塑性应变，而 $H0$ 是软化模量。设 $\\eta0$ 为具有应力单位的梯度系数，因此对微观力的梯度贡献为 $\\eta\\,l^2\\,\\gamma_p''(x)$，其中撇号表示对 $x$ 的空间微分。\n\n从小应变运动学、无体力的一维线性动量平衡、线弹性以及梯度塑性的微观力平衡等控制原理出发，对一个正在经历单调剪切（使得 $\\kappa=\\gamma_p$）的均匀基态进行线性微扰（稳定性）分析。假设一个波数为 $k$ 的正弦微扰模式，形式为 $\\delta\\gamma(x) = \\hat{\\gamma}\\cos(kx)$ 和 $\\delta\\gamma_p(x) = \\hat{\\gamma}_p\\cos(kx)$，并推导出结构切线刚度丧失的条件，该条件用 $k$、$H$、$\\eta$ 和 $l$ 表示。将局部化开始时的剪切带厚度 $t_b$ 定义为在刚度丧失条件下与中性稳定模式相关的半波长，并明确证明对于线性软化定律，$t_b$ 与内禀长度 $l$ 成线性比例关系。然后，用 $H$、$\\eta$ 和 $l$ 以闭合形式量化 $t_b$。\n\n你的程序必须为每个测试用例计算预测的剪切带厚度 $t_b$（单位为米）和无量纲比率 $t_b/l$，两者均为浮点数。将 $t_b$ 以米为单位表示。每个测试用例的输出应为两个浮点数：$[t_b, r]$，每个数都四舍五入到六位小数。最终的程序输出必须是单行，包含一个由这些双浮点数列表组成的逗号分隔列表，并用方括号括起来。\n\n使用以下具有物理上合理参数的测试套件：\n- 测试用例 $1$：$l = 0.005\\ \\mathrm{m}$，$H = 20\\times 10^6\\ \\mathrm{Pa}$，$\\eta = 40\\times 10^6\\ \\mathrm{Pa}$。\n- 测试用例 $2$：$l = 0.001\\ \\mathrm{m}$，$H = 20\\times 10^6\\ \\mathrm{Pa}$，$\\eta = 40\\times 10^6\\ \\mathrm{Pa}$。\n- 测试用例 $3$：$l = 0.010\\ \\mathrm{m}$，$H = 80\\times 10^6\\ \\mathrm{Pa}$，$\\eta = 40\\times 10^6\\ \\mathrm{Pa}$。\n- 测试用例 $4$：$l = 0.005\\ \\mathrm{m}$，$H = 160\\times 10^6\\ \\mathrm{Pa}$，$\\eta = 40\\times 10^6\\ \\mathrm{Pa}$。\n- 测试用例 $5$：$l = 0.003\\ \\mathrm{m}$，$H = 40\\times 10^6\\ \\mathrm{Pa}$，$\\eta = 40\\times 10^6\\ \\mathrm{Pa}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是按上述顺序排列的测试用例的双浮点数列表，例如：$[[t_{b1},r_1],[t_{b2},r_2],[t_{b3},r_3],[t_{b4},r_4],[t_{b5},r_5]]$，每个浮点数都四舍五入到六位小数，并且打印行中没有空格。", "solution": "我们从适用于一维小应变剪切的基本公式开始。设 $x$ 表示空间坐标，$\\gamma(x)$ 为总剪应变，$\\gamma_p(x)$ 为塑性剪应变。剪应力遵循线性弹性关系\n$$\n\\tau(x) = G\\left(\\gamma(x) - \\gamma_p(x)\\right),\n$$\n其中 $G$ 是剪切模量。在梯度塑性理论中，微观力平衡引入了一个与 $\\gamma_p(x)$ 梯度共轭的高阶应力贡献。对于单调加载的一维情况（此时累积塑性应变 $\\kappa$ 等于 $\\gamma_p$），稳态微观力平衡可以写为\n$$\n\\tau(x) - \\tau_y(\\gamma_p(x)) + \\eta\\,l^2\\,\\gamma_p''(x) = 0,\n$$\n其中 $l0$ 是内禀长度尺度，$\\eta0$ 是具有应力单位的梯度系数。屈服应力的线性软化定律为\n$$\n\\tau_y(\\kappa) = \\tau_0 - H \\kappa, \\quad H0,\n$$\n其中 $\\tau_0$ 是初始屈服应力， $H$ 是软化模量。\n\n我们通过线性微扰分析来研究局部化的开始。在一个均匀基态上，我们叠加正弦微扰：\n$$\n\\delta\\gamma(x) = \\hat{\\gamma}\\cos(kx), \\qquad \\delta\\gamma_p(x) = \\hat{\\gamma}_p\\cos(kx),\n$$\n其中 $k$ 是波数，$\\hat{\\gamma}$ 和 $\\hat{\\gamma}_p$ 是振幅。线性化本构关系得到\n$$\n\\delta\\tau(x) = G\\left(\\delta\\gamma(x) - \\delta\\gamma_p(x)\\right).\n$$\n围绕基态线性化的微观力平衡变为\n$$\n\\delta\\tau(x) - \\left(-H\\,\\delta\\gamma_p(x)\\right) + \\eta\\,l^2\\,\\delta\\gamma_p''(x) = 0,\n$$\n因为 $\\tau_y = \\tau_0 - H\\gamma_p$ 关于 $\\gamma_p$ 的导数是 $-H$。使用 $\\delta\\gamma_p''(x) = -k^2 \\hat{\\gamma}_p \\cos(kx)$，我们将微扰代入线性化的微观力平衡中，得到\n$$\nG\\left(\\delta\\gamma - \\delta\\gamma_p\\right) + H\\,\\delta\\gamma_p - \\eta\\,l^2\\,k^2\\,\\delta\\gamma_p = 0.\n$$\n分解各项并求解振幅比，得到\n$$\nG\\,\\delta\\gamma + \\left(-G + H - \\eta\\,l^2\\,k^2\\right)\\delta\\gamma_p = 0\n\\quad\\Rightarrow\\quad\n\\frac{\\delta\\gamma_p}{\\delta\\gamma} = \\frac{G}{G - H + \\eta\\,l^2\\,k^2}.\n$$\n相应的，将 $\\delta\\tau$ 与 $\\delta\\gamma$ 相关联的结构切线（刚度）为\n$$\n\\delta\\tau = G\\left(\\delta\\gamma - \\delta\\gamma_p\\right)\n= G\\,\\delta\\gamma\\left(1 - \\frac{G}{G - H + \\eta\\,l^2\\,k^2}\\right)\n= G\\,\\delta\\gamma\\,\\frac{-H + \\eta\\,l^2\\,k^2}{G - H + \\eta\\,l^2\\,k^2}.\n$$\n当分子为零时，发生结构刚度丧失（中性稳定）：\n$$\n-H + \\eta\\,l^2\\,k^2 = 0 \\quad\\Rightarrow\\quad k_c = \\sqrt{\\frac{H}{\\eta\\,l^2}}.\n$$\n我们将局部化开始时的剪切带厚度 $t_b$ 定义为中性稳定模式的半波长，即\n$$\nt_b = \\frac{\\pi}{k_c} = \\pi\\,l\\,\\sqrt{\\frac{\\eta}{H}}.\n$$\n该表达式表明，对于线性软化定律，$t_b$ 与内禀长度 $l$ 成线性比例关系，比例因子 $\\pi\\sqrt{\\eta/H}$ 取决于材料的软化模量 $H$ 和梯度系数 $\\eta$。\n\n算法设计：\n1. 对于每个测试用例 $(l,H,\\eta)$，其中 $l0$, $H0$ 且 $\\eta0$，计算 $t_b = \\pi\\,l\\,\\sqrt{\\eta/H}$。\n2. 计算无量纲比率 $r = t_b/l = \\pi\\sqrt{\\eta/H}$ 以明确验证与 $l$ 的比例关系。\n3. 将 $t_b$ 和 $r$ 都四舍五入到六位小数。\n4. 按照测试套件指定的顺序，将结果汇总为单行，形式为由双浮点数列表组成的逗号分隔列表，不含空格。\n\n数值考虑：\n- 单位：$l$ 的单位是米， $H$ 和 $\\eta$ 的单位是帕斯卡，因此 $t_b$ 的单位是米， $r$ 是无量纲的。\n- 该公式要求 $H0$ 和 $\\eta0$；所有提供的测试用例都满足此条件。\n- 在中性稳定条件中，剪切模量 $G$ 被消去，因此在此线性分析中，用于预测局部化开始的 $t_b$ 仅取决于 $l$、$H$ 和 $\\eta$。\n\n将该公式应用于测试套件，得出以下数值（程序将计算并格式化它们）：\n- 测试用例 1：$l = 0.005$, $H = 20\\times 10^6$, $\\eta = 40\\times 10^6$ 得到 $t_b \\approx 0.022214\\ \\mathrm{m}$ 和 $r \\approx 4.442883$。\n- 测试用例 2：$l = 0.001$, $H = 20\\times 10^6$, $\\eta = 40\\times 10^6$ 得到 $t_b \\approx 0.004443\\ \\mathrm{m}$ 和 $r \\approx 4.442883$。\n- 测试用例 3：$l = 0.010$, $H = 80\\times 10^6$, $\\eta = 40\\times 10^6$ 得到 $t_b \\approx 0.022214\\ \\mathrm{m}$ 和 $r \\approx 2.221441$。\n- 测试用例 4：$l = 0.005$, $H = 160\\times 10^6$, $\\eta = 40\\times 10^6$ 得到 $t_b \\approx 0.007854\\ \\mathrm{m}$ 和 $r \\approx 1.570796$。\n- 测试用例 5：$l = 0.003$, $H = 40\\times 10^6$, $\\eta = 40\\times 10^6$ 得到 $t_b \\approx 0.009425\\ \\mathrm{m}$ 和 $r \\approx 3.141593$。\n\n这些结果证明了 $t_b \\propto l$，并在一维梯度塑性理论框架内，为线性软化剖面量化了厚度。", "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5 (used), scipy 1.11.4 (not used)\nimport numpy as np\n\ndef band_thickness(l, H, eta):\n    \"\"\"\n    Compute shear band thickness t_b and ratio t_b/l for 1D gradient plasticity\n    with linear softening, at onset of localization.\n\n    Parameters:\n        l   : internal length (m), positive float\n        H   : softening modulus (Pa), positive float\n        eta : gradient coefficient (Pa), positive float\n\n    Returns:\n        (t_b, ratio) where:\n            t_b  : shear band thickness in meters\n            ratio: dimensionless t_b / l\n    \"\"\"\n    # t_b = pi * l * sqrt(eta / H)\n    # ratio = pi * sqrt(eta / H)\n    root = np.sqrt(eta / H)\n    t_b = np.pi * l * root\n    ratio = np.pi * root\n    return t_b, ratio\n\ndef format_results(pairs):\n    \"\"\"\n    Format the list of (t_b, ratio) pairs into the exact required string:\n    [[tb1,ratio1],[tb2,ratio2],...], with each float rounded to six decimals\n    and no spaces.\n    \"\"\"\n    parts = []\n    for tb, r in pairs:\n        parts.append(f\"[{tb:.6f},{r:.6f}]\")\n    return \"[\" + \",\".join(parts) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement: (l, H, eta)\n    test_cases = [\n        (0.005, 20e6, 40e6),  # Case 1\n        (0.001, 20e6, 40e6),  # Case 2\n        (0.010, 80e6, 40e6),  # Case 3\n        (0.005, 160e6, 40e6), # Case 4\n        (0.003, 40e6, 40e6),  # Case 5\n    ]\n\n    results = []\n    for l, H, eta in test_cases:\n        tb, ratio = band_thickness(l, H, eta)\n        # Round is handled in formatting, but keep raw floats here\n        results.append((tb, ratio))\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "3563673"}]}