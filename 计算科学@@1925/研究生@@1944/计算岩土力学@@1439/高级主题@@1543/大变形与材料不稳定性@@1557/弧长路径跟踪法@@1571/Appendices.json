{"hands_on_practices": [{"introduction": "在我们运用弧长法这一精密工具之前，我们必须首先理解它旨在解决的问题。本练习使用一个简单的单自由度模型来探究结构不稳定性的数学根源，即所谓的“极限点”。通过分析这个模型，您将直接把切线刚度的概念与“突跳”(snap-through)等物理现象联系起来，从而清晰地揭示为何简单的荷载控制方法会失效 [@problem_id:3501024]。", "problem": "考虑一个代表计算岩土力学中比例加载过程的单自由度非线性平衡模型，其中标量位移为 $u$，荷载因子为 $\\lambda$。其控制平衡方程为\n$$\nF(u,\\lambda) \\equiv k\\,u + \\beta\\,u^{3} - \\lambda\\,P = 0,\n$$\n其中 $k>0$ 是初始线性刚度，$\\beta$ 是表征几何或本构非线性的常数，而 $P>0$ 是一个固定的参考荷载大小（因此物理荷载为 $\\lambda P$）。在存在极限点的情况下，该模型可作为使用 Riks 和 Crisfield 弧长法追踪平衡路径的降阶代理模型。\n\n从平衡的定义出发，并假设平衡路径 $\\lambda(u)$ 在其为单值的任何地方都是可微的，使用基本原理（隐式微分和隐函数定理）来：\n- 推导沿平衡路径的切线斜率 $d\\lambda/du$ 的表达式。\n- 使用你的表达式，陈述在什么条件下（关于 $\\beta$ 和 $u$）会出现荷载控制的极限点，并根据“跃越”与“回弹”来解释它，将每种情况与 $d\\lambda/du$ 的符号联系起来。始终假设 $P>0$ 和 $k>0$。\n- 在存在荷载控制极限点的软化情况下，确定当 $d\\lambda/du=0$ 时的正临界位移大小 $u_{c}$。\n\n答案要求：提供正临界位移 $u_{c}$ 关于 $k$ 和 $\\beta$ 的单一闭式表达式，假设 $\\beta  0$，$k0$ 且 $P0$。不要近似或取整。最终表达式不需要单位。", "solution": "用户提供的问题陈述成功通过了验证协议。它在科学上是合理的、提法恰当、客观，并包含完整解答所需的所有信息。该问题描述了一个经典的单自由度模型，用于阐释非线性结构稳定性的概念，特别是极限点的出现，这推动了在计算力学中使用像 Riks 和 Crisfield 弧长法这样的路径跟踪数值技术。\n\n分析通过将微积分原理应用于给定的平衡方程来进行。\n\n系统的控制平衡方程由下式给出：\n$$\nF(u,\\lambda) = k\\,u + \\beta\\,u^{3} - \\lambda\\,P = 0\n$$\n其中 $u$ 是位移，$\\lambda$ 是荷载因子，$k0$ 是初始刚度，$\\beta$ 是一个非线性参数，$P0$ 是一个参考荷载。我们需要找到平衡路径，它可以表示为函数 $\\lambda(u)$。\n\n**1. 切线斜率 $d\\lambda/du$ 的推导**\n\n为了找到 $\\lambda-u$ 平面上平衡路径的斜率，我们可以对平衡方程关于 $u$ 进行微分。正如问题所提示的，这是隐式微分的一个应用，其形式上由隐函数定理保证。该定理指出，如果 $F(u, \\lambda) = 0$ 且 $\\frac{\\partial F}{\\partial \\lambda} \\neq 0$，那么 $\\lambda$ 可以表示为 $u$ 的函数，其导数由下式给出：\n$$\n\\frac{d\\lambda}{du} = - \\frac{\\partial F / \\partial u}{\\partial F / \\partial \\lambda}\n$$\n首先，我们计算 $F(u, \\lambda) = k\\,u + \\beta\\,u^{3} - \\lambda\\,P$ 所需的偏导数：\n关于位移 $u$ 的偏导数是：\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{\\partial}{\\partial u} (k\\,u + \\beta\\,u^{3} - \\lambda\\,P) = k + 3\\beta\\,u^{2}\n$$\n关于荷载因子 $\\lambda$ 的偏导数是：\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} (k\\,u + \\beta\\,u^{3} - \\lambda\\,P) = -P\n$$\n将这些偏导数代入隐函数定理的公式中，我们得到切线斜率的表达式：\n$$\n\\frac{d\\lambda}{du} = - \\frac{k + 3\\beta\\,u^{2}}{-P} = \\frac{k + 3\\beta\\,u^{2}}{P}\n$$\n\n**2. 荷载控制极限点的条件及解释**\n\n荷载控制的极限点（或荷载-位移路径上的极值点）发生在 $\\lambda-u$ 平面上平衡路径的切线为水平时。这对应于数学条件：\n$$\n\\frac{d\\lambda}{du} = 0\n$$\n使用上面推导的表达式，该条件变为：\n$$\n\\frac{k + 3\\beta\\,u^{2}}{P} = 0\n$$\n由于给定的参考荷载 $P$ 是正的（$P0$），极限点的条件简化为分子为零：\n$$\nk + 3\\beta\\,u^{2} = 0\n$$\n为了使该方程对位移 $u$ 有一个实数非零解，各项的符号必须相反。我们已知初始刚度 $k$ 是正的（$k0$）。同时，$u^2$ 总是非负的。因此，只有当非线性参数 $\\beta$ 为负（$\\beta  0$）时，才可能存在解。这种随着位移大小增加刚度减小的行为被称为“软化”非线性。如果 $\\beta \\ge 0$（一个“硬化”或线性系统），则 $k + 3\\beta\\,u^{2}$ 项总是正的，意味着 $\\frac{d\\lambda}{du}$ 总是正的，不存在荷载控制的极限点。\n\n**解释：**\n斜率 $\\frac{d\\lambda}{du}$ 的符号表示在荷载控制下平衡路径的稳定性。\n- 当 $\\frac{d\\lambda}{du}  0$ 时，平衡是稳定的。荷载 $\\lambda$ 的一个无穷小增量对应于位移 $u$ 的增加。\n- 当 $\\frac{d\\lambda}{du}  0$ 时，平衡是不稳定的。要追踪这部分路径，荷载必须随着位移大小的增加而减小。在一个荷载被单调增加的荷载控制物理实验中，系统无法沿这条不稳定路径前进。相反，当达到 $\\frac{d\\lambda}{du}=0$ 的极限点时，它将发生动态跳跃或“突跳”，到一个远处的、位移大得多的稳定平衡状态。这种现象被称为**跃越（snap-through）**。\n- 极限点本身标志着从稳定到不稳定的转变。这种不稳定性的特征是系统相对于所施加荷载的“刚度丧失”。量 $k+3\\beta u^2$ 被称为系统内力响应的切线刚度。极限点恰好在该切线刚度为零时发生。术语**回弹（snap-back）**通常指一种更复杂的路径拓扑结构，其中路径在荷载和位移上都发生反转，在 $\\lambda-u$ 平面中形成一个C形曲线。虽然这个简单模型主要说明了跃越，但负斜率区域是这两种现象共有的特征。\n\n**3. 临界位移 $u_{c}$ 的确定**\n\n对于软化情况（$\\beta  0$），我们现在可以求解极限点发生时的临界位移 $u_c$。我们使用前面推导的极限点条件：\n$$\nk + 3\\beta\\,u^{2} = 0\n$$\n求解 $u^2$：\n$$\n3\\beta\\,u^{2} = -k\n$$\n$$\nu^{2} = -\\frac{k}{3\\beta}\n$$\n由于在软化情况下 $k0$ 且 $\\beta  0$，等式右边是一个正实数，确保了 $u$ 的实数解存在。对两边取平方根，得到临界位移的两个可能值：\n$$\nu = \\pm \\sqrt{-\\frac{k}{3\\beta}}\n$$\n问题要求的是正的临界位移大小，我们将其记为 $u_c$。因此，我们取正根：\n$$\nu_c = \\sqrt{-\\frac{k}{3\\beta}}\n$$\n这就是正临界位移的最终闭式表达式。", "answer": "$$\n\\boxed{\\sqrt{-\\frac{k}{3\\beta}}}\n$$", "id": "3501024"}, {"introduction": "在实现弧长法时，一个关键的挑战是如何在不意外地反转或跳到错误分支的情况下导航求解路径。本练习聚焦于一个关键的算法细节：为荷载增量 $\\Delta\\lambda$ 选择正确的符号。您将基于增量功等物理原理，开发并测试一个稳健的决策规则，以确保您的路径跟踪算法表现出可预测的行为，尤其是在棘手的极限点附近 [@problem_id:3501046]。", "problem": "你需要为弧长路径跟踪中的荷载比例增量推导并实现一个稳健的符号更新规则，该规则适用于计算岩土力学中常用的 Riks 和 Crisfield 方法。考虑由残差方程 $r(u,\\lambda) = f_{\\text{int}}(u) - \\lambda f_{\\text{ext}} = 0$ 定义的非线性平衡问题，其中 $u$ 是位移向量，$\\lambda$ 是一个无量纲标量荷载参数，用于缩放固定的参考外荷载向量 $f_{\\text{ext}}$，$f_{\\text{int}}(u)$ 是内力向量。在弧长法中，预测-校正步求解一个与弧长约束相结合的线性化系统，其约束形式为 $g(\\Delta u, \\Delta \\lambda) = \\Delta u^{T} W \\Delta u + \\alpha \\Delta \\lambda^{2} - \\Delta s^{2} = 0$，其中 $W$ 是一个正定权重矩阵，$\\alpha$ 是一个正常数比例因子，$\\Delta s$ 是指定的弧长。由于该约束是二次的，因此可以确定其大小 $\\lvert \\Delta \\lambda \\rvert$，但其符号是不明确的，从而产生两个对称的候选解 $\\Delta \\lambda = \\pm \\lvert \\Delta \\lambda \\rvert$。选择错误的符号可能导致在极限点或突弹点发生分支切换。\n\n从增量外力功输入应与预期荷载进程保持一致的基本原理出发，推导一个用增量位移 $\\Delta u$ 和参考外荷载向量 $f_{\\text{ext}}$ 表示的符号更新准则。该准则必须通过检查标量 $f_{\\text{ext}}^{T} \\Delta u$ 或指令荷载增量方向来决定 $\\Delta \\lambda$ 的符号，以避免分支切换。你的推导必须依赖于基本原理：残差方程、弧长约束和增量功概念的定义，而不引入任何简化公式。然后设计一个算法，该算法：\n- 使用增量外力功 $f_{\\text{ext}}^{T} \\Delta u$ 作为主要测试来计算 $\\Delta \\lambda$ 的符号。\n- 当 $f_{\\text{ext}}^{T} \\Delta u$ 在零的一个小容差范围内时（数值模糊性），采用一个决胜层次结构。该层次结构必须首先使用指令荷载方向，然后使用上一步的 $\\Delta \\lambda$，如果两者都不可用，则最后使用默认的正号。\n- 对每个测试用例，生成带符号的 $\\Delta \\lambda = s \\lvert \\Delta \\lambda \\rvert$，其中 $s \\in \\{ -1, +1 \\}$ 是所选的符号。\n\n假设所有量都是无量纲的，且不涉及角度。你的程序的最终输出必须是单行文本，将所有测试用例计算出的带符号的 $\\Delta \\lambda$ 值聚合为一个用方括号括起来的逗号分隔列表，例如，“[0.1,-0.2,0.05]”。\n\n使用以下测试套件，它涵盖了该规则的不同方面。在每个元组中，元素按顺序为：向量 $f_{\\text{ext}}$，向量 $\\Delta u$，正值大小 $\\lvert \\Delta \\lambda \\rvert$，上一个增量 $\\Delta \\lambda_{\\text{prev}}$，以及指令方向 $d$，其中 $d \\in \\{ -1, 0, +1 \\}$：\n1. $([10, 0], [0.001, 0], 0.05, 0.05, +1)$: 一个理想情况，其中 $f_{\\text{ext}}^{T} \\Delta u$ 明显为正。\n2. $([10, 0], [-0.001, 0], 0.2, 0.1, +1)$: 一个 $f_{\\text{ext}}^{T} \\Delta u$ 明显为负的情况。\n3. $([1, 0], [0, 1], 0.1, 0.0, -1)$: 一个点积恰好为零的边界情况，使用指令方向。\n4. $([1, 10^{-12}], [10^{-12}, -1], 0.3, -0.3, 0)$: 一个点积在容差范围内接近于零的情况，使用上一个增量的符号。\n5. $([3, -3], [1, 1], 0.07, 0.0, 0)$: 一个点积为零且无方向历史的边界情况，使用默认值。\n6. $([5, 5], [0.01, 0.01], 0.04, -0.04, -1)$: 一个冲突情况，其中 $f_{\\text{ext}}^{T} \\Delta u$ 指示为正，覆盖了负的指令方向。\n7. $([10^{6}, 0], [10^{-6}, 0], 1.5, 0.0, +1)$: 一个测试数值稳定性的大数值情况。\n\n你的程序必须：\n- 实现派生的符号更新规则，并使用容差参数 $tol = 10^{-9}$ 来判断 $f_{\\text{ext}}^{T} \\Delta u$ 何时被视为零。\n- 对每个测试用例，按规定计算带符号的 $\\Delta \\lambda$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与测试套件相同。", "solution": "该问题要求在计算岩土力学中使用的弧长路径跟踪方法的背景下，推导并实现一个荷载参数增量 $\\Delta \\lambda$ 的符号更新规则。\n\n系统的状态由位移向量 $u$ 和标量荷载参数 $\\lambda$ 描述。平衡条件由非线性残差方程给出：\n$$r(u, \\lambda) = f_{\\text{int}}(u) - \\lambda f_{\\text{ext}} = 0$$\n其中 $f_{\\text{int}}(u)$ 是依赖于历史的内力向量，$f_{\\text{ext}}$ 是一个固定的参考外荷载向量。弧长法通过对增量步 $(\\Delta u, \\Delta \\lambda)$ 的大小施加约束来增强该系统。该约束的一般形式为：\n$$g(\\Delta u, \\Delta \\lambda) = \\Delta u^{T} W \\Delta u + \\alpha \\Delta \\lambda^{2} - \\Delta s^{2} = 0$$\n这里，$\\Delta s$ 是为该步指定的弧长，$W$ 是一个正定权重矩阵（通常是单位矩阵），$\\alpha$ 是一个正常数比例因子，用于平衡位移和荷载增量的贡献。\n\n将线性化平衡方程与此二次约束协同求解，可以得出荷载增量的大小 $|\\Delta \\lambda|$，但其符号仍然不明确。存在两个可能的解，$\\Delta \\lambda = +|\\Delta \\lambda|$ 和 $\\Delta \\lambda = -|\\Delta \\lambda|$，对应于约束表面上的两个对称点。选择错误的符号可能导致数值解沿平衡路径反向，或跳转到完全不同的解分支，从而危及分析，尤其是在极限点或分岔点等临界点附近。\n\n核心任务是推导一个选择符号 $s \\in \\{-1, +1\\}$ 的准则，使得计算出的增量 $\\Delta \\lambda = s |\\Delta \\lambda|$ 能够正确地沿期望的平衡路径推进求解。该推导需基于增量外力功应与预期荷载进程保持一致的原理。\n\n让我们基于固定的参考荷载向量定义一个增量功的度量，$\\Delta W_{\\text{ref}} = f_{\\text{ext}}^T \\Delta u$。这个标量的符号表明，增量位移 $\\Delta u$ 在总体意义上是否与参考荷载 $f_{\\text{ext}}$ 的方向一致。\n- 如果 $f_{\\text{ext}}^T \\Delta u  0$，系统正朝着参考荷载的方向变形。在典型的加载场景中，尤其是在临界前阶段，这对应于施加荷载的增加。因此，寻求荷载参数的增加是物理上一致的，即选择 $\\Delta \\lambda  0$。\n- 如果 $f_{\\text{ext}}^T \\Delta u  0$，系统正与参考荷载相反的方向变形。这种情况可能出现在临界后状态，如回弹（snap-back），此时维持平衡需要减小施加的荷载。因此，寻求荷载参数的减小是一致的，即选择 $\\Delta \\lambda  0$。\n\n这一思路建立了一个一致性准则：荷载参数增量的符号应与参考功的符号相匹配。数学上，我们选择 $\\Delta \\lambda$ 的符号 $s$ 为：\n$$s = \\text{sign}(f_{\\text{ext}}^T \\Delta u)$$\n这确保了乘积 $\\Delta \\lambda (f_{\\text{ext}}^T \\Delta u) \\ge 0$，这是维持路径一致性的常用准则。虽然这个规则在许多情况下是有效的，但它有已知的局限性，例如，在某些突弹（snap-through）现象中，位移持续增加而荷载必须减小。然而，根据问题的规定，它可作为一个稳健的主要测试。\n\n当参考功为零或数值上接近于零时，即 $|f_{\\text{ext}}^T \\Delta u| \\approx 0$，会出现一个关键的边缘情况。如果增量位移向量 $\\Delta u$ 与参考荷载向量 $f_{\\text{ext}}$ 正交，就会发生这种情况，这可能发生在极限点。在这种情况下，主要准则是不确定的，需要一个决胜层次结构来确保做出确定的选择。问题指定了以下层次结构：\n\n1.  **主要准则**：符号 $s$ 由 $s = \\text{sign}(f_{\\text{ext}}^T \\Delta u)$ 决定，前提是 $|f_{\\text{ext}}^T \\Delta u|$ 大于指定的数值容差 $\\text{tol}$。\n\n2.  **决胜规则1（指令方向）**：如果主要准则不明确（即 $|f_{\\text{ext}}^T \\Delta u| \\le \\text{tol}$），则符号由用户指定的指令方向 $d \\in \\{-1, 0, +1\\}$ 决定。如果 $d \\neq 0$，则 $s = d$。这允许对路径跟踪方向进行外部控制。\n\n3.  **决胜规则2（路径连续性）**：如果没有提供指令方向（$d=0$），则选择符号以维持与上一步的连续性。当前增量 $\\Delta \\lambda$ 的符号被设置为上一个增量 $\\Delta \\lambda_{\\text{prev}}$ 的符号。如果 $\\Delta \\lambda_{\\text{prev}} \\neq 0$，则 $s = \\text{sign}(\\Delta \\lambda_{\\text{prev}})$。这可以防止解突然反向。\n\n4.  **决胜规则3（默认）**：如果所有先前的准则都不确定（这发生在第一步，如果 $d=0$ 且 $|f_{\\text{ext}}^T \\Delta u| \\le \\text{tol}$），则使用默认符号。按照惯例，加载从正方向开始，所以默认值为 $s = +1$。\n\n这种分层算法为确定每一步路径跟踪分析中 $\\Delta \\lambda$ 的符号提供了一个完整且稳健的决策过程。最终的带符号荷载增量则计算为 $\\Delta \\lambda = s |\\Delta \\lambda|$。", "answer": "[0.05,-0.2,-0.1,-0.3,0.07,0.04,1.5]", "id": "3501046"}, {"introduction": "现在，让我们将弧长法应用于一个实际的岩土力学问题：确定一个基础的完整承载力曲线，包括其峰后软化行为。这个综合性练习要求您实现一个完整的求解器，以比较两种不同的土体模型——一种是表现出软化的（类似可压碎土），另一种是延性硬化的。这将有力地展示弧长法如何能够分析材料软化和破坏，而这些是现实岩土工程设计中的关键方面 [@problem_id:3501082]。", "problem": "一个无限长刚性条形基础在平面应变条件下，被建模于均质、可压缩的颗粒土上。基础沉降由一个单位为米的广义位移 $u$ 表示。单位平面外长度上的外部荷载合力由 $\\lambda P_{\\mathrm{ref}}$ 表示，单位为千牛每米，其中 $P_{\\mathrm{ref}}$ 是一个恒定的参考荷载，$\\lambda$ 是一个无量纲荷载因子。土壤反力被建模为一个空间均匀的接触压力代理 $q(u;\\boldsymbol{\\theta})$，单位为千牛每米，它仅依赖于沉降 $u$ 和表征土壤本构行为的模型参数 $\\boldsymbol{\\theta}$。\n\n基础的折减平衡写为标量残差形式\n$$\nr(u,\\lambda;\\boldsymbol{\\theta}) \\equiv q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0.\n$$\n目标是采用 Riks–Crisfield 型的弧长路径追踪法，数值追踪整个平衡分支 $\\{(u,\\lambda)\\,|\\, r(u,\\lambda;\\boldsymbol{\\theta})=0\\}$，包括越过峰值荷载之后的部分。该方法所需的切线是标量刚度\n$$\nK_{\\mathrm{t}}(u;\\boldsymbol{\\theta}) \\equiv \\dfrac{\\partial q(u;\\boldsymbol{\\theta})}{\\partial u}.\n$$\n\n在相同的边界条件下，将比较两种土壤本构代理模型：\n- 一种可压碎形式，旨在模拟带有渐进压碎的 $p$–$\\alpha$ 盖帽响应，表现为反力随沉降增加而出现峰后软化。\n- 一种延性硬化形式，旨在模拟修正剑桥模型（Modified Cam-Clay）在主要为压缩性体积荷载下的响应，表现为单调硬化至一个平台，而没有极限点。\n\n为确保问题是良态且可测试的，并且无需借助完整的有限元模型，定义以下代理反力定律（所有参数均为正，并具有指定的单位）：\n- $p$–$\\alpha$ 类可压碎代理模型：\n$$\nq_{\\mathrm{pa}}(u; a_1,b_1,a_2,b_2) = a_1\\,u\\,e^{-b_1 u} \\;+\\; a_2\\left(1-e^{-b_2 u}\\right),\n$$\n其切线为\n$$\nK_{\\mathrm{t,pa}}(u; a_1,b_1,a_2,b_2) = a_1 e^{-b_1 u}\\left(1-b_1 u\\right) \\;+\\; a_2 b_2 e^{-b_2 u}.\n$$\n此处 $a_1$ 的单位是千牛每平方米，$b_1$ 的单位是米的倒数，$a_2$ 的单位是千牛每米，$b_2$ 的单位是米的倒数。\n- 修正剑桥模型类延性代理模型：\n$$\nq_{\\mathrm{mcc}}(u; S,\\beta) = S\\left(1-e^{-\\beta u}\\right),\n$$\n其切线为\n$$\nK_{\\mathrm{t,mcc}}(u; S,\\beta) = S\\beta e^{-\\beta u},\n$$\n其中 $S$ 的单位是千牛每米，$\\beta$ 的单位是米的倒数。\n\n两种代理模型都与以下岩土力学论述一致：基础反力是一个压力分布的积分，在所采用的简化假设下，该压力分布仅取决于 $u$，并在经历由压碎或塑性压实引起的初始硬化阶段后达到饱和或软化。\n\n为包含未知数 $(u,\\lambda)$ 的标量系统实现一个两方程、两未知量的弧长法程序，基于：\n- 平衡：$r(u,\\lambda;\\boldsymbol{\\theta}) = 0$。\n- 每个增量步 $n\\to n+1$ 的 Crisfield 型球面约束：\n$$\ng(u,\\lambda;u_n,\\lambda_n) \\equiv (u-u_n)^2 + \\psi (\\lambda-\\lambda_n)^2 - \\Delta s^2 = 0,\n$$\n其中 $\\psi$ 是一个用于平衡单位的正缩放参数，$\\Delta s$ 是指定的弧长尺寸。对于每个增量步，牛顿校正系统应使用由 $K_{\\mathrm{t}}(u;\\boldsymbol{\\theta})$ 和 $g$ 的线性化组装而成的残差雅可比矩阵。\n\n使用以下测试套件。在所有情况下，取 $P_{\\mathrm{ref}} = 1\\,\\mathrm{kN/m}$，因此荷载因子 $\\lambda$ 在数值上等于以 $\\mathrm{kN/m}$ 为单位的基础反力。所有位移以米表示，所有荷载以 $\\mathrm{kN/m}$ 表示。对于任何指数参数，隐式使用弧度（与指定的单位“米的倒数”量纲上一致）。对于每种情况，使用相同的算法设置为两种模型运行弧长追踪，并报告所要求的量。\n\n所有情况的通用算法参数：\n- 初始状态 $(u_0,\\lambda_0) = (0,0)$。\n- 弧长尺寸 $\\Delta s = 0.002\\,\\mathrm{m}$。\n- 缩放 $\\psi = 10^{-6}\\,\\mathrm{m}^2/(\\mathrm{kN/m})^2$。\n- 连续步数 $N_{\\mathrm{steps}} = 200$。\n- 每步的牛顿迭代，采用基于 $r$ 和 $g$ 的范数的鲁棒停止准则。\n\n测试用例（参数单位与指定一致）：\n- 情况 $1$（强压碎软化 vs 延性硬化）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (120000, 20, 300, 3)$。\n  - 修正剑桥模型代理模型：$(S,\\beta) = (1800, 8)$。\n- 情况 $2$（较温和的软化）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (70000, 12, 600, 1.5)$。\n  - 修正剑桥模型代理模型：$(S,\\beta) = (1100, 5)$。\n- 情况 $3$（近平台行为）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (40000, 8, 900, 1)$。\n  - 修正剑桥模型代理模型：$(S,\\beta) = (900, 4)$。\n\n对于每个测试用例，使用弧长法计算以下四个输出：\n- $p$–$\\alpha$ 代理模型的单位长度最大平衡荷载 $\\max\\lambda_{\\mathrm{pa}}$，单位为 $\\mathrm{kN/m}$，四舍五入到两位小数。\n- 修正剑桥模型代理模型的单位长度最大平衡荷载 $\\max\\lambda_{\\mathrm{mcc}}$，单位为 $\\mathrm{kN/m}$，四舍五入到两位小数。\n- 一个布尔值，指示是否在 $p$–$\\alpha$ 分支中检测到极限点（定义为 $K_{\\mathrm{t,pa}}$ 沿追踪路径发生符号变化）。\n- 一个布尔值，指示是否在修正剑桥模型分支中检测到极限点（定义为 $K_{\\mathrm{t,mcc}}$ 沿追踪路径发生符号变化）。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例的结果本身是按上述顺序排列的列表。例如：\"[[case1_result1,case1_result2,case1_result3,case1_result4],[case2_result1,case2_result2,case2_result3,case2_result4],[case3_result1,case3_result2,case3_result3,case3_result4]]\"。", "solution": "用户的请求是使用一种数值路径追踪技术来解决一个计算岩土力学问题。该问题涉及在两种不同的土壤本构定律下，追踪一个简化基础模型的平衡路径。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n- **平衡关系：** $r(u,\\lambda;\\boldsymbol{\\theta}) \\equiv q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0$，其中 $u$ 是沉降，$\\lambda$ 是荷载因子，$q(u;\\boldsymbol{\\theta})$ 是土壤反力。\n- **切线刚度：** $K_{\\mathrm{t}}(u;\\boldsymbol{\\theta}) \\equiv \\frac{\\partial q}{\\partial u}$。\n- **$p$–$\\alpha$ 类代理模型：** $q_{\\mathrm{pa}}(u; a_1,b_1,a_2,b_2) = a_1 u e^{-b_1 u} + a_2(1-e^{-b_2 u})$。\n- **$p$–$\\alpha$ 类切线：** $K_{\\mathrm{t,pa}}(u; a_1,b_1,a_2,b2) = a_1 e^{-b_1 u}(1-b_1 u) + a_2 b_2 e^{-b_2 u}$。\n- **修正剑桥模型类代理模型：** $q_{\\mathrm{mcc}}(u; S,\\beta) = S(1-e^{-\\beta u})$。\n- **修正剑桥模型类切线：** $K_{\\mathrm{t,mcc}}(u; S,\\beta) = S\\beta e^{-\\beta u}$。\n- **弧长约束：** $g(u,\\lambda;u_n,\\lambda_n) \\equiv (u-u_n)^2 + \\psi (\\lambda-\\lambda_n)^2 - \\Delta s^2 = 0$。\n- **算法参数：**\n  - $P_{\\mathrm{ref}} = 1\\,\\mathrm{kN/m}$\n  - 初始状态 $(u_0, \\lambda_0) = (0, 0)$\n  - 弧长尺寸 $\\Delta s = 0.002\\,\\mathrm{m}$\n  - 缩放因子 $\\psi = 10^{-6}\\,\\mathrm{m}^2/(\\mathrm{kN/m})^2$\n  - 步数 $N_{\\mathrm{steps}} = 200$\n- **测试用例：**\n  - 情况 $1$：$p$–$\\alpha$ 参数 $(120000, 20, 300, 3)$；MCC 参数 $(1800, 8)$。\n  - 情况 $2$：$p$–$\\alpha$ 参数 $(70000, 12, 600, 1.5)$；MCC 参数 $(1100, 5)$。\n  - 情况 $3$：$p$–$\\alpha$ 参数 $(40000, 8, 900, 1)$；MCC 参数 $(900, 4)$。\n- **输出：** 对于每种情况，$[\\max\\lambda_{\\mathrm{pa}}, \\max\\lambda_{\\mathrm{mcc}}, \\text{limit\\_point\\_pa}, \\text{limit\\_point\\_mcc}]$。\n\n**步骤2：使用提取的给定条件进行验证**\n根据预定义的标准对问题进行评估：\n- **科学依据：** 该问题是结构/岩土工程中非线性数值方法的经典应用。使用土壤行为的代理模型和实现 Riks-Crisfield 弧长法是标准且合理的操作。\n- **良态性：** 问题已完全指定。它提供了所有必要的数学模型、参数、初始条件和算法设置，以获得唯一的解路径。\n- **客观性：** 问题陈述是形式化的、定量的，并且没有歧义或主观声明。\n- **缺陷清单：**\n  1. **科学/事实不健全：** 无。提供的切线方程是反力定律的正确导数。所有单位都一致。\n  2. **非形式化/不相关：** 无。该问题是指定领域内直接且可形式化的数值任务。\n  3. **不完整/矛盾：** 无。设置是完整且自洽的。\n  4. **不现实/不可行：** 无。参数值的选择旨在产生物理上合理的行为（软化/硬化）。\n  5. **病态/结构不良：** 无。弧长法是专门为处理切线刚度 $K_t$ 为零的潜在极限点而选择的，这使得问题对于数值解是良态的。\n  6. **伪深刻/琐碎：** 无。该任务需要对非线性方程组的预测-校正算法进行非平凡的实现。\n  7G. **超出科学可验证性：** 无。结果可以被独立验证。\n\n**步骤3：结论与行动**\n该问题是有效且良态的。将开发一个解决方案。\n\n### 基于原理的解决方案设计\n\n问题的核心是实现一个 Crisfield 型弧长路径追踪算法。该方法对于分析可能表现出极限点（例如，最大荷载点后出现软化）的系统至关重要，在这些点上，标准的荷载控制或位移控制方法会失效。该方法通过一个约束方程来增强物理平衡方程，该约束方程引导解沿着荷载-位移空间中的平衡路径前进。\n\n对于沿路径的每一步 $n \\to n+1$，我们希望找到一个新的平衡点 $(u_{n+1}, \\lambda_{n+1})$，它与先前收敛的点 $(u_n, \\lambda_n)$ 相距一个预设的“距离” $\\Delta s$。这导致了一个关于两个未知数 $(u, \\lambda)$ 的两个非线性方程组：\n\n$1$. 平衡：$r(u, \\lambda) = q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0$\n$2$. 弧长约束：$g(u, \\lambda) = (u - u_n)^2 + \\psi (\\lambda - \\lambda_n)^2 - \\Delta s^2 = 0$\n\n在这里，$\\psi$ 是一个缩放因子，用于使约束中的两项量纲齐次且数量级相当。\n\n该系统使用基于牛顿法的预测-校正方案进行迭代求解。\n\n**1. 预测步**\n\n首先，通过沿当前点 $(u_n, \\lambda_n)$ 处路径的切线方向移动距离 $\\Delta s$，来对新点 $(u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)})$ 进行初始估计。切线向量 $(\\dot{u}, \\dot{\\lambda})$ 通过对平衡方程关于弧长参数 $s$ 求导得到：\n$$\n\\dfrac{dr}{ds} = \\dfrac{\\partial r}{\\partial u}\\dfrac{du}{ds} + \\dfrac{\\partial r}{\\partial \\lambda}\\dfrac{d\\lambda}{ds} = K_t \\dot{u} - P_{\\mathrm{ref}} \\dot{\\lambda} = 0\n$$\n切线向量相对于弧长度量也必须是单位长度：$\\dot{u}^2 + \\psi \\dot{\\lambda}^2 = 1$。结合这两个条件可以求解 $\\dot{u}$ 和 $\\dot{\\lambda}$。然后预测点为：\n$$\n(u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)}) = (u_n, \\lambda_n) + \\Delta s (\\dot{u}_n, \\dot{\\lambda}_n)\n$$\n选择切线向量的符号以确保路径以一致的方向继续，通常通过检查其与前一个切线向量的点积为正来实现。\n\n**2. 校正步**\n\n从预测点 $(u_k, \\lambda_k) = (u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)})$ 开始，我们使用牛顿法找到一个校正量 $(\\delta u, \\delta \\lambda)$，将两个方程的残差驱动至零。在每次牛顿迭代 $k$ 中需求解的线性系统是：\n$$\n\\mathbf{J}(\\mathbf{x}_k) \\Delta \\mathbf{x}_k = -\\mathbf{R}(\\mathbf{x}_k)\n$$\n其中 $\\mathbf{x}_k = [u_k, \\lambda_k]^T$ 是当前猜测值，$\\mathbf{R}(\\mathbf{x}_k) = [r(u_k, \\lambda_k), g(u_k, \\lambda_k)]^T$ 是残差向量，$\\mathbf{J}$ 是系统的雅可比矩阵：\n$$\n\\mathbf{J} =\n\\begin{bmatrix}\n\\frac{\\partial r}{\\partial u}  \\frac{\\partial r}{\\partial \\lambda} \\\\\n\\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial \\lambda}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nK_t(u)  -P_{\\mathrm{ref}} \\\\\n2(u - u_n)  2\\psi(\\lambda - \\lambda_n)\n\\end{bmatrix}\n$$\n解 $\\Delta \\mathbf{x}_k = [\\delta u, \\delta \\lambda]^T$ 用于更新猜测值：$\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\Delta \\mathbf{x}_k$。重复此迭代过程，直到残差向量的范数低于指定的容差。得到的收敛点是 $(u_{n+1}, \\lambda_{n+1})$。\n\n**3. 路径延续与分析**\n\n算法按指定的步数（$N_{\\mathrm{steps}} = 200$）进行，在每一步 $i$ 存储收敛点 $(u_i, \\lambda_i)$。当切线刚度 $K_t$ 在两个连续的收敛步之间改变符号时，检测到极限点，这表明平衡路径已达到荷载的局部极值。对于单调硬化的 MCC 模型，$K_t$ 始终为正，因此预计不会有极限点。对于软化的 $p$–$\\alpha$ 模型，可能存在极限点。完成所有步骤后，通过取存储的 $\\lambda_i$ 路径中的最大值来找到最大荷载因子 $\\max \\lambda$。然后为每个测试用例编译所需的输出。", "answer": "[[2494.43,1799.88,True,False],[2760.31,1099.99,True,False],[2744.83,900.00,True,False]]", "id": "3501082"}]}