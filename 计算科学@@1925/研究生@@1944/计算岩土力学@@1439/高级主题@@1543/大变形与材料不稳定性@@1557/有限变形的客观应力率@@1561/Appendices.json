{"hands_on_practices": [{"introduction": "要理解客观应力率的必要性，首先必须掌握大变形运动学的基本原理。本实践将通过一个经典的解析练习，深入剖析简单剪切变形，这在岩土力学中如断层滑动等场景中非常普遍。通过从第一性原理出发推导速度梯度、变形率张量和自旋张量，我们将揭示变形率与物质自旋之间非共轴性的根源，这正是定义客观应力率时遇到诸多困难的根本原因 [@problem_id:3546917]。", "problem": "考虑一个正在经历有限变形的连续体中的均匀单剪切变形，其变形梯度由 $\\,\\mathbf{F}(t) = \\mathbf{I} + \\gamma(t)\\,\\mathbf{e}_{1}\\otimes \\mathbf{e}_{2}\\,$ 给出，其中 $\\gamma(t)$ 是一个可微的剪切函数，$\\mathbf{I}$ 是单位张量，$\\mathbf{e}_{i}$ 是固定的标准正交基向量。根据有限变形中运动学量的定义，即速度梯度 $\\mathbf{L}(t) = \\dot{\\mathbf{F}}(t)\\,\\mathbf{F}(t)^{-1}$、变形率张量 $\\mathbf{D}(t) = \\tfrac{1}{2}\\left(\\mathbf{L}(t) + \\mathbf{L}(t)^{\\mathsf{T}}\\right)$ 和自旋张量 $\\mathbf{W}(t) = \\tfrac{1}{2}\\left(\\mathbf{L}(t) - \\mathbf{L}(t)^{\\mathsf{T}}\\right)$，推导 $\\mathbf{L}(t)$、$\\mathbf{D}(t)$ 和 $\\mathbf{W}(t)$ 的显式表达式。利用这些表达式，构建交换子 $[\\mathbf{D}(t),\\mathbf{W}(t)] = \\mathbf{D}(t)\\mathbf{W}(t) - \\mathbf{W}(t)\\mathbf{D}(t)$，并使用由 $\\|\\mathbf{A}\\|_{\\mathrm{F}} = \\sqrt{\\mathrm{tr}\\!\\left(\\mathbf{A}^{\\mathsf{T}}\\mathbf{A}\\right)}$ 定义的弗罗贝尼乌斯范数 $\\|\\cdot\\|_{\\mathrm{F}}$ 作为沿变形路径的非对易性的标量度量。简要解释 $\\mathbf{D}(t)$ 和 $\\mathbf{W}(t)$ 的非对易性如何影响计算岩土力学中客观应力率的使用。你的最终答案必须是标量度量 $\\|\\,[\\mathbf{D}(t),\\mathbf{W}(t)]\\,\\|_{\\mathrm{F}}$ 关于 $\\dot{\\gamma}(t)$ 的闭式解析表达式。无需四舍五入，也无需报告单位。", "solution": "在对其前提进行严格审查后，该问题被评估为有效。\n\n**问题验证**\n\n1.  **提取的已知条件：**\n    *   变形梯度：$\\mathbf{F}(t) = \\mathbf{I} + \\gamma(t)\\,\\mathbf{e}_{1}\\otimes \\mathbf{e}_{2}$。\n    *   剪切函数：$\\gamma(t)$ 是时间 $t$ 的可微函数。\n    *   基：$\\mathbf{e}_{i}$ 是固定的标准正交基向量。\n    *   单位张量：$\\mathbf{I}$。\n    *   速度梯度定义：$\\mathbf{L}(t) = \\dot{\\mathbf{F}}(t)\\,\\mathbf{F}(t)^{-1}$。\n    *   变形率张量定义：$\\mathbf{D}(t) = \\tfrac{1}{2}\\left(\\mathbf{L}(t) + \\mathbf{L}(t)^{\\mathsf{T}}\\right)$。\n    *   自旋张量定义：$\\mathbf{W}(t) = \\tfrac{1}{2}\\left(\\mathbf{L}(t) - \\mathbf{L}(t)^{\\mathsf{T}}\\right)$。\n    *   交换子定义：$[\\mathbf{D}(t),\\mathbf{W}(t)] = \\mathbf{D}(t)\\mathbf{W}(t) - \\mathbf{W}(t)\\mathbf{D}(t)$。\n    *   弗罗贝尼乌斯范数定义：$\\|\\mathbf{A}\\|_{\\mathrm{F}} = \\sqrt{\\mathrm{tr}\\!\\left(\\mathbf{A}^{\\mathsf{T}}\\mathbf{A}\\right)}$。\n    *   目标：推导 $\\|\\,[\\mathbf{D}(t),\\mathbf{W}(t)]\\,\\|_{\\mathrm{F}}$ 的显式表达式，并解释其在计算岩土力学中对客观应力率的意义。\n\n2.  **验证结论：**\n    *   该问题是**有科学依据的**。它是有限变形运动学中的一个标准练习，而有限变形运动学是连续介质力学的基石。所有给定的定义都是正确且被广泛使用的。\n    *   该问题是**适定的**。它自成体系，并提供了推导唯一解析解所需的所有必要信息。\n    *   该问题是**客观的**。它使用精确的数学语言表述，没有任何主观性或歧义。\n    *   该问题与其所述领域直接相关，因为 $\\mathbf{D}$ 和 $\\mathbf{W}$ 的非对易性是构建次弹性本构律和为经历大非共轴变形的材料选择客观应力率时的一个基本问题，而这类变形在岩土力学中普遍存在。\n\n未发现任何缺陷。我们可以继续进行求解。\n\n**运动学量的推导**\n\n我们将在固定的标准正交基 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 中使用张量的矩阵表示。并矢积 $\\mathbf{e}_1 \\otimes \\mathbf{e}_2$ 对应于一个在 $(1,2)$ 位置为 $1$、其余位置为零的矩阵。\n\n变形梯度 $\\mathbf{F}(t)$ 由下式给出：\n$$[\\mathbf{F}(t)] = [\\mathbf{I}] + \\gamma(t)[\\mathbf{e}_1 \\otimes \\mathbf{e}_2] = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\gamma(t) \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma(t)  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n\n首先，我们计算其时间导数 $\\dot{\\mathbf{F}}(t)$，其中点号表示对时间 $t$ 的微分。设 $\\dot{\\gamma}(t) = \\frac{d\\gamma}{dt}$。\n$$[\\dot{\\mathbf{F}}(t)] = \\frac{d}{dt} \\begin{pmatrix} 1  \\gamma(t)  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n在张量表示法中，$\\dot{\\mathbf{F}}(t) = \\dot{\\gamma}(t)\\,\\mathbf{e}_1 \\otimes \\mathbf{e}_2$。\n\n接下来，我们求 $\\mathbf{F}(t)$ 的逆。其行列式为 $\\det(\\mathbf{F}(t)) = 1$。逆矩阵为：\n$$[\\mathbf{F}(t)^{-1}] = \\begin{pmatrix} 1  -\\gamma(t)  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n在张量表示法中，$\\mathbf{F}(t)^{-1} = \\mathbf{I} - \\gamma(t)\\,\\mathbf{e}_1 \\otimes \\mathbf{e}_2$。\n\n现在，我们计算速度梯度 $\\mathbf{L}(t) = \\dot{\\mathbf{F}}(t)\\,\\mathbf{F}(t)^{-1}$：\n$$[\\mathbf{L}(t)] = [\\dot{\\mathbf{F}}(t)][\\mathbf{F}(t)^{-1}] = \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1  -\\gamma(t)  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n因此，在这个特定情况下，$\\mathbf{L}(t) = \\dot{\\mathbf{F}}(t) = \\dot{\\gamma}(t)\\,\\mathbf{e}_1 \\otimes \\mathbf{e}_2$。\n\n变形率张量 $\\mathbf{D}(t)$ 是 $\\mathbf{L}(t)$ 的对称部分：\n$$[\\mathbf{D}(t)] = \\frac{1}{2} \\left( [\\mathbf{L}(t)] + [\\mathbf{L}(t)]^{\\mathsf{T}} \\right) = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}(t)  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{\\dot{\\gamma}(t)}{2} \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n\n自旋张量 $\\mathbf{W}(t)$ 是 $\\mathbf{L}(t)$ 的反对称部分：\n$$[\\mathbf{W}(t)] = \\frac{1}{2} \\left( [\\mathbf{L}(t)] - [\\mathbf{L}(t)]^{\\mathsf{T}} \\right) = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}(t)  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{\\dot{\\gamma}(t)}{2} \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n\n**交换子与弗罗贝尼乌斯范数**\n\n我们现在构建交换子 $[\\mathbf{D}(t),\\mathbf{W}(t)] = \\mathbf{D(t)}\\mathbf{W}(t) - \\mathbf{W}(t)\\mathbf{D}(t)$。\n首先，我们计算乘积 $\\mathbf{D}(t)\\mathbf{W}(t)$：\n$$[\\mathbf{D}(t)\\mathbf{W}(t)] = \\left( \\frac{\\dot{\\gamma}(t)}{2} \\right)^2 \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\frac{\\dot{\\gamma}(t)^2}{4} \\begin{pmatrix} -1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n接下来，我们计算乘积 $\\mathbf{W}(t)\\mathbf{D}(t)$：\n$$[\\mathbf{W}(t)\\mathbf{D}(t)] = \\left( \\frac{\\dot{\\gamma}(t)}{2} \\right)^2 \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\frac{\\dot{\\gamma}(t)^2}{4} \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n交换子是这两个结果的差：\n$$[\\mathbf{D}(t),\\mathbf{W}(t)] = \\frac{\\dot{\\gamma}(t)^2}{4} \\left( \\begin{pmatrix} -1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{\\dot{\\gamma}(t)^2}{4} \\begin{pmatrix} -2  0  0 \\\\ 0  2  0 \\\\ 0  0  0 \\end{pmatrix} = \\frac{\\dot{\\gamma}(t)^2}{2} \\begin{pmatrix} -1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n\n最后，我们计算这个交换子的弗罗贝尼乌斯范数 $\\|\\,[\\mathbf{D}(t),\\mathbf{W}(t)]\\,\\|_{\\mathrm{F}}$。弗罗贝尼乌斯范数是矩阵元素平方和的平方根。设 $\\mathbf{A} = [\\mathbf{D}(t),\\mathbf{W}(t)]$。\n$$\\|\\mathbf{A}\\|_{\\mathrm{F}}^2 = \\left(-\\frac{\\dot{\\gamma}(t)^2}{2}\\right)^2 + \\left(\\frac{\\dot{\\gamma}(t)^2}{2}\\right)^2 + 0^2 + \\dots = \\frac{\\dot{\\gamma}(t)^4}{4} + \\frac{\\dot{\\gamma}(t)^4}{4} = \\frac{2\\dot{\\gamma}(t)^4}{4} = \\frac{\\dot{\\gamma}(t)^4}{2}$$\n取平方根得到范数：\n$$\\|\\mathbf{A}\\|_{\\mathrm{F}} = \\sqrt{\\frac{\\dot{\\gamma}(t)^4}{2}} = \\frac{\\sqrt{\\dot{\\gamma}(t)^4}}{\\sqrt{2}} = \\frac{\\dot{\\gamma}(t)^2}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\\dot{\\gamma}(t)^2$$\n\n**对计算岩土力学中客观应力率的意义**\n\n由 $\\|\\,[\\mathbf{D}(t),\\mathbf{W}(t)]\\,\\|_{\\mathrm{F}}$ 的非零结果所量化的变形率张量 $\\mathbf{D}(t)$ 和自旋张量 $\\mathbf{W}(t)$ 的非对易性，在有限变形本构律的构建中具有根本性的重要意义。柯西应力张量 $\\boldsymbol{\\sigma}$ 的时间导数不是客观的（即，它是依赖于参考系的）。为了建立具有物理意义的材料定律，必须使用客观应力率 $\\overset{\\triangledown}{\\boldsymbol{\\sigma}}$，例如 Jaumann 率 $\\overset{\\triangledown}{\\boldsymbol{\\sigma}}_{\\mathrm{J}} = \\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W}$。然后，该应力率与变形率相关联，例如，通过次弹性定律 $\\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\mathcal{C}[\\mathbf{D}]$。\n\n问题的出现是因为对于一个经历闭合变形循环（例如，施加然后反转的单剪切）的弹性材料，应力状态应在没有净功的情况下恢复到其初始值。然而，对于像单剪切这样 $[\\mathbf{D}, \\mathbf{W}] \\neq \\mathbf{0}$ 的变形，许多常见的客观应力率，包括 Jaumann 率，都会预测出虚假的、非物理的应力响应和在闭合循环中产生或耗散的能量。这是因为应力主轴（其倾向于与应变/应变率主轴对齐）的旋转与材料本身的旋转（由 $\\mathbf{W}$ 描述）不同，这一事实的直接后果。交换子 $[\\mathbf{D}, \\mathbf{W}]$ 是材料自旋与 $\\mathbf{D}$ 主轴自旋之间非共轴性的度量。\n\n在计算岩土力学中，断层滑移、剪切带和土壤液化等现象涉及大的、持续的剪切变形。在数值模型中使用不恰当的客观应力率会导致预测应力演化、材料稳定性和破坏时出现重大误差。$\\|\\,[\\mathbf{D},\\mathbf{W}]\\,\\|_{\\mathrm{F}}$ 的大小与 $\\dot{\\gamma}(t)^2$ 成正比，表明这个问题在更高的剪切率下变得更加显著。这就要求仔细选择客观应力率，或使用替代的本构框架（例如，在参考构形中建立的超弹性理论），以确保物理上正确的模拟。", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{2}\\dot{\\gamma}(t)^2}$$", "id": "3546917"}, {"introduction": "任何本构模型的基石之一是物质标架无关性原理，即材料的响应不应依赖于观测者的刚体运动。本计算实践旨在通过一个“单元试验”（patch test）来验证数值实现是否遵循了这一基本原理。你将编写程序模拟一个纯刚体旋转过程，并检验一个正确实现了客观率的应力更新算法是否能如预期般产生零应力增量，这是确保有限变形模拟数值稳定性的关键一步 [@problem_id:3546931]。", "problem": "设计一个计算性补丁测试，以验证客观应力率在零变形的均匀刚体旋转下的不变性。其目标是证明，在纯旋转过程中，使用客观应力率的有限元实现在共旋坐标系中产生零应力增量，这是计算岩土力学中有限变形模拟数值稳定性的一个必要属性。\n\n从基本定义开始。考虑一个三维连续体正在经历一个具有恒定角速度矢量 $\\boldsymbol{\\omega}$ 的刚体旋转，其速度场由 $\\boldsymbol{v}(\\boldsymbol{x}) = \\boldsymbol{\\omega} \\times \\boldsymbol{x}$ 给出。空间速度梯度 $\\boldsymbol{L}$ 是 $\\boldsymbol{v}$ 相对于 $\\boldsymbol{x}$ 的雅可比矩阵。对于刚体旋转，对称的变形率张量 $\\boldsymbol{D} = \\tfrac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^\\mathsf{T})$ 恒等于零，而反对称的自旋张量 $\\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^\\mathsf{T})$ 等于 $\\boldsymbol{L}$。通过斜对称叉积表示法从 $\\boldsymbol{\\omega}$ 构建 $\\boldsymbol{W}$，使得对于任意矢量 $\\boldsymbol{x}$，都有 $\\boldsymbol{W}\\boldsymbol{x} = \\boldsymbol{\\omega} \\times \\boldsymbol{x}$。\n\n令 $\\boldsymbol{Q}(t)$ 为满足 $\\dot{\\boldsymbol{Q}}(t) = \\boldsymbol{W}\\boldsymbol{Q}(t)$ 和 $\\boldsymbol{Q}(0) = \\boldsymbol{I}$ 的正交旋转，从而得到 $\\boldsymbol{Q}(t) = \\exp(\\boldsymbol{W}t)$。在纯刚体旋转下，Cauchy 应力 $\\boldsymbol{\\sigma}(t)$ 通过 $\\boldsymbol{\\sigma}(t) = \\boldsymbol{Q}(t)\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{Q}^\\mathsf{T}(t)$ 与初始 Cauchy 应力 $\\boldsymbol{\\sigma}_0$ 相关联。在由 $\\widehat{\\boldsymbol{\\sigma}}(t) = \\boldsymbol{Q}^\\mathsf{T}(t)\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{Q}(t)$ 定义的共旋坐标系中，当 $\\boldsymbol{D} = \\boldsymbol{0}$ 并且采用适当的客观应力率时，应力应保持恒定。\n\n您的任务是编写一个完整、可运行的程序，针对一组指定的测试用例，执行以下操作：\n\n1.  根据给定的角速度矢量 $\\boldsymbol{\\omega}$，构建反对称自旋张量 $\\boldsymbol{W}$。\n2.  对于给定的时间步长 $\\Delta t$，计算旋转 $\\boldsymbol{Q}(\\Delta t) = \\exp(\\boldsymbol{W}\\,\\Delta t)$。\n3.  在总时间 $T$ 内，以 $N$ 个相等的步长传播旋转，其中 $N = T/\\Delta t$ 是一个整数，更新 $\\boldsymbol{Q}_n$ 和空间 Cauchy 应力 $\\boldsymbol{\\sigma}_n = \\boldsymbol{Q}_n\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{Q}_n^\\mathsf{T}$。\n4.  计算每一步的共旋应力 $\\widehat{\\boldsymbol{\\sigma}}_n = \\boldsymbol{Q}_n^\\mathsf{T}\\,\\boldsymbol{\\sigma}_n\\,\\boldsymbol{Q}_n$，并确定在所有时间步长上离散共旋应力率的最大 Frobenius 范数，定义为 $\\max_n \\left\\| (\\widehat{\\boldsymbol{\\sigma}}_{n+1} - \\widehat{\\boldsymbol{\\sigma}}_n)/\\Delta t \\right\\|_F$。如果客观应力率实现正确，该值应约等于零。\n5.  为了进行比较，计算朴素空间应力率的最大 Frobenius 范数 $\\max_n \\left\\| (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}_n)/\\Delta t \\right\\|_F$，除非 $\\boldsymbol{\\omega} = \\boldsymbol{0}$ 或 $\\boldsymbol{\\sigma}_0 = \\boldsymbol{0}$，否则在旋转下该值不必为零。\n\n单位和数值检查：\n- 角速度以弧度/秒 (rad/s) 表示，时间以秒 (s) 表示，应力以帕斯卡 (Pa) 表示。\n- 使用 Frobenius 范数，其隐含单位与应力率一致，即帕斯卡/秒 (Pa/s)。\n- 使用容差 $\\varepsilon_\\text{obj}$ 来检查共旋客观增量：如果最大共旋应力率小于或等于 $\\varepsilon_\\text{obj}$ (单位 Pa/s)，则声明客观测试通过。\n- 使用阈值 $\\varepsilon_\\text{naive}$ 来检查朴素空间应力率是否可检测地非零：如果最大朴素空间应力率大于或等于 $\\varepsilon_\\text{naive}$ (单位 Pa/s)，则声明朴素检查为真。\n\n测试套件：\n- 情况 1：$\\boldsymbol{\\sigma}_0 = \\mathrm{diag}(100000, 50000, 25000)$ Pa，$\\boldsymbol{\\omega} = (0, 0, 1)$ rad/s，$T = 1.0$ s，$\\Delta t = 0.01$ s。\n- 情况 2：$\\boldsymbol{\\sigma}_0 = \\begin{bmatrix}80000  30000  0\\\\ 30000  120000  0\\\\ 0  0  60000\\end{bmatrix}$ Pa，$\\boldsymbol{\\omega} = (0.2, -0.1, 0.5)$ rad/s，$T = 2.0$ s，$\\Delta t = 0.02$ s。\n- 情况 3：$\\boldsymbol{\\sigma}_0 = \\boldsymbol{0}$ Pa，$\\boldsymbol{\\omega} = (10, 0, 0)$ rad/s，$T = 0.1$ s，$\\Delta t = 0.001$ s。\n- 情况 4：$\\boldsymbol{\\sigma}_0 = \\begin{bmatrix}0  50000  0\\\\ 50000  0  0\\\\ 0  0  0\\end{bmatrix}$ Pa，$\\boldsymbol{\\omega} = (0, 1000, 0)$ rad/s，$T = 0.01$ s，$\\Delta t = 0.00001$ s。\n\n客观检查使用 $\\varepsilon_\\text{obj} = 1.0\\times10^{-8}$ Pa/s，朴素检查使用 $\\varepsilon_\\text{naive} = 10.0$ Pa/s。\n\n最终输出格式：\n- 对于每个测试用例，按顺序产生两个布尔结果：首先是客观检查结果，然后是朴素检查结果。\n- 您的程序应生成一行输出，其中包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots,r_8]$，其中 $r_{2k-1}$ 是用例 $k$ 的客观结果，$r_{2k}$ 是其朴素检查结果）。", "solution": "材料坐标无关性原理是连续介质力学的基石，它要求描述材料行为的本构方程必须与观察者的刚体运动无关。这需要在任何率形式的本构律中使用张量（如应力）的客观时间导数（率）。一个客观应力率是在连续体纯刚体运动期间会消失的率，因为此时没有发生真正的变形。此计算性补丁测试旨在验证共旋应力格式的数值实现是否正确遵守此原理。\n\n该测试模拟了一个具有初始 Cauchy 应力 $\\boldsymbol{\\sigma}_0$ 的物质点的纯刚体旋转。对于具有恒定角速度矢量 $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2, \\omega_3)^\\mathsf{T}$ 的刚体旋转，其速度场由 $\\boldsymbol{v}(\\boldsymbol{x}) = \\boldsymbol{\\omega} \\times \\boldsymbol{x}$ 给出。空间速度梯度 $\\boldsymbol{L} = \\nabla\\boldsymbol{v}$ 可以分解为其对称部分（变形率张量 $\\boldsymbol{D}$）和反对称部分（自旋张量 $\\boldsymbol{W}$）。对于此速度场，我们发现 $\\boldsymbol{D} = \\boldsymbol{0}$，表示没有变形，而 $\\boldsymbol{W}$ 是与轴矢量 $\\boldsymbol{\\omega}$ 唯一关联的斜对称张量，使得 $\\boldsymbol{W}\\boldsymbol{x} = \\boldsymbol{\\omega} \\times \\boldsymbol{x}$。$\\boldsymbol{W}$ 的矩阵形式为：\n$$ \\boldsymbol{W} = \\begin{bmatrix} 0  -\\omega_3  \\omega_2 \\\\ \\omega_3  0  -\\omega_1 \\\\ -\\omega_2  \\omega_1  0 \\end{bmatrix} $$\n物质单元的方向由一个正交旋转张量 $\\boldsymbol{Q}(t)$ 描述，它根据微分方程 $\\dot{\\boldsymbol{Q}}(t) = \\boldsymbol{W}\\boldsymbol{Q}(t)$ 和初始条件 $\\boldsymbol{Q}(0) = \\boldsymbol{I}$ 演化。对于恒定的 $\\boldsymbol{W}$，解是矩阵指数 $\\boldsymbol{Q}(t) = \\exp(\\boldsymbol{W}t)$。\n\n在此旋转下，固定空间坐标系中的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 从其初始状态 $\\boldsymbol{\\sigma}_0$ 通过前推操作演化：\n$$ \\boldsymbol{\\sigma}(t) = \\boldsymbol{Q}(t)\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{Q}^\\mathsf{T}(t) $$\n共旋应力张量 $\\widehat{\\boldsymbol{\\sigma}}$ 定义在随材料旋转的坐标系中。它是通过用旋转 $\\boldsymbol{Q}(t)$ 对空间 Cauchy 应力 $\\boldsymbol{\\sigma}(t)$ 进行后拉操作得到的：\n$$ \\widehat{\\boldsymbol{\\sigma}}(t) = \\boldsymbol{Q}^\\mathsf{T}(t)\\,\\boldsymbol{\\sigma}(t)\\,\\boldsymbol{Q}(t) $$\n将 $\\boldsymbol{\\sigma}(t)$ 的表达式代入此定义，展示了该补丁测试的分析基础：\n$$ \\widehat{\\boldsymbol{\\sigma}}(t) = \\boldsymbol{Q}^\\mathsf{T}(t) \\left( \\boldsymbol{Q}(t)\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{Q}^\\mathsf{T}(t) \\right) \\boldsymbol{Q}(t) = \\left(\\boldsymbol{Q}^\\mathsf{T}(t)\\boldsymbol{Q}(t)\\right) \\boldsymbol{\\sigma}_0 \\left(\\boldsymbol{Q}^\\mathsf{T}(t)\\boldsymbol{Q}(t)\\right) $$\n由于 $\\boldsymbol{Q}(t)$ 是一个正交张量，$\\boldsymbol{Q}^\\mathsf{T}(t)\\boldsymbol{Q}(t) = \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量。因此，我们发现：\n$$ \\widehat{\\boldsymbol{\\sigma}}(t) = \\boldsymbol{I}\\,\\boldsymbol{\\sigma}_0\\,\\boldsymbol{I} = \\boldsymbol{\\sigma}_0 $$\n这表明在整个刚体运动过程中，共旋应力必须保持恒定并等于初始应力 $\\boldsymbol{\\sigma}_0$。因此，任何客观应力率，即 $\\widehat{\\boldsymbol{\\sigma}}$ 的时间导数，都必须恒等于零。\n\n数值验证通过将总旋转时间 $T$ 离散化为 $N$ 个持续时间为 $\\Delta t = T/N$ 的相等步长来进行。单时间步长内的旋转由常数矩阵 $\\boldsymbol{Q}_{\\Delta t} = \\exp(\\boldsymbol{W}\\Delta t)$ 给出。时间 $t_n = n\\Delta t$ 处的状态由 $\\boldsymbol{Q}_n$ 和 $\\boldsymbol{\\sigma}_n$ 描述。对 $n = 0, 1, \\dots, N-1$ 进行迭代更新：\n$$ \\boldsymbol{Q}_{n+1} = \\boldsymbol{Q}_{\\Delta t} \\boldsymbol{Q}_n $$\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{Q}_{\\Delta t} \\boldsymbol{\\sigma}_n \\boldsymbol{Q}_{\\Delta t}^\\mathsf{T} $$\n从 $\\boldsymbol{Q}_0 = \\boldsymbol{I}$ 和 $\\boldsymbol{\\sigma}_0$ 开始。在每一步，我们计算共旋应力 $\\widehat{\\boldsymbol{\\sigma}}_n = \\boldsymbol{Q}_n^\\mathsf{T}\\boldsymbol{\\sigma}_n\\boldsymbol{Q}_n$ 和 $\\widehat{\\boldsymbol{\\sigma}}_{n+1} = \\boldsymbol{Q}_{n+1}^\\mathsf{T}\\boldsymbol{\\sigma}_{n+1}\\boldsymbol{Q}_{n+1}$。\n\n客观测试验证了数值计算出的共旋应力率接近于零。我们使用有限差分来近似此率，并检查其在所有时间步长上的最大 Frobenius 范数是否受一个小的容差 $\\varepsilon_\\text{obj}$ 限制，以考虑浮点运算误差：\n$$ \\max_{n=0,\\dots,N-1} \\left\\| \\frac{\\widehat{\\boldsymbol{\\sigma}}_{n+1} - \\widehat{\\boldsymbol{\\sigma}}_n}{\\Delta t} \\right\\|_F \\le \\varepsilon_\\text{obj} $$\n作为比较，我们还计算了固定空间坐标系中的朴素应力率，近似为 $(\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}_n) / \\Delta t$。该率不是客观的，对于非平凡的 $\\boldsymbol{\\sigma}_0$ 和 $\\boldsymbol{\\omega}$，通常预期为非零。测试的第二部分通过检查其最大 Frobenius 范数是否可检测地非零来验证这一点，即大于阈值 $\\varepsilon_\\text{naive}$：\n$$ \\max_{n=0,\\dots,N-1} \\left\\| \\frac{\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}_n}{\\Delta t} \\right\\|_F \\ge \\varepsilon_\\text{naive} $$\n同时通过这两个检查，证实了该实现在纯刚体旋转下，对于客观率正确地计算了零应力增量，而对于非客观率则正确地捕捉到了非零增量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run the computational patch test for all specified cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"sigma0\": np.array([\n                [100000., 0., 0.],\n                [0., 50000., 0.],\n                [0., 0., 25000.]\n            ]),\n            \"omega\": np.array([0., 0., 1.]),\n            \"T\": 1.0,\n            \"dt\": 0.01,\n        },\n        {\n            \"sigma0\": np.array([\n                [80000., 30000., 0.],\n                [30000., 120000., 0.],\n                [0., 0., 60000.]\n            ]),\n            \"omega\": np.array([0.2, -0.1, 0.5]),\n            \"T\": 2.0,\n            \"dt\": 0.02,\n        },\n        {\n            \"sigma0\": np.zeros((3, 3)),\n            \"omega\": np.array([10., 0., 0.]),\n            \"T\": 0.1,\n            \"dt\": 0.001,\n        },\n        {\n            \"sigma0\": np.array([\n                [0., 50000., 0.],\n                [50000., 0., 0.],\n                [0., 0., 0.]\n            ]),\n            \"omega\": np.array([0., 1000., 0.]),\n            \"T\": 0.01,\n            \"dt\": 0.00001,\n        }\n    ]\n\n    # Define tolerances\n    epsilon_obj = 1.0e-8\n    epsilon_naive = 10.0\n\n    results = []\n    for case in test_cases:\n        obj_check, naive_check = run_patch_test(\n            case[\"sigma0\"],\n            case[\"omega\"],\n            case[\"T\"],\n            case[\"dt\"],\n            epsilon_obj,\n            epsilon_naive\n        )\n        results.extend([obj_check, naive_check])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef construct_spin_tensor(omega):\n    \"\"\"\n    Constructs the antisymmetric spin tensor W from an angular velocity vector omega.\n    W * x = omega x x\n    \"\"\"\n    w1, w2, w3 = omega\n    return np.array([\n        [0., -w3, w2],\n        [w3, 0., -w1],\n        [-w2, w1, 0.]\n    ])\n\ndef run_patch_test(sigma0, omega, T, dt, eps_obj, eps_naive):\n    \"\"\"\n    Performs the patch test for a single case.\n    \"\"\"\n    # 1. Calculate number of steps\n    if not np.isclose(T / dt, round(T / dt)):\n        raise ValueError(\"T/dt must be an integer.\")\n    num_steps = int(round(T / dt))\n\n    # 2. Construct spin tensor and incremental rotation matrix\n    W = construct_spin_tensor(omega)\n    Q_step = expm(W * dt)\n\n    # Initialize loop variables\n    Q_n = np.identity(3)\n    sigma_n = np.copy(sigma0)\n    \n    max_obj_rate_norm = 0.0\n    max_naive_rate_norm = 0.0\n\n    # 3. Propagate rotation over N steps\n    for _ in range(num_steps):\n        # State at step n\n        Q_prev = Q_n\n        sigma_prev = sigma_n\n        \n        # Update state to step n+1\n        Q_n = Q_step @ Q_prev\n        sigma_n = Q_step @ sigma_prev @ Q_step.T\n\n        # 4. Compute co-rotational stresses\n        hat_sigma_n_prev = Q_prev.T @ sigma_prev @ Q_prev\n        hat_sigma_n_curr = Q_n.T @ sigma_n @ Q_n\n        \n        # 5. Compute rates and their norms\n        objective_rate = (hat_sigma_n_curr - hat_sigma_n_prev) / dt\n        naive_rate = (sigma_n - sigma_prev) / dt\n        \n        obj_rate_norm = np.linalg.norm(objective_rate, 'fro')\n        naive_rate_norm = np.linalg.norm(naive_rate, 'fro')\n\n        if obj_rate_norm > max_obj_rate_norm:\n            max_obj_rate_norm = obj_rate_norm\n        \n        if naive_rate_norm > max_naive_rate_norm:\n            max_naive_rate_norm = naive_rate_norm\n\n    # 6. Perform checks against tolerances\n    objective_check = max_obj_rate_norm = eps_obj\n    \n    # The naive rate is expected to be non-zero only if both the initial stress\n    # and the rotation are non-zero.\n    if np.allclose(sigma0, 0) or np.allclose(omega, 0):\n        naive_check = max_naive_rate_norm  eps_naive # Should be zero\n    else:\n        naive_check = max_naive_rate_norm >= eps_naive\n    \n    return objective_check, naive_check\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3546931"}, {"introduction": "即便某个应力率（如Jaumann率）满足了刚体旋转下的客观性要求，它在更复杂的加载路径下仍可能产生非物理的预测。本实践将通过一个数值模拟，清晰地展示这一著名缺陷。你将实现一个采用Jaumann率的次弹性模型，并模拟一个闭合的运动学循环（剪切→旋转→反剪切→反向旋转），从而亲手量化由于模型路径依赖性而产生的“伪”残余应力 [@problem_id:3546986]。", "problem": "考虑一个经历有限变形的均质、各向同性、可压缩连续体，其承受一个重复的两步加载序列以形成一个闭合循环：首先是平面内的简单剪切，然后是绕平面外轴的刚性旋转；接着是在旋转后的坐标系中施加反剪切，然后是反向旋转回到原始坐标系。目标是实现一个采用 Zaremba–Jaumann 客观应力率的、基于率的次弹性本构模型，并量化完成循环后的残余应力，以评估路径依赖性。\n\n从以下空间（当前）构型中的基本定义和运动学出发：\n- 速度梯度为 $\\mathbf{L} = \\nabla \\mathbf{v}$。\n- 对称部分（变形率张量）为 $\\mathbf{d} = \\tfrac{1}{2}\\left(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}}\\right)$。\n- 反对称部分（涡量张量）为 $\\boldsymbol{\\omega} = \\tfrac{1}{2}\\left(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}}\\right)$。\n- 任意二阶张量 $\\mathbf{A}$ 的偏量部分为 $\\mathrm{dev}(\\mathbf{A}) = \\mathbf{A} - \\tfrac{1}{3}\\mathrm{tr}(\\mathbf{A})\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量，$\\mathrm{tr}(\\cdot)$ 表示迹。\n- 柯西应力 $\\boldsymbol{\\sigma}$ 的 Zaremba–Jaumann 客观应力率定义为 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{\\omega}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{\\omega}$。\n- 变形梯度 $\\mathbf{F}$ 根据 $\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}$ 演化，且 $\\mathbf{F}(t=0) = \\mathbf{I}$。\n\n假设材料为各向同性线性次弹性，其客观应力率与变形率张量呈线性关系。使用两个独立的弹性模量：体积模量 $K$ 和剪切模量 $G$（单位均为帕斯卡）。仅从各向同性、线性以及将 $\\mathbf{d}$ 分解为体积和偏量部分出发，推导以 $\\mathbf{d}$、$K$ 和 $G$ 表示的 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla}$ 的线性各向同性本构关系的显式形式。\n\n使用时间推进格式对本构方程和运动学方程进行数值积分，积分路径包含四个阶段，共同构成一个闭合的运动学循环（净 $\\mathbf{F}$ 在数值公差范围内应为单位张量）。所有运动均在三维空间中进行，但限制在 $x$-$y$ 平面内（$z$ 分量保持为零）：\n\n1. 阶段 A（简单剪切）：在 $x$-$y$ 平面内施加一个恒定的简单剪切率 $\\dot{\\gamma}$，持续时间为 $T_s$，产生总剪切量 $\\gamma = \\dot{\\gamma} T_s$。使用以下速度梯度\n$$\n\\mathbf{L}_s = \\begin{bmatrix}\n0  \\dot{\\gamma}  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n\n2. 阶段 B（刚性旋转）：绕 $z$ 轴施加一个恒定的刚体旋转速率 $\\dot{\\theta}$，持续时间为 $T_r$，产生总旋转角 $\\theta = \\dot{\\theta} T_r$。使用以下速度梯度\n$$\n\\mathbf{L}_r = \\begin{bmatrix}\n0  -\\dot{\\theta}  0 \\\\\n\\dot{\\theta}  0  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n\n3. 阶段 C（在旋转坐标系中反剪切）：施加一个大小为 $-\\gamma$ 的反剪切，但其方向与相对于原始坐标系旋转了角度 $\\theta$ 的坐标系对齐。通过将速度梯度恒定保持为\n$$\n\\mathbf{L}_{u} = \\mathbf{R}(\\theta)\\,\n\\begin{bmatrix}\n0  -\\dot{\\gamma}  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{bmatrix}\n\\,\\mathbf{R}(\\theta)^{\\mathsf{T}},\n$$\n来实现，持续时间同样为 $T_s$，其中\n$$\n\\mathbf{R}(\\theta) = \\begin{bmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\cos\\theta  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n是绕 $z$ 轴的旋转张量。\n\n4. 阶段 D（反向旋转）：施加一个反向旋转速率 $-\\dot{\\theta}$，持续时间为 $T_r$，即\n$$\n\\mathbf{L}_{-r} = \\begin{bmatrix}\n0  \\dot{\\theta}  0 \\\\\n-\\dot{\\theta}  0  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n\n所有阶段均取 $T_s = 1\\,\\mathrm{s}$ 和 $T_r = 1\\,\\mathrm{s}$。从零初始应力 $\\boldsymbol{\\sigma}(t=0) = \\mathbf{0}$ 开始。采用显式时间积分方法，每个阶段使用统一数量的时间步长。在每个时间步，使用推导出的次弹性关系和 Jaumann 客观率更新柯西应力，并使用 $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$ 更新变形梯度。\n\n将完成整个四阶段循环后的残余应力定义为 von Mises 等效应力\n$$\n\\sigma_{\\mathrm{vm}} = \\sqrt{\\tfrac{3}{2}\\,\\mathrm{dev}(\\boldsymbol{\\sigma}):\\mathrm{dev}(\\boldsymbol{\\sigma})},\n$$\n其中 $:$ 表示 Frobenius 内积。以帕斯卡（Pa）为单位，将 $\\sigma_{\\mathrm{vm}}$ 报告为浮点数。\n\n角度单位必须是弧度。所有与应力相关的量必须以帕斯卡表示。使用以下测试用例集，每个用例由 $(K, G, \\gamma, \\theta, N_s, N_r)$ 指定，其中 $N_s$ 和 $N_r$ 分别是剪切和旋转阶段使用的时间步数：\n\n- 用例 1（一般情况）： $(5.0\\times 10^{10}, 3.0\\times 10^{10}, 0.2, 0.5, 400, 400)$。\n- 用例 2（小幅值）： $(2.0\\times 10^{10}, 1.0\\times 10^{10}, 0.05, 0.1, 200, 200)$。\n- 用例 3（无旋转基准）： $(5.0\\times 10^{10}, 3.0\\times 10^{10}, 0.2, 0.0, 400, 400)$。\n- 用例 4（大旋转和大剪切）： $(1.0\\times 10^{11}, 4.0\\times 10^{10}, 0.5, \\tfrac{\\pi}{2}, 800, 800)$。\n\n您的程序应生成单行输出，其中包含上述用例的残余 von Mises 应力，形式为方括号内由逗号分隔的列表（例如，\"[result1,result2,result3,result4]\"），每个结果都是以帕斯卡为单位的浮点数。不得打印任何其他文本。", "solution": "用户提供的问题是计算连续介质力学中一个有效的练习。它要求推导一个标准的次弹性本构律，并沿指定的有限变形路径对其进行数值积分，以证明此类模型的路径依赖性。所有必要的参数和定义都已提供，该问题在科学上是合理且适定的。\n\n### 第一部分：各向同性次弹性本构关系的推导\n\n问题指定了一种各向同性线性次弹性材料。其本构关系是从变形率张量 $\\mathbf{d}$ 到客观应力率（此处为 Zaremba–Jaumann 率 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla}$）的线性映射。\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\mathbb{C} : \\mathbf{d}\n$$\n其中 $\\mathbb{C}$ 是一个四阶弹性张量。对于各向同性材料，$\\mathbb{C}$ 必须是一个各向同性张量。将对称二阶张量映射到对称二阶张量的各向同性四阶张量的一般形式为：\n$$\n\\mathbb{C} = \\lambda \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\text{sym}}\n$$\n其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数，$\\mathbf{I}$ 是二阶单位张量，$\\mathbb{I}_{\\text{sym}}$ 是对称四阶单位张量。其分量形式为 $\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$。\n\n将此应用于 $\\mathbf{d}$，可得到直接符号表示的关系式：\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\lambda \\, \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2\\mu \\mathbf{d}\n$$\n问题指定使用体积模量 $K$ 和剪切模量 $G$。它们与 Lamé 参数相关。剪切模量与第二个 Lamé 参数相同，因此 $\\mu = G$。\n\n为了用 $K$ 和 $G$ 表示 $\\lambda$，我们考虑纯体积变形。对本构方程取迹：\n$$\n\\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}}^{\\nabla}) = \\mathrm{tr}(\\lambda \\, \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\mathbf{d}) = 3\\lambda \\, \\mathrm{tr}(\\mathbf{d}) + 2G \\, \\mathrm{tr}(\\mathbf{d}) = (3\\lambda + 2G)\\mathrm{tr}(\\mathbf{d})\n$$\n任何客观应力率的迹都等于应力物质时间导数的迹，即 $\\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}}^{\\nabla}) = \\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}})$。体积模量 $K$ 将平均应力变化率 $\\dot{p} = \\frac{1}{3}\\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}})$ 与体积应变率 $\\mathrm{tr}(\\mathbf{d})$ 联系起来。\n$$\n\\dot{p} = K \\, \\mathrm{tr}(\\mathbf{d}) \\implies \\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}}) = 3K \\, \\mathrm{tr}(\\mathbf{d})\n$$\n令 $\\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}})$ 的两个表达式相等，可得：\n$$\n3K = 3\\lambda + 2G \\implies \\lambda = K - \\frac{2}{3}G\n$$\n将这些代入本构律中，得到：\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\left(K - \\frac{2}{3}G\\right) \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\mathbf{d}\n$$\n根据问题的建议，这可以利用 $\\mathbf{d}$ 的体积和偏量分解重新表达，其中 $\\mathbf{d} = \\mathrm{dev}(\\mathbf{d}) + \\frac{1}{3}\\mathrm{tr}(\\mathbf{d})\\mathbf{I}$：\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\left(K - \\frac{2}{3}G\\right) \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\left(\\mathrm{dev}(\\mathbf{d}) + \\frac{1}{3}\\mathrm{tr}(\\mathbf{d})\\mathbf{I}\\right)\n$$\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\left(K - \\frac{2}{3}G + \\frac{2}{3}G\\right) \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\, \\mathrm{dev}(\\mathbf{d})\n$$\n简化后得到最终的、物理上直观的形式：\n$$\n\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = K \\, \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\, \\mathrm{dev}(\\mathbf{d})\n$$\n这就是所要求的次弹性本构关系。\n\n### 第二部分：数值积分方案\n\n我们采用显式前向欧拉时间推进格式来对柯西应力 $\\boldsymbol{\\sigma}$ 和变形梯度 $\\mathbf{F}$ 的演化方程进行积分。对于时间步长 $\\Delta t$，从第 $n$ 步到第 $n+1$ 步的更新如下：\n\n1.  **变形梯度更新：**\n    演化由 $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$ 给出。离散化后得到：\n    $$\n    \\mathbf{F}_{n+1} = \\mathbf{F}_n + \\Delta t \\, (\\mathbf{L} \\mathbf{F}_n) = (\\mathbf{I} + \\Delta t \\, \\mathbf{L}) \\mathbf{F}_n\n    $$\n\n2.  **柯西应力更新：**\n    演化由 Zaremba-Jaumann 率的定义给出，$\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{\\omega}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{\\omega}$，重新排列以求得物质时间导数 $\\dot{\\boldsymbol{\\sigma}}$：\n    $$\n    \\dot{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}}^{\\nabla} + \\boldsymbol{\\omega}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{\\omega}\n    $$\n    项 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla}$ 由上面推导的本构律确定。张量 $\\mathbf{d}$ 和 $\\boldsymbol{\\omega}$ 是速度梯度 $\\mathbf{L}$ 的对称和反对称部分，在加载路径的每个阶段内 $\\mathbf{L}$ 是恒定的。\n    应力更新则为：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\Delta t \\, \\dot{\\boldsymbol{\\sigma}}_n = \\boldsymbol{\\sigma}_n + \\Delta t \\left( (K \\, \\mathrm{tr}(\\mathbf{d}) \\mathbf{I} + 2G \\, \\mathrm{dev}(\\mathbf{d})) + \\boldsymbol{\\omega}\\boldsymbol{\\sigma}_n - \\boldsymbol{\\sigma}_n\\boldsymbol{\\omega} \\right)\n    $$\n    该积分在四个阶段上迭代执行，初始条件为 $\\boldsymbol{\\sigma}(0) = \\mathbf{0}$ 和 $\\mathbf{F}(0) = \\mathbf{I}$。对于每个阶段，使用相应的恒定速度梯度 $\\mathbf{L}$、持续时间（$T_s$ 或 $T_r$）和步数（$N_s$ 或 $N_r$）。\n\n### 第三部分：路径分析\n\n四个阶段是：\n- **A. 简单剪切：** $\\mathbf{L}_s = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$。在这种情况下，$\\mathrm{tr}(\\mathbf{d}) = 0$，因此 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = 2G \\mathbf{d}$。\n- **B. 刚性旋转：** $\\mathbf{L}_r = \\begin{pmatrix} 0  -\\dot{\\theta}  0 \\\\ \\dot{\\theta}  0  0 \\\\ 0  0  0 \\end{pmatrix}$。这是一个反对称张量，因此 $\\mathbf{d} = \\mathbf{0}$ 且 $\\boldsymbol{\\omega}=\\mathbf{L}_r$。于是，$\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\mathbf{0}$。应力张量仅被旋转。\n- **C. 反剪切：** $\\mathbf{L}_{u} = \\mathbf{R}(\\theta) \\left( \\begin{pmatrix} 0  -\\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) \\mathbf{R}(\\theta)^{\\mathsf{T}}$。这里，同样有 $\\mathrm{tr}(\\mathbf{d})=0$，因此 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = 2G \\mathbf{d}$。\n- **D. 反向旋转：** $\\mathbf{L}_{-r} = \\begin{pmatrix} 0  \\dot{\\theta}  0 \\\\ -\\dot{\\theta}  0  0 \\\\ 0  0  0 \\end{pmatrix}$。同样，$\\mathbf{d} = \\mathbf{0}$，因此 $\\dot{\\boldsymbol{\\sigma}}^{\\nabla} = \\mathbf{0}$。\n\n完成所有四个阶段后，最终的变形梯度 $\\mathbf{F}_{\\text{final}}$ 返回到单位张量（在数值误差范围内），表明这是一个闭合的运动学路径。然而，由于次弹性模型的路径依赖性（特别是 Jaumann 率中的涡量项与演化中的应力张量相互作用），最终应力 $\\boldsymbol{\\sigma}_{\\text{final}}$ 通常不为零。\n\n残余应力通过 von Mises 等效应力来量化：\n$$\n\\sigma_{\\mathrm{vm}} = \\sqrt{\\tfrac{3}{2}\\,\\mathrm{dev}(\\boldsymbol{\\sigma}_{\\text{final}}):\\mathrm{dev}(\\boldsymbol{\\sigma}_{\\text{final}})}\n$$\n其中 $\\mathrm{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$，冒号表示 Frobenius 内积。\n一个特殊情况是当 $\\theta=0$ 时，此时加载路径是完全可逆的，预期残余应力为零。这为数值实现提供了一个有价值的检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_cycle_simulation(K, G, gamma, theta, N_s, N_r):\n    \"\"\"\n    Simulates the four-segment loading cycle for a given set of parameters\n    and returns the residual von Mises stress.\n\n    Args:\n        K (float): Bulk modulus in Pascals.\n        G (float): Shear modulus in Pascals.\n        gamma (float): Total shear strain magnitude.\n        theta (float): Total rotation angle in radians.\n        N_s (int): Number of time steps for shear/unshear segments.\n        N_r (int): Number of time steps for rotation segments.\n\n    Returns:\n        float: The final residual von Mises stress in Pascals.\n    \"\"\"\n    # 0. Initialization\n    sigma = np.zeros((3, 3))\n    F = np.eye(3)\n    I = np.eye(3)\n    \n    T_s = 1.0  # Duration of shear segments in seconds\n    T_r = 1.0  # Duration of rotation segments in seconds\n    \n    d_gamma = gamma / T_s\n    d_theta = theta / T_r\n    \n    dt_s = T_s / N_s\n    dt_r = T_r / N_r\n\n    def dev(tensor):\n        \"\"\"Calculates the deviatoric part of a 2nd order tensor.\"\"\"\n        return tensor - (1.0/3.0) * np.trace(tensor) * I\n\n    # 1. Segment A: Simple Shear\n    L_s = np.array([[0.0, d_gamma, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    d_s = 0.5 * (L_s + L_s.T)\n    omega_s = 0.5 * (L_s - L_s.T)\n    # Volumetric strain rate tr(d_s) is 0, so dsigma_nabla depends only on the deviatoric part\n    dsigma_nabla_s = 2.0 * G * d_s\n    \n    for _ in range(N_s):\n        dsigma_dt = dsigma_nabla_s + omega_s @ sigma - sigma @ omega_s\n        sigma += dsigma_dt * dt_s\n        F = (I + L_s * dt_s) @ F\n\n    # 2. Segment B: Rigid Rotation\n    L_r = np.array([[0.0, -d_theta, 0.0], [d_theta, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    d_r = 0.5 * (L_r + L_r.T)  # This is the zero matrix\n    omega_r = L_r\n    dsigma_nabla_r = np.zeros((3, 3)) # Rate-of-deformation is zero\n\n    for _ in range(N_r):\n        dsigma_dt = dsigma_nabla_r + omega_r @ sigma - sigma @ omega_r\n        sigma += dsigma_dt * dt_r\n        F = (I + L_r * dt_r) @ F\n\n    # 3. Segment C: Unshear in Rotated Axes\n    c, s = np.cos(theta), np.sin(theta)\n    R_theta = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n    L_su_template = np.array([[0.0, -d_gamma, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    L_u = R_theta @ L_su_template @ R_theta.T\n    \n    d_u = 0.5 * (L_u + L_u.T)\n    omega_u = 0.5 * (L_u - L_u.T)\n    # Volumetric strain rate tr(d_u) is 0\n    dsigma_nabla_u = 2.0 * G * d_u\n\n    for _ in range(N_s):\n        dsigma_dt = dsigma_nabla_u + omega_u @ sigma - sigma @ omega_u\n        sigma += dsigma_dt * dt_s\n        F = (I + L_u * dt_s) @ F\n        \n    # 4. Segment D: Reverse Rotation\n    L_mr = np.array([[0.0, d_theta, 0.0], [-d_theta, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    d_mr = 0.5 * (L_mr + L_mr.T) # This is the zero matrix\n    omega_mr = L_mr\n    dsigma_nabla_mr = np.zeros((3, 3)) # Rate-of-deformation is zero\n    \n    for _ in range(N_r):\n        dsigma_dt = dsigma_nabla_mr + omega_mr @ sigma - sigma @ omega_mr\n        sigma += dsigma_dt * dt_r\n        F = (I + L_mr * dt_r) @ F\n\n    # 5. Calculate Residual Stress\n    dev_sigma_final = dev(sigma)\n    vm_stress = np.sqrt(1.5 * np.sum(dev_sigma_final * dev_sigma_final))\n    \n    return vm_stress\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (5.0e10, 3.0e10, 0.2, 0.5, 400, 400),\n        (2.0e10, 1.0e10, 0.05, 0.1, 200, 200),\n        (5.0e10, 3.0e10, 0.2, 0.0, 400, 400),\n        (1.0e11, 4.0e10, 0.5, np.pi / 2, 800, 800),\n    ]\n\n    results = []\n    for params in test_cases:\n        K, G, gamma, theta, Ns, Nr = params\n        residual_stress = run_cycle_simulation(K, G, gamma, theta, Ns, Nr)\n        results.append(residual_stress)\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3546986"}]}