{"hands_on_practices": [{"introduction": "本实践是材料不稳定性分析的基础。声学张量分析是预测材料（如岩石和土壤）何时以及如何发生应变局部化（如剪切带）的关键工具。本练习将指导您为横观各向同性这一常见于沉积岩和层状材料的地质材料构建声学张量。通过计算其特征值，您将亲身体验如何使用声学张量来评估材料稳定性，并将了解最小特征值与材料刚度的关系 [@problem_id:3541344]。", "problem": "考虑一个交叉各向异性（横向各向同性）的岩土材料，其对称轴与单位向量 $\\boldsymbol{e}_{3}$（垂直于层理面）对齐。在线性小应变弹性理论中，增量本构响应由四阶刚度张量 $C_{ijkl}$ 定义，该张量具有通常的次对称性和主对称性。对于绕 $\\boldsymbol{e}_{3}$ 的横向各向同性，五个独立的刚度常数是 $C_{11}$、$C_{33}$、$C_{13}$、$C_{44}$ 和 $C_{66}$，其中 $C_{12}$ 由 $C_{66} = \\tfrac{1}{2}\\left(C_{11}-C_{12}\\right)$ 隐含。分析所需的非零分量为正-正分量 $C_{1111}$、$C_{2222}$、$C_{3333}$、$C_{1122}$、$C_{1133}$、$C_{2233}$，以及剪切分量 $C_{1212}$、$C_{1313}$、$C_{2323}$，这与横向各向同性是一致的。\n\n与传播方向 $\\boldsymbol{n}$ 相关的声学张量 $A(\\boldsymbol{n})$ 定义为 $A_{ij}(\\boldsymbol{n}) = C_{ikjl}\\,n_{k}\\,n_{l}$。在计算岩土力学中，椭圆性丧失是通过声学张量 $A(\\boldsymbol{n})$ 对于某个方向 $\\boldsymbol{n}$ 丧失正定性来诊断的。\n\n设材料常数（解释为增量模量）为\n$$\nC_{11} = 18~\\text{GPa},\\quad\nC_{33} = 12~\\text{GPa},\\quad\nC_{13} = 6~\\text{GPa},\\quad\nC_{44} = 7~\\text{GPa},\\quad\nC_{66} = 5~\\text{GPa},\n$$\n并取 $C_{12}$ 满足 $C_{66} = \\tfrac{1}{2}\\left(C_{11}-C_{12}\\right)$。\n\n从声学张量的定义和横向各向同性的 $C_{ijkl}$ 对称性约束形式出发，计算在 $\\boldsymbol{n}=\\boldsymbol{e}_{1}$（层理面方向）和 $\\boldsymbol{n}=\\boldsymbol{e}_{3}$（垂直于层理面）两种情况下 $A(\\boldsymbol{n})$ 的值。确定 $A(\\boldsymbol{n})$ 在这两种情况下的特征值谱，并找出每种情况下的最小特征值。\n\n作为最终答案，报告层理面方向情况下的最小特征值与垂直层理面方向情况下的最小特征值的比值。将答案表示为最简分数。该比值为无量纲，无需四舍五入。", "solution": "经评估，问题陈述有效。其科学依据在于线性弹性和连续介质力学原理，问题提法恰当，数据充分且一致，表述客观。所提供的材料属性满足横向各向同性弹性材料的热力学稳定性条件，证实了其物理合理性。因此，我们可以进行求解。\n\n对于给定的传播方向 $\\boldsymbol{n}$，声学张量 $A_{ij}(\\boldsymbol{n})$ 由四阶刚度张量 $C_{ijkl}$ 与方向向量的缩并定义：\n$$\nA_{ij}(\\boldsymbol{n}) = C_{ikjl}\\,n_{k}\\,n_{l}\n$$\n这里隐含了对重复指标 $k$ 和 $l$ 从 $1$ 到 $3$ 的求和。向量 $\\boldsymbol{n}$ 的分量是 $n_k$。对称二阶张量 $\\boldsymbol{A}(\\boldsymbol{n})$ 的特征值与在 $\\boldsymbol{n}$ 方向上传播的平面波的速度相关。\n\n对于对称轴沿 $\\boldsymbol{e}_3$ 的横向各向同性材料，刚度张量 $C_{ijkl}$ 的非零分量用五个独立的弹性常数表示。使用标准的双下标Voigt标记法（$11 \\to 1$、$22 \\to 2$、$33 \\to 3$、$23 \\to 4$、$13 \\to 5$、$12 \\to 6$），其主要分量为：\n$C_{1111} = C_{2222} = C_{11}$\n$C_{3333} = C_{33}$\n$C_{1122} = C_{12}$\n$C_{1133} = C_{2233} = C_{13}$\n$C_{2323} = C_{1313} = C_{44}$\n$C_{1212} = C_{66}$\n\n问题给出了关系式 $C_{66} = \\frac{1}{2}(C_{11}-C_{12})$，这是横向各向同性材料的一个已知恒等式。\n\n设传播方向为一个通用单位向量 $\\boldsymbol{n} = n_1 \\boldsymbol{e}_1 + n_2 \\boldsymbol{e}_2 + n_3 \\boldsymbol{e}_3$。声学张量 $\\boldsymbol{A}(\\boldsymbol{n})$ 的分量计算如下：\n$A_{11} = C_{1k1l} n_k n_l = C_{1111}n_1^2 + C_{1212}n_2^2 + C_{1313}n_3^2 = C_{11}n_1^2 + C_{66}n_2^2 + C_{44}n_3^2$\n$A_{22} = C_{2k2l} n_k n_l = C_{2121}n_1^2 + C_{2222}n_2^2 + C_{2323}n_3^2 = C_{66}n_1^2 + C_{11}n_2^2 + C_{44}n_3^2$\n$A_{33} = C_{3k3l} n_k n_l = C_{3131}n_1^2 + C_{3232}n_2^2 + C_{3333}n_3^2 = C_{44}n_1^2 + C_{44}n_2^2 + C_{33}n_3^2 = C_{44}(n_1^2+n_2^2) + C_{33}n_3^2$\n$A_{12} = A_{21} = C_{1k2l} n_k n_l = (C_{1122}+C_{1212})n_1n_2 = (C_{12}+C_{66})n_1n_2$\n$A_{13} = A_{31} = C_{1k3l} n_k n_l = (C_{1133}+C_{1313})n_1n_3 = (C_{13}+C_{44})n_1n_3$\n$A_{23} = A_{32} = C_{2k3l} n_k n_l = (C_{2233}+C_{2323})n_2n_3 = (C_{13}+C_{44})n_2n_3$\n\n声学张量的矩阵形式为：\n$$\n\\boldsymbol{A}(\\boldsymbol{n}) =\n\\begin{pmatrix}\nC_{11}n_1^2 + C_{66}n_2^2 + C_{44}n_3^2  (C_{12}+C_{66})n_1n_2  (C_{13}+C_{44})n_1n_3 \\\\\n(C_{12}+C_{66})n_1n_2  C_{66}n_1^2 + C_{11}n_2^2 + C_{44}n_3^2  (C_{13}+C_{44})n_2n_3 \\\\\n(C_{13}+C_{44})n_1n_3  (C_{13}+C_{44})n_2n_3  C_{44}(n_1^2+n_2^2) + C_{33}n_3^2\n\\end{pmatrix}\n$$\n\n我们现在针对两个指定的传播方向计算该张量。\n\n情况1：在层理面方向上传播，$\\boldsymbol{n} = \\boldsymbol{e}_1$。\n此时，$n_1=1$，$n_2=0$，$n_3=0$。将这些值代入 $\\boldsymbol{A}(\\boldsymbol{n})$ 的矩阵中：\n$$\n\\boldsymbol{A}(\\boldsymbol{e}_1) =\n\\begin{pmatrix}\nC_{11}(1)^2 + 0 + 0  0  0 \\\\\n0  C_{66}(1)^2 + 0 + 0  0 \\\\\n0  0  C_{44}(1)^2 + 0 + 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{11}  0  0 \\\\\n0  C_{66}  0 \\\\\n0  0  C_{44}\n\\end{pmatrix}\n$$\n声学张量是对角矩阵。其特征值为对角线上的元素。使用给定的材料常数：\n$C_{11} = 18~\\text{GPa}$\n$C_{66} = 5~\\text{GPa}$\n$C_{44} = 7~\\text{GPa}$\n$\\boldsymbol{n} = \\boldsymbol{e}_1$ 的特征值谱为 $\\{18, 5, 7\\}$。\n此情况下的最小特征值为：\n$$\n\\lambda_{\\min}^{(1)} = \\min(C_{11}, C_{66}, C_{44}) = \\min(18, 5, 7) = 5~\\text{GPa}\n$$\n\n情况2：垂直于层理面方向传播，$\\boldsymbol{n} = \\boldsymbol{e}_3$。\n此时，$n_1=0$，$n_2=0$，$n_3=1$。将这些值代入 $\\boldsymbol{A}(\\boldsymbol{n})$ 的矩阵中：\n$$\n\\boldsymbol{A}(\\boldsymbol{e}_3) =\n\\begin{pmatrix}\n0 + 0 + C_{44}(1)^2  0  0 \\\\\n0  0 + 0 + C_{44}(1)^2  0 \\\\\n0  0  0 + C_{33}(1)^2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{44}  0  0 \\\\\n0  C_{44}  0 \\\\\n0  0  C_{33}\n\\end{pmatrix}\n$$\n该声学张量也是对角矩阵。其特征值为对角线上的元素。使用给定的材料常数：\n$C_{44} = 7~\\text{GPa}$\n$C_{33} = 12~\\text{GPa}$\n$\\boldsymbol{n} = \\boldsymbol{e}_3$ 的特征值谱为 $\\{7, 7, 12\\}$。\n此情况下的最小特征值为：\n$$\n\\lambda_{\\min}^{(3)} = \\min(C_{44}, C_{44}, C_{33}) = \\min(7, 7, 12) = 7~\\text{GPa}\n$$\n\n最后，我们计算层理面方向情况（$\\boldsymbol{n}=\\boldsymbol{e}_1$）下的最小特征值与垂直层理面方向情况（$\\boldsymbol{n}=\\boldsymbol{e}_3$）下的最小特征值的比值：\n$$\n\\text{Ratio} = \\frac{\\lambda_{\\min}^{(1)}}{\\lambda_{\\min}^{(3)}} = \\frac{5}{7}\n$$\n该比值是无量纲的，并且已经是其最简分数形式。", "answer": "$$\\boxed{\\frac{5}{7}}$$", "id": "3541344"}, {"introduction": "为了更精确地模拟颗粒材料（如砂土）的力学行为，我们需要超越经典的连续介质力学。本高级练习引入了微极（Cosserat）连续介质模型，该模型考虑了颗粒的微观旋转自由度。在此练习 [@problem_id:3541350] 中，您将推导一个与频率相关的动态声学张量，并分析其色散关系，从而揭示微观转动惯量如何产生新的波型（光学分支），以及它如何在快速加载条件下延迟材料失稳的发生。", "problem": "考虑一个经历小变形的各向同性线性微极（Cosserat）连续体，其宏观位移场为 $\\mathbf{u}$，独立微旋转矢量为 $\\boldsymbol{\\varphi}$，质量密度为 $\\rho$，微旋转惯量为 $J$。运动学度量为微极畸变 $\\gamma_{ij} = u_{i,j} - \\epsilon_{ijk} \\varphi_{k}$ 和曲率 $\\kappa_{ij} = \\varphi_{i,j}$，其中 $\\epsilon_{ijk}$ 是 Levi-Civita 张量。线动量和角动量的平衡方程（在无体力与体力矩的情况下）为 $\\sigma_{ij,j} = \\rho \\, \\ddot{u}_{i}$ 和 $m_{ij,j} + \\epsilon_{ijk} \\sigma_{jk} = J \\, \\ddot{\\varphi}_{i}$，其中 $\\sigma$ 是 Cauchy 应力， $m$ 是力偶应力。对于各向同性线性微极响应，Cauchy 应力取决于 $\\gamma$ 的对称和反对称部分，而力偶应力取决于 $\\kappa$。重点关注反平面剪切设置，其中唯一的非零运动学场是面内横向位移 $u_{2}(x_{1},t)$ 和面外微旋转 $\\varphi_{3}(x_{1},t)$，且所有场仅沿 $x_{1}$ 方向变化。在此模式下，本构特化为：\n- $\\sigma_{12} = 2 \\mu \\, \\mathrm{sym}(\\gamma)_{12} + 2 \\kappa \\, \\mathrm{skw}(\\gamma)_{12}$，\n- $\\sigma_{21} = 2 \\mu \\, \\mathrm{sym}(\\gamma)_{21} + 2 \\kappa \\, \\mathrm{skw}(\\gamma)_{21}$，\n- $m_{31} = \\eta \\, \\varphi_{3,1}$，\n其中 $\\mu$ 是切线对称剪切模量（可能因软化而退化），$\\kappa0$ 是与 $\\gamma$ 的反对称部分相关的 Cosserat 力偶模量，$\\eta0$ 是此模式下的相关曲率模量。\n\n假设一个平面谐波拟设，其形式为 $u_{2}(x_{1},t) = U \\exp\\!\\big(i(k x_{1} - \\omega t)\\big)$ 和 $\\varphi_{3}(x_{1},t) = P \\exp\\!\\big(i(k x_{1} - \\omega t)\\big)$，其中波数大小为实数 $k0$，角频率为实数 $\\omega \\ge 0$，振幅 $U$ 和 $P$ 为复数。取传播方向（单位法向量）为 $\\mathbf{n} = \\mathbf{e}_{1}$。\n\n任务：\n- 从线动量和角动量平衡方程，结合上述运动学和本构特化，推导此剪切水平微极模式下 $2 \\times 2$ 的频率相关动态声学张量 $\\mathbf{A}(\\mathbf{n},\\omega)$，其形式为一个作用于广义振幅矢量 $(U, P)^{T}$ 的复厄米矩阵。将 $\\mathbf{A}(\\mathbf{n},\\omega)$ 明确地用 $\\rho$、 $J$、 $\\mu$、 $\\kappa$、 $\\eta$、 $k$ 和 $\\omega$ 表示。\n- 通过分析 $\\det \\mathbf{A}(\\mathbf{n},\\omega)=0$，确定两个色散分支，并证明存在一个微旋转分支，该分支具有一个非零的截止角频率，当 $k \\to 0$ 时该频率与 $k$ 无关，这反映了色散微旋转波的存在。利用这一点，从物理角度解释为什么快速加载（有限 $\\omega$）会相对于准静态极限延迟 $\\det \\mathbf{A} = 0$ 的发生。\n- 作为最终答案，报告微旋转截止角频率 $\\omega_{\\mathrm{r}}$ 关于 $\\kappa$ 和 $J$ 的精确解析表达式。不要代入数值。最终答案必须是单一的闭式表达式，且不得包含单位。", "solution": "解答过程首先推导指定反平面剪切模式的控制偏微分方程（PDE），然后应用平面波拟设推导声学张量，最后分析得到的色散关系。\n\n首先，我们确定微极畸变 $\\gamma_{ij} = u_{i,j} - \\epsilon_{ijk} \\varphi_{k}$ 的相关分量。鉴于 $u_1=u_3=0$，$\\varphi_1=\\varphi_2=0$，且所有场仅依赖于 $x_1$，唯一可能非零的 $u_{i,j}$ 分量是 $u_{2,1}$。唯一非零的 $\\varphi_k$ 分量是 $\\varphi_3$。\n$\\gamma_{ij}$ 的非零分量为：\n$$\n\\gamma_{21} = u_{2,1} - \\epsilon_{21k}\\varphi_k = u_{2,1} - \\epsilon_{213}\\varphi_3 = u_{2,1} - (-1)\\varphi_3 = u_{2,1} + \\varphi_3\n$$\n$$\n\\gamma_{12} = u_{1,2} - \\epsilon_{12k}\\varphi_k = 0 - \\epsilon_{123}\\varphi_3 = -(1)\\varphi_3 = -\\varphi_3\n$$\n$\\gamma_{ij}$ 的所有其他分量均为零。\n\n相关畸变张量分量的对称和反对称部分为：\n$$\n\\mathrm{sym}(\\gamma)_{12} = \\mathrm{sym}(\\gamma)_{21} = \\frac{1}{2}(\\gamma_{12} + \\gamma_{21}) = \\frac{1}{2}(-\\varphi_3 + u_{2,1} + \\varphi_3) = \\frac{1}{2}u_{2,1}\n$$\n$$\n\\mathrm{skw}(\\gamma)_{12} = \\frac{1}{2}(\\gamma_{12} - \\gamma_{21}) = \\frac{1}{2}(-\\varphi_3 - (u_{2,1} + \\varphi_3)) = -\\frac{1}{2}(u_{2,1} + 2\\varphi_3)\n$$\n$$\n\\mathrm{skw}(\\gamma)_{21} = \\frac{1}{2}(\\gamma_{21} - \\gamma_{12}) = \\frac{1}{2}(u_{2,1} + \\varphi_3 - (-\\varphi_3)) = \\frac{1}{2}(u_{2,1} + 2\\varphi_3)\n$$\n将这些代入给定的应力本构关系：\n$$\n\\sigma_{12} = 2\\mu \\left(\\frac{1}{2}u_{2,1}\\right) + 2\\kappa \\left(-\\frac{1}{2}(u_{2,1} + 2\\varphi_3)\\right) = (\\mu - \\kappa)u_{2,1} - 2\\kappa\\varphi_3\n$$\n$$\n\\sigma_{21} = 2\\mu \\left(\\frac{1}{2}u_{2,1}\\right) + 2\\kappa \\left(\\frac{1}{2}(u_{2,1} + 2\\varphi_3)\\right) = (\\mu + \\kappa)u_{2,1} + 2\\kappa\\varphi_3\n$$\n对于力偶应力，唯一相关的曲率分量是 $\\kappa_{31} = \\varphi_{3,1}$，因此 $m_{31} = \\eta\\varphi_{3,1}$。\n\n接下来，我们将这些代入平衡定律。\n线动量平衡 $\\sigma_{ij,j} = \\rho \\ddot{u}_i$，对于 $i=2$ 为 $\\sigma_{2j,j} = \\rho \\ddot{u}_2$。由于场仅随 $x_1$ 变化，这简化为 $\\sigma_{21,1} = \\rho \\ddot{u}_2$。代入 $\\sigma_{21}$ 的表达式：\n$$\n((\\mu + \\kappa)u_{2,1} + 2\\kappa \\varphi_3)_{,1} = \\rho \\ddot{u}_2 \\implies (\\mu + \\kappa)u_{2,11} + 2\\kappa \\varphi_{3,1} = \\rho \\ddot{u}_2\n$$\n这是第一个控制偏微分方程。\n\n角动量平衡 $m_{ij,j} + \\epsilon_{ijk} \\sigma_{jk} = J \\ddot{\\varphi}_i$，对于 $i=3$ 为 $m_{3j,j} + \\epsilon_{3jk} \\sigma_{jk} = J \\ddot{\\varphi}_3$。仅随 $x_1$ 变化时，这变为 $m_{31,1} + \\epsilon_{312}\\sigma_{12} + \\epsilon_{321}\\sigma_{21} = J \\ddot{\\varphi}_3$。\n使用 $\\epsilon_{312}=1$ 和 $\\epsilon_{321}=-1$，方程为 $m_{31,1} + \\sigma_{12} - \\sigma_{21} = J \\ddot{\\varphi}_3$。\n应力差为 $\\sigma_{12} - \\sigma_{21} = ((\\mu - \\kappa)u_{2,1} - 2\\kappa\\varphi_3) - ((\\mu + \\kappa)u_{2,1} + 2\\kappa\\varphi_3) = -2\\kappa u_{2,1} - 4\\kappa\\varphi_3$。\n将此式和 $m_{31,1} = (\\eta\\varphi_{3,1})_{,1} = \\eta\\varphi_{3,11}$ 代入平衡定律，得到第二个控制偏微分方程：\n$$\n\\eta\\varphi_{3,11} - 2\\kappa u_{2,1} - 4\\kappa \\varphi_3 = J \\ddot{\\varphi}_3\n$$\n\n现在，我们引入平面波拟设 $u_2 = U\\exp(i(kx_1-\\omega t))$ 和 $\\varphi_3 = P\\exp(i(kx_1-\\omega t))$。所需的导数为：\n$u_{2,1} = ikU\\exp(\\dots)$， $u_{2,11} = -k^2U\\exp(\\dots)$， $\\ddot{u}_2 = -\\omega^2U\\exp(\\dots)$。\n$\\varphi_{3,1} = ikP\\exp(\\dots)$， $\\varphi_{3,11} = -k^2P\\exp(\\dots)$， $\\ddot{\\varphi}_3 = -\\omega^2P\\exp(\\dots)$。\n将这些代入两个偏微分方程并消去公共指数因子，得到关于振幅 $U$ 和 $P$ 的线性代数方程组：\n由线动量平衡：\n$$\n(\\mu + \\kappa)(-k^2 U) + 2\\kappa (ik P) = \\rho(-\\omega^2 U) \\implies ((\\mu + \\kappa)k^2 - \\rho\\omega^2)U - 2ik\\kappa P = 0\n$$\n由角动量平衡：\n$$\n\\eta(-k^2 P) - 2\\kappa(ik U) - 4\\kappa P = J(-\\omega^2 P) \\implies 2ik\\kappa U + (\\eta k^2 + 4\\kappa - J\\omega^2)P = 0\n$$\n该系统可以写成矩阵形式 $\\mathbf{A}(\\mathbf{n},\\omega) \\begin{pmatrix} U \\\\ P \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，其中 $\\mathbf{A}(\\mathbf{n},\\omega)$ 是沿 $\\mathbf{n}=\\mathbf{e}_1$ 传播的频率相关动态声学张量：\n$$\n\\mathbf{A}(\\mathbf{n},\\omega) = \\begin{pmatrix} (\\mu + \\kappa)k^2 - \\rho \\omega^2  -2ik\\kappa \\\\ 2ik\\kappa  \\eta k^2 + 4\\kappa - J \\omega^2 \\end{pmatrix}\n$$\n非对角线项为 $A_{12} = -2ik\\kappa$ 和 $A_{21} = 2ik\\kappa$。由于 $\\overline{A_{21}} = \\overline{2ik\\kappa} = -2ik\\kappa = A_{12}$，且对角线项为实数，该矩阵是复厄米矩阵，符合要求。\n\n对于非平凡解 $(U,P)^T \\neq (0,0)^T$，声学张量的行列式必须为零，即 $\\det\\mathbf{A}(\\mathbf{n},\\omega) = 0$。这给出了色散关系：\n$$\n((\\mu + \\kappa)k^2 - \\rho \\omega^2)(\\eta k^2 + 4\\kappa - J \\omega^2) - (-2ik\\kappa)(2ik\\kappa) = 0\n$$\n$$\n((\\mu + \\kappa)k^2 - \\rho \\omega^2)(\\eta k^2 + 4\\kappa - J \\omega^2) - 4k^2\\kappa^2 = 0\n$$\n这是一个关于 $\\omega^2$ 作为 $k^2$ 函数的二次方程，定义了两个色散分支。\n\n为求截止频率，我们分析 $k \\to 0$ 极限下的色散关系。在方程中令 $k=0$：\n$$\n(0 - \\rho \\omega^2)(0 + 4\\kappa - J \\omega^2) - 0 = 0\n$$\n$$\n-\\rho \\omega^2 (4\\kappa - J \\omega^2) = 0\n$$\n这个方程对 $\\omega^2$ 有两个解：\n1. $\\omega^2 = 0$：这是声学分支。当波长趋于无穷大时，频率趋于零，对应于刚体运动。\n2. $4\\kappa - J \\omega^2 = 0$：这给出 $\\omega^2 = \\frac{4\\kappa}{J}$。这个分支即使在零波数（$k=0$）下也具有非零频率。这是微旋转（或光学）分支。相应的截止角频率，我们记为 $\\omega_r$，是：\n$$\n\\omega_{\\mathrm{r}} = \\sqrt{\\frac{4\\kappa}{J}}\n$$\n$k=0$ 时的这种模式对应于整个介质的空间均匀微旋转，其中内部恢复力偶与微惯量相平衡。\n\n材料不稳定性（例如，应变局部化）的开始由 $\\det\\mathbf{A}=0$ 对于实数波数 $k$ 的条件所标志。这通常发生在切线模量 $\\mu$ 因材料软化而退化时。我们可以通过求解关于 $\\mu$ 的色散关系来找到不稳定性开始时的 $\\mu$ 的临界值。\n在准静态极限（$\\omega=0$）下，条件 $\\det\\mathbf{A}=0$ 变为 $(\\mu+\\kappa)k^2(\\eta k^2+4\\kappa)-4k^2\\kappa^2=0$。对于 $k \\neq 0$，这给出 $\\eta(\\mu+\\kappa)k^2 + 4\\kappa\\mu = 0$。为使实数 $k$ 存在，我们必须有 $-\\kappa  \\mu \\le 0$。不稳定性首先发生在该范围的上界，即在临界模量 $\\mu_{crit}^{qs} = 0$ 处，这对应于长波极限（$k \\to 0$）。\n\n在动态情况（有限 $\\omega > 0$）下，条件 $\\det\\mathbf{A}=0$ 更复杂。惯性项 $\\rho\\omega^2$ 和 $J\\omega^2$ 的存在为变形模式的形成提供了阻力。这被称为惯性稳定。对于任何有限频率 $\\omega$，长波模式（$k \\to 0$）被强烈稳定，因为这些模式的有效刚度变得非常大。因此，在准静态情况下于 $k \\to 0$ 处发生的不稳定性被抑制了。不稳定性必须在更短的波长（更大的 $k$）处开始。详细分析表明，动态不稳定性的临界模量降低了。例如，在高频振荡或短波扰动（$k \\to \\infty$）的极限下，临界模量接近 $\\mu_{crit}^{dyn} = -\\kappa$。由于 $\\mu_{crit}^{dyn}  \\mu_{crit}^{qs}$，与慢速（准静态）加载相比，材料在快速加载下变得不稳定之前必须经历更显著的软化（即 $\\mu$ 必须下降到更负的值）。因此，快速加载延迟了不稳定性的发生。\n\n根据要求，微旋转分支的截止频率是从色散关系的 $k \\to 0$ 极限推导出来的。", "answer": "$$\n\\boxed{2\\sqrt{\\frac{\\kappa}{J}}}\n$$", "id": "3541350"}, {"introduction": "从理论到计算实践的跨越是计算岩土力学中的一个关键步骤。当材料经历大变形时，忽略几何非线性和有限应变效应的小应变理论将导致严重错误。这个编码实践 [@problem_id:3541371] 要求您实现一个完整的有限应变弹塑性框架，包括正确的应力更新和空间切线刚度张量的推导。通过将精确的有限应变声学张量分析结果与简化的、不正确的理论进行对比，您将深刻理解在数值模拟中采用严谨的运动学和本构关系的重要性。", "problem": "一名开发人员的任务是实现一个有限应变、乘法弹塑性框架，以通过声学张量分析评估材料稳定性。该模型必须遵循变形梯度的乘法分解，$\\,\\mathbf{F} = \\mathbf{F}_e \\mathbf{F}_p\\,$，其中 $\\,\\mathbf{F}_e\\,$ 是弹性部分，$\\,\\mathbf{F}_p\\,$ 是塑性部分。开发人员应推导并实现包含几何应力项的增量空间切线模量 $\\,\\mathbb{c}\\,$，然后将通过朴素小应变公式预测的声学张量行列式与通过正确的有限应变推前（push-forward）程序获得的结果进行比较。该比较应突显在有限应变下，尤其是在大体积变化（$\\,J = \\det \\mathbf{F}\\,$）时，应用小应变声学张量公式的误区。\n\n推导必须基于适用于计算地质力学的第一性原理。使用以下公认的基础：\n- 乘法运动学：$\\,\\mathbf{F} = \\mathbf{F}_e \\mathbf{F}_p\\,$，并且对于压力不敏感塑性中典型的等容塑性流动，有 $\\,\\det \\mathbf{F}_p = 1\\,$，因此 $\\,J = \\det \\mathbf{F} = \\det \\mathbf{F}_e\\,$。\n- 弹性构型中的弹性本构关系：采用依赖于弹性Green-Lagrange应变 $\\,\\mathbf{E}_e = \\tfrac{1}{2}(\\mathbf{C}_e - \\mathbf{I})\\,$（其中 $\\,\\mathbf{C}_e = \\mathbf{F}_e^{\\top}\\mathbf{F}_e\\,$）的弹性势能，以及相应的第二Piola-Kirchhoff应力 $\\,\\mathbf{S}_e = \\lambda\\,\\mathrm{tr}(\\mathbf{E}_e)\\,\\mathbf{I} + 2\\mu\\,\\mathbf{E}_e\\,$，其中 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 是Lamé参数。这一选择在遵循有限应变运动学的同时，确保了推导过程的透明和可测试性。\n- 材料切线模量的推前：弹性构型中的参考（材料）切线模量 $\\,\\mathbb{C}_e\\,$ 为 $\\,\\mathbb{C}_e = \\lambda\\,\\mathbf{I}\\otimes\\mathbf{I} + 2\\mu\\,\\mathbb{I}_{\\mathrm{sym}}\\,$，其中 $\\,\\mathbb{I}_{\\mathrm{sym}}\\,$ 是四阶对称单位张量。空间（当前构型）材料切线模量通过 $\\,\\mathbf{F}_e\\,$ 的推前操作得到，如下所示：\n$$\n\\mathbb{c}_{\\mathrm{mat},\\,ijkl} = \\frac{1}{J} \\, F_{e\\,iI}\\,F_{e\\,jJ}\\,F_{e\\,kK}\\,F_{e\\,lL}\\, \\mathbb{C}_{e\\,IJKL},\n$$\n此处使用常规的求和约定，且 $\\,J = \\det\\mathbf{F}\\,$。\n- 几何应力贡献：增量空间切线模量必须包含由当前Cauchy应力 $\\,\\boldsymbol{\\sigma}\\,$ 产生的几何项。使用Kirchhoff应力 $\\,\\boldsymbol{\\tau} = \\mathbf{F}_e\\,\\mathbf{S}_e\\,\\mathbf{F}_e^{\\top}\\,$ 和 $\\,\\boldsymbol{\\sigma} = \\boldsymbol{\\tau}/J\\,$，包含几何部分\n$$\n\\mathbb{c}_{\\mathrm{geo},\\,ijkl} = \\delta_{jk}\\,\\sigma_{il} + \\delta_{il}\\,\\sigma_{jk},\n$$\n使得完整的空间切线模量为 $\\,\\mathbb{c} = \\mathbb{c}_{\\mathrm{mat}} + \\mathbb{c}_{\\mathrm{geo}}\\,$。此形式代表了在更新Lagrangian框架中平衡方程的一致线性化，并直接贡献于有限元方法（FEM）中使用的几何刚度项。\n- 声学张量定义：对于单位传播方向 $\\,\\mathbf{n}\\,$，声学张量 $\\,\\mathbf{A}(\\mathbf{n})\\,$ 为 $\\,A_{jk}(\\mathbf{n}) = \\mathbb{c}_{ijkl}\\,n_i\\,n_l\\,$。强椭圆性要求对于所有 $\\,\\mathbf{n}\\,$ 都有 $\\,\\det \\mathbf{A}(\\mathbf{n})  0\\,$。\n\n朴素的小应变声学张量公式直接在当前构型中使用小应变各向同性弹性张量 $\\,\\mathbb{C}^{\\mathrm{small}} = \\lambda\\,\\mathbf{I}\\otimes\\mathbf{I} + 2\\mu\\,\\mathbb{I}_{\\mathrm{sym}}\\,$，忽略了推前操作和几何应力项。在此近似下，\n$$\nA^{\\mathrm{small}}_{jk}(\\mathbf{n}) = \\mathbb{C}^{\\mathrm{small}}_{ijkl} \\, n_i \\, n_l .\n$$\n\n任务要求：\n1. 实现上述有限应变乘法框架，其中 $\\,\\mathbf{F} = \\mathbf{F}_e\\mathbf{F}_p\\,$，并计算 $\\,\\mathbf{F}_e = \\mathbf{F}\\,\\mathbf{F}_p^{-1}\\,$。对于所提供的测试套件，取 $\\,\\mathbf{F}_p = \\mathbf{I}\\,$（无塑性流动），因此 $\\,\\mathbf{F}_e = \\mathbf{F}\\,$；这保留了乘法结构，同时分离出有限应变推前和几何项的作用。\n2. 通过对 $\\,\\mathbb{C}_e\\,$ 进行推前操作来推导并实现 $\\,\\mathbb{c}_{\\mathrm{mat}}\\,$，并按照规定使用 $\\,\\boldsymbol{\\sigma}\\,$ 包含 $\\,\\mathbb{c}_{\\mathrm{geo}}\\,$。构建 $\\,\\mathbf{A}(\\mathbf{n})\\,$ 并计算 $\\,\\det \\mathbf{A}(\\mathbf{n})\\,$。\n3. 直接使用 $\\,\\mathbb{C}^{\\mathrm{small}}\\,$ 计算朴素的小应变声学张量行列式 $\\,\\det \\mathbf{A}^{\\mathrm{small}}(\\mathbf{n})\\,$。\n4. 在一个测试套件上比较这两个行列式，该套件包括典型的有限应变剪切、大体积膨胀（大 $\\,J\\,$）和各向异性拉伸。此比较必须展示在有限应变下使用小应变公式的误区。\n\n所有测试均使用以下材料参数：Lamé参数 $\\,\\lambda = 30\\,$ 和 $\\,\\mu = 20\\,$（对于此抽象数学问题，这些参数是无量纲的）。\n\n测试套件：\n- 案例1（理想路径，近等容剪切）：$\\,\\mathbf{F} = \\begin{bmatrix}1  0.3  0 \\\\ 0  1  0 \\\\ 0  0  1\\end{bmatrix}\\,$, $\\,\\mathbf{n} = [1,0,0]^{\\top}\\,$。\n- 案例2（大 $\\,J\\,$ 体积膨胀）：$\\,\\mathbf{F} = \\mathrm{diag}(1.5,1.5,1.5)\\,$, $\\,\\mathbf{n} = [1,0,0]^{\\top}\\,$。\n- 案例3（各向异性拉伸，中等 $\\,J$）：$\\,\\mathbf{F} = \\mathrm{diag}(0.7,\\,1.6,\\,1.3)\\,$, $\\,\\mathbf{n} = \\frac{1}{\\sqrt{2}}[1,1,0]^{\\top}\\,$.\n- 案例4（极大 $\\,J\\,$ 体积膨胀）：$\\,\\mathbf{F} = \\mathrm{diag}(2.0,\\,2.0,\\,2.0)\\,$, $\\,\\mathbf{n} = [0,0,1]^{\\top}\\,$.\n\n对于每个案例，计算两个浮点数：来自正确的有限应变 $\\,\\mathbb{c}\\,$ 的 $\\,\\det \\mathbf{A}(\\mathbf{n})\\,$，以及来自朴素小应变公式的 $\\,\\det \\mathbf{A}^{\\mathrm{small}}(\\mathbf{n})\\,$。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n\\big[\\det \\mathbf{A}_1,\\ \\det \\mathbf{A}^{\\mathrm{small}}_1,\\ \\det \\mathbf{A}_2,\\ \\det \\mathbf{A}^{\\mathrm{small}}_2,\\ \\det \\mathbf{A}_3,\\ \\det \\mathbf{A}^{\\mathrm{small}}_3,\\ \\det \\mathbf{A}_4,\\ \\det \\mathbf{A}^{\\mathrm{small}}_4\\big].\n$$\n由于在此抽象公式中所有量都是无量纲的，因此不需要物理单位。不使用角度。不使用百分比。\n\n实现必须是一个完整的、可运行的程序，如最终答案部分所规定。", "solution": "求解过程如下：首先，建立理论框架，推导所有必要张量的分量形式。这包括应力度量的计算、正确的有限应变空间切线模量 $\\,\\mathbb{c}\\,$ 以及相应的声学张量 $\\,\\mathbf{A}(\\mathbf{n})\\,$。同时，构建了朴素的小应变声学张量 $\\,\\mathbf{A}^{\\mathrm{small}}(\\mathbf{n})\\,$。其次，基于这些推导，概述了算法流程。最后，实现该流程以计算指定测试案例的行列式。\n\n### 理论构建与推导\n\n目标是计算并比较 $\\,\\det \\mathbf{A}(\\mathbf{n})\\,$ 和 $\\,\\det \\mathbf{A}^{\\mathrm{small}}(\\mathbf{n})\\,$。\n\n**1. 运动学与应力计算**\n\n问题指出，对于测试套件，塑性变形梯度 $\\,\\mathbf{F}_p = \\mathbf{I}\\,$，其中 $\\,\\mathbf{I}\\,$ 是二阶单位张量。因此，乘法分解 $\\,\\mathbf{F} = \\mathbf{F}_e \\mathbf{F}_p\\,$ 简化为 $\\,\\mathbf{F}_e = \\mathbf{F}\\,$。所有后续计算都基于此弹性变形梯度 $\\,\\mathbf{F}_e\\,$。\n\n*   **弹性右Cauchy-Green张量 ($\\mathbf{C}_e$)**: 该张量度量材料构型中的伸长平方。\n    $$ \\mathbf{C}_e = \\mathbf{F}_e^{\\top} \\mathbf{F}_e $$\n*   **弹性Green-Lagrange应变 ($\\mathbf{E}_e$)**: 这是与第二Piola-Kirchhoff应力能量共轭的应变度量。\n    $$ \\mathbf{E}_e = \\frac{1}{2}(\\mathbf{C}_e - \\mathbf{I}) $$\n*   **第二Piola-Kirchhoff应力 ($\\mathbf{S}_e$)**: 这是在弹性参考构型中的应力，根据给定的各向同性本构关系计算。\n    $$ \\mathbf{S}_e = \\lambda\\,\\mathrm{tr}(\\mathbf{E}_e)\\,\\mathbf{I} + 2\\mu\\,\\mathbf{E}_e $$\n    其中 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 是Lamé参数。\n*   **Cauchy应力 ($\\boldsymbol{\\sigma}$)**: 这是当前（空间）构型中的真实应力。它是通过使用 $\\,\\mathbf{F}_e\\,$ 对 $\\,\\mathbf{S}_e\\,$ 进行推前操作得到的。首先，我们计算Kirchhoff应力 $\\,\\boldsymbol{\\tau}\\,$，然后按体积变化 $\\,J = \\det(\\mathbf{F}_e)\\,$ 进行缩放。\n    $$ \\boldsymbol{\\tau} = \\mathbf{F}_e \\mathbf{S}_e \\mathbf{F}_e^{\\top} $$\n    $$ \\boldsymbol{\\sigma} = \\frac{1}{J} \\boldsymbol{\\tau} = \\frac{1}{\\det(\\mathbf{F}_e)} \\mathbf{F}_e \\mathbf{S}_e \\mathbf{F}_e^{\\top} $$\n\n**2. 朴素小应变声学张量 ($\\mathbf{A}^{\\mathrm{small}}$)**\n\n该张量是通过在当前构型中直接错误地应用小应变各向同性弹性张量而构建的，忽略了变形。\n\n*   **小应变弹性张量 ($\\mathbb{C}^{\\mathrm{small}}$)**: 其分量形式为\n    $$ \\mathbb{C}^{\\mathrm{small}}_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) $$\n    其中 $\\,\\delta_{ij}\\,$ 是Kronecker delta。\n*   **朴素声学张量 ($\\mathbf{A}^{\\mathrm{small}}$)**: 这是通过将 $\\,\\mathbb{C}^{\\mathrm{small}}\\,$ 与空间传播方向 $\\,\\mathbf{n}\\,$ 进行缩并而形成的。\n    $$ A^{\\mathrm{small}}_{jk}(\\mathbf{n}) = \\mathbb{C}^{\\mathrm{small}}_{ijkl} n_i n_l $$\n    代入 $\\,\\mathbb{C}^{\\mathrm{small}}\\,$ 的分量并进行缩并（假设 $\\,\\mathbf{n}\\,$ 是单位向量，$\\,\\mathbf{n}\\cdot\\mathbf{n}=1\\,$）可得：\n    $$ \\mathbf{A}^{\\mathrm{small}}(\\mathbf{n}) = (\\lambda + \\mu)(\\mathbf{n} \\otimes \\mathbf{n}) + \\mu \\mathbf{I} $$\n*   **$\\mathbf{A}^{\\mathrm{small}}$的行列式**: 这个对缩放单位矩阵的秩-1更新的行列式可以使用矩阵行列式引理求得，其结果是一个仅取决于材料属性的常数：\n    $$ \\det \\mathbf{A}^{\\mathrm{small}}(\\mathbf{n}) = (\\lambda+2\\mu)\\mu^2 $$\n    对于给定的参数 $\\,\\lambda=30\\,$ 和 $\\,\\mu=20\\,$，该值为 $\\,(30 + 2 \\cdot 20)(20^2) = 70 \\cdot 400 = 28000\\,$。此结果与变形 $\\,\\mathbf{F}\\,$ 和方向 $\\,\\mathbf{n}\\,$ 无关，这也是该方法的根本缺陷。\n\n**3. 正确的有限应变声学张量 ($\\mathbf{A}$)**\n\n正确的张量由完整的空间切线模量 $\\,\\mathbb{c} = \\mathbb{c}_{\\mathrm{mat}} + \\mathbb{c}_{\\mathrm{geo}}\\,$ 构建。\n\n*   **材料贡献 ($\\mathbb{c}_{\\mathrm{mat}}$)**: 此项通过用 $\\,\\mathbf{F}_e\\,$ 推前材料弹性张量 $\\,\\mathbb{C}_e = \\lambda\\,\\mathbf{I}\\otimes\\mathbf{I} + 2\\mu\\,\\mathbb{I}_{\\mathrm{sym}}\\,$ 得到。推前操作 $\\,\\mathbb{c}_{\\mathrm{mat},\\,ijkl} = J^{-1} F_{e\\,iI}\\,F_{e\\,jJ}\\,F_{e\\,kK}\\,F_{e\\,lL}\\, \\mathbb{C}_{e\\,IJKL}\\,$ 以弹性左Cauchy-Green张量 $\\,\\mathbf{b}_e = \\mathbf{F}_e\\mathbf{F}_e^\\top\\,$ 给出以下空间表示：\n    $$ \\mathbb{c}_{\\mathrm{mat},\\,ijkl} = \\frac{1}{J} \\left( \\lambda b_{e,ij} b_{e,kl} + \\mu (b_{e,ik} b_{e,jl} + b_{e,il} b_{e,jk}) \\right) $$\n    对声学张量的贡献 $\\,\\mathbf{A}_{\\mathrm{mat}}(\\mathbf{n})\\,$，其分量为 $\\,A_{\\mathrm{mat}, jk} = \\mathbb{c}_{\\mathrm{mat}, ijkl} n_i n_l\\,$，则为：\n    $$ \\mathbf{A}_{\\mathrm{mat}}(\\mathbf{n}) = \\frac{1}{J} \\left( (\\lambda+\\mu)(\\mathbf{u} \\otimes \\mathbf{u}) + \\mu (\\mathbf{n}^\\top \\mathbf{b}_e \\mathbf{n}) \\mathbf{b}_e \\right) \\quad \\text{其中} \\quad \\mathbf{u} = \\mathbf{b}_e \\mathbf{n} $$\n*   **几何贡献 ($\\mathbb{c}_{\\mathrm{geo}}$)**: 此项源于Cauchy应力随几何形状的变化，对于捕捉如屈曲等不稳定性至关重要。问题规定其形式为：\n    $$ \\mathbb{c}_{\\mathrm{geo},\\,ijkl} = \\delta_{jk}\\sigma_{il} + \\delta_{il}\\sigma_{jk} $$\n    对声学张量的相应贡献 $\\,\\mathbf{A}_{\\mathrm{geo}}(\\mathbf{n})\\,$，其分量为 $\\,A_{\\mathrm{geo}, jk} = \\mathbb{c}_{\\mathrm{geo}, ijkl} n_i n_l\\,$，为：\n    $$ \\mathbf{A}_{\\mathrm{geo}}(\\mathbf{n}) = \\boldsymbol{\\sigma} + (\\mathbf{n}^\\top \\boldsymbol{\\sigma} \\mathbf{n}) \\mathbf{I} $$\n*   **总声学张量 ($\\mathbf{A}$)**: 完整的声学张量是材料部分和几何部分之和。\n    $$ \\mathbf{A}(\\mathbf{n}) = \\mathbf{A}_{\\mathrm{mat}}(\\mathbf{n}) + \\mathbf{A}_{\\mathrm{geo}}(\\mathbf{n}) $$\n    其行列式 $\\,\\det \\mathbf{A}(\\mathbf{n})\\,$ 正确地反映了当前的变形状态，包括由变形引起的材料各向异性以及压应力的失稳效应（或拉应力的稳定效应）。\n\n### 算法流程\n\n对于每个由变形梯度 $\\,\\mathbf{F}\\,$ 和传播方向 $\\,\\mathbf{n}\\,$ 定义的测试案例：\n\n1.  **初始化**：设置 $\\,\\mathbf{F}_e = \\mathbf{F}\\,$, $\\,\\lambda = 30\\,$ 和 $\\,\\mu = 20\\,$。\n2.  **计算朴素行列式**：计算 $\\,\\det \\mathbf{A}^{\\mathrm{small}} = (\\lambda+2\\mu)\\mu^2 = 28000\\,$。\n3.  **计算应力**：\n    a. 计算 $\\,J = \\det(\\mathbf{F}_e)\\,$。\n    b. 计算 $\\,\\mathbf{C}_e = \\mathbf{F}_e^\\top \\mathbf{F}_e\\,$。\n    c. 计算 $\\,\\mathbf{E}_e = 0.5 \\cdot (\\mathbf{C}_e - \\mathbf{I})\\,$。\n    d. 计算 $\\,\\mathbf{S}_e = \\lambda\\,\\mathrm{tr}(\\mathbf{E}_e)\\,\\mathbf{I} + 2\\mu\\,\\mathbf{E}_e\\,$。\n    e. 计算 $\\,\\boldsymbol{\\sigma} = (1/J) \\cdot \\mathbf{F}_e \\mathbf{S}_e \\mathbf{F}_e^\\top\\,$。\n4.  **计算正确的声学张量**：\n    a. 计算弹性左Cauchy-Green张量 $\\,\\mathbf{b}_e = \\mathbf{F}_e \\mathbf{F}_e^\\top\\,$。\n    b. 计算向量 $\\,\\mathbf{u} = \\mathbf{b}_e \\mathbf{n}\\,$。\n    c. 计算材料部分 $\\,\\mathbf{A}_{\\mathrm{mat}} = (1/J) \\cdot [ (\\lambda+\\mu)(\\mathbf{u} \\otimes \\mathbf{u}) + \\mu (\\mathbf{n}^\\top \\mathbf{b}_e \\mathbf{n}) \\mathbf{b}_e ]\\,$。\n    d. 计算几何部分 $\\,\\mathbf{A}_{\\mathrm{geo}} = \\boldsymbol{\\sigma} + (\\mathbf{n}^\\top \\boldsymbol{\\sigma} \\mathbf{n}) \\mathbf{I}\\,$。\n    e. 将它们相加得到总声学张量 $\\,\\mathbf{A} = \\mathbf{A}_{\\mathrm{mat}} + \\mathbf{A}_{\\mathrm{geo}}\\,$。\n5.  **计算正确的行列式**：使用数值线性代数程序计算 $\\,\\det \\mathbf{A}\\,$。\n6.  **存储结果**：将计算出的值 $\\,\\det \\mathbf{A}\\,$ 和 $\\,\\det \\mathbf{A}^{\\mathrm{small}}\\,$ 追加到结果列表中。\n\n该流程在实现后，将通过数值方式展示正确的有限应变结果与恒定的小应变近似之间的显著偏差，尤其是在涉及大体积变化或显著剪切的情况下。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_acoustic_tensors(F, n, lambda_, mu):\n    \"\"\"\n    Calculates the determinants of the correct finite-strain and naive small-strain\n    acoustic tensors for a given deformation state.\n\n    Args:\n        F (np.ndarray): The 3x3 deformation gradient tensor.\n        n (np.ndarray): The 3x1 unit propagation direction vector.\n        lambda_ (float): The first Lamé parameter.\n        mu (float): The second Lamé parameter (shear modulus).\n\n    Returns:\n        tuple[float, float]: A tuple containing:\n            - The determinant of the correct finite-strain acoustic tensor.\n            - The determinant of the naive small-strain acoustic tensor.\n    \"\"\"\n    # Define the 3x3 identity matrix\n    I = np.identity(3)\n\n    # 1. Naive Small-Strain Acoustic Tensor Calculation\n    # A_small = mu*I + (lambda+mu)*(n . n^T)\n    # The determinant is constant: det(A_small) = (lambda + 2*mu) * mu^2\n    det_A_small = (lambda_ + 2 * mu) * mu**2\n\n    # 2. Correct Finite-Strain Acoustic Tensor Calculation\n\n    # Set Fe = F as per problem statement (Fp = I)\n    Fe = F\n\n    # --- Stress Calculation ---\n    # Volume change J = det(Fe)\n    J = np.linalg.det(Fe)\n\n    # Elastic Right Cauchy-Green tensor: Ce = Fe^T * Fe\n    Ce = Fe.T @ Fe\n\n    # Elastic Green-Lagrange strain: Ee = 1/2 * (Ce - I)\n    Ee = 0.5 * (Ce - I)\n\n    # Second Piola-Kirchhoff stress: Se = lambda*tr(Ee)*I + 2*mu*Ee\n    tr_Ee = np.trace(Ee)\n    Se = lambda_ * tr_Ee * I + 2 * mu * Ee\n\n    # Cauchy stress: sigma = (1/J) * Fe * Se * Fe^T\n    sigma = (1 / J) * (Fe @ Se @ Fe.T)\n\n    # --- Acoustic Tensor Calculation ---\n\n    # Material contribution (A_mat)\n    # Elastic Left Cauchy-Green tensor: be = Fe * Fe^T\n    be = Fe @ Fe.T\n    \n    # Helper vector u = be . n\n    u = be @ n\n    \n    # Helper scalar beta = n^T . be . n\n    beta = n.T @ be @ n\n    \n    # A_mat = (1/J) * [ (lambda+mu)*(u . u^T) + mu*beta*be ]\n    u_outer_u = np.outer(u, u)\n    A_mat = (1 / J) * ((lambda_ + mu) * u_outer_u + mu * beta * be)\n\n    # Geometric contribution (A_geo)\n    # Helper scalar gamma = n^T . sigma . n\n    gamma = n.T @ sigma @ n\n    \n    # A_geo = sigma + gamma * I\n    A_geo = sigma + gamma * I\n    \n    # Total correct acoustic tensor: A = A_mat + A_geo\n    A = A_mat + A_geo\n    \n    # Determinant of the correct tensor\n    det_A = np.linalg.det(A)\n    \n    return det_A, det_A_small\n\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    # Material parameters (dimensionless)\n    lambda_ = 30.0\n    mu = 20.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"F\": np.array([[1.0, 0.3, 0.0],\n                           [0.0, 1.0, 0.0],\n                           [0.0, 0.0, 1.0]]),\n            \"n\": np.array([1.0, 0.0, 0.0])\n        },\n        {\n            \"F\": np.array([[1.5, 0.0, 0.0],\n                           [0.0, 1.5, 0.0],\n                           [0.0, 0.0, 1.5]]),\n            \"n\": np.array([1.0, 0.0, 0.0])\n        },\n        {\n            \"F\": np.array([[0.7, 0.0, 0.0],\n                           [0.0, 1.6, 0.0],\n                           [0.0, 0.0, 1.3]]),\n            \"n\": np.array([1.0/np.sqrt(2.0), 1.0/np.sqrt(2.0), 0.0])\n        },\n        {\n            \"F\": np.array([[2.0, 0.0, 0.0],\n                           [0.0, 2.0, 0.0],\n                           [0.0, 0.0, 2.0]]),\n            \"n\": np.array([0.0, 0.0, 1.0])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        F = case[\"F\"]\n        # Ensure n is a column vector for matrix operations\n        n = case[\"n\"].reshape(3, 1)\n\n        det_A, det_A_small = calculate_acoustic_tensors(F, n, lambda_, mu)\n        results.append(f\"{det_A:.6f}\")\n        results.append(f\"{det_A_small:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "3541371"}]}