## 引言
在模拟混凝土、岩石等准脆性材料的破坏过程时，[应变软化](@entry_id:755491)现象会导致传统的局部连续介质模型出现数学上的[不适定性](@entry_id:635673)，其直接后果是数值解严重依赖于[有限元网格](@entry_id:174862)的划分，这构成了计算力学领域的一个长期挑战。为了弥合这一理论与实践之间的鸿沟，学界发展了多种[正则化技术](@entry_id:261393)，其中非局部积分模型因其清晰的物理背景和强大的数学框架而备受瞩目。本文旨在系统性地剖析用于解决局部化问题的[非局部积分正则化](@entry_id:752662)方法。我们将从“原理与机制”一章入手，深入探讨非局部平均化的核心思想、[核函数](@entry_id:145324)的性质以及[内禀长度尺度](@entry_id:750789)的物理意义。随后，在“应用与跨学科[交叉](@entry_id:147634)”一章中，我们将展示该模型如何应用于分析[尺寸效应](@entry_id:153734)、各向异性材料等复杂工程问题，并探讨其与随机力学、多尺度建模等前沿领域的联系。最后，在“动手实践”部分，我们将通过具体的计算练习，引导读者将理论知识转化为实际的编程与分析能力，从而全面掌握这一先进的计算工具。

## 原理与机制

在上一章中，我们探讨了[应变软化](@entry_id:755491)材料中局部化现象带来的挑战，特别是其导致的数学[不适定性](@entry_id:635673)（ill-posedness）和[网格依赖性](@entry_id:198563)。为了解决这些问题，[连续介质力学](@entry_id:155125)引入了[正则化方法](@entry_id:150559)，其中非局部积分模型是最为强大和物理意义明确的方法之一。本章将深入探讨[非局部积分正则化](@entry_id:752662)的核心原理与关键机制，阐述其如何通过引入内部长度尺度来恢复模型的[适定性](@entry_id:148590)。

### 非局部平均化原理

非局部积分模型的核心思想是，材料在某一点的响应（如[损伤演化](@entry_id:184965)或[塑性流动](@entry_id:201346)）不应仅由该点的局部[状态变量](@entry_id:138790)（如应变）决定，而应由其邻域[内状态变量](@entry_id:750754)的加权平均值决定。这种处理方式在物理上反映了[材料微观结构](@entry_id:198422)（如骨料、晶粒）之间的相互作用，这种作用具有一定的空间范围。

在数学上，这一思想通过一个[卷积积分](@entry_id:155865)算子来实现。给定一个局部场量 $f(x)$，其对应的非局部场量 $\bar{f}(x)$ 定义为：

$$
\bar{f}(x) = \int_{\Omega} w(|x-\xi|) \, f(\xi) \, \mathrm{d}\xi
$$

其中，$x$ 是评估点，$\xi$ 是积分点（邻域点），$\Omega$ 是物体所占据的区域。函数 $w(r)$ 被称为**核函数**（kernel function）或权函数（weight function），它描述了距离为 $r = |x-\xi|$ 的点 $\xi$ 对点 $x$ 的影响程度。[核函数](@entry_id:145324)的有效作用范围由一个内置的**特征长度**（characteristic length）$\ell$ 来控制。这个长度尺度是正则化成功的关键。

为了直观地理解非局部平均化的作用，我们可以考察一个一维杆中理想化的[应变局部化](@entry_id:176973)带 [@problem_id:3546091]。假设在一个无限长杆中，局部应变 $\varepsilon(x)$ 集中在一个宽度为 $w$ 的带内，带内应变恒为 $\varepsilon_{\mathrm{in}}$，带外应变为零。即：

$$
\varepsilon(x) = \begin{cases}
\varepsilon_{\mathrm{in}},  |x| \le \frac{w}{2} \\
0,  |x| > \frac{w}{2}
\end{cases}
$$

如果我们采用指数型[核函数](@entry_id:145324) $w(r) = \frac{1}{2\ell} \exp(-\frac{|r|}{\ell})$，其中 $\ell$ 是[特征长度](@entry_id:265857)，那么在局部化带[中心点](@entry_id:636820) $x=0$ 处的非局部应变 $\bar{\varepsilon}(0)$ 就不是带内的局部值 $\varepsilon_{\mathrm{in}}$，而是通过积分计算得到的“平滑化”或“涂抹”后的值。通过计算该[卷积积分](@entry_id:155865)，可以得到精确的表达式：

$$
\bar{\varepsilon}(0) = \varepsilon_{\mathrm{in}} \left( 1 - \exp\left(-\frac{w}{2\ell}\right) \right)
$$

这个简单的结果揭示了[非局部算子](@entry_id:752664)的本质：$\bar{\varepsilon}(0)$ 的值不仅取决于带内的应变大小 $\varepsilon_{\mathrm{in}}$，还取决于局部化带宽 $w$ 与[特征长度](@entry_id:265857) $\ell$ 的比值。当局部化带非常宽时（$w \gg \ell$），指数项趋于零，$\bar{\varepsilon}(0)$ 接近于 $\varepsilon_{\mathrm{in}}$。反之，当局部化带非常窄时（$w \ll \ell$），$\bar{\varepsilon}(0)$ 远小于 $\varepsilon_{\mathrm{in}}$。这意味着[非局部算子](@entry_id:752664)能够“感知”到应变场的空间梯度，从而阻止应变无限集中于零宽度区域。如果材料的软化是由非局部应变 $\bar{\varepsilon}(x)$ 触发的，那么为了达到某个软化阈值 $\varepsilon_{\mathrm{th}}$，局部化带必须具有一个由 $\ell$ 控制的最小宽度 [@problem_id:3546091]。这正是正则化的核心机制。

### [核函数](@entry_id:145324)：[非局部算子](@entry_id:752664)的核心

[核函数](@entry_id:145324) $w(r)$ 的选择和性质直接决定了[非局部模型](@entry_id:175315)的数学特性和物理意义。一个适定的[核函数](@entry_id:145324)通常需要满足以下几个基本原则 [@problem_id:3546147]：

1.  **正定性 (Positivity)**：$w(r) \ge 0$。这保证了非局部平均是一种凸平均，符合其物理直觉，即邻域点的贡献总是正向的。
2.  **对称性 (Symmetry)**：$w(r)$ 是一个[偶函数](@entry_id:163605)，即 $w(r) = w(-r)$。这反映了材料响应的各向同性，即点 $\xi_1$ 对 $\xi_2$ 的影响与 $\xi_2$ 对 $\xi_1$ 的影响是对等的。这保证了[非局部算子](@entry_id:752664)的自伴性，与[变分原理](@entry_id:198028)和[能量守恒](@entry_id:140514)相容。
3.  **归一化/单位分解 (Partition of Unity)**：在无限域中，核函数应满足 $\int_{-\infty}^{\infty} w(|r|) \, \mathrm{d}r = 1$。这一性质保证了模型的一致性，即当局部场为常数 $f(x) = f_0$ 时，非局部场也能精确地重现该常数，$\bar{f}(x) = f_0$ [@problem_id:3546140]。
4.  **有限二阶矩 (Finite Second Moment)**：积分 $m_2 = \int_{-\infty}^{\infty} r^2 w(|r|) \, \mathrm{d}r$ 必须是有限的。这确保了特征长度被明确定义，并且使得非局部积分模型与梯度模型之间建立了联系，我们将在后续章节中讨论。

基于这些准则，我们可以评估一些常见的核函数 [@problem_id:3546147]：

-   **高斯核 (Gaussian kernel)**：$w(r) = C \exp(-r^2/\ell^2)$。该核函数无限光滑，但其[影响范围](@entry_id:166501)理论上是无限的。
-   **三角核 (Triangular kernel)**：$w(r) = C \max(0, 1-|r|/\ell)$。该核函数具有[紧支集](@entry_id:276214)（即在 $|r| > \ell$ 时为零），在数值计算中具有优势。
-   **指数核 (Exponential kernel)**：$w(r) = C \exp(-|r|/\ell)$。这是许多理论分析中常用的核函数。

上述三种核函数均可被适当归一化以满足所有四个条件。相比之下，某些函数则不适用。例如，类[sinc函数](@entry_id:274746) $w(r) = C \sin(|r|/\ell)/|r|$ 由于其[振荡](@entry_id:267781)性而违背了正定性。柯西分布（Cauchy distribution）形式的[核函数](@entry_id:145324) $w(r) = C/(1+(r/\ell)^2)$ 虽然满足前三个条件，但其二阶矩发散，不满足第四个条件。

### [特征长度](@entry_id:265857) $\ell_c$：一个内禀的材料属性

在[非局部模型](@entry_id:175315)中，特征长度 $\ell_c$ 绝不是一个可随意调整的数值参数，而是一个具有深刻物理意义的**内禀[材料长度尺度](@entry_id:197771)** [@problem_id:3546089]。它反映了[材料微观结构](@entry_id:198422)（如混凝土中的骨料尺寸、岩石中的晶粒尺寸或微裂纹的相互作用距离）对宏观力学行为的影响。

$\ell_c$ 的核心作用是设定了[应变局部化](@entry_id:176973)带的最小宽度。[数值模拟](@entry_id:137087)和理论分析均表明，最终形成的[断裂过程区](@entry_id:749561)（Fracture Process Zone, FPZ）的宽度与 $\ell_c$ 成正比。正是通过强制这个最小宽度，[非局部模型](@entry_id:175315)保证了在断裂过程中耗散的能量（即**断裂能** $G_f$）是一个有限的、非零的量，从而解决了局部模型中断裂能为零的悖论。

由于 $\ell_c$ 是一个材料参数，它必须通过实验来标定。标定过程通常旨在使模型能够重现那些由材料内部长度尺度控制的宏观现象 [@problem_id:3546089]：

-   **[断裂能](@entry_id:174458) $G_f$**：这是最重要的标定目标之一。模型的总耗散能与 $\ell_c$ 和[本构关系](@entry_id:186508)中的软化参数均相关。为了使模型预测的[断裂能](@entry_id:174458)与实验测量的材料断裂能 $G_f$ 一致，必须协同标定 $\ell_c$ 和软化定律。仅仅引入 $\ell_c > 0$ 只能保证[网格无关性](@entry_id:634417)，但不能保证其预测的断裂能数值是正确的 [@problem_id:3546140]。
-   **[尺寸效应](@entry_id:153734) (Size Effect)**：准[脆性](@entry_id:198160)材料的结构响应（如名义强度）表现出显著的[尺寸效应](@entry_id:153734)，即结构的力学行为依赖于结构尺寸与材料内部长度尺度的比值。通过对不同尺寸的几何相似试样进行实验，可以获得[尺寸效应](@entry_id:153734)曲线。拟合该曲线是标定 $\ell_c$ 的一种非常可靠的方法。
-   **完整的荷载-位移曲线**：最全面的标定方法是匹配整个实验过程中的荷载-位移曲线，特别是峰后软化段。[峰后行为](@entry_id:753623)对局部化带的宽度非常敏感，因此对 $\ell_c$ 的值有很强的约束。

需要特别强调的是一些常见的误解。例如，将 $\ell_c$ 设定为[有限元网格](@entry_id:174862)尺寸 $h$ 是完全错误的，这会使正则化本身依赖于网格，从而无法实现真正的网格客观性。$\ell_c$ 必须是一个独立于网格的固定材料常数。

### 模型的完备性与应用考量

为了构建一个在理论上严谨且在实践中稳健的[非局部模型](@entry_id:175315)，除了选择合适的核函数和标定[特征长度](@entry_id:265857)外，还必须考虑以下关键问题。

#### 非局部变量的选择

非局部平均化的对象必须是一个**客观的 (objective)** 标量 [@problem_id:3546079]。客观性，或称[参考系无关性](@entry_id:197245)（frame-indifference），是连续介质力学的一条基本公理，要求[本构关系](@entry_id:186508)在[刚体转动](@entry_id:191086)下保持不变。这意味着本构关系只能通过客观的张量、矢量或标量来表达。

[应变张量](@entry_id:193332)的单个分量（如 $\varepsilon_{11}$）不是客观量，其数值依赖于[坐标系](@entry_id:156346)的选取。如果对这样一个非客观量进行[空间平均](@entry_id:203499)，得到的非局部场也将是非客观的，这会使整个本构理论在物理上失效。因此，被平均的局部变量必须是一个[标量不变量](@entry_id:193787)。在塑性力学中，常选择**累积等效塑性应变** $\varepsilon_p$；在[损伤力学](@entry_id:178377)中，则常选择一个等效或等效[拉伸应变](@entry_id:183817) $\varepsilon_{eq}$。这些量是通过[张量不变量](@entry_id:203254)（如二阶[不变量](@entry_id:148850)）构造的，因此其数值与[坐标系](@entry_id:156346)选择无关，保证了整个[非局部模型](@entry_id:175315)的客观性。

#### 边界效应与重归一化

在有限尺寸的物体中，当评估点 $x$ 靠近边界 $\partial\Omega$ 时，[核函数](@entry_id:145324)的支承域会被边界截断。如果仍然使用无限域的[归一化常数](@entry_id:752675)，将导致$\int_{\Omega} w(|x-\xi|) \, \mathrm{d}\xi  1$。这会使得靠近边界的材料表现出人为的“伪增强”或“伪刚化”效应，因为常数场无法被精确重现 [@problem_id:3546140]。

为了修正这个问题，必须采用**位置依赖的重归一化 (position-dependent renormalization)** 方法 [@problem_id:3546131] [@problem_id:3546068]。其思想是为每个点 $x$ 计算一个修正因子 $C(x)$，该因子等于[核函数](@entry_id:145324)在有界域 $\Omega$ 内的实际积分值：

$$
C(x) = \int_{\Omega} w(|x-\xi|) \, \mathrm{d}\xi
$$

然后，有效的[核函数](@entry_id:145324)被定义为 $\tilde{w}(x, \xi) = w(|x-\xi|) / C(x)$。通过这种方式，可以保证对于任意点 $x \in \Omega$，单位分解条件 $\int_{\Omega} \tilde{w}(x, \xi) \, \mathrm{d}\xi = 1$ 都精确成立。

例如，对于一维区间 $\Omega=[0,L]$ 和指数核 $w(r) = \exp(-r/\ell)$，可以精确计算出重归一化因子为 [@problem_id:3546131]：

$$
C(x) = \ell\left(2-e^{-x/\ell}-e^{-(L-x)/\ell}\right)
$$

可以看出，当 $x$ 远离边界时（即 $x \gg \ell$ 且 $L-x \gg \ell$），指数项趋于零，$C(x)$ 趋近于其在无限域中的积分值 $2\ell$。而在靠近边界处，$C(x)$ 的值会减小，通过除以 $C(x)$，有效地放大了截断[核函数](@entry_id:145324)的权重，从而修正了边界效应。

### 正则化机制：[色散](@entry_id:263750)与[稳定性分析](@entry_id:144077)

非局部[积分算子](@entry_id:262332)到底是如何抑制病态局部化的？其深层机制在于它改变了系统对不同波长扰动的响应，即引入了**[色散](@entry_id:263750) (dispersion)**。我们可以通过[线性稳定性分析](@entry_id:154985)来揭示这一点 [@problem_id:3546084] [@problem_id:3546078]。

考虑一个处于均匀状态的材料，我们对其施加一个微小的、呈[谐波](@entry_id:181533)形式的扰动，例如应变扰动 $\delta\varepsilon(x) = \hat{\varepsilon} \exp(ikx)$，其中 $k$ 是波数（wavenumber），代表扰动的空间频率。非局部[平均算子](@entry_id:746605)是一个卷积运算，根据卷积定理，其在傅里叶空间中对应于乘法运算。对扰动进行非局部平均，我们得到：

$$
\delta\bar{\varepsilon}(x) = \tilde{w}(k) \, \delta\varepsilon(x)
$$

这里的 $\tilde{w}(k)$ 是核函数 $w(r)$ 的[傅里叶变换](@entry_id:142120)。它是一个依赖于波数 $k$ 的**[传递函数](@entry_id:273897) (transfer function)** 或滤波器。例如，对于高斯核 $w(r) = \frac{1}{\sqrt{\pi}l} \exp(-r^2/l^2)$，其[傅里叶变换](@entry_id:142120)为 $\tilde{w}(k) = \exp(-k^2 l^2/4)$ [@problem_id:3546084]。对于指数核 $w(r) = \frac{1}{2\ell}\exp(-|r|/\ell)$，其[傅里叶变换](@entry_id:142120)为 $\tilde{w}(k) = 1/(1+k^2\ell^2)$ [@problem_id:3546078]。

在软化材料中，线弹性[切线](@entry_id:268870)模量会因损伤或塑性而退化。对于一个[非局部模型](@entry_id:175315)，其增量本构关系 $\delta\sigma(x) = E_{\mathrm{eff}}(k) \delta\varepsilon(x)$ 中的有效[切线](@entry_id:268870)模量 $E_{\mathrm{eff}}$ 将依赖于波数 $k$。一个典型的表达式形如 [@problem_id:3546084]：

$$
E_{\mathrm{eff}}(k) = E_{\mathrm{loc}} \left( 1 - r \cdot \tilde{w}(k) \right)
$$

其中 $E_{\mathrm{loc}}$ 是局部[切线](@entry_id:268870)模量（在软化区为负），$r$ 是一个[无量纲参数](@entry_id:169335)，表征软化强度。关键在于 $\tilde{w}(k)$ 的性质：对于长波扰动（$k \to 0$），$\tilde{w}(k) \to 1$，[非局部模型](@entry_id:175315)退化为局部模型，系统可能不稳定 ($E_{\mathrm{eff}}  0$)。然而，对于短波扰动（$k \to \infty$），$\tilde{w}(k) \to 0$。这意味着非局部平均有效地“过滤”掉了高频（短波长）的扰动。因此，即使局部模型在所有波长下都不稳定，[非局部模型](@entry_id:175315)的[有效模量](@entry_id:748818) $E_{\mathrm{eff}}(k)$ 在高频区域仍可能保持为正。

系统稳定性的[临界点](@entry_id:144653)出现在 $E_{\mathrm{eff}}(k_c)=0$ 处，这个临界[波数](@entry_id:172452) $k_c$ 被称为**中性[波数](@entry_id:172452) (neutral wavenumber)** 或**截止波数 (cutoff wavenumber)**。只有波数小于 $k_c$ 的扰动才可能增长，而[波数](@entry_id:172452)大于 $k_c$ 的扰动则会被衰减。这保证了不稳定性被限制在有限的波长范围内，从而阻止了向无限窄带的坍缩，保证了最终局部化带具有由 $k_c$ (进而由 $\ell$) 控制的特征宽度。

### 与梯度正则化的关系

非局部积分模型与另一类重要的[正则化方法](@entry_id:150559)——梯度模型（gradient models）——有着密切的联系 [@problem_id:3546067]。如果局部场 $\varepsilon(x)$ 足够光滑，我们可以在非局部积分的定义中对 $\varepsilon(x+r)$ 进行泰勒展开：

$$
\bar{\varepsilon}(x) = \int_{-\infty}^{\infty} W(r) \left( \varepsilon(x) + r\,\varepsilon'(x) + \frac{r^2}{2}\,\varepsilon''(x) + \dots \right) \mathrm{d}r
$$

由于核函数 $W(r)$ 是[偶函数](@entry_id:163605)，其所有奇数阶矩（如 $\int r W(r) \mathrm{d}r$）均为零。因此，展开式变为：

$$
\bar{\varepsilon}(x) = \varepsilon(x) \left(\int_{-\infty}^{\infty} W(r)\,\mathrm{d}r\right) + \frac{\varepsilon''(x)}{2} \left(\int_{-\infty}^{\infty} r^2 W(r)\,\mathrm{d}r\right) + O(\varepsilon''''\!(x))
$$

利用[归一化条件](@entry_id:156486) $\int W(r)\mathrm{d}r=1$ 和二阶矩 $m_2 = \int r^2 W(r)\mathrm{d}r$，并忽略高阶项，我们得到：

$$
\bar{\varepsilon}(x) \approx \varepsilon(x) + \frac{m_2}{2} \varepsilon''(x)
$$

这正是一个隐式的二阶梯度模型的形式 $\bar{\varepsilon}(x) \approx \varepsilon(x) + \ell_g^2 \varepsilon''(x)$ [@problem_id:3546140]。这表明，对于变化缓慢的场，非局部积分模型可以被一个梯度模型近似。梯度模型的特征长度 $\ell_g$ 与积分核的二阶矩直接相关：$\ell_g^2 = m_2/2$。

例如，对于指数核 $W(r) = \frac{1}{2\ell}\exp(-|r|/\ell)$，其二阶矩为 $m_2 = 2\ell^2$。代入上式，我们发现其等效的梯度长度恰好为 $\ell_g = \ell$ [@problem_id:3546067]。这一联系不仅在理论上具有启发性，也为不同正则化模型之间的参数转换提供了依据。

总之，[非局部积分正则化](@entry_id:752662)通过引入[内禀长度尺度](@entry_id:750789)，从根本上改变了材料的本构描述，使其能够物理上合理且数学上适定地模拟软化和局部化过程。其核心机制包括：通过空间平均强制有限的局部化宽度，通过[核函数](@entry_id:145324)引入[色散](@entry_id:263750)以稳定短波扰动，并通过与物理可测量的量（如断裂能和[尺寸效应](@entry_id:153734)）相关联来确保模型的预测能力。