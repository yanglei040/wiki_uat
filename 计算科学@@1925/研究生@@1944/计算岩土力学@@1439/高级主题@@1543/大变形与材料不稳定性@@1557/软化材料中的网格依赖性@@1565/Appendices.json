{"hands_on_practices": [{"introduction": "理解断裂过程中的能量耗散是预测材料失效的关键。本练习对一维杆件进行了基础分析，对比了纯局部软化模型与正则化的裂纹带模型。通过解决这个问题 [@problem_id:3542798]，你将直接观察到为什么局部模型会产生病态的网格依赖性，以及如何使用断裂能 $G_f$ 进行正则化以确保获得物理上真实且客观的结果。", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的棱柱形一维杆，为进行有限元方法 (FEM) 分析，被离散化为 $N$ 个长度为 $h=L/N$ 的等长单元。该杆在准静态、位移控制的拉伸荷载作用下，达到峰值应力后，非弹性变形会局部化到一个长度为 $h$ 的单元内，而杆的其余部分则弹性卸载。该材料表现出线性弹性行为，直至在应变为 $\\varepsilon_{u}$ 时达到峰值应力 $\\sigma_{u}$，随后进入线性应变软化阶段，直至在破坏应变 $\\varepsilon_{f}(x)$ 时应力降为零，其中破坏应变通常可能依赖于空间坐标 $x$。耗散能定义为\n$$\nW_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx,\n$$\n其中 $\\sigma(\\varepsilon)$ 是软化分支上单轴应力随应变 $\\varepsilon$ 变化的函数。假设局部化恰好发生在一个单元内，在长度为 $h$ 的局部化单元之外，各处的 $\\varepsilon_{f}(x)=\\varepsilon_{u}$，并且在局部化单元内，软化分支在 $\\varepsilon_{u}$ 和 $\\varepsilon_{f}(x)$ 之间是严格线性的。\n\n从上述定义以及断裂能 $G_{f}$（被理解为产生单位面积裂纹所需的能量，即单位面积上的牵引-分离法则所做的功）的概念出发，并认识到在裂纹带正则化中，有效局部化宽度取为单元尺寸 $h$，推导以下情况的耗散能 $W_{d}$：\n- 对于纯局部应变软化材料，其中 $\\varepsilon_{f}(x)$ 是一个与 $h$ 无关的材料常数，以及\n- 对于裂纹带正则化材料，其中 $\\varepsilon_{f}(x)$ 的选取应使得局部化单元中的耗散能等于 $G_{f}A$。\n\n在两种情况下，使用上述积分定义显式计算 $W_{d}$，并论证正则化如何实现网格客观的能量耗散。以正则化情况下的单个闭式解析表达式形式给出最终答案。不需要数值，也无需四舍五入。最终能量以焦耳为单位表示，但最后的方框表达式应以不带单位的符号形式写出。", "solution": "在尝试解答之前，将对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 几何与离散化：一根长度为 $L$、横截面积恒为 $A$ 的一维杆，被离散为 $N$ 个长度为 $h = L/N$ 的等长单元。\n- 加载与局部化：准静态、位移控制的拉伸。变形局部化到一个长度为 $h$ 的单元内。杆的其余部分弹性卸载。\n- 本构关系：线性弹性行为，直至在应变为 $\\varepsilon_{u}$ 时达到峰值应力 $\\sigma_{u}$。随后是线性应变软化分支，直至在破坏应变 $\\varepsilon_{f}(x)$ 时应力降为零。\n- 耗散能定义：$W_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx$。\n- 假设：\n    1. 局部化恰好发生在一个单元内。\n    2. 除局部化单元外，各处的 $\\varepsilon_{f}(x)=\\varepsilon_{u}$。\n    3. 软化分支在 $(\\varepsilon_{u}, \\sigma_{u})$ 和 $(\\varepsilon_{f}, 0)$ 之间是严格线性的。\n- 断裂能 $G_f$：定义为产生单位面积裂纹所需的能量。\n- 正则化任务：\n    1. 推导局部材料的耗散能 $W_d$，其中 $\\varepsilon_f$ 是一个常数。\n    2. 推导正则化材料的耗散能 $W_d$，其中 $\\varepsilon_f(x)$ 的选取应使得局部化单元中的耗散能等于 $G_f A$。\n- 最终输出要求：为正则化情况下的耗散能提供一个单一的闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上是合理的、适定的和客观的。它探讨了应变软化材料计算建模中的经典问题——网格依赖性，这是计算力学中的一个基本课题。线性软化、断裂能 $G_f$ 和裂纹带正则化的概念都是标准的，并且描述正确。问题设定是自洽且逻辑清晰的。\n\n然而，在耗散能 $W_d$ 的定义中存在一个微小的歧义。所提供的积分 $W_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx$ 的单位是能量每单位面积 ($J/m^2$)，因为 $\\int\\sigma d\\varepsilon$ 的单位是应力（力/面积），而外层积分是对长度进行的。相比之下，问题稍后将局部化单元中的耗散能称为 $G_{f}A$，其单位是能量 ($J$)。此外，问题要求以“焦耳”为单位表示最终“能量”。这强烈表明 $W_d$ 意在表示杆中的总耗散能，这是一个对体积的积分。所提供的积分似乎缺少了横截面积 $A$。假设这是一个符号上的疏忽，那么通过使用物理上一致的总耗散能定义，该问题是可以解决的：\n$$ W_{d} = \\int_{V} \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(\\mathbf{x})} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dV = \\int_{0}^{L} A \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dx $$\n这种解释使得问题陈述完全一致。经过此澄清，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题是**有效的**，澄清了 $W_d$ 代表总耗散能。现在开始推导解答。\n\n解答过程首先推导总耗散能 $W_d$ 的一个通用表达式。然后将对两种指定的材料模型评估该表达式。\n\n比耗散能，即单位体积的耗散能 $w_d$，是软化阶段应力-应变曲线下的面积。给定一个从 $(\\varepsilon_{u}, \\sigma_{u})$ 到 $(\\varepsilon_{f}, 0)$ 的线性软化分支，这个面积是一个三角形的面积：\n$$ w_d = \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}} \\sigma(\\varepsilon) \\, d\\varepsilon = \\frac{1}{2} (\\varepsilon_f - \\varepsilon_u) \\sigma_u $$\n问题陈述指出，非弹性变形（因此也包括能量耗散）被限制在长度为 $h$ 的单个单元内。在此单元之外，材料弹性卸载，因此没有能量耗散。这个单一局部化单元的体积是 $V_{loc} = A \\cdot h$。\n整个杆的总耗散能 $W_d$ 是比耗散能乘以其发生的体积：\n$$ W_d = w_d \\cdot V_{loc} = \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h $$\n这个通用表达式构成了分析两种情况的基础。\n\n**情况 1：纯局部应变软化材料**\n在纯局部本构模型中，材料属性被认为是固有的，且与离散化无关。因此，破坏应变 $\\varepsilon_f$ 是一个恒定的材料参数，我们称之为 $\\varepsilon_{f,m}$。将此代入 $W_d$ 的通用表达式中：\n$$ W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h $$\n这个结果表明，总耗散能与单元尺寸 $h$ 成正比。随着有限元网格的细化，$h \\to 0$，因此 $W_{d, \\text{local}} \\to 0$。这意味着对于无限精细的网格，结构断裂将不需要任何能量，这是一个物理上不真实的、被称为病态网格依赖性的结果。\n\n**情况 2：裂纹带正则化材料**\n裂纹带模型通过强制要求局部化带中耗散的总能量等于一个与网格无关的材料属性来对问题进行正则化。问题指定该能量为 $G_f A$，其中 $G_f$ 是断裂能（每单位裂纹面积的能量）。由于能量耗散仅发生在局部化单元内，因此整个杆的总耗散能 $W_d$ 必须等于这个值。\n$$ W_{d, \\text{reg}} = G_f A $$\n根据定义，这就是正则化情况下的耗散能。为了达到这个网格客观的结果，材料参数 $\\varepsilon_f$ 不能再是一个常数。相反，它必须根据单元尺寸 $h$ 进行调整。我们通过将 $W_d$ 的通用表达式与目标正则化能量相等来施加该条件：\n$$ \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h = G_f A $$\n我们可以求解所需的破坏应变 $\\varepsilon_f$ 作为 $h$ 的函数：\n$$ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) h = G_f $$\n$$ \\varepsilon_f - \\varepsilon_u = \\frac{2 G_f}{\\sigma_u h} $$\n$$ \\varepsilon_f(h) = \\varepsilon_u + \\frac{2 G_f}{\\sigma_u h} $$\n这个关系表明，对于正则化模型，材料的软化模量不是恒定的，而是根据单元尺寸 $h$ 进行调整，以确保断裂功保持不变。随着网格的细化 ($h \\to 0$)，所需的破坏应变 $\\varepsilon_f \\to \\infty$，这使得应力-应变图中的软化响应更脆，但确保了总能量耗散保持恒定且具有物理意义。\n\n**网格客观耗散的论证**\n对两种情况的比较展示了正则化的效果：\n- 对于局部模型，$W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h$。耗散能依赖于网格尺寸 $h$，并且当 $h \\to 0$ 时趋于零。\n- 对于正则化模型，$W_{d, \\text{reg}} = G_f A$。耗散能是一个恒定的材料属性，与网格尺寸 $h$ 无关。\n\n通过使本构律（特别是软化行为）依赖于单元尺寸，裂纹带模型确保了断裂过程中消耗的总能量是一个网格客观的量，从而解决了在局部模型中观察到的病态依赖性。\n\n所要求的最终答案是正则化情况下总耗散能的单一闭式解析表达式。根据问题中给出的正则化程序的定义，这个能量是 $G_f A$。", "answer": "$$\n\\boxed{G_f A}\n$$", "id": "3542798"}, {"introduction": "从理论走向实践，我们必须用可测量的材料属性（如断裂能 $G_f$）来校准本构模型。这个问题 [@problem_id:3542867] 将引导你完成校准一个特定指数损伤演化律的全过程。通过将抽象的模型参数 $\\beta$ 与物理量 $G_f$ 联系起来，你将掌握一项关键技能，即创建具有预测性且网格客观的材料失效模拟。", "problem": "考虑一个土工材料的一维拉伸试验，该试验在有限元法（FEM）中由一个长度为 $l_{c}$ 的单常应变单元表示。该材料由各向同性标量损伤公式建模，其单位体积的亥姆霍兹自由能密度为\n$$\\psi(\\varepsilon,d) = \\tfrac{1}{2}\\,(1-d)\\,E\\,\\varepsilon^{2},$$\n其中 $E$ 是杨氏模量，$\\varepsilon$ 是轴向应变，$d \\in [0,1]$ 是标量损伤变量。等效应变取为轴向应变，因此在单轴拉伸下 $\\kappa = \\varepsilon$。当轴向应力首次达到抗拉强度 $f_{t}$ 时，损伤开始发生，这发生在弹性极限应变处\n$$\\varepsilon_{0}=\\frac{f_{t}}{E}。$$\n超过 $\\varepsilon_{0}$ 时，损伤根据单调指数定律演化\n$$d(\\kappa)=1-\\exp\\!\\left(-\\frac{\\kappa-\\kappa_{0}}{\\beta}\\right)\\quad\\text{for}\\quad \\kappa\\ge\\kappa_{0},$$\n对于 $\\kappa\\le\\kappa_{0}$ 有 $d(\\kappa)=0$，其中 $\\kappa_{0}=\\varepsilon_{0}$ 且 $\\beta0$ 是一个待标定的无量纲模型参数。\n\n在单轴拉伸下，柯西应力为 $\\sigma(\\varepsilon)=(1-d)E\\varepsilon$。假设应变在单个单元内局部化，因此单位裂纹面积的耗散能（断裂能）等于沿软化分支积分的单位体积功，再乘以特征长度 $l_{c}$。施加断裂能匹配条件\n$$G_{f}=l_{c}\\int_{\\varepsilon_{0}}^{\\infty}\\sigma(\\varepsilon)\\,\\mathrm{d}\\varepsilon.$$\n\n给定 $E=1.0\\times 10^{10}\\,\\mathrm{Pa}$，$f_{t}=2.0\\times 10^{6}\\,\\mathrm{Pa}$，$l_{c}=0.10\\,\\mathrm{m}$ 以及 $G_{f}=30\\,\\mathrm{N/m}$，确定 $\\beta$ 的标定值，以满足上述断裂能条件并保持网格客观的能量耗散。将您的最终答案表示为一个无量纲数，并四舍五入到三位有效数字。", "solution": "该问题陈述科学基础扎实、内容自洽、数学上适定。它描述了计算力学中正则化应变软化模型的一种标准程序，称为裂纹带模型，以确保断裂过程中的能量耗散具有网格客观性。任务是确定软化参数 $\\beta$ 的值，使其满足给定的断裂能条件。\n\n断裂能匹配条件由下式给出：\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon$$\n其中 $G_f$ 是断裂能，$l_c$ 是有限元的特征长度，积分代表了软化过程中单位体积耗散的能量。积分从弹性极限应变 $\\varepsilon_{0}$ 开始，该应变对应于损伤和软化的开始。\n\n柯西应力 $\\sigma$ 定义为 $\\sigma(\\varepsilon) = (1-d)E\\varepsilon$，其中 $E$ 是杨氏模量，$\\varepsilon$ 是轴向应变，$d$ 是损伤变量。\n对于软化阶段，即应变 $\\varepsilon \\ge \\varepsilon_{0}$，问题陈述指出，所经历的最大应变（内变量 $\\kappa$）等于当前应变，因此 $\\kappa = \\varepsilon$。对于 $\\kappa \\ge \\kappa_{0} = \\varepsilon_{0}$，损伤演化定律为：\n$$d(\\kappa) = d(\\varepsilon) = 1 - \\exp\\left(-\\frac{\\varepsilon - \\varepsilon_{0}}{\\beta}\\right)$$\n将该损伤表达式代入应力定义，得到沿软化分支的应力-应变关系：\n$$\\sigma(\\varepsilon) = \\left(1 - \\left[1 - \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)\\right]\\right) E\\varepsilon$$\n$$\\sigma(\\varepsilon) = E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)$$\n现在我们可以将 $\\sigma(\\varepsilon)$ 的表达式代入断裂能积分中：\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\n为了求解此积分，我们可以提出常数项并进行变量替换。我们重写指数项：\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\n该积分可以使用分部积分法求解，即 $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$。令：\n$u = \\varepsilon \\implies \\mathrm{d}u = \\mathrm{d}\\varepsilon$\n$\\mathrm{d}v = \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon \\implies v = -\\beta \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)$\n\n将此应用于定积分：\n$$\\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon = \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty} - \\int_{\\varepsilon_{0}}^{\\infty} \\left(-\\beta\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right) \\mathrm{d}\\varepsilon$$\n$$= \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty} + \\beta \\left[-\\beta\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty}$$\n$$= \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) - \\beta^{2}\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty}$$\n计算在积分上下限处的值：\n当 $\\varepsilon \\to \\infty$ 时，$\\varepsilon\\exp(-\\varepsilon/\\beta)$ 和 $\\exp(-\\varepsilon/\\beta)$ 两项都趋于 $0$，因为指数衰减快于线性增长。\n当 $\\varepsilon = \\varepsilon_{0}$ 时，表达式为 $-\\beta\\varepsilon_{0}\\exp(-\\varepsilon_{0}/\\beta) - \\beta^{2}\\exp(-\\varepsilon_{0}/\\beta)$。\n所以，该定积分的值为：\n$$0 - \\left(-\\beta\\varepsilon_{0}\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right) - \\beta^{2}\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right)\\right) = (\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right)$$\n将此结果代回 $G_f$ 的方程中：\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\left[ (\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right) \\right]$$\n指数项相互抵消，得到一个简单的代数关系：\n$$G_{f} = l_{c} E (\\beta\\varepsilon_{0} + \\beta^{2})$$\n问题给出 $\\varepsilon_{0} = f_{t}/E$。将其代入方程中：\n$$G_{f} = l_{c} E \\left(\\beta\\frac{f_{t}}{E} + \\beta^{2}\\right) = l_{c} f_{t} \\beta + l_{c} E \\beta^{2}$$\n这是一个关于 $\\beta$ 的二次方程：\n$$(l_{c} E) \\beta^{2} + (l_{c} f_{t}) \\beta - G_{f} = 0$$\n我们使用二次公式 $\\beta = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\beta$，其中系数为 $a = l_{c}E$，$b = l_{c}f_{t}$ 和 $c = -G_{f}$。\n$$\\beta = \\frac{-(l_{c} f_{t}) \\pm \\sqrt{(l_{c} f_{t})^{2} - 4(l_{c} E)(-G_{f})}}{2 (l_{c} E)}$$\n$$\\beta = \\frac{-l_{c} f_{t} \\pm \\sqrt{(l_{c} f_{t})^{2} + 4 l_{c} E G_{f}}}{2 l_{c} E}$$\n由于模型要求 $\\beta  0$，我们必须取正根：\n$$\\beta = \\frac{-l_{c} f_{t} + \\sqrt{(l_{c} f_{t})^{2} + 4 l_{c} E G_{f}}}{2 l_{c} E}$$\n现在，我们代入给定的数值：\n$E = 1.0 \\times 10^{10}\\,\\mathrm{Pa}$\n$f_{t} = 2.0 \\times 10^{6}\\,\\mathrm{Pa}$\n$l_{c} = 0.10\\,\\mathrm{m}$\n$G_{f} = 30\\,\\mathrm{N/m}$\n\n我们来计算各项：\n$l_{c} E = (0.10\\,\\mathrm{m})(1.0 \\times 10^{10}\\,\\mathrm{N/m^{2}}) = 1.0 \\times 10^{9}\\,\\mathrm{N/m}$\n$l_{c} f_{t} = (0.10\\,\\mathrm{m})(2.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}) = 2.0 \\times 10^{5}\\,\\mathrm{N/m}$\n$(l_{c} f_{t})^{2} = (2.0 \\times 10^{5}\\,\\mathrm{N/m})^{2} = 4.0 \\times 10^{10}\\,(\\mathrm{N/m})^{2}$\n$4 l_{c} E G_{f} = 4 (1.0 \\times 10^{9}\\,\\mathrm{N/m}) (30\\,\\mathrm{N/m}) = 120 \\times 10^{9}\\,(\\mathrm{N/m})^{2} = 1.2 \\times 10^{11}\\,(\\mathrm{N/m})^{2}$\n\n现在将这些值代入 $\\beta$ 的表达式中：\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{4.0 \\times 10^{10} + 1.2 \\times 10^{11}}}{2 (1.0 \\times 10^{9})}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{0.4 \\times 10^{11} + 1.2 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{1.6 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{16 \\times 10^{10}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + 4.0 \\times 10^{5}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{2.0 \\times 10^{5}}{2.0 \\times 10^{9}} = 1.0 \\times 10^{-4}$$\n问题要求答案四舍五入到三位有效数字。因此，值为 $1.00 \\times 10^{-4}$。", "answer": "$$\\boxed{1.00 \\times 10^{-4}}$$", "id": "3542867"}, {"introduction": "网格依赖性的表现形式可能很微妙，并不仅限于单元尺寸。本练习 [@problem_id:3542841] 探讨了单元类型（线性与二次）及其各自的数值积分方案如何影响非正则化模型预测的能量耗散。这个练习揭示了局部化通常会收缩到最小的可能区域——即单个积分点——这突显了计算工程师需要识别的一个关键数值伪影。", "problem": "考虑一根长度为 $L$、横截面积为 $A$ 的一维（$1\\text{D}$）均质杆。该杆使用有限元（FE）方法进行离散化，并承受单调轴向拉伸载荷。该材料在达到峰值应力前表现为线性弹性，之后线性应变软化至应力为零。本问题的目的在于：形式化、计算并比较一个纯局部（非正则化）的应变软化本构律，如何通过将应变局部化坍缩至最小可用数值积分区域，从而引发网格依赖性；并强调线性和二次单元类型在此过程中的差异。\n\n从以下基础开始：\n- 一维虚功原理：内功密度是应力与应变的乘积在体积上的积分。\n- 在父域 $\\xi \\in [-1,1]$ 上使用高斯-勒让德（GL）求积法进行有限元中的数值积分。对于两节点线性单元，使用单点GL求积，其积分点为 $\\xi_1 = 0$，权重为 $w_1 = 2$。对于三节点二次单元，使用两点GL求积，其积分点为 $\\xi_1 = -1/\\sqrt{3}$ 和 $\\xi_2 = +1/\\sqrt{3}$，权重为 $w_1 = 1$ 和 $w_2 = 1$。\n- 从父域到物理坐标的映射是仿射的，其雅可比行列式为 $J = L_e/2$，其中 $L_e$ 是单元的物理长度。与高斯点 $i$ 相关的物理积分权重为 $w_i J$。\n- 所有计算中，横截面积为 $A = 1\\,\\text{m}^2$。\n\n本构行为定义为一个线性弹性分支，在应变为 $\\varepsilon_0$ 时达到峰值应力 $\\sigma_0$，随后线性软化至应变为 $\\varepsilon_f  \\varepsilon_0$ 时应力为零：\n- 线性弹性：$\\sigma(\\varepsilon) = E\\,\\varepsilon$，适用于 $0 \\le \\varepsilon \\le \\varepsilon_0$，其中 $\\varepsilon_0 = \\sigma_0/E$。\n- 线性软化：$\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right)$，适用于 $\\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f$，其中 $\\sigma(\\varepsilon_f) = 0$。\n\n假设存在以下局部化情景，这与没有任何正则化的局部应变软化行为一致：当杆被加载时，椭圆性的丧失导致应变局部化，并坍缩到网格中的单个高斯点上。因此，只有一个高斯点对不可逆的软化功有贡献，其空间影响范围等于该点的物理积分权重 $w_\\star J$。由于有限元求积将单元划分为多个积分区域，最小的积分区域决定了局部化长度。对于线性单元，该区域跨越整个单元（$w_1 J = L_e$），而对于二次单元，每个高斯点跨越单元的一半（$w_i J = L_e/2$）。\n\n将体积软化功密度定义为应力-应变曲线软化分支下的面积，\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon,\n$$\n并将此局部有限元离散化预测的单位面积表观断裂能定义为\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}},\n$$\n其中 $l_{\\text{loc}}$ 是局部化长度，等于发生软化坍缩的单个高斯点的物理积分权重 $w_\\star J$（对于线性单元，$l_{\\text{loc}} = L_e$；对于二次单元，$l_{\\text{loc}} = L_e/2$）。量 $G_{\\text{app}}$ 必须以 $\\text{N/m}$ 为单位报告。\n\n您的任务是实现一个程序，对每个测试用例计算：\n- 由线性单元组成的网格的单位面积表观断裂能，$G_{\\text{app}}^{\\text{lin}}$。\n- 由二次单元组成的网格的单位面积表观断裂能，$G_{\\text{app}}^{\\text{quad}}$。\n- 比率 $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$。如果 $G_{\\text{app}}^{\\text{lin}}$ 和 $G_{\\text{app}}^{\\text{quad}}$ 均为零（即没有软化，$\\varepsilon_f \\le \\varepsilon_0$），则定义 $r = 1$。\n\n所有输入必须使用国际单位制（SI单位）：$E$ 的单位为 $\\text{Pa}$，$\\sigma_0$ 的单位为 $\\text{Pa}$，$\\varepsilon_f$ 为无量纲，$L_e$ 的单位为 $\\text{m}$。$G_{\\text{app}}$ 的所有输出必须以 $\\text{N/m}$ 为单位。\n\n使用以下参数值测试套件 $(L_e, E, \\sigma_0, \\varepsilon_f)$：\n- 情况 $1$（一般情况）：$L_e = 0.5\\,\\text{m}$, $E = 3.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 3.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.006$。\n- 情况 $2$（一般情况）：$L_e = 0.25\\,\\text{m}$, $E = 2.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.003$。\n- 情况 $3$（边界情况，无软化）：$L_e = 1.0\\,\\text{m}$, $E = 4.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 4.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.001$。\n- 情况 $4$（边缘情况，极小单元）：$L_e = 0.001\\,\\text{m}$, $E = 2.5 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.5 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.005$。\n- 情况 $5$（边缘情况，大单元）：$L_e = 2.0\\,\\text{m}$, $E = 3.5 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.8 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.007$。\n\n您的程序应生成单行输出，其中包含每个情况的列表 $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$，能量的单位为 $\\text{N/m}$，比率为无量纲。将所有五个情况聚合到一个外部列表中，并严格按照逗号分隔列表的形式打印，并用方括号括起来，例如：\n$[[G_{1}^{\\text{lin}}, G_{1}^{\\text{quad}}, r_1], [G_{2}^{\\text{lin}}, G_{2}^{\\text{quad}}, r_2], \\dots, [G_{5}^{\\text{lin}}, G_{5}^{\\text{quad}}, r_5]]$。", "solution": "该问题是有效的，因为它在科学上基于计算固体力学的原理，特别是应用于应变软化材料的有限元方法。该问题是适定的、客观的，并包含了获得唯一解所需的所有信息。所描述的情景是局部连续介质损伤模型中病态网格依赖性的一个经典教科书示例。\n\n求解需要计算两种不同有限元类型下的单位面积表观断裂能 $G_{\\text{app}}$：一种是 $2$ 节点线性单元，另一种是 $3$ 节点二次单元。问题的核心在于理解单元选择及其数值积分方案如何影响应变局部化过程中计算出的能量耗散。\n\n单位面积表观断裂能定义为：\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}\n$$\n其中 $g_{\\text{soft}}$ 是体积软化功密度（单位体积的能量），$l_{\\text{loc}}$ 是局部化长度，这是数值离散化的产物。\n\n首先，我们必须确定体积软化功密度 $g_{\\text{soft}}$。它被定义为应力-应变曲线软化部分的面积，从峰值应力对应的应变 $\\varepsilon_0$ 到应力恢复为零的最终应变 $\\varepsilon_f$。\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon\n$$\n软化行为被给出为应变的线性函数：\n$$\n\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right) \\quad \\text{for} \\quad \\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f\n$$\n这描述了一条从点 $(\\varepsilon_0, \\sigma_0)$ 到 $(\\varepsilon_f, 0)$ 的直线。因此，$g_{\\text{soft}}$ 的积分是底为 $(\\varepsilon_f - \\varepsilon_0)$、高为 $\\sigma_0$ 的直角三角形的面积。\n$$\ng_{\\text{soft}} = \\frac{1}{2} \\cdot (\\text{base}) \\cdot (\\text{height}) = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0)\n$$\n此计算仅在发生软化时有效，即当 $\\varepsilon_f  \\varepsilon_0$ 时。峰值应力处的应变 $\\varepsilon_0$ 由弹性特性决定：$\\varepsilon_0 = \\sigma_0 / E$。如果 $\\varepsilon_f \\le \\varepsilon_0$，材料在单调加载下不会进入软化阶段，因此不做软化功，且 $g_{\\text{soft}} = 0$。$g_{\\text{soft}}$ 的单位是压力（$\\text{Pa}$ 或 $\\text{N/m}^2$）乘以无量纲应变，结果为 $\\text{N/m}^2$ 或 $\\text{J/m}^3$，即单位体积的能量。\n\n接下来，我们讨论局部化长度 $l_{\\text{loc}}$。问题指出，应变局部化坍缩到单个高斯点上。该高斯点材料行为所积分的物理“体积”（在此一维情况下为长度）对总能量耗散有贡献。这个局部化长度由该高斯点的物理积分权重给出，即其父单元权重 $w_\\star$ 与映射的雅可比行列式 $J$ 的乘积。\n从长度为 $2$（从 $\\xi=-1$ 到 $\\xi=1$）的父单元到长度为 $L_e$ 的物理单元的仿射映射的雅可比行列式为 $J = L_e/2$。\n\n对于一个 $2$ 节点线性单元，使用位于 $\\xi_1 = 0$ 处、权重为 $w_1 = 2$ 的单个高斯-勒让德点。\n线性单元的局部化长度为：\n$$\nl_{\\text{loc}}^{\\text{lin}} = w_1 \\cdot J = 2 \\cdot \\frac{L_e}{2} = L_e\n$$\n这意味着局部化带的宽度等于整个单元的长度。\n\n对于一个 $3$ 节点二次单元，使用两个高斯点：$\\xi_1 = -1/\\sqrt{3}$ 和 $\\xi_2 = +1/\\sqrt{3}$，每个点的权重为 $w_1 = w_2 = 1$。假设局部化坍缩到其中一个点上。\n二次单元的局部化长度基于单个高斯点：\n$$\nl_{\\text{loc}}^{\\text{quad}} = w_i \\cdot J = 1 \\cdot \\frac{L_e}{2} = \\frac{L_e}{2}\n$$\n在此，局部化带的宽度是单元长度的一半。\n\n现在我们可以写出两种单元类型的表观断裂能表达式。单位为 $(\\text{N}/\\text{m}^2) \\cdot \\text{m} = \\text{N}/\\text{m}$，符合要求。\n$$\nG_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{lin}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) L_e\n$$\n$$\nG_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{quad}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) \\frac{L_e}{2}\n$$\n\n最后，我们计算比率 $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$。\n如果发生软化（$\\varepsilon_f  \\varepsilon_0$），则 $g_{\\text{soft}}  0$。比率为：\n$$\nr = \\frac{g_{\\text{soft}} \\cdot L_e}{g_{\\text{soft}} \\cdot L_e/2} = 2\n$$\n这表明对于给定的单元尺寸 $L_e$，线性单元预测的断裂能是二次单元的两倍，这是不同的积分方案影响数值局部化长度的直接后果。\n如果没有软化（$\\varepsilon_f \\le \\varepsilon_0$），则 $g_{\\text{soft}} = 0$，导致 $G_{\\text{app}}^{\\text{lin}} = 0$ 且 $G_{\\text{app}}^{\\text{quad}} = 0$。问题规定在这种情况下，比率定义为 $r=1$。\n\n每个测试用例 $(L_e, E, \\sigma_0, \\varepsilon_f)$ 的计算步骤如下：\n$1$. 计算峰值应力处的应变：$\\varepsilon_0 = \\sigma_0 / E$。\n$2$. 检查是否 $\\varepsilon_f  \\varepsilon_0$。\n$3$. 如果为真（发生软化）：\n   a. 计算 $g_{\\text{soft}} = 0.5 \\cdot \\sigma_0 \\cdot (\\varepsilon_f - \\varepsilon_0)$。\n   b. 计算 $G_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot L_e$。\n   c. 计算 $G_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot L_e / 2.0$。\n   d. 比率为 $r = 2.0$。\n$4$. 如果为假（无软化）：\n   a. $G_{\\text{app}}^{\\text{lin}} = 0.0$。\n   b. $G_{\\text{app}}^{\\text{quad}} = 0.0$。\n   c. 比率为 $r = 1.0$。\n$5$. 以列表 $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$ 的形式返回结果。\n此过程适用于所有提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes apparent fracture energy for linear and quadratic elements\n    to demonstrate mesh dependency in strain-softening materials.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_e, E, sigma_0, epsilon_f)\n    # L_e: element length (m)\n    # E: Young's modulus (Pa)\n    # sigma_0: peak stress (Pa)\n    # epsilon_f: final strain (dimensionless)\n    test_cases = [\n        (0.5, 3.0e10, 3.0e7, 0.006),    # Case 1\n        (0.25, 2.0e10, 2.0e7, 0.003),   # Case 2\n        (1.0, 4.0e10, 4.0e7, 0.001),    # Case 3\n        (0.001, 2.5e10, 2.5e7, 0.005),  # Case 4\n        (2.0, 3.5e10, 2.8e7, 0.007)     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        L_e, E, sigma_0, epsilon_f = case\n\n        # Calculate the strain at peak stress\n        epsilon_0 = sigma_0 / E\n\n        # Check if softening occurs\n        if epsilon_f  epsilon_0:\n            # Calculate volumetric softening work density (area of softening triangle)\n            g_soft = 0.5 * sigma_0 * (epsilon_f - epsilon_0)\n\n            # Localization length for linear element is L_e\n            l_loc_lin = L_e\n            # Apparent fracture energy for linear element\n            G_app_lin = g_soft * l_loc_lin\n\n            # Localization length for quadratic element is L_e / 2\n            l_loc_quad = L_e / 2.0\n            # Apparent fracture energy for quadratic element\n            G_app_quad = g_soft * l_loc_quad\n            \n            # The ratio of apparent fracture energies\n            r = 2.0\n        else:\n            # No softening branch is activated\n            G_app_lin = 0.0\n            G_app_quad = 0.0\n            # Per problem statement, ratio is 1 if no softening\n            r = 1.0\n        \n        results.append([G_app_lin, G_app_quad, r])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the example.\n    print(str(results).replace(\"'\", '\"'))\n\nsolve()\n```", "id": "3542841"}]}