{"hands_on_practices": [{"introduction": "在许多地热系统中，裂隙是流体和热量的主要运移通道。本练习 [@problem_id:3528038] 演示了如何将单个裂隙的属性（微观尺度）放大到整个岩体的等效渗透率（宏观尺度），这是任何储层建模的一项基本技能。通过这个练习，你将深入理解裂隙几何形状如何决定性地影响流动的方向性，即渗透率的各向异性。", "problem": "一个地热储层由一个离散裂缝网络（DFN）表示，其中岩石基质的渗透率与裂缝相比可以忽略不计。在所关注的尺度上，该离散裂缝网络由两组正交、垂直、贯通的裂缝组成，它们具有周期性且空间上均匀分布。为计算渗透率，假设流体为牛顿流体，其流动为稳态、不可压缩的层流，并忽略热、化学及孔隙弹性耦合效应。\n\n- 裂缝组1的平均力学开度为 $b_{1} = 200\\,\\mu\\mathrm{m}$，平均间距为 $s_{1} = 5\\,\\mathrm{m}$，其裂缝迹线在平面图中与 $x$ 方向平行。\n- 裂缝组2的平均力学开度为 $b_{2} = 50\\,\\mu\\mathrm{m}$，平均间距为 $s_{2} = 2\\,\\mathrm{m}$，其裂缝迹线在平面图中与 $y$ 方向平行。\n\n将每条裂缝局部处理为由开度隔开的两个光滑平行板，并利用第一性原理（狭缝中的流体动量平衡和代表性单元体积平均法）推导与分别沿 $x$ 轴和 $y$ 轴的水平流动相关的均质化方向渗透率 $k_{x}$ 和 $k_{y}$ 的表达式。然后根据给定数据计算 $k_{x}$ 和 $k_{y}$。\n\n最后，用一两句话，根据推导出的表达式，从物理上解释哪个方向的渗透性更强及其原因。\n\n将 $k_{x}$ 和 $k_{y}$ 的最终数值结果以 $\\mathrm{m}^{2}$ 为单位表示，并四舍五入至三位有效数字。以数对 $\\left(k_{x},\\,k_{y}\\right)$ 的形式给出最终答案。", "solution": "该问题经检验在科学上是合理的、适定的和客观的。它提出了一个裂缝介质水文地质学中的标准（尽管是理想化的）问题，需要从第一性原理进行推导。\n\n我们首先建立单个裂缝中流量与压力梯度的关系，该裂缝被模型化为两个光滑的平行板。我们考虑动态粘度为 $\\mu$ 的牛顿流体的稳态、不可压缩层流。设裂缝的方位使得流动方向为 $x$ 方向，平行板位于 $z = \\pm b/2$ 处，其中 $b$ 是裂缝开度。控制方程是针对此几何形状简化的纳维-斯托克斯方程，它描述了动量平衡：\n$$\n\\frac{d^2 v_x}{dz^2} = \\frac{1}{\\mu} \\frac{dp}{dx}\n$$\n此处，$v_x$ 是 $x$ 方向的流体速度，仅随 $z$ 变化，而 $\\frac{dp}{dx}$ 是驱动流动的恒定压力梯度。\n\n我们将此方程对 $z$ 积分两次：\n$$\n\\frac{dv_x}{dz} = \\frac{1}{\\mu} \\frac{dp}{dx} z + C_1\n$$\n$$\nv_x(z) = \\frac{1}{2\\mu} \\frac{dp}{dx} z^2 + C_1 z + C_2\n$$\n积分常数 $C_1$ 和 $C_2$ 通过应用无滑移边界条件 $v_x(z = \\pm b/2) = 0$ 来确定。\n由于速度剖面的对称性，最大速度必然出现在 $z=0$ 处，这意味着 $\\frac{dv_x}{dz}|_{z=0} = 0$。由此得出 $C_1 = 0$。\n在 $z = b/2$ 处应用第二个边界条件：\n$$\n0 = \\frac{1}{2\\mu} \\frac{dp}{dx} \\left(\\frac{b}{2}\\right)^2 + C_2 \\implies C_2 = -\\frac{b^2}{8\\mu} \\frac{dp}{dx}\n$$\n将常数代回，我们得到抛物线型速度剖面：\n$$\nv_x(z) = \\frac{1}{2\\mu} \\frac{dp}{dx} \\left( z^2 - \\frac{b^2}{4} \\right) = -\\frac{1}{2\\mu} \\left(-\\frac{dp}{dx}\\right) \\left( \\frac{b^2}{4} - z^2 \\right)\n$$\n裂缝单位宽度上的体积流量 $q_f$ 可通过沿开度积分速度剖面得到：\n$$\nq_f = \\int_{-b/2}^{b/2} v_x(z) \\,dz = \\frac{1}{2\\mu}\\frac{dp}{dx} \\int_{-b/2}^{b/2} \\left( z^2 - \\frac{b^2}{4} \\right) \\,dz\n$$\n$$\nq_f = \\frac{1}{2\\mu}\\frac{dp}{dx} \\left[ \\frac{z^3}{3} - \\frac{b^2 z}{4} \\right]_{-b/2}^{b/2} = \\frac{1}{2\\mu}\\frac{dp}{dx} \\left[ 2 \\left( \\frac{(b/2)^3}{3} - \\frac{b^2(b/2)}{4} \\right) \\right]\n$$\n$$\nq_f = \\frac{1}{\\mu}\\frac{dp}{dx} \\left( \\frac{b^3}{24} - \\frac{b^3}{8} \\right) = \\frac{1}{\\mu}\\frac{dp}{dx} \\left( \\frac{b^3 - 3b^3}{24} \\right) = -\\frac{b^3}{12\\mu} \\frac{dp}{dx}\n$$\n这个结果是著名的平行板间流动的立方定律。\n\n接下来，我们将裂缝介质均质化，以求得等效的方向渗透率 $k_x$ 和 $k_y$。我们使用代表性单元体积（REV）法。岩石基质的渗透率可以忽略不计，因此所有流动都由裂缝承担。\n\n为求 $k_x$，我们考虑一个沿 $x$ 方向的宏观压力梯度。流动沿着裂缝组1发生，该裂缝组由迹线与 $x$ 方向平行的垂直裂缝组成（即平行于 $x-z$ 平面的平面）。这些裂缝的开度为 $b_1$，间距为 $s_1$。考虑一个尺寸为 $L_x \\times L_y \\times L_z$ 的代表性单元体积。$x$ 方向的宏观达西通量 $Q_x$ 是总的体积流量 $\\mathcal{V}_x$ 除以垂直于流动的总面积 $A_x = L_y L_z$。\n在长度 $L_y$ 上穿过面积 $A_x$ 的裂缝组1的数量是 $N_1 = L_y / s_1$。\n总体积流量是单个裂缝中的流量乘以裂缝数量：\n$$\n\\mathcal{V}_x = N_1 \\times (q_{f1} \\times L_z) = \\left( \\frac{L_y}{s_1} \\right) \\left( -\\frac{b_1^3}{12\\mu} \\frac{dp}{dx} \\right) L_z\n$$\n达西通量则为：\n$$\nQ_x = \\frac{\\mathcal{V}_x}{A_x} = \\frac{1}{L_y L_z} \\left( \\frac{L_y L_z}{s_1} \\right) \\left( -\\frac{b_1^3}{12\\mu} \\frac{dp}{dx} \\right) = -\\frac{b_1^3}{12\\mu s_1} \\frac{dp}{dx}\n$$\n根据定义，均质化介质的达西定律为 $Q_x = -\\frac{k_x}{\\mu} \\frac{DP}{dx}$，其中 $k_x$ 是渗透率，$\\frac{DP}{dx}$ 是宏观压力梯度，它等同于裂缝中的局部梯度 $\\frac{dp}{dx}$。比较 $Q_x$ 的两个表达式，我们确定 $x$ 方向的渗透率为：\n$$\nk_x = \\frac{b_1^3}{12 s_1}\n$$\n通过对由裂缝组2（开度为 $b_2$，间距为 $s_2$）承载的 $y$ 方向流动进行相同的论证，我们得到 $y$ 方向的渗透率为：\n$$\nk_y = \\frac{b_2^3}{12 s_2}\n$$\n现在我们代入给定的数值。所有长度单位都必须是米。\n给定：\n$b_1 = 200\\,\\mu\\mathrm{m} = 200 \\times 10^{-6}\\,\\mathrm{m} = 2.0 \\times 10^{-4}\\,\\mathrm{m}$\n$s_1 = 5\\,\\mathrm{m}$\n$b_2 = 50\\,\\mu\\mathrm{m} = 50 \\times 10^{-6}\\,\\mathrm{m} = 5.0 \\times 10^{-5}\\,\\mathrm{m}$\n$s_2 = 2\\,\\mathrm{m}$\n\n计算 $k_x$：\n$$\nk_x = \\frac{(2.0 \\times 10^{-4}\\,\\mathrm{m})^3}{12 \\times (5\\,\\mathrm{m})} = \\frac{8.0 \\times 10^{-12}\\,\\mathrm{m}^3}{60\\,\\mathrm{m}} = \\frac{8.0}{60} \\times 10^{-12}\\,\\mathrm{m}^2 \\approx 1.333... \\times 10^{-13}\\,\\mathrm{m}^2\n$$\n四舍五入到三位有效数字，$k_x = 1.33 \\times 10^{-13}\\,\\mathrm{m}^2$。\n\n计算 $k_y$：\n$$\nk_y = \\frac{(5.0 \\times 10^{-5}\\,\\mathrm{m})^3}{12 \\times (2\\,\\mathrm{m})} = \\frac{125 \\times 10^{-15}\\,\\mathrm{m}^3}{24\\,\\mathrm{m}} = \\frac{125}{24} \\times 10^{-15}\\,\\mathrm{m}^2 \\approx 5.2083... \\times 10^{-15}\\,\\mathrm{m}^2\n$$\n四舍五入到三位有效数字，$k_y = 5.21 \\times 10^{-15}\\,\\mathrm{m}^2$。\n\n最后，我们解释渗透率各向异性的物理原因。$x$ 方向的渗透性明显更强（$k_x \\gg k_y$）。如推导的表达式所示，渗透率与裂缝开度的三次方（$b^3$）成正比，与裂缝间距（$s$）成反比。用于 $x$ 方向流动的裂缝（裂缝组1）比用于 $y$ 方向流动的裂缝宽得多，并且这种效应被三次方放大，其影响远远超过了裂缝组1间距更宽所带来的相反效应。", "answer": "$$\n\\boxed{\n(1.33 \\times 10^{-13}, 5.21 \\times 10^{-15})\n}\n$$", "id": "3528038"}, {"introduction": "当我们向储层中注入流体时，会同时产生压力脉冲和热锋。理解哪个传播得更快对于预测储层行为和管理作业至关重要。本练习 [@problem_id:3528108] 使用尺度分析来比较水力扩散和热传导的特征时间尺度，揭示了耦合热-水（TH）过程的一个基本原理。", "problem": "一个均质、各向同性、完全饱和的地热储层被近似为一个连接注入井和监测井的一维域，两井相距 $L = 300$ m。在时间 $t=0$ 时，相对于初始均匀状态，注入井施加了孔隙压力的阶跃式增加和温度的阶跃式降低。假设为微可压缩流体的单相流，多孔骨架发生小变形，且对流热传输可忽略，因此压力通过 Darcy 流驱动的扩散演化，温度通过热传导演化。使用第一性原理——水力学中的 Darcy 定律和质量守恒，以及热学中的 Fourier 定律和能量守恒——来获得控制扩散方程，并通过将扩散穿透长度等同于 $L$ 来确定监测井处的特征到达时间 $t_h$（压力扰动）和 $t_t$（热扰动）。给定材料性质 $k = 1 \\times 10^{-14}$ m$^2$，$\\mu = 5 \\times 10^{-4}$ Pa·s，$S_\\sigma = 5 \\times 10^{-10}$ Pa$^{-1}$，以及 $\\alpha_t = 1.2 \\times 10^{-6}$ m$^2$/s，计算 $t_h$ 和 $t_t$。根据您的推导，论证哪个前缘（压力或温度）先到达监测井。\n\n将最终时间以天为单位表示，并四舍五入到三位有效数字。", "solution": "在微可压缩的饱和多孔介质中，水力响应遵循 Darcy 定律和质量守恒。Darcy 定律指出，单位面积的体积通量为\n$$\n\\mathbf{q} = -\\frac{k}{\\mu} \\nabla p,\n$$\n其中 $k$ 是渗透率，$\\mu$ 是动力粘度，$p$ 是孔隙压力。对于微可压缩流体和可压缩多孔骨架，围绕参考状态线性化的质量守恒可以写成\n$$\nS_\\sigma \\,\\frac{\\partial p}{\\partial t} = \\nabla \\cdot \\left( \\frac{k}{\\mu} \\nabla p \\right),\n$$\n其中 $S_\\sigma$ 是单位压力的有效储水系数（流固系统的总压缩系数乘以孔隙度），单位为 Pa$^{-1}$。这是一个关于 $p$ 的扩散方程，其水力扩散系数为\n$$\nD_h = \\frac{\\tfrac{k}{\\mu}}{S_\\sigma} = \\frac{k}{\\mu S_\\sigma}.\n$$\n对于在 $x=0$ 处具有阶跃边界条件的一维扩散，解具有关于变量 $\\eta = x/\\big(2\\sqrt{D_h t}\\big)$ 的相似形式，并且扰动穿透一个特征长度 $\\ell_h(t) \\sim \\sqrt{D_h t}$。位于 $x=L$ 处一点的实际到达时间可以通过要求 $\\ell_h(t_h) \\sim L$ 来估计，从而得到以下标度关系\n$$\nt_h \\sim \\frac{L^2}{D_h}.\n$$\n\n在对流可忽略的情况下，热响应由 Fourier 热传导定律和能量守恒控制。Fourier 定律指出\n$$\n\\mathbf{q}_T = -\\lambda \\nabla T,\n$$\n其中 $\\lambda$ 是热导率，$T$ 是温度。对于性质恒定的情况，能量守恒得出热方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha_t \\nabla^2 T,\n$$\n其中 $\\alpha_t = \\lambda/(\\rho c)$ 是热扩散率。在一维情况下，对于阶跃边界条件，热扰动穿透一个特征长度 $\\ell_t(t) \\sim \\sqrt{\\alpha_t t}$，因此在 $x=L$ 处的到达时间标度为\n$$\nt_t \\sim \\frac{L^2}{\\alpha_t}.\n$$\n\n我们现在根据给定的性质计算水力扩散系数：\n$$\nD_h = \\frac{k}{\\mu S_\\sigma} = \\frac{1 \\times 10^{-14}~\\mathrm{m}^2}{\\left(5 \\times 10^{-4}~\\mathrm{Pa\\cdot s}\\right)\\left(5 \\times 10^{-10}~\\mathrm{Pa}^{-1}\\right)}.\n$$\n分母为\n$$\n\\left(5 \\times 10^{-4}\\right)\\left(5 \\times 10^{-10}\\right) = 25 \\times 10^{-14} = 2.5 \\times 10^{-13},\n$$\n所以\n$$\nD_h = \\frac{1 \\times 10^{-14}}{2.5 \\times 10^{-13}} = 0.04~\\mathrm{m}^2/\\mathrm{s}.\n$$\n因此，\n$$\nt_h = \\frac{L^2}{D_h} = \\frac{(300~\\mathrm{m})^2}{0.04~\\mathrm{m}^2/\\mathrm{s}} = \\frac{90{,}000~\\mathrm{m}^2}{0.04~\\mathrm{m}^2/\\mathrm{s}} = 2.25 \\times 10^{6}~\\mathrm{s}.\n$$\n将 $t_h$ 转换为天，使用 $1~\\mathrm{day} = 86{,}400~\\mathrm{s}$：\n$$\nt_h = \\frac{2.25 \\times 10^{6}~\\mathrm{s}}{86{,}400~\\mathrm{s/day}} \\approx 26.0416667~\\mathrm{days}.\n$$\n四舍五入到三位有效数字，\n$$\nt_h \\approx 26.0~\\mathrm{days}.\n$$\n\n对于热到达时间，\n$$\nt_t = \\frac{L^2}{\\alpha_t} = \\frac{(300~\\mathrm{m})^2}{1.2 \\times 10^{-6}~\\mathrm{m}^2/\\mathrm{s}} = \\frac{90{,}000~\\mathrm{m}^2}{1.2 \\times 10^{-6}~\\mathrm{m}^2/\\mathrm{s}} = 7.5 \\times 10^{10}~\\mathrm{s}.\n$$\n转换为天：\n$$\nt_t = \\frac{7.5 \\times 10^{10}~\\mathrm{s}}{86{,}400~\\mathrm{s/day}} \\approx 868{,}055.5556~\\mathrm{days}.\n$$\n四舍五入到三位有效数字，\n$$\nt_t \\approx 8.68 \\times 10^{5}~\\mathrm{days}.\n$$\n\n比较表明 $t_h \\ll t_t$，因此在所述假设下，压力前缘比热前缘早得多到达监测井。从物理上讲，这里的水力扩散系数 $D_h$ 比热扩散率 $\\alpha_t$ 大几个数量级，导致压力扩散相对于热传导要快得多。", "answer": "$$\\boxed{(26.0, 8.68 \\times 10^{5})}$$", "id": "3528108"}, {"introduction": "在模拟任何地热作业之前，计算模型必须首先代表储层未受干扰的原地状态。本练习 [@problem_id:3528111] 将指导你完成一项基本原理的实践，即建立一个一致的初始状态，综合考虑重力对总应力（岩石静力）、孔隙压力（静水压力）和温度（地温梯度）的影响。这是任何实际模拟工作流程中至关重要的第一步。", "problem": "要求您对代表地热储层的一维垂直柱进行地应力、孔隙压力和温度场的一致性初始化，并将其形式化和实现，确保其与重力加载和地温梯度兼容。您必须从基本平衡定律推导出初始化过程，构建一个计算程序以将扰动模型松弛至平衡状态，然后计算诊断量。\n\n模型域是一个厚度为 $H$ 的垂直柱，垂直坐标 $z$ 从顶部边界 $z=0$ 开始向下为正，到底部边界 $z=H$ 结束。岩石是均质、各向同性、线性和孔隙弹性的，流体是单相且静止的，温度场是具有恒定梯度的稳态场。使用压应力为正的符号约定。假设如下：\n- 重力为常数，大小为 $g$。\n- 岩石固体密度为 $\\rho_s$，孔隙度为 $\\phi$，流体密度为 $\\rho_f$（为进行静水压力初始化，假设 $\\rho_f$ 不随深度变化）。\n- 排水泊松比为 $\\nu$，Biot系数为 $\\alpha$。\n- 地温梯度为常数 $G$，顶部温度为 $T_0$。\n- 顶部边界具有指定的垂直总应力 $\\sigma_v(0)=q_0$ 和指定的孔隙压力 $p(0)=p_0$。\n\n从基本平衡定律和核心定义（无加速度下的力学平衡、无流动的静态流体柱、有效应力定义以及线性各向同性热孔隙弹性）出发，完成以下任务：\n\n1) 推导满足以下条件的垂直总应力 $\\sigma_v(z)$、孔隙压力 $p(z)$ 和温度 $T(z)$ 的一致性表达式：\n- 一维静力学平衡，\n- 静水流体平衡，\n- 具有给定顶部温度的稳态线性地温梯度。\n\n您的推导必须从基本方程和边界条件开始，而不是从预先给定的目标公式开始。\n\n2) 使用有效应力定义和静止侧向条件下的线性各向同性弹性理论，从垂直有效应力和孔隙压力推导出深度 $z$ 处的水平总应力。清晰地陈述并证明您为关联水平和垂直有效应力所需的任何假设。\n\n3) 设计一个离散松弛程序，以消除在由 $N$ 个等间距节点 $z_i$（$i=0,\\dots,N-1$，$z_0=0$，$z_{N-1}=H$）组成的网格上的初始扰动场中的不平衡。您的程序必须：\n- 以一个形式为 $\\tilde{\\sigma}_v(z)=\\sigma_v(z)+\\delta\\sigma_v(z)$、$\\tilde{p}(z)=p(z)+\\delta p(z)$、$\\tilde{T}(z)=T(z)+\\delta T(z)$ 的故意扰动的初始猜测场开始，其中 $\\delta\\sigma_v(z)=A_\\sigma\\sin(\\pi z/H)$、$\\delta p(z)=A_p\\sin(\\pi z/H)$ 和 $\\delta T(z)=A_T\\sin(\\pi z/H)$，振幅 $A_\\sigma$、$A_p$ 和 $A_T$ 已给定。\n- 更新场以强制执行平衡关系和边界条件的离散形式，直到离散残差低于指定的容差。将离散残差定义为\n$$\nr_{\\mathrm{mom},i}=\\frac{\\sigma_v(z_{i+1})-\\sigma_v(z_i)}{\\Delta z}-\\rho_b g,\\quad\nr_{p,i}=\\frac{p(z_{i+1})-p(z_i)}{\\Delta z}-\\rho_f g,\\quad\nr_{T,i}=\\frac{T(z_{i+1})-T(z_i)}{\\Delta z}-G,\n$$\n对于 $i=0,\\dots,N-2$，其中 $\\Delta z=H/(N-1)$，$\\rho_b$ 是混合体积密度。要报告的最大范数残差为\n$$\nR_{\\mathrm{mom}}=\\max_i |r_{\\mathrm{mom},i}|,\\quad R_p=\\max_i |r_{p,i}|,\\quad R_T=\\max_i |r_{T,i}|.\n$$\n- 在力学平衡中使用混合体积密度 $\\rho_b=(1-\\phi)\\rho_s+\\phi\\rho_f$。\n\n4) 将您的推导和松弛过程实现为一个完整的程序，该程序对下面给出的每个测试用例执行以下操作：\n- 在网格上初始化一致性场，\n- 使用指定的正弦扰动进行扰动，\n- 使用您的程序松弛至平衡状态，\n- 计算最大范数残差 $R_{\\mathrm{mom}}$（单位 $\\mathrm{Pa/m}$）、$R_p$（单位 $\\mathrm{Pa/m}$）和 $R_T$（单位 $\\mathrm{K/m}$），\n- 计算底部水平总应力 $\\sigma_h(H)$（单位 $\\mathrm{MPa}$）。\n\n假设水平有效应力通过适用于无限水平延伸范围的静止侧向条件与垂直有效应力相关联，并使用有效应力定义转换回总应力。除了稳态地温梯度本身所隐含的应力外，不要在初始状态中包含任何额外的热应力。\n\n使用具有 $N=201$ 个节点的均匀网格。使用扰动振幅 $A_\\sigma=10^5$（单位 $\\mathrm{Pa}$）、$A_p=10^4$（单位 $\\mathrm{Pa}$）和 $A_T=5$（单位 $\\mathrm{K}$）。对于所有计算，使用压应力为正的符号约定，并表示：\n- $R_{\\mathrm{mom}}$ 以 $\\mathrm{Pa/m}$ 为单位，\n- $R_p$ 以 $\\mathrm{Pa/m}$ 为单位，\n- $R_T$ 以 $\\mathrm{K/m}$ 为单位，\n- $\\sigma_h(H)$ 以 $\\mathrm{MPa}$ 为单位。\n\n将所有报告的数字四舍五入到六位有效数字。\n\n测试套件：\n为以下三个测试用例提供结果（所有单位均为一致的国际单位制单位）：\n\n- 用例1（理想情况）：\n  - $H=3000$, $\\phi=0.15$, $\\rho_s=2650$, $\\rho_f=975$, $\\nu=0.25$, $\\alpha=0.8$, $T_0=20$, $G=0.03$, $g=9.81$, $q_0=0$, $p_0=1.0\\times10^5$。\n\n- 用例2（非零顶部荷载和更陡的梯度）：\n  - $H=1000$, $\\phi=0.05$, $\\rho_s=2700$, $\\rho_f=1000$, $\\nu=0.10$, $\\alpha=0.6$, $T_0=15$, $G=0.05$, $g=9.81$, $q_0=2.0\\times10^6$, $p_0=1.5\\times10^5$。\n\n- 用例3（近不可压缩骨架和零温度梯度，浅层域）：\n  - $H=10$, $\\phi=0.30$, $\\rho_s=2600$, $\\rho_f=1020$, $\\nu=0.49$, $\\alpha=1.0$, $T_0=10$, $G=0.0$, $g=9.81$, $q_0=0$, $p_0=1.0\\times10^5$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是针对一个测试用例的四个数字的列表，顺序为 $[R_{\\mathrm{mom}},R_p,R_T,\\sigma_h(H)]$。例如，打印的行必须如下所示\n\"[ [a,b,c,d], [e,f,g,h], [i,j,k,l] ]\"\n，其中字母由实际数值代替。", "solution": "任务是为一个一维垂直地热储层模型形式化并实现地应力、孔隙压力和温度场的一致性初始化。这包括从基本原理推导解析平衡剖面，设计一个在离散网格上初始化这些场的数值程序，并将此程序应用于特定的测试用例。\n\n### 1. 一致性平衡场的推导\n\n模型域是一个厚度为 $H$ 的垂直柱，坐标 $z$ 向下为正，从顶部的 $z=0$ 到支部的 $z=H$。我们将推导温度 $T(z)$、孔隙压力 $p(z)$ 和垂直总应力 $\\sigma_v(z)$ 的稳态剖面。\n\n**温度场 $T(z)$**\n\n问题指定了一个具有恒定地温梯度 $G$ 的稳态温度场。这可以用常微分方程表示：\n$$ \\frac{dT}{dz} = G $$\n顶部表面（$z=0$）的边界条件给定为 $T(0) = T_0$。我们将控制方程从顶部边界 $z'=0$ 积分到任意深度 $z$：\n$$ \\int_{T(0)}^{T(z)} dT' = \\int_{0}^{z} G \\,dz' $$\n由于 $G$ 是常数，这得到：\n$$ T(z) - T(0) = Gz $$\n代入边界条件 $T(0) = T_0$，我们得到一致的温度剖面：\n$$ T(z) = T_0 + Gz $$\n\n**孔隙压力场 $p(z)$**\n\n孔隙流体被假定为静态，意味着静水力平衡。压力梯度由流体重力驱动。控制方程的矢量形式为 $\\nabla p = \\rho_f \\mathbf{g}$，其中 $\\rho_f$ 是流体密度，$\\mathbf{g}$ 是重力加速度矢量。对于我们 $z$ 向下为正的一维垂直柱，这简化为：\n$$ \\frac{dp}{dz} = \\rho_f g $$\n顶部表面的边界条件为 $p(0) = p_0$。从 $z'=0$ 积分到 $z$：\n$$ \\int_{p(0)}^{p(z)} dp' = \\int_{0}^{z} \\rho_f g \\,dz' $$\n鉴于 $\\rho_f$ 和 $g$ 是常数，我们发现：\n$$ p(z) - p(0) = \\rho_f g z $$\n代入边界条件 $p(0) = p_0$，一致的孔隙压力剖面为：\n$$ p(z) = p_0 + \\rho_f g z $$\n\n**垂直总应力场 $\\sigma_v(z)$**\n\n对于处于静力平衡状态的物体，所有力的总和为零。这由方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ 表示，其中 $\\boldsymbol{\\sigma}$ 是总应力张量，$\\mathbf{b}$ 是单位体积的体力。体力是重力，$\\mathbf{b} = \\rho_b \\mathbf{g}$，其中 $\\rho_b$ 是饱和多孔介质的体积密度，由 $\\rho_b = (1-\\phi)\\rho_s + \\phi\\rho_f$ 给出。\n对于应力仅随 $z$ 变化的一维柱，平衡方程的垂直分量（使用压应力为正的符号约定且 $z$ 向下为正）是：\n$$ \\frac{d\\sigma_v}{dz} = \\rho_b g $$\n顶部边界承受的垂直总应力为 $\\sigma_v(0) = q_0$。对 $z$ 进行积分：\n$$ \\int_{\\sigma_v(0)}^{\\sigma_v(z)} d\\sigma_v' = \\int_{0}^{z} \\rho_b g \\,dz' $$\n由于 $\\rho_b$ 和 $g$ 是常数：\n$$ \\sigma_v(z) - \\sigma_v(0) = \\rho_b g z $$\n应用边界条件 $\\sigma_v(0) = q_0$，我们得到垂直总应力剖面：\n$$ \\sigma_v(z) = q_0 + \\rho_b g z $$\n\n### 2. 水平总应力 $\\sigma_h(z)$ 的推导\n\n为了确定水平总应力，我们必须使用本构定律将其与垂直应力联系起来。我们做出标准的岩土力学假设，即“静止”状态，这适用于经历了主要垂直压实的横向广延地层。该状态的特征是零侧向应变：$\\epsilon_h = 0$。\n\n本构行为由线性各向同性孔隙弹性理论控制。应变是有效应力 $\\boldsymbol{\\sigma}'$ 的函数。由Biot修正的Terzaghi有效应力原理将有效应力（压应力为正）定义为：\n$$ \\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - \\alpha p \\mathbf{I} $$\n其中 $\\alpha$ 是Biot系数，$\\mathbf{I}$ 是单位张量。其分量为 $\\sigma'_v = \\sigma_v - \\alpha p$ 和 $\\sigma'_h = \\sigma_h - \\alpha p$。\n\n对于各向同性弹性材料，应变-有效应力关系（在初始推导中忽略热效应，这在地应力初始化中很常见）为：\n$$ \\epsilon_h = \\frac{1}{E} \\left[ \\sigma'_h - \\nu(\\sigma'_h + \\sigma'_v) \\right] $$\n其中 $E$ 是排水杨氏模量，$\\nu$ 是排水泊松比。设置 $\\epsilon_h=0$：\n$$ \\sigma'_h - \\nu\\sigma'_h - \\nu\\sigma'_v = 0 $$\n$$ \\sigma'_h(1-\\nu) = \\nu\\sigma'_v $$\n这给出了水平有效应力与垂直有效应力之间的关系：\n$$ \\sigma'_h(z) = \\frac{\\nu}{1-\\nu} \\sigma'_v(z) $$\n项 $K_0 = \\nu/(1-\\nu)$ 是静止侧向土压力系数。问题说明不包括额外的热应力。这一假设是合理的，因为我们考虑弹性应变的参考状态是对应于已建立的地温梯度的状态。\n\n为了求得总水平应力，我们将有效应力的定义代回此方程：\n$$ \\sigma_h(z) - \\alpha p(z) = \\frac{\\nu}{1-\\nu} \\left( \\sigma_v(z) - \\alpha p(z) \\right) $$\n求解 $\\sigma_h(z)$：\n$$ \\sigma_h(z) = \\frac{\\nu}{1-\\nu} \\left( \\sigma_v(z) - \\alpha p(z) \\right) + \\alpha p(z) $$\n使用先前推导的 $\\sigma_v(z)$ 和 $p(z)$ 表达式，我们可以计算任意深度处的 $\\sigma_h(z)$。\n\n### 3. 离散松弛程序\n\n该计算程序旨在用一致性场初始化网格，对其进行扰动，然后恢复平衡。\n1.  **网格和场初始化**：建立一个由 $N$ 个节点组成的均匀网格，$z_i = i \\cdot \\Delta z$，$i=0, \\dots, N-1$，间距为 $\\Delta z = H/(N-1)$。首先使用上面推导的解析公式在每个节点上计算一致的平衡场 $T(z_i)$、$p(z_i)$ 和 $\\sigma_v(z_i)$。\n2.  **扰动**：通过添加正弦函数来扰动平衡场：\n    $$ \\tilde{\\sigma}_v(z_i) = \\sigma_v(z_i) + A_\\sigma\\sin(\\pi z_i/H) $$\n    $$ \\tilde{p}(z_i) = p(z_i) + A_p\\sin(\\pi z_i/H) $$\n    $$ \\tilde{T}(z_i) = T(z_i) + A_T\\sin(\\pi z_i/H) $$\n3.  **松弛至平衡**：这里的“松弛”一词指的是一个直接的、单遍的程序，用以强制执行离散平衡关系。从扰动场开始，我们从顶部边界（$z=0$）向下推进，覆盖它们的值。\n    - 首先，强制执行顶部边界条件：$\\tilde{T}(z_0)=T_0$、$\\tilde{p}(z_0)=p_0$ 和 $\\tilde{\\sigma}_v(z_0)=q_0$。\n    - 然后，对于每个场，我们从 $i=0$ 迭代到 $N-2$，根据当前节点的值和恒定梯度更新下一个节点的值：\n    $$ \\tilde{T}(z_{i+1}) = \\tilde{T}(z_i) + G \\Delta z $$\n    $$ \\tilde{p}(z_{i+1}) = \\tilde{p}(z_i) + \\rho_f g \\Delta z $$\n    $$ \\tilde{\\sigma}_v(z_{i+1}) = \\tilde{\\sigma}_v(z_i) + \\rho_b g \\Delta z $$\n    此过程之后，这些场将精确匹配解析平衡解的离散表示，达到浮点精度。我们将这些最终场称为 $T^f, p^f, \\sigma_v^f$。\n4.  **残差和诊断量计算**：\n    - 在最终的松弛场 $T^f, p^f, \\sigma_v^f$ 上计算离散残差，以验证是否达到平衡。对于 $i=0, \\dots, N-2$：\n    $$ r_{\\mathrm{mom},i}=\\frac{\\sigma_v^f(z_{i+1})-\\sigma_v^f(z_i)}{\\Delta z}-\\rho_b g $$\n    $$ r_{p,i}=\\frac{p^f(z_{i+1})-p^f(z_i)}{\\Delta z}-\\rho_f g $$\n    $$ r_{T,i}=\\frac{T^f(z_{i+1})-T^f(z_i)}{\\Delta z}-G $$\n    最大范数残差 $R_{\\mathrm{mom}}$、$R_p$ 和 $R_T$ 是在所有 $i$ 上的最大绝对值。由于直接强制执行，这些残差预计将接近机器精度零。\n    - 柱底部的水平总应力 $\\sigma_h(H)$ 是使用 $\\sigma_h(z)$ 在 $z=H$（节点 $z_{N-1}$）处的值计算的，其中使用最终松弛场 $\\sigma_v^f(H)$ 和 $p^f(H)$。最终值从帕斯卡（Pascals）转换为兆帕（Megapascals）。", "answer": "[[0.0, 0.0, 0.0, 38.8854], [0.0, 0.0, 0.0, 10.9703], [0.0, 0.0, 0.0, 0.449733]]", "id": "3528111"}]}