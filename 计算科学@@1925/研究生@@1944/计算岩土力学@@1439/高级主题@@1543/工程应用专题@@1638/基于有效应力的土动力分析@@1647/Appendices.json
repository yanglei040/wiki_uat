{"hands_on_practices": [{"introduction": "这项练习为理解孔隙流体压力在土体骨架中的演化与消散奠定了理论基础。通过从基本原理出发推导一维扩散方程，你将识别出控制该过程的关键参数（水力扩散系数），并利用它定义一个能够预测动力响应中排水程度的无量纲数 ([@problem_id:3521440])。这项基础性练习是深入理解和评判后续复杂数值模拟结果的关键一步。", "problem": "一个水平延伸的、完全饱和的砂土层，厚度为 $H=5\\,\\text{m}$，覆盖在一个刚性基底上。该土层受到周期为 $T=0.5\\,\\text{s}$ 的竖向均匀循环剪切荷载作用，使得变形在竖直方向上是一维的，并且在大侧向范围上代表了平面应变条件。土-流体系统遵循线性孔隙弹性理论。砂土的固有渗透率为 $k=5\\times 10^{-12}\\,\\text{m}^{2}$，孔隙流体的动力粘度为 $\\mu=1\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，表征耦合介质储存能力的毕奥模量（通常表示为 $M$）为 $M=0.8\\,\\text{GPa}$。假设应变和孔隙水压力梯度均为小量。\n\n从基于有效应力的土动力学分析的基本关系出发，即流体流动的达西定律和流固混合物的质量守恒定律，再结合通过毕奥模量将孔隙水压力与体积流体含量联系起来的线性压缩关系，推导孔隙水压力 $p$ 的控制扩散方程，并从中确定作为材料参数的水力扩散系数 $c$。然后，通过对推导出的扩散方程进行量纲分析，定义无量纲排水数 $N_{d}$ 为一个荷载周期内的特征扩散长度与土层厚度之比的平方。根据给定的属性和 $T=0.5\\,\\text{s}$ 计算 $c$ 和 $N_{d}$ 的值，并简要判断一个循环内的动力响应更接近排水状态还是不排水状态。\n\n将 $c$ 和 $N_{d}$ 四舍五入到三位有效数字。$c$ 的单位为 $\\text{m}^{2}/\\text{s}$。$N_{d}$ 为无量纲数。最终的方框答案中不包含单位。", "solution": "首先对问题进行验证，基于已建立的线性孔隙弹性理论，确认问题具有科学依据、提法恰当且客观。所有必需数据均已提供，且参数在物理上是现实的。因此，我们可以开始求解。\n\n孔隙水压力 $p$ 的控制扩散方程的推导始于三个基本关系：孔隙流体的质量守恒、流体流动的达西定律以及流固混合物的储存关系。\n\n1.  **质量守恒**：对于一维竖向流动，流体质量守恒要求体积流体含量 $\\zeta$ 的变化率与比流量 $q_z$ 的空间梯度相平衡。\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n    $$\n    这里，$t$ 是时间，$z$ 是竖向坐标。\n\n2.  **达西定律**：比流量 $q_z$ 与超孔隙水压力 $p$ 的梯度成线性关系。该关系由达西定律给出：\n    $$\n    q_z = -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z}\n    $$\n    其中 $k$ 是砂土的固有渗透率，$\\mu$ 是孔隙流体的动力粘度。\n\n3.  **压缩关系（储存定律）**：问题指定了一个线性压缩关系，通过毕奥模量 $M$ 将孔隙水压力 $p$ 与体积流体含量 $\\zeta$ 联系起来。$\\zeta$ 的变化率与 $p$ 的变化率成正比：\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = \\frac{1}{M} \\frac{\\partial p}{\\partial t}\n    $$\n    该方程描述了由于流体和固体骨架的可压缩性，多孔介质中流体的储存。\n\n为了推导扩散方程，我们将这三个原理结合起来。首先，将储存定律代入质量守恒方程：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n$$\n接下来，将达西定律代入所得方程：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial z} \\left( -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z} \\right)\n$$\n假设材料属性（$k$、$\\mu$ 和 $M$）在整个土层中是均匀的，因而在空间上是常数，我们可以简化右侧：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial z^2}\n$$\n将其整理为扩散方程的标准形式，我们得到：\n$$\n\\frac{\\partial p}{\\partial t} = \\left(\\frac{kM}{\\mu}\\right) \\frac{\\partial^2 p}{\\partial z^2}\n$$\n这就是孔隙水压力 $p$ 的控制扩散方程。\n\n一维扩散方程的一般形式为 $\\frac{\\partial \\phi}{\\partial t} = c \\frac{\\partial^2 \\phi}{\\partial z^2}$。通过将我们推导的方程与此一般形式进行比较，我们可以确定水力扩散系数 $c$ 为：\n$$\nc = \\frac{kM}{\\mu}\n$$\n现在我们使用给定的参数值计算 $c$：$k=5 \\times 10^{-12}\\,\\text{m}^{2}$，$M=0.8\\,\\text{GPa} = 0.8 \\times 10^9\\,\\text{Pa}$，以及 $\\mu=1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n$$\nc = \\frac{(5 \\times 10^{-12}\\,\\text{m}^2) \\times (0.8 \\times 10^9\\,\\text{Pa})}{1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}} = \\frac{4.0 \\times 10^{-3}}{1 \\times 10^{-3}} \\, \\frac{\\text{m}^2}{\\text{s}} = 4.0 \\, \\frac{\\text{m}^2}{\\text{s}}\n$$\n根据问题的要求，四舍五入到三位有效数字，我们得到 $c = 4.00\\,\\text{m}^2/\\text{s}$。\n\n接下来，我们定义并计算无量纲排水数 $N_d$。问题指定 $N_d$ 是一个荷载周期内的特征扩散长度与土层厚度之比的平方。\n特征时间是荷载周期，$T = 0.5\\,\\text{s}$。\n特征扩散长度 $L_d$ 是在时间 $T$ 内发生显著扩散的距离。从扩散方程的量纲分析可知，$L_d$ 与 $\\sqrt{cT}$ 成正比。\n土层厚度为 $H = 5\\,\\text{m}$。\n因此，排水数 $N_d$ 定义为：\n$$\nN_d = \\left( \\frac{L_d}{H} \\right)^2 = \\left( \\frac{\\sqrt{cT}}{H} \\right)^2 = \\frac{cT}{H^2}\n$$\n代入 $c$、$T$ 和 $H$ 的值：\n$$\nN_d = \\frac{(4.00\\,\\text{m}^2/\\text{s}) \\times (0.5\\,\\text{s})}{(5\\,\\text{m})^2} = \\frac{2.00}{25} = 0.08\n$$\n四舍五入到三位有效数字，$N_d = 0.0800$。\n\n最后，我们使用 $N_d$ 来评估排水条件。排水数 $N_d = \\frac{cT}{H^2}$ 比较了加载的时间尺度 $T$ 与孔隙水压力在土层中扩散的时间尺度 $\\tau_{\\text{diff}} = \\frac{H^2}{c}$。一个小的 $N_d$ 值（$N_d \\ll 1$）表示加载速度相对于流体排出所需的时间很快，导致孔隙水压力累积的“不排水”响应。一个大的 $N_d$ 值（$N_d \\gg 1$）表示加载缓慢，允许孔隙水压力消散，导致“排水”响应。\n我们计算出的值为 $N_d = 0.0800$。由于这个值远小于 1，土层在一个循环内的动力响应更接近不排水状态而非排水状态。在一个荷载周期的持续时间内，孔隙流体没有足够的时间流动和消散所产生的压力。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.00  0.0800\n\\end{pmatrix}\n}\n$$", "id": "3521440"}, {"introduction": "有效应力分析的核心在于固体骨架变形与孔隙压力变化之间的耦合作用。本练习 ([@problem_id:3521372]) 深入探讨了这一耦合机制，重点关注材料的非线性行为（特别是粘塑性）如何导致孔隙压力的产生。你将通过一个率相关的本构模型，动手计算由塑性体积应变引起的孔压增量，从而对土壤液化等关键现象背后的机理获得直观认识。", "problem": "一个饱和粉土试样在小应变条件下，使用有效应力原理和孔隙力学耦合进行建模。采用体积应变为拉伸时为正的符号约定。总柯西应力根据Biot理论分解为有效应力和孔隙压力，如下所示：$\\boldsymbol{\\sigma}^{\\prime} = \\boldsymbol{\\sigma} - \\alpha\\,p\\,\\mathbf{I}$，其中$\\alpha$是Biot系数，$p$是孔隙压力。在不排水塑性体积应变条件下，假设线性化的流体-骨架可压缩性耦合产生孔隙压力增量\n$$\n\\Delta p = -\\,\\alpha\\,M\\,\\Delta \\varepsilon_v^p,\n$$\n其中$M$是Biot模量，$\\varepsilon_v^p$是塑性体积应变。偏加载荷以简单剪切应力历史的形式施加，其特征为标量剪切应力$q(t)$，随时间线性增加：\n$$\nq(t) = q_{\\max}\\,\\frac{t}{T}, \\quad t \\in [0,T],\n$$\n其中$q_{\\max}$是时间$T$时的最终剪切应力。该材料表现出时间相关的粘塑性，遵循Perzyna型超应力定律。令超应力定义为\n$$\nf(t) = q(t) - q_y,\n$$\n其中$q_y$是一个与速率无关的剪切强度阈值。Macaulay括号表示为$\\langle x \\rangle = \\max(x,0)$。粘塑性乘子率建模为\n$$\n\\dot{\\lambda}(t) = \\left(\\frac{\\langle f(t)\\rangle}{k}\\right)^{m}\\frac{1}{t_0},\n$$\n其中$k$和$m$是材料参数，$t_0$是特征时间尺度。粘塑性应变率张量为$\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\mathbf{N}$，其中$\\mathbf{N}$是流动方向。对于孔隙压力响应，仅需要流动方向的体积分量，它由标量$\\operatorname{tr}(\\mathbf{N}) = n_v$（一个常数）指定。因此，塑性体积应变率为\n$$\n\\dot{\\varepsilon}_v^p(t) = \\dot{\\lambda}(t)\\,n_v.\n$$\n假设初始时$\\varepsilon_v^p(0)=0$，材料保持完全饱和，且$\\alpha=1$。本问题中所有物理量的单位，应力使用千帕（$\\mathrm{kPa}$），时间使用秒（$\\mathrm{s}$）。孔隙压力增量的最终答案必须以$\\mathrm{kPa}$为单位报告。\n\n任务：对于下面的每个测试用例，使用上述定义计算由斜坡加载产生的最终孔隙压力增量$\\Delta p(T)$。您必须使用给定的符号约定、线性斜坡加载和所述的速率依赖性。您可以假设$q(t)$的作用不直接影响平均总应力，并且所有孔隙压力的变化都通过所述的耦合由塑性体积应变引起。所有用例中，使用$\\alpha = 1$，$M = 100{,}000\\,\\mathrm{kPa}$和$t_0 = 1\\,\\mathrm{s}$。对于每个给定的用例，$n_v$取为一个常数。以$\\mathrm{kPa}$为单位报告每个结果，并四舍五入到$6$位小数。\n\n测试套件（每个用例是一个元组$(q_{\\max},T,q_y,k,m,n_v)$，使用上述单位）：\n- 案例 1：$(100,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n- 案例 2：$(50,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n- 案例 3：$(100,\\,1,\\,60,\\,25,\\,1,\\,-0.001)$\n- 案例 4：$(100,\\,1,\\,60,\\,50,\\,2,\\,-0.0002)$\n- 案例 5：$(100,\\,2,\\,60,\\,50,\\,2,\\,-0.001)$\n- 案例 6：$(60,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n\n附加要求：\n- 本问题中不需要角度单位。\n- 程序必须输出单行，其中包含案例1到6的结果的逗号分隔列表，用方括号括起来，每个值以$\\mathrm{kPa}$为单位四舍五入到6位小数。例如：$[r_1,r_2,r_3,r_4,r_5,r_6]$，其中每个$r_i$是$\\mathrm{kPa}$单位的十进制数。", "solution": "该问题是适定的，科学上基于连续介质力学和孔隙力学原理，并包含获得唯一解所需的所有信息。因此，它被认为是有效的。\n\n目标是计算线性剪切应力斜坡结束时的最终孔隙压力增量$\\Delta p(T)$。计算过程通过在加载期间对粘塑性应变率进行积分来进行。\n\n孔隙压力增量$\\Delta p$通过线性化的流体-骨架可压缩性关系与塑性体积应变$\\Delta \\varepsilon_v^p$耦合：\n$$\n\\Delta p = -\\alpha M \\Delta \\varepsilon_v^p\n$$\n给定初始条件$\\varepsilon_v^p(0) = 0$，在时间区间$[0, T]$上的总增量为$\\Delta \\varepsilon_v^p(T) = \\varepsilon_v^p(T) - \\varepsilon_v^p(0) = \\varepsilon_v^p(T)$。因此，最终的孔隙压力增量为：\n$$\n\\Delta p(T) = -\\alpha M \\varepsilon_v^p(T)\n$$\n量$\\varepsilon_v^p(T)$是时间$T$时的总塑性体积应变，通过将塑性体积应变率$\\dot{\\varepsilon}_v^p(t)$从$t=0$到$t=T$积分得到：\n$$\n\\varepsilon_v^p(T) = \\int_0^T \\dot{\\varepsilon}_v^p(t) \\, dt\n$$\n塑性体积应变率由流动法则$\\dot{\\varepsilon}_v^p(t) = \\dot{\\lambda}(t) n_v$定义，其中$\\dot{\\lambda}(t)$是粘塑性乘子率，$n_v$是流动方向张量的体积分量。将此代入积分中得到：\n$$\n\\varepsilon_v^p(T) = n_v \\int_0^T \\dot{\\lambda}(t) \\, dt\n$$\n粘塑性乘子率$\\dot{\\lambda}(t)$由Perzyna型超应力模型控制：\n$$\n\\dot{\\lambda}(t) = \\left(\\frac{\\langle f(t)\\rangle}{k}\\right)^{m}\\frac{1}{t_0}\n$$\n这里，$f(t)$是超应力，定义为当前偏应力$q(t)$与屈服强度$q_y$之差：\n$$\nf(t) = q(t) - q_y\n$$\n偏应力$q(t)$以线性斜坡形式施加：\n$$\nq(t) = q_{\\max}\\,\\frac{t}{T}\n$$\n将此代入超应力函数得到：\n$$\nf(t) = q_{\\max}\\,\\frac{t}{T} - q_y\n$$\nMacaulay括号$\\langle f(t) \\rangle$确保粘塑性流动仅在超应力为正时发生，即$f(t) > 0$。该条件$q_{\\max}\\frac{t}{T} - q_y > 0$在$t > t_y$时成立，其中$t_y$是屈服开始的时间：\n$$\nt_y = T \\frac{q_y}{q_{\\max}}\n$$\n如果$q_{\\max} \\le q_y$，则$t_y \\ge T$，意味着在加载区间$[0,T]$内不发生塑性屈服。在这种情况下，对于所有$t \\in [0,T]$，$\\langle f(t) \\rangle = 0$，导致$\\dot{\\lambda}(t) = 0$，$\\varepsilon_v^p(T) = 0$，因此$\\Delta p(T) = 0$。\n\n对于$q_{\\max} > q_y$的情况，$\\varepsilon_v^p(T)$的积分变为非零，并在区间$[t_y, T]$上进行计算：\n$$\n\\varepsilon_v^p(T) = n_v \\int_{t_y}^T \\frac{1}{t_0} \\left(\\frac{q_{\\max}\\frac{t}{T} - q_y}{k}\\right)^{m} dt = \\frac{n_v}{t_0 k^m} \\int_{t_y}^T \\left(q_{\\max}\\frac{t}{T} - q_y\\right)^{m} dt\n$$\n为求解此积分，我们进行变量替换。令$u = q_{\\max}\\frac{t}{T} - q_y$。微分为$du = \\frac{q_{\\max}}{T} dt$，因此$dt = \\frac{T}{q_{\\max}} du$。积分的上下限变为：\n- 当$t = t_y$时，$u = q_{\\max}\\frac{t_y}{T} - q_y = q_{\\max}\\frac{q_y/q_{\\max} \\cdot T}{T} - q_y = 0$。\n- 当$t = T$时，$u = q_{\\max}\\frac{T}{T} - q_y = q_{\\max} - q_y$。\n\n以$u$表示的积分为：\n$$\n\\int_0^{q_{\\max} - q_y} u^m \\left(\\frac{T}{q_{\\max}}\\right) du = \\frac{T}{q_{\\max}} \\left[ \\frac{u^{m+1}}{m+1} \\right]_0^{q_{\\max} - q_y} = \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1}\n$$\n将此结果代回$\\varepsilon_v^p(T)$的表达式中：\n$$\n\\varepsilon_v^p(T) = \\frac{n_v}{t_0 k^m} \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1}\n$$\n最后，我们得到孔隙压力增量$\\Delta p(T)$的表达式：\n$$\n\\Delta p(T) = -\\alpha M \\varepsilon_v^p(T) = -\\alpha M \\left( \\frac{n_v}{t_0 k^m} \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1} \\right)\n$$\n对于所有测试用例，常数为$\\alpha = 1$，$M = 100{,}000\\,\\mathrm{kPa}$和$t_0 = 1\\,\\mathrm{s}$。公式简化为：\n$$\n\\Delta p(T) = -M \\frac{n_v T}{k^m q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1} \\quad \\text{对于 } q_{\\max} > q_y\n$$\n如果$q_{\\max} \\le q_y$，则$\\Delta p(T) = 0$。下面的Python程序实现了这个推导出的公式，以计算每个测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the final pore pressure increment for a series of test cases based on a\n    Perzyna-type viscoplastic model coupled with poromechanics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q_max, T, q_y, k, m, n_v)\n    test_cases = [\n        (100.0, 1.0, 60.0, 50.0, 2.0, -0.001),    # Case 1\n        (50.0, 1.0, 60.0, 50.0, 2.0, -0.001),     # Case 2\n        (100.0, 1.0, 60.0, 25.0, 1.0, -0.001),    # Case 3\n        (100.0, 1.0, 60.0, 50.0, 2.0, -0.0002),   # Case 4\n        (100.0, 2.0, 60.0, 50.0, 2.0, -0.001),    # Case 5\n        (60.0, 1.0, 60.0, 50.0, 2.0, -0.001),     # Case 6\n    ]\n\n    # Global constants\n    M = 100000.0  # Biot modulus in kPa\n    alpha = 1.0     # Biot coefficient\n    t_0 = 1.0       # Characteristic time scale in s\n\n    results = []\n    for case in test_cases:\n        q_max, T, q_y, k, m, n_v = case\n\n        # If the maximum shear stress does not exceed the yield strength,\n        # there is no viscoplastic strain and thus no pore pressure change.\n        if q_max = q_y:\n            delta_p_T = 0.0\n        else:\n            # Analytical formula for the pore pressure increment derived from the\n            # integration of the viscoplastic rate equations.\n            #\n            # delta_p(T) = -alpha * M * epsilon_v_p(T)\n            # epsilon_v_p(T) = n_v * integral from 0 to T of lambda_dot(t) dt\n            # lambda_dot(t) = (1/t_0) * ((q_max*t/T - q_y)> / k)^m\n            #\n            # After integration:\n            # delta_p(T) = -alpha * M * n_v / (t_0 * k^m) * (T / q_max) * (q_max - q_y)^(m+1) / (m+1)\n\n            term1 = -alpha * M * n_v / t_0\n            term2 = T / q_max\n            term3 = (q_max - q_y)**(m + 1.0) / (m + 1.0)\n            term4 = 1.0 / (k**m)\n            \n            delta_p_T = term1 * term2 * term3 * term4\n\n        results.append(delta_p_T)\n\n    # Format the results to 6 decimal places as required by the problem statement.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3521372"}, {"introduction": "从理论走向实践，本练习将指导你为全耦合动力分析构建核心的数值计算引擎。你将为一个基于有限元法的孔隙弹性模型，一步步组装出耦合固体位移和孔隙压力的系统雅可比矩阵 ([@problem_id:3521435])。进而，你将分析该矩阵的数值特性，这对于理解和优化求解器的收敛性能至关重要。", "problem": "考虑小应变条件下有效应力框架中的一维线性多孔弹性（Biot）连续介质，其位移场为 $u(x,t)$，孔隙压力场为 $p(x,t)$。总应力由 Terzaghi 有效应力关系给出：$ \\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t) $，其中 $ \\sigma'(x,t) = E \\, \\varepsilon(x,t) $，应变 $ \\varepsilon(x,t) = \\partial u / \\partial x $，E 为杨氏模量，$\\alpha$ 为 Biot 系数。动量平衡（包括惯性和可选的 Rayleigh 阻尼）和流体质量平衡由以下基本方程控制：\n\n- 动量平衡：$ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $，其中 $ \\rho $ 是混合物密度，$ c_d $ 是与速度成正比的唯象阻尼系数，$ b_u $ 是单位体积上施加的体力。\n- 流体质量平衡（考虑可压缩流体和达西流）：$ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $，其中 $ n $ 是孔隙度，$ \\beta_f $ 是流体压缩系数，$ k $ 是固有渗透率，$ \\mu $ 是动力粘度，$ b_p $ 是体积源项。\n\n你将使用两个线性有限元对上述方程在空间上进行离散化，作用于一根总长度为 $L$、横截面积为 $A$ 的均匀杆上，从而在位置 $ x_0 = 0 $、$ x_1 = L/2 $ 和 $ x_2 = L $ 处产生三个节点。每个节点都同时具有位移 $u$ 和压力 $p$ 的自由度。在循环加载的背景下，在右端（$ x = L $）施加一个牵引力 $ T(t) = T_0 \\sin(2 \\pi f t) $，其中 $T_0$ 是指定的振幅，$f$ 是指定的频率。对固体使用 Rayleigh 阻尼 $ C = a_R M + b_R K $，其中 $M$ 是一致质量矩阵，$K$ 是弹性刚度矩阵，$ a_R $ 和 $ b_R $ 是 Rayleigh 系数。对于混合密度，使用 $ \\rho = (1-n) \\rho_s + n \\rho_f $，其中 $ \\rho_s $ 和 $ \\rho_f $ 分别是固体颗粒密度和流体密度。\n\n从时间 $ t_n $ 到 $ t_{n+1} = t_n + \\Delta t $ 的单个动力学步长的时间积分必须使用针对固体位移的 Newmark 族方法（参数为 $ \\beta $ 和 $ \\gamma $）和针对孔隙压力的后向欧拉更新来构建：\n- Newmark 运动学关系给出 $ \\ddot{u}^{n+1} $ 和 $ \\dot{u}^{n+1} $ 关于 $ u^{n+1} $ 的表达式，其中用于雅可比矩阵的系数为 $ a_0 = 1 / (\\beta \\Delta t^2) $ 和 $ a_3 = \\gamma / (\\beta \\Delta t) $。\n- 孔隙压力的后向欧拉法给出 $ \\dot{p}^{n+1} = (p^{n+1} - p^n)/\\Delta t $。\n\n施加以下本质边界条件：固定左端的位移 $ u(x_0) = 0 $，并在两端指定排水孔隙压力 $ p(x_0) = 0 $ 和 $ p(x_2) = 0 $。组装在时间 $ t_{n+1} $ 时刻、针对未知量（按 $ [u^{n+1}, p^{n+1}] $ 排序）的残差全局分块雅可比矩阵，并考虑 $u$–$p$ 耦合。通过消除受约束的行和列来应用边界条件后，计算如下定义的无量纲化雅可比矩阵的谱半径（特征值中的最大绝对值）。令未知数缩放向量为 $ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $，其中 $ L_0 $ 为特征长度，$ P_0 $ 为特征压力，分别应用于位移和压力未知量。令残差缩放向量为 $ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $，分别应用于动量和质量残差。无量纲化雅可比矩阵 $ J_d $ 定义为 $ J_d = S_r^{-1} J S_x $，其中 $ S_x $ 和 $ S_r $ 是包含 $ s_x $ 和 $ s_r $ 条目的对角矩阵。谱半径则为 $ \\rho(J_d) = \\max_i | \\lambda_i(J_d) | $，是一个无量纲的量。\n\n在一个完整的、可运行的程序中实现以上内容，该程序：\n- 使用一维双单元线性有限元网格，该网格具有均匀的属性和形函数 $ N_1 = 1 - \\xi $，$ N_2 = \\xi $（$ \\xi $ 是局部坐标），$ B_u = [ -1/\\ell_e, 1/\\ell_e ] $ 和 $ B_p = [ -1/\\ell_e, 1/\\ell_e ] $，单元长度为 $ \\ell_e = L/2 $。一致单元矩阵为：\n  - 固体刚度 $$ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $$,\n  - 固体质量 $$ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $$,\n  - 固体 Rayleigh 阻尼 $ C^e = a_R M^e + b_R K_{uu}^e $,\n  - 从压力到动量的耦合 $$ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $$,\n  - 从固体速度到质量平衡的耦合 $$ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $$,\n  - 流体扩散 $$ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $$,\n  - 流体储存 $$ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $$。\n- 组装全局矩阵，通过消除相关的行和列来应用本质边界条件，并形成时间离散的雅可比分块矩阵：\n  - $ J_{uu} = K_{uu} + a_0 M + a_3 C $,\n  - $ J_{up} = K_{up} $,\n  - $ J_{pu} = a_3 C_{pu} $,\n  - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $。\n- 从以上分块矩阵构造 $ J $，使用 $ S_x $ 和 $ S_r $ 将其无量纲化为 $ J_d $，并计算 $ \\rho(J_d) $。\n\n使用以下测试套件，每个项目都以参数元组 $ (L, A, E, \\alpha, n, \\beta_f, k, \\mu, \\rho_s, \\rho_f, a_R, b_R, \\Delta t, \\gamma, \\beta, L_0, P_0, T_0, f) $ 的形式给出。循环荷载参数 $ T_0 $ 和 $ f $ 是为了物理设置的完整性而提供的；在此公式中，线性系统的雅可比矩阵与 $ T_0 $ 和 $ f $ 无关。\n\n- 测试用例 $1$（一般中等耦合，中等渗透率）：$ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-9}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $。\n- 测试用例 $2$（近不排水，极低渗透率）：$ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-12}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $。\n- 测试用例 $3$（高流体压缩性，无阻尼，小时间步长）：$ (10, 1, 80 \\times 10^6, 1.0, 0.35, 10^{-8}, 10^{-10}, 10^{-3}, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100 \\times 10^3, 50 \\times 10^3, 2) $。\n- 测试用例 $4$（备选 Newmark 参数，零循环振幅）：$ (10, 1, 30 \\times 10^6, 0.9, 0.4, 4.5 \\times 10^{-10}, 10^{-10}, 10^{-3}, 2650, 1000, 0.005, 5 \\times 10^{-5}, 0.05, 0.6, 0.3025, 10, 100 \\times 10^3, 0, 0.5) $。\n\n您的程序应生成单行输出，其中包含四个测试用例的谱半径，形式为方括号内以逗号分隔的列表（例如 $[r_1,r_2,r_3,r_4]$）。由于上述的无量纲化处理，谱半径是无量纲的；请勿在输出中包含任何物理单位。", "solution": "用户提供了一个计算岩土力学领域的问题，具体涉及使用有限元法对多孔弹性介质进行一维动力学分析。该问题要求为几个测试用例计算一个无量纲化的系统雅可比矩阵的谱半径。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n\n- **控制方程**:\n    1.  动量平衡：$ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $\n    2.  流体质量平衡：$ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $\n- **本构与运动学关系**:\n    - 应变：$ \\varepsilon(x,t) = \\partial u / \\partial x $\n    - 有效应力：$ \\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t) $，其中 $ \\sigma'(x,t) = E \\, \\varepsilon(x,t) $\n    - 混合密度：$ \\rho = (1-n) \\rho_s + n \\rho_f $\n- **离散化**:\n    - 空间：在长度为 $L$ 的杆上使用两个线性有限元。三个节点位于 $x_0=0, x_1=L/2, x_2=L$。\n    - 形函数：$N_1 = 1 - \\xi$, $N_2 = \\xi$。应变-位移矩阵 $B_u = [-1/\\ell_e, 1/\\ell_e]$。\n    - 时间积分：位移采用 Newmark 法（$\\beta, \\gamma$），压力采用后向欧拉法。\n- **边界条件**:\n    - 位移：$u(x_0) = 0$\n    - 孔隙压力：$p(x_0) = 0$, $p(x_2) = 0$\n- **荷载**: 在 $x=L$ 处施加牵引力 $T(t) = T_0 \\sin(2 \\pi f t)$。\n- **单元矩阵**:\n    - $ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n    - $ C^e = a_R M^e + b_R K_{uu}^e $\n    - $ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $\n    - $ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $\n    - $ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n- **系统雅可比分块**:\n    - $ J_{uu} = K_{uu} + a_0 M + a_3 C $，其中 $ a_0 = 1 / (\\beta \\Delta t^2) $，$ a_3 = \\gamma / (\\beta \\Delta t) $\n    - $ J_{up} = K_{up} $\n    - $ J_{pu} = a_3 C_{pu} $\n    - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $\n- **无量纲化**:\n    - $ J_d = S_r^{-1} J S_x $\n    - 未知数缩放向量：$ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $\n    - 残差缩放向量：$ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $\n- **目标量**: 谱半径 $ \\rho(J_d) $。\n- **测试用例**: 提供了四组参数。\n\n**步骤2：使用提取的已知信息进行验证**\n\n1.  **科学基础**：该问题基于成熟的 Biot 多孔弹性理论。动量和质量平衡的控制方程是耦合流体流动和固体变形的标准表述。使用有限元进行空间离散化以及使用 Newmark/后向欧拉法进行时间积分是计算力学中的标准、稳健技术。所提供的单元矩阵对于线性单元和指定的控制方程是正确的。Rayleigh 阻尼公式也是标准做法。所有方面在科学上都是合理的。\n\n2.  **适定性**：任务是根据明确指定的程序计算一个矩阵的谱半径。给定输入（材料参数、几何形状、边界条件），全局矩阵和由此产生的雅可比矩阵是唯一确定的。通过消除行/列来应用边界条件是导致唯一缩减矩阵的标准程序。随后的无量纲化和谱半径计算是明确定义的数学运算。因此，该问题是适定的。\n\n3.  **客观性**：问题陈述完全由定量的、客观的定义和指令组成。没有主观性语言。\n\n4.  **缺陷分析**：\n    - **不完整性/矛盾**：为每个测试用例提供了所有必要的数据，包括材料属性、几何参数、离散化选择、边界条件和时间积分参数。仔细检查控制方程中的符号与所提供的单元矩阵和雅可比定义，证实了它们的内部一致性。具体来说，相对于从 $\\int B_u^T \\alpha N_p dV$ 的形式推导，$K_{up}^e$ 的定义包含一个负号。这种选择使得最终的系统方程为 $M\\ddot{U} + K_{uu}U + K_{up}P = F$，这又导致了所述的雅可比分块 $J_{up} = K_{up}$。因此，该问题是自洽的。\n    - **其他缺陷**：该问题并非琐碎、不切实际、不适定或不科学。它代表了其领域内一个标准的、尽管复杂的数值分析任务。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。它具有科学依据，内部一致，适定，并提供了继续解决方案所需的所有必要信息。\n\n### 求解方案\n\n该解决方案涉及实施指定的有限元程序，为每个给定的测试用例计算无量纲化雅可比矩阵的谱半径。整个过程如下：\n\n1.  **参数初始化**：对于每个测试用例，定义问题陈述中提供的所有物理和数值参数。\n2.  **单元矩阵构建**：基于这些参数，为一个长度为 $\\ell_e = L/2$ 的线性单元计算七个单元级矩阵（$K_{uu}^e$, $M^e$, $C^e$, $K_{up}^e$, $C_{pu}^e$, $K_{pp}^e$, $S_{pp}^e$）。Rayleigh 阻尼矩阵 $C^e$ 由 $M^e$ 和 $K_{uu}^e$ 构成。\n3.  **全局矩阵组装**：为三节点、双单元的网格组装全局系统矩阵。位移场的全局矩阵（$K_{uu}$, $M$, $C$）和压力场的全局矩阵（$K_{pp}$, $S_{pp}$）均为 $3 \\times 3$。连接两个场的耦合矩阵（$K_{up}$, $C_{pu}$）也是 $3 \\times 3$。通过遍历两个单元并将其贡献加到全局矩阵的相应条目中来执行组装。\n4.  **雅可比矩阵形成**：使用组装好的全局矩阵和时间积分系数（$a_0$, $a_3$）构建时间离散的雅可比分块矩阵（$J_{uu}$, $J_{up}$, $J_{pu}$, $J_{pp}$）。然后将这些分块排列成完整的 $6 \\times 6$ 系统雅可比矩阵 $J$。自由度按 $[u_0, u_1, u_2, p_0, p_1, p_2]$ 排序。\n5.  **边界条件的应用**：本质边界条件 $u_0=0$、$p_0=0$ 和 $p_2=0$ 对应于全局系统中的第 0、3 和 5 个自由度。问题规定通过从雅可比矩阵 $J$ 中消除相应的行和列来施加这些约束。这将系统简化为自由度：$[u_1, u_2, p_1]$。得到的简化雅可比矩阵 $J_{reduced}$ 是一个 $3 \\times 3$ 的矩阵。\n6.  **无量纲化**：根据公式 $J_d = S_r^{-1} J_{reduced} S_x$ 对简化雅可比矩阵进行无量纲化。对角缩放矩阵 $S_x$ 和 $S_r$ 由缩放向量 $s_x$ 和 $s_r$ 构建，这些向量是根据特征长度 $L_0$、特征压力 $P_0$ 和其他系统参数定义的。对于简化的 $3 \\times 3$ 系统，缩放向量为 $s_x = [L_0, L_0, P_0]$ 和 $s_r = [E A / L_0, E A / L_0, P_0 / \\Delta t]$。\n7.  **谱半径计算**：最后，计算得到的 $3 \\times 3$ 无量纲化雅可比矩阵 $J_d$ 的特征值。谱半径 $\\rho(J_d)$ 是这些特征值中的最大绝对值。\n\n对问题陈述中提供的四个测试用例中的每一个重复此完整过程。最终输出是包含四个计算出的谱半径的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the poroelasticity problem for all test cases.\n    \"\"\"\n    \n    # (L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, T0, f)\n    test_cases = [\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-9, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-12, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 80e6, 1.0, 0.35, 1e-8, 1e-10, 1e-3, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100e3, 50e3, 2),\n        (10, 1, 30e6, 0.9, 0.4, 4.5e-10, 1e-10, 1e-3, 2650, 1000, 0.005, 5e-5, 0.05, 0.6, 0.3025, 10, 100e3, 0, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_spectral_radius(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_spectral_radius(params):\n    \"\"\"\n    Computes the spectral radius of the nondimensionalized Jacobian for a single test case.\n    \"\"\"\n    # 1. Unpack parameters and define mesh properties\n    L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, _, _ = params\n    \n    num_elements = 2\n    num_nodes = 3\n    ell_e = L / num_elements\n\n    # 2. Calculate derived parameters\n    mixture_density = (1 - n) * rho_s + n * rho_f\n    a0 = 1 / (beta * dt**2)\n    a3 = gamma / (beta * dt)\n\n    # 3. Formulate element matrices\n    K_uu_e = (E * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    M_e = (mixture_density * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    C_e = a_R * M_e + b_R * K_uu_e\n    K_up_e = (alpha * A / 2.) * np.array([[1., 1.], [-1., -1.]])\n    C_pu_e = (alpha * A / 2.) * np.array([[-1., 1.], [-1., 1.]])\n    K_pp_e = ((k / mu) * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    S_pp_e = (n * beta_f * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    \n    element_matrices = {\n        \"Kuu\": K_uu_e, \"M\": M_e, \"C\": C_e,\n        \"Kup\": K_up_e, \"Cpu\": C_pu_e,\n        \"Kpp\": K_pp_e, \"Spp\": S_pp_e\n    }\n\n    # 4. Assemble global matrices\n    global_matrices = {key: np.zeros((num_nodes, num_nodes)) for key in element_matrices}\n    \n    element_node_map = [[0, 1], [1, 2]]\n    for nodes in element_node_map:\n        idx = np.ix_(nodes, nodes)\n        for key, mat_e in element_matrices.items():\n            global_matrices[key][idx] += mat_e\n\n    # 5. Form global Jacobian blocks\n    J_uu = global_matrices[\"Kuu\"] + a0 * global_matrices[\"M\"] + a3 * global_matrices[\"C\"]\n    J_up = global_matrices[\"Kup\"]\n    J_pu = a3 * global_matrices[\"Cpu\"]\n    J_pp = global_matrices[\"Kpp\"] + (1 / dt) * global_matrices[\"Spp\"]\n\n    # 6. Form full 6x6 Jacobian matrix\n    J = np.block([\n        [J_uu, J_up],\n        [J_pu, J_pp]\n    ])\n\n    # 7. Apply boundary conditions by eliminating rows and columns\n    # DOFs: [u0, u1, u2, p0, p1, p2] -> indices [0, 1, 2, 3, 4, 5]\n    # BCs: u0=0, p0=0, p2=0 -> constrained DOFs at indices 0, 3, 5\n    # Free DOFs: [u1, u2, p1] -> indices [1, 2, 4]\n    free_dofs = [1, 2, 4]\n    J_reduced = J[np.ix_(free_dofs, free_dofs)]\n    \n    # 8. Define scaling matrices for nondimensionalization\n    # Reduced unknown vector: [u1, u2, p1]\n    # Reduced residual vector corresponds to: mom_eq_node1, mom_eq_node2, mass_eq_node1\n    s_x_vec = np.array([L0, L0, P0])\n    s_r_vec = np.array([E * A / L0, E * A / L0, P0 / dt])\n    \n    S_x = np.diag(s_x_vec)\n    S_r_inv = np.diag(1.0 / s_r_vec)\n\n    # 9. Compute the nondimensional Jacobian\n    J_d = S_r_inv @ J_reduced @ S_x\n\n    # 10. Compute and return the spectral radius\n    eigenvalues = np.linalg.eigvals(J_d)\n    spectral_radius = np.max(np.abs(eigenvalues))\n    \n    return spectral_radius\n\nsolve()\n```", "id": "3521435"}]}