{"hands_on_practices": [{"introduction": "本练习侧重于已有裂缝的基本力学行为。通过应用双曲线接触定律，我们将推导出裂缝在压应力作用下的闭合规律，并计算其柔度——该参数衡量了裂缝开度如何响应流体压力的变化。掌握这一概念是理解水力压裂中复杂流固相互作用的第一步，因为它定义了流体必须克服的固体介质的“刚度”。[@problem_id:3530159]", "problem": "在平面应变条件下，将嵌入线性弹性岩石中的单一平面水力裂缝进行理想化处理。该裂缝与最小水平主应力方向一致，因此裂缝上的法向牵引力由最小远场应力和内部流体压力控制。该裂缝表现为粗糙的、无张力接触，其压缩法向响应由双曲线节理定律控制。目标是基于第一性原理和唯象法向接触定律，计算一个明确定义的闭合应力以及裂缝柔度随流体压力的演化过程。\n\n假设和基本依据：\n- 裂缝两侧法向牵引力的力学平衡意味着，作用于闭合裂缝的有效法向应力由下式给出\n$$\n\\sigma_{n}^{\\prime} = \\sigma_{h,\\min} - p_{f},\n$$\n其中 $\\sigma_{h,\\min}$ 是最小水平主应力（单位：$\\mathrm{Pa}$），$p_{f}$ 是裂缝流体压力（单位：$\\mathrm{Pa}$）。张力被视为负的有效法向应力。\n- 裂缝遵循无张力接触条件。当 $\\sigma_{n}^{\\prime} \\le 0$ 时，平均力学开度保持在其最大值 $w_{0}$，并且不会因张力而进一步增加。\n- 在压缩状态下，即 $\\sigma_{n}^{\\prime} > 0$ 时，平均力学闭合量 $u_{n}$（单位：$\\mathrm{m}$）遵循双曲线定律，其初始法向刚度为 $k_{i}$（单位：$\\mathrm{Pa/m}$），渐近最大闭合量为 $u_{\\max}$（单位：$\\mathrm{m}$）：\n$$\n\\sigma_{n}^{\\prime} = \\frac{k_{i}\\,u_{n}}{1 - \\dfrac{u_{n}}{u_{\\max}}}, \\quad 0 \\le u_{n}  u_{\\max}.\n$$\n平均力学开度为 $w = w_{0} - u_{n}$，当 $\\sigma_{n}^{\\prime} \\to +\\infty$ 时，残余开度为 $w_{\\mathrm{res}} = w_{0} - u_{\\max}$。\n\n任务：\n1. 从上述关系出发，推导平均闭合量 $u_{n}$ 作为 $\\sigma_{n}^{\\prime}$ 函数的显式表达式，然后获得裂缝相对于流体压力的柔度\n$$\nJ_{p}(p_{f}) \\equiv \\frac{\\mathrm{d}w}{\\mathrm{d}p_{f}}\n$$\n作为 $p_{f}$ 和各参数的函数。需考虑无张力条件。\n2. 将闭合有效应力 $\\sigma_{\\mathrm{cl}}$ 定义为平均闭合量达到其最大值 $90\\%$ 时的 $\\sigma_{n}^{\\prime}$ 值，即 $u_{n} = 0.9\\,u_{\\max}$。计算相应的闭合流体压力\n$$\np_{\\mathrm{cl}} = \\sigma_{h,\\min} - \\sigma_{\\mathrm{cl}}.\n$$\n3. 对于下面测试套件中的每个参数集，计算：\n   - 闭合流体压力 $p_{\\mathrm{cl}}$（单位：$\\mathrm{Pa}$），\n   - 在两个指定的流体压力 $p_{f,\\mathrm{init}}$ 和 $p_{f,\\mathrm{final}}$（单位：$\\mathrm{Pa}$）下评估的柔度 $J_{p}$（单位：$\\mathrm{m/Pa}$），\n   需遵循上述无张力接触条件。\n\n单位和数值要求：\n- 所有压力必须以 $\\mathrm{Pa}$ 表示。\n- 所有开度和闭合量必须以 $\\mathrm{m}$ 表示。\n- 柔度必须以 $\\mathrm{m/Pa}$ 表示。\n- 不涉及角度。\n- 当定义中出现百分比时，任何要求的输出都必须以小数或分数形式给出；不要输出百分号。在本问题中，所有要求的输出都是以国际单位制基本单位表示的浮点数。\n\n测试套件（每个案例是一个元组 $\\left(\\sigma_{h,\\min},\\,k_{i},\\,u_{\\max},\\,w_{0},\\,p_{f,\\mathrm{init}},\\,p_{f,\\mathrm{final}}\\right)$）：\n- 案例 A（通用理想路径）：$\\left(50\\times 10^{6},\\,1\\times 10^{11},\\,5\\times 10^{-6},\\,1.5\\times 10^{-4},\\,48\\times 10^{6},\\,40\\times 10^{6}\\right)$。\n- 案例 B（接近阈值的闭合）：$\\left(10\\times 10^{6},\\,1\\times 10^{11},\\,1\\times 10^{-5},\\,4\\times 10^{-4},\\,9.5\\times 10^{6},\\,8\\times 10^{6}\\right)$。\n- 案例 C（刚性节理，小柔度）：$\\left(60\\times 10^{6},\\,5\\times 10^{11},\\,3\\times 10^{-6},\\,2\\times 10^{-4},\\,49\\times 10^{6},\\,46\\times 10^{6}\\right)$。\n- 案例 D（用于测试无张力条件的拉伸到压缩转换）：$\\left(30\\times 10^{6},\\,8\\times 10^{10},\\,6\\times 10^{-6},\\,1\\times 10^{-4},\\,32\\times 10^{6},\\,28\\times 10^{6}\\right)$。\n\n程序规范和输出格式：\n- 实现推导过程并为每个案例计算所要求的量。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个案例的结果本身必须是一个用方括号括起来的逗号分隔的三个浮点数列表，顺序为 $\\left[p_{\\mathrm{cl}},\\,J_{p}(p_{f,\\mathrm{init}}),\\,J_{p}(p_{f,\\mathrm{final}})\\right]$。例如：\n\"[ [pcl_A,Ji_A,Jf_A], [pcl_B,Ji_B,Jf_B], [pcl_C,Ji_C,Jf_C], [pcl_D,Ji_D,Jf_D] ]\" 但不含任何空格。", "solution": "该问题提供了一组描述单一平面水力裂缝力学行为的关系式，并要求推导和计算与其闭合和柔度相关的特定量。该问题在科学上基于连续介质力学和岩石力学的原理，是适定且客观的，因此被认为是有效的。解决方案首先推导所要求的解析表达式，然后将它们应用于提供的测试案例。\n\n基本关系如下：\n1. 有效法向应力：$\\sigma_{n}^{\\prime} = \\sigma_{h,\\min} - p_{f}$。\n2. 平均力学开度：$w = w_{0} - u_{n}$。\n3. 无张力条件：对于 $\\sigma_{n}^{\\prime} \\le 0$，闭合量 $u_{n} = 0$。\n4. 双曲线闭合定律：对于 $\\sigma_{n}^{\\prime} > 0$，闭合量 $u_{n}$ 由 $\\sigma_{n}^{\\prime} = \\frac{k_{i}\\,u_{n}}{1 - u_{n}/u_{\\max}}$ 控制，其中 $0 \\le u_{n}  u_{\\max}$。\n\n**任务1：推导平均闭合量 $u_{n}(\\sigma_{n}^{\\prime})$ 和柔度 $J_{p}(p_{f})$**\n\n首先，我们推导平均闭合量 $u_{n}$ 作为有效法向应力 $\\sigma_{n}^{\\prime}$ 函数的显式表达式。双曲线定律仅在压缩状态（$\\sigma_{n}^{\\prime} > 0$）下有效。我们重排方程以求解 $u_{n}$：\n$$ \\sigma_{n}^{\\prime} \\left(1 - \\frac{u_{n}}{u_{\\max}}\\right) = k_{i}\\,u_{n} $$\n$$ \\sigma_{n}^{\\prime} - \\frac{\\sigma_{n}^{\\prime}}{u_{\\max}} u_{n} = k_{i}\\,u_{n} $$\n$$ \\sigma_{n}^{\\prime} = u_{n} \\left(k_i + \\frac{\\sigma_{n}^{\\prime}}{u_{\\max}}\\right) $$\n$$ u_{n} = \\frac{\\sigma_{n}^{\\prime}}{k_i + \\sigma_{n}^{\\prime}/u_{\\max}} = \\frac{\\sigma_{n}^{\\prime} u_{\\max}}{k_i u_{\\max} + \\sigma_{n}^{\\prime}} $$\n该表达式在 $\\sigma_{n}^{\\prime} > 0$ 时成立。对于无张力条件，即 $\\sigma_{n}^{\\prime} \\le 0$ 时，闭合量 $u_{n}$ 为零。结合这些条件，得到 $u_{n}(\\sigma_{n}^{\\prime})$ 的完整分段表达式：\n$$ u_{n}(\\sigma_{n}^{\\prime}) = \\begin{cases} 0  \\text{当 } \\sigma_{n}^{\\prime} \\le 0 \\\\ \\dfrac{\\sigma_{n}^{\\prime} u_{\\max}}{k_i u_{\\max} + \\sigma_{n}^{\\prime}}  \\text{当 } \\sigma_{n}^{\\prime} > 0 \\end{cases} $$\n接下来，我们推导裂缝相对于流体压力的柔度，定义为 $J_{p}(p_{f}) \\equiv \\frac{\\mathrm{d}w}{\\mathrm{d}p_{f}}$。\n给定 $w = w_{0} - u_{n}$，则柔度为 $J_{p}(p_{f}) = -\\frac{\\mathrm{d}u_{n}}{\\mathrm{d}p_f}$。\n使用链式法则，$\\frac{\\mathrm{d}u_{n}}{\\mathrm{d}p_f} = \\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}} \\frac{\\mathrm{d}\\sigma_{n}^{\\prime}}{\\mathrm{d}p_f}$。\n根据有效应力的定义，$\\sigma_{n}^{\\prime} = \\sigma_{h,\\min} - p_{f}$，我们得到 $\\frac{\\mathrm{d}\\sigma_{n}^{\\prime}}{\\mathrm{d}p_f} = -1$。\n因此，$J_{p}(p_f) = - \\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}} (-1) = \\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}}$。\n\n现在我们针对每种情况，对 $u_{n}(\\sigma_{n}^{\\prime})$ 关于 $\\sigma_{n}^{\\prime}$ 求导。\n如果 $\\sigma_{n}^{\\prime} \\le 0$，则 $u_{n} = 0$（一个常数），所以 $\\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}} = 0$。因此 $J_p=0$。\n如果 $\\sigma_{n}^{\\prime} > 0$，我们使用商法则对 $u_{n}$ 的表达式求导：\n$$ \\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}} = \\frac{d}{d\\sigma_{n}^{\\prime}}\\left( \\frac{\\sigma_{n}^{\\prime} u_{\\max}}{k_i u_{\\max} + \\sigma_{n}^{\\prime}} \\right) = \\frac{u_{\\max}(k_i u_{\\max} + \\sigma_{n}^{\\prime}) - (\\sigma_{n}^{\\prime} u_{\\max})(1)}{(k_i u_{\\max} + \\sigma_{n}^{\\prime})^2} $$\n$$ \\frac{\\mathrm{d}u_{n}}{\\mathrm{d}\\sigma_{n}^{\\prime}} = \\frac{k_i u_{\\max}^2 + \\sigma_{n}^{\\prime} u_{\\max} - \\sigma_{n}^{\\prime} u_{\\max}}{(k_i u_{\\max} + \\sigma_{n}^{\\prime})^2} = \\frac{k_i u_{\\max}^2}{(k_i u_{\\max} + \\sigma_{n}^{\\prime})^2} $$\n结合这些结果，并使用 $\\sigma_{n}^{\\prime} = \\sigma_{h,\\min} - p_f$ 将它们表示为 $p_f$ 的函数，我们得到柔度的分段函数：\n$$\nJ_{p}(p_{f}) = \\begin{cases} 0  \\text{当 } p_{f} \\ge \\sigma_{h,\\min} \\\\ \\dfrac{k_i u_{\\max}^2}{(k_i u_{\\max} + \\sigma_{h,\\min} - p_{f})^2}  \\text{当 } p_{f}  \\sigma_{h,\\min} \\end{cases}\n$$\n\n**任务2：推导闭合压力 $p_{\\mathrm{cl}}$**\n\n闭合有效应力 $\\sigma_{\\mathrm{cl}}$ 定义为闭合量 $u_{n}$ 达到其最大值 $90\\%$ 时的 $\\sigma_{n}^{\\prime}$ 值，即 $u_{n} = 0.9\\,u_{\\max}$。将此代入双曲线定律：\n$$ \\sigma_{\\mathrm{cl}} = \\frac{k_{i}\\,(0.9\\,u_{\\max})}{1 - \\frac{0.9\\,u_{\\max}}{u_{\\max}}} = \\frac{0.9\\,k_{i}\\,u_{\\max}}{1 - 0.9} = \\frac{0.9\\,k_{i}\\,u_{\\max}}{0.1} $$\n$$ \\sigma_{\\mathrm{cl}} = 9\\,k_{i}\\,u_{\\max} $$\n相应的闭合流体压力 $p_{\\mathrm{cl}}$ 可从有效应力关系中求得：\n$$ p_{\\mathrm{cl}} = \\sigma_{h,\\min} - \\sigma_{\\mathrm{cl}} = \\sigma_{h,\\min} - 9\\,k_{i}\\,u_{\\max} $$\n由于 $k_i > 0$ 和 $u_{\\max} > 0$，$\\sigma_{\\mathrm{cl}}$ 的值为正，这证实了该状态如要求的那样发生在压缩状态内。\n\n**任务3：测试套件的计算**\n\n现在应用推导出的公式来计算每个参数集所需的量。每个案例的步骤如下：\n1. 计算 $p_{\\mathrm{cl}} = \\sigma_{h,\\min} - 9\\,k_{i}\\,u_{\\max}$。\n2. 对于给定的流体压力 $p_f$（$p_{f,\\mathrm{init}}$ 或 $p_{f,\\mathrm{final}}$），计算柔度 $J_p(p_f)$。\n   - 如果 $p_f \\ge \\sigma_{h,\\min}$，则 $J_p(p_f)=0$。\n   - 如果 $p_f  \\sigma_{h,\\min}$，则计算 $\\sigma_{n}^{\\prime} = \\sigma_{h,\\min} - p_f$ 并使用 $J_p(p_f) = \\frac{k_i u_{\\max}^2}{(k_i u_{\\max} + \\sigma_{n}^{\\prime})^2}$。\n\n这些计算将在提供的 Python 脚本中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hydraulic fracture closure problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite from the problem statement.\n    # Each case is a tuple: (sigma_h_min, k_i, u_max, w_0, p_f_init, p_f_final)\n    test_cases = [\n        # Case A (general happy path)\n        (50e6, 1e11, 5e-6, 1.5e-4, 48e6, 40e6),\n        # Case B (near-threshold closure)\n        (10e6, 1e11, 1e-5, 4e-4, 9.5e6, 8e6),\n        # Case C (stiff joint, small compliance)\n        (60e6, 5e11, 3e-6, 2e-4, 49e6, 46e6),\n        # Case D (tension-to-compression transition to test no-tension)\n        (30e6, 8e10, 6e-6, 1e-4, 32e6, 28e6)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        sigma_h_min, k_i, u_max, w_0, p_f_init, p_f_final = case\n        \n        # Task 2: Compute closure fluid pressure p_cl\n        # sigma_cl is the effective stress at which closure u_n reaches 90% of u_max.\n        # sigma_cl = 9 * k_i * u_max\n        # p_cl = sigma_h_min - sigma_cl\n        p_cl = sigma_h_min - 9 * k_i * u_max\n        \n        # Task 1: Compute compliance J_p at specified fluid pressures.\n        # J_p(p_f) = d(w)/d(p_f)\n        def compute_compliance(p_f):\n            # Effective normal stress sigma_n_prime = sigma_h_min - p_f\n            sigma_n_prime = sigma_h_min - p_f\n            \n            # No-tension condition: if sigma_n_prime = 0 (i.e., p_f >= sigma_h_min),\n            # aperture is constant, so compliance is zero.\n            if sigma_n_prime = 0:\n                return 0.0\n            \n            # Compressive regime: sigma_n_prime > 0\n            # J_p = k_i * u_max^2 / (k_i * u_max + sigma_n_prime)^2\n            k_i_u_max = k_i * u_max\n            numerator = k_i * u_max**2\n            denominator = (k_i_u_max + sigma_n_prime)**2\n            return numerator / denominator\n\n        J_p_init = compute_compliance(p_f_init)\n        J_p_final = compute_compliance(p_f_final)\n        \n        all_results.append([p_cl, J_p_init, J_p_final])\n\n    # Format the output string to match the problem specification:\n    # A list of lists, with no spaces. e.g., [[v1,v2,v3],[v4,v5,v6]]\n    case_strings = []\n    for result_list in all_results:\n        # Convert each list to its string representation and remove spaces\n        case_str = str(result_list).replace(\" \", \"\")\n        case_strings.append(case_str)\n        \n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "3530159"}, {"introduction": "本练习使用经典的PKN模型，深入探讨了黏度主导的水力压裂扩展的核心物理机制。您将从第一性原理出发，推导自相似解，揭示流体流动、弹性变形和质量守恒如何错综复杂地耦合在一起，共同主导裂缝随时间的生长。通过验证模型的自洽性，您将更深刻地体会到这些基础解析解在数学上的优美性和物理上的稳健性。[@problem_id:3530236]", "problem": "考虑一个由牛顿流体驱动的平面应变水力压裂的一维 Perkins–Kern–Nordgren (PKN) 模型，忽略滤失和断裂韧性（零韧性或粘性主导极限）。设缝宽为 $w(x,t)$，半长为 $l(t)$，其中 $x \\in [0,l(t)]$。平面应变弹性是局部的：$p(x,t) = k_e w(x,t)$，其中 $k_e = E'/h$，$E'$ 是平面应变模量，$h$ 是恒定的裂缝高度。润滑流遵循泊肃叶定律 $q(x,t) = -\\dfrac{w(x,t)^3}{12 \\mu} \\dfrac{\\partial p}{\\partial x}$，其中 $\\mu$ 是动力粘度。质量守恒给出 $\\dfrac{\\partial w}{\\partial t} + \\dfrac{\\partial q}{\\partial x} = 0$。在尖端 $x = l(t)$ 处的零韧性极限强制要求 $w(l(t),t)=0$ 以及速度方程 $V(t)=\\dfrac{\\mathrm{d}l}{\\mathrm{d}t} = \\lim_{x \\to l(t)^-} \\dfrac{q(x,t)}{w(x,t)}$。\n\n您的任务是：\n\n1) 从上面给出的基本定律和定义出发，假设自相似形式为 $w(x,t) = W_0 t^{\\alpha} f(\\xi)$，其中 $\\xi = x/l(t)$ 且 $l(t) = L_0 t^{\\beta}$。仅通过平衡时间尺度来推导相似性指数 $\\alpha$ 和 $\\beta$，并获得相似性形状函数 $f(\\xi)$ 满足的无参数常微分方程以及在零韧性极限下的相应边界条件。除了本问题开头提供的物理陈述外，您不得假设任何预先存在的公式。\n\n2) 证明该无参数相似性方程在 $\\xi \\to 1^{-}$ 时允许存在尖端渐近解 $f(\\xi) \\sim A (1-\\xi)^{1/3}$，并纯粹从主阶平衡中推导出 $A$。然后，通过在整个域上对该无参数方程进行积分，证明积分恒等式 $-f(\\xi)^3 f'(\\xi)\\big|_{\\xi=0} = \\int_{0}^{1} f(\\xi)\\,\\mathrm{d}\\xi$。\n\n3) 令 $D = \\dfrac{k_e}{12 \\mu}$。利用无参数相似性方程所蕴含的耦合一致性，证明振幅和长度前置因子 $W_0$ 和 $L_0$ 必须满足 $D \\dfrac{W_0^3}{L_0^2} = 1$ 和 $W_0 L_0 \\int_{0}^{1} f(\\xi)\\,\\mathrm{d}\\xi = Q_0$，其中 $Q_0$ 是单位平面外厚度的恒定注入速率。推导出 $W_0$ 和 $L_0$ 关于 $D$、$Q_0$ 和形状积分 $I_1 = \\int_{0}^{1} f(\\xi)\\,\\mathrm{d}\\xi$ 的显式表达式。\n\n4) 如果弹性-流动耦合在零韧性极限下是自洽的，那么计算 $w(x,t) \\sim C(t)\\,(l(t)-x)^{1/3}$ 中近尖端系数（对于物理缝宽）的两种独立方法必须一致：\n\n- 全局相似性路径：$C_{\\mathrm{global}}(t) = \\dfrac{W_0 A}{l(t)^{1/3}} t^{\\alpha}$，其中 $A$ 与任务 2 中的定义相同。\n- 局部速度路径：$C_{\\mathrm{local}}(t) = \\left[\\dfrac{36\\,\\mu\\,V(t)}{k_e}\\right]^{1/3}$，其中 $V(t) = \\dfrac{\\mathrm{d}l}{\\mathrm{d}t}$。\n\n使用您的结果，在时间 $t = 1\\,\\mathrm{s}$ 通过计算相对误差来验证此一致性\n$$\n\\delta = \\frac{\\left|C_{\\mathrm{global}}(1) - C_{\\mathrm{local}}(1)\\right|}{C_{\\mathrm{local}}(1)}.\n$$\n\n为使问题可测试，您的程序必须通过从尖端开始的初值积分来数值求解 $f(\\xi)$ 的无参数相似性方程，并使用渐近展开在 $\\xi = 1 - \\varepsilon$（对于一个小的 $\\varepsilon > 0$）处进行初始化。在计算 $I_1$ 时，使用尖端渐近解来校正 $(1-\\varepsilon,1)$ 上缺失的积分段。然后，对每组参数，计算 $W_0$、$L_0$、$V(1)$、$C_{\\mathrm{global}}(1)$、$C_{\\mathrm{local}}(1)$，最后计算 $\\delta$。\n\n所有量都必须在国际单位制（SI）中处理。具体来说，$E'$ 的单位必须是帕斯卡（$\\mathrm{Pa}$），$h$ 是米（$\\mathrm{m}$），$\\mu$ 是帕斯卡-秒（$\\mathrm{Pa\\,s}$），$Q_0$ 是平方米/秒（$\\mathrm{m^2/s}$），时间是秒（$\\mathrm{s}$）。相对误差 $\\delta$ 是无量纲的，必须以小数形式报告。\n\n测试套件（每行是一组参数 $(E', h, \\mu, Q_0)$）：\n\n- 情况 A（正常路径）：$(E', h, \\mu, Q_0) = \\left(3.0 \\times 10^{10},\\, 15,\\, 0.1,\\, 0.05\\right)$\n- 情况 B（低粘度，较高注入速率）：$(E', h, \\mu, Q_0) = \\left(2.5 \\times 10^{10},\\, 10,\\, 0.001,\\, 0.1\\right)$\n- 情况 C（高粘度，较低注入速率）：$(E', h, \\mu, Q_0) = \\left(3.5 \\times 10^{10},\\, 30,\\, 10,\\, 1.0 \\times 10^{-3}\\right)$\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，\"[resultA,resultB,resultC]\"），其中每个条目是对应于上述情况在 $t=1\\,\\mathrm{s}$ 时计算出的相对误差 $\\delta$。", "solution": "用户提供了一个关于零韧性、粘性主导状态下水力压裂 Perkins–Kern–Nordgren (PKN) 模型自相似解的问题。该解答需要进行解析推导，然后通过数值实现来验证一个一致性条件。\n\n### 第 1 步：控制方程与自相似性\n\n问题提供了以下一维（$x$）和时间（$t$）的控制方程：\n1.  平面应变弹性：$p(x,t) = k_e w(x,t)$，其中 $k_e = E'/h$。\n2.  泊肃叶流（润滑理论）：$q(x,t) = -\\dfrac{w(x,t)^3}{12 \\mu} \\dfrac{\\partial p}{\\partial x}$。\n3.  质量守恒：$\\dfrac{\\partial w}{\\partial t} + \\dfrac{\\partial q}{\\partial x} = 0$。\n\n将（1）代入（2），我们得到以缝宽 $w$ 表示的流量：\n$$q(x,t) = -\\dfrac{k_e}{12 \\mu} w(x,t)^3 \\dfrac{\\partial w}{\\partial x}$$\n令 $D = \\dfrac{k_e}{12 \\mu}$。质量守恒方程（3）变为关于 $w(x,t)$ 的单个非线性偏微分方程：\n$$\\dfrac{\\partial w}{\\partial t} = D \\dfrac{\\partial}{\\partial x} \\left( w^3 \\dfrac{\\partial w}{\\partial x} \\right)$$\n此方程在 $x \\in (0, l(t))$ 内有效。\n\n我们假设一个自相似解的形式为：\n$$w(x,t) = W_0 t^{\\alpha} f(\\xi)$$\n$$l(t) = L_0 t^{\\beta}$$\n其中 $\\xi = x/l(t)$ 是无量纲坐标。$w$ 的导数通过链式法则求得：\n$$\\dfrac{\\partial w}{\\partial t} = W_0 \\alpha t^{\\alpha-1} f(\\xi) + W_0 t^{\\alpha} f'(\\xi) \\left( -\\dfrac{\\beta \\xi}{t} \\right) = W_0 t^{\\alpha-1} (\\alpha f(\\xi) - \\beta \\xi f'(\\xi))$$\n$$\\dfrac{\\partial w}{\\partial x} = W_0 t^{\\alpha} f'(\\xi) \\dfrac{1}{l(t)} = \\dfrac{W_0}{L_0} t^{\\alpha-\\beta} f'(\\xi)$$\n将这些代入偏微分方程：\n$$W_0 t^{\\alpha-1} (\\alpha f - \\beta \\xi f') = D \\dfrac{1}{L_0 t^{\\beta}} \\dfrac{d}{d\\xi} \\left[ \\left( W_0 t^{\\alpha} f \\right)^3 \\left( \\dfrac{W_0}{L_0} t^{\\alpha-\\beta} f' \\right) \\right]$$\n$$W_0 t^{\\alpha-1} (\\alpha f - \\beta \\xi f') = D \\dfrac{W_0^4}{L_0^2} t^{4\\alpha-2\\beta} \\dfrac{d}{d\\xi} (f^3 f')$$\n为了实现自相似性，含时项必须相互抵消。令 $t$ 的指数相等：\n$$\\alpha - 1 = 4\\alpha - 2\\beta \\implies 3\\alpha - 2\\beta = -1$$\n第二个关系由全局质量守恒得到。注入的总方量为 $V_{inj}(t) = Q_0 t$（单位高度）。储存在裂缝中的方量为 $\\mathcal{V}(t) = \\int_0^{l(t)} w(x,t) dx$。因此，$\\int_0^{l(t)} w(x,t) dx = Q_0 t$。\n$$\\int_0^{l(t)} W_0 t^{\\alpha} f\\left(\\frac{x}{l(t)}\\right) dx = W_0 L_0 t^{\\alpha+\\beta} \\int_0^1 f(\\xi) d\\xi = Q_0 t$$\n这要求 $t$ 的指数为 $1$，所以 $\\alpha + \\beta = 1$。求解关于指数的线性方程组：\n$$3\\alpha - 2(1-\\alpha) = -1 \\implies 5\\alpha = 1 \\implies \\alpha = 1/5$$\n$$\\beta = 1 - \\alpha = 4/5$$\n余下的项产生了相似性方程。为了获得一个无参数形式，我们定义 $W_0$ 和 $L_0$ 使得常数组合为单位 $1$，即 $D \\frac{W_0^3}{L_0^2} = 1$：\n$$\\alpha f - \\beta \\xi f' = \\dfrac{d}{d\\xi} (f^3 f')$$\n$$\\dfrac{d}{d\\xi} (f^3 f'(\\xi)) = \\frac{1}{5} f(\\xi) - \\frac{4}{5} \\xi f'(\\xi)$$\n边界条件是：$w(l(t), t) = 0 \\implies f(1)=0$。入口 $x=0$ 处的条件是流量为指定的注入速率，$q(0,t)=Q_0$。这将隐式地决定解的尺度和在 $\\xi=0$ 处的边界条件，如下所示。\n\n### 第 2 步：尖端渐近解与积分恒等式\n\n在尖端附近 $\\xi \\to 1^-$，令 $\\eta = 1-\\xi \\to 0^+$。常微分方程变为 $\\dfrac{d}{d\\eta}(f^3 \\frac{df}{d\\eta}) = \\frac{1}{5}f + \\frac{4}{5}(1-\\eta)\\frac{df}{d\\eta}$。假设一个幂律形式 $f(\\eta) \\sim A \\eta^p$。主导项是右侧的 $\\frac{df}{d\\eta}$ 和左侧的 $\\frac{d}{d\\eta}(f^3 \\frac{df}{d\\eta})$。\n$$\\dfrac{d}{d\\eta}( (A\\eta^p)^3 (Ap\\eta^{p-1}) ) \\sim \\frac{4}{5} Ap\\eta^{p-1}$$\n$$A^4 p(4p-1) \\eta^{4p-2} \\sim \\frac{4}{5} Ap\\eta^{p-1}$$\n令指数相等：$4p-2 = p-1 \\implies 3p = 1 \\implies p=1/3$。\n令系数相等：$A^3(4p-1) = 4/5 \\implies A^3(4/3 - 1) = 4/5 \\implies A^3/3 = 4/5 \\implies A^3 = 12/5$。所以，$A = (12/5)^{1/3}$。\n尖端渐近解为 $f(\\xi) \\sim (12/5)^{1/3} (1-\\xi)^{1/3}$。\n\n为了证明积分恒等式，我们将无参数常微分方程从 $\\xi=0$ 积分到 $\\xi=1$：\n$$\\int_{0}^{1} \\dfrac{d}{d\\xi} (f^3 f') d\\xi = \\int_{0}^{1} \\left(\\frac{1}{5} f - \\frac{4}{5} \\xi f'\\right) d\\xi$$\n$$[f(\\xi)^3 f'(\\xi)]_{0}^{1} = \\frac{1}{5}\\int_{0}^{1} f d\\xi - \\frac{4}{5}\\int_{0}^{1} \\xi f' d\\xi$$\n在 $\\xi=1$ 处的项是 $\\lim_{\\xi\\to 1^-} f^3 f' \\sim (A^3(1-\\xi))(-A/3(1-\\xi)^{-2/3}) = -A^4/3(1-\\xi)^{1/3} \\to 0$。\n右侧可以通过对第二项进行分部积分来简化：$\\int_{0}^{1} \\xi f' d\\xi = [\\xi f(\\xi)]_0^1 - \\int_0^1 f d\\xi = (f(1) - 0) - \\int_0^1 f d\\xi = -\\int_0^1 f d\\xi$。\n令 $I_1 = \\int_0^1 f(\\xi) d\\xi$，方程变为：\n$$-f(0)^3 f'(0) = \\frac{1}{5}I_1 - \\frac{4}{5}(-I_1) = I_1$$\n这就得到了所要求的恒等式：$-f(0)^3 f'(0) = \\int_0^1 f(\\xi) d\\xi$。\n\n### 第 3 步：振幅和长度前置因子\n\n问题陈述了关于前置因子的三个关键关系：\n1.  $D \\dfrac{W_0^3}{L_0^2} = 1$（来自将常微分方程无参数化）\n2.  $W_0 L_0 I_1 = Q_0$（来自全局质量守恒，其中 $I_1=\\int_0^1 f d\\xi$）\n从（1），$L_0 = \\sqrt{D} W_0^{3/2}$。将此代入（2）：\n$$W_0 (\\sqrt{D} W_0^{3/2}) I_1 = Q_0 \\implies W_0^{5/2} = \\frac{Q_0}{I_1 \\sqrt{D}}$$\n$$W_0 = \\left( \\frac{Q_0}{I_1 \\sqrt{D}} \\right)^{2/5}$$\n将 $W_0$ 代回 $L_0$ 的表达式中：\n$$L_0 = \\frac{Q_0}{W_0 I_1} = \\frac{Q_0}{I_1} \\left( \\frac{I_1 \\sqrt{D}}{Q_0} \\right)^{2/5} = Q_0^{3/5} I_1^{-3/5} D^{1/5} = \\left( \\frac{Q_0^3 D}{I_1^3} \\right)^{1/5}$$\n\n### 第 4 步：一致性验证\n\n近尖端系数 $C(t)$ 的两个表达式为：\n-   全局相似性：$w(x,t) \\sim \\frac{W_0 A t^\\alpha}{l(t)^{1/3}}(l(t)-x)^{1/3} \\implies C_{\\mathrm{global}}(t) = \\frac{W_0 A t^\\alpha}{l(t)^{1/3}}$。\n-   局部速度：从尖端附近的物理学，$V = \\lim (q/w)$，可以证明 $V(t) = D C(t)^3 / 3$，这给出 $C_{\\mathrm{local}}(t) = \\left(\\frac{3V(t)}{D}\\right)^{1/3} = \\left(\\frac{36\\mu V(t)}{k_e}\\right)^{1/3}$。\n\n我们必须证明它们是相同的。让我们在 $t=1\\,\\mathrm{s}$ 处进行评估：\n$l(1) = L_0$ 且 $V(1) = \\frac{d}{dt}(L_0 t^\\beta)|_{t=1} = L_0 \\beta = \\frac{4}{5}L_0$。\n$$C_{\\mathrm{global}}(1) = \\frac{W_0 A}{L_0^{1/3}}$$\n$$C_{\\mathrm{local}}(1) = \\left( \\frac{36\\mu}{k_e} \\frac{4}{5}L_0 \\right)^{1/3} = \\left( \\frac{3}{D} \\frac{4}{5}L_0 \\right)^{1/3} = \\left( \\frac{12 L_0}{5D} \\right)^{1/3}$$\n要使它们相等，它们的立方必须相等：\n$$\\frac{W_0^3 A^3}{L_0} = \\frac{12 L_0}{5D} \\implies 5D W_0^3 A^3 = 12 L_0^2$$\n使用推导出的值 $A^3 = 12/5$：\n$$5D W_0^3 \\left(\\frac{12}{5}\\right) = 12 L_0^2 \\implies 12 D W_0^3 = 12 L_0^2 \\implies D W_0^3 = L_0^2$$\n这恰好是用于使相似性常微分方程无参数化的条件 $D W_0^3 / L_0^2 = 1$。因此，该公式是自洽的，理论上的相对误差 $\\delta$ 为 $0$。数值实现中任何非零结果都将归因于数值精度和近似误差。\n\n数值部分涉及通过从尖端向后积分来求解 $f(\\xi)$ 的常微分方程，并使用渐近解提供初始条件。这将确定形状积分 $I_1 = \\int_0^1 f(\\xi)d\\xi$ 的值。已知 $I_1$ 后，所有其他量都可以计算出来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the PKN problem for the given test cases.\n    It encapsulates the numerical solution of the similarity ODE and the\n    calculation of the consistency error.\n    \"\"\"\n\n    def setup_pkn_solver(eps=1e-10):\n        \"\"\"\n        Solves the parameter-free PKN similarity ODE to find the shape function f(xi)\n        and compute its integral I1.\n\n        The solution is obtained by backward integration from the fracture tip.\n        The similarity ODE is: (f^3 * f')' = (1/5)f - (4/5)*xi*f'\n        \n        Let eta = 1 - xi. The ODE in terms of eta is:\n        d/d_eta (f^3 * df/d_eta) = (1/5)f + (4/5)*(1-eta)*df/d_eta\n        \n        We solve this as a system of first-order ODEs for y = [f, g], where g = f^3 * df/d_eta.\n        \"\"\"\n        # Universal constant from tip asymptotic f(eta) ~ A * eta^(1/3)\n        A = (12/5)**(1/3)\n\n        def pkn_ode_eta(eta, y):\n            \"\"\"The system of ODEs in the eta coordinate.\"\"\"\n            f, g = y\n            # Add a small floor to f to prevent division by zero, though in practice\n            # f should remain positive when integrating from the tip.\n            f_cubed = f**3\n            if f_cubed  1e-30:\n                f_cubed = 1e-30\n            \n            df_deta = g / f_cubed\n            dg_deta = f/5 + 4/5 * (1 - eta) * df_deta\n            return [df_deta, dg_deta]\n\n        # Initial conditions at eta = eps (a point very close to the fracture tip xi=1)\n        f_init = A * eps**(1/3)\n        g_init = (4/5) * f_init  # From g' ~ (4/5)f' -> g ~ (4/5)f for g(0)=f(0)=0\n        y_init = [f_init, g_init]\n        \n        # Integrate from eta=eps to eta=1 (corresponds to xi=1-eps to xi=0)\n        sol = solve_ivp(pkn_ode_eta, [eps, 1.0], y_init, dense_output=True, method='Radau', atol=1e-12, rtol=1e-12)\n\n        # The dense output provides an interpolation function for the solution\n        f_numerical_interp = sol.sol\n\n        # The integral of the similarity shape function f(xi) over [0, 1] is I1.\n        # I1 = integral from xi=0 to 1 of f(xi)dxi\n        # This is equivalent to integral from eta=0 to 1 of f_sol(eta)deta\n        # We split this into the part solved numerically and the part approximated\n        # by the asymptotic solution near the tip.\n        \n        # Integral over the numerically solved domain [eps, 1]\n        main_integral_val, _ = quad(lambda eta: f_numerical_interp(eta)[0], eps, 1.0, epsabs=1e-14, epsrel=1e-14)\n        \n        # Integral over the tip region [0, eps], using the asymptotic form f(eta) ~ A * eta^(1/3)\n        tip_integral_val = A * (eps**(4/3)) * (3/4)\n        \n        I1 = main_integral_val + tip_integral_val\n        \n        return I1, A\n\n    # Numerically compute the universal constants I1 and A once.\n    I1_const, A_const = setup_pkn_solver()\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        (3.0e10, 15.0, 0.1, 0.05),\n        # Case B\n        (2.5e10, 10.0, 0.001, 0.1),\n        # Case C\n        (3.5e10, 30.0, 10.0, 1.0e-3),\n    ]\n\n    results = []\n    for E_prime, h, mu, Q0 in test_cases:\n        t = 1.0  # Time of evaluation is 1 s\n        \n        # Calculate derived physical parameters\n        k_e = E_prime / h\n        D = k_e / (12 * mu)\n        \n        # Calculate PKN model prefactors W0 and L0 using the derived formulas\n        # W0 = (Q0 / (I1 * sqrt(D)))^(2/5)\n        # L0 = (Q0^3 * D / I1^3)^(1/5)\n        W0 = (Q0 / (I1_const * np.sqrt(D)))**(2/5)\n        L0 = (Q0**3 * D / I1_const**3)**(1/5)\n        \n        # Similarity exponents\n        alpha = 1/5\n        beta = 4/5\n        \n        # Fracture length and propagation speed at t=1s\n        # l(t) = L0 * t^beta\n        l_at_t1 = L0 * t**beta\n        # V(t) = d(l(t))/dt = L0 * beta * t^(beta-1)\n        V_at_t1 = L0 * beta * t**(beta - 1)\n        \n        # ---\n        # Calculate the near-tip coefficient C(t) at t=1s via two routes\n        # ---\n        \n        # Route 1: Global-similarity\n        # C_global(t) = (W0 * A * t^alpha) / (l(t)^(1/3))\n        C_global_t1 = (W0 * A_const * t**alpha) / (l_at_t1**(1/3))\n        \n        # Route 2: Local-speed\n        # C_local(t) = (36 * mu * V(t) / k_e)^(1/3)\n        C_local_t1 = (36 * mu * V_at_t1 / k_e)**(1/3)\n        \n        # Compute the relative error delta\n        if C_local_t1 == 0:\n            relative_error = 0.0 if C_global_t1 == 0.0 else np.inf\n        else:\n            relative_error = np.abs(C_global_t1 - C_local_t1) / C_local_t1\n            \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "3530236"}, {"introduction": "现代断裂模型通常依赖于一个“内禀长度尺度”($\\ell$)来描述断裂过程区，但这个参数必须经过物理标定。本练习将指导您完成一个完整的工作流程：从利用模拟的实验室数据（尺寸效应律）确定$\\ell$，到评估其对大规模裂缝扩展模拟的影响。这项练习弥合了实验力学和计算建模之间的鸿沟，突出了参数标定和敏感性分析在预测性模拟中的关键作用。[@problem_id:3530210]", "problem": "考虑一个非局部或梯度损伤模型的标定，以及随后的水力裂缝扩展对内禀长度的敏感性。您将构建一个完整且可运行的程序，该程序 (i) 通过基于能量断裂力学的尺寸效应拟合，从带切口的实验室试验数据中推断内禀长度 $\\,\\ell\\,$，以及 (ii) 在一个简化的流体驱动裂缝扩展模型中使用标定的 $\\,\\ell\\,$，来量化预测的裂缝半长 $\\,L(t)\\,$ 对 $\\,\\ell\\,$ 的敏感性。所有结果必须使用国际单位制生成，并以米为单位报告，四舍五入到六位小数。\n\n推导必须从以下基本依据和经过充分检验的事实出发：\n- 准脆性断裂的能量平衡，正如线性弹性断裂力学 (LEFM) 所描述的那样，即在扩展时能量释放率等于材料的断裂能。将平面应变模量定义为 $\\,E' = E/(1-\\nu^2)\\,$。\n- Irwin 特征长度 $\\,l_{\\mathrm{ch}} = E' G_f / f_t^2\\,$，其中 $\\,G_f\\,$ 是断裂能，$\\,f_t\\,$ 是抗拉强度。\n- 针对带切口试样的 Bažant 尺寸效应律，其便于回归的形式可以表示为名义强度平方的倒数与结构特征尺寸之间的线性关系。当无量纲几何函数缓慢变化时，双参数拟合可以得到一个有效过渡尺寸 $\\,D_0\\,$ 和一个渐近强度 $\\,\\sigma_0\\,$，使得数据近似满足 $\\,\\sigma_N(D) \\approx \\sigma_0 / \\sqrt{1 + D/D_0}\\,$。使用标准线性化方法，将 $\\,Y = 1/\\sigma_N^2\\,$ 拟合为 $\\,X=D\\,$ 的线性函数，并从斜率和截距中推断出 $\\,D_0\\,$ 和 $\\,\\sigma_0\\,$。\n- 在一大类梯度损伤和相场正则化方法中，内禀长度 $\\,\\ell\\,$ 与有效断裂过程区尺寸成比例，对于深切口尺寸效应标定，该尺寸在主导阶上可被视为过渡尺寸 $\\,D_0\\,$。在本问题中，取 $\\,\\ell = D_0\\,$。\n- 对于在平面应变条件下，受均匀净流体压力 $\\,p\\,$ 作用的半长为 $\\,L\\,$ 的 I 型受压裂缝，其单位平面外厚度的弹性柔度由经典的 Sneddon 解给出：单位厚度的裂缝体积为 $\\,V' = (2\\pi/E')\\, p\\, L^2\\,$。这是来自 LEFM 的一个经过充分检验的结果。\n- 单位平面外厚度的流体质量守恒遵循 $\\,dV'/dt = Q'\\,$，其中 $\\,Q'\\,$ 是单位厚度的注入速率。对于高粘度流体中滤失可忽略的早期成核控制生长，假设裂缝尖端阻力由抗拉强度控制，从而得到净压力 $\\,p \\approx f_t\\,$。结合这些来获得并积分关于 $\\,L(t)\\,$ 的常微分方程。\n\n您的程序必须实现以下任务。\n\n1) 标定任务。给定以结构尺寸 $\\,D\\,$（单位为米）和名义强度 $\\,\\sigma_N\\,$（单位为帕斯卡）数据对形式表示的带切口实验室数据，对 $\\,Y = 1/\\sigma_N^2\\,$ 与 $\\,X = D\\,$ 进行最小二乘线性回归，以确定斜率 $\\,A\\,$ 和截距 $\\,B\\,$。根据这些值，计算过渡尺寸 $\\,D_0 = B/A\\,$ 和渐近强度 $\\,\\sigma_0 = 1/\\sqrt{B}\\,$。将内禀长度确定为 $\\,\\ell = D_0\\,$。\n\n2) 水力裂缝敏感性任务。使用 $\\,E'\\,$ 和 $\\,G_f\\,$，计算 $\\,f_t = \\sqrt{E' G_f / \\ell}\\,$。将均匀净压力设为 $\\,p = f_t\\,$。根据质量守恒和弹性柔度，推导出在指定时间 $\\,t\\,$ 和指定单位厚度注入速率 $\\,Q'\\,$ 下 $\\,L(t)\\,$ 的演化规律。然后，对于每个测试案例，评估三种内禀长度（$\\,\\ell\\,$, $\\,\\ell/2\\,$ 和 $\\,2\\ell\\,$）下的 $\\,L(t)\\,$，同时保持所有其他参数不变，以量化敏感性。\n\n您的实现必须使用以下材料常数和测试套件。\n\n- 所有测试共用的材料常数：平面应变模量 $\\,E' = 25\\times 10^9\\,$ 帕斯卡；断裂能 $\\,G_f = 40\\,$ 焦耳每平方米。这些是固定且已知的。\n\n- 包含两个标定-扩展案例的测试套件：\n\n案例 A：\n- 带切口标定数据（所有强度必须视为帕斯卡）：尺寸 $\\,D\\,$ 分别等于 $\\,0.02\\,$ 米、$\\,0.06\\,$ 米和 $\\,0.16\\,$ 米；对应的名义强度 $\\,\\sigma_N\\,$ 分别等于 $\\,8\\times 10^6/\\sqrt{2}\\,$, $\\,4\\times 10^6\\,$ 和 $\\,8\\times 10^6/3\\,$ 帕斯卡。\n- 单位厚度注入速率 $\\,Q' = 1.0\\times 10^{-3}\\,$ 平方米每秒。\n- 评估时间 $\\,t = 100\\,$ 秒。\n\n案例 B：\n- 带切口标定数据：尺寸 $\\,D\\,$ 分别等于 $\\,0.015\\,$ 米、$\\,0.045\\,$ 米和 $\\,0.12\\,$ 米；对应的名义强度 $\\,\\sigma_N\\,$ 分别等于 $\\,8\\times 10^6/\\sqrt{2}\\,$, $\\,4\\times 10^6\\,$ 和 $\\,8\\times 10^6/3\\,$ 帕斯卡。\n- 单位厚度注入速率 $\\,Q' = 7.5\\times 10^{-4}\\,$ 平方米每秒。\n- 评估时间 $\\,t = 80\\,$ 秒。\n\n所有计算必须以国际单位制（SI units）进行。每个案例最终要求的输出是四个浮点数值：\n- 标定的内禀长度 $\\,\\ell\\,$（单位为米）。\n- 在指定时间下，对于 $\\,\\ell\\,$ 的预测裂缝半长 $\\,L(t)\\,$。\n- 在指定时间下，对于 $\\,\\ell/2\\,$ 的预测裂缝半长 $\\,L(t)\\,$。\n- 在指定时间下，对于 $\\,2\\ell\\,$ 的预测裂缝半长 $\\,L(t)\\,$。\n\n您的程序应生成单行输出，包含一个由两个列表组成的逗号分隔列表，每个列表对应一个案例，每个内部列表包含上述四个值，所有值均以米表示并四舍五入到六位小数，例如 $\\,[[\\ell_A,L_A(\\ell_A),L_A(\\ell_A/2),L_A(2\\ell_A)],[\\ell_B,L_B(\\ell_B),L_B(\\ell_B/2),L_B(2\\ell_B)]]\\,$，其中每个数值条目均四舍五 \"round\" 到六位小数，且不打印单位。\n\n角度单位不适用。如果您在内部计算任何分数，请确保所有输出都是十进制浮点数。除了要求的单行输出外，不应打印任何其他文本。", "solution": "用户提供的问题是有效的，因为它在科学上基于断裂力学和计算地质力学的原理，其提法明确，具有清晰完整的数据和目标，并以客观、正式的语言表述。它展示了一个标准的、尽管是简化的模型标定和敏感性分析工作流程，没有矛盾或含糊之处。\n\n本文遵循基于原理的设计，提供一个完整的、论证充分的解决方案。该方案分为两个主要部分：首先，根据尺寸效应数据标定内禀长度参数 $\\,\\ell\\,$；其次，推导并应用一个水力裂缝扩展模型来评估对 $\\,\\ell\\,$ 的敏感性。\n\n### 第 1 部分：通过尺寸效应律标定内禀长度 $\\,\\ell\\,$\n\n内禀长度 $\\,\\ell\\,$ 的标定基于 Bažant 尺寸效应律，这是准脆性断裂力学的一块基石。该定律描述了破坏模式从强度控制（在小试样中）到断裂控制（在大试样中）的转变。对于带切口的几何形状，名义强度 $\\,\\sigma_N\\,$ 作为试样特征尺寸 $\\,D\\,$ 的函数由下式给出：\n$$\n\\sigma_N(D) \\approx \\frac{\\sigma_0}{\\sqrt{1 + \\frac{D}{D_0}}}\n$$\n其中 $\\,\\sigma_0\\,$ 是无限大试样的渐近强度（对应于非硬化材料的塑性极限载荷），而 $\\,D_0\\,$ 是过渡尺寸，它表征了行为介于基于强度的准则和线性弹性断裂力学 (LEFM) 之间的尺寸。\n\n为了从实验数据 $\\,(D_i, \\sigma_{N,i})\\,$ 中确定 $\\,\\sigma_0\\,$ 和 $\\,D_0\\,$，该方程被线性化。平方并取倒数，得到：\n$$\n\\frac{1}{\\sigma_N^2} = \\frac{1}{\\sigma_0^2}\\left(1 + \\frac{D}{D_0}\\right) = \\left(\\frac{1}{\\sigma_0^2 D_0}\\right)D + \\frac{1}{\\sigma_0^2}\n$$\n该方程呈直线形式 $\\,Y = A X + B\\,$，其中：\n- $\\,Y = 1/\\sigma_N^2\\,$\n- $\\,X = D\\,$\n- 斜率为 $\\,A = \\frac{1}{\\sigma_0^2 D_0}\\,$\n- 截距为 $\\,B = \\frac{1}{\\sigma_0^2}\\,$\n\n给定一组 $\\,n\\,$ 个数据点 $\\,(X_i, Y_i)\\,$，通过标准最小二乘线性回归找到系数 $\\,A\\,$ 和 $\\,B\\,$。一旦 $\\,A\\,$ 和 $\\,B\\,$ 已知，就可以恢复物理参数：\n$$\n\\sigma_0 = \\frac{1}{\\sqrt{B}}\n$$\n$$\nD_0 = \\frac{B}{A}\n$$\n问题陈述指出，对于所考虑的非局部损伤模型，内禀长度参数 $\\,\\ell\\,$ 被视为过渡尺寸 $\\,D_0\\,$。这是该领域的一种常规做法，因为 $\\,\\ell\\,$ 和 $\\,D_0\\,$ 都代表了与断裂过程区尺寸相关的内禀长度尺度。因此，我们设定：\n$$\n\\ell = D_0 = \\frac{B}{A}\n$$\n此过程将应用于为每个测试案例提供的标定数据。\n\n### 第 2 部分：水力裂缝扩展与敏感性分析\n\n问题的第二部分涉及对水力裂缝的扩展进行建模，并评估其对标定的内禀长度 $\\,\\ell\\,$ 的敏感性。该模型基于作用于由均匀净压力 $\\,p\\,$ 驱动的半长为 $\\,L\\,$ 的平面应变裂缝的两个基本原理。\n\n1.  **弹性柔度：** 单位厚度裂缝体积 $\\,V'\\,$、压力 $\\,p\\,$ 和半长 $\\,L\\,$ 之间的关系由一个经典的 LEFM 解给出：\n    $$\n    V' = \\frac{2\\pi}{E'} p L^2\n    $$\n    其中 $\\,E'\\,$ 是平面应变弹性模量。\n\n2.  **流体质量守恒：** 假设流体不可压缩且没有向周围介质的滤失，裂缝体积的变化率必须等于单位厚度的流体注入速率 $\\,Q'\\,$：\n    $$\n    \\frac{dV'}{dt} = Q'\n    $$\n\n为了推导裂缝半长 $\\,L(t)\\,$ 的演化规律，我们对柔度方程关于时间 $\\,t\\,$ 求导。问题指定了一个早期、高粘度流体的情景，其中裂缝的生长主要受到材料韧性的抵抗。这为净压力恒定且等于材料抗拉强度 $\\,p \\approx f_t\\,$ 的简化假设提供了理由。\n$$\n\\frac{dV'}{dt} = \\frac{d}{dt}\\left(\\frac{2\\pi p}{E'} L(t)^2\\right) = \\frac{4\\pi p}{E'} L(t) \\frac{dL(t)}{dt}\n$$\n将此与质量守恒定律相等，得到关于 $\\,L(t)\\,$ 的一阶常微分方程：\n$$\nQ' = \\frac{4\\pi p}{E'} L(t) \\frac{dL(t)}{dt}\n$$\n这个常微分方程是可分离的。我们从 $\\,t=0\\,$ 时 $\\,L=0\\,$ 的初始状态重新整理并积分：\n$$\n\\int_0^{L(t)} L \\, dL = \\int_0^t \\frac{Q' E'}{4\\pi p} \\, dt\n$$\n$$\n\\frac{L(t)^2}{2} = \\frac{Q' E'}{4\\pi p} t\n$$\n求解 $\\,L(t)\\,$ 得到扩展规律：\n$$\nL(t) = \\sqrt{\\frac{Q' E' t}{2\\pi p}}\n$$\n通过将压力 $\\,p\\,$ 与标定的内禀长度 $\\,\\ell\\,$ 联系起来，模型得以完成。问题提供了关系式 $\\,f_t = \\sqrt{E' G_f / \\ell}\\,$，其中 $\\,G_f\\,$ 是断裂能。设 $\\,p = f_t\\,$，我们将其代入 $\\,L(t)\\,$ 的表达式中：\n$$\nL(t, \\ell) = \\sqrt{\\frac{Q' E' t}{2\\pi \\sqrt{E' G_f / \\ell}}} = \\sqrt{\\frac{Q' t}{2\\pi}} (E')^{1/4} (G_f)^{-1/4} \\ell^{1/4}\n$$\n这个最终方程明确地显示了裂缝半长对内禀长度的依赖关系：$\\,L \\propto \\ell^{1/4}\\,$。对于每个测试案例，在标定 $\\,\\ell\\,$ 之后，将使用此方程计算标定 $\\,\\ell\\,$ 下的 $\\,L(t)\\,$，以及扰动值 $\\,\\ell/2\\,$ 和 $\\,2\\ell\\,$ 下的 $\\,L(t)\\,$，以量化模型对这一关键参数的敏感性。\n\n数值实现将首先对每个案例的转换后数据 $\\,(D, 1/\\sigma_N^2)\\,$ 进行线性回归，以找到 $\\,\\ell = B/A\\,$。然后，将在指定的时间 $\\,t\\,$ 和注入速率 $\\,Q'\\,$ 下，对三个所需的内禀长度值，评估推导出的 $\\,L(t, \\ell)\\,$ 公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calibrating an internal length from size effect data\n    and performing a sensitivity analysis on a hydraulic fracture propagation model.\n    \"\"\"\n\n    # Material constants common to all tests (SI units)\n    E_PRIME = 25e9  # Plane-strain modulus in Pa\n    G_F = 40.0      # Fracture energy in J/m^2\n\n    # Test suite of two calibration-propagation cases\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"D\": np.array([0.02, 0.06, 0.16]),  # meters\n            \"sigma_N\": np.array([8e6 / np.sqrt(2), 4e6, 8e6 / 3.0]),  # Pascals\n            \"Q_prime\": 1.0e-3,  # m^2/s\n            \"t\": 100.0,  # seconds\n        },\n        {\n            \"name\": \"Case B\",\n            \"D\": np.array([0.015, 0.045, 0.12]),  # meters\n            \"sigma_N\": np.array([8e6 / np.sqrt(2), 4e6, 8e6 / 3.0]),  # Pascals\n            \"Q_prime\": 7.5e-4,  # m^2/s\n            \"t\": 80.0,  # seconds\n        },\n    ]\n\n    all_results = []\n\n    def calculate_L(l_val, Q_prime, t, E_prime, G_f):\n        \"\"\"\n        Calculates the hydraulic fracture half-length L(t).\n        \n        L(t) = sqrt( (Q' * E' * t) / (2 * pi * p) )\n        where p = f_t = sqrt(E' * G_f / l)\n        \n        This simplifies to: L(t, l) = sqrt(Q'*t/(2*pi)) * (E')^(1/4) * (G_f)^(-1/4) * l^(1/4)\n        \"\"\"\n        if l_val == 0:\n            return 0.0\n            \n        term1 = np.sqrt(Q_prime * t / (2.0 * np.pi))\n        term2 = E_prime**0.25\n        term3 = G_f**-0.25\n        term4 = l_val**0.25\n        \n        L = term1 * term2 * term3 * term4\n        return L\n\n    for case in test_cases:\n        # 1) Calibration task\n        D_data = case[\"D\"]\n        sigma_N_data = case[\"sigma_N\"]\n\n        # Linearize the data for regression: Y = A*X + B\n        X = D_data\n        Y = 1.0 / (sigma_N_data**2)\n\n        # Perform least-squares linear regression to find slope A and intercept B\n        # np.polyfit(x, y, 1) returns [slope, intercept]\n        A, B = np.polyfit(X, Y, 1)\n\n        # Compute transitional size D_0 and identify internal length l\n        # Avoid division by zero if slope is zero\n        if A == 0:\n            # This case shouldn't happen with the given data\n            # but is good practice for robustness.\n            l_calibrated = np.inf\n        else:\n            D_0 = B / A\n            l_calibrated = D_0\n\n        # 2) Hydraulic fracture sensitivity task\n        Q_prime_case = case[\"Q_prime\"]\n        t_case = case[\"t\"]\n\n        # Calculate L(t) for the three internal lengths: l, l/2, 2l\n        L_at_l = calculate_L(l_calibrated, Q_prime_case, t_case, E_PRIME, G_F)\n        L_at_l_half = calculate_L(l_calibrated / 2.0, Q_prime_case, t_case, E_PRIME, G_F)\n        L_at_2l = calculate_L(l_calibrated * 2.0, Q_prime_case, t_case, E_PRIME, G_F)\n\n        # Store results for this case\n        case_results = [l_calibrated, L_at_l, L_at_l_half, L_at_2l]\n        all_results.append(case_results)\n\n    # Format the final output string as required\n    formatted_results = []\n    for result_set in all_results:\n        # Round each value to 6 decimal places and format as a string\n        str_values = [f\"{val:.6f}\" for val in result_set]\n        # Join the strings with commas and enclose in brackets\n        formatted_results.append(f\"[{','.join(str_values)}]\")\n    \n    # Join the case results with a comma and enclose in outer brackets\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "3530210"}]}