{"hands_on_practices": [{"introduction": "理解多孔岩石在快速加载下的响应是多孔弹性力学的基础。在这种不排水条件下，孔隙流体没有时间流出，导致孔隙压力发生显著变化。本练习 [@problem_id:3513581] 将指导你推导并计算关键的多孔弹性参数，例如 Skempton 孔隙压力系数 $B$，该系数定量描述了总应力变化引起的孔隙压力响应，这是理解流固耦合效应的第一步。", "problem": "考虑一个均质、完全饱和、各向同性的储层岩石，正在经历一次快速、空间均匀的加载，以至于流体无法排出（不排水条件）。应力和应变采用压缩为正的符号约定。岩石骨架由Biot多孔弹性理论描述，其排水体积模量为$K_b$，Biot系数为$\\alpha$，Biot模量为$M$，孔隙流体是微可压缩的。加载是在平均总应力上均匀施加一个增量$\\Delta \\sigma_m$。从平均总应力和流体含量变化的 poroelastic 本构关系出发，结合不排水约束条件，推导不排水体积模量$K_u$和Skempton孔隙压力系数$B$的表达式，以$K_b$、$\\alpha$和$M$表示。然后用这些表达式预测由$\\Delta \\sigma_m$引起的不排水孔隙压力增量$\\Delta p$。\n\n使用以下参数值：$K_b = 8$ GPa，$\\alpha = 0.9$，$M = 4$ GPa，以及$\\Delta \\sigma_m = 5$ MPa。在任何计算中，一致地处理吉帕斯卡（GPa）和兆帕斯卡（MPa）。以兆帕斯卡（MPa）为单位表示最终的不排水孔隙压力增量$\\Delta p$，并将您的答案四舍五入到四位有效数字。仅报告$\\Delta p$的数值作为您的最终答案。", "solution": "该问题要求根据Biot多孔弹性理论的原理，推导不排水体积模量（$K_u$）和Skempton孔隙压力系数（$B$），并随后使用它们来计算在给定不排水加载条件下产生的孔隙压力增量（$\\Delta p$）。\n\n分析始于多孔弹性本构关系，采用压缩为正的应力和应变符号约定。两个基本关系将平均总应力增量（$\\Delta \\sigma_m$）和孔隙压力增量（$\\Delta p$）与岩石骨架的体积应变（$\\Delta \\epsilon_v$）和流体含量的变化（$\\Delta \\zeta$）联系起来。流体含量的变化$\\Delta \\zeta$表示单位参考体积内流体质量的变化量除以初始流体密度。\n\n第一个本构关系，源自有效应力原理（$\\Delta \\sigma'_m = \\Delta \\sigma_m - \\alpha \\Delta p$）和骨架的应力-应变定律（$\\Delta \\sigma'_m = K_b \\Delta \\epsilon_v$），为：\n$$ \\Delta \\sigma_m = K_b \\Delta \\epsilon_v + \\alpha \\Delta p \\quad (1) $$\n其中$K_b$是岩石骨架的排水体积模量，$\\alpha$是Biot系数。\n\n第二个本构关系描述了由于骨架体积和流体质量的变化引起的孔隙流体压力变化：\n$$ \\Delta p = M (\\alpha \\Delta \\epsilon_v - \\Delta \\zeta) \\quad (2) $$\n其中$M$是Biot模量。该方程捕捉了固相和流相之间的耦合。\n\n问题指定了快速、均匀的加载，这对应于不排水条件。在不排水条件下，没有流体流入或流出代表性体积单元。这意味着流体含量的变化为零：\n$$ \\Delta \\zeta = 0 $$\n\n将此不排水约束应用于方程（2）：\n$$ \\Delta p = M (\\alpha \\Delta \\epsilon_v - 0) $$\n$$ \\Delta p = \\alpha M \\Delta \\epsilon_v \\quad (3) $$\n该方程给出了不排水条件下诱导孔隙压力和体积应变之间的直接关系。我们可以重新整理它来表示$\\Delta \\epsilon_v$：\n$$ \\Delta \\epsilon_v = \\frac{\\Delta p}{\\alpha M} \\quad (4) $$\n\n现在，我们推导不排水体积模量$K_u$和Skempton系数$B$的表达式。\n\n首先，我们推导不排水体积模量$K_u$。根据定义，$K_u$将在不排水条件下平均总应力的变化与体积应变联系起来，即当$\\Delta \\zeta = 0$时，$\\Delta \\sigma_m = K_u \\Delta \\epsilon_v$。我们可以通过将方程（3）中的$\\Delta p$表达式代入方程（1）来找到这个关系：\n$$ \\Delta \\sigma_m = K_b \\Delta \\epsilon_v + \\alpha (\\alpha M \\Delta \\epsilon_v) $$\n$$ \\Delta \\sigma_m = K_b \\Delta \\epsilon_v + \\alpha^2 M \\Delta \\epsilon_v $$\n提取公因式$\\Delta \\epsilon_v$：\n$$ \\Delta \\sigma_m = (K_b + \\alpha^2 M) \\Delta \\epsilon_v $$\n将其与$K_u$的定义进行比较，我们得到不排水体积模量的表达式：\n$$ K_u = K_b + \\alpha^2 M $$\n\n接下来，我们推导Skempton孔隙压力系数$B$。它被定义为在不排水条件下，孔隙压力变化与平均总应力变化之比：\n$$ B = \\frac{\\Delta p}{\\Delta \\sigma_m} $$\n为了找到这个关系，我们在方程（1）和（4）之间消去$\\Delta \\epsilon_v$。将方程（4）代入方程（1）：\n$$ \\Delta \\sigma_m = K_b \\left(\\frac{\\Delta p}{\\alpha M}\\right) + \\alpha \\Delta p $$\n$$ \\Delta \\sigma_m = \\Delta p \\left(\\frac{K_b}{\\alpha M} + \\alpha\\right) $$\n$$ \\Delta \\sigma_m = \\Delta p \\left(\\frac{K_b + \\alpha^2 M}{\\alpha M}\\right) $$\n重新整理以求比值$\\Delta p / \\Delta \\sigma_m$：\n$$ \\frac{\\Delta p}{\\Delta \\sigma_m} = \\frac{\\alpha M}{K_b + \\alpha^2 M} $$\n因此，Skempton系数$B$的表达式是：\n$$ B = \\frac{\\alpha M}{K_b + \\alpha^2 M} $$\n注意，我们也可以用$K_u$来表示$B$，即$B=\\alpha M / K_u$。\n\n问题要求预测由给定的平均总应力增量$\\Delta \\sigma_m$引起的不排水孔隙压力增量$\\Delta p$。使用Skempton系数$B$的定义：\n$$ \\Delta p = B \\Delta \\sigma_m = \\left(\\frac{\\alpha M}{K_b + \\alpha^2 M}\\right) \\Delta \\sigma_m $$\n\n我们给定的参数值如下：\n$K_b = 8$ GPa\n$\\alpha = 0.9$\n$M = 4$ GPa\n$\\Delta \\sigma_m = 5$ MPa\n\n为了进行计算，我们必须确保单位一致。我们可以用GPa来处理所有模量，因为在计算无量纲的$B$时，单位会抵消。\n首先，计算分子$\\alpha M$：\n$$ \\alpha M = 0.9 \\times 4 \\text{ GPa} = 3.6 \\text{ GPa} $$\n接下来，计算分母$K_b + \\alpha^2 M$：\n$$ K_b + \\alpha^2 M = 8 \\text{ GPa} + (0.9)^2 \\times 4 \\text{ GPa} $$\n$$ K_b + \\alpha^2 M = 8 \\text{ GPa} + 0.81 \\times 4 \\text{ GPa} $$\n$$ K_b + \\alpha^2 M = 8 \\text{ GPa} + 3.24 \\text{ GPa} = 11.24 \\text{ GPa} $$\n现在，计算Skempton系数$B$：\n$$ B = \\frac{3.6 \\text{ GPa}}{11.24 \\text{ GPa}} = \\frac{3.6}{11.24} = \\frac{360}{1124} = \\frac{90}{281} $$\n最后，计算孔隙压力增量$\\Delta p$：\n$$ \\Delta p = B \\times \\Delta \\sigma_m = \\frac{90}{281} \\times 5 \\text{ MPa} = \\frac{450}{281} \\text{ MPa} $$\n现在我们计算数值：\n$$ \\Delta p \\approx 1.6014234875... \\text{ MPa} $$\n根据要求将结果四舍五入到四位有效数字：\n$$ \\Delta p = 1.601 \\text{ MPa} $$\n最终答案为$\\Delta p$的数值。", "answer": "$$\\boxed{1.601}$$", "id": "3513581"}, {"introduction": "在掌握了瞬时响应之后，我们将注意力转向油气藏生产的长期效应。油气藏枯竭导致的孔隙压力下降会显著改变地下的有效应力场，这是引发地表沉降和断层活化等岩石力学问题的核心驱动因素。本练习 [@problem_id:3513573] 将探讨如何在典型的储层约束条件下计算这种应力路径，并评估其对天然裂缝稳定性等实际问题的影响。", "problem": "一个横向广阔、均质、各向同性的储层被建模为小应变下的线性多孔弹性固体。由于开采，该储层经历了 $\\Delta p=-10$ MPa 的均匀孔隙压力变化。岩石骨架的弹性特性为：杨氏模量 $E=30$ GPa，泊松比 $\\nu=0.25$。Biot 系数为 $\\alpha=0.8$，Biot 模量为 $M=5$ GPa。假设以下符合物理实际的条件，这些条件适用于嵌入在坚硬围岩中的压实储层：\n- 压应力为正。\n- 在开采期间，总垂直应力保持不变，$\\Delta \\sigma_{v}=0$。\n- 横向应变为零，$\\Delta \\varepsilon_{x}=\\Delta \\varepsilon_{y}=0$（垂直方向上的单轴应变条件）。\n- 无热效应或非弹性效应。\n\n结合线性各向同性弹性力学基本原理和 Biot 的多孔弹性有效应力定义，从第一性原理出发，推导水平总应力变化量 $\\Delta \\sigma_{h}$ 关于 $\\Delta p$、$\\alpha$ 和 $\\nu$（如果需要，还可包括 $E$）的表达式，然后根据给定数据进行计算。在您的结果中明确说明符号约定。最后，根据 $\\Delta \\sigma_{h}$ 的符号，简要评估在开采引起的应力路径下，远场裂缝更倾向于闭合还是张开。您必须只提供 $\\Delta \\sigma_{h}$ 的数值作为最终答案。\n\n以 MPa 为单位表示 $\\Delta \\sigma_{h}$ 的最终数值，并将答案四舍五入到四位有效数字。", "solution": "该问题要求在单轴垂直应变条件下，推导并计算经历开采的多孔弹性储层中总水平应力的变化量 $\\Delta \\sigma_{h}$。符号约定为压应力为正。\n\n线性、各向同性多孔弹性材料的基本本构关系将固体骨架的应变张量 $\\varepsilon_{ij}$ 与有效应力张量 $\\sigma'_{ij}$ 联系起来。对于主方向，其增量形式为：\n$$\n\\Delta \\varepsilon_{i} = \\frac{1}{E} \\left[ \\Delta \\sigma'_{i} - \\nu (\\Delta \\sigma'_{j} + \\Delta \\sigma'_{k}) \\right]\n$$\n其中 $E$ 是排干杨氏模量，$\\nu$ 是排干泊松比，下标 $i, j, k$ 代表三个正交的主方向。\n\nBiot 有效应力原理根据总应力张量 $\\sigma_{ij}$、Biot 系数 $\\alpha$ 和孔隙压力 $p$ 来定义有效应力张量。其增量形式为：\n$$\n\\Delta \\sigma'_{ij} = \\Delta \\sigma_{ij} - \\alpha \\Delta p \\, \\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克符号。\n\n我们有以下特定于问题的约束条件：\n1.  单轴应变条件：储层受到横向约束，因此水平应变的变化量为零。\n    $$\n    \\Delta \\varepsilon_{x} = 0 \\quad \\text{和} \\quad \\Delta \\varepsilon_{y} = 0\n    $$\n2.  总垂直应力恒定：总上覆载荷不发生变化。\n    $$\n    \\Delta \\sigma_{v} = \\Delta \\sigma_{z} = 0\n    $$\n3.  各向同性和对称性意味着总水平应力的变化是均匀的：\n    $$\n    \\Delta \\sigma_{x} = \\Delta \\sigma_{y} = \\Delta \\sigma_{h}\n    $$\n\n使用这些约束条件，我们可以表示主有效应力的变化：\n垂直有效应力的变化为：\n$$\n\\Delta \\sigma'_{z} = \\Delta \\sigma_{z} - \\alpha \\Delta p = 0 - \\alpha \\Delta p = -\\alpha \\Delta p\n$$\n水平有效应力的变化为：\n$$\n\\Delta \\sigma'_{x} = \\Delta \\sigma'_{y} = \\Delta \\sigma_{h} - \\alpha \\Delta p\n$$\n\n现在，我们可以写出 x 方向应变变化的本构关系：\n$$\n\\Delta \\varepsilon_{x} = \\frac{1}{E} \\left[ \\Delta \\sigma'_{x} - \\nu (\\Delta \\sigma'_{y} + \\Delta \\sigma'_{z}) \\right]\n$$\n代入给定条件 $\\Delta \\varepsilon_{x} = 0$ 和有效应力变化的表达式：\n$$\n0 = \\frac{1}{E} \\left[ (\\Delta \\sigma_{h} - \\alpha \\Delta p) - \\nu \\left( (\\Delta \\sigma_{h} - \\alpha \\Delta p) + (-\\alpha \\Delta p) \\right) \\right]\n$$\n我们可以消去 $1/E$ 项，并简化括号内的表达式：\n$$\n0 = (\\Delta \\sigma_{h} - \\alpha \\Delta p) - \\nu (\\Delta \\sigma_{h} - 2\\alpha \\Delta p)\n$$\n展开并合并 $\\Delta \\sigma_{h}$ 的项：\n$$\n0 = \\Delta \\sigma_{h} - \\alpha \\Delta p - \\nu \\Delta \\sigma_{h} + 2\\nu\\alpha \\Delta p\n$$\n$$\n\\Delta \\sigma_{h} (1 - \\nu) = \\alpha \\Delta p - 2\\nu\\alpha \\Delta p\n$$\n$$\n\\Delta \\sigma_{h} (1 - \\nu) = \\alpha \\Delta p (1 - 2\\nu)\n$$\n求解 $\\Delta \\sigma_{h}$ 得到所需的表达式，值得注意的是，该表达式不依赖于杨氏模量 $E$ 或 Biot 模量 $M$：\n$$\n\\Delta \\sigma_{h} = \\alpha \\left( \\frac{1 - 2\\nu}{1 - \\nu} \\right) \\Delta p\n$$\n此表达式是在单轴应变条件下，总水平应力变化量作为孔隙压力变化、Biot 系数和泊松比的函数。\n\n接下来，我们使用提供的数值数据来计算这个表达式：\n- Biot 系数, $\\alpha = 0.8$\n- 泊松比, $\\nu = 0.25$\n- 孔隙压力变化, $\\Delta p = -10 \\text{ MPa}$\n\n将这些值代入推导出的公式：\n$$\n\\Delta \\sigma_{h} = 0.8 \\left( \\frac{1 - 2(0.25)}{1 - 0.25} \\right) (-10 \\text{ MPa})\n$$\n$$\n\\Delta \\sigma_{h} = 0.8 \\left( \\frac{1 - 0.5}{0.75} \\right) (-10 \\text{ MPa})\n$$\n$$\n\\Delta \\sigma_{h} = 0.8 \\left( \\frac{0.5}{0.75} \\right) (-10 \\text{ MPa})\n$$\n$$\n\\Delta \\sigma_{h} = 0.8 \\left( \\frac{2}{3} \\right) (-10 \\text{ MPa})\n$$\n$$\n\\Delta \\sigma_{h} = -\\frac{16}{3} \\text{ MPa} \\approx -5.3333... \\text{ MPa}\n$$\n按要求四舍五入到四位有效数字，总水平应力的变化量为 $\\Delta \\sigma_h = -5.333$ MPa。\n\n最后，我们评估其对远场裂缝的影响。符号约定为压应力为正。我们计算出的 $\\Delta \\sigma_{h}$ 为负值，表示总水平应力发生了拉张性变化（即减小）。然而，裂缝的稳定性由作用在裂缝平面法线方向上的*有效*应力的变化所决定。对于垂直裂缝，这是水平有效应力的变化量 $\\Delta \\sigma'_{h}$。其计算方法如下：\n$$\n\\Delta \\sigma'_{h} = \\Delta \\sigma_{h} - \\alpha \\Delta p\n$$\n代入已知值：\n$$\n\\Delta \\sigma'_{h} = -5.333... \\text{ MPa} - (0.8)(-10 \\text{ MPa}) = -5.333... \\text{ MPa} + 8 \\text{ MPa} = +2.666... \\text{ MPa}\n$$\n$\\Delta \\sigma'_{h}$ 的正号表示作用在垂直裂缝上的压性有效应力增加了。压性有效应力的增加倾向于增大滑动的摩擦阻力并闭合任何已存在的孔隙。因此，在给定的开采引起的应力路径下，远场垂直裂缝更倾向于闭合。", "answer": "$$\n\\boxed{-5.333}\n$$", "id": "3513573"}, {"introduction": "理论分析为我们提供了深刻的见解，但解决真实的工程问题通常需要依赖数值模拟。本练习旨在弥合理论与实践之间的鸿沟，指导你构建一个一维耦合多孔弹性问题的基本模拟器。通过这个编程实践 [@problem_id:3513601]，你将学习顺序耦合算法的设计、残差的定义以及收敛性判断，这些都是计算岩石力学软件开发的核心概念。", "problem": "考虑一个高度为 $H$ 的一维垂直储层-岩石柱，其被离散为 $N$ 个间距均匀的单元，单元尺寸为 $\\Delta z = H/N$。该柱体经历微可压缩流体的单相流以及平面应变条件下的准静态线性孔隙弹性变形。耦合通过带有外不动点迭代的顺序流-地质力学算法处理。目标是为两个子问题定义残差，指定一致的范数停止准则，并实现一个稳健的算法来计算一个隐式时间步长后的地表沉降。\n\n基本原理：\n- 微可压缩单相流体的质量守恒和 Darcy 定律给出了压力 $p$ 的控制性偏微分方程（PDE）：\n$$\nS \\frac{\\partial p}{\\partial t} + \\alpha \\frac{\\partial \\epsilon_v}{\\partial t} - \\nabla \\cdot \\left(\\frac{k}{\\mu} \\nabla p \\right) = q,\n$$\n其中，$S$ 是有效储水系数，$\\alpha$ 是 Biot 系数，$\\epsilon_v$ 是体积应变，$k$ 是绝对渗透率，$\\mu$ 是动力粘度，$q$ 是单位体积的体积源。\n- 在平面应变和零增量垂直牵引力条件下，准静态线性孔隙弹性力学给出了体积应变和孔隙压力之间的局部本构关系：\n$$\nK_d \\, \\epsilon_v = \\alpha \\, p,\n$$\n其中，$K_d$ 是排水体积模量。\n\n离散化假设：\n- 在均匀网格上的有限体积离散化导出一个具有无流动（Neumann）边界条件的离散一维拉普拉斯算子 $L \\in \\mathbb{R}^{N \\times N}$。使用标准的二阶差分格式，定义 $L$ 使得对于 $1 \\le i \\le N-2$ 的内部单元 $i$：\n$$\n(L p)_i = 2 p_i - p_{i-1} - p_{i+1},\n$$\n以及对于边界：\n$$\n(L p)_0 = p_0 - p_1, \\quad (L p)_{N-1} = p_{N-1} - p_{N-2}.\n$$\n令 $T = \\frac{k}{\\mu \\, \\Delta z^2}$，使得离散扩散项为 $T L p$。\n- 从时间层 $n$ 到 $n+1$，步长为 $\\Delta t$ 的向后欧拉时间离散化给出了每个单元 $i$ 的代数质量守恒：\n$$\nS \\frac{p_i^{n+1} - p_i^{n}}{\\Delta t} + \\alpha \\frac{\\epsilon_{v,i}^{n+1} - \\epsilon_{v,i}^{n}}{\\Delta t} - T (L p^{n+1})_i = q_i.\n$$\n\n带有外不动点迭代的顺序流-地质力学分裂法：\n- 在第 $k$ 次外迭代中，将 $\\epsilon_v^{k}$ 在流体求解中视为已知。使用以下公式求解 $p^{k+1}$：\n$$\n\\left(\\frac{S}{\\Delta t} I - T L\\right) p^{k+1} = \\frac{S}{\\Delta t} p^{n} + \\frac{\\alpha}{\\Delta t} \\left( \\epsilon_v^{k} - \\epsilon_v^{n} \\right) + q,\n$$\n其中 $I$ 是单位矩阵。\n- 通过地质力学关系更新体积应变：\n$$\n\\epsilon_v^{k+1} = \\frac{\\alpha}{K_d} \\, p^{k+1}.\n$$\n\n残差定义（在每次外迭代的地质力学更新后计算）：\n- 流体残差向量 $r_f^{k+1} \\in \\mathbb{R}^N$：\n$$\nr_f^{k+1} = \\frac{S}{\\Delta t} \\left(p^{k+1} - p^{n}\\right) + \\frac{\\alpha}{\\Delta t} \\left(\\epsilon_v^{k+1} - \\epsilon_v^{n}\\right) - T L p^{k+1} - q.\n$$\n- 地质力学残差向量 $r_g^{k+1} \\in \\mathbb{R}^N$：\n$$\nr_g^{k+1} = K_d \\, \\epsilon_v^{k+1} - \\alpha \\, p^{k+1}.\n$$\n\n范数停止准则：\n- 使用欧几里得范数（即 $L_2$ 范数）定义归一化残差范数：\n$$\n\\|r_f^{k+1}\\|_{\\text{rel}} = \\frac{\\|r_f^{k+1}\\|_2}{\\left\\|\\frac{S}{\\Delta t} p^{k+1}\\right\\|_2 + \\|T L p^{k+1}\\|_2 + \\|q\\|_2 + \\varepsilon},\n$$\n$$\n\\|r_g^{k+1}\\|_{\\text{rel}} = \\frac{\\|r_g^{k+1}\\|_2}{\\max\\left(\\alpha \\|p^{k+1}\\|_2, K_d \\|\\epsilon_v^{k+1}\\|_2\\right) + \\varepsilon},\n$$\n其中 $\\varepsilon$ 是一个小的稳定化参数（例如，$\\varepsilon = 10^{-30}$）以避免除以零。同时定义相对更新量：\n$$\n\\delta_p^{k+1} = \\frac{\\|p^{k+1} - p^{k}\\|_2}{\\|p^{k+1}\\|_2 + \\varepsilon}, \\quad \\delta_{\\epsilon}^{k+1} = \\frac{\\|\\epsilon_v^{k+1} - \\epsilon_v^{k}\\|_2}{\\|\\epsilon_v^{k+1}\\|_2 + \\varepsilon}.\n$$\n- 停止条件：当满足以下条件时宣告收敛\n$$\n\\|r_f^{k+1}\\|_{\\text{rel}} \\le \\tau_f, \\quad \\|r_g^{k+1}\\|_{\\text{rel}} \\le \\tau_g, \\quad \\max\\left(\\delta_p^{k+1}, \\delta_{\\epsilon}^{k+1}\\right) \\le \\tau_u,\n$$\n其中 $\\tau_f$、$\\tau_g$ 和 $\\tau_u$ 是预设的容差。\n\n最终关注量：\n- 地表沉降是地表处综合垂直位移的负值。在此处使用的平面应变映射和零增量牵引力条件下，增量垂直位移等于体积应变的积分。因此，地表沉降 $s$ 可近似为\n$$\ns = - \\sum_{i=0}^{N-1} \\epsilon_{v,i}^{n+1} \\, \\Delta z,\n$$\n单位为米。\n\n单位与数据：\n- 使用 $p$ 单位为帕斯卡，$H$ 单位为米，$k$ 单位为平方米，$\\mu$ 单位为帕斯卡-秒，$K_d$ 单位为帕斯卡，$\\alpha$ 无量纲，$S$ 单位为帕斯卡的倒数（每帕斯卡），$\\Delta t$ 单位为秒，$q$ 单位为秒的倒数（每秒），$s$ 单位为米。\n- 将 $p^n$ 统一初始化为 $p^n_i = p_{\\text{init}}$ 并设置 $\\epsilon_v^n = \\frac{\\alpha}{K_d} p^n$。\n- 在 $z=0$ 和 $z=H$ 处使用无流动边界条件。\n\n测试套件：\n提供四组参数集以测试不同方面：\n1. 中等耦合，典型分辨率：\n   - $H = 1000$，$N = 50$，$k = 1.0 \\times 10^{-14}$，$\\mu = 1.0 \\times 10^{-3}$，$S = 1.0 \\times 10^{-9}$，$\\alpha = 0.8$，$K_d = 1.0 \\times 10^{10}$，$\\Delta t = 1.0 \\times 10^{5}$，$p_{\\text{init}} = 5.0 \\times 10^{7}$，除中心单元 $q_{\\text{center}} = -1.0 \\times 10^{-12}$ 外，$q$ 在各处均为零。\n2. 弱耦合：\n   - 与情况 1 相同，但 $\\alpha = 0.1$。\n3. 非常坚硬的岩石和粗糙分辨率：\n   - $H = 1000$，$N = 5$，$k = 1.0 \\times 10^{-14}$，$\\mu = 1.0 \\times 10^{-3}$，$S = 1.0 \\times 10^{-9}$，$\\alpha = 0.8$，$K_d = 5.0 \\times 10^{10}$，$\\Delta t = 1.0 \\times 10^{5}$，$p_{\\text{init}} = 5.0 \\times 10^{7}$，$q_{\\text{center}} = -1.0 \\times 10^{-12}$。\n4. 零耦合边缘情况：\n   - 与情况 1 相同，但 $\\alpha = 0.0$。\n\n算法要求：\n- 实现如上定义的带有外迭代的顺序算法。\n- 使用容差 $\\tau_f = 1.0 \\times 10^{-8}$，$\\tau_g = 1.0 \\times 10^{-12}$ 和 $\\tau_u = 1.0 \\times 10^{-10}$，以及最多 50 次外迭代。\n- 对于每个参数集，计算以米为单位的地表沉降 $s$，通过自然的浮点表示进行四舍五入，并汇总结果。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\right]$）。每个结果必须是相应测试用例计算出的地表沉降 $s$，单位为米。", "solution": "该问题要求实现一个顺序不动点迭代算法，以求解一个耦合的一维孔隙弹性问题的一个时间步长。最终目标是计算由此产生的地表沉降。解决方案的开发将首先对控制方程进行离散化，然后构建迭代算法，最后计算关注的量。\n\n### 1. 模型建立与离散化\n物理系统是一个高度为 $H$ 的一维柱体，离散为 $N$ 个尺寸为 $\\Delta z = H/N$ 的单元。状态变量是每个单元中心的孔隙压力 $p$ 和体积应变 $\\epsilon_v$。\n\n使用向后欧拉格式进行时间离散化的流体流动控制方程为：\n$$\nS \\frac{p^{n+1} - p^{n}}{\\Delta t} + \\alpha \\frac{\\epsilon_v^{n+1} - \\epsilon_v^{n}}{\\Delta t} - \\nabla \\cdot \\left(\\frac{k}{\\mu} \\nabla p^{n+1} \\right) = q\n$$\n空间扩散项使用有限体积法进行离散化，其结果是一个由矩阵 $T L$ 表示的线性算子，其中 $T = \\frac{k}{\\mu \\Delta z^2}$ 且 $L$ 是指定的离散拉普拉斯矩阵。这导出了单元 $i$ 的全离散代数系统：\n$$\nS \\frac{p_i^{n+1} - p_i^{n}}{\\Delta t} + \\alpha \\frac{\\epsilon_{v,i}^{n+1} - \\epsilon_{v,i}^{n}}{\\Delta t} - T (L p^{n+1})_i = q_i\n$$\n地质力学耦合由局部本构关系给出：\n$$\n\\epsilon_v^{n+1} = \\frac{\\alpha}{K_d} p^{n+1}\n$$\n\n### 2. 顺序迭代算法\n使用不动点迭代方案（具体来说是固定应变分裂法）来求解耦合系统。在从 $n$ 到 $n+1$ 的单个时间步内，我们执行由 $k$ 索引的外迭代。我们从新状态的初始猜测开始，通常是前一时间步的状态：$p^0 = p^n$ 和 $\\epsilon_v^0 = \\epsilon_v^n$。\n\n对于每次迭代 $k = 0, 1, 2, ...$：\n1.  **流动求解**：地质力学耦合项 $\\alpha \\frac{\\partial \\epsilon_v}{\\partial t}$ 使用前一次迭代的应变 $\\epsilon_v^k$ 进行显式处理。流动方程变为关于新压力迭代值 $p^{k+1}$ 的线性系统：\n    $$\n    S \\frac{p^{k+1} - p^n}{\\Delta t} - T L p^{k+1} = - \\alpha \\frac{\\epsilon_v^k - \\epsilon_v^n}{\\Delta t} + q\n    $$\n    重排为标准矩阵形式 $A\\mathbf{x} = \\mathbf{b}$：\n    $$\n    \\left( \\frac{S}{\\Delta t} I - T L \\right) p^{k+1} = \\frac{S}{\\Delta t} p^n + \\frac{\\alpha}{\\Delta t} (\\epsilon_v^k - \\epsilon_v^n) + q\n    $$\n    矩阵 $A = \\frac{S}{\\Delta t} I - T L$ 在整个迭代过程中是恒定的，因此可以只构建一次并为求解做准备（例如，通过 LU 分解，尽管对于中等大小的 $N$ 来说，在每一步直接求解也是可行的）。\n\n2.  **地质力学更新**：利用新的压力 $p^{k+1}$，根据本构定律更新应变：\n    $$\n    \\epsilon_v^{k+1} = \\frac{\\alpha}{K_d} p^{k+1}\n    $$\n\n重复此两步过程，直到连续迭代之间的变化和系统残差低于指定的容差。\n\n### 3. 收敛准则\n在每次迭代 $k$ 结束时（在地质力学更新之后），通过计算归一化残差和相对更新量来评估收敛性。\n\n- **地质力学残差**：$r_g^{k+1} = K_d \\epsilon_v^{k+1} - \\alpha p^{k+1}$。根据定义，地质力学更新步骤确保 $r_g^{k+1} = K_d (\\frac{\\alpha}{K_d} p^{k+1}) - \\alpha p^{k+1} = 0$。因此，其归一化范数 $\\|r_g^{k+1}\\|_{\\text{rel}}$ 始终为零，且条件 $\\|r_g^{k+1}\\|_{\\text{rel}} \\le \\tau_g$ 是平凡满足的。\n\n- **流动残差**：$r_f^{k+1} = \\frac{S}{\\Delta t} (p^{k+1} - p^{n}) + \\frac{\\alpha}{\\Delta t} (\\epsilon_v^{k+1} - \\epsilon_v^{n}) - T L p^{k+1} - q$。这衡量了全耦合单体系统中的不平衡性。通过注意到流动求解器找到 $p^{k+1}$ 使得 $\\frac{S}{\\Delta t} (p^{k+1} - p^{n}) + \\frac{\\alpha}{\\Delta t} (\\epsilon_v^{k} - \\epsilon_v^{n}) - T L p^{k+1} - q = 0$，可以推导出一个高效的计算方法。从残差定义中减去此项，得到一个简化形式：\n    $$\n    r_f^{k+1} = \\frac{\\alpha}{\\Delta t} (\\epsilon_v^{k+1} - \\epsilon_v^k)\n    $$\n    这表明流动残差是由应变更新驱动的。然后计算归一化范数 $\\|r_f^{k+1}\\|_{\\text{rel}}$ 并与容差 $\\tau_f$ 进行比较。\n\n- **相对更新量**：主变量的相对变化也受到监控：\n    $$\n    \\delta_p^{k+1} = \\frac{\\|p^{k+1} - p^{k}\\|_2}{\\|p^{k+1}\\|_2 + \\varepsilon}, \\quad \\delta_{\\epsilon}^{k+1} = \\frac{\\|\\epsilon_v^{k+1} - \\epsilon_v^{k}\\|_2}{\\|\\epsilon_v^{k+1}\\|_2 + \\varepsilon}\n    $$\n    收敛要求 $\\max(\\delta_p^{k+1}, \\delta_{\\epsilon}^{k+1}) \\le \\tau_u$。\n\n当所有准则同时满足或达到最大迭代次数后，循环终止。收敛时的解 $(p^k, \\epsilon_v^k)$ 被视为新时间步的状态 $(p^{n+1}, \\epsilon_v^{n+1})$。\n\n### 4. 地表沉降的计算\n收敛后，通过在柱高上对垂直应变分量进行积分来计算总地表沉降 $s$。对于假设的一维平面应变条件，这仅仅是单元体积应变之和乘以单元高度：\n$$\ns = - \\sum_{i=0}^{N-1} \\epsilon_{v,i}^{n+1} \\, \\Delta z\n$$\n负号约定压缩（负应变）导致正沉降。\n\n### 5. 实现策略\n实现一个 Python 函数来解决每个测试用例。\n- 它首先初始化所有物理和数值参数，包括网格属性（$\\Delta z$）和派生系数（$T$）。\n- 它构建常数系统矩阵 $L$ 和 $A = (\\frac{S}{\\Delta t}I - T L)$。\n- 它根据问题要求初始化时间 $n$ 的状态（$p^n$, $\\epsilon_v^n$）。\n- 它进入不动点迭代循环，将 `p_k` 和 `eps_v_k` 初始化为它们在时间 $n$ 的值。\n- 在循环内部，它计算右侧向量，使用 `numpy.linalg.solve` 求解 `p_kp1` 的线性系统，并更新 `eps_v_kp1`。\n- 然后，它计算残差和更新范数以检查收敛性。\n- 循环之后，它根据收敛的应变向量 `eps_v_n_plus_1` 计算最终沉降。\n- 一个主脚本为四个测试用例中的每一个调用此函数，并格式化输出。零耦合情况（$\\alpha=0.0$）作为一个重要的验证，因为它必须产生零沉降。", "answer": "[0.0039999981880474,0.000624999969694726,3.19999999929841e-06,0]", "id": "3513601"}]}