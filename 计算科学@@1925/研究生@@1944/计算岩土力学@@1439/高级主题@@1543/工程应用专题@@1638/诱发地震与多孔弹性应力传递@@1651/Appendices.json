{"hands_on_practices": [{"introduction": "本练习将介绍流体注入与诱发地震之间最直接的联系：由孔隙压力增加引起的库仑破裂应力（$\\Delta \\text{CFS}$）变化。我们将应用一个简化但功能强大的模型和叠加原理，来评估来自多个注入源的综合地震风险。这项实践为您提供了进行一级灾害筛选的基础计算工具。[@problem_id:3532803]", "problem": "一个均质、各向同性、线性的孔隙弹性地壳受到来自三口空间上分离的井的流体注入。在一个位于平面断层上的目标震源处，由每口井引起的孔隙压力扰动是时间的已知函数，记为 $\\Delta p_i(t)$，其中 $i \\in \\{1,2,3\\}$。假设扰动很小，且叠加原理适用。需要在震源处的断层面上计算库仑破裂应力（CFS）的变化，其定义为 $\\Delta \\mathrm{CFS}(t) = \\Delta \\tau(t) - \\mu' \\Delta \\sigma_n'(t)$，其中对于 $\\Delta \\sigma_n'(t)$，压应力为正。在此，$\\Delta \\tau(t)$ 是沿滑动方向的解析剪应力变化，$\\mu'$ 是有效摩擦系数，$\\Delta \\sigma_n'(t)$ 是断层面上的有效正应力变化。\n\n使用线性孔隙弹性理论的有效应力原理，$\\sigma'_{ij} = \\sigma_{ij} - \\alpha p \\delta_{ij}$，其中 $\\alpha$ 是 Biot 系数，$\\delta_{ij}$ 是克罗内克δ函数。在震源处孔隙压力扰动为各向同性且孔隙弹性剪应力产生可忽略的假设下，取 $\\Delta \\tau(t) \\approx 0$，且总应力扰动可忽略，因此断层面上的有效正应力变化由孔隙压力扰动控制，即 $\\Delta \\sigma_n'(t) = - \\alpha \\Delta p(t)$，其中 $\\Delta p(t) = \\sum_{i=1}^{3} \\Delta p_i(t)$。\n\n三口井在震源处产生如下的孔隙压力历史（时间 $t$ 单位为天，压力单位为兆帕，指数的参数是无量纲的）：\n- $\\Delta p_1(t) = 0.4 \\,\\text{MPa} \\left(1 - \\exp\\!\\left(-\\frac{t}{100 \\,\\text{d}}\\right)\\right)$,\n- $\\Delta p_2(t) = 0.25 \\,\\text{MPa} \\,\\exp\\!\\left(-\\frac{t}{200 \\,\\text{d}}\\right)$,\n- $\\Delta p_3(t) = 0.6 \\,\\text{MPa} \\,\\exp\\!\\left(-\\frac{\\left(t - 300 \\,\\text{d}\\right)^{2}}{2 \\left(50 \\,\\text{d}\\right)^{2}}\\right)$.\n\n给定 $\\alpha = 0.8$，$\\mu' = 0.6$，以及触发阈值 $\\Delta \\mathrm{CFS}_c = 0.05 \\,\\text{MPa}$，计算在 $t^* = 365 \\,\\text{d}$ 时的累积 $\\Delta \\mathrm{CFS}(t^*)$，并通过报告比率 $R = \\Delta \\mathrm{CFS}(t^*) / \\Delta \\mathrm{CFS}_c$ 来评估其是否超过 $\\Delta \\mathrm{CFS}_c$。将最终的比率 $R$ 四舍五入到四位有效数字。$\\Delta \\mathrm{CFS}$ 的中间值以兆帕（MPa）表示，但最终比率 $R$ 必须是无量纲的。", "solution": "推导从线性孔隙弹性理论和有效应力原理开始。有效应力张量由 $\\sigma'_{ij} = \\sigma_{ij} - \\alpha p \\delta_{ij}$ 给出，其中 $\\alpha$ 是 Biot 系数，p 是孔隙压力。对于小扰动，其变化满足 $\\Delta \\sigma'_{ij} = \\Delta \\sigma_{ij} - \\alpha \\Delta p \\delta_{ij}$。在震源处的总应力扰动可忽略的假设下，$\\Delta \\sigma_{ij} \\approx 0$，有效应力变化简化为 $\\Delta \\sigma'_{ij} \\approx - \\alpha \\Delta p \\delta_{ij}$。投影到单位法向量为 $n_i$ 的断层法线上，断层面上的有效正应力变化为\n$$\n\\Delta \\sigma_n'(t) = n_i \\Delta \\sigma'_{ij} n_j = - \\alpha \\Delta p(t),\n$$\n其中 $\\Delta p(t)$ 是震源处的累积孔隙压力变化。\n\n库仑破裂应力（CFS）的变化定义为\n$$\n\\Delta \\mathrm{CFS}(t) = \\Delta \\tau(t) - \\mu' \\Delta \\sigma_n'(t),\n$$\n其中对于 $\\Delta \\sigma_n'(t)$，压应力为正。在所述的震源处孔隙弹性剪应力产生可忽略的假设下，$\\Delta \\tau(t) \\approx 0$，因此\n$$\n\\Delta \\mathrm{CFS}(t) \\approx - \\mu' \\Delta \\sigma_n'(t) = - \\mu' \\left(- \\alpha \\Delta p(t)\\right) = \\mu' \\alpha \\,\\Delta p(t).\n$$\n由于系统是线性的且叠加原理适用，累积孔隙压力变化是每口井贡献的总和：\n$$\n\\Delta p(t) = \\sum_{i=1}^{3} \\Delta p_i(t).\n$$\n因此，\n$$\n\\Delta \\mathrm{CFS}(t) = \\mu' \\alpha \\sum_{i=1}^{3} \\Delta p_i(t).\n$$\n\n我们现在计算 $t^* = 365 \\,\\text{d}$ 时的值。计算每个 $\\Delta p_i(t^*)$：\n\n1. 对于第一口井，\n$$\n\\Delta p_1(365) = 0.4 \\left(1 - \\exp\\!\\left(-\\frac{365}{100}\\right)\\right) = 0.4 \\left(1 - \\exp(-3.65)\\right).\n$$\n计算 $\\exp(-3.65) \\approx 0.0259911$，因此\n$$\n\\Delta p_1(365) \\approx 0.4 \\times (1 - 0.0259911) = 0.4 \\times 0.9740089 = 0.3896036 \\,\\text{MPa}.\n$$\n\n2. 对于第二口井，\n$$\n\\Delta p_2(365) = 0.25 \\,\\exp\\!\\left(-\\frac{365}{200}\\right) = 0.25 \\,\\exp(-1.825).\n$$\n计算 $\\exp(-1.825) \\approx 0.161218$，因此\n$$\n\\Delta p_2(365) \\approx 0.25 \\times 0.161218 = 0.0403045 \\,\\text{MPa}.\n$$\n\n3. 对于第三口井，\n$$\n\\Delta p_3(365) = 0.6 \\,\\exp\\!\\left(-\\frac{(365 - 300)^{2}}{2 \\times 50^{2}}\\right) = 0.6 \\,\\exp\\!\\left(-\\frac{65^{2}}{2 \\times 50^{2}}\\right) = 0.6 \\,\\exp\\!\\left(-\\frac{4225}{5000}\\right) = 0.6 \\,\\exp(-0.845).\n$$\n计算 $\\exp(-0.845) \\approx 0.429564$，因此\n$$\n\\Delta p_3(365) \\approx 0.6 \\times 0.429564 = 0.2577384 \\,\\text{MPa}.\n$$\n\n将孔隙压力变化相加：\n$$\n\\Delta p(365) = \\Delta p_1(365) + \\Delta p_2(365) + \\Delta p_3(365) \\approx 0.3896036 + 0.0403045 + 0.2577384 = 0.6876465 \\,\\text{MPa}.\n$$\n\n使用 $\\mu' = 0.6$ 和 $\\alpha = 0.8$ 计算累积库仑破裂应力变化：\n$$\n\\Delta \\mathrm{CFS}(365) = \\mu' \\alpha \\,\\Delta p(365) = 0.6 \\times 0.8 \\times 0.6876465 = 0.3300703 \\,\\text{MPa}.\n$$\n\n计算与阈值 $\\Delta \\mathrm{CFS}_c = 0.05 \\,\\text{MPa}$ 的比率：\n$$\nR = \\frac{\\Delta \\mathrm{CFS}(365)}{\\Delta \\mathrm{CFS}_c} = \\frac{0.3300703}{0.05} = 6.601406.\n$$\n\n四舍五入到四位有效数字，该比率为 $R \\approx 6.601$。由于 $R > 1$，累积的 $\\Delta \\mathrm{CFS}(t^*)$ 超过了触发阈值 $\\Delta \\mathrm{CFS}_c$。", "answer": "$$\\boxed{6.601}$$", "id": "3532803"}, {"introduction": "虽然直接的孔隙压力效应至关重要，但这并非故事的全貌。本练习将通过推导在真实地质约束下由孔隙压力变化产生的完整孔隙弹性应力张量，来更深入地探讨这一问题。通过将完整解与前一练习中的简化标量模型进行比较，您将学会量化模型误差，并理解何时必须进行更复杂的张量分析。[@problem_id:3532842]", "problem": "考虑一个均匀、各向同性、线性的孔隙弹性固体，其特征为 Biot 系数 $\\alpha$ 和弹性 Lamé 参数 $\\lambda$ 与 $G$。在准静态、小应变条件下，总 Cauchy 应力张量 $\\boldsymbol{\\sigma}$（以拉伸为正）遵循线性 Biot 本构定律\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I} \\;+\\; 2G\\,\\boldsymbol{\\varepsilon} \\;-\\; \\alpha\\,p\\,\\mathbf{I},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是无穷小应变张量，$p$ 是孔隙压力，$\\mathbf{I}$ 是二阶单位张量。Lamé 参数通过 $G = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{2G\\nu}{1-2\\nu}$ 与杨氏模量 $E$ 和泊松比 $\\nu$ 相关。Biot 有效应力为 $\\boldsymbol{\\sigma}'=\\boldsymbol{\\sigma}+\\alpha p \\mathbf{I}$。\n\n施加一个均匀的孔隙压力增量 $\\Delta p$。假设一个理想化的约束，代表平面外方向的平面应变，其中平面外应变为零，即 $\\varepsilon_{yy}=0$，并将面内方向取为 $x$ 和 $z$ 方向，其中 $\\varepsilon_{xx}=0$（侧向约束），竖直方向上的牵引力为零，即 $\\Delta\\sigma_{zz}=0$。在这些均匀约束下，孔隙压力增量通过本构定律中的耦合作用，引起一个均匀的弹性应力变化 $\\Delta\\boldsymbol{\\sigma}$。\n\n对于一个具有单位法向量 $\\mathbf{n}$ 和面内单位滑移方向 $\\mathbf{s}$（其中 $\\mathbf{s}\\cdot\\mathbf{n}=0$）的断层面，库仑破裂应力（CFS）的变化定义为（以拉伸为正）\n$$\n\\Delta CFS \\;=\\; \\Delta \\tau \\;-\\; \\mu\\,\\Delta \\sigma_n',\n$$\n其中 $\\mu$ 是摩擦系数，$\\Delta \\tau = \\mathbf{s}^\\top \\Delta\\boldsymbol{t}$ 是滑移方向上的解析剪切牵引力变化，$\\Delta \\sigma_n'=\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}' \\mathbf{n}$ 是作用在平面上的有效法向应力变化，$\\Delta\\boldsymbol{t}=\\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$ 是牵引力变化矢量。使用有效应力的定义，可得 $\\Delta \\sigma_n' = \\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} + \\alpha \\Delta p$。\n\n在常用的标量孔隙弹性近似中，弹性应力传递被忽略，仅保留孔隙压力对有效法向应力的直接影响，因此\n$$\n\\Delta CFS_{\\mathrm{scalar}} \\;=\\; -\\,\\mu\\,\\alpha\\,\\Delta p.\n$$\n相比之下，在所述约束下的完整张量解保留了弹性应力传递项，得到\n$$\n\\Delta CFS_{\\mathrm{full}} \\;=\\; \\underbrace{\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}}_{\\Delta \\tau_{\\mathrm{elastic}}} \\;-\\; \\mu\\left(\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} + \\alpha \\Delta p\\right).\n$$\n\n您的任务是：\n\n- 从线性 Biot 本构定律、给定的运动学约束 $\\varepsilon_{xx}=0$、$\\varepsilon_{yy}=0$ 以及牵引力条件 $\\Delta\\sigma_{zz}=0$ 出发，推导由均匀孔隙压力增量 $\\Delta p$ 引起的均匀应力增量张量 $\\Delta\\boldsymbol{\\sigma}$，用材料参数和 $\\Delta p$ 表示。用泊松比 $\\nu$ 和 Biot 系数 $\\alpha$ 表达您的结果，并确定一个材料对比因子 $r(\\nu)$，该因子在 $\\Delta\\boldsymbol{\\sigma}$ 的非零分量中乘以 $\\alpha\\,\\Delta p$。您不能假设任何预先制定的孔隙弹性系数；必须从所述的基本原理推导它们。\n\n- 特别针对法向量位于 $x$–$z$ 平面内的断层面进行分析，其法向量由从 $x$ 轴测量的角度 $\\theta$ 参数化，使得 $\\mathbf{n} = [\\cos\\theta,\\,0,\\,\\sin\\theta]^\\top$，并选择面内单位滑移方向为 $\\mathbf{s}=[-\\sin\\theta,\\,0,\\,\\cos\\theta]^\\top$。\n\n- 计算库仑破裂应力变化的绝对建模误差，\n$$\n\\varepsilon_{\\mathrm{CFS}} \\;=\\; \\left|\\Delta CFS_{\\mathrm{full}} \\;-\\; \\Delta CFS_{\\mathrm{scalar}}\\right| \\;=\\; \\left|\\,\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} \\;-\\; \\mu\\,\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}\\,\\right|.\n$$\n\n- 证明并实现一个形式为\n$$\n\\varepsilon_{\\mathrm{CFS}} \\;\\le\\; \\left| \\alpha\\,\\Delta p \\right|\\,r(\\nu)\\,c(\\mu)\n$$\n的紧密的、与方向无关的上界，其中 $r(\\nu)$ 是一个仅依赖于 $\\nu$ 的材料对比率，源于您的张量解；而 $c(\\mu)$ 是一个仅依赖于 $\\mu$ 的函数，您必须通过求解从牵引力解析得出的三角表达式对所有 $\\theta$ 的上确界来获得。您的 $c(\\mu)$ 对于所述类别的张量和方向必须是精确的。\n\n- 实现一个程序，对于下面的每个测试用例，计算绝对误差 $\\varepsilon_{\\mathrm{CFS}}$ 和上界 $\\left| \\alpha\\,\\Delta p \\right|\\,r(\\nu)\\,c(\\mu)$，并返回一个布尔值，指示该不等式是否成立（在帕斯卡单位下，数值公差为 $10^{-12}$）。所有应力必须以帕斯卡（Pa）表示。所有角度以度为单位提供，必须在内部通过 $\\theta_{\\mathrm{rad}} = \\pi\\,\\theta_{\\mathrm{deg}}/180$ 转换为弧度。\n\n测试集（每个元组为 $(\\Delta p\\ \\mathrm{[Pa]},\\,\\alpha,\\,\\nu,\\,\\mu,\\,\\theta\\ \\mathrm{[deg]})$）：\n\n- 用例 A（典型参数）：$(\\,1.0\\times 10^{6},\\;0.8,\\;0.25,\\;0.6,\\;30\\,)$\n- 用例 B（近乎不可压缩）：$(\\,5.0\\times 10^{6},\\;1.0,\\;0.49,\\;0.6,\\;45\\,)$\n- 用例 C（低泊松比，高摩擦系数）：$(\\,2.0\\times 10^{6},\\;0.9,\\;0.15,\\;1.2,\\;75\\,)$\n- 用例 D（中等泊松比，无摩擦）：$(\\,3.0\\times 10^{5},\\;0.7,\\;1/3,\\;0.0,\\;15\\,)$\n- 用例 E（耗竭，负孔隙压力变化）：$(\\,-1.5\\times 10^{6},\\;0.85,\\;0.30,\\;0.5,\\;60\\,)$\n- 用例 F（接近小摩擦系数下最差情况的方向）：$(\\,4.0\\times 10^{6},\\;1.0,\\;0.20,\\;0.2,\\;39.345\\,)$\n\n您的程序应生成单行输出，其中包含一个逗号分隔的 Python 布尔值列表，并用方括号括起来（例如，`[{\\rm True},{\\rm False},\\dots]`），其顺序与测试用例相同。", "solution": "目标是推导出一个与方向无关的上界，用于衡量孔隙弹性应力传递效应对断层稳定性的标量近似所产生的建模误差，并对此上界进行数值验证。推导过程分三步：1) 在给定约束下，确定孔隙弹性应力变化张量 $\\Delta\\boldsymbol{\\sigma}$；2) 计算作为断层方向函数的精确建模误差 $\\varepsilon_{\\mathrm{CFS}}$；3) 通过最大化其与方向相关的部分，找到此误差的紧密上界。\n\n首先，我们推导由均匀孔隙压力变化 $\\Delta p$ 引起的应力变化张量 $\\Delta\\boldsymbol{\\sigma}$。线性 Biot 本构定律为：\n$$\n\\Delta\\boldsymbol{\\sigma} \\;=\\; \\lambda \\,\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon})\\,\\mathbf{I} \\;+\\; 2G\\,\\Delta\\boldsymbol{\\varepsilon} \\;-\\; \\alpha\\,\\Delta p\\,\\mathbf{I}\n$$\n其中 $\\Delta\\boldsymbol{\\sigma}$ 是总应力张量的变化，$\\Delta\\boldsymbol{\\varepsilon}$ 是无穷小应变张量的变化，$\\lambda$ 和 $G$ 是 Lamé 参数，$\\alpha$ 是 Biot 系数，$\\Delta p$ 是孔隙压力变化，$\\mathbf{I}$ 是单位张量。问题假设均匀条件，因此我们可以忽略剪切应变和应力，这意味着 $\\Delta\\boldsymbol{\\sigma}$ 和 $\\Delta\\boldsymbol{\\varepsilon}$ 是对角张量。给定的约束是 $x$ 和 $y$ 方向上无应变，以及 $z$ 方向上无应力变化：\n$$\n\\Delta\\varepsilon_{xx} = 0, \\quad \\Delta\\varepsilon_{yy} = 0, \\quad \\Delta\\sigma_{zz} = 0\n$$\n本构定律的对角分量为：\n$$\n\\Delta\\sigma_{ii} = \\lambda(\\Delta\\varepsilon_{xx}+\\Delta\\varepsilon_{yy}+\\Delta\\varepsilon_{zz}) + 2G\\Delta\\varepsilon_{ii} - \\alpha\\Delta p\n$$\n应用应变约束 $\\Delta\\varepsilon_{xx}=0$ 和 $\\Delta\\varepsilon_{yy}=0$，方程简化为：\n$$\n\\Delta\\sigma_{xx} = \\lambda\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (1)\n$$\n$$\n\\Delta\\sigma_{yy} = \\lambda\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (2)\n$$\n$$\n\\Delta\\sigma_{zz} = (\\lambda+2G)\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (3)\n$$\n在方程 ($3$) 中使用应力约束 $\\Delta\\sigma_{zz}=0$，我们解出未知的竖直应变变化 $\\Delta\\varepsilon_{zz}$：\n$$\n0 = (\\lambda+2G)\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad \\implies \\quad \\Delta\\varepsilon_{zz} = \\frac{\\alpha\\Delta p}{\\lambda+2G}\n$$\n将此结果代回方程 ($1$) 和 ($2$)，得到水平应力变化：\n$$\n\\Delta\\sigma_{xx} = \\Delta\\sigma_{yy} = \\lambda\\left(\\frac{\\alpha\\Delta p}{\\lambda+2G}\\right) - \\alpha\\Delta p = \\left(\\frac{\\lambda}{\\lambda+2G} - 1\\right)\\alpha\\Delta p = -\\frac{2G}{\\lambda+2G}\\alpha\\Delta p\n$$\n为了用泊松比 $\\nu$ 来表示这个结果，我们使用关系式 $\\lambda = \\frac{2G\\nu}{1-2\\nu}$。分母变为 $\\lambda+2G = \\frac{2G\\nu}{1-2\\nu} + 2G = 2G\\left(\\frac{\\nu}{1-2\\nu}+1\\right) = 2G\\frac{1-\\nu}{1-2\\nu}$。因此，该比值为：\n$$\n\\frac{2G}{\\lambda+2G} = \\frac{2G}{2G\\frac{1-\\nu}{1-2\\nu}} = \\frac{1-2\\nu}{1-\\nu}\n$$\n问题将此材料对比因子定义为 $r(\\nu)$。因此，$r(\\nu) = \\frac{1-2\\nu}{1-\\nu}$。非零应力变化为 $\\Delta\\sigma_{xx} = \\Delta\\sigma_{yy} = -r(\\nu)\\alpha\\Delta p$。完整的应力变化张量为：\n$$\n\\Delta\\boldsymbol{\\sigma} = \\begin{pmatrix} -r(\\nu)\\alpha\\Delta p & 0 & 0 \\\\ 0 & -r(\\nu)\\alpha\\Delta p & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\n其次，我们计算绝对建模误差 $\\varepsilon_{\\mathrm{CFS}} = \\left|\\,\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} \\;-\\; \\mu\\,\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}\\,\\right|$。断层法向量和滑移矢量为 $\\mathbf{n} = [\\cos\\theta, 0, \\sin\\theta]^\\top$ 和 $\\mathbf{s} = [-\\sin\\theta, 0, \\cos\\theta]^\\top$。为简洁起见，令 $C = -r(\\nu)\\alpha\\Delta p$。\n牵引力变化项为 $\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$：\n$$\n\\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} C & 0 & 0 \\\\ 0 & C & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ 0 \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} -\\sin\\theta & 0 & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix} = -C\\sin\\theta\\cos\\theta = r(\\nu)\\alpha\\Delta p \\sin\\theta\\cos\\theta\n$$\n法向应力变化项为 $\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$：\n$$\n\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} \\cos\\theta & 0 & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix} = C\\cos^2\\theta = -r(\\nu)\\alpha\\Delta p \\cos^2\\theta\n$$\n将这些项组合到 $\\varepsilon_{\\mathrm{CFS}}$ 的表达式中：\n$$\n\\varepsilon_{\\mathrm{CFS}} = \\left| r(\\nu)\\alpha\\Delta p \\sin\\theta\\cos\\theta - \\mu(-r(\\nu)\\alpha\\Delta p \\cos^2\\theta) \\right| = \\left| r(\\nu)\\alpha\\Delta p (\\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta) \\right|\n$$\n由于 $\\alpha \\ge 0$ 且对于典型的材料属性（$0 \\le \\nu < 0.5$），$r(\\nu) = \\frac{1-2\\nu}{1-\\nu} \\ge 0$，因此表达式简化为：\n$$\n\\varepsilon_{\\mathrm{CFS}} = |\\alpha\\Delta p| r(\\nu) \\left| \\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta \\right|\n$$\n\n第三，我们通过找到三角项的上确界来推导与方向无关的上界。令 $f(\\theta) = \\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta$。我们想找到 $c(\\mu) = \\sup_{\\theta} |f(\\theta)|$。使用倍角公式 $\\sin\\theta\\cos\\theta = \\frac{1}{2}\\sin(2\\theta)$ 和 $\\cos^2\\theta = \\frac{1+\\cos(2\\theta)}{2}$：\n$$\nf(\\theta) = \\frac{1}{2}\\sin(2\\theta) + \\mu\\frac{1+\\cos(2\\theta)}{2} = \\frac{1}{2}\\left( \\sin(2\\theta) + \\mu\\cos(2\\theta) + \\mu \\right)\n$$\n项 $\\sin(2\\theta) + \\mu\\cos(2\\theta)$ 可以表示为谐波形式 $A\\cos(2\\theta-\\phi)$，其中振幅为 $A = \\sqrt{1^2+\\mu^2}$。因此，$f(\\theta)$ 变为：\n$$\nf(\\theta) = \\frac{1}{2}\\left( \\sqrt{1+\\mu^2}\\cos(2\\theta-\\phi) + \\mu \\right)\n$$\n因此，$f(\\theta)$ 的值受其极值限制，极值在 $\\cos(2\\theta-\\phi)=\\pm 1$ 时出现：\n$$\nf_{\\max} = \\frac{1}{2}(\\sqrt{1+\\mu^2} + \\mu), \\quad f_{\\min} = \\frac{1}{2}(-\\sqrt{1+\\mu^2} + \\mu)\n$$\n我们需要找到它们绝对值的最大值。对于非负摩擦系数 $\\mu \\ge 0$，我们有 $\\sqrt{1+\\mu^2} \\ge \\mu$。由此可知 $f_{\\max} > 0$ 且 $f_{\\min} \\le 0$。比较大小可得 $|f_{\\max}| = \\frac{1}{2}(\\mu+\\sqrt{1+\\mu^2})$ 和 $|f_{\\min}| = \\frac{1}{2}(\\sqrt{1+\\mu^2}-\\mu)$。显然， $|f_{\\max}| \\ge |f_{\\min}|$。\n因此，上确界为 $c(\\mu) = |f_{\\max}| = \\frac{1}{2}\\left(\\mu + \\sqrt{1+\\mu^2}\\right)$。\n\n最终的、紧密的、与方向无关的上界为：\n$$\n\\varepsilon_{\\mathrm{CFS}} \\le |\\alpha\\Delta p| r(\\nu) c(\\mu) = |\\alpha\\Delta p| \\left(\\frac{1-2\\nu}{1-\\nu}\\right) \\frac{1}{2}\\left(\\mu + \\sqrt{1+\\mu^2}\\right)\n$$\n以下代码实现了这个不等式，以验证其对给定测试用例的有效性。该代码计算了精确误差 $\\varepsilon_{\\mathrm{CFS}}$ 和其上界，然后检查不等式是否在 $10^{-12}$ Pa 的数值公差下成立。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic stress modeling error problem.\n\n    For a set of geomechanical scenarios, this function calculates the absolute error\n    between a full tensorial and a simplified scalar model for Coulomb Failure\n    Stress (CFS) change due to a pore pressure increment. It also calculates a\n    derived tight, orientation-independent upper bound for this error and verifies\n    that the error does not exceed the bound.\n    \"\"\"\n    \n    # Test suite: (delta_p [Pa], alpha, nu, mu, theta [deg])\n    test_cases = [\n        (1.0e6, 0.8, 0.25, 0.6, 30.0),      # Case A\n        (5.0e6, 1.0, 0.49, 0.6, 45.0),      # Case B\n        (2.0e6, 0.9, 0.15, 1.2, 75.0),      # Case C\n        (3.0e5, 0.7, 1/3, 0.0, 15.0),       # Case D\n        (-1.5e6, 0.85, 0.3, 0.5, 60.0),     # Case E\n        (4.0e6, 1.0, 0.2, 0.2, 39.345),     # Case F\n    ]\n\n    results = []\n    # Numerical tolerance in Pascals, as specified in the problem.\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        delta_p, alpha, nu, mu, theta_deg = case\n\n        # Convert fault orientation angle from degrees to radians\n        theta_rad = np.pi * theta_deg / 180.0\n\n        # Calculate the material-contrast factor r(nu)\n        # This factor arises from the poro-thermo-elastic analogy under plane strain constraints\n        # r(nu) = (1 - 2*nu) / (1 - nu)\n        if nu == 1.0:\n            # Physical limit for nu is < 0.5 for isotropic materials.\n            # nu=1 would cause a division by zero.\n            # The limit as nu -> 0.5 is 0, which correctly represents an incompressible solid.\n            r_nu = 0.0\n        else:\n            r_nu = (1.0 - 2.0 * nu) / (1.0 - nu)\n\n        # Calculate the absolute modeling error in Coulomb Failure Stress, eps_CFS.\n        # eps_CFS = | alpha * delta_p * r_nu * (sin(theta)cos(theta) + mu*cos^2(theta)) |\n        cos_theta = np.cos(theta_rad)\n        sin_theta = np.sin(theta_rad)\n        \n        trig_term = sin_theta * cos_theta + mu * cos_theta**2\n        \n        eps_CFS = np.abs(alpha * delta_p * r_nu * trig_term)\n\n        # Calculate the orientation-independent bounding function c(mu).\n        # c(mu) is the supremum of |sin(theta)cos(theta) + mu*cos^2(theta)| over all theta.\n        # c(mu) = (mu + sqrt(1 + mu^2)) / 2\n        c_mu = 0.5 * (mu + np.sqrt(1.0 + mu**2))\n\n        # Calculate the tight, orientation-independent upper bound for the error.\n        # Bound = |alpha * delta_p| * r(nu) * c(mu)\n        bound = np.abs(alpha * delta_p) * r_nu * c_mu\n\n        # Verify that the calculated error is less than or equal to the derived bound,\n        # with the specified numerical tolerance.\n        is_valid = eps_CFS <= bound + TOLERANCE\n        results.append(is_valid)\n\n    # Convert boolean results to lowercase strings for printing\n    # in compliance with Python's default string representation of booleans.\n    # e.g., True -> \"True\"\n    # This step is implicitly handled by map(str, ...).\n    \n    # Final print statement in the exact required format: [True,True,False,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3532842"}, {"introduction": "孔隙弹性效应不仅会改变应力的大小，还可能使主应力轴发生旋转，从而可能激活先前稳定的断层。本练习模拟了一个真实的油气藏枯竭情景，您将计算不断演化的应力场，追踪主应力旋转，并对预先存在的断层系统进行稳定性分析。这项实践突显了在长期风险评估中分析完整应力路径的重要性。[@problem_id:3532835]", "problem": "考虑一个经历枯竭的多孔弹性储层的二维平面应变切片。设远场初始有效主应力与笛卡尔坐标轴对齐，$x$轴承载最大有效主应力，$y$轴承载最小有效主应力。将初始有效主应力表示为$\\sigma_1$和$\\sigma_2$，单位为兆帕（MPa）的正数，并假设采用压缩为正的岩土力学符号约定。\n\n储层枯竭会产生一个压实盆和多孔弹性应力传递。将枯竭引起的孔隙压力下降模拟为一个随时间变化的函数\n$$\n\\Delta p(t) = \\Delta p_{\\max}\\left(1 - e^{-t/t_c}\\right),\n$$\n其中$\\Delta p_{\\max}$是最大孔隙压力降（MPa），$t$是时间（年），$t_c$是特征枯竭时间（年）。在水平面上，用极坐标$(r,\\theta)$将轴对称压实诱导的有效应力扰动近似为\n$$\n\\Delta \\sigma_r(r,t) = c_r \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2},\\quad\n\\Delta \\sigma_\\theta(r,t) = c_\\theta \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2},\n$$\n其中$a$是一个捕捉压实盆半径的长度尺度（千米），$r$是从压实中心起的径向距离（千米），$\\theta$是从$x$轴测量的极角（度），$c_r,c_\\theta$是代表径向和环向之间多孔弹性应力传递各向异性的无量纲系数。\n\n将这些扰动转换为笛卡尔分量，以获得在时间$t$的总有效应力张量，\n$$\n\\boldsymbol{\\sigma}(t) = \n\\begin{bmatrix}\n\\sigma_{xx}(t) & \\sigma_{xy}(t) \\\\\n\\sigma_{xy}(t) & \\sigma_{yy}(t)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\sigma_1 & 0\\\\\n0 & \\sigma_2\n\\end{bmatrix}\n+\n\\begin{bmatrix}\n\\Delta \\sigma_{xx}(t) & \\Delta \\sigma_{xy}(t) \\\\\n\\Delta \\sigma_{xy}(t) & \\Delta \\sigma_{yy}(t)\n\\end{bmatrix},\n$$\n其中扰动分量是通过将$\\Delta \\sigma_r$和$\\Delta \\sigma_\\theta$从极坐标转换到笛卡尔坐标得到的。\n\n您的任务是：\n- 推导主应力旋转$\\Delta \\phi(t)$，定义为初始最大主应力方向（$x$轴）与$\\boldsymbol{\\sigma}(t)$的瞬时最大主应力方向之间的夹角（度）。\n- 在指定的最终时间$t_{\\mathrm{end}}$，评估哪些具有指定方向（从$x$轴测量的角度，单位为度）的已有断层族在旋转和扰动后的应力状态下会穿过摩擦破坏包络线。假设黏聚力为零，并采用莫尔-库仑型摩擦破坏准则：当平面上分解的剪应力大小$\\tau$大于或等于$\\mu\\,\\sigma_n$时，发生破坏。其中$\\mu$是摩擦系数（无量纲），$\\sigma_n$是平面上的压缩有效正应力（MPa），$\\tau$是该平面上的剪应力大小（MPa）。\n\n您必须实现一个完整的程序，该程序：\n1. 使用线性弹性力学和应力变换的基本定律，根据给定的极坐标扰动和初始应力状态计算笛卡尔应力分量。\n2. 计算最终主应力旋转$\\Delta \\phi(t_{\\mathrm{end}})$（度）。\n3. 分解每个指定断层方向上的面力，并计算有效正应力$\\sigma_n$和剪应力大小$\\tau$。\n4. 对每个断层族确定一个布尔结果，指示在$t_{\\mathrm{end}}$时是否满足$\\tau \\ge \\mu\\,\\sigma_n$。\n\n使用以下参数值的测试套件。每个测试用例都是独立的，包括参数$(\\sigma_1,\\sigma_2,a,r,\\theta,c_r,c_\\theta,\\Delta p_{\\max},t_c,t_{\\mathrm{end}},\\mu,\\text{fault\\_angles})$，其单位和含义如上定义：\n- 测试用例1（一般情况，中等各向异性，正常路径）：\n    - $\\sigma_1 = 40$ MPa, $\\sigma_2 = 30$ MPa, $a = 1.0$ km, $r = 1.0$ km, $\\theta = 45$ 度,\n    - $c_r = 1.0$, $c_\\theta = 0.6$, $\\Delta p_{\\max} = 8$ MPa, $t_c = 0.4$ 年, $t_{\\mathrm{end}} = 1.0$ 年,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [20,35,60]$ 度。\n- 测试用例2（强各向异性，近临界，低摩擦以测试破坏穿越）：\n    - $\\sigma_1 = 35$ MPa, $\\sigma_2 = 34$ MPa, $a = 2.0$ km, $r = 1.0$ km, $\\theta = 30$ 度,\n    - $c_r = 1.5$, $c_\\theta = 0.1$, $\\Delta p_{\\max} = 15$ MPa, $t_c = 0.2$ 年, $t_{\\mathrm{end}} = 1.0$ 年,\n    - $\\mu = 0.15$, $\\text{fault\\_angles} = [30,60,75]$ 度。\n- 测试用例3（远场点，扰动可忽略的边界情况）：\n    - $\\sigma_1 = 45$ MPa, $\\sigma_2 = 35$ MPa, $a = 1.0$ km, $r = 10.0$ km, $\\theta = 30$ 度,\n    - $c_r = 1.0$, $c_\\theta = 0.7$, $\\Delta p_{\\max} = 5$ MPa, $t_c = 0.5$ 年, $t_{\\mathrm{end}} = 1.0$ 年,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [30,60]$ 度。\n- 测试用例4（各向同性扰动，不产生主应力旋转的边缘情况）：\n    - $\\sigma_1 = 50$ MPa, $\\sigma_2 = 20$ MPa, $a = 1.5$ km, $r = 0.7$ km, $\\theta = 75$ 度,\n    - $c_r = 0.9$, $c_\\theta = 0.9$, $\\Delta p_{\\max} = 12$ MPa, $t_c = 0.3$ 年, $t_{\\mathrm{end}} = 1.0$ 年,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [45,60,90]$ 度。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，并且本身是一个双元素列表。第一个元素是最终主应力旋转$\\Delta \\phi(t_{\\mathrm{end}})$（度），四舍五入到三位小数。第二个元素是一个布尔值列表，为每个列出的断层族指示其在$t_{\\mathrm{end}}$时是否穿过摩擦破坏包络线。例如：\"[[rotation1,[bool1,bool2,...]],[rotation2,[...]],...]\"。", "solution": "该问题要求对经历枯竭的多孔弹性介质中的应力状态进行多步分析。我们必须首先确定最终时间$t_{\\mathrm{end}}$的应力状态，然后评估已有断层的稳定性。该解决方案遵循连续介质力学中关于应力变换和破坏分析的原理进行开发。\n\n**步骤1：随时间变化的孔隙压力变化**\n枯竭过程通过孔隙压力的随时间下降$\\Delta p(t)$来建模。问题提供了其函数形式：\n$$\n\\Delta p(t) = \\Delta p_{\\max}\\left(1 - e^{-t/t_c}\\right)\n$$\n这里，$\\Delta p_{\\max}$是最大可能压力降（兆帕，MPa），$t$是时间（年），$t_c$是特征时间常数（年）。对于每个测试用例，我们首先在指定的最终时间$t = t_{\\mathrm{end}}$评估此函数，以找出已经发生的总孔隙压力变化$\\Delta p(t_{\\mathrm{end}})$。\n\n**步骤2：多孔弹性应力扰动**\n孔隙压力下降会引起有效应力状态的变化。问题为这些应力扰动提供了一个在极坐标系$(r,\\theta)$下的简化模型。径向应力变化$\\Delta \\sigma_r$和环向（切向）应力变化$\\Delta \\sigma_\\theta$由下式给出：\n$$\n\\Delta \\sigma_r(r,t) = c_r \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2}\n$$\n$$\n\\Delta \\sigma_\\theta(r,t) = c_\\theta \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2}\n$$\n其中$a$是压实盆的特征半径（千米），$r$是距中心的径向距离（千米），$c_r$和$c_\\theta$是无量纲的各向异性系数。我们使用先前计算的$\\Delta p(t_{\\mathrm{end}})$在感兴趣的点$(r, \\theta)$处计算这两个值。\n\n**步骤3：应力向笛卡尔坐标系的变换**\n初始应力状态是在固定的笛卡尔坐标系$(x,y)$中给出的，因此必须将极坐标应力扰动转换到同一坐标系中才能进行组合。使用标准的张量变换方程。对于位于角度$\\theta$（从$x$轴测量）的点，应力扰动张量$\\Delta \\boldsymbol{\\sigma}$的笛卡尔分量为：\n$$\n\\Delta \\sigma_{xx} = \\Delta \\sigma_r \\cos^2\\theta + \\Delta \\sigma_\\theta \\sin^2\\theta\n$$\n$$\n\\Delta \\sigma_{yy} = \\Delta \\sigma_r \\sin^2\\theta + \\Delta \\sigma_\\theta \\cos^2\\theta\n$$\n$$\n\\Delta \\sigma_{xy} = (\\Delta \\sigma_r - \\Delta \\sigma_\\theta) \\sin\\theta \\cos\\theta\n$$\n请注意，输入的角度$\\theta$以度为单位，在使用三角函数时必须转换为弧度。\n\n**步骤4：总有效应力张量**\n在时间$t_{\\mathrm{end}}$的总有效应力张量，记为$\\boldsymbol{\\sigma}(t_{\\mathrm{end}})$，是初始应力张量和扰动张量之和。初始状态是对角阵，其中$\\sigma_{xx}(0) = \\sigma_1$和$\\sigma_{yy}(0) = \\sigma_2$，且$\\sigma_{xy}(0) = 0$。因此，总应力张量的分量为：\n$$\n\\sigma_{xx}(t_{\\mathrm{end}}) = \\sigma_1 + \\Delta \\sigma_{xx}(t_{\\mathrm{end}})\n$$\n$$\n\\sigma_{yy}(t_{\\mathrm{end}}) = \\sigma_2 + \\Delta \\sigma_{yy}(t_{\\mathrm{end}})\n$$\n$$\n\\sigma_{xy}(t_{\\mathrm{end}}) = 0 + \\Delta \\sigma_{xy}(t_{\\mathrm{end}})\n$$\n\n**步骤5：主应力旋转**\n剪应力分量$\\sigma_{xy}(t_{\\mathrm{end}})$的引入导致主应力轴发生旋转。初始最大主应力与$x$轴对齐（角度为$0^\\circ$）。新的最大主应力角度$\\phi_p$（相对于$x$轴）可由总应力张量的分量求出。主应力面方向的公式为：\n$$\n\\tan(2\\phi_p) = \\frac{2\\sigma_{xy}}{\\sigma_{xx} - \\sigma_{yy}}\n$$\n主应力旋转$\\Delta \\phi$就是$\\phi_p$，因为初始方向为$0^\\circ$。为避免角度的模糊性，我们使用双参数反正切函数$\\arctan2(y, x)$。以弧度为单位的旋转角度为：\n$$\n\\Delta \\phi = \\frac{1}{2} \\arctan2(2\\sigma_{xy}, \\sigma_{xx} - \\sigma_{yy})\n$$\n然后将此结果从弧度转换为度，以满足最终输出的要求。\n\n**步骤6：断层稳定性分析**\n最后的任务是确定在指定方向上已存在的断层是否达到临界应力状态。我们使用零黏聚力的莫尔-库仑破坏准则，该准则指出，当平面上的剪应力大小$\\tau$大于或等于摩擦阻力$\\mu \\sigma_n$时，发生破坏。其中$\\mu$是摩擦系数，$\\sigma_n$是该平面上的有效正应力。对于一个相对于$x$轴方向为$\\beta$的断层面，该平面上的正应力$\\sigma_n$和剪应力$\\tau_s$由下式给出：\n$$\n\\sigma_n = \\frac{\\sigma_{xx} + \\sigma_{yy}}{2} + \\frac{\\sigma_{xx} - \\sigma_{yy}}{2} \\cos(2\\beta) + \\sigma_{xy} \\sin(2\\beta)\n$$\n$$\n\\tau_s = -\\frac{\\sigma_{xx} - \\sigma_{yy}}{2} \\sin(2\\beta) + \\sigma_{xy} \\cos(2\\beta)\n$$\n剪应力的大小为$\\tau = |\\tau_s|$。对于输入列表中的每个断层角度，我们使用总应力分量$\\sigma_{xx}(t_{\\mathrm{end}})$、$\\sigma_{yy}(t_{\\mathrm{end}})$和$\\sigma_{xy}(t_{\\mathrm{end}})$计算$\\sigma_n$和$\\tau$。然后我们评估布尔条件：\n$$\n\\tau \\ge \\mu \\sigma_n\n$$\n与其他角度一样，断层方向$\\beta$以度为单位给出，必须在计算中转换为弧度。所有指定断层族的结果被收集到一个布尔值列表中。\n\n对每个测试用例执行这一系列计算，并将结果——主应力旋转和断层破坏布尔值列表——格式化为指定的最终输出字符串。实现将使用`numpy`库进行高效的数值和三角运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (40.0, 30.0, 1.0, 1.0, 45.0, 1.0, 0.6, 8.0, 0.4, 1.0, 0.6, [20, 35, 60]),\n        # Test Case 2\n        (35.0, 34.0, 2.0, 1.0, 30.0, 1.5, 0.1, 15.0, 0.2, 1.0, 0.15, [30, 60, 75]),\n        # Test Case 3\n        (45.0, 35.0, 1.0, 10.0, 30.0, 1.0, 0.7, 5.0, 0.5, 1.0, 0.6, [30, 60]),\n        # Test Case 4\n        (50.0, 20.0, 1.5, 0.7, 75.0, 0.9, 0.9, 12.0, 0.3, 1.0, 0.6, [45, 60, 90]),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string with no spaces.\n    def format_result(res_list):\n        outer_parts = []\n        for item in res_list:\n            rotation = item[0]\n            bools_raw = item[1]\n            # Convert python booleans (True/False) to json-style (true/false)\n            bools = [str(b).lower() for b in bools_raw]\n            bool_str = '[' + ','.join(bools) + ']'\n            outer_parts.append(f'[{rotation},{bool_str}]')\n        return '[' + ','.join(outer_parts) + ']'\n\n    # Custom formatting to match the sample exactly, including no spaces and lowercase bools\n    # The example given was \"[[rotation1,[bool1,bool2,...]],[rotation2,[...]],...]\"\n    # Python's bool __str__ is 'True'/'False'. The example implies 'true'/'false'.\n    # I will stick to Python's default representation as it's more standard for code output.\n    # The logic below produces \"[rotation, [True, False]]\" style string representations\n    # which is then joined.\n    final_string = str(results).replace(\" \", \"\").replace(\"'\", \"\")\n    print(final_string)\n\ndef _solve_case(sigma1, sigma2, a, r, theta_deg, cr, ctheta, dp_max, tc, t_end, mu, fault_angles_deg):\n    \"\"\"\n    Solves a single test case for the poroelastic stress problem.\n    \"\"\"\n    # Convert angles from degrees to radians for trigonometric functions\n    theta_rad = np.deg2rad(theta_deg)\n    fault_angles_rad = np.deg2rad(np.array(fault_angles_deg))\n\n    # Step 1: Calculate pore pressure drop at t_end\n    # Note: problem describes depletion, so dp_max is a pressure *drop*. A negative value.\n    # The formulas for stress perturbation are given in terms of delta_p, so the sign\n    # must be handled consistently. Let's assume dp_max is positive and delta_p is negative.\n    dp_t_end = -dp_max * (1.0 - np.exp(-t_end / tc))\n\n    # Step 2: Calculate stress perturbations in polar coordinates\n    common_factor = dp_t_end * (a**2 / (r**2 + a**2))\n    delta_sigma_r = cr * common_factor\n    delta_sigma_theta = ctheta * common_factor\n\n    # Step 3: Transform perturbations to Cartesian coordinates\n    cos_theta = np.cos(theta_rad)\n    sin_theta = np.sin(theta_rad)\n    \n    delta_sigma_xx = delta_sigma_r * cos_theta**2 + delta_sigma_theta * sin_theta**2\n    delta_sigma_yy = delta_sigma_r * sin_theta**2 + delta_sigma_theta * cos_theta**2\n    delta_sigma_xy = (delta_sigma_r - delta_sigma_theta) * sin_theta * cos_theta\n\n    # Step 4: Calculate total stress tensor components\n    # The initial stresses are effective stresses. The perturbations are also effective stresses.\n    sigma_xx = sigma1 + delta_sigma_xx\n    sigma_yy = sigma2 + delta_sigma_yy\n    sigma_xy = 0.0 + delta_sigma_xy\n\n    # Step 5: Calculate principal stress rotation\n    # The angle of the new max principal stress relative to the x-axis is given by\n    # 0.5 * arctan2(2*sigma_xy, sigma_xx - sigma_yy). This is the rotation angle.\n    delta_phi_rad = 0.5 * np.arctan2(2.0 * sigma_xy, sigma_xx - sigma_yy)\n    delta_phi_deg = np.rad2deg(delta_phi_rad)\n\n    # Step 6: Analyze fault stability for each fault orientation\n    fault_failure_bools = []\n    for beta_rad in fault_angles_rad:\n        # Use standard transformation equations for stress on the fault plane\n        cos_2beta = np.cos(2.0 * beta_rad)\n        sin_2beta = np.sin(2.0 * beta_rad)\n\n        sigma_n = (sigma_xx + sigma_yy) / 2.0 + (sigma_xx - sigma_yy) / 2.0 * cos_2beta + sigma_xy * sin_2beta\n        tau_s = -(sigma_xx - sigma_yy) / 2.0 * sin_2beta + sigma_xy * cos_2beta\n        \n        # Shear stress magnitude\n        tau_mag = np.abs(tau_s)\n\n        # Apply Mohr-Coulomb failure criterion: tau >= mu * sigma_n\n        # Only check for failure if the normal stress is compressive (positive)\n        is_failing = tau_mag >= mu * sigma_n if sigma_n > 0 else False\n        fault_failure_bools.append(bool(is_failing))\n        \n    # Format the result for this case as per the requirements\n    # Python's bool to string is 'True' or 'False'. The problem output example uses lowercase,\n    # but I will stick to the Python standard as it is a code block result.\n    final_result_list = [round(delta_phi_deg, 3), fault_failure_bools]\n\n    # The final print outside this function will handle the string formatting.\n    # However, let's regenerate the string manually to match the exact weird format.\n    # [[-2.583,[False,False,False]],[...]]\n    return final_result_list\n\n# This wrapper is needed to produce the exact output format requested by the problem,\n# which is non-standard Python list string representation.\ndef final_formatting_wrapper():\n    test_cases = [\n        (40.0, 30.0, 1.0, 1.0, 45.0, 1.0, 0.6, 8.0, 0.4, 1.0, 0.6, [20, 35, 60]),\n        (35.0, 34.0, 2.0, 1.0, 30.0, 1.5, 0.1, 15.0, 0.2, 1.0, 0.15, [30, 60, 75]),\n        (45.0, 35.0, 1.0, 10.0, 30.0, 1.0, 0.7, 5.0, 0.5, 1.0, 0.6, [30, 60]),\n        (50.0, 20.0, 1.5, 0.7, 75.0, 0.9, 0.9, 12.0, 0.3, 1.0, 0.6, [45, 60, 90]),\n    ]\n    results_list = [_solve_case(*case) for case in test_cases]\n    \n    # Custom string building\n    parts = []\n    for rot, bool_list in results_list:\n        bool_list_str = str(bool_list).replace(\" \", \"\")\n        parts.append(f\"[{rot},{bool_list_str}]\")\n    print(f\"[{','.join(parts)}]\")\n\n# The original code's print logic was complex. Let's stick to the robust solution and\n# let the outer shell handle formatting. The `solve` function is the one that is executed.\n# It was decided to just print the Python `repr` of the list and remove spaces.\nfinal_formatting_wrapper()\n\n```", "id": "3532835"}]}