{"hands_on_practices": [{"introduction": "本实践旨在将库仑摩擦模型与岩土力学中的其他核心概念相结合。通过这个练习，你将运用有效应力原理和固结理论，推导出一个饱和界面上临界剪切力的瞬时表达式，从而深刻理解孔隙水压力耗散如何影响界面的摩擦强度和稳定性。这种分析能力的培养对于评估如断层和地基等岩土地质界面的长期稳定性至关重要。 [@problem_id:3512291]", "problem": "一个面积为 $A$ 的平面、饱和、粗糙的岩土界面对称地嵌入在两个相同的、均质的、各向同性的、完全饱和的多孔半层之间。在时间 $t=0^{+}$ 时，一个压缩法向载荷 $N$ 被均匀地施加到界面上，然后保持恒定。界面上的总法向应力为 $\\sigma_{n}=N/A$（压缩为正）。加载后，界面立即表现出不排水的超孔隙水压力 $u_{0}$，随后通过一维固结在相邻的多孔层中消散，固结系数为 $c_{v}$，到每个排水边界的排水路径长度相等，为 $H_{d}$（双面排水）。假设小应变和准静态条件。\n\n然后，一个切向（剪切）力 $T$ 被单调且准静态地沿界面施加，在界面上引起一个均匀的剪切牵引矢量 $\\boldsymbol{\\tau}$。该界面遵循一个用有效应力表示的、与速率无关的、无粘聚力的库仑准则：$\\|\\boldsymbol{\\tau}\\| \\le \\mu\\,p'$，其中 $\\mu$ 是恒定的摩擦系数，$p'$ 是界面上的有效法向应力。有效法向应力根据有效应力原理定义为 $p'=\\sigma_{n}-u$，其中 $u$ 是界面上的孔隙水压力。\n\n将孔隙水压力消散处理为垂直于界面的一维固结，在两侧距离为 $H_{d}$ 的排水边界处超孔隙水压力为零，并且在固结层中初始超孔隙水压力在空间上均匀，为 $u(z,0)=u_{0}$。您可以假设，与界面滑动相关的孔隙水压力等于太沙基（Terzaghi）双面排水一维固结理论意义下固结层中的空间平均超孔隙水压力。\n\n仅使用上述基础（有效应力原理、库仑摩擦和一维固结），推导出一个关于滑动起始的随时间变化的临界剪切力 $T_{c}(t)$ 的闭式解析表达式（您可以将其表示为一个收敛级数）。将您最终的 $T_{c}(t)$ 以牛顿为单位表示。然后，根据您的表达式，定性地解释增加固结时间 $t$ 如何影响界面的稳定性。\n\n您的最终答案必须是 $T_{c}(t)$ 的单个闭式解析表达式，用 $N$、$A$、$\\mu$、$u_{0}$、$c_{v}$、$H_{d}$ 和 $t$ 表示。不需要进行数值计算，也不需要四舍五入。此问题不涉及角度。", "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 界面面积: $A$。\n- 法向载荷: $N$ (压缩)，在时间 $t=0^{+}$ 施加并保持恒定。\n- 总法向应力: $\\sigma_{n} = N/A$。\n- 界面初始超孔隙水压力: $u_{0}$ (在 $t=0^{+}$ 时)。\n- 固结模型: 相邻多孔层中的一维 (1D) 固结。\n- 固结系数: $c_{v}$。\n- 排水条件: 双面排水，到每个排水边界的排水路径长度为 $H_{d}$。\n- 切向力: $T$，引起均匀的剪切牵引力 $\\boldsymbol{\\tau}$。\n- 摩擦定律: 与速率无关的无粘聚力库仑准则, $\\|\\boldsymbol{\\tau}\\| \\le \\mu\\,p'$。\n- 摩擦系数: $\\mu$。\n- 有效应力原理: $p' = \\sigma_{n} - u$，其中 $u$ 是界面上的孔隙水压力。\n- 固结初始条件: 空间上均匀的初始超孔隙水压力 $u(z,0) = u_{0}$。\n- 固结边界条件: 距界面 $H_{d}$ 处的超孔隙水压力为零。\n- 核心假设: 用于计算滑动的孔隙水压力 $u$ 等于太沙基 (Terzaghi) 一维固结理论中固结层的空间平均超孔隙水压力。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，利用了有效应力原理、库仑摩擦定律和太沙基 (Terzaghi) 的一维固结理论。这些是岩土力学中基本且公认的原理。该问题是适定的，提供了所有必要的参数 ($A, N, \\mu, u_0, c_v, H_d$)、初始和边界条件，以及一个关于计算相关孔隙水压力的清晰但理想化的假设。语言客观、精确。该问题是土力学中概念的标准、非平凡的综合，不包含任何所列的缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n目标是推导启动滑动所需的随时间变化的临界剪切力 $T_{c}(t)$ 的表达式。\n\n临界剪切力 $T_{c}(t)$ 是首先满足滑动条件的切向力 $T$ 的大小。给定界面面积 $A$ 上的均匀剪切牵引矢量 $\\boldsymbol{\\tau}$，其大小为 $\\|\\boldsymbol{\\tau}\\| = T/A$。临界剪切力 $T_{c}(t)$ 对应一个临界剪切牵引力大小，我们将其表示为 $\\tau_{c}(t)$，使得\n$$T_{c}(t) = A \\, \\tau_{c}(t)$$\n\n界面行为由以有效应力表示的无粘聚力库仑摩擦准则控制。当剪切牵引力大小达到界面的摩擦阻力时，滑动开始：\n$$\\tau_{c}(t) = \\mu \\, p'(t)$$\n其中 $\\mu$ 是摩擦系数，$p'(t)$ 是界面上随时间变化的有效法向应力。\n\n有效法向应力由有效应力原理定义为：\n$$p'(t) = \\sigma_{n} - u(t)$$\n这里，$\\sigma_{n}$ 是总法向应力，它是一个常数，由 $\\sigma_{n} = N/A$ 给出。项 $u(t)$ 是时间 $t$ 时界面上的超孔隙水压力。\n\n结合这些方程，我们可以将临界剪切力表示为：\n$$T_{c}(t) = A \\, \\mu \\, p'(t) = A \\, \\mu \\, (\\sigma_{n} - u(t)) = A \\, \\mu \\left(\\frac{N}{A} - u(t)\\right)$$\n$$T_{c}(t) = \\mu (N - A \\, u(t))$$\n为了求得 $T_{c}(t)$，我们必须确定界面上的超孔隙水压力 $u(t)$ 作为时间的函数。\n\n问题指出，孔隙水压力根据太沙基 (Terzaghi) 的一维固结理论消散。几何形状为双面排水，界面位于固结介质的中心，排水边界在两侧距离为 $H_{d}$ 的位置。因此，固结土的总厚度为 $L = 2H_{d}$。超孔隙水压力 $u(z,t)$ 的控制偏微分方程是扩散方程：\n$$\\frac{\\partial u}{\\partial t} = c_{v} \\frac{\\partial^2 u}{\\partial z^2}$$\n其中 $z$ 是垂直于界面的空间坐标。设界面位于 $z=0$。排水边界位于 $z = \\pm H_{d}$。边界条件为 $u(\\pm H_{d}, t) = 0$ (对于 $t  0$)。初始条件为均匀的超孔隙水压力 $u(z, 0) = u_{0}$ (对于 $-H_{d}  z  H_{d}$) 。\n\n关键是，问题明确指出，与滑动相关的孔隙水压力 $u(t)$ 应取为时间 $t$ 时整个固结层中超孔隙水压力的*空间平均值*。让我们将这个平均压力表示为 $\\bar{u}(t)$。它被定义为：\n$$\\bar{u}(t) = \\frac{1}{2H_{d}} \\int_{-H_{d}}^{H_{d}} u(z,t) \\, dz$$\n\n对于这些初始和边界条件，平均超孔隙水压力 $\\bar{u}(t)$ 的解是固结理论中的一个标准结果。它可以表示为傅里叶级数。平均固结度 $U_{av}(t)$ 定义为 $U_{av}(t) = 1 - \\bar{u}(t)/u_{0}$。$U_{av}(t)$ 的解为：\n$$U_{av}(t) = 1 - \\sum_{m=0}^{\\infty} \\frac{8}{(2m+1)^2 \\pi^2} \\exp\\left( - \\frac{(2m+1)^2 \\pi^2 c_{v} t}{4 H_{d}^2} \\right)$$\n由此，我们可以将平均超孔隙水压力 $\\bar{u}(t)$ 写为：\n$$\\bar{u}(t) = u_{0} (1 - U_{av}(t)) = u_{0} \\sum_{m=0}^{\\infty} \\frac{8}{(2m+1)^2 \\pi^2} \\exp\\left( - \\frac{(2m+1)^2 \\pi^2 c_{v} t}{4 H_{d}^2} \\right)$$\n根据问题的假设，我们将用于摩擦计算的界面孔隙水压力设置为这个平均值：$u(t) = \\bar{u}(t)$。\n\n将 $u(t)$ 的这个表达式代入我们的 $T_{c}(t)$ 方程：\n$$T_{c}(t) = \\mu \\left( N - A \\, u_{0} \\sum_{m=0}^{\\infty} \\frac{8}{(2m+1)^2 \\pi^2} \\exp\\left(-\\frac{(2m+1)^2 \\pi^2 c_{v} t}{4 H_{d}^2}\\right) \\right)$$\n这就是滑动起始时随时间变化的临界剪切力的闭式解析表达式。该级数是收敛的。\n\n为了定性解释增加固结时间 $t$ 如何影响界面的稳定性，我们分析推导出的 $T_{c}(t)$ 表达式。稳定性与 $T_c(t)$ 的大小直接相关：值越高表示抗滑能力越强。\n\n$T_{c}(t)$ 的表达式包含一个求和项。和中的每一项都包含一个指数因子 $\\exp(-k_{m}t)$，其中 $k_{m} = \\frac{(2m+1)^2 \\pi^2 c_{v}}{4 H_{d}^2}$ 对于每个模态 $m$ 都是一个正常数。随着时间 $t$ 的增加，每个指数项都衰减趋于零。因此，代表平均超孔隙水压力 $\\bar{u}(t)$ 的整个求和项随时间单调递减。\n- 在时间 $t=0$ 时，指数项为 $1$。该和的值为 $1$ (因为 $\\sum_{m=0}^{\\infty} \\frac{8}{(2m+1)^2\\pi^2} = 1$)，所以 $\\bar{u}(0) = u_{0}$。初始临界剪切力为 $T_{c}(0) = \\mu(N - A u_{0})$。\n- 当时间 $t \\to \\infty$ 时，指数项以及整个求和项都趋于 $0$。超孔隙水压力完全消散，$\\bar{u}(\\infty) = 0$。长期临界剪切力为 $T_{c}(\\infty) = \\mu N$。\n\n由于平均孔隙水压力 $u(t)$ 随时间从 $u_{0}$ 减小到 $0$，有效法向应力 $p'(t) = N/A - u(t)$ 随时间增加。根据库仑准则，剪切强度 $\\tau_c(t)$ 与 $p'(t)$ 成正比。因此，临界剪切力 $T_{c}(t)$ 随时间从初始值 $\\mu(N - A u_{0})$ 单调增加到最终的完全排水值 $\\mu N$。这个由于孔隙水压力消散而导致界面摩擦强度增加的过程，被称为摩擦强化。因此，增加固结时间可以增强界面抵抗剪切诱发滑动的稳定性。", "answer": "$$\\boxed{\\mu \\left( N - A u_{0} \\sum_{m=0}^{\\infty} \\frac{8}{\\pi^2 (2m+1)^2} \\exp\\left(-\\frac{(2m+1)^2 \\pi^2 c_{v} t}{4 H_{d}^2}\\right) \\right)}$$", "id": "3512291"}, {"introduction": "从理论分析转向计算实践，本练习的核心是实现返回映射算法（Return-Mapping Algorithm）。该算法是计算塑性力学（包括库仑摩擦）的基石，广泛应用于有限元等数值程序中。通过亲手构建“弹性预测-塑性修正”的逻辑，你将掌握在数值模拟中如何处理从粘滞到滑动的状态切换，这是开发和应用现代岩土力学计算软件的一项核心技能。 [@problem_id:3512367]", "problem": "考虑一个摩擦接触界面，该界面被建模为放置在两个可变形体之间的切向弹簧-滑块。该界面在切向方向上的行为由弹性粘滞状态下的线性弹性弹簧和当弹性试探状态超过容許摩擦边界时的率无关库仑滑移所控制。设弹性切向位移（存储弹性弹簧伸长的内部变量）为向量 $\\boldsymbol{\\delta}_t \\in \\mathbb{R}^2$，切向牵引力为 $\\boldsymbol{\\tau} \\in \\mathbb{R}^2$，单位面积的标量切向刚度为 $k_t$（单位为 $\\mathrm{Pa/m}$），法向压缩牵引力大小为 $p_n \\ge 0$（单位为 $\\mathrm{Pa}$），摩擦系数为 $\\mu \\ge 0$。在一个时间（或载荷）增量内，运动驱动量是施加的相对切向位移增量 $\\Delta \\mathbf{u}_t \\in \\mathbb{R}^2$（单位为 $\\mathrm{m}$），算法必须一致地更新 $\\boldsymbol{\\delta}_t$ 和 $\\boldsymbol{\\tau}$。\n\n使用以下基本法则，您必须将其作为给定条件而无需推导：(i) 切向粘滞状态下的线性弹性接触定律，即 $\\boldsymbol{\\tau} = k_t \\boldsymbol{\\delta}_t$；以及 (ii) 库仑摩擦容许条件，即 $\\|\\boldsymbol{\\tau}\\| \\le \\mu p_n$，其中 $\\|\\cdot\\|$ 表示欧几里得范数。假设小变形和准静态条件，并使用返回映射算法（Return-Mapping Algorithm, RMA）的标准预测-校正结构，但除了所述的基本法则外，不假设任何专门的封闭形式表达式。\n\n您的任务如下，并且每一步都必须严格基于所提供的基本定律和核心定义：\n- 从上一内部状态 $\\boldsymbol{\\delta}_t^{\\mathrm{old}}$ 和给定的增量 $\\Delta \\mathbf{u}_t$ 出发，构建区分弹性粘滞和塑性滑移的逻辑结构。清晰解释如何通过纯弹性演化获得弹性试探状态，以及如何使用从库仑条件导出的适当屈服函数来判断其容许性。\n- 如果试探状态是容许的，则以与弹性粘滯一致的方式更新 $\\boldsymbol{\\delta}_t$ 和 $\\boldsymbol{\\tau}$。如果试探状态违反了容许性，则执行一次到库仑面的返回（投影），强制 $\\|\\boldsymbol{\\tau}\\| = \\mu p_n$，同时以数学上一致的方式保持驱动状态的方向。展示校正后的 $\\boldsymbol{\\delta}_t$ 和 $\\boldsymbol{\\tau}$ 更新是如何从这一强制条件和线性弹性定律中得出的。\n- 确保该方案对边缘情况具有鲁棒性，包括 $p_n = 0$、$\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\| = 0$ 以及试探状态恰好位于容许面上的边界情况。明确指明哪種情況被視為彈性黏滯，哪種情況被視為塑性滑移。\n- 将该算法实现为一个完整的程序。对于每个测试用例，程序返回更新后的牵引力向量和更新后的弹性切向位移向量，以及一个布尔指示符，用于表明该增量是以弹性粘滞还是塑性滑移结束。所有中間物理量均以國際單位制（SI 單位）表示。程序不应打印任何单位符号；必须只输出纯数字。\n\n使用以下测试套件，所有量均采用 SI 单位，向量按 $(x,y)$ 顺序给出：\n- 测试用例 1 (理想路径粘滞): $k_t = 1.0\\times 10^9\\,\\mathrm{Pa/m}$, $\\mu = 0.6$, $p_n = 1.0\\times 10^5\\,\\mathrm{Pa}$, $\\boldsymbol{\\delta}_t^{\\mathrm{old}} = [0.0, 0.0]\\,\\mathrm{m}$, $\\Delta \\mathbf{u}_t = [2.0\\times 10^{-5}, 1.0\\times 10^{-5}]\\,\\mathrm{m}$。\n- 测试用例 2 (边界相等情况视为粘滞): $k_t = 1.0\\times 10^9\\,\\mathrm{Pa/m}$, $\\mu = 0.6$, $p_n = 1.0\\times 10^5\\,\\mathrm{Pa}$, $\\boldsymbol{\\delta}_t^{\\mathrm{old}} = [0.0, 0.0]\\,\\mathrm{m}$, $\\Delta \\mathbf{u}_t = [6.0\\times 10^{-5}, 0.0]\\,\\mathrm{m}$。\n- 测试用例 3 (存在非零初始弹性伸长时的塑性滑移): $k_t = 1.0\\times 10^9\\,\\mathrm{Pa/m}$, $\\mu = 0.6$, $p_n = 1.0\\times 10^5\\,\\mathrm{Pa}$, $\\boldsymbol{\\delta}_t^{\\mathrm{old}} = [2.0\\times 10^{-5}, 1.0\\times 10^{-5}]\\,\\mathrm{m}$, $\\Delta \\mathbf{u}_t = [1.0\\times 10^{-4}, -1.0\\times 10^{-5}]\\,\\mathrm{m}$。\n- 测试用例 4 (零法向压力边缘情况): $k_t = 1.0\\times 10^9\\,\\mathrm{Pa/m}$, $\\mu = 0.6$, $p_n = 0.0\\,\\mathrm{Pa}$, $\\boldsymbol{\\delta}_t^{\\mathrm{old}} = [0.0, 0.0]\\,\\mathrm{m}$, $\\Delta \\mathbf{u}_t = [1.0\\times 10^{-5}, -1.0\\times 10^{-5}]\\,\\mathrm{m}$。\n- 测试用例 5 (存在初始弹性伸长时的零增量情况): $k_t = 1.0\\times 10^9\\,\\mathrm{Pa/m}$, $\\mu = 0.6$, $p_n = 1.0\\times 10^5\\,\\mathrm{Pa}$, $\\boldsymbol{\\delta}_t^{\\mathrm{old}} = [3.0\\times 10^{-5}, 0.0]\\,\\mathrm{m}$, $\\Delta \\mathbf{u}_t = [0.0, 0.0]\\,\\mathrm{m}$。\n\n对于每个测试用例，您的程序必须输出一个格式为 $[\\tau_x, \\tau_y, \\delta_{t,x}, \\delta_{t,y}, \\mathrm{is\\_stick}]$ 的列表，其中 $\\tau_x$ 和 $\\tau_y$ 是更新后的牵引力分量（单位为 $\\mathrm{Pa}$），$\\delta_{t,x}$ 和 $\\delta_{t,y}$ 是更新后的弹性切向位移分量（单位为 $\\mathrm{m}$），$\\mathrm{is\\_stick}$ 是一个布尔值，$ \\mathrm{True}$ 表示弹性粘滞，$ \\mathrm{False}$ 表示塑性滑移。将所有浮点输出四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含所有五个测试用例的结果，形式为方括号内由逗号分隔的列表，其中每个元素是单个测试用例的列表（例如 $[[\\cdots],[\\cdots],\\ldots]$）。", "solution": "该问题要求为率无关库仑摩擦模型制定并实现一个返回映射算法。该模型使用弹簧-滑块系统描述摩擦界面的切向行为。解决方案将遵循计算塑性力学的标准预测-校正框架进行构建。所有物理量均以国际单位制（SI）表示。\n\n核心运动学假设是总相对切向位移增量 $\\Delta \\mathbf{u}_t$ 的加性分解，分解为一个弹性部分 $\\Delta \\boldsymbol{\\delta}_t$ 和一个塑性（滑移）部分 $\\Delta \\mathbf{u}_t^p$：\n$$\n\\Delta \\mathbf{u}_t = \\Delta \\boldsymbol{\\delta}_t + \\Delta \\mathbf{u}_t^p\n$$\n增量开始时界面的状态由上一步的弹性切向位移 $\\boldsymbol{\\delta}_t^{\\mathrm{old}}$ 定义。目标是在给定增量 $\\Delta \\mathbf{u}_t$ 和恒定法向压力 $p_n$ 的情况下，计算更新后的状态变量 $\\boldsymbol{\\delta}_t^{\\mathrm{new}}$ 和 $\\boldsymbol{\\tau}^{\\mathrm{new}}$。\n\n### 步骤 1：弹性预测（试探状态）\n\n返回映射算法的第一步是假设整个增量是纯弹性的。这是“预测”步骤。在此假设下，塑性滑移增量为零，即 $\\Delta \\mathbf{u}_t^p = \\mathbf{0}$。因此，弹性位移增量等于总施加位移增量。\n\n试探弹性位移 $\\boldsymbol{\\delta}_t^{\\mathrm{trial}}$ 通过将增量加到先前状态来计算：\n$$\n\\boldsymbol{\\delta}_t^{\\mathrm{trial}} = \\boldsymbol{\\delta}_t^{\\mathrm{old}} + \\Delta \\mathbf{u}_t\n$$\n使用给定的线性弹性接触定律 $\\boldsymbol{\\tau} = k_t \\boldsymbol{\\delta}_t$，计算试探切向牵引力 $\\boldsymbol{\\tau}^{\\mathrm{trial}}$：\n$$\n\\boldsymbol{\\tau}^{\\mathrm{trial}} = k_t \\boldsymbol{\\delta}_t^{\\mathrm{trial}}\n$$\n\n### 步骤 2：容许性检查（屈服条件）\n\n必须根据摩擦容许性准则检查试探状态，该准则规定切向牵引力的大小不能超过与法向压力成比例的极限。这就是库仑摩擦定律：$\\|\\boldsymbol{\\tau}\\| \\le \\mu p_n$。我们可以定义一个屈服函数 $f$ 来形式化此检查：\n$$\nf(\\boldsymbol{\\tau}, p_n) = \\|\\boldsymbol{\\tau}\\| - \\mu p_n\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。如果 $f \\le 0$，界面处于弹性粘滞状态；如果 $f  0$，则发生塑性滑移。\n\n我们在试探状态下评估此函数：\n$$\nf^{\\mathrm{trial}} = f(\\boldsymbol{\\tau}^{\\mathrm{trial}}, p_n) = \\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\| - \\mu p_n\n$$\n$f^{\\mathrm{trial}}$ 的值决定了是否需要“校正”步骤。\n\n### 步骤 3：校正/更新\n\n根据容许性检查，会出现两种情况。\n\n**情况 A：弹性粘滞 ($f^{\\mathrm{trial}} \\le 0$)**\n\n如果试探屈服函数小于或等于零，则试探状态是容许的。纯弹性行为的初始假设是正确的。没有发生塑性滑移。试探状态被接受为该增量的最终状态。\n更新后的变量为：\n$$\n\\boldsymbol{\\tau}^{\\mathrm{new}} = \\boldsymbol{\\tau}^{\\mathrm{trial}}\n$$\n$$\n\\boldsymbol{\\delta}_t^{\\mathrm{new}} = \\boldsymbol{\\delta}_t^{\\mathrm{trial}}\n$$\n塑性滑移增量被确认为零：$\\Delta \\mathbf{u}_t^p = \\mathbf{0}$。此增量的过程是弹性粘滞。根据问题陈述，当 $f^{\\mathrm{trial}} = 0$（即试探状态恰好位于容许面上）的边界情况被视为弹性粘滞，因为不需要校正。\n\n**情况 B：塑性滑移 ($f^{\\mathrm{trial}}  0$)**\n\n如果试探屈服函数大于零，则试探状态是不可容许的，并且在物理上是不可能的。纯弹性行为的假设是错误的，必须发生塑性滑移以将牵引力维持在屈服面上。“校正”步骤涉及一个“返回映射”，它将试探牵引力投影回容许边界（即屈服面）。\n\n对于率无关库仑摩擦，相关联流动法则規定塑性滑移的方向 $\\Delta \\mathbf{u}_t^p$ 在应力空间中垂直于屈服面。在 $\\boldsymbol{\\tau}$ 平面中，屈服面是一個半徑為 $\\mu p_n$ 的圓。屈服面上一点 $\\boldsymbol{\\tau}$ 的外法线方向是 $\\boldsymbol{\\tau} / \\|\\boldsymbol{\\tau}\\|$。为保持一致性，返回映射使用试探应力的方向，该方向代表了弹性驱动力的方向。\n\n校正后的牵引力 $\\boldsymbol{\\tau}^{\\mathrm{new}}$ 必须位于屈服面上，这意味着其大小必须恰好为 $\\mu p_n$。其方向保留了试探状态的方向：\n$$\n\\boldsymbol{\\tau}^{\\mathrm{new}} = (\\mu p_n) \\frac{\\boldsymbol{\\tau}^{\\mathrm{trial}}}{\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\|}\n$$\n这是一个到屈服圆的径向返回。根据弹性定律，更新后的弹性位移 $\\boldsymbol{\\delta}_t^{\\mathrm{new}}$ 必须与此校正后的牵引力一致：\n$$\n\\boldsymbol{\\delta}_t^{\\mathrm{new}} = \\frac{\\boldsymbol{\\tau}^{\\mathrm{new}}}{k_t} = \\frac{\\mu p_n}{k_t} \\frac{\\boldsymbol{\\tau}^{\\mathrm{trial}}}{\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\|}\n$$\n此增量的过程是塑性滑移。\n\n### 边缘情况的处理\n\n算法必须对问题中指出的特定边缘情况具有鲁棒性。\n\n- **$p_n = 0$**: 如果法向压力为零，则摩擦极限 $\\mu p_n$ 也为零。\n    - 如果 $\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\|  0$，则 $f^{\\mathrm{trial}}  0$，表示滑移。返回映射将牵引力投影到大小为零的点上：$\\boldsymbol{\\tau}^{\\mathrm{new}} = \\mathbf{0}$。因此，最终的弹性位移也为零：$\\boldsymbol{\\delta}_t^{\\mathrm{new}} = \\mathbf{0}$。这代表无阻力的自由滑移。\n    - 如果 $\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\| = 0$，则 $f^{\\mathrm{trial}} = 0$，表示粘滞。最终状态为 $\\boldsymbol{\\tau}^{\\mathrm{new}} = \\mathbf{0}$ 和 $\\boldsymbol{\\delta}_t^{\\mathrm{new}} = \\boldsymbol{\\delta}_t^{\\mathrm{trial}}$。\n\n- **$\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\| = 0$**: 这种情况只在 $\\boldsymbol{\\delta}_t^{\\mathrm{trial}} = \\mathbf{0}$ 时发生。此时，屈服函数为 $f^{\\mathrm{trial}} = 0 - \\mu p_n$。由于 $\\mu \\ge 0$ 且 $p_n \\ge 0$，因此 $f^{\\mathrm{trial}} \\le 0$。这种情况将总是被分类为弹性粘滞。更新结果为 $\\boldsymbol{\\tau}^{\\mathrm{new}} = \\mathbf{0}$ 和 $\\boldsymbol{\\delta}_t^{\\mathrm{new}} = \\mathbf{0}$，这在物理上是一致的。因此，在这种情况下永远不会遇到除以 $\\|\\boldsymbol{\\tau}^{\\mathrm{trial}}\\|$ 的情况，因为它不会进入滑移分支。\n\n预测、检查和校正步骤的组合构成了一个完整且鲁棒的算法，用于在单个载荷增量上更新摩擦界面的状态。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Coulomb friction return-mapping algorithm.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy path stick\n        {'k_t': 1.0e9, 'mu': 0.6, 'p_n': 1.0e5, 'delta_t_old': np.array([0.0, 0.0]), 'delta_u_t': np.array([2.0e-5, 1.0e-5])},\n        # Case 2: Boundary equality treated as stick\n        {'k_t': 1.0e9, 'mu': 0.6, 'p_n': 1.0e5, 'delta_t_old': np.array([0.0, 0.0]), 'delta_u_t': np.array([6.0e-5, 0.0])},\n        # Case 3: Plastic slip with nonzero prior elastic stretch\n        {'k_t': 1.0e9, 'mu': 0.6, 'p_n': 1.0e5, 'delta_t_old': np.array([2.0e-5, 1.0e-5]), 'delta_u_t': np.array([1.0e-4, -1.0e-5])},\n        # Case 4: Zero normal pressure edge case\n        {'k_t': 1.0e9, 'mu': 0.6, 'p_n': 0.0, 'delta_t_old': np.array([0.0, 0.0]), 'delta_u_t': np.array([1.0e-5, -1.0e-5])},\n        # Case 5: Zero increment with pre-existing elastic stretch\n        {'k_t': 1.0e9, 'mu': 0.6, 'p_n': 1.0e5, 'delta_t_old': np.array([3.0e-5, 0.0]), 'delta_u_t': np.array([0.0, 0.0])},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_return_mapping(**params)\n        results.append(result)\n\n    # Format the final output string as a list of lists.\n    # The map(str, results) and join correctly format the output per the problem specification.\n    # e.g., [[val1, val2, ...], [val1, val2, ...]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef run_return_mapping(k_t, mu, p_n, delta_t_old, delta_u_t):\n    \"\"\"\n    Implements the return-mapping algorithm for rate-independent Coulomb friction.\n\n    Args:\n        k_t (float): Tangential stiffness per unit area (Pa/m).\n        mu (float): Coefficient of friction.\n        p_n (float): Compressive normal traction (Pa).\n        delta_t_old (np.ndarray): Previous elastic tangential displacement vector (m).\n        delta_u_t (np.ndarray): Imposed relative tangential displacement increment vector (m).\n\n    Returns:\n        list: A list containing [tau_x, tau_y, delta_t_x, delta_t_y, is_stick]\n              with floats rounded to 6 decimal places.\n    \"\"\"\n    # Step 1: Elastic Predictor (Trial State)\n    # Assume the entire increment is elastic.\n    delta_t_trial = delta_t_old + delta_u_t\n    tau_trial = k_t * delta_t_trial\n    \n    # Step 2: Admissibility Check (Yield Condition)\n    norm_tau_trial = np.linalg.norm(tau_trial)\n    friction_limit = mu * p_n\n    \n    # Yield function: f = ||tau|| - mu*p_n\n    yield_function = norm_tau_trial - friction_limit\n\n    # Step 3: Corrector / Update\n    # Check if the trial state is admissible (stick) or not (slip).\n    # The condition `yield_function = 0` corresponds to elastic stick.\n    if yield_function = 0:\n        # Case A: Elastic Stick\n        is_stick = True\n        tau_new = tau_trial\n        delta_t_new = delta_t_trial\n    else:\n        # Case B: Plastic Slip\n        is_stick = False\n        # The trial traction magnitude is guaranteed to be non-zero here\n        # because yield_function > 0 implies norm_tau_trial > friction_limit >= 0.\n        # A direct return to the yield surface is performed.\n        \n        # Handle the special case of frictionless sliding where friction_limit is 0.\n        # Return to origin.\n        if friction_limit == 0.0:\n            tau_new = np.array([0.0, 0.0])\n        else:\n            # Radial return: project the trial traction back to the yield surface.\n            tau_new = tau_trial * (friction_limit / norm_tau_trial)\n        \n        # Update elastic displacement to be consistent with the corrected traction.\n        delta_t_new = tau_new / k_t\n\n    # Format the output for the current test case\n    return [\n        round(tau_new[0], 6),\n        round(tau_new[1], 6),\n        round(delta_t_new[0], 6),\n        round(delta_t_new[1], 6),\n        is_stick\n    ]\n\n# Execute the main function.\nsolve()\n```", "id": "3512367"}, {"introduction": "本练习探讨了摩擦计算模型中的一个关键高级问题：病态网格依赖性。当使用经典的库仑摩擦模型模拟滑移局部化时，由于模型缺乏内禀长度尺度，计算结果会随网格加密而发生不收敛的改变。通过评估不同的正则化方法，本练习旨在让你深刻认识到确保计算结果客观、物理真实的必要性，并培养对计算模型有效性的批判性思维。 [@problem_id:3512317]", "problem": "考虑一个 $2$ 维平面应变连续体域 $\\Omega$，该区域通过一个协调的有限元（FE）网格进行离散化，在其内部，两个子域之间插入了一个预设的、零厚度的摩擦界面 $\\Gamma \\subset \\Omega$。假设该物体在界面上承受准静态剪切载荷和均匀的法向压应力 $\\sigma_n$。该界面通过一个率无关的 Coulomb 摩擦定律进行建模，该定律具有恒定的摩擦系数 $\\mu$，使得切向牵引力 $\\tau$ 满足 $\\tau \\le \\mu \\sigma_n$，并且当 $\\tau = \\mu \\sigma_n$ 时，沿着局部切向方向发生非负滑移率的滑动。假设法向接触约束被强制执行以防止张开，并忽略惯性。\n\n要求您从第一性原理出发，论证为什么离散解可能沿 $\\Gamma$ 表现出与网格相关的滑移局部化，并评估在网格细化时减轻滑移病态集中的策略。使用以下基本原理：\n\n- 体内的线动量平衡，表示为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$，并带有适当的边界条件和运动学协调的位移场 $\\boldsymbol{u}$。\n- Coulomb 摩擦的定义，即一个率无关、非关联、耗散的接触定律，它将切向牵引力限制在 $\\mu \\sigma_n$ 以内，并强制与滑移率的互补性。\n- 准静态增量能量的观点，其中外力功的增量等于 $\\Omega$ 中可恢复应变能的增量与 $\\Gamma$ 上耗散功率之和，同时认识到纯粹的率无关 Coulomb 定律没有引入与 $\\Gamma$ 上滑移梯度相关的内禀长度尺度。\n\n基于此推理，评估以下陈述并选择所有正确的选项：\n\nA. 在一个没有内禀长度尺度的率无关 Coulomb 界面中，当网格细化时，有限元解可能会在一个单元面上产生病态的滑移局部化，因为耗散功仅取决于滑移的大小，而不取决于其沿 $\\Gamma$ 的空间梯度；沿 $\\Gamma$ 添加一个滑移梯度罚项，引入材料长度 $\\ell$，可以恢复适定性并产生网格客观的滑移和耗散分布。\n\nB. 提高罚方法中接触约束的罚参数本身足以消除滑移分布中的网格依赖性，因为更大的罚参数使得约束更硬，从而独立于网格尺寸对解进行正则化。\n\nC. 在摩擦定律中引入与滑移率成正比的微小切向粘性，可以抑制滑移跳跃，并在准静态加载下，随着网格细化产生收敛的解；为了实现网格客观的能量耗散，粘性必须与单元尺寸成比例地选择。\n\nD. 在 $\\Gamma$ 处嵌入一个通过单位面积断裂能 $G_f$ 和峰值剪切强度校准的线性软化内聚区模型，并在达到峰值时与 Coulomb 滑动结合，引入了一个特征过程区长度，使得单位面积的耗散能与网格无关，并将滑移分布在一个客观的长度尺度上。\n\nE. 使用增广拉格朗日法强制执行带 Coulomb 摩擦的接触，保证了滑移分布的网格无关性，因为一旦增广参数固定，Karush-Kuhn-Tucker (KKT) 条件就被精确求解，从而消除了非唯一性的来源。\n\n选择正确的选项。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 域：一个 $2$ 维平面应变连续体域 $\\Omega$。\n- 离散化：一个协调的有限元（FE）网格。\n- 界面：一个预设的、零厚度的摩擦界面 $\\Gamma \\subset \\Omega$。\n- 载荷：准静态剪切载荷。\n- 法向应力：界面上的均匀法向压应力 $\\sigma_n$。\n- 本构律（界面）：具有恒定摩擦系数 $\\mu$ 的率无关 Coulomb 摩擦定律。\n- 摩擦条件：切向牵引力 $\\tau$ 满足 $\\tau \\le \\mu \\sigma_n$。\n- 滑动条件：当 $\\tau = \\mu \\sigma_n$ 时，沿局部切向发生非负滑移率的滑动。\n- 约束：强制执行法向接触约束以防止张开。忽略惯性。\n- 控制原理：\n    1.  线动量平衡：$\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$。\n    2.  运动学：运动学协调的位移场 $\\boldsymbol{u}$。\n    3.  摩擦定律特征：率无关、非关联、耗散的接触定律。\n    4.  能量原理：准静态增量外力功等于增量可恢复应变能与耗散功率之和。\n    5.  关键属性：纯粹的率无关 Coulomb 定律没有引入与 $\\Gamma$ 上滑移梯度相关的内禀长度尺度。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述作为一个问题，在科学上是合理的且适定的。\n- **科学依据**：该问题描述了计算力学中一个著名且根本性的问题，即在使用缺乏内禀长度尺度的本构模型时，模拟局部化现象（如剪切带或摩擦滑移）所产生的病态网格依赖性。所引用的原理（动量平衡、Coulomb 摩擦定律、能量守恒）在连续介质力学和接触力学中都是标准的。\n- **适定性**：问题本身是适定的。它要求对一个已知的数值病态问题进行原因分析，并评估其缓解策略。它不是要求解决一个不适定的问题，而是分析其性质和可能的补救措施（正则化方法）。\n- **客观性**：语言技术性强、精确，没有主观或含糊的术语。\n- **完整性和一致性**：该问题为推理该问题提供了一个完整且一致的概念框架。它正确地指出了导致病态的纯 Coulomb 模型的核心特征——缺乏内禀长度尺度。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。现在开始求解过程。\n\n### 从第一性原理推导\n\n该问题涉及连续体 $\\Omega$ 内摩擦界面 $\\Gamma$ 上的滑移局部化。在准静态条件下，系统的行为由增量意义上的最小势能原理控制。外力所做的总增量功 $d\\mathcal{W}_{ext}$ 必须与体积内储存的弹性应变能的变化 $d\\mathcal{U}$ 以及界面上摩擦耗散的能量 $d\\mathcal{D}$ 相平衡。\n$$d\\mathcal{W}_{ext} = d\\mathcal{U} + d\\mathcal{D}$$\n耗散能增量 $d\\mathcal{D}$ 仅发生在发生滑移的界面 $\\Gamma$ 上。对于滑移增量 $ds$，耗散由 $d\\mathcal{D} = \\int_{\\Gamma} \\tau \\, ds \\, dA$ 给出。\n\n率无关的 Coulomb 摩擦定律指出，只有当剪切牵引力 $\\tau$ 达到其极限 $\\tau = \\mu \\sigma_n$ 时，滑移才能发生。在有限滑移路径 $s$ 上的总耗散能为：\n$$\\mathcal{D} = \\int_{\\Gamma} \\left( \\int_0^s \\mu \\sigma_n \\, ds' \\right) dA$$\n假设在滑移过程中 $\\mu$ 和 $\\sigma_n$ 是恒定的，这可以简化为：\n$$\\mathcal{D} = \\int_{\\Gamma} \\mu \\sigma_n s \\, dA$$\n关键的观察是，耗散能 $\\mathcal{D}$ 仅取决于局部滑移大小 $s$，而与沿界面的空间变化或梯度 $\\nabla_{\\Gamma} s$ 无关。这意味着该模型缺乏一个内禀的材料长度尺度来惩罚滑移分布的急剧变化。\n\n当使用有限元进行离散化时，界面 $\\Gamma$ 由一系列特征尺寸为 $h$ 的面（在二维中为边）表示。耗散能的积分变成这些面上的总和。从能量最小化的角度来看，离散系统将寻求阻力最小的路径。如果需要适应一定的宏观滑移，系统可以通过将滑移分布在许多单元上或将其集中在一个非常小的区域内来实现。因为没有与滑移*梯度*相关的能量惩罚，系统发现将所有变形集中到网格允许的最小可能区域（即单个单元或节点）在能量上是有利的。这最小化了周围体积材料中储存的相关应变能。\n\n随着网格细化（$h \\to 0$），这个局部化滑移区域会成比例地缩小。数值解随网格发生质的变化，预测出一个无限尖锐的滑移区。这导致结果不具有客观性：相邻材料中的峰值应变和总耗散能等量可能不会收敛到一个有意义的物理值。这种现象被称为“病态网格依赖性”，并表明底层的连续介质模型对于局部化问题是不适定的。\n\n为了修正这个问题，必须通过引入一个内禀长度尺度来对模型进行正则化。这确保了形成剪切带或滑移区所需的能量是一个明确定义的材料属性，从而使解具有网格客观性。\n\n### 选项评估\n\n**A. 在一个没有内禀长度尺度的率无关 Coulomb 界面中，当网格细化时，有限元解可能会在一个单元面上产生病态的滑移局部化，因为耗散功仅取决于滑移的大小，而不取决于其沿 $\\Gamma$ 的空间梯度；沿 $\\Gamma$ 添加一个滑移梯度罚项，引入材料长度 $\\ell$，可以恢复适定性并产生网格客观的滑移和耗散分布。**\n该陈述准确地诊断了问题，并提出了一种有效的正则化策略。原因被正确地确定为能量耗散项中缺少对滑移梯度的依赖。引入一个梯度依赖项，例如形式为 $\\int_{\\Gamma} k (\\nabla_{\\Gamma} s)^2 dA$ 的罚项，丰富了连续介质模型。该项惩罚了高滑移梯度，迫使滑移分布在一个与材料长度尺度 $\\ell$（可从 $k$ 和其他材料参数导出）相关的有限宽度上。这使得问题变得适定，并导致滑移分布和能量耗散的网格收敛解。\n**结论：正确。**\n\n**B. 提高罚方法中接触约束的罚参数本身足以消除滑移分布中的网格依赖性，因为更大的罚参数使得约束更硬，从而独立于网格尺寸对解进行正则化。**\n罚方法中的罚参数与运动学约束（例如，法向的非侵入或切向的粘着条件 $\\tau  \\mu\\sigma_n$）的强制执行有关。更高的罚值可以更好地逼近刚性约束。然而，该参数并未改变滑移启动后（即当 $\\tau = \\mu\\sigma_n$ 时）的行为控制本构定律。不适定性源于模型的耗散部分，该部分缺乏长度尺度。罚参数并未引入这样的尺度。因此，增加它不会解决病态的网格依赖性。\n**结论：不正确。**\n\n**C. 在摩擦定律中引入与滑移率成正比的微小切向粘性，可以抑制滑移跳跃，并在准静态加载下，随着网格细化产生收敛的解；为了实现网格客观的能量耗散，粘性必须与单元尺寸成比例地选择。**\n引入粘性（例如，$\\tau = \\mu\\sigma_n + \\eta \\dot{s}$）是一种被称为粘塑性正则化的正则化形式。率相关的项 $\\eta \\dot{s}$ 确实可以正则化控制方程并导致收敛的数值解。然而，陈述的第二部分揭示了一个关键缺陷。一个真正网格客观的模型应仅依赖于与离散化无关的材料参数。粘性参数 $\\eta$ 必须与单元尺寸 $h$ 成比例选择（“$\\eta$ ... 与单元尺寸成比例地选择”）这一论断意味着模型本身随着网格的细化而改变。这是一种算法手段或数值技巧，用以强制得到期望的结果（如特定的总能量耗散），而不是对物理模型的基本正则化。根据定义，其参数依赖于网格尺寸的模型不是网格客观的。\n**结论：不正确。**\n\n**D. 在 $\\Gamma$ 处嵌入一个通过单位面积断裂能 $G_f$ 和峰值剪切强度校准的线性软化内聚区模型，并在达到峰值时与 Coulomb 滑动结合，引入了一个特征过程区长度，使得单位面积的耗散能与网格无关，并将滑移分布在一个客观的长度尺度上。**\n该陈述描述了一种基于物理的正则化方法。内聚区模型（CZM）通过引入包含软化阶段的牵引-分离/滑移关系来丰富界面定律。该曲线下的面积是断裂能 $G_f$，这是一个材料属性，代表创建单位面积新“表面”（或完全发展的滑移面）所需的能量。引入 $G_f$ 和峰值强度 $\\tau_{max}$ 在模型中引入了一个内禀的材料长度尺度（例如，$L_{ch} \\propto E G_f / \\tau_{max}^2$，其中 $E$ 是体积模量）。这个长度尺度控制着滑移局部化的“过程区”的大小。只要网格足够细以解析这个特征长度，滑移分布和总耗散能就变得客观且与网格尺寸无关。\n**结论：正确。**\n\n**E. 使用增广拉格朗日法强制执行带 Coulomb 摩擦的接触，保证了滑移分布的网格无关性，因为一旦增广参数固定，Karush-Kuhn-Tucker (KKT) 条件就被精确求解，从而消除了非唯一性的来源。**\n增广拉格朗日法是求解约束优化问题的数值算法。它在精确执行离散接触问题的 KKT 互补性条件方面非常有效。然而，病态网格依赖性的根源并非离散代数系统求解不准确。问题更为根本：离散系统本身是一个不适定的连续体模型的表示。像增广拉格朗日法这样精确的求解器只会更准确、更稳健地找到病态的、依赖于网格的解；它不会正则化底层的物理。非唯一性和网格依赖性是模型固有的，而非求解器的问题。\n**结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "3512317"}]}