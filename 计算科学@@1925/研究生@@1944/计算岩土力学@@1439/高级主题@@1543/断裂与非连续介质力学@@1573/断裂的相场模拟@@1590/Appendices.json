{"hands_on_practices": [{"introduction": "在解决复杂的断裂问题之前，我们必须理解相场模型的基本构成单元：对尖锐裂纹的正则化表示。本练习运用变分法原理，通过最小化裂纹表面能泛函，推导出一维裂纹的最优稳态剖面。通过这个练习，你将巩固对模型变分基础的理解，并揭示长度尺度参数 $\\ell$ 作为裂纹弥散宽度的物理意义。", "problem": "考虑一个包含位于 $x=0$ 中心的直裂纹的一维无限长弹性杆。在 Ambrosio–Tortorelli (AT) 断裂正则化（AT2 模型）中，裂纹由一个标量相场变量 $d(x) \\in [0,1]$ 表示，其中 $d=1$ 表示完全断裂的材料， $d=0$ 表示完好无损的材料。设临界能量释放率为 $G_c0$，内禀长度尺度为 $\\ell0$。在没有机械载荷的情况下，穿过直裂纹的稳态裂纹轮廓 $d(x)$ 是通过最小化正则化的裂纹表面能泛函\n$$\n\\Psi[d] \\;=\\; \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d(x)^{2}}{2\\,\\ell} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\n得到的，其约束条件为 $d(0)=1$ 和当 $|x|\\to\\infty$ 时 $d(x)\\to 0$。从变分法的第一性原理和上述能量泛函出发，推导裂纹的稳态最优轮廓 $d(x)$。然后，将弥散裂纹的特征宽度定义为 $d(x)$ 的半峰全宽 (FWHM)，即 $d(x)$ 达到值 $1/2$ 的两点之间的距离，并以 $\\ell$ 计算此宽度。以米为单位表示最终宽度。请以闭式解析表达式的形式提供最终答案。不需要进行数值舍入。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n-   **系统**：一个带直裂纹的一维无限长弹性杆。\n-   **模型**：Ambrosio-Tortorelli (AT) 断裂正则化（AT$2$ 模型）。\n-   **相场变量**：$d(x) \\in [0,1]$, 表示裂纹。$d=1$ 表示完全断裂状态，$d=0$ 表示完好无损状态。裂纹中心位于 $x=0$。\n-   **常数**：临界能量释放率 $G_c0$ 和内禀长度尺度 $\\ell0$。\n-   **泛函**：需要最小化的正则化裂纹表面能泛函为\n    $$\n    \\Psi[d] \\;=\\; \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d(x)^{2}}{2\\,\\ell} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x.\n    $$\n-   **边界条件**：$d(0)=1$ 和当 $|x|\\to\\infty$ 时 $d(x)\\to 0$。\n-   **任务 1**：推导稳态最优轮廓 $d(x)$。\n-   **任务 2**：以 $\\ell$ 表示，计算 $d(x)$ 的半峰全宽 (FWHM)。\n-   **任务 3**：以米为单位表示最终宽度。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定的验证标准，对问题进行严格审查。\n\n-   **科学基础**：该问题基于 Ambrosio-Tortorelli 断裂相场模型，这是计算固体力学和地质力学中一个成熟且科学可靠的框架。泛函 $\\Psi[d]$ 是 AT$2$ 模型的标准形式。该问题牢固地植根于连续介质力学和变分法的原理。\n-   **适定性**：该问题是适定的。它要求在明确定义的边界条件下求一个凸泛函的最小值。已知此类问题存在唯一且稳定的解。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n-   **完整性和一致性**：该问题提供了推导所需量所需的所有必要信息（泛函、边界条件和定义）。没有内部矛盾。\n-   **现实性和可行性**：虽然是一个理想化的一维模型，但它代表了一种标准且有意义的简化，用于理解相场断裂模型的基本性质。参数 $G_c$ 和 $\\ell$ 被定义为正数，这在物理上是正确的。要求“以米为单位表示最终宽度”被解释为，得到的宽度符号表达式具有长度量纲，如果 $\\ell$ 以米为单位给出，则宽度将以米为单位计算。这不会使问题无效。\n\n问题验证清单中列出的缺陷均不存在。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解答。\n\n稳态轮廓 $d(x)$ 是使能量泛函 $\\Psi[d]$ 最小化的函数。这是变分法中的一个经典问题。最小化函数必须满足欧拉-拉格朗日方程。\n泛函的被积函数是拉格朗日量 $L(d, d')$，其中 $d' = \\frac{\\mathrm{d}d}{\\mathrm{d}x}$。\n$$\nL(x, d, d') = G_c \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2}(d')^{2} \\right)\n$$\n由于拉格朗日量不显式依赖于 $x$，这是一个保守系统，可以使用贝尔特拉米恒等式。然而，应用标准的欧拉-拉格朗日方程也同样直接：\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0\n$$\n首先，我们计算所需的偏导数：\n$$\n\\frac{\\partial L}{\\partial d} = G_c \\left( \\frac{2d}{2\\ell} \\right) = \\frac{G_c d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = G_c \\left( \\frac{\\ell}{2}(2d') \\right) = G_c \\ell d'\n$$\n接下来，我们求第二项关于 $x$ 的全导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(G_c \\ell d') = G_c \\ell d''\n$$\n将这些表达式代入欧拉-拉格朗日方程，我们得到：\n$$\n\\frac{G_c d}{\\ell} - G_c \\ell d'' = 0\n$$\n常数 $G_c$ 是正的，所以我们可以用它来除。整理各项得到一个二阶线性齐次常系数微分方程：\n$$\n\\ell^{2} d'' - d = 0 \\quad \\implies \\quad d'' - \\frac{1}{\\ell^{2}} d = 0\n$$\n这个常微分方程的特征方程是 $r^2 - \\frac{1}{\\ell^2} = 0$，其根为 $r_1 = \\frac{1}{\\ell}$ 和 $r_2 = -\\frac{1}{\\ell}$。\n因此，通解的形式为：\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是待由边界条件确定的常数。\n\n边界条件是 $d(0)=1$ 和当 $|x| \\to \\infty$ 时 $d(x) \\to 0$。我们必须小心地应用无穷远处的条件。\n为了使解在 $x \\to \\infty$ 时衰减到 $0$，必须消除无界增长的项 $\\exp(x/\\ell)$。这要求 $C_1 = 0$。因此对于 $x > 0$，解必须是 $d(x) = C_2 \\exp(-x/\\ell)$ 的形式。\n为了使解在 $x \\to -\\infty$ 时衰减到 $0$，必须消除无界增长的项 $\\exp(-x/\\ell)$。这要求 $C_2 = 0$。因此对于 $x  0$，解必须是 $d(x) = C_1 \\exp(x/\\ell)$ 的形式。\n\n让我们应用中心处的条件，$d(0)=1$。\n对于在 $x > 0$ 上有效的解，我们有 $d(x) = C_2 \\exp(-x/\\ell)$。从右侧趋近 $x=0$，得到 $d(0) = C_2 \\exp(0) = C_2$。所以，$C_2=1$。\n对于在 $x  0$ 上有效的解，我们有 $d(x) = C_1 \\exp(x/\\ell)$。从左侧趋近 $x=0$，得到 $d(0) = C_1 \\exp(0) = C_1$。所以，$C_1=1$。\n\n结合这些结果，解为：\n$$\nd(x) = \\begin{cases} \\exp(-x/\\ell)  \\text{if } x \\ge 0 \\\\ \\exp(x/\\ell)  \\text{if } x  0 \\end{cases}\n$$\n这个分段函数可以使用绝对值函数更紧凑地写成：\n$$\nd(x) = \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\n这就是相场变量 $d(x)$ 的稳态最优轮廓。\n\n接下来，我们计算此轮廓的半峰全宽 (FWHM)。$d(x)$ 的最大值出现在 $x=0$ 处，此时 $d(0) = \\exp(0) = 1$。因此，半峰值为 $1/2$。\n我们需要找到使 $d(x) = 1/2$ 成立的 $x$ 值。\n$$\n\\exp\\left(-\\frac{|x|}{\\ell}\\right) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{|x|}{\\ell} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n|x| = \\ell \\ln(2)\n$$\n该方程给出两个 $x$ 的解：$x_1 = -\\ell \\ln(2)$ 和 $x_2 = \\ell \\ln(2)$。\nFWHM 定义为这两点之间的距离：\n$$\n\\text{FWHM} = x_2 - x_1 = \\ell \\ln(2) - (-\\ell \\ln(2)) = 2\\ell \\ln(2)\n$$\n这就是以长度尺度参数 $\\ell$ 表示的弥散裂纹的特征宽度。问题要求“以米为单位表示最终宽度”。由于 $\\ell$ 是一个内禀长度尺度，它具有长度的单位。如果 $\\ell$ 以米为单位给出，则表达式 $2\\ell\\ln(2)$ 直接给出以米为单位的宽度。结果是一个符号表达式，而不是一个数值，因为没有给出 $\\ell$ 的值。\n\n最终答案是推导出的轮廓 $d(x)$ 和 FWHM 的表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp\\left(-\\frac{|x|}{\\ell}\\right)  2\\ell\\ln(2) \\end{pmatrix}}\n$$", "id": "3550312"}, {"introduction": "任何断裂模型的一个关键考验是其预测材料强度的能力。本练习旨在弥合相场模型参数与这一关键宏观属性之间的鸿沟。通过分析均质材料在拉伸作用下的稳定性，我们可以推导出抗拉强度 $\\sigma_c$ 的解析表达式。此练习将展示材料破坏如何作为位移-损伤耦合系统中的一种不稳定性而出现，并突显不同模型（如AT1和AT2模型）之间的关键差异，尤其是在损伤形核阈值的存在性方面。", "problem": "考虑一根一维、无限长、单位横截面积的线弹性杆，承受远场均匀拉伸。小应变位移场为 $u(x)$，标量相场（损伤）变量为 $d(x) \\in [0,1]$，其中 $d=0$ 表示完好无损，$d=1$ 表示完全断裂。退化的弹性刚度通过标准二次退化函数 $g(d) = (1 - d)^{2}$ 来建模。弹性应变为 $\\varepsilon(x) = u'(x)$，拉伸状态下的弹性应变能密度为 $\\psi_{e}(\\varepsilon,d) = \\tfrac{1}{2}\\,g(d)\\,E\\,\\varepsilon^{2}$，其中 $E$ 是杨氏模量。断裂能通过 Ambrosio–Tortorelli 泛函进行正则化\n$$\n\\Gamma_{\\ell}[d] = \\int_{-\\infty}^{\\infty} \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,|d'(x)|^{2} \\right)\\,\\mathrm{d}x,\n$$\n其中 $G_{c}$ 是临界能量释放率，$\\ell$ 是内禀长度尺度，$w(d)$ 是裂纹面密度函数。裂纹密度归一化常数 $c_{w}$ 的选取使得一维稳态裂纹剖面的能量为 $\\Gamma_{\\ell} = G_{c}$，即：\n$$\nc_{w} = 2 \\int_{0}^{1} \\sqrt{w(s)}\\,\\mathrm{d}s.\n$$\n考虑两种典型的选择：Ambrosio–Tortorelli 二次模型 (AT2)，其中 $w(d) = d^{2}$；以及 Ambrosio–Tortorelli 线性模型 (AT1)，其中 $w(d) = d$。对于这两种选择，我们有 $c_{w}^{\\mathrm{AT2}} = 1$ 和 $c_{w}^{\\mathrm{AT1}} = \\tfrac{4}{3}$。\n\n在名义应力 $\\sigma$（在 $x$ 上为常数）的远场应力控制下，需要对 $d(x)$ 最小化的恰当势函数是焓泛函\n$$\n\\Pi_{\\sigma}[d] = \\int_{-\\infty}^{\\infty} \\left( -\\,\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,|d'(x)|^{2} \\right) \\right)\\,\\mathrm{d}x,\n$$\n其约束条件为 $d(\\pm \\infty) = 0$ 和 $d'(0) = 0$，对应于以 $x=0$ 为中心的对称局部化。\n\n从这些定义和变分法出发，并且不引用任何预先制表的强度公式，完成以下任务：\n\n1. 根据欧拉-拉格朗日方程的第一积分，推导非平凡局部化稳态损伤剖面存在的条件。利用此条件，将损伤剖面的转折点成为二重根时的应力作为最大许用远场应力（抗拉强度）$\\sigma_{c}$ 的判据，并推导该判据。\n\n2. 将你的推导应用于 AT2 模型，并获得 $\\sigma_{c}$ 关于 $E$、$G_{c}$ 和 $\\ell$ 的闭式解析表达式。\n\n3. 对 AT1 模型重复此分析，并确定是否存在有限的损伤形核阈值。给出相应的解析表达式，并解释对于 AT1 模型，抗拉强度是否与形核阈值重合。\n\n用 $E$、$G_{c}$ 和 $\\ell$ 的精确解析表达式来表示你的最终答案。不要代入数值，最终的方框答案中也不要包含单位。", "solution": "本问题要求在相场断裂力学框架内，针对 AT2 和 AT1 两种不同模型，推导一维杆的抗拉强度。\n\n该分析基于对给定远场应力 $\\sigma$ 下的焓泛函 $\\Pi_{\\sigma}[d]$ 进行最小化。\n$$\n\\Pi_{\\sigma}[d] = \\int_{-\\infty}^{\\infty} L(d, d')\\,\\mathrm{d}x\n$$\n其中拉格朗日量 $L(d, d')$ 由下式给出：\n$$\nL(d, d') = -\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,(d')^{2} \\right)\n$$\n其中 $g(d) = (1 - d)^{2}$。\n\n### 第一部分：稳态条件和抗拉强度判据的一般推导\n\n泛函 $\\Pi_{\\sigma}[d]$ 的欧拉-拉格朗日方程为 $\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0$。由于拉格朗日量 $L$ 不显式地依赖于空间坐标 $x$，我们可以使用贝尔特拉米恒等式（欧拉-拉格朗日方程的一个第一积分），其表述为：\n$$\nL - d' \\frac{\\partial L}{\\partial d'} = C\n$$\n其中 $C$ 是一个常数。首先，我们计算 $L$ 对 $d'$ 的偏导数：\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{G_{c}}{c_{w}} \\ell (2d')\n$$\n将此式代入贝尔特拉米恒等式：\n$$\n\\left( -\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,(d')^{2} \\right) \\right) - d' \\left( \\frac{G_{c}}{c_{w}} 2\\ell d' \\right) = C\n$$\n$$\n-\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\frac{w(d)}{\\ell} - \\frac{G_{c}}{c_{w}} \\ell\\,(d')^{2} = C\n$$\n常数 $C$ 由局部化解的边界条件确定，即当 $x \\to \\pm\\infty$ 时，$d(x) \\to 0$ 且 $d'(x) \\to 0$。我们还知道，对于 AT1 ($w(d)=d$) 和 AT2 ($w(d)=d^2$) 两种模型，都有 $w(0)=0$。应用这些条件：\n$$\nC = -\\frac{\\sigma^{2}}{2\\,E\\,g(0)} + \\frac{G_{c}}{c_{w}} \\frac{w(0)}{\\ell} - 0 = -\\frac{\\sigma^{2}}{2\\,E\\,(1-0)^{2}} = -\\frac{\\sigma^{2}}{2\\,E}\n$$\n将 $C$ 代回，我们得到稳态损伤剖面的运动第一积分：\n$$\n-\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\frac{w(d)}{\\ell} - \\frac{G_{c}}{c_{w}} \\ell\\,(d')^{2} = -\\frac{\\sigma^{2}}{2\\,E}\n$$\n该方程表示稳态损伤剖面存在的条件。我们将其重新整理以求解 $(d')^2$：\n$$\n\\frac{G_c}{c_w} \\ell (d')^2 = \\frac{G_c}{c_w} \\frac{w(d)}{\\ell} - \\frac{\\sigma^2}{2E}\\left( \\frac{1}{g(d)} - 1 \\right)\n$$\n我们定义一个势函数 $F(d, \\sigma)$，使得 $\\ell^2(d')^2 \\propto F(d, \\sigma)$。经过整理，我们可以将运动方程写成 $\\frac{G_c}{c_w} \\ell (d')^2 = F(d, \\sigma)$，其中\n$$\nF(d, \\sigma) = \\frac{G_c}{c_w} \\frac{w(d)}{\\ell} - \\frac{\\sigma^2}{2E}\\frac{d(2-d)}{(1-d)^2}\n$$\n为了使一个实的、非平凡的解存在，我们必须在解的范围内有 $F(d, \\sigma) \\ge 0$，即对于 $d \\in [0, d_{\\max}]$，其中 $d_{\\max}$ 是局部化中心 $x=0$ 处的损伤值。在该点，$d'(0)=0$，这意味着 $F(d_{\\max}, \\sigma)=0$。\n抗拉强度 $\\sigma_c$ 是材料能承受的最大应力。这对应于 $\\sigma$ vs. $d_{\\max}$ 曲线的峰值。该峰值的特征是 $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}d_{\\max}}=0$。在数学上，这个条件等价于转折点 $d_{\\max}$ 成为 $F(d, \\sigma_c) = 0$ 的一个二重根。设这个临界损伤值为 $d_c$。条件是：\n$$\nF(d_c, \\sigma_c) = 0 \\quad \\text{和} \\quad \\frac{\\partial F}{\\partial d}(d_c, \\sigma_c) = 0\n$$\n我们来计算导数 $\\frac{\\partial F}{\\partial d}$：\n$$\n\\frac{\\partial F}{\\partial d} = \\frac{G_c}{c_w \\ell}w'(d) - \\frac{\\sigma^2}{2E} \\frac{\\mathrm{d}}{\\mathrm{d}d}\\left(\\frac{2d-d^2}{(1-d)^2}\\right)\n$$\n该有理函数的导数为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}d}\\left(\\frac{2d-d^2}{(1-d)^2}\\right) = \\frac{(2-2d)(1-d)^2 - (2d-d^2) \\cdot 2(1-d)(-1)}{((1-d)^2)^2} = \\frac{2(1-d)^3 + 2(1-d)(2d-d^2)}{(1-d)^4} = \\frac{2(1-d)^2 + 2(2d-d^2)}{(1-d)^3} = \\frac{2}{(1-d)^3}\n$$\n所以，导数是：\n$$\n\\frac{\\partial F}{\\partial d} = \\frac{G_c}{c_w \\ell}w'(d) - \\frac{\\sigma^{2}}{E} \\frac{1}{(1-d)^3}\n$$\n求解 $\\sigma_c$ 和 $d_c$ 的方程组是：\n1) $F(d_c, \\sigma_c) = 0 \\implies \\frac{G_c}{c_w \\ell}w(d_c) - \\frac{\\sigma_c^{2}}{2 E} \\frac{d_c(2-d_c)}{(1-d_c)^2} = 0$\n2) $\\frac{\\partial F}{\\partial d}(d_c, \\sigma_c) = 0 \\implies \\frac{G_c}{c_w \\ell}w'(d_c) - \\frac{\\sigma_c^{2}}{E} \\frac{1}{(1-d_c)^3} = 0$\n\n从方程 (2) 中，我们可以表示出应力项：\n$$\n\\sigma_c^{2} = \\frac{E G_c}{c_w \\ell} w'(d_c) (1-d_c)^3\n$$\n将此式代入方程 (1)：\n$$\n\\frac{G_c}{c_w \\ell}w(d_c) - \\frac{1}{2 E} \\left( \\frac{E G_c}{c_w \\ell} w'(d_c) (1-d_c)^3 \\right) \\frac{d_c(2-d_c)}{(1-d_c)^2} = 0\n$$\n$$\nw(d_c) - \\frac{1}{2} w'(d_c) d_c(1-d_c)(2-d_c) = 0\n$$\n这个方程决定了抗拉强度下的临界损伤 $d_c$。一旦求出 $d_c$，抗拉强度 $\\sigma_c$ 可由下式得到：\n$$\n\\sigma_c^2 = \\frac{E G_c}{c_w \\ell} w'(d_c) (1-d_c)^3\n$$\n\n### 第二部分：应用于 AT2 模型\n\n对于 AT2 模型，我们有 $w(d) = d^2$，$w'(d) = 2d$ 和 $c_w = 1$。\n将这些代入求解 $d_c$ 的方程：\n$$\nd_c^2 - \\frac{1}{2}(2d_c)d_c(1-d_c)(2-d_c) = 0\n$$\n$$\nd_c^2 \\left[1 - (1-d_c)(2-d_c)\\right] = 0\n$$\n这给出了一个平凡解 $d_c=0$ 或非平凡条件：\n$$\n1 - (2 - 3d_c + d_c^2) = 0 \\implies d_c^2 - 3d_c + 1 = 0\n$$\n这个二次方程的根是 $d_c = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n由于 $d \\in [0,1]$，我们必须选择较小的根：\n$$\nd_c = \\frac{3 - \\sqrt{5}}{2} \\approx 0.382\n$$\n现在，我们使用 $\\sigma_c^2$ 的表达式，其中 $c_w = 1$ 和 $w'(d_c)=2d_c$，来求解 $\\sigma_c$：\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} (2d_c) (1-d_c)^3\n$$\n我们有 $d_c = \\frac{3 - \\sqrt{5}}{2}$ 和 $1-d_c = 1 - \\frac{3 - \\sqrt{5}}{2} = \\frac{-1 + \\sqrt{5}}{2}$。\n我们来计算 $2d_c(1-d_c)^3$ 这一项：\n$$\n(1-d_c)^3 = \\left(\\frac{\\sqrt{5}-1}{2}\\right)^3 = \\frac{(\\sqrt{5})^3 - 3(\\sqrt{5})^2(1) + 3\\sqrt{5}(1)^2 - 1^3}{8} = \\frac{5\\sqrt{5} - 15 + 3\\sqrt{5} - 1}{8} = \\frac{8\\sqrt{5}-16}{8} = \\sqrt{5}-2\n$$\n$$\n2d_c(1-d_c)^3 = 2\\left(\\frac{3-\\sqrt{5}}{2}\\right)(\\sqrt{5}-2) = (3-\\sqrt{5})(\\sqrt{5}-2) = 3\\sqrt{5} - 6 - 5 + 2\\sqrt{5} = 5\\sqrt{5}-11\n$$\n因此，AT2 模型的抗拉强度为：\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} (5\\sqrt{5} - 11) \\implies \\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}(5\\sqrt{5} - 11)}\n$$\n\n### 第三部分：应用于 AT1 模型\n\n对于 AT1 模型，我们有 $w(d) = d$，$w'(d) = 1$ 和 $c_w = 4/3$。\n首先，我们研究损伤形核阈值的存在性。只有当势函数 $F(d, \\sigma)$ 对于无穷小的 $d0$ 为非负时，损伤过程才能从完好状态 $d=0$ 开始萌生。这要求在 $d=0$ 处的斜率为非负，即 $\\frac{\\partial F}{\\partial d}(0, \\sigma) \\ge 0$。\n$$\n\\frac{\\partial F}{\\partial d}(0, \\sigma) = \\frac{G_c}{c_w \\ell}w'(0) - \\frac{\\sigma^{2}}{E} \\frac{1}{(1-0)^3} = \\frac{G_c}{(4/3)\\ell}(1) - \\frac{\\sigma^2}{E} = \\frac{3G_c}{4\\ell} - \\frac{\\sigma^2}{E}\n$$\n令其 $\\ge 0$ 给出损伤形核的应力条件：\n$$\n\\frac{3G_c}{4\\ell} - \\frac{\\sigma^2}{E} \\ge 0 \\implies \\sigma^2 \\le \\frac{3 E G_c}{4 \\ell}\n$$\n这意味着对于应力 $\\sigma  \\sigma_{\\text{nuc}} = \\sqrt{\\frac{3 E G_c}{4 \\ell}}$，完好状态是不稳定的，损伤将会形核。在 $\\sigma = \\sigma_{\\text{nuc}}$ 时，一条损伤路径开启。这就是损伤形核阈值。\n\n接下来，我们检查抗拉强度是否与此阈值重合。我们通过应用一般判据 $w(d_c) - \\frac{1}{2} w'(d_c) d_c(1-d_c)(2-d_c) = 0$ 来寻找峰值载荷。\n$$\nd_c - \\frac{1}{2}(1)d_c(1-d_c)(2-d_c) = 0\n$$\n$$\nd_c \\left[1 - \\frac{1}{2}(1-d_c)(2-d_c)\\right] = 0\n$$\n一个解是平凡解 $d_c=0$。另一个解来自方括号内的项：\n$$\n1 = \\frac{1}{2}(1-d_c)(2-d_c) \\implies 2 = 2 - 3d_c + d_c^2 \\implies d_c^2 - 3d_c = 0\n$$\n这得到 $d_c(d_c-3)=0$，其解为 $d_c=0$ 和 $d_c=3$。这两个解都不在物理范围 $(0,1]$ 内，因此都不是有效的临界损伤状态。\n$d_c \\in (0,1]$ 无解意味着应力-损伤曲线 $\\sigma(d_{\\max})$ 在形核后没有最大值（峰值载荷）。为了证实这一点，我们可以从条件 $F(d_{\\max}, \\sigma)=0$ 出发，考察函数 $\\sigma^2(d_{\\max})$。\n$\\sigma^2(d_{\\max}) \\propto \\frac{w(d_{\\max})(1-d_{\\max})^2}{d_{\\max}(2-d_{\\max})} = \\frac{d_{\\max}(1-d_{\\max})^2}{d_{\\max}(2-d_{\\max})} = \\frac{(1-d_{\\max})^2}{2-d_{\\max}}$。\n$h(d) = \\frac{(1-d)^2}{2-d}$ 在 $d\\in(0,1)$ 上的导数为 $h'(d) = \\frac{-2(1-d)(2-d) - (1-d)^2(-1)}{(2-d)^2} = \\frac{(1-d)(-2(2-d)+(1-d))}{(2-d)^2} = \\frac{(1-d)(d-3)}{(2-d)^2}  0$。\n由于这个函数在 $d \\in (0,1)$ 上是严格递减的，最大应力出现在可能的最低损伤处，即在损伤形核开始时 ($d_{\\max} \\to 0$）。\n因此，对于 AT1 模型，抗拉强度 $\\sigma_c$ 与损伤形核阈值 $\\sigma_{\\text{nuc}}$ 重合。\n$$\n\\sigma_c = \\sigma_{\\text{nuc}} = \\sqrt{\\frac{3 E G_c}{4 \\ell}}\n$$\n最终答案包含 AT2 和 AT1 两种模型抗拉强度 $\\sigma_c$ 的解析表达式。\n\n对于 AT2： $\\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}(5\\sqrt{5} - 11)}$\n对于 AT1： $\\sigma_c = \\sqrt{\\frac{3 E G_c}{4 \\ell}}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{E G_{c}}{\\ell}(5\\sqrt{5} - 11)}  \\sqrt{\\frac{3 E G_{c}}{4 \\ell}}\n\\end{pmatrix}\n}\n$$", "id": "3550301"}, {"introduction": "大多数脆性材料（如岩石）在拉伸和压缩下的行为不同。一个真实的断裂模型必须能够捕捉这种不对称性，防止在纯压缩状态下损伤的演化。本计算实践将探索并比较两种实现拉压不对称性的常用策略：应变张量的谱分解和基于应力的开关。通过在各种加载条件下实施和测试这些策略，你将获得关于实际相场建模关键方面的实践经验，并理解在复杂地质力学场景中确保物理上有意义的模拟结果的细微之处。", "problem": "设计并实现一个单点计算实验，用于比较在三轴压缩条件下脆性断裂相场模拟中的两种退化策略。考虑一个杨氏模量为 $\\mathrm{E}$、泊松比为 $\\nu$ 的小应变、线弹性、各向同性固体，并使用 Ambrosio-Tortorelli (AT-2) 裂纹面密度正则化。标量相场（损伤）变量为 $d \\in [0,1]$，弹性退化函数为 $g(d) = (1 - d)^{2} + \\kappa$，其中 $\\kappa$ 是一个小的残余刚度。你将在单个材料点上进行计算，忽略裂纹面泛函中的梯度项，但必须通过裂纹面密度罚项保留长度尺度 $\\ell$，以确保单位一致性。\n\n从以下基本理论出发：\n- 小应变运动学：无穷小应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$，其中 $\\mathbf{u}$ 是位移场。\n- 各向同性材料的线弹性本构律（胡克定律）：$\\boldsymbol{\\sigma} = \\lambda\\, \\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$，其中拉梅参数为 $\\lambda = \\dfrac{\\mathrm{E}\\,\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{\\mathrm{E}}{2(1+\\nu)}$，体积模量为 $\\mathrm{K} = \\lambda + \\dfrac{2}{3}\\mu$。此处，$\\mathbf{I}$ 是单位张量，$\\mathrm{tr}(\\cdot)$ 是迹，$\\boldsymbol{\\sigma}$ 是柯西应力张量。\n- 八面体剪应力为 $\\tau_{\\mathrm{oct}} = \\sqrt{\\dfrac{1}{3}\\,\\mathbf{s}:\\mathbf{s}}$，其中 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\sigma_{\\mathrm{m}}\\mathbf{I}$ 是偏应力，$\\sigma_{\\mathrm{m}} = \\dfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 是平均应力。双点积表示弗罗贝尼乌斯内积。\n\n对于每个给定的应变状态，考虑以下损伤驱动能的选择：\n- 策略 $\\mathrm{S}$（谱分解，仅受拉）：对 $\\boldsymbol{\\varepsilon}$ 进行谱分解，令 $\\boldsymbol{\\varepsilon}_{+}$ 是由正主应变构建的正部，并定义\n$$\n\\psi_{0,\\mathrm{S}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\lambda\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+},\n$$\n其中 $\\langle x \\rangle_{+} = \\max(x,0)$ 是麦考利括号。\n- 策略 $\\mathrm{O}$（基于八面体应力的偏量开关）：定义偏应变 $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I}$，计算 $\\boldsymbol{\\sigma}$、$\\sigma_{\\mathrm{m}}$ 和 $\\tau_{\\mathrm{oct}}$，并设置\n$$\nS_{\\mathrm{oct}} =\n\\begin{cases}\n1,  \\text{if } \\sigma_{\\mathrm{m}} \\ge 0 \\text{ and } \\tau_{\\mathrm{oct}} \\ge \\tau_{\\mathrm{th}},\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n阈值为 $\\tau_{\\mathrm{th}} = 0$。然后取\n$$\n\\psi_{0,\\mathrm{O}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\mathrm{K}\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + S_{\\mathrm{oct}}\\,\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}.\n$$\n\n使用标准的能量驱动，并带有一个不可逆历史场 $H$ 来存储迄今为止的最大受拉驱动能，并局部最小化正则化能量密度\n$$\n\\psi(d) = g(d)\\,H + \\dfrac{G_{\\mathrm{c}}}{2\\ell}\\,d^{2},\n$$\n约束条件为 $d \\in [0,1]$ 和 $d$ 非递减。此处，$G_{\\mathrm{c}}$ 是临界能量释放率。你必须通过施加带不可逆性的一阶最优性条件，从无损状态开始，为每个策略获取更新后的 $d$。不要引入任何超出指定范围的特设上限或调整。所有应力单位必须是 $\\mathrm{Pa}$，应变是无量纲的，$G_{\\mathrm{c}}$ 的单位是 $\\mathrm{N/m}$，$\\ell$ 的单位是 $\\mathrm{m}$。$d$ 的最终值是无量纲的。将程序的数值输出表示为四舍五入到 $6$ 位小数。\n\n参数：\n- $\\mathrm{E} = 3.0 \\times 10^{10}\\ \\mathrm{Pa}$，\n- $\\nu = 0.25$，\n- $G_{\\mathrm{c}} = 1.0 \\times 10^{3}\\ \\mathrm{N/m}$，\n- $\\ell = 1.0 \\times 10^{-2}\\ \\mathrm{m}$，\n- $\\kappa = 1.0 \\times 10^{-8}$，\n- $\\tau_{\\mathrm{th}} = 0$。\n\n测试组：对以下 $5$ 个给定的无量纲小应变状态 $\\boldsymbol{\\varepsilon}$（以对称张量形式给出），评估这两种策略：\n- 情况 1（静水压缩）：$\\boldsymbol{\\varepsilon} = \\mathrm{diag}(-1.0\\times 10^{-3},-1.0\\times 10^{-3},-1.0\\times 10^{-3})$。\n- 情况 2（带剪切的三轴压缩）：$\\boldsymbol{\\varepsilon} = \\begin{bmatrix}-5.0\\times 10^{-4}  1.5\\times 10^{-3}  0\\\\ 1.5\\times 10^{-3}  -5.0\\times 10^{-4}  0\\\\ 0  0  -5.0\\times 10^{-4}\\end{bmatrix}$。\n- 情况 3（静水拉伸）：$\\boldsymbol{\\varepsilon} = \\mathrm{diag}(5.0\\times 10^{-4},5.0\\times 10^{-4},5.0\\times 10^{-4})$。\n- 情况 4（纯剪切）：$\\boldsymbol{\\varepsilon} = \\begin{bmatrix}0  1.0\\times 10^{-3}  0\\\\ 1.0\\times 10^{-3}  0  0\\\\ 0  0  0\\end{bmatrix}$。\n- 情况 5（近零量值，压缩性平均应力，微小剪切）：$\\boldsymbol{\\varepsilon} = \\begin{bmatrix}-1.0\\times 10^{-8}  1.0\\times 10^{-8}  0\\\\ 1.0\\times 10^{-8}  -1.0\\times 10^{-8}  0\\\\ 0  0  -1.0\\times 10^{-8}\\end{bmatrix}$。\n\n对于每种情况，计算两个损伤值：使用 $\\psi_{0,\\mathrm{S}}^{+}$ 计算 $d_{\\mathrm{S}}$ 和使用 $\\psi_{0,\\mathrm{O}}^{+}$ 计算 $d_{\\mathrm{O}}$，两者都从 $H=0$ 开始，在给定的应变下，通过单个伪时间步施加不可逆性。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序为 $[d_{\\mathrm{S}}^{(1)}, d_{\\mathrm{O}}^{(1)}, d_{\\mathrm{S}}^{(2)}, d_{\\mathrm{O}}^{(2)}, d_{\\mathrm{S}}^{(3)}, d_{\\mathrm{O}}^{(3)}, d_{\\mathrm{S}}^{(4)}, d_{\\mathrm{O}}^{(4)}, d_{\\mathrm{S}}^{(5)}, d_{\\mathrm{O}}^{(5)}]$，每个值四舍五入到 $6$ 位小数，并且没有附加文本。输出为无量纲浮点数。", "solution": "用户要求设计并实现一个单点计算实验，以比较两种用于脆性断裂的相场退化策略。该问题定义明确，具有科学依据，并包含唯一解所需的所有必要信息。我们着手进行推导和实现。\n\n问题的核心是针对给定的应变张量 $\\boldsymbol{\\varepsilon}$，计算一个材料点的损伤变量 $d$。这是通过最小化一个局部能量泛函来实现的。该过程从一个无损状态（$d=0$）和零历史场（$H=0$）开始。在单个步骤中施加给定的应变，这定义了历史场的新值。\n\n首先，我们根据给定的杨氏模量 $\\mathrm{E} = 3.0 \\times 10^{10}\\ \\mathrm{Pa}$ 和泊松比 $\\nu = 0.25$ 计算必要的弹性常数。\n拉梅参数 $\\lambda$ 和 $\\mu$ 为：\n$$\n\\lambda = \\dfrac{\\mathrm{E}\\,\\nu}{(1+\\nu)(1-2\\nu)} = \\dfrac{(3.0 \\times 10^{10})(0.25)}{(1+0.25)(1-2 \\cdot 0.25)} = \\dfrac{7.5 \\times 10^{9}}{1.25 \\cdot 0.5} = 1.2 \\times 10^{10}\\ \\mathrm{Pa}\n$$\n$$\n\\mu = \\dfrac{\\mathrm{E}}{2(1+\\nu)} = \\dfrac{3.0 \\times 10^{10}}{2(1+0.25)} = \\dfrac{3.0 \\times 10^{10}}{2.5} = 1.2 \\times 10^{10}\\ \\mathrm{Pa}\n$$\n体积模量 $\\mathrm{K}$ 为：\n$$\n\\mathrm{K} = \\lambda + \\dfrac{2}{3}\\mu = 1.2 \\times 10^{10} + \\dfrac{2}{3}(1.2 \\times 10^{10}) = 2.0 \\times 10^{10}\\ \\mathrm{Pa}\n$$\n\n损伤演化由正则化能量密度 $\\psi(d)$ 的局部最小化所控制，其中 $d \\in [0,1]$ 是损伤变量：\n$$\n\\psi(d) = g(d)\\,H + \\dfrac{G_{\\mathrm{c}}}{2\\ell}\\,d^{2}\n$$\n此处，$g(d) = (1-d)^2 + \\kappa$ 是退化函数，$H$ 是表示迄今为止所经历的最大损伤驱动能的历史场，$G_{\\mathrm{c}} = 1.0 \\times 10^{3}\\ \\mathrm{N/m}$ 是临界能量释放率，$\\ell = 1.0 \\times 10^{-2}\\ \\mathrm{m}$ 是长度尺度参数。对于从无损状态（$d=0, H=0$）开始的单步分析，新的历史值为 $H = \\psi_0^+(\\boldsymbol{\\varepsilon})$，其中 $\\psi_0^+$ 是给定应变 $\\boldsymbol{\\varepsilon}$ 下弹性应变能密度的驱动部分。\n\n为了找到更新后的损伤值 $d$，我们必须在 $d \\in [0,1]$ 和不可逆性约束（通过使用迄今为止最大的历史场 $H$ 来隐式处理）的条件下，找到 $\\psi(d)$ 的最小值。一阶最优性条件是 $\\dfrac{\\partial\\psi}{\\partial d} = 0$：\n$$\n\\dfrac{\\partial\\psi}{\\partial d} = \\dfrac{\\partial}{\\partial d} \\left( ((1-d)^2 + \\kappa)H + \\dfrac{G_{\\mathrm{c}}}{2\\ell}d^2 \\right) = -2(1-d)H + \\dfrac{G_{\\mathrm{c}}}{\\ell}d = 0\n$$\n求解无约束最小化子 $d_{\\mathrm{unc}}$：\n$$\n2H - 2Hd + \\dfrac{G_{\\mathrm{c}}}{\\ell}d = 0 \\implies d\\left(2H + \\dfrac{G_{\\mathrm{c}}}{\\ell}\\right) = 2H \\implies d_{\\mathrm{unc}} = \\dfrac{2H}{2H + G_{\\mathrm{c}}/\\ell} = \\dfrac{H}{H + G_{\\mathrm{c}}/(2\\ell)}\n$$\n由于 $H = \\psi_0^+ \\ge 0$，$G_{\\mathrm{c}}  0$ 且 $\\ell  0$，我们有 $0 \\le d_{\\mathrm{unc}}  1$。因此，约束条件 $d \\in [0,1]$ 被 $d_{\\mathrm{unc}}$ 满足。$d$ 的解因此由这个闭式表达式给出。我们定义常数罚项系数 $C = \\dfrac{G_{\\mathrm{c}}}{2\\ell} = \\dfrac{1.0 \\times 10^3}{2 \\times 1.0 \\times 10^{-2}} = 5 \\times 10^4\\ \\mathrm{J/m^3}$。那么损伤为 $d = \\dfrac{H}{H+C}$。\n\n这两种策略的不同之处在于如何计算驱动能 $\\psi_0^+$（即 $H$）。\n\n**策略 S：谱分解**\n该策略假定只有拉伸应变对损伤有贡献。驱动能为：\n$$\n\\psi_{0,\\mathrm{S}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\lambda\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}\n$$\n为了计算这个值，我们对应变张量 $\\boldsymbol{\\varepsilon}$ 进行谱分解，以找到其主应变（特征值）$\\varepsilon_1, \\varepsilon_2, \\varepsilon_3$。应变张量的正部 $\\boldsymbol{\\varepsilon}_{+}$ 是利用这些特征值的正部构建的。然后，弗罗贝尼乌斯内积为 $\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+} = \\sum_{i=1}^3 \\langle\\varepsilon_i\\rangle_+^2$。麦考利括号为 $\\langle x \\rangle_{+} = \\max(x,0)$。\n\n**策略 O：基于八面体应力的偏量开关**\n该策略根据应力状态（拉伸平均应力和剪切）激活偏量损伤。驱动能为：\n$$\n\\psi_{0,\\mathrm{O}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\mathrm{K}\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + S_{\\mathrm{oct}}\\,\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}\n$$\n其中 $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I}$ 是偏应变张量。开关 $S_{\\mathrm{oct}}$ 定义为：\n$$\nS_{\\mathrm{oct}} = 1 \\quad \\text{if } \\sigma_{\\mathrm{m}} \\ge 0 \\text{ and } \\tau_{\\mathrm{oct}} \\ge \\tau_{\\mathrm{th}} \\quad (\\text{with } \\tau_{\\mathrm{th}}=0), \\quad \\text{else } S_{\\mathrm{oct}} = 0.\n$$\n需要平均应力 $\\sigma_{\\mathrm{m}}$ 和八面体剪应力 $\\tau_{\\mathrm{oct}}$。这些可以直接与应变不变量相关联：\n$$\n\\sigma_{\\mathrm{m}} = \\mathrm{K}\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\n$$\n偏应力为 $\\mathbf{s} = 2\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}$。因此，八面体剪应力为：\n$$\n\\tau_{\\mathrm{oct}} = \\sqrt{\\dfrac{1}{3}\\,\\mathbf{s}:\\mathbf{s}} = \\sqrt{\\dfrac{1}{3}\\,(2\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}):(2\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}})} = 2\\mu\\sqrt{\\dfrac{\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}}{3}}\n$$\n其中 $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} = \\sum_{i,j} (\\varepsilon_{\\mathrm{dev},ij})^2$。\n\n对于每个测试案例，我们计算 $H_S = \\psi_{0,\\mathrm{S}}^{+}(\\boldsymbol{\\varepsilon})$ 和 $H_O = \\psi_{0,\\mathrm{O}}^{+}(\\boldsymbol{\\varepsilon})$，然后找到相应的损伤值 $d_S = H_S / (H_S + C)$ 和 $d_O = H_O / (H_O + C)$。实现将针对每个给定的应变张量遵循这些步骤。", "answer": "```python\nimport numpy as np\n\ndef compute_damage_S(eps, lame_lambda, mu, C_penalty):\n    \"\"\"\n    Computes damage using the spectral split strategy (S).\n    \"\"\"\n    # Calculate driving energy psi_0_S^+\n    tr_eps = np.trace(eps)\n    macaulay_tr_eps = np.maximum(0.0, tr_eps)\n    \n    # Eigenvalues of the strain tensor for the spectral split\n    eigvals = np.linalg.eigh(eps)[0]\n    macaulay_eigvals = np.maximum(0.0, eigvals)\n    \n    # Frobenius inner product of the positive part of the strain tensor\n    eps_plus_dot_eps_plus = np.sum(macaulay_eigvals**2)\n    \n    # Driving energy for strategy S\n    psi_plus_S = 0.5 * lame_lambda * macaulay_tr_eps**2 + mu * eps_plus_dot_eps_plus\n    \n    # This psi_plus is the history variable H for this single step\n    H = psi_plus_S\n    \n    # Compute damage d\n    if H == 0.0:\n        return 0.0\n    d = H / (H + C_penalty)\n    return d\n\ndef compute_damage_O(eps, mu, K, tau_th, C_penalty):\n    \"\"\"\n    Computes damage using the octahedral-stress-based deviatoric switch strategy (O).\n    \"\"\"\n    tr_eps = np.trace(eps)\n    macaulay_tr_eps = np.maximum(0.0, tr_eps)\n    \n    # Calculate mean stress to check the switch condition\n    sigma_m = K * tr_eps\n    \n    # Deviatoric strain and its Frobenius norm\n    eps_dev = eps - (tr_eps / 3.0) * np.identity(3)\n    eps_dev_dot_eps_dev = np.sum(eps_dev**2)\n\n    # Calculate octahedral shear stress to check the switch condition\n    s_dot_s = (2 * mu)**2 * eps_dev_dot_eps_dev\n    tau_oct = np.sqrt(s_dot_s / 3.0) if s_dot_s > 0.0 else 0.0\n\n    # Determine the switch S_oct\n    S_oct = 1.0 if sigma_m >= 0.0 and tau_oct >= tau_th else 0.0\n        \n    # Driving energy for strategy O\n    psi_plus_O = 0.5 * K * macaulay_tr_eps**2 + S_oct * mu * eps_dev_dot_eps_dev\n    \n    # This psi_plus is the history variable H for this single step\n    H = psi_plus_O\n    \n    # Compute damage d\n    if H == 0.0:\n        return 0.0\n    d = H / (H + C_penalty)\n    return d\n\ndef solve():\n    \"\"\"\n    Main function to run the computational experiment.\n    \"\"\"\n    # Material and model parameters\n    E = 3.0e10        # Pa (Young's modulus)\n    nu = 0.25         # (Poisson's ratio)\n    Gc = 1.0e3        # N/m (Critical energy release rate)\n    l = 1.0e-2        # m (Length scale)\n    tau_th = 0.0      # Pa (Octahedral stress threshold)\n\n    # Prescribed strain tensors for the 5 test cases\n    test_cases = [\n        # Case 1: Hydrostatic compression\n        np.diag([-1.0e-3, -1.0e-3, -1.0e-3]),\n        # Case 2: Triaxial compression with shear\n        np.array([[-5.0e-4, 1.5e-3, 0.0], [1.5e-3, -5.0e-4, 0.0], [0.0, 0.0, -5.0e-4]]),\n        # Case 3: Hydrostatic tension\n        np.diag([5.0e-4, 5.0e-4, 5.0e-4]),\n        # Case 4: Pure shear\n        np.array([[0.0, 1.0e-3, 0.0], [1.0e-3, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n        # Case 5: Near-zero magnitudes, compressive mean, tiny shear\n        np.array([[-1.0e-8, 1.0e-8, 0.0], [1.0e-8, -1.0e-8, 0.0], [0.0, 0.0, -1.0e-8]])\n    ]\n\n    # Pre-calculate derived constants\n    lame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n    K = lame_lambda + (2.0 / 3.0) * mu\n    C_penalty = Gc / (2.0 * l)\n\n    results = []\n    for eps in test_cases:\n        # Strategy S calculation\n        d_S = compute_damage_S(eps, lame_lambda, mu, C_penalty)\n        results.append(d_S)\n\n        # Strategy O calculation\n        d_O = compute_damage_O(eps, mu, K, tau_th, C_penalty)\n        results.append(d_O)\n\n    # Format the results into the required single-line output string\n    # Expected output: [0.000000,0.000000,0.222222,0.000000,0.473684,0.473684,0.193548,0.324324,0.000000,0.000000]\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3550356"}]}