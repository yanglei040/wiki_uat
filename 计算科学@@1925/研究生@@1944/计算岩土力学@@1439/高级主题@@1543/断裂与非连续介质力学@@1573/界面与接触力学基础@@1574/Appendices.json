{"hands_on_practices": [{"introduction": "在计算接触力学中，任何动力学分析的第一步都是精确地描述接触几何。在有限元方法中，这意味着要计算离散化表面（如从节点坐标定义的三角形）之间的法向间隙 $g_n$ 和切向间隙向量 $\\boldsymbol{g}_t$。本练习将引导您完成这一基本过程，使用最近点投影法来量化两个变形单元之间的相对位置，这是所有接触算法的基石。[@problem_id:3534212]", "problem": "在三维空间中，一对离散化曲面由有限元法 (FEM) 中的两个线性三角形曲面单元表示。第一个三角形被指定为主面，第二个为从面。每个三角形由三个具有初始位置和已知节点位移的节点定义，并且两个曲面在单个时间步长内都经历小变形。使用线性三角形的标准等参插值以及面积（重心）坐标中形心高斯点的定义。主三角形节点按 $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$ 的顺序排列，以通过右手定则定义单位外法向量。\n\n给定初始坐标和位移：\n- 主三角形初始节点坐标：$\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$，$\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$。\n- 主三角形节点位移：$\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$，$\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$。\n- 从三角形初始节点坐标：$\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$，$\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$，$\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$。\n- 从三角形节点位移：$\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$，$\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$，$\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$。\n\n假设小应变，并在当前（变形后）构型中计算所有量。在重心坐标为 $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$ 的从三角形形心高斯点处，执行到当前主三角形上的最近点投影。使用接触界面运动学的基本原理：\n1. 根据变形后的从节点构造从面高斯点的当前坐标。\n2. 根据变形后的主节点构造主三角形的当前单位外法向量。\n3. 计算从面高斯点到主三角形平面上的正交最近点投影，并通过重心坐标验证该投影点位于三角形内部。\n4. 从相对位置向量 $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$ 中，通过将 $\\boldsymbol{g}$ 分解为相对于主面在投影点处的法向和切向分量，提取法向间隙 $g_n$ 和切向间隙向量 $\\boldsymbol{g}_t$。使用符号约定，$g_n > 0$ 表示沿主面外法向的分离，$g_n  0$ 表示侵彻。\n\n将最终数值四舍五入至四位有效数字。以米为单位表示 $g_n$ 和 $\\boldsymbol{g}_t$ 的每个分量。将最终答案以单行矩阵的形式给出，其中包含 $g_n$ 以及 $\\boldsymbol{g}_t$ 在全局坐标系下的三个笛卡尔分量。", "solution": "首先验证问题，以确保其具有科学依据、是适定的，并提供了所有必要信息。\n\n### 步骤1：提取给定条件\n- 主三角形初始节点坐标：$\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$，$\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$。\n- 主三角形节点位移：$\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$，$\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$。\n- 从三角形初始节点坐标：$\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$，$\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$，$\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$。\n- 从三角形节点位移：$\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$，$\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$，$\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$。\n- 从点：形心高斯点，重心坐标为 $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$。\n- 主面法向：由 $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$ 的顺序和右手定则定义。\n- 运动学假设：小变形，在当前构型中计算。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据：** 该问题使用了有限元法 (FEM) 中计算接触力学的标准概念，如等参插值、主从接触对和用于间隙计算的最近点投影。这些都是已确立的基本原理。\n- **适定性：** 所有必要数据（节点坐标和位移）均已提供。任务定义清晰，并能导出一个唯一的可计算解。\n- **客观性：** 问题以精确、定量的术语陈述，没有主观或模糊的语言。\n- **结论：** 该问题被认为是有效的，因为它是自洽的、一致的，并且基于计算力学中已确立的科学原理。\n\n### 求解推导\n求解过程遵循问题陈述中概述的四个步骤。首先，我们计算当前（变形后）构型中的节点坐标。当前坐标向量 $\\boldsymbol{x}$ 是初始坐标向量 $\\boldsymbol{X}$ 和位移向量 $\\boldsymbol{u}$ 的和，即 $\\boldsymbol{x} = \\boldsymbol{X} + \\boldsymbol{u}$。\n\n变形后主节点坐标：\n$\\boldsymbol{x}_{M1} = \\boldsymbol{X}_{M1} + \\boldsymbol{u}_{M1} = (0,\\,0,\\,0) + (0,\\,0,\\,0) = (0,\\,0,\\,0)$\n$\\boldsymbol{x}_{M2} = \\boldsymbol{X}_{M2} + \\boldsymbol{u}_{M2} = (1,\\,0,\\,0) + (0,\\,0,\\,0.02) = (1,\\,0,\\,0.02)$\n$\\boldsymbol{x}_{M3} = \\boldsymbol{X}_{M3} + \\boldsymbol{u}_{M3} = (0,\\,1,\\,0.1) + (0,\\,0,\\,0) = (0,\\,1,\\,0.1)$\n\n变形后从节点坐标：\n$\\boldsymbol{x}_{S1} = \\boldsymbol{X}_{S1} + \\boldsymbol{u}_{S1} = (0.2,\\,0.2,\\,0.15) + (0.01,\\,-0.005,\\,-0.02) = (0.21,\\,0.195,\\,0.13)$\n$\\boldsymbol{x}_{S2} = \\boldsymbol{X}_{S2} + \\boldsymbol{u}_{S2} = (1.05,\\,0.1,\\,0.12) + (0,\\,0,\\,-0.03) = (1.05,\\,0.1,\\,0.09)$\n$\\boldsymbol{x}_{S3} = \\boldsymbol{X}_{S3} + \\boldsymbol{u}_{S3} = (0.1,\\,0.9,\\,0.25) + (-0.005,\\,0.005,\\,-0.01) = (0.095,\\,0.905,\\,0.24)$\n\n**1. 构造从面高斯点的当前坐标 ($\\boldsymbol{x}_{S}^{\\text{GP}}$)**\n形心高斯点的位置是节点坐标的平均值，对应于重心坐标 $(\\xi_1, \\xi_2, \\xi_3) = (\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$。\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3}\\boldsymbol{x}_{S1} + \\frac{1}{3}\\boldsymbol{x}_{S2} + \\frac{1}{3}\\boldsymbol{x}_{S3} = \\frac{1}{3}(\\boldsymbol{x}_{S1} + \\boldsymbol{x}_{S2} + \\boldsymbol{x}_{S3}) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} \\left( (0.21+1.05+0.095),\\,(0.195+0.1+0.905),\\,(0.13+0.09+0.24) \\right) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} (1.355,\\,1.2,\\,0.46) = (0.45166\\dots,\\,0.4,\\,0.15333\\dots) $$\n\n**2. 构造主三角形的当前单位外法向量 ($\\boldsymbol{n}$)**\n法向量 $\\boldsymbol{N}$ 由源于同一节点、且符合右手定则的两个边向量的叉积求得。我们使用边向量 $\\boldsymbol{v}_{12} = \\boldsymbol{x}_{M2}-\\boldsymbol{x}_{M1}$ 和 $\\boldsymbol{v}_{13} = \\boldsymbol{x}_{M3}-\\boldsymbol{x}_{M1}$。\n$$ \\boldsymbol{v}_{12} = (1,\\,0,\\,0.02) - (0,\\,0,\\,0) = (1,\\,0,\\,0.02) $$\n$$ \\boldsymbol{v}_{13} = (0,\\,1,\\,0.1) - (0,\\,0,\\,0) = (0,\\,1,\\,0.1) $$\n$$ \\boldsymbol{N} = \\boldsymbol{v}_{12} \\times \\boldsymbol{v}_{13} = \\begin{vmatrix} \\boldsymbol{i}  \\boldsymbol{j}  \\boldsymbol{k} \\\\ 1  0  0.02 \\\\ 0  1  0.1 \\end{vmatrix} = (-0.02, -0.1, 1) $$\n法向量的模为：\n$$ ||\\boldsymbol{N}|| = \\sqrt{(-0.02)^2 + (-0.1)^2 + 1^2} = \\sqrt{0.0004 + 0.01 + 1} = \\sqrt{1.0104} \\approx 1.0051865 $$\n单位法向量 $\\boldsymbol{n}$ 为：\n$$ \\boldsymbol{n} = \\frac{\\boldsymbol{N}}{||\\boldsymbol{N}||} = \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) \\approx (-0.01990,\\, -0.09949,\\, 0.99494) $$\n\n**3. 计算正交最近点投影 ($\\boldsymbol{x}_{M}^{\\text{proj}}$) 并验证**\n主面是一个由 $\\boldsymbol{n} \\cdot (\\boldsymbol{x} - \\boldsymbol{x}_{M1}) = 0$ 定义的平面。由于 $\\boldsymbol{x}_{M1} = (0,0,0)$，平面方程为 $\\boldsymbol{n} \\cdot \\boldsymbol{x} = 0$。\n投影点 $\\boldsymbol{x}_{M}^{\\text{proj}}$ 可通过从 $\\boldsymbol{x}_{S}^{\\text{GP}}$ 点沿 $-\\boldsymbol{n}$ 方向移动一段等于正交距离 $d = (\\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M1}) \\cdot \\boldsymbol{n}$ 的距离得到。\n$$ d = \\boldsymbol{x}_{S}^{\\text{GP}} \\cdot \\boldsymbol{n} = \\frac{1}{3}(1.355,\\,1.2,\\,0.46) \\cdot \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} \\left(1.355(-0.02) + 1.2(-0.1) + 0.46(1) \\right) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} (-0.0271 - 0.12 + 0.46) = \\frac{0.3129}{3\\sqrt{1.0104}} = \\frac{0.1043}{\\sqrt{1.0104}} \\approx 0.103762 $$\n投影点为 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\boldsymbol{x}_{S}^{\\text{GP}} - d \\boldsymbol{n}$。\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667,\\,0.4,\\,0.153333) - 0.103762 \\cdot (-0.01990,\\, -0.09949,\\, 0.99494) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667+0.002065,\\, 0.4+0.010323,\\, 0.153333-0.103234) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.45373,\\, 0.41032,\\, 0.05010) $$\n为验证该点在主三角形内部，我们求解其重心坐标 $(\\xi_1, \\xi_2, \\xi_3)$，使得 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_1\\boldsymbol{x}_{M1} + \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$ 且 $\\xi_1+\\xi_2+\\xi_3=1$。\n由于 $\\boldsymbol{x}_{M1} = (0,0,0)$，该式简化为 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$。\n$$ (0.45373,\\, 0.41032,\\, 0.05010) = \\xi_2(1,\\,0,\\,0.02) + \\xi_3(0,\\,1,\\,0.1) $$\n根据 $x$ 和 $y$ 分量：\n$\\xi_2 = 0.45373$\n$\\xi_3 = 0.41032$\n则 $\\xi_1 = 1 - \\xi_2 - \\xi_3 = 1 - 0.45373 - 0.41032 = 0.13595$。\n由于 $\\xi_1, \\xi_2, \\xi_3$ 均为正数且和为1，因此投影点位于主三角形内部。验证成功。\n\n**4. 计算法向间隙 ($g_n$) 和切向间隙向量 ($\\boldsymbol{g}_t$)**\n相对位置向量（间隙向量）为 $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$。根据正交投影的定义，该向量在构造上平行于法向量 $\\boldsymbol{n}$，其长度等于距离 $d$。\n$$ \\boldsymbol{g} = d \\boldsymbol{n} $$\n法向间隙 $g_n$ 是 $\\boldsymbol{g}$ 沿 $\\boldsymbol{n}$ 方向的分量。根据 $g_n > 0$ 表示分离的符号约定，可得：\n$$ g_n = \\boldsymbol{g} \\cdot \\boldsymbol{n} = (d \\boldsymbol{n}) \\cdot \\boldsymbol{n} = d (\\boldsymbol{n} \\cdot \\boldsymbol{n}) = d $$\n$$ g_n = d \\approx 0.103762 $$\n四舍五入到四位有效数字，$g_n = 0.1038$ 米。由于 $g_n > 0$，曲面在该点处于分离状态。\n\n切向间隙向量 $\\boldsymbol{g}_t$ 是 $\\boldsymbol{g}$ 在主面平面内的分量。它可以通过从 $\\boldsymbol{g}$ 中减去其法向分量得到：\n$$ \\boldsymbol{g}_t = \\boldsymbol{g} - g_n \\boldsymbol{n} $$\n代入 $\\boldsymbol{g} = d \\boldsymbol{n}$ 和 $g_n = d$：\n$$ \\boldsymbol{g}_t = d \\boldsymbol{n} - d \\boldsymbol{n} = \\boldsymbol{0} $$\n切向间隙向量为零，因为投影被定义为与主面正交。因此，根据定义，从从点到其投影点的向量没有切向分量。\n切向间隙向量的分量为 $\\boldsymbol{g}_t = (g_{tx}, g_{ty}, g_{tz}) = (0, 0, 0)$。\n\n四舍五入到四位有效数字的最终值：\n$g_n = 0.1038$\n$\\boldsymbol{g}_t = (0, 0, 0)$\n将这些值表示为单行矩阵 $[g_n, g_{tx}, g_{ty}, g_{tz}]$：\n$[0.1038,\\, 0,\\, 0,\\, 0]$。\n注意，题目要求对最终数值进行四舍五入，因此值为 $0$ 的分量保持为 $0$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1038  0  0  0 \\end{pmatrix} } $$", "id": "3534212"}, {"introduction": "摩擦接触不仅涉及力的传递，还涉及复杂的能量转换过程。当外力作用于摩擦界面时，一部分功以弹性应变能的形式储存起来，而另一部分则因滑移而不可逆地耗散为热量。通过本练习，您将从第一性原理出发，推导并计算在一个完整的粘滑加载路径中能量的分配，从而加深对界面耗散物理机制的理解。[@problem_id:3534277]", "problem": "一个平面岩石节理被理想化为两个可变形体之间的零厚度界面。该界面在恒定的法向压应力 $p_n$ 作用下，承受一个指定的单调递增的切向相对位移跳跃 $g_t$，并且在整个加载过程中接触保持闭合，不发生分离。其切向本构响应在滑动前是弹性的，单位面积刚度为 $k_t$，而在滑动开始后则遵循经典的 Coulomb 摩擦定律：剪切牵引力的大小 $|\\tau|$ 不能超过由摩擦系数 $\\mu$ 与施加的法向应力 $p_n$ 的乘积所定义的摩擦极限，并且在滑动期间 $|\\tau|$ 的大小保持等于该摩擦极限。界面面积为 $A$。加载路径先产生粘滞直至滑动开始，随后在摩擦极限下发生稳定滑移，最终达到一个切向位移跳跃 $D_f$。\n\n仅使用第一性原理，即切向位移跳跃的运动学定义、滑动前的弹性本构关系、Coulomb 摩擦极限以及界面处机械功率/功的定义，推导总外功如何划分为加载结束时储存的可恢复弹性势能和在加载路径中累积的不可恢复的摩擦耗散。然后，使用以下科学上符合实际的参数计算这两种能量：\n- 界面面积 $A = 0.50\\,\\mathrm{m}^2$,\n- 恒定法向压应力 $p_n = 10\\,\\mathrm{MPa}$,\n- 摩擦系数 $\\mu = 0.60$,\n- 单位面积切向刚度 $k_t = 2.0\\,\\mathrm{GPa/m}$,\n- 最终切向位移跳跃 $D_f = 8.0\\,\\mathrm{mm}$.\n\n以焦耳（Joule）为单位表示最终能量。将答案四舍五入至四位有效数字。将最终答案以行矩阵的形式报告，其中第一个条目等于可恢复弹性势能，第二个条目等于不可恢复的摩擦耗散。", "solution": "该问题是有效的，因为它在科学上基于接触力学和连续介质力学的原理，是一个具有完整且一致的数据集和本构定律的适定问题，并以客观、正式的语言表述。我们开始进行求解。\n\n问题要求对一个承受剪切加载的平面界面，将其总外功划分为可恢复弹性势能和不可恢复的摩擦耗散。让我们定义相关物理量。该界面的面积为 $A$。它承受着一个恒定的法向压应力 $p_n$ 和一个单调递增的切向相对位移跳跃 $g_t$。剪切牵引力用 $\\tau$ 表示。\n\n界面的本构行为由两种状态描述：\n1.  **弹性（粘滞）状态**：在滑动开始之前，剪切牵引力与切向位移跳跃成线性比例。单位面积刚度为 $k_t$。其关系由下式给出：\n    $$ \\tau = k_t g_t $$\n    只要剪切牵引力低于摩擦强度，此状态就一直保持。\n2.  **塑性（滑移）状态**：当剪切牵引力达到 Coulomb 摩擦定律定义的极限时，滑动发生。摩擦强度为 $\\mu p_n$，其中 $\\mu$ 是摩擦系数。在滑动过程中，剪切牵力的大小是恒定的，等于这个极限值：\n    $$ |\\tau| = \\mu p_n $$\n\n从粘滞状态到滑移状态的转变发生在一个特定的切向位移跳跃处，我们称之为屈服位移 $g_{t, \\text{yield}}$。在这一点上，弹性牵引力等于摩擦强度：\n$$ k_t g_{t, \\text{yield}} = \\mu p_n $$\n解出屈服位移，得到：\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} $$\n加载路径包括一个初始弹性阶段（$0 \\le g_t \\le g_{t, \\text{yield}}$），随后是一个稳定滑移阶段（$g_{t, \\text{yield}}  g_t \\le D_f$），其中 $D_f$ 是最终给定的切向位移跳跃。我们必须首先验证 $D_f > g_{t, \\text{yield}}$，以确认确实进入了滑移阶段。\n\n施加在界面上的总外功 $W_{\\text{total}}$ 是总切向力 $F_t = \\tau A$ 对总切向位移跳跃从 $g_t=0$ 到 $g_t=D_f$ 的积分。\n$$ W_{\\text{total}} = \\int_0^{D_f} F_t(g_t) \\, dg_t = A \\int_0^{D_f} \\tau(g_t) \\, dg_t $$\n我们必须根据加载路径的两个阶段来分解这个积分：\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} \\tau(g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} \\tau(g_t) \\, dg_t \\right) $$\n将每个阶段中 $\\tau(g_t)$ 的本构关系代入：\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} (k_t g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} (\\mu p_n) \\, dg_t \\right) $$\n计算积分：\n$$ W_{\\text{total}} = A \\left( \\left[ \\frac{1}{2} k_t g_t^2 \\right]_0^{g_{t, \\text{yield}}} + \\left[ \\mu p_n g_t \\right]_{g_{t, \\text{yield}}}^{D_f} \\right) $$\n$$ W_{\\text{total}} = A \\left( \\frac{1}{2} k_t g_{t, \\text{yield}}^2 + \\mu p_n (D_f - g_{t, \\text{yield}}) \\right) $$\n\n这个总功被划分为可恢复的储存弹性势能 $U_e$ 和不可恢复的耗散能 $W_d$。\n$$ W_{\\text{total}} = U_e + W_d $$\n\n可恢复弹性势能 $U_e$ 是在对应位移 $D_f$ 的最终状态下储存在界面中的能量。在这个最终状态下，界面正在滑动，所以剪切牵引力为 $\\tau_f = \\mu p_n$。位移的弹性部分 $g_t^e$ 通过弹性定律与此牵引力相关：$\\tau_f = k_t g_t^e$。因此，在最终状态下：\n$$ g_{t,f}^e = \\frac{\\tau_f}{k_t} = \\frac{\\mu p_n}{k_t} = g_{t, \\text{yield}} $$\n单位面积储存的弹性势能为 $u_e = \\frac{1}{2} k_t (g_{t,f}^e)^2 = \\frac{1}{2} \\frac{\\tau_f^2}{k_t}$。整个界面的总可恢复弹性势能为：\n$$ U_e = A \\cdot u_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\n不可恢复的摩擦耗散 $W_d$ 是摩擦力在位移的塑性（滑移）部分 $g_t^p = g_t - g_t^e$ 上所做的功。耗散仅在滑移阶段发生，即 $g_t > g_{t, \\text{yield}}$ 且 $|\\tau| = \\mu p_n$。滑移量为 $\\Delta g_t^p = D_f - g_{t,f}^e = D_f - g_{t, \\text{yield}}$。耗散是恒定总摩擦力 $F_f = A \\mu p_n$ 与总滑移距离的乘积：\n$$ W_d = (A \\mu p_n) (D_f - g_{t, \\text{yield}}) $$\n代入 $g_{t, \\text{yield}}$ 的表达式：\n$$ W_d = A \\mu p_n \\left( D_f - \\frac{\\mu p_n}{k_t} \\right) = A \\left( \\mu p_n D_f - \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\n现在我们代入给定的数值，确保所有数值都采用国际单位制（SI）基本单位。\n- 界面面积：$A = 0.50\\,\\mathrm{m}^2$\n- 法向应力：$p_n = 10\\,\\mathrm{MPa} = 10 \\times 10^6\\,\\mathrm{Pa}$\n- 摩擦系数：$\\mu = 0.60$\n- 切向刚度：$k_t = 2.0\\,\\mathrm{GPa/m} = 2.0 \\times 10^9\\,\\mathrm{N/m^3}$\n- 最终位移：$D_f = 8.0\\,\\mathrm{mm} = 8.0 \\times 10^{-3}\\,\\mathrm{m}$\n\n首先，我们计算屈服位移 $g_{t, \\text{yield}}$：\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} = \\frac{0.60 \\times (10 \\times 10^6\\,\\mathrm{Pa})}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = \\frac{6.0 \\times 10^6\\,\\mathrm{N/m^2}}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = 3.0 \\times 10^{-3}\\,\\mathrm{m} $$\n由于 $D_f = 8.0 \\times 10^{-3}\\,\\mathrm{m} > g_{t, \\text{yield}} = 3.0 \\times 10^{-3}\\,\\mathrm{m}$，界面确实经历了一个稳定滑移阶段，因此我们推导的公式是适用的。\n\n接下来，我们计算可恢复弹性势能 $U_e$：\n$$ U_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) = (0.50\\,\\mathrm{m}^2) \\left( \\frac{1}{2} \\frac{(0.60 \\times 10 \\times 10^6\\,\\mathrm{Pa})^2}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} \\right) $$\n$$ U_e = 0.50 \\left( \\frac{1}{2} \\frac{(6.0 \\times 10^6)^2}{2.0 \\times 10^9} \\right) \\,\\mathrm{J} = 0.50 \\left( \\frac{36 \\times 10^{12}}{4.0 \\times 10^9} \\right) \\,\\mathrm{J} $$\n$$ U_e = 0.50 \\times (9.0 \\times 10^3) \\,\\mathrm{J} = 4500\\,\\mathrm{J} $$\n\n最后，我们计算不可恢复的摩擦耗散 $W_d$：\n$$ W_d = A \\mu p_n (D_f - g_{t, \\text{yield}}) = (0.50\\,\\mathrm{m}^2)(0.60)(10 \\times 10^6\\,\\mathrm{Pa})(8.0 \\times 10^{-3}\\,\\mathrm{m} - 3.0 \\times 10^{-3}\\,\\mathrm{m}) $$\n总摩擦力为 $F_f = A \\mu p_n = (0.50\\,\\mathrm{m}^2)(6.0 \\times 10^6\\,\\mathrm{N/m^2}) = 3.0 \\times 10^6\\,\\mathrm{N}$。\n总滑移距离为 $\\Delta g_t^p = (8.0 - 3.0) \\times 10^{-3}\\,\\mathrm{m} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$。\n$$ W_d = (3.0 \\times 10^6\\,\\mathrm{N}) (5.0 \\times 10^{-3}\\,\\mathrm{m}) = 15.0 \\times 10^3\\,\\mathrm{J} = 15000\\,\\mathrm{J} $$\n\n问题要求将结果四舍五入到四位有效数字。\n可恢复弹性势能：$U_e = 4500\\,\\mathrm{J} = 4.500 \\times 10^3\\,\\mathrm{J}$。\n不可恢复的摩擦耗散：$W_d = 15000\\,\\mathrm{J} = 1.500 \\times 10^4\\,\\mathrm{J}$。\n\n最终答案是一个行矩阵，包含这两个以焦耳为单位的数值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.500 \\times 10^3   1.500 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "3534277"}, {"introduction": "在数值模拟中，准确实施像库仑摩擦这样的非线性本构定律是一个核心挑战。由于摩擦定律定义了一个“容许应力”区域，当弹性试探步产生的应力超出此区域时，必须通过一个算法将其“拉回”到屈服面上。本编码练习将指导您实现径向返回算法——这是在计算塑性力学和摩擦学中用于强制执行屈服条件的最基本、最广泛使用的技术。[@problem_id:3534224]", "problem": "在计算岩土力学中，考虑一个平面摩擦接触界面，其中法向应力 $p_n$ 在受压时为正。切向应力由二维向量 $\\boldsymbol{\\tau} \\in \\mathbb{R}^2$ 表示。摩擦强度由经典的库仑定律建模，摩擦系数为 $\\mu \\ge 0$，这意味着容许集由屈服函数定义\n$$\n\\phi(\\boldsymbol{\\tau},p_n) = \\|\\boldsymbol{\\tau}\\| - \\mu\\,p_n \\le 0,\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。该界面通过切向罚刚度 $k_t  0$（单位：帕斯卡/米）进行正则化，因此纯弹性预测器提供了一个试探切向应力 $\\boldsymbol{\\tau}^{\\text{trial}} \\in \\mathbb{R}^2$（单位：帕斯卡）。如果发生滑动，则引入一个塑性滑移增量向量 $\\Delta \\boldsymbol{\\xi} \\in \\mathbb{R}^2$（单位：米）来校正试探状态，使其满足摩擦定律。\n\n从摩擦容许集 $\\phi(\\boldsymbol{\\tau},p_n) \\le 0$ 的第一性原理、接触和摩擦的 Karush–Kuhn–Tucker (KKT) 条件以及基于罚函数的弹性预测器出发，实现径向返回算法，该算法将试探切向应力 $\\boldsymbol{\\tau}^{\\text{trial}}$ 映射到返回映射后的切向应力 $\\boldsymbol{\\tau}$ 和塑性滑移增量 $\\Delta \\boldsymbol{\\xi}$。您的实现必须遵循以下物理上一致的情况：\n- 如果 $p_n \\le 0$（接触张开），则设置 $\\boldsymbol{\\tau} = \\boldsymbol{0}$ 和 $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$。\n- 如果 $p_n  0$ 且 $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) \\le 0$（粘滞），则设置 $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$ 和 $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$。\n- 如果 $p_n  0$ 且 $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n)  0$（滑动），则执行径向返回，使得最终应力满足 $\\|\\boldsymbol{\\tau}\\| = \\mu\\,p_n$ 并与 $\\boldsymbol{\\tau}^{\\text{trial}}$ 共线，并计算与切向罚刚度 $k_t$ 一致的相应塑性滑移增量。\n\n算法中的所有量必须使用以下单位处理：\n- 法向应力 $p_n$ 的单位为帕斯卡 (Pa)。\n- 切向应力向量 $\\boldsymbol{\\tau}^{\\text{trial}}$ 和 $\\boldsymbol{\\tau}$ 的单位为帕斯卡 (Pa)。\n- 切向罚刚度 $k_t$ 的单位为帕斯卡/米 (Pa/m)。\n- 塑性滑移增量 $\\Delta \\boldsymbol{\\xi}$ 的单位为米 (m)。\n\n使用以下包含七个测试用例的测试套件，每个用例以 $(p_n,\\mu,\\boldsymbol{\\tau}^{\\text{trial}},k_t)$ 的形式给出：\n1. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n2. $p_n = 2.0\\times 10^5$ Pa, $\\mu = 0.5$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n3. $p_n = 2.6034\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n4. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.0$, $\\boldsymbol{\\tau}^{\\text{trial}} = [1.0\\times 10^4,\\,0.0]$ Pa, $k_t = 1.0\\times 10^8$ Pa/m.\n5. $p_n = -1.0\\times 10^4$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [2.0\\times 10^4,\\,0.0]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n6. $p_n = 5.0\\times 10^4$ Pa, $\\mu = 0.6$, $\\boldsymbol{\\tau}^{\\text{trial}} = [0.0,\\,0.0]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n7. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^{12}$ Pa/m.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个结果必须是一个包含四个实数的列表 $[\\tau_x,\\tau_y,\\Delta \\xi_x,\\Delta \\xi_y]$，其中 $[\\tau_x,\\tau_y]$ 是对应情况的返回映射后切向应力（单位：帕斯卡），$[\\Delta \\xi_x,\\Delta \\xi_y]$ 是塑性滑移增量（单位：米）。例如，最终输出格式必须为\n$$\n[\\,[\\tau_x^{(1)},\\tau_y^{(1)},\\Delta \\xi_x^{(1)},\\Delta \\xi_y^{(1)}],\\,[\\tau_x^{(2)},\\tau_y^{(2)},\\Delta \\xi_x^{(2)},\\Delta \\xi_y^{(2)}],\\,\\dots\\,].\n$$", "solution": "出发点是来自库仑定律的摩擦容许条件，由屈服函数表示\n$$\n\\phi(\\boldsymbol{\\tau},p_n) = \\|\\boldsymbol{\\tau}\\| - \\mu\\,p_n \\le 0,\n$$\n其中 $\\mu \\ge 0$ 且 $p_n$ 在受压时为正。摩擦的 Karush–Kuhn–Tucker (KKT) 结构指出了三种状态：接触张开（$p_n \\le 0$）、粘滞（$p_n  0$ 且 $\\phi \\le 0$）和滑动（$p_n  0$ 且 $\\phi = 0$ 伴随非零滑移增量）。在基于罚函数的离散化中，纯弹性预测器通过切向刚度 $k_t$ 从试探滑移增量中得到一个试探应力 $\\boldsymbol{\\tau}^{\\text{trial}}$。如果试探状态违反了 $\\phi \\le 0$，则应用塑性修正。\n\n在接触张开状态下，即 $p_n \\le 0$ 时，无法维持法向压应力，切向应力必须为零：\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{0}, \\quad \\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}.\n$$\n\n在粘滞状态下，即 $p_n  0$ 且 $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) \\le 0$ 时，试探状态是容许的，这意味着不需要塑性滑移增量：\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}, \\quad \\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}.\n$$\n\n在滑动状态下，即 $p_n  0$ 且 $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n)  0$ 时，返回映射旨在寻找一个位于摩擦边界上、与试探应力共线且与罚刚度一致的修正应力。将试探应力的单位方向表示为\n$$\n\\boldsymbol{m} = \\frac{\\boldsymbol{\\tau}^{\\text{trial}}}{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|}.\n$$\n径向返回通过以下方式强制共线性和边界容许性\n$$\n\\boldsymbol{\\tau} = \\mu\\,p_n\\,\\boldsymbol{m}.\n$$\n为了计算塑性滑移增量，我们使用罚函数关系，即塑性修正会减小试探应力：\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}} - k_t\\,\\Delta \\boldsymbol{\\xi}.\n$$\n在径向返回下，取 $\\Delta \\boldsymbol{\\xi}$ 与 $\\boldsymbol{m}$ 对齐，即 $\\Delta \\boldsymbol{\\xi} = \\Delta \\gamma\\,\\boldsymbol{m}$，其中 $\\Delta \\gamma$ 是一个单位为米的标量。将罚函数关系投影到 $\\boldsymbol{m}$ 上可得\n$$\n\\mu\\,p_n = \\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - k_t\\,\\Delta \\gamma \\quad \\Rightarrow \\quad \\Delta \\gamma = \\frac{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - \\mu\\,p_n}{k_t}.\n$$\n因此，塑性滑移增量向量为\n$$\n\\Delta \\boldsymbol{\\xi} = \\Delta \\gamma\\,\\boldsymbol{m} = \\frac{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - \\mu\\,p_n}{k_t}\\,\\frac{\\boldsymbol{\\tau}^{\\text{trial}}}{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|}.\n$$\n这个表达式在物理上是一致的：当 $\\mu = 0$ 且 $p_n  0$ 时，返回映射后的应力为零，滑移增量的大小在 $\\boldsymbol{\\tau}^{\\text{trial}}$ 方向上减小为 $\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|/k_t$；当恰好 $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) = 0$ 时，$\\Delta \\gamma = 0$ 且 $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$，作为边界粘滞状态；当 $\\boldsymbol{\\tau}^{\\text{trial}} = \\boldsymbol{0}$ 时，应力和滑移增量均为零。\n\n为每个测试用例 $(p_n,\\mu,\\boldsymbol{\\tau}^{\\text{trial}},k_t)$ 实现的算法步骤如下：\n1. 计算 $s = \\|\\boldsymbol{\\tau}^{\\text{trial}}\\|$。\n2. 如果 $p_n \\le 0$，设置 $\\boldsymbol{\\tau} = \\boldsymbol{0}$ 和 $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$。\n3. 否则，计算 $\\phi^{\\text{trial}} = s - \\mu\\,p_n$。\n4. 如果 $\\phi^{\\text{trial}} \\le 0$，设置 $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$ 和 $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$。\n5. 如果 $\\phi^{\\text{trial}}  0$，设置 $\\boldsymbol{m} = \\boldsymbol{\\tau}^{\\text{trial}}/s$，$\\boldsymbol{\\tau} = \\mu\\,p_n\\,\\boldsymbol{m}$，以及 $\\Delta \\boldsymbol{\\xi} = \\left(\\phi^{\\text{trial}}/k_t\\right)\\,\\boldsymbol{m}$。\n\n将上述步骤应用于指定的测试套件，对每个案例产生有序列表 $[\\tau_x,\\tau_y,\\Delta \\xi_x,\\Delta \\xi_y]$，其中 $\\boldsymbol{\\tau}$ 的单位是帕斯卡，$\\Delta \\boldsymbol{\\xi}$ 的单位是米。程序将包含所有七个案例的这些列表的列表作为单行输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef radial_return(p_n: float, mu: float, kt: float, tau_trial: np.ndarray):\n    \"\"\"\n    Perform radial return mapping for planar Coulomb friction with tangential penalty stiffness.\n\n    Parameters\n    ----------\n    p_n : float\n        Normal traction (Pa), positive in compression.\n    mu : float\n        Friction coefficient (dimensionless).\n    kt : float\n        Tangential penalty stiffness (Pa/m).\n    tau_trial : np.ndarray\n        Trial tangential traction vector (Pa), shape (2,).\n\n    Returns\n    -------\n    tau : np.ndarray\n        Return-mapped tangential traction vector (Pa), shape (2,).\n    dxi : np.ndarray\n        Plastic slip increment vector (m), shape (2,).\n    \"\"\"\n    # Ensure tau_trial is a numpy array\n    t_trial = np.asarray(tau_trial, dtype=float)\n    s = np.linalg.norm(t_trial)\n\n    # Open contact: no traction, no slip increment\n    if p_n = 0.0:\n        return np.array([0.0, 0.0], dtype=float), np.array([0.0, 0.0], dtype=float)\n\n    # Trial yield function\n    phi_trial = s - mu * p_n\n\n    # Stick: admissible trial state\n    if phi_trial = 0.0 or s == 0.0:\n        return t_trial.copy(), np.array([0.0, 0.0], dtype=float)\n\n    # Sliding: radial return to yield surface\n    m = t_trial / s  # unit direction\n    tau = (mu * p_n) * m\n    # Plastic consistency parameter magnitude\n    delta_gamma = phi_trial / kt\n    dxi = delta_gamma * m\n    return tau, dxi\n\ndef solve():\n    # Define the test cases from the problem statement: (p_n, mu, tau_trial, k_t)\n    test_cases = [\n        (1.0e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (2.0e5, 0.5, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (2.6034e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (1.0e5, 0.0, np.array([1.0e4, 0.0]), 1.0e8),\n        (-1.0e4, 0.3, np.array([2.0e4, 0.0]), 1.0e9),\n        (5.0e4, 0.6, np.array([0.0, 0.0]), 1.0e9),\n        (1.0e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e12),\n    ]\n\n    results = []\n    for p_n, mu, tau_trial, kt in test_cases:\n        tau, dxi = radial_return(p_n, mu, kt, tau_trial)\n        # Prepare list [tau_x, tau_y, dxi_x, dxi_y]\n        result = [float(tau[0]), float(tau[1]), float(dxi[0]), float(dxi[1])]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists\n    def fmt(x):\n        # Use default str for floats; ensure no extraneous spaces\n        return str(x)\n\n    inner = []\n    for r in results:\n        inner.append(f\"[{','.join(fmt(x) for x in r)}]\")\n    print(f\"[{','.join(inner)}]\")\n\nsolve()\n```", "id": "3534224"}]}