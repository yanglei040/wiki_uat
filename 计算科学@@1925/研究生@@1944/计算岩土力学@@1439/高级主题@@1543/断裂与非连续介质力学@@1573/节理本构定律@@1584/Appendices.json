{"hands_on_practices": [{"introduction": "要掌握一个本构律，首先需要理解其数学表达式。本练习聚焦于推导Barton-Bandis剪切强度准则的无量纲形式，这是岩石力学中的一个基石。通过这个实践，你将阐明节理壁抗压强度（$JCS$）、节理粗糙度系数（$JRC$）和残余摩擦角（$\\phi_r$）这些基本参数是如何共同决定节理强度的 [@problem_id:3537020]。", "problem": "在数值模型中，一个岩石节理由一个摩擦界面表示，其抗剪强度在低法向应力下随接触面粗糙度的增加而增加，并在高法向应力下趋于一个残余摩擦响应。设剪应力用 $\\tau$ 表示，施加的有效法向应力用 $\\sigma_{n}$ 表示。节理壁抗压强度 (JCS) 是节理表面的一个材料强度标度，而节理粗糙度系数 (JRC) 是一个无量纲的表面粗糙度描述符，其标定方式使其对表观摩擦角的贡献通过一个由 $JCS$ 和 $\\sigma_{n}$ 构成的应力比的以10为底的对数，以$\\text{radians}$为单位加和地计入。残余摩擦角为 $\\phi_{r}$，以$\\text{radians}$为单位。从抗剪强度与法向应力和动员摩擦角的正切值成比例的基本摩擦形式出发，使用 $JCS$ 作为应力标度引入适当的无量纲化。推导无量纲抗剪强度 $\\tau/JCS$ 关于无量纲比率 $\\sigma_{n}/JCS$、残余摩擦角 $\\phi_{r}$ 和粗糙度项 $JRC \\log_{10}(JCS/\\sigma_{n})$ 的闭式表达式。所有角度均以$\\text{radians}$表示。提供 $\\tau/JCS$ 的最终解析表达式；无需进行数值计算。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 剪应力: $\\tau$\n- 施加的有效法向应力: $\\sigma_{n}$\n- 节理壁抗压强度: $JCS$\n- 节理粗糙度系数: $JRC$ (无量纲)\n- 残余摩擦角: $\\phi_{r}$ (以弧度为单位)\n- 抗剪强度的基本关系：$\\tau$ 与 $\\sigma_{n}$ 和动员摩擦角 $\\phi_{mob}$ 的正切值成比例。这可以写成 $\\tau = \\sigma_{n} \\tan(\\phi_{mob})$。\n- 动员摩擦角的定义：来自 $JRC$ 的贡献加和地计入残余摩擦角 $\\phi_{r}$。$JRC$ 的贡献为 $JRC \\log_{10}(JCS/\\sigma_{n})$。因此，$\\phi_{mob} = \\phi_{r} + JRC \\log_{10}(JCS/\\sigma_{n})$。\n- 无量纲化：用于无量纲化的特征应力标度是 $JCS$。\n- 目标：推导无量纲抗剪强度 $\\tau/JCS$ 关于无量纲比率 $\\sigma_{n}/JCS$、$\\phi_{r}$ 和 $JRC \\log_{10}(JCS/\\sigma_{n})$ 的闭式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了岩石节理的 Barton-Bandis 抗剪强度准则的公式，这是岩石力学和计算地质力学中一个被广泛接受和使用的经验模型。其前提在事实上是可靠的，并基于该领域的既定原则。\n- **适定性**：该问题是适定的。它提供了推导唯一解析表达式所需的所有必要定义和关系。目标陈述清晰。\n- **客观性**：该问题以精确、客观和技术性的语言表述，没有任何主观或基于意见的陈述。\n- **完整性与一致性**：该问题是自洽的，提供了所有必需的参数（$\\tau$, $\\sigma_n$, $JCS$, $JRC$, $\\phi_r$）以及它们之间的函数关系形式。没有矛盾之处。\n- **真实性**：这些参数和模型本身在物理上是真实的，代表了岩土工程领域的标准做法。\n- **结构**：该问题被清晰地构建为一个推导任务。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、适定、客观且完整。可以继续求解过程。\n\n### 求解推导\n\n推导过程通过系统地组合问题陈述中描述的各个部分来进行。\n\n剪应力 $\\tau$、有效法向应力 $\\sigma_{n}$ 和动员摩擦角 $\\phi_{mob}$ 之间的基本关系以 Mohr-Coulomb 型定律给出：\n$$\n\\tau = \\sigma_{n} \\tan(\\phi_{mob})\n$$\n问题陈述指出，动员摩擦角 $\\phi_{mob}$ 由两个加和部分组成：残余摩擦角 $\\phi_{r}$ 和节理粗糙度的贡献。粗糙度项明确给出为 $JRC \\log_{10}(JCS/\\sigma_{n})$。因此，动员摩擦角的表达式为：\n$$\n\\phi_{mob} = \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\n$$\n此表达式中的所有角度都指定以弧度为单位。\n\n将 $\\phi_{mob}$ 的表达式代入抗剪强度方程，得到根据 Barton-Bandis 模型的完整抗剪强度表达式：\n$$\n\\tau = \\sigma_{n} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\n最终要求是通过相对于节理壁抗压强度 $JCS$ 进行归一化，以无量纲形式表示抗剪强度。为此，我们将方程两边同时除以 $JCS$：\n$$\n\\frac{\\tau}{JCS} = \\frac{\\sigma_{n}}{JCS} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\n该方程按要求将无量纲抗剪强度 $\\tau/JCS$ 表示为无量纲法向应力 $\\sigma_{n}/JCS$、残余摩擦角 $\\phi_{r}$ 和粗糙度项 $JRC \\log_{10}(JCS/\\sigma_{n})$ 的函数。这就是最终的闭式表达式。", "answer": "$$\n\\boxed{\\frac{\\tau}{JCS} = \\frac{\\sigma_{n}}{JCS} \\tan\\left(\\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\\right)}\n$$", "id": "3537020"}, {"introduction": "在建立了本构公式之后，下一步是理解其适用范围和局限性。这个实践将探讨Barton-Bandis模型的一个关键边界条件 [@problem_id:3537034]。通过计算保证物理真实性所需的最小$JCS$值，你将理解为什么在数值模型中，必须为经验公式添加“上限”或逻辑判断，以处理其主要适用范围之外的工况。", "problem": "一个岩石节理使用 Barton–Bandis 节理本构定律对其峰值抗剪强度进行建模，该定律将峰值摩擦角分解为一个残余分量和一个由粗糙度引起的增量。设残余摩擦角表示为 $\\phi_{r}$，节理粗糙度系数 (JRC) 表示为 $JRC$，节理壁抗压强度 (JCS) 表示为 $JCS$，施加的法向应力表示为 $\\sigma_{n}$。在此模型中，由粗糙度引起的增量与比率 $JCS/\\sigma_{n}$ 的对数相关，并与 $JRC$ 成正比。当 $\\sigma_{n}$ 足够高以致粗糙度效应消失时，峰值摩擦角会降低至残余摩擦角。\n\n假设 $JRC \\ge 0$ 并且对数以 10 为底。使用上述经过充分检验的 Barton–Bandis 峰值摩擦角表示法，确定能保证计算出的峰值摩擦角不低于 $\\phi_{r}$ 的最小 $JCS$ 值（以闭合形式的符号表达式表示您的答案）。同时，从计算实现和物理一致性的角度，简要说明为什么通常要防止计算出的摩擦角低于 $\\phi_{r}$。\n\n以与 $\\sigma_{n}$ 相同的应力单位，将最终的 $JCS$ 表示为符号表达式。无需四舍五入。您的最终答案必须是单个表达式。", "solution": "问题要求确定最小的节理壁抗压强度 $JCS$，以确保在 Barton–Bandis 模型中计算出的峰值摩擦角 $\\phi_p$ 不会低于残余摩擦角 $\\phi_r$。此外，问题还要求从物理和计算的角度对这一约束进行论证。\n\n首先，我们根据问题陈述，将 Barton–Bandis 峰值摩擦角模型形式化。峰值摩擦角 $\\phi_p$ 是残余摩擦角 $\\phi_r$ 与一个由粗糙度引起的增量之和。这个增量与节理粗糙度系数 $JRC$ 成正比，并与节理壁抗压强度 $JCS$ 与施加的法向应力 $\\sigma_n$ 之比的对数（以 10 为底）相关。这种关系的标准表示法是：\n$$\n\\phi_p = \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\n$$\n问题指明 $JRC \\ge 0$。它还指出，为使对数有定义，其参数必须为正，因此我们假设 $JCS > 0$ 且 $\\sigma_n > 0$。\n\n需要满足的核心条件是峰值摩擦角不得低于残余摩擦角。这在数学上表示为：\n$$\n\\phi_p \\ge \\phi_r\n$$\n将 $\\phi_p$ 的表达式代入此不等式，得到：\n$$\n\\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge \\phi_r\n$$\n从不等式两边减去 $\\phi_r$，可将表达式简化为：\n$$\nJRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\n我们根据 $JRC$ 的值来分析这个不等式。\n情况 1：$JRC = 0$。\n如果 $JRC = 0$，则节理是完全光滑的。不等式变为 $0 \\ge 0$，这始终成立。在这种情况下，无论 $JCS$ 和 $\\sigma_n$ 的值是多少，都有 $\\phi_p = \\phi_r$，因此对于任何有效的 $JCS$，该条件都得到满足。\n\n情况 2：$JRC > 0$。\n由于 $JRC$ 是一个正常数，我们可以将不等式两边同时除以 $JRC$ 而不改变不等号的方向：\n$$\n\\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right) \\ge 0\n$$\n对于以 10 为底的对数，要使其值大于或等于零，其参数必须大于或等于 1。这是对数的一个基本性质（对于任何底数 $b > 1$，$\\log_b(x) \\ge 0 \\iff x \\ge 1$）。因此，我们必须有：\n$$\n\\frac{JCS}{\\sigma_n} \\ge 1\n$$\n两边同时乘以 $\\sigma_n$（这是一个正应力），得到关于 $JCS$ 的条件：\n$$\nJCS \\ge \\sigma_n\n$$\n为保证 $\\phi_p \\ge \\phi_r$，此不等式必须成立。问题要求保证此条件的最小 $JCS$ 值。这对应于所导出不等式的下界。因此，$JCS$ 所需的最小值等于 $\\sigma_n$。\n\n问题的第二部分要求说明为什么在实践中要强制执行 $\\phi_p \\ge \\phi_r$ 这一条件。\n\n从物理一致性角度的论证：\n残余摩擦角 $\\phi_r$ 代表了岩石节理表面在所有凸起（粗糙度特征）被剪断后的基准摩擦阻力。它是平面、未胶结接触面的摩擦强度。强度的粗糙度分量，由项 $JRC \\log_{10}(JCS/\\sigma_n)$ 表示，说明了由这些凸起的互锁提供的额外抗剪能力。这种额外的阻力可以为零（对于光滑节理或在压碎凸起的极高法向应力下），但不能为负。负的贡献将意味着粗糙表面的强度低于完全光滑的表面，这与摩擦和力学的基本物理原理相矛盾。当 $JCS  \\sigma_n$ 时，对数项变为负值，这是一个数学上的假象，是该经验公式在其主要有效范围之外的一个局限。从物理上讲，当法向应力 $\\sigma_n$ 超过节理壁材料的抗压强度 $JCS$ 时，凸起会被压碎。此时的行为应该默认为在碎石屑上滑动，其摩擦角至少等于 $\\phi_r$。\n\n从计算实现角度的论证：\n在计算岩土力学软件中（例如，使用有限元法或离散元法），本构模型必须在数值上稳健且在物理上合理，以确保模拟的稳定性和意义。如果允许计算出的摩擦角 $\\phi_p$ 降至 $\\phi_r$ 以下，可能会导致不符合物理规律的材料软化和潜在的数值不稳定性，从而导致不收敛或错误的失效预测。为防止这种情况，Barton–Bandis 模型的实现几乎普遍包含一个条件检查。一个常见的实现是：\n$$\n\\phi_p = \\max\\left(\\phi_r, \\phi_r + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_n}\\right)\\right)\n$$\n这确保了峰值摩擦角永远不会被赋予小于残余摩擦角的值，从而保持了物理一致性并提高了数值解的稳定性。条件 $JCS \\ge \\sigma_n$ 正是防止这个下限函数被激活的标准。", "answer": "$$\n\\boxed{\\sigma_n}\n$$", "id": "3537034"}, {"introduction": "学习的最后一步是将理论付诸实践。这个练习模拟了计算岩土力学开发者的工作，要求你为一个完整的节理模型推导并实现其一致性切线刚度 [@problem_id:3537116]。这项实践对于理解本构律如何被整合到像牛顿-拉夫逊法这样的数值求解器中，以确保模拟的高效和精确收敛至关重要。", "problem": "考虑一个零厚度界面单元，该单元代表一个在正向-剪切混合模式加载下，使用 Barton-Bandis (BB) 节理本构法建模的岩石节理。设界面相对位移向量为 $\\boldsymbol{\\delta} = (\\delta_n, \\delta_s)$，其中 $\\delta_n$ 为法向闭合量（压缩为正，张开为负），$\\delta_s$ 为剪切滑移量（沿局部切向为正）。设相应的面力向量为 $\\mathbf{t} = (t_n, t_s)$，其中 $t_n$ 为法向应力，$t_s$ 为剪切应力（两者均以应力表示）。您需要推导并实现一致性切线分量 $\\partial t_n / \\partial \\delta_n$ 和 $\\partial t_s / \\partial \\delta_s$，这是求解非线性界面平衡的 Newton-Raphson 格式实现二次收敛所必需的。\n\n使用以下科学上公认的本构要素作为基础：\n\n- 法向应力-闭合关系，受 Barton-Bandis 双曲线定律启发：对于 $\\delta_n \\le 0$（张开），节理不承受压缩法向应力，即 $t_n = 0$。对于 $\\delta_n  0$（压缩），法向应力由下式给出\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m},\n$$\n其中 $k_{n0}$ 是初始法向刚度，$\\delta_m$ 是一个特征闭合尺度。这会产生物理上真实的非线性软化切线刚度，并在大闭合量下使法向应力渐近饱和。\n\n- 剪切应力演化通过光滑函数进行正则化，同时锚定于 Barton 峰值抗剪强度包络线。峰值抗剪强度 $\\tau_p(\\sigma_n)$ 作为有效法向应力 $\\sigma_n$ 的函数，由下式给出\n$$\n\\tau_p(\\sigma_n) = \n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right),  \\sigma_n  0, \\\\\n0,  \\sigma_n \\le 0,\n\\end{cases}\n$$\n其中 $\\phi_r$ 是残余摩擦角，$\\mathrm{JRC}$ 是节理粗糙度系数 (Joint Roughness Coefficient)，$\\mathrm{JCS}$ 是节理壁抗压强度 (Joint Wall Compressive Strength)。$\\tan(\\cdot)$ 中的角度必须以弧度为单位。剪切应力通过一个光滑滑移函数进行正则化\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n其中 $d_s$ 是一个特征滑移长度，控制着从初始类弹性响应到渐近摩擦强度的过渡。这种正则化确保了 $t_s$ 相对于 $\\delta_s$ 的可微性，并使得为 Newton-Raphson 格式提供一致性切线成为可能。在混合模式下，使用 $\\sigma_n = t_n(\\delta_n)$。\n\n任务：\n1. 严格从上述基础出发，推导一致性切线分量 $\\partial t_n / \\partial \\delta_n$ 和 $\\partial t_s / \\partial \\delta_s$ 的显式表达式，这些表达式适用于混合模式加载下的 Newton-Raphson 格式。在推导中，清晰说明为保证物理真实性所需的任何分段条件，并始终将 $\\partial t_s / \\partial \\delta_s$ 视为在固定 $\\delta_n$ 条件下对 $\\delta_s$ 的偏导数。\n2. 在一个程序中实现这些表达式，该程序用于对给定的参数集和 $(\\delta_n, \\delta_s)$，计算切线分量对 $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$。\n\n单位和角度规定：\n- 所有位移 $\\delta_n$ 和 $\\delta_s$ 必须以毫米（$\\mathrm{mm}$）为单位。\n- 所有应力 $t_n$, $t_s$, $\\sigma_n$, $\\mathrm{JCS}$ 必须以兆帕（$\\mathrm{MPa}$）为单位。\n- 刚度 $k_{n0}$ 和切线 $\\partial t_n / \\partial \\delta_n$, $\\partial t_s / \\partial \\delta_s$ 必须以 $\\mathrm{MPa}/\\mathrm{mm}$ 为单位。\n- 角度必须以度为单位提供，但在用于 $\\tan(\\cdot)$ 时需转换为弧度。\n\n测试套件：\n使用以下五个测试案例，每个案例由 $(\\delta_n, \\delta_s, k_{n0}, \\delta_m, \\mathrm{JRC}, \\mathrm{JCS}, \\phi_r, d_s)$ 指定：\n- 案例 1（一般混合模式，中等压缩和滑移）：$(\\delta_n, \\delta_s) = (0.5, 0.2)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$。\n- 案例 2（法向张开，零剪切）：$(\\delta_n, \\delta_s) = (-0.1, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$。\n- 案例 3（高压缩，大滑移）：$(\\delta_n, \\delta_s) = (20.0, 2.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$。\n- 案例 4（小压缩，零滑移）：$(\\delta_n, \\delta_s) = (0.05, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$。\n- 案例 5（无粗糙度，中等压缩和滑移）：$(\\delta_n, \\delta_s) = (1.0, 0.1)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 0$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是对应一个案例的切线分量对 $[\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s]$，格式化为嵌套列表，每个浮点值打印到小数点后六位，例如：$[[a_1,b_1],[a_2,b_2],\\dots]$。所有切线结果必须以 $\\mathrm{MPa}/\\mathrm{mm}$ 为单位表示。", "solution": "我们从本构定义中推导一致性切线分量，这些定义是计算岩石力学中用于岩石节理的、经过充分检验的公式。在 Newton-Raphson 格式中，目标是计算残差相对于位移增量的雅可比矩阵。对于零厚度界面，来自本构律的残差贡献涉及面力 $\\mathbf{t}(\\boldsymbol{\\delta})$。因此，所需的一致性切线分量是在当前状态下评估的面力分量相对于其相应位移分量的偏导数。\n\n法向推导：\n对于 $\\delta_n \\le 0$，节理处于张开状态，不承受压缩法向应力，因此 $t_n(\\delta_n) = 0$，切线为 $\\partial t_n / \\partial \\delta_n = 0$。对于 $\\delta_n  0$，法向应力为\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m}.\n$$\n设 $k_{n0}$ 和 $\\delta_m$ 为常数，且 $k_{n0}  0$ 和 $\\delta_m  0$。定义 $v(\\delta_n) = 1 + \\delta_n / \\delta_m$。则 $t_n(\\delta_n) = k_{n0} \\frac{\\delta_n}{v(\\delta_n)}$。根据商法则，\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{v(\\delta_n)\\cdot 1 - \\delta_n \\cdot \\frac{\\partial v}{\\partial \\delta_n}}{v(\\delta_n)^2}.\n$$\n由于 $\\frac{\\partial v}{\\partial \\delta_n} = \\frac{1}{\\delta_m}$，我们得到\n$$\n\\frac{\\partial}{\\partial \\delta_n}\\left(\\frac{\\delta_n}{v(\\delta_n)}\\right) = \\frac{1 + \\delta_n / \\delta_m - \\delta_n / \\delta_m}{\\left(1 + \\delta_n / \\delta_m\\right)^2} = \\frac{1}{\\left(1 + \\delta_n / \\delta_m\\right)^2}.\n$$\n因此，法向的一致性切线为\n$$\n\\frac{\\partial t_n}{\\partial \\delta_n} =\n\\begin{cases}\n0,  \\delta_n \\le 0, \\\\\n\\dfrac{k_{n0}}{\\left(1 + \\delta_n / \\delta_m\\right)^2},  \\delta_n  0.\n\\end{cases}\n$$\n\n剪切方向推导：\n我们通过将其锚定到 Barton 峰值抗剪强度包络线并使用光滑滑移函数来正则化剪切应力。作为有效法向应力 $\\sigma_n$ 的函数的峰值抗剪强度为\n$$\n\\tau_p(\\sigma_n) =\n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right),  \\sigma_n  0, \\\\\n0,  \\sigma_n \\le 0,\n\\end{cases}\n$$\n其中 $\\tan(\\cdot)$ 的参数以弧度为单位。在混合模式下，$\\sigma_n = t_n(\\delta_n)$。剪切应力定义为\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n且 $d_s  0$。对于关于 $\\delta_s$ 的一致性切线，我们考虑在固定 $\\delta_n$ 下的偏导数，这意味着在对 $t_s$ 求关于 $\\delta_s$ 的导数时，$\\sigma_n$ 保持不变。因此，\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s}\\bigg|_{\\delta_n} = \\tau_p(\\sigma_n) \\cdot \\frac{\\partial}{\\partial \\delta_s}\\left[\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right)\\right] = \\tau_p(\\sigma_n) \\cdot \\frac{1}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\n其中 $\\mathrm{sech}(x) = 1/\\cosh(x)$。考虑到 $\\tau_p(\\sigma_n)$ 中的物理分段条件，我们有\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} =\n\\begin{cases}\n0,  \\sigma_n \\le 0, \\\\\n\\dfrac{\\tau_p(\\sigma_n)}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\dfrac{\\delta_s}{d_s}\\right),  \\sigma_n  0.\n\\end{cases}\n$$\n\n单位和角度：\n- $\\delta_n$ 和 $\\delta_s$ 以 $\\mathrm{mm}$ 为单位。\n- $t_n$、$t_s$、$\\sigma_n$、$\\mathrm{JCS}$ 以 $\\mathrm{MPa}$ 为单位。\n- $k_{n0}$ 和切线分量 $\\partial t_n / \\partial \\delta_n$、$\\partial t_s / \\partial \\delta_s$ 以 $\\mathrm{MPa}/\\mathrm{mm}$ 为单位。\n- $\\phi_r$ 以度为单位提供，在 $\\tan(\\cdot)$ 的参数中必须通过 $\\phi_r^{\\mathrm{rad}} = \\phi_r^{\\circ}\\,\\pi/180$ 转换为弧度。\n- $\\log_{10}(\\cdot)$ 是以 10 为底的对数，与 Barton 公式一致。\n\n实现算法设计：\n1. 对于每个测试案例，读取 $\\delta_n$、$\\delta_s$、$k_{n0}$、$\\delta_m$、$\\mathrm{JRC}$、$\\mathrm{JCS}$、$\\phi_r$、$d_s$。\n2. 使用分段的、受 BB 启发的双曲线定律计算 $t_n$。然后使用推导出的封闭形式表达式计算 $\\partial t_n / \\partial \\delta_n$。\n3. 设 $\\sigma_n = t_n$。如果 $\\sigma_n \\le 0$，则设 $\\tau_p = 0$ 和 $\\partial t_s / \\partial \\delta_s = 0$。否则，计算 Barton 峰值强度\n$$\n\\theta^{\\circ} = \\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\frac{\\mathrm{JCS}}{\\sigma_n}\\right),\\quad \\theta^{\\mathrm{rad}} = \\theta^{\\circ}\\,\\frac{\\pi}{180},\n$$\n$$\n\\tau_p = \\sigma_n \\tan(\\theta^{\\mathrm{rad}}),\n$$\n然后计算\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} = \\frac{\\tau_p}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right) = \\frac{\\tau_p}{d_s}\\,\\frac{1}{\\cosh^2\\!\\left(\\frac{\\delta_s}{d_s}\\right)}.\n$$\n4. 收集每个案例的切线分量对 $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$。\n5. 将结果打印为单行，格式化为嵌套列表，每个浮点数保留六位小数：$[[a_1,b_1],[a_2,b_2],\\dots]$。\n\n此过程提供了 Newton-Raphson 求解器实现二次收敛所需的一致性切线，因为它们是在混合模式条件下，本构应力相对于位移分量的精确偏导数，同时尊重了法向的物理分段行为并确保了剪切方向的光滑性。", "answer": "[[32.000000,25.790919],[0.000000,0.000000],[0.413223,0.143093],[47.593254,5.072970],[22.222222,36.988019]]", "id": "3537116"}]}