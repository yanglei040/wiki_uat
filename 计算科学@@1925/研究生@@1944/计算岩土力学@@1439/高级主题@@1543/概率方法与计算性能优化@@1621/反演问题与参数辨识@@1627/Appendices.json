{"hands_on_practices": [{"introduction": "逆问题的核心挑战之一是解的唯一性。在着手进行复杂的参数识别之前，我们必须首先确定，给定的实验数据是否足以唯一地确定我们感兴趣的参数。本实践是一个思想实验 ([@problem_id:3535002])，旨在通过一个简化的岩土力学模型，培养对参数可识别性问题的直观理解。通过运用基本力学原理，我们将揭示在何种条件下，像内聚力这样的材料参数会对观测数据“隐身”，从而凸显实验设计与参数可识别性之间的关键联系。", "problem": "一个棱柱状土样占据一个矩形区域，其宽度为 $W$，高度为 $H$，单位厚度为 $t=1$。材料在屈服前遵循小应变线性弹性理论，其杨氏模量为 $E$，泊松比为 $\\nu$；屈服后遵循摩擦角为零 $\\phi=0$ 的理想弹塑性莫尔-库仑模型（Mohr–Coulomb）（纯黏性响应）。无体力。侧面无牵引力。底面固定。顶面受到一个向下的均匀指定竖向位移 $u_0$。假设圣维南原理适用，因此在这些边界条件下，内部应力状态可被视为均匀。\n\n考虑两种不同的黏聚力场：\n- 场 A：$c_A(x,y) \\equiv 0.50 \\,\\text{MPa}$，在整个区域内为常数。\n- 场 B：$c_B(x,y) = 0.20 \\,\\text{MPa} + 0.05 \\,\\text{MPa}\\,\\cos\\!\\left(\\pi y/H\\right)$，随 $y$ 变化且与 $x$ 无关。\n\n弹性常数和几何尺寸为\n$E=1.00\\times 10^{8}\\,\\text{Pa}$，$\\nu=0.30$，$H=1.00\\,\\text{m}$，$W=1.00\\,\\text{m}$，施加的位移为 $u_0=1.00\\times 10^{-3}\\,\\text{m}$。\n\n仅使用小应变的基本运动学、线性弹性的本构关系、牵引力的定义，以及当应力状态严格处于屈服域内时理想弹塑性行为简化为纯弹性演化这一事实，完成以下任务：\n\n1. 从第一性原理出发进行论证，在给定的边界条件下，内部应力状态可视为单轴应力状态，其中 $\\sigma_{yy}$ 是均匀的，且 $\\sigma_{xx}=\\sigma_{zz}=0$。并导出用 $E$、$u_0$ 和 $H$ 表示 $\\sigma_{yy}$ 的表达式。\n\n2. 对于 $\\phi=0$ 的莫尔-库仑模型，使用最大剪应力与主应力之间的标准关系，验证对于整个试样中的黏聚力场 $c_A$ 和 $c_B$ ，所产生的弹性应力状态均严格位于屈服域内。\n\n3. 判断对于这两种黏聚力场，顶面上的边界牵引力场是否相同，并解释在指定位移 $u_0$ 下，根据测得的边界牵引力识别黏聚力时出现任何非唯一性的结构原因。\n\n4. 计算顶面边界上的总竖向反力 $F$（以牛顿为单位）。将最终数值答案四舍五入至四位有效数字，并以牛顿表示。", "solution": "该问题在明确假设圣维南原理允许将内部应力状态视为均匀的前提下，被验证为科学上合理、适定且自洽。这种简化是工程力学中为绕过边界处的应力集中而采用的标准方法。\n\n按要求，解答过程分为四个部分。\n\n1. 内部应力状态和竖向应力分量 $\\sigma_{yy}$ 的推导。\n\n问题陈述内部应力状态可视为均匀。一个均匀应力场 $\\sigma_{ij}$（其中 $\\sigma_{ij}$ 为常数）在无体力时自动满足平衡方程 $\\partial_j \\sigma_{ij} = 0$。\n\n侧面（$x=0$ 和 $x=W$ 处）的边界条件是无牵引力。外法线为 $\\mathbf{n}$ 的表面上的牵引力矢量由 $\\mathbf{T} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 给出。\n对于 $x=W$ 处的面，法向为 $\\mathbf{n} = (1, 0, 0)$。牵引力分量为：\n$T_x = \\sigma_{xx} n_x = \\sigma_{xx}$\n$T_y = \\sigma_{yx} n_x = \\sigma_{yx}$\n$T_z = \\sigma_{zx} n_x = \\sigma_{zx}$\n由于该面无牵引力，$\\mathbf{T} = \\mathbf{0}$，这意味着 $\\sigma_{xx} = \\sigma_{yx} = \\sigma_{zx} = 0$。\n对无牵引力的前面和后面（$z$ 方向，法向为 $\\mathbf{n}=(0,0,\\pm 1)$）进行类似分析，可得 $\\sigma_{zz} = \\sigma_{yz} = \\sigma_{xz} = 0$。\n根据应力张量的对称性，$\\sigma_{ij} = \\sigma_{ji}$，我们有 $\\sigma_{xy} = \\sigma_{yx} = 0$，$\\sigma_{xz} = \\sigma_{zx} = 0$，以及 $\\sigma_{yz} = \\sigma_{zy} = 0$。\n唯一可能不为零的应力分量是 $\\sigma_{yy}$。因此，应力张量是单轴的：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\sigma_{yy}  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n试样顶面 $y=H$ 处受到均匀竖向位移 $u_y = -u_0$，而底面 $y=0$ 固定，即 $u_y=0$。均匀应力状态的假设意味着均匀应变状态。竖向应变 $\\varepsilon_{yy}$ 由小应变运动学定义为 $\\varepsilon_{yy} = \\frac{\\Delta L}{L_0}$。\n高度变化量为 $\\Delta L = u_y(H) - u_y(0) = -u_0 - 0 = -u_0$。原始高度为 $L_0 = H$。\n因此，均匀竖向应变为：\n$$\n\\varepsilon_{yy} = -\\frac{u_0}{H}\n$$\n材料的初始行为是线性弹性的。各向同性弹性材料在单轴应力下的本构关系（胡克定律）简化为：\n$$\n\\sigma_{yy} = E \\varepsilon_{yy}\n$$\n代入 $\\varepsilon_{yy}$ 的表达式，我们得到竖向应力的表达式：\n$$\n\\sigma_{yy} = E \\!\\left(-\\frac{u_0}{H}\\right) = -\\frac{E u_0}{H}\n$$\n该应力在整个试样中是均匀的，与初始假设一致。\n\n2. 验证两种黏聚力场下的应力状态均为弹性。\n\n材料根据莫尔-库仑准则屈服。当摩擦角 $\\phi=0$ 时，屈服函数简化为特雷斯卡准则，即当最大剪应力 $\\tau_{max}$ 达到黏聚力 $c$ 时发生屈服。材料严格保持在弹性域内的条件是：\n$$\n\\tau_{max}  c\n$$\n最大剪应力由 $\\tau_{max} = \\frac{\\sigma_1 - \\sigma_3}{2}$ 给出，其中 $\\sigma_1$ 和 $\\sigma_3$ 分别是最大和最小主应力。\n对于上面推导的单轴应力状态，非零应力为 $\\sigma_{yy}$。我们使用给定的参数计算其值：$E=1.00 \\times 10^8\\,\\text{Pa}$，$u_0=1.00 \\times 10^{-3}\\,\\text{m}$，$H=1.00\\,\\text{m}$。\n$$\n\\sigma_{yy} = -\\frac{(1.00 \\times 10^8\\,\\text{Pa})(1.00 \\times 10^{-3}\\,\\text{m})}{1.00\\,\\text{m}} = -1.00 \\times 10^5\\,\\text{Pa} = -0.100\\,\\text{MPa}\n$$\n正如预期的那样，应力是压应力。主应力是应力张量的特征值。对于我们得到的对角应力张量，主应力就是对角线元素：$\\{\\sigma_{yy}, 0, 0\\}$。\n对它们进行排序，我们得到 $\\sigma_1 = 0$，$\\sigma_2 = 0$ 和 $\\sigma_3 = \\sigma_{yy} = -0.100\\,\\text{MPa}$。\n因此，最大剪应力为：\n$$\n\\tau_{max} = \\frac{\\sigma_1 - \\sigma_3}{2} = \\frac{0 - (-0.100\\,\\text{MPa})}{2} = 0.050\\,\\text{MPa}\n$$\n现在我们必须将此值与每个场的黏聚力进行比较。\n- 场 A：黏聚力为常数，$c_A(x,y) = 0.50\\,\\text{MPa}$。弹性条件为 $\\tau_{max}  c_A$，即 $0.050\\,\\text{MPa}  0.50\\,\\text{MPa}$。此不等式成立。因此，对于黏聚力场 A，试样保持严格弹性。\n- 场 B：黏聚力随深度变化，$c_B(x,y) = 0.20\\,\\text{MPa} + 0.05\\,\\text{MPa}\\,\\cos(\\pi y/H)$。为确保整个试样保持弹性，最大剪应力必须小于区域内任何地方的黏聚力最小值。当 $\\cos(\\pi y/H)$ 取其最小值 $-1$ 时，$c_B$ 达到最小值。这发生在 $y=H$ 处。\n$$\nc_{B, \\text{min}} = 0.20\\,\\text{MPa} + 0.05\\,\\text{MPa}\\,(-1) = 0.15\\,\\text{MPa}\n$$\n弹性条件为 $\\tau_{max}  c_{B, \\text{min}}$，即 $0.050\\,\\text{MPa}  0.15\\,\\text{MPa}$。此不等式也成立。因此，对于黏聚力场 B，试样在其整个区域内也保持严格弹性。\n\n3. 关于边界牵引力和非唯一性的结论。\n\n顶面（$y=H$）上的边界牵引力矢量由 $\\mathbf{T} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 给出，其中从试样指出的外法线为 $\\mathbf{n}=(0, 1, 0)$。\n$$\n\\mathbf{T} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\sigma_{yy}  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\sigma_{yy} \\\\ 0 \\end{pmatrix}\n$$\n牵引力场是均匀的，并且只有一个竖向分量 $T_y = \\sigma_{yy} = -0.100\\,\\text{MPa}$。\n正如我们所证明的，$\\sigma_{yy}$ 的计算仅取决于弹性模量 $E$ 和施加的运动学条件（$u_0, H$）。该结果与黏聚力参数 $c$ 无关。由于对于场 A 和场 B，材料响应都是纯弹性的，因此两种情况下产生的应力状态 $\\sigma_{yy}$ 是相同的。因此，对于这两种黏聚力场，顶面上的边界牵引力场是相同的。\n\n产生非唯一性的结构原因是所施加的荷载（一个小位移 $u_0$）不足以引起塑性变形。从边界牵引力的测量值中识别黏聚力场 $c(x,y)$ 是一个反问题。在这种情况下，正演模型（材料属性与可观测测量值之间的关系）表明，对于弹性范围内的变形，边界牵引力仅取决于弹性参数（$E$, $\\nu$）。塑性参数（$c$, $\\phi$）不影响力学响应。由于测量值（边界牵引力）对我们希望识别的参数（黏聚力）不敏感，任何足以防止屈服的黏聚力场（即，处处满足 $c(x,y) > \\tau_{max}$）都将产生完全相同的边界牵引力。因此，无法通过本实验唯一地确定黏聚力场。\n\n4. 总竖向反力的计算。\n\n顶面边界上的总竖向反力 $F$ 是竖向反作用牵引力在该面面积上的积分。试样对加载压板施加的反作用牵引力与压板对试样施加的牵引力大小相等、方向相反。试样施加的力方向向上（$y$ 轴正方向），其大小等于 $|T_y|$ 在面积 $A = W \\times t$ 上的积分。\n给定 $W = 1.00\\,\\text{m}$ 和单位厚度 $t=1$，我们假设 $t = 1.00\\,\\text{m}$。面积为 $A = 1.00\\,\\text{m} \\times 1.00\\,\\text{m} = 1.00\\,\\text{m}^2$。\n竖向牵引力为 $T_y = \\sigma_{yy} = -1.00 \\times 10^5\\,\\text{Pa}$。这是 $y=H$ 下方的材料对上方材料施加的应力。施加在加载压板上的力方向相反（向上）。\n$$\nF = -T_y \\times A = -(\\sigma_{yy}) \\times (W \\cdot t)\n$$\n代入数值：\n$$\nF = -(-1.00 \\times 10^5\\,\\text{N/m}^2) \\times (1.00\\,\\text{m} \\times 1.00\\,\\text{m}) = 1.00 \\times 10^5\\,\\text{N}\n$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$\nF = 1.000 \\times 10^5\\,\\text{N}\n$$\n由于应力状态相同，该力对于两种黏聚力场是相同的。", "answer": "$$\n\\boxed{1.000 \\times 10^{5}}\n$$", "id": "3535002"}, {"introduction": "在解决了参数的可识别性问题后，我们面临的下一个实际挑战是如何处理充满噪声的真实世界数据。本实践将指导我们构建对异常值具有鲁棒性的反演算法。常规的最小二乘法对数据中的异常点非常敏感，而本推导 ([@problem_id:3534965]) 将展示，通过为测量误差选择一个更符合实际的统计模型（即具有“重尾”特征的学生$t$分布），我们可以从最大似然估计原理出发，自然地推导出迭代重加权最小二乘（IRLS）算法。", "problem": "在计算地质力学中，考虑一个在小应变线性弹性理论下的参数辨识反问题。一组位移传感器提供的观测值由模型 $d = F(m) + \\epsilon$ 描述，其中 $d \\in \\mathbb{R}^{n}$ 是观测到的位移向量，$F(m) \\in \\mathbb{R}^{n}$ 是将参数场 $m \\in \\mathbb{R}^{p}$（例如，一个离散化的杨氏模量场）映射到预测位移的正演模型，$\\epsilon \\in \\mathbb{R}^{n}$ 是测量误差。假设误差 $\\epsilon_{i}$ 是独立同分布的，服从自由度为 $\\nu  0$、尺度为 $s  0$ 的学生t分布 (Student's $t$ distribution)，其对于一个标量残差 $r$ 的概率密度函数为\n$$\np(r \\,|\\, \\nu, s) = \\frac{\\Gamma\\!\\left(\\frac{\\nu+1}{2}\\right)}{\\Gamma\\!\\left(\\frac{\\nu}{2}\\right)\\sqrt{\\nu \\pi}\\, s} \\left(1 + \\frac{1}{\\nu}\\left(\\frac{r}{s}\\right)^{2}\\right)^{-\\frac{\\nu+1}{2}} .\n$$\n定义残差向量为 $r(m) = d - F(m)$。利用最大似然原理，为参数估计构建负对数似然目标函数 $L(m)$。从该目标函数出发，并围绕当前迭代点 $m_{k}$ 对 $F(m)$ 进行高斯-牛顿 (Gauss–Newton) 线性化，其雅可比矩阵 (Jacobian) 为 $J = \\partial F/\\partial m \\big|_{m_{k}} \\in \\mathbb{R}^{n \\times p}$，推导由此产生的迭代重加权最小二乘法 (IRLS; Iteratively Reweighted Least Squares) 方案。特别地，请用标量残差 $r_{i}$、自由度 $\\nu$ 和尺度 $s$ 来表示 IRLS 法方程中的对角权重 $w_{i}$。此外，推导单个残差的稳健影响函数 $\\psi(r)$，其定义为单个残差的负对数似然函数关于 $r$ 的导数。\n\n提供 IRLS 权重 $w(r)$ 和影响函数 $\\psi(r)$ 的最终表达式，形式为关于 $r$、$\\nu$ 和 $s$ 的闭式解析表达式。不要求数值近似。最终答案必须是一个表达式，并且不应包含任何单位。", "solution": "目标是找到使观测数据 $d$ 的似然最大化的参数 $m$。这等价于最小化负对数似然函数 $L(m)$。\n\n鉴于测量误差 $\\epsilon_i$ 是独立同分布的，残差向量 $r(m)$ 的似然函数是其每个分量 $r_i(m)$ 的概率的乘积：\n$$\n\\mathcal{L}(m | d) = \\prod_{i=1}^{n} p(r_i(m) \\,|\\, \\nu, s)\n$$\n对数似然函数 $l(m)$ 是此表达式的对数：\n$$\nl(m) = \\ln(\\mathcal{L}(m | d)) = \\sum_{i=1}^{n} \\ln(p(r_i(m) \\,|\\, \\nu, s))\n$$\n代入给定的学生t分布的概率密度函数 (PDF)：\n$$\n\\ln(p(r \\,|\\, \\nu, s)) = \\ln\\left(\\frac{\\Gamma\\!\\left(\\frac{\\nu+1}{2}\\right)}{\\Gamma\\!\\left(\\frac{\\nu}{2}\\right)\\sqrt{\\nu \\pi}\\, s}\\right) - \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{1}{\\nu}\\left(\\frac{r}{s}\\right)^{2}\\right)\n$$\n负对数似然目标函数 $L(m) = -l(m)$ 是我们需要最小化的函数。在最小化过程中，与优化变量 $m$ 无关的常数项可以舍去。包含伽马函数、$\\nu$、$\\pi$ 和 $s$ 的项就是这样一个常数项。因此，最小化 $L(m)$ 等价于最小化各个残差目标函数 $\\rho(r_i)$ 的和：\n$$\nL(m) \\propto \\sum_{i=1}^{n} \\rho(r_i(m)), \\quad \\text{其中} \\quad \\rho(r) = \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{1}{\\nu}\\left(\\frac{r}{s}\\right)^{2}\\right)\n$$\n问题要求推导影响函数 $\\psi(r)$，其定义为单个残差的负对数似然函数关于残差 $r$ 的导数。这正是我们的 $\\rho(r)$ 的导数：\n$$\n\\psi(r) = \\frac{d\\rho(r)}{dr} = \\frac{d}{dr} \\left[ \\frac{\\nu+1}{2} \\ln\\left(1 + \\frac{r^2}{\\nu s^2}\\right) \\right]\n$$\n使用链式法则求导：\n$$\n\\psi(r) = \\frac{\\nu+1}{2} \\cdot \\frac{1}{1 + \\frac{r^2}{\\nu s^2}} \\cdot \\frac{d}{dr}\\left(\\frac{r^2}{\\nu s^2}\\right) = \\frac{\\nu+1}{2} \\cdot \\frac{1}{\\frac{\\nu s^2 + r^2}{\\nu s^2}} \\cdot \\frac{2r}{\\nu s^2}\n$$\n$$\n\\psi(r) = \\frac{\\nu+1}{2} \\cdot \\frac{\\nu s^2}{\\nu s^2 + r^2} \\cdot \\frac{2r}{\\nu s^2} = \\frac{(\\nu+1)r}{r^2 + \\nu s^2}\n$$\n这就是影响函数的表达式。\n\n接下来，我们推导迭代重加权最小二乘法 (IRLS) 方案。该优化问题是找到使目标函数梯度为零的 $m$：$\\nabla_m L(m) = 0$。\n使用链式法则，$\\nabla_m L(m) = \\sum_{i=1}^{n} \\frac{d\\rho(r_i)}{dr_i} \\nabla_m r_i(m)$。\n由于 $r(m) = d - F(m)$，我们有 $\\nabla_m r_i(m) = -\\nabla_m F_i(m)$。梯度 $\\nabla_m F_i(m)$ 是雅可比矩阵 $J^T$ 的列向量。因此，梯度可以写成矩阵形式：\n$$\n\\nabla_m L(m) = -J(m)^T \\psi(r(m))\n$$\n其中 $\\psi(r(m))$ 是一个分量为 $\\psi(r_i(m))$ 的向量。一阶最优性条件是 $J(m)^T \\psi(r(m)) = 0$。\n\nIRLS 方法将这个非线性方程组重构为一系列加权最小二乘问题。我们定义一个权重函数 $w(r)$，使得 $\\psi(r) = w(r) \\cdot r$。根据我们得到的 $\\psi(r)$ 表达式：\n$$\nw(r) = \\frac{\\psi(r)}{r} = \\frac{1}{r} \\left(\\frac{(\\nu+1)r}{r^2 + \\nu s^2}\\right) = \\frac{\\nu+1}{r^2 + \\nu s^2}\n$$\n这就是 IRLS 权重的表达式。注意，由于 $\\nu0$，这些权重始终为正，这是稳定算法的一个理想性质。\n\n根据这个定义，最优性条件变为 $J(m)^T W(m) r(m) = 0$，其中 $W(m)$ 是一个对角元素为 $w(r_i(m))$ 的对角矩阵。\nIRLS 算法按以下方式进行：在给定的迭代点 $m_k$，我们固定雅可比矩阵 $J_k = J(m_k)$ 和权重矩阵 $W_k = W(m_k)$，然后求解更新量 $\\delta m = m_{k+1} - m_k$。我们采用围绕 $m_k$ 的残差向量的高斯-牛顿线性化：\n$$\nr(m_{k+1}) = r(m_k + \\delta m) \\approx r(m_k) - J_k \\delta m\n$$\n将此代入为下一步计算的最优性条件中：\n$$\nJ_k^T W_k r(m_{k+1}) \\approx J_k^T W_k (r(m_k) - J_k \\delta m) = 0\n$$\n为求解未知的更新量 $\\delta m$ 进行整理：\n$$\nJ_k^T W_k J_k \\delta m = J_k^T W_k r(m_k)\n$$\n这是加权最小二乘问题的法方程组，在 IRLS 算法的每次迭代中求解该方程组以找到参数更新量 $\\delta m$。对角权重 $w_i$ 由 $w_i = w(r_i(m_k))$ 给出。\n\n所求的两个表达式是 IRLS 权重 $w(r)$ 和影响函数 $\\psi(r)$。\n$$\nw(r) = \\frac{\\nu+1}{r^2 + \\nu s^2}\n$$\n$$\n\\psi(r) = \\frac{(\\nu+1)r}{r^2 + \\nu s^2}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\nu+1}{r^2 + \\nu s^2}  \\frac{(\\nu+1)r}{r^2 + \\nu s^2} \\end{pmatrix}}\n$$", "id": "3534965"}, {"introduction": "在反演问题中，获得一个单一的“最佳”参数估计值往往是不够的，我们还需要知道这个估计的确定性有多高。本实践将我们带入贝叶斯推断的视角，专注于参数不确定性的量化。这个计算练习 ([@problem_id:3534949]) 以应用广泛的修正剑桥黏土模型为例，演示了如何使用高斯-牛顿近似来计算模型参数的后验协方差。通过这个过程，我们不仅能量化每个参数的不确定度，还能揭示参数之间的相关性，从而深入理解它们在物理上的权衡关系。", "problem": "考虑一个在小应变设定下修正剑桥模型的参数辨识问题，其中参数向量定义为 $\\boldsymbol{\\theta} = [\\lambda, \\kappa, M, p_{c0}, N]^\\top$。这些符号依次代表：孔隙比与平均有效应力自然对数坐标下的原始固结线斜率、卸载-再加载线斜率、三轴压缩中的临界状态应力比、初始预固结压力以及比容截距。假设一个观测模型基于两种标准实验模式：给出指定平均有效应力值下孔隙比的各向同性压缩-再加载实验，以及给出指定平均有效应力值下偏应力的临界状态排水三轴压缩实验。假设观测噪声为高斯噪声，参数的先验分布为高斯分布。使用最大后验 (MAP) 估计处的高斯-牛顿近似来逼近后验协方差，并解释相关性结构所体现的参数权衡。\n\n基本原理：\n- 对于高斯先验和加性高斯噪声，在MAP点进行线性化的贝叶斯定理给出了后验分布的高斯近似。在MAP点，负对数后验的高斯-牛顿Hessian近似为\n$$\\mathbf{H} \\approx \\mathbf{J}^\\top \\boldsymbol{\\Gamma}_{\\text{n}}^{-1} \\mathbf{J} + \\boldsymbol{\\Gamma}_{\\text{pr}}^{-1},$$\n其中 $\\mathbf{J}$ 是残差向量关于 $\\boldsymbol{\\theta}$ 在MAP点的雅可比矩阵，$\\boldsymbol{\\Gamma}_{\\text{n}}$ 是观测噪声协方差，$\\boldsymbol{\\Gamma}_{\\text{pr}}$ 是先验协方差。近似的后验协方差则为\n$$\\boldsymbol{\\Sigma}_{\\text{post}} \\approx \\mathbf{H}^{-1}。$$\n- 各向同性压缩-再加载的孔隙比模型由 $e$ 与 $\\ln p'$ 之间的标准分段线性关系近似：\n  - 对于 $p' \\ge p_{c0}$ (正常固结)：$e(p';\\boldsymbol{\\theta}) = N - \\lambda \\ln\\!\\left(\\dfrac{p'}{p_{\\text{ref}}}\\right)$。\n  - 对于 $p'  p_{c0}$ (超固结/再加载)：$e(p';\\boldsymbol{\\theta}) = N - \\lambda \\ln\\!\\left(\\dfrac{p_{c0}}{p_{\\text{ref}}}\\right) - \\kappa \\ln\\!\\left(\\dfrac{p_{c0}}{p'}\\right)$。\n- 排水三轴临界状态关系为 $q(p';\\boldsymbol{\\theta}) = M\\, p'$。\n\n假设 $p_{\\text{ref}} = 1$ kPa。假设所有孔隙比测量值 $e$ 具有独立同分布的高斯噪声，标准差为 $\\sigma_e$，所有临界状态 $q$ 测量值具有独立同分布的高斯噪声，标准差为 $\\sigma_q$。$\\boldsymbol{\\theta}$ 的先验是具有对角协方差的高斯分布。\n\n在MAP估计 $\\boldsymbol{\\theta}^{\\star}$ 处，通过堆叠每个模型预测对 $\\boldsymbol{\\theta}$ 的偏导数（在 $\\boldsymbol{\\theta}^{\\star}$ 处求值）来定义雅可比矩阵 $\\mathbf{J}$，使用以下表达式：\n- 对于每个在 $p'$ 处的孔隙比数据点：\n  - 若 $p' \\ge p_{c0}^{\\star}$，\n    $$\\frac{\\partial e}{\\partial \\lambda} = -\\ln\\!\\left(\\frac{p'}{p_{\\text{ref}}}\\right),\\quad \\frac{\\partial e}{\\partial \\kappa} = 0,\\quad \\frac{\\partial e}{\\partial M} = 0,\\quad \\frac{\\partial e}{\\partial p_{c0}} = 0,\\quad \\frac{\\partial e}{\\partial N} = 1.$$\n  - 若 $p'  p_{c0}^{\\star}$，\n    $$\\frac{\\partial e}{\\partial \\lambda} = -\\ln\\!\\left(\\frac{p_{c0}^{\\star}}{p_{\\text{ref}}}\\right),\\quad \\frac{\\partial e}{\\partial \\kappa} = -\\ln\\!\\left(\\frac{p_{c0}^{\\star}}{p'}\\right),\\quad \\frac{\\partial e}{\\partial M} = 0,\\quad \\frac{\\partial e}{\\partial p_{c0}} = -\\frac{\\lambda^{\\star}+\\kappa^{\\star}}{p_{c0}^{\\star}},\\quad \\frac{\\partial e}{\\partial N} = 1.$$\n- 对于每个在 $p'$ 处的临界状态数据点：\n  $$\\frac{\\partial q}{\\partial M} = p',\\quad \\frac{\\partial q}{\\partial \\lambda} = 0,\\quad \\frac{\\partial q}{\\partial \\kappa} = 0,\\quad \\frac{\\partial q}{\\partial p_{c0}} = 0,\\quad \\frac{\\partial q}{\\partial N} = 0.$$\n\n噪声协方差为 $\\boldsymbol{\\Gamma}_{\\text{n}} = \\operatorname{diag}(\\sigma_e^2,\\dots,\\sigma_e^2,\\sigma_q^2,\\dots,\\sigma_q^2)$，与堆叠的残差向量对齐。先验协方差为 $\\boldsymbol{\\Gamma}_{\\text{pr}} = \\operatorname{diag}(s_\\lambda^2, s_\\kappa^2, s_M^2, s_{p_{c0}}^2, s_N^2)$。\n\n你的任务是编写一个程序，对下面定义的每个测试用例执行以下步骤：\n1. 根据提供的观测横坐标和模型定义，在 $\\boldsymbol{\\theta}^{\\star}$ 处构造 $\\mathbf{J}$。\n2. 构造 $\\boldsymbol{\\Gamma}_{\\text{n}}$ 和 $\\boldsymbol{\\Gamma}_{\\text{pr}}$。\n3. 计算 $\\mathbf{H} = \\mathbf{J}^\\top \\boldsymbol{\\Gamma}_{\\text{n}}^{-1} \\mathbf{J} + \\boldsymbol{\\Gamma}_{\\text{pr}}^{-1}$。\n4. 计算 $\\boldsymbol{\\Sigma}_{\\text{post}} = \\mathbf{H}^{-1}$。\n5. 按照指定的输出格式，报告后验边际标准差 $\\sqrt{\\Sigma_{ii}}$（参数顺序为 $[\\lambda, \\kappa, M, p_{c0}, N]$）以及从 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 计算出的以下相关系数：\n   - $\\rho(N,\\lambda)$,\n   - $\\rho(\\kappa, p_{c0})$,\n   - $\\rho(M,\\lambda)$.\n\n使用以下常数和测试套件。所有压力单位均为千帕 (kPa)。所有孔隙比测量值均为无量纲。所有标准差都应报告为绝对值，相关系数为无量纲。以 kPa 为单位表示 $p_{c0}$ 的后验标准差。不涉及角度。\n\n所有测试用例的全局常数：\n- 参考压力：$p_{\\text{ref}} = 1$ kPa。\n- 噪声标准差：$\\sigma_e = 0.02$，$\\sigma_q = 10$ kPa。\n- 所有测试用例的MAP参数向量：\n  $$\\boldsymbol{\\theta}^{\\star} = [\\lambda^{\\star}, \\kappa^{\\star}, M^{\\star}, p_{c0}^{\\star}, N^{\\star}]^\\top = [0.2, 0.05, 1.2, 150, 2.0]^\\top.$$\n\n测试套件（每个用例指定孔隙比和临界状态测量的 $p'$ 值集合，以及先验标准差 $s$）：\n- 用例 A（均衡数据，中等先验）：\n  - 孔隙比横坐标 $p'_e$：$[25, 50, 100, 200, 400]$ kPa。\n  - 临界状态横坐标 $p'_q$：$[50, 100, 200, 400]$ kPa。\n  - 先验标准差 $[s_\\lambda, s_\\kappa, s_M, s_{p_{c0}}, s_N] = [0.05, 0.02, 0.2, 50, 0.2]$。\n- 用例 B（无临界状态数据；先验主导 $M$）：\n  - 孔隙比横坐标 $p'_e$：$[25, 50, 100, 200, 400]$ kPa。\n  - 临界状态横坐标 $p'_q$：空列表 $[\\ ]$。\n  - 先验标准差 $[s_\\lambda, s_\\kappa, s_M, s_{p_{c0}}, s_N] = [0.05, 0.02, 0.2, 50, 0.2]$。\n- 用例 C（孔隙比数据全在正常固结区；$\\kappa$ 和 $p_{c0}$ 的可辨识性弱）：\n  - 孔隙比横坐标 $p'_e$：$[200, 300, 400, 600, 800]$ kPa。\n  - 临界状态横坐标 $p'_q$：$[50, 100, 200, 400]$ kPa。\n  - 先验标准差 $[s_\\lambda, s_\\kappa, s_M, s_{p_{c0}}, s_N] = [0.05, 0.02, 0.2, 50, 0.2]$。\n\n最终输出格式：\n- 对于每个测试用例，按以下顺序生成一个包含8个值的列表：\n  $$[\\text{sd}_\\lambda, \\text{sd}_\\kappa, \\text{sd}_M, \\text{sd}_{p_{c0}}, \\text{sd}_N, \\rho(N,\\lambda), \\rho(\\kappa,p_{c0}), \\rho(M,\\lambda)].$$\n- 你的程序应生成单行输出，其中包含按测试套件顺序聚合到单个列表中的三个用例结果，格式为一个用方括号括起来的逗号分隔列表。每个内部列表必须包含四舍五入到六位小数的值。例如：\n  $$[[0.001234,0.005678,0.012345,1.234567,0.023456,-0.987654,0.123456,0.000000],[\\dots],[\\dots]].$$\n\n你的解答必须是纯算法的，从上述定义出发，且不得假设任何未知量。所有数值和单位必须完全按提供的方式处理。以 kPa 报告 $\\text{sd}_{p_{c0}}$，所有其他标准差和相关系数作为无量纲量报告，并四舍五入到六位小数。", "solution": "目标是给定一组实验数据点和参数的先验知识，确定修正剑桥土体模型参数的后验不确定性。这是一个贝叶斯参数辨识中的经典问题。我们将使用围绕最大后验 (MAP) 估计的线性化近似，这将后验分布简化为一个多元高斯分布。后验协方差矩阵量化了参数的不确定性和相关性，其近似为在 MAP 估计处求值的负对数后验函数的Hessian矩阵的逆。\n\n参数向量定义为 $\\boldsymbol{\\theta} = [\\lambda, \\kappa, M, p_{c0}, N]^\\top$，包含修正剑bridge模型的五个关键参数。问题提供了 MAP 估计 $\\boldsymbol{\\theta}^{\\star}$，任务是使用高斯-牛顿近似计算后验协方差 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 的 Hessian 矩阵 $\\mathbf{H}$。\n\nHessian 矩阵的公式如下：\n$$\n\\mathbf{H} \\approx \\mathbf{J}^\\top \\boldsymbol{\\Gamma}_{\\text{n}}^{-1} \\mathbf{J} + \\boldsymbol{\\Gamma}_{\\text{pr}}^{-1}\n$$\n其中 $\\mathbf{J}$ 是模型预测关于参数 $\\boldsymbol{\\theta}$ 的雅可比矩阵，$\\boldsymbol{\\Gamma}_{\\text{n}}$ 是观测噪声的协方差矩阵，$\\boldsymbol{\\Gamma}_{\\text{pr}}$ 是参数高斯先验的协方差矩阵。\n\n为每个测试用例求解此问题的步骤如下：\n\n1.  **构造雅可比矩阵 ($\\mathbf{J}$)**：雅可比矩阵的每一行对应一个观测，每一列对应一个参数。一个元素 $J_{ij}$ 是第 $i$ 个模型预测对第 $j$ 个参数的偏导数，即 $\\partial f_i / \\partial \\theta_j$。预测值 $f_i$ 来自两个模型：\n    -   一个孔隙比 $e$ 作为平均有效应力 $p'$ 函数的模型，依赖于参数 $\\lambda, \\kappa, p_{c0}, N$。\n    -   一个在临界状态下偏应力 $q$ 作为 $p'$ 函数的模型，依赖于参数 $M$。\n    \n    问题为这些偏导数提供了显式公式，它们在 MAP 估计 $\\boldsymbol{\\theta}^{\\star} = [0.2, 0.05, 1.2, 150, 2.0]^\\top$ 和每次测量给定的压力值处进行求值。雅可比矩阵将有 $m = n_e + n_q$ 行（其中 $n_e$ 和 $n_q$ 分别是孔隙比和临界状态测量的数量）和 5 列。\n\n2.  **构造噪声和先验协方差矩阵**：\n    -   观测噪声被假定为独立的高斯噪声。因此，噪声协方差 $\\boldsymbol{\\Gamma}_{\\text{n}}$ 是一个对角矩阵。对角线上的元素对于 $n_e$ 个孔隙比测量是 $\\sigma_e^2 = (0.02)^2$，对于 $n_q$ 个临界状态测量是 $\\sigma_q^2 = (10)^2$。其逆矩阵 $\\boldsymbol{\\Gamma}_{\\text{n}}^{-1}$ 也是对角矩阵，元素为 $1/\\sigma_e^2$ 和 $1/\\sigma_q^2$。\n    -   参数的先验也是高斯分布，具有对角协方差矩阵 $\\boldsymbol{\\Gamma}_{\\text{pr}}$。对角线元素是先验标准差的平方，即 $[s_\\lambda^2, s_\\kappa^2, s_M^2, s_{p_{c0}}^2, s_N^2]$，这些值为每个测试用例提供。其逆矩阵 $\\boldsymbol{\\Gamma}_{\\text{pr}}^{-1}$ 是一个对角矩阵，元素为 $1/s_j^2$。\n\n3.  **计算Hessian矩阵 ($\\mathbf{H}$)**：构造好 $\\mathbf{J}$、$\\boldsymbol{\\Gamma}_{\\text{n}}^{-1}$ 和 $\\boldsymbol{\\Gamma}_{\\text{pr}}^{-1}$ 后，通过矩阵乘法和加法，使用提供的公式计算 Hessian 矩阵 $\\mathbf{H}$。项 $\\mathbf{J}^\\top \\boldsymbol{\\Gamma}_{\\text{n}}^{-1} \\mathbf{J}$ 代表从数据中获得的信息（似然），而 $\\boldsymbol{\\Gamma}_{\\text{pr}}^{-1}$ 代表来自先验的信息。\n\n4.  **计算后验协方差 ($\\boldsymbol{\\Sigma}_{\\text{post}}$)**：近似的后验协方差矩阵是 Hessian 矩阵的逆：\n    $$\n    \\boldsymbol{\\Sigma}_{\\text{post}} \\approx \\mathbf{H}^{-1}\n    $$\n    这个 $5 \\times 5$ 矩阵的对角线上包含参数的方差，非对角元素是协方差。\n\n5.  **提取结果**：\n    -   每个参数 $\\theta_i$ 的后验边际标准差是后验协方差矩阵对应对角元素的平方根：$\\text{sd}_i = \\sqrt{(\\boldsymbol{\\Sigma}_{\\text{post}})_{ii}}$。\n    -   两个参数 $\\theta_i$ 和 $\\theta_j$ 之间的相关系数计算如下：\n        $$\n        \\rho(\\theta_i, \\theta_j) = \\frac{(\\boldsymbol{\\Sigma}_{\\text{post}})_{ij}}{\\sqrt{(\\boldsymbol{\\Sigma}_{\\text{post}})_{ii} (\\boldsymbol{\\Sigma}_{\\text{post}})_{jj}}}\n        $$\n    \n    每个测试用例所需的量是五个后验标准差（$\\text{sd}_\\lambda$, $\\text{sd}_\\kappa$, $\\text{sd}_M$, $\\text{sd}_{p_{c0}}$, $\\text{sd}_N$）和三个特定的相关系数（$\\rho(N,\\lambda)$, $\\rho(\\kappa,p_{c0})$, $\\rho(M,\\lambda)$）。\n\n从雅可比矩阵的结构中可以得到一个重要的洞见。孔隙比 $e$ 对参数 $M$ 的灵敏度为零。反之，临界状态应力 $q$ 对参数 $\\lambda$、$\\kappa$、$p_{c0}$ 和 $N$ 的灵敏度也为零。这种结构上的分离意味着 Hessian 矩阵 $\\mathbf{H}$ 将是块对角的，一个块对应参数 $M$，另一个块对应其余四个参数。因此，其逆矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 也将是块对角的。这意味着 $M$ 的后验估计将与其他四个参数的后验估计在统计上不相关。因此，对于所有测试用例，$\\rho(M,\\lambda)$ 在数学上期望为零。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the series of test cases for a parameter identification problem.\n    \"\"\"\n    # Global constants\n    p_ref = 1.0  # kPa\n    sigma_e = 0.02\n    sigma_q = 10.0  # kPa\n    theta_star = np.array([0.2, 0.05, 1.2, 150.0, 2.0])  # [lambda, kappa, M, pc0, N]\n\n    # Test suite\n    test_suite = {\n        \"Case A\": {\n            \"p_e_values\": [25.0, 50.0, 100.0, 200.0, 400.0],\n            \"p_q_values\": [50.0, 100.0, 200.0, 400.0],\n            \"s_prior\": [0.05, 0.02, 0.2, 50.0, 0.2]\n        },\n        \"Case B\": {\n            \"p_e_values\": [25.0, 50.0, 100.0, 200.0, 400.0],\n            \"p_q_values\": [],\n            \"s_prior\": [0.05, 0.02, 0.2, 50.0, 0.2]\n        },\n        \"Case C\": {\n            \"p_e_values\": [200.0, 300.0, 400.0, 600.0, 800.0],\n            \"p_q_values\": [50.0, 100.0, 200.0, 400.0],\n            \"s_prior\": [0.05, 0.02, 0.2, 50.0, 0.2]\n        }\n    }\n    \n    all_results = []\n    \n    for case_name in [\"Case A\", \"Case B\", \"Case C\"]:\n        case_data = test_suite[case_name]\n        result = _calculate_posterior_covariance(\n            p_e_values=case_data[\"p_e_values\"],\n            p_q_values=case_data[\"p_q_values\"],\n            s_prior=case_data[\"s_prior\"],\n            theta_star=theta_star,\n            p_ref=p_ref,\n            sigma_e=sigma_e,\n            sigma_q=sigma_q\n        )\n        all_results.append(result)\n\n    # Format output as specified\n    formatted_results = []\n    for res in all_results:\n        # Use a list comprehension to format each number, then join with commas\n        formatted_res_list = [f\"{x:.6f}\" for x in res]\n        formatted_results.append(f\"[{','.join(formatted_res_list)}]\")\n    \n    # Final output string\n    final_output = f\"[[{formatted_results[0][1:-1]}],[{formatted_results[1][1:-1]}],[{formatted_results[2][1:-1]}]]\"\n    print(final_output)\n\n\ndef _calculate_posterior_covariance(\n    p_e_values, p_q_values, s_prior, theta_star, p_ref, sigma_e, sigma_q\n):\n    \"\"\"\n    Calculates the posterior covariance matrix and derived quantities for one test case.\n    \"\"\"\n    lambda_star, kappa_star, _, pc0_star, _ = theta_star\n    n_params = 5\n\n    J_rows = []\n    Gamma_n_inv_diag = []\n\n    # Parameter indices: 0:lambda, 1:kappa, 2:M, 3:pc0, 4:N\n    \n    # Process void ratio measurements\n    for p_prime in p_e_values:\n        j_row = np.zeros(n_params)\n        if p_prime = pc0_star:\n            # Normally consolidated branch\n            j_row[0] = -np.log(p_prime / p_ref)  # d(e)/d(lambda)\n            j_row[4] = 1.0                      # d(e)/d(N)\n        else:\n            # Overconsolidated branch\n            j_row[0] = -np.log(pc0_star / p_ref) # d(e)/d(lambda)\n            j_row[1] = -np.log(pc0_star / p_prime) # d(e)/d(kappa)\n            j_row[3] = -(lambda_star + kappa_star) / pc0_star  # d(e)/d(pc0)\n            j_row[4] = 1.0                       # d(e)/d(N)\n        \n        J_rows.append(j_row)\n        Gamma_n_inv_diag.append(1.0 / sigma_e**2)\n\n    # Process critical state measurements\n    for p_prime in p_q_values:\n        j_row = np.zeros(n_params)\n        j_row[2] = p_prime  # d(q)/d(M)\n        J_rows.append(j_row)\n        Gamma_n_inv_diag.append(1.0 / sigma_q**2)\n    \n    # Construct Jacobian and inverse noise covariance matrix\n    if not J_rows:\n        J = np.zeros((0, n_params))\n    else:\n        J = np.array(J_rows)\n    \n    Gamma_n_inv = np.diag(Gamma_n_inv_diag)\n    \n    # Calculate Hessian term from data\n    if J.shape[0] == 0:\n        H_data = np.zeros((n_params, n_params))\n    else:\n        H_data = J.T @ Gamma_n_inv @ J\n\n    # Calculate Hessian term from prior\n    s_prior_sq = np.array(s_prior)**2\n    # handle potential division by zero if a prior std dev is 0\n    with np.errstate(divide='ignore'):\n        Gamma_pr_inv_diag = 1.0 / s_prior_sq\n    Gamma_pr_inv_diag[np.isinf(Gamma_pr_inv_diag)] = 0 # should not happen with given data\n    Gamma_pr_inv = np.diag(Gamma_pr_inv_diag)\n    \n    # Total Hessian of negative log posterior\n    H = H_data + Gamma_pr_inv\n    \n    # Posterior covariance is the inverse of the Hessian\n    Sigma_post = np.linalg.inv(H)\n    \n    # Extract results: standard deviations and correlations\n    post_std_devs = np.sqrt(np.diag(Sigma_post))\n    \n    def get_corr(i, j, sigma_matrix, std_devs):\n        if std_devs[i] == 0 or std_devs[j] == 0:\n            return 0.0\n        return sigma_matrix[i, j] / (std_devs[i] * std_devs[j])\n\n    rho_N_lambda = get_corr(4, 0, Sigma_post, post_std_devs)\n    rho_kappa_pc0 = get_corr(1, 3, Sigma_post, post_std_devs)\n    rho_M_lambda = get_corr(2, 0, Sigma_post, post_std_devs)\n    \n    result = [\n        post_std_devs[0], \n        post_std_devs[1], \n        post_std_devs[2], \n        post_std_devs[3], \n        post_std_devs[4],\n        rho_N_lambda,\n        rho_kappa_pc0,\n        rho_M_lambda\n    ]\n    \n    return result\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3534949"}]}