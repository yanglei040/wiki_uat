{"hands_on_practices": [{"introduction": "第一个练习是一项基础性训练。它剥离了大规模模拟的复杂性，专注于本征正交分解（POD）的核心机制。通过为一个极小的数据集手动计算POD模态，你将对快照数据如何被转换成一组最优基向量有一个具体的理解。[@problem_id:3553475] 这个练习将巩固POD的理论定义与求解相关矩阵特征值问题的实际步骤之间的联系。", "problem": "在一个平面应变岩土力学边值问题的有限元模拟中，假设位移场已通过静态凝聚简化为两个主导自由度，并且已经计算了三个准静态加载步。设快照矩阵为 $2 \\times 3$ 矩阵\n$$\nX=\\begin{bmatrix}1  1  0 \\\\ 0  1  1\\end{bmatrix},\n$$\n其中第 $j$ 列存储了加载步 $j$ 的离散位移向量。采用标准的欧几里得内积，因此权重矩阵为 $W=I$，其中 $I$ 表示 $2 \\times 2$ 的单位矩阵。\n\n使用本征正交分解（POD）的变分定义，即第一阶模态 $u_{1}$ 是在关于 $W$ 的归一化约束下，快照在 $u_{1}$ 上的均方投影的约束最大化问题的解，从第一性原理推导表征 $W=I$ 时 POD 模态的相关性特征问题。然后，对于给定的 $X$：\n- 显式计算前两阶 POD 模态 $u_{1}$ 和 $u_{2}$，确保在 $W$ 内积下精确归一化，并为每个模态明确指定一致的符号约定。\n- 计算形成最优一阶 POD 重构 $\\widehat{X}_{1}$ 所需的相关奇异值，以及对应于 $u_{1}$ 和 $u_{2}$ 的右奇异向量。\n- 将最优一阶 POD 重构定义为 $\\widehat{X}_{1}=\\sigma_{1}\\,u_{1}\\,v_{1}^{\\top}$，残差定义为 $R=X-\\widehat{X}_{1}$。仅使用基本定义和结果，计算弗罗贝尼乌斯范数 $\\|R\\|_{F}$。\n\n最终答案请提供等于 $\\|R\\|_{F}$ 的单个实数。如果您选择对任何中间量进行近似，请将最终答案四舍五入到四位有效数字。最终答案不包含单位。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 上下文是平面应变岩土力学边值问题的有限元模拟。\n- 快照矩阵是 $X=\\begin{bmatrix}1  1  0\\\\ 0  1  1\\end{bmatrix}$，一个 $2 \\times 3$ 矩阵。各列代表 3 个准静态加载步的离散位移向量。\n- 权重矩阵是 $W=I$，即 $2 \\times 2$ 的单位矩阵。内积是标准的欧几里得内积。\n- 第一阶 POD 模态 $u_{1}$ 被定义为在关于 $W$ 的归一化约束下，快照在 $u_{1}$ 上的均方投影的约束最大化问题的解。\n- 要求任务：\n    1. 从第一性原理推导 $W=I$ 时的相关性特征问题。\n    2. 计算前两阶 POD 模态 $u_{1}$ 和 $u_{2}$。\n    3. 计算相关的奇异值和右奇异向量。\n    4. 将最优一阶 POD 重构定义为 $\\widehat{X}_{1}=\\sigma_{1}\\,u_{1}\\,v_{1}^{\\top}$。\n    5. 计算残差 $R=X-\\widehat{X}_{1}$ 的弗罗贝尼乌斯范数，记为 $\\|R\\|_{F}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用本征正交分解（POD），这是计算力学（包括岩土力学）中一种标准且广泛使用的模型降阶技术。通过变分原理的公式化及其与奇异值分解（SVD）的联系是线性代数和数据分析中的基本概念。该问题基于已建立的数学原理。\n- **适定性：** 问题提供了所有必要信息（快照矩阵 $X$，权重矩阵 $W$），并要求计算具体的、可计算的量。矩阵维度是一致的。对于任何非零矩阵 $X$，POD 模态（在符号上可能不同）和奇异值的存在性和唯一性是有保证的。\n- **客观性：** 问题以精确的数学语言陈述，没有歧义或主观论断。任务定义清晰。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它具有科学依据、适定性、客观性和自包含性。解法将如下推导。\n\n### 解答\n\n**第一部分：相关性特征问题的推导**\n\n第一阶 POD 模态 $u_1$ 的变分问题是，在归一化约束下，最大化快照在向量 $u$ 上的均方投影。设快照数量为 $N_s = 3$。快照是矩阵 $X$ 的列，记为 $x_j \\in \\mathbb{R}^2$，其中 $j=1, 2, 3$。\n\n快照 $x_j$ 在向量 $u$ 上的投影由内积 $\\langle x_j, u \\rangle_W = u^T W x_j$ 给出。由于 $W=I$，这就是标准的点积 $u^T x_j$。\n均方投影是要最大化的目标函数：\n$$J(u) = \\frac{1}{N_s} \\sum_{j=1}^{N_s} (\\langle x_j, u \\rangle_W)^2 = \\frac{1}{3} \\sum_{j=1}^{3} (u^T x_j)^2$$\n归一化约束为 $\\langle u, u \\rangle_W = 1$，可简化为 $u^T W u = u^T I u = u^T u = 1$。\n\n我们可以使用矩阵表示法重写目标函数：\n$$J(u) = \\frac{1}{3} \\sum_{j=1}^{3} (u^T x_j)(x_j^T u) = u^T \\left( \\frac{1}{3} \\sum_{j=1}^{3} x_j x_j^T \\right) u$$\n矩阵 $X$ 由 $X = \\begin{bmatrix} x_1  x_2  x_3 \\end{bmatrix}$ 给出。求和可以写成矩阵乘积 $XX^T = \\sum_{j=1}^{3} x_j x_j^T$。\n因此，目标函数为 $J(u) = u^T \\left(\\frac{1}{3} XX^T\\right) u$。\n\n我们使用拉格朗日乘子法来解决这个约束优化问题：\n最大化 $J(u)$，约束条件为 $g(u) = u^T u - 1 = 0$。\n拉格朗日函数为 $\\mathcal{L}(u, \\lambda) = J(u) - \\lambda g(u) = u^T \\left(\\frac{1}{3} XX^T\\right) u - \\lambda(u^T u - 1)$。\n为求驻点，我们对 $u$ 求梯度并令其为零：\n$$\\nabla_u \\mathcal{L} = 2 \\left(\\frac{1}{3} XX^T\\right) u - 2\\lambda u = 0$$\n这可以简化为特征问题：\n$$\\left(\\frac{1}{3} XX^T\\right) u = \\lambda u$$\n这就是相关性特征问题。矩阵 $C_X = \\frac{1}{3} XX^T$ 称为空间相关矩阵。POD 模态 $u_i$ 是 $C_X$ 的特征向量，相应的特征值 $\\lambda_i$ 代表每个模态捕获的平均能量。\n\n**第二部分：POD 模态和奇异值的计算**\n\n首先，计算矩阵 $K = XX^T$：\n$$K = XX^T = \\begin{bmatrix}1  1  0\\\\ 0  1  1\\end{bmatrix} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} = \\begin{bmatrix} (1)(1)+(1)(1)+(0)(0)  (1)(0)+(1)(1)+(0)(1) \\\\ (0)(1)+(1)(1)+(1)(0)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix}2  1\\\\ 1  2\\end{bmatrix}$$\nPOD 模态是 $C_X = \\frac{1}{3}K$ 的特征向量，这与 $K$ 的特征向量相同。设 $\\theta$ 为 $K$ 的特征值。特征方程为 $\\det(K - \\theta I) = 0$。\n$$\\det\\begin{pmatrix} 2-\\theta  1 \\\\ 1  2-\\theta \\end{pmatrix} = (2-\\theta)^2 - 1 = 0 \\implies \\theta^2 - 4\\theta + 3 = 0$$\n因式分解得到 $(\\theta-3)(\\theta-1)=0$。$K$ 的特征值为 $\\theta_1 = 3$ 和 $\\theta_2 = 1$，按大小降序排列。\n\n对于 $\\theta_1 = 3$：\n$$(K - 3I)u_1 = \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies -a+b=0 \\implies a=b$$\n未归一化的特征向量为 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。将其归一化：$u_1 = \\frac{1}{\\sqrt{1^2+1^2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。我们采用第一个非零元素为正的符号约定。\n\n对于 $\\theta_2 = 1$：\n$$(K - 1I)u_2 = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies a+b=0 \\implies a=-b$$\n未归一化的特征向量为 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。将其归一化：$u_2 = \\frac{1}{\\sqrt{1^2+(-1)^2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\nPOD 模态为 $u_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $u_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\nPOD 模态 $u_i$ 是 $X$ 的左奇异向量。奇异值 $\\sigma_i$ 与 $XX^T$ 的特征值 $\\theta_i$ 相关，关系为 $\\sigma_i = \\sqrt{\\theta_i}$。\n$$\\sigma_1 = \\sqrt{\\theta_1} = \\sqrt{3}$$\n$$\\sigma_2 = \\sqrt{\\theta_2} = \\sqrt{1} = 1$$\n\n**第三部分：右奇异向量的计算**\n\n右奇异向量 $v_i$ 是 SVD 分解 $X=U\\Sigma V^T$ 中矩阵 $V$ 的列。它们可以通过关系式 $v_i = \\frac{1}{\\sigma_i} X^T u_i$ 计算得出。\n对于 $v_1$：\n$$v_1 = \\frac{1}{\\sigma_1}X^T u_1 = \\frac{1}{\\sqrt{3}} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 1 \\\\ 2 \\\\ 1 \\end{bmatrix}$$\n对于 $v_2$：\n$$v_2 = \\frac{1}{\\sigma_2}X^T u_2 = \\frac{1}{1} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 0 \\\\ -1 \\end{bmatrix}$$\n\n**第四部分：残差的弗罗贝尼乌斯范数计算**\n\n$X$ 的奇异值分解由 $X = \\sum_{i=1}^r \\sigma_i u_i v_i^T$ 给出，其中 $r = \\mathrm{rank}(X)=2$。\n$$X = \\sigma_1 u_1 v_1^T + \\sigma_2 u_2 v_2^T$$\n最优一阶 POD 重构为 $\\widehat{X}_1 = \\sigma_1 u_1 v_1^T$。\n残差矩阵为 $R = X - \\widehat{X}_1$。\n$$R = (\\sigma_1 u_1 v_1^T + \\sigma_2 u_2 v_2^T) - \\sigma_1 u_1 v_1^T = \\sigma_2 u_2 v_2^T$$\n矩阵 $M$ 的弗罗贝尼乌斯范数是 $\\|M\\|_F = \\sqrt{\\mathrm{tr}(M^T M)}$。对于外积 $ab^T$ 的弗罗贝尼乌斯范数，一个基本结果是 $\\|ab^T\\|_F = \\|a\\|_2 \\|b\\|_2$，其中 $\\| \\cdot \\|_2$ 是标准的欧几里得向量范数。\n\n将此结果应用于残差矩阵 $R$：\n$$\\|R\\|_F = \\|\\sigma_2 u_2 v_2^T\\|_F = \\|\\sigma_2 u_2\\|_2 \\|v_2\\|_2$$\n由于 $\\sigma_2$ 是一个标量，$\\|\\sigma_2 u_2\\|_2 = |\\sigma_2| \\|u_2\\|_2$。\n向量 $u_2$ 和 $v_2$ 是奇异向量，根据构造它们是标准正交的。因此，$\\|u_2\\|_2 = 1$ 和 $\\|v_2\\|_2 = 1$。\n$$\\|R\\|_F = \\sigma_2 \\cdot 1 \\cdot 1 = \\sigma_2$$\n我们发现第二个奇异值为 $\\sigma_2=1$。\n因此，残差的弗罗贝尼乌斯范数为：\n$$\\|R\\|_F = 1$$\n\n作为验证，我们可以显式计算 $R$：\n$$R = \\sigma_2 u_2 v_2^T = 1 \\cdot \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) \\cdot \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  0  -1 \\end{pmatrix}\\right) = \\frac{1}{2}\\begin{pmatrix} 1  0  -1\\\\ -1  0  1\\end{pmatrix}$$\n弗罗贝尼乌斯范数的平方是其所有元素平方的总和：\n$$\\|R\\|_F^2 = \\left(\\frac{1}{2}\\right)^2 + 0^2 + \\left(-\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + 0^2 + \\left(\\frac{1}{2}\\right)^2$$\n$$\\|R\\|_F^2 = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} = 4 \\cdot \\frac{1}{4} = 1$$\n因此，$\\|R\\|_F = \\sqrt{1} = 1$。这证实了结果。最终答案是一个精确的整数，因此不需要四舍五入。", "answer": "$$\\boxed{1}$$", "id": "3553475"}, {"introduction": "一旦我们获得了一组POD基向量，下一步就是用它们来建立一个降阶模型（ROM）。这个练习展示了伽辽金投影（Galerkin projection）这一关键步骤。你将使用一个给定的基向量，将一个全阶方程系统投影到它上面，从而将一个复杂的矩阵方程简化为一个简单的标量方程。[@problem_id:3553438] 这个练习阐明了POD如何作为创建复杂物理系统的高效计算模型的基础。", "problem": "通过有限元方法离散化的线性准静态地质力学模型可导出代数系统 $K u = f$，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定刚度矩阵，$f \\in \\mathbb{R}^{n}$ 是载荷向量。通过本征正交分解（POD）构建了一个降阶模型，该模型使用单个试验基向量 $V \\in \\mathbb{R}^{n \\times 1}$，此基向量已根据由对称正定矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 导出的加权内积进行了归一化。近似位移被参数化为 $u \\approx \\bar{u} + V a$，其中 $\\bar{u} \\in \\mathbb{R}^{n}$ 是一个基准场，$a \\in \\mathbb{R}$ 是降阶坐标。通过强制残差 $r(u) = K u - f$ 相对于 $W$-加权内积与测试空间正交，可以得到降阶方程。\n\n考虑 $n=2$ 的示例模型，\n$$\nK=\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix}, \n\\qquad \nf=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\n\\qquad \n\\bar{u}=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\n\\qquad\nV=\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix},\n\\qquad\nW=I,\n$$\n其中 $I$ 是单位矩阵。利用关于 $W$-加权内积的残差正交性条件，推导降阶标量平衡方程，计算降阶算子，并求解降阶系数 $a$。\n\n最终答案仅需陈述 $a$ 的值。无需单位。不要对答案进行四舍五入；请提供精确值。", "solution": "用户提供的问题已经过验证，并被确定为计算力学中的一个有效的、适定的问题。所有提供的数据都是自洽且一致的。\n\n该问题要求解一个通过本征正交分解（POD）和伽辽金投影获得的降阶模型。近似位移场 $u \\in \\mathbb{R}^{n}$ 被参数化为基准场 $\\bar{u} \\in \\mathbb{R}^{n}$ 和单个试验基向量 $V \\in \\mathbb{R}^{n \\times 1}$ 的线性组合：\n$$u \\approx \\bar{u} + V a$$\n其中 $a \\in \\mathbb{R}$ 是待求的降阶坐标。\n\n全阶模型是线性代数系统 $K u = f$。对于给定的近似位移 $u$，残差定义为：\n$$r(u) = K u - f$$\n将 $u$ 的参数化近似代入，残差变为 $a$ 的函数：\n$$r(a) = K(\\bar{u} + V a) - f = K \\bar{u} + (K V) a - f$$\n\n降阶模型是通过强制执行伽辽金条件推导出来的，该条件规定残差必须与测试空间正交。在此问题中，测试空间由相同的基向量 $V$ 张成，且正交性是关于 $W$-加权内积定义的。两个向量 $x, y \\in \\mathbb{R}^{n}$ 的内积为 $(x, y)_W = x^T W y$。因此，正交性条件为：\n$$(V, r(a))_W = 0$$\n用矩阵表示法即为：\n$$V^T W r(a) = 0$$\n代入残差 $r(a)$ 的表达式：\n$$V^T W (K \\bar{u} + (K V) a - f) = 0$$\n将 $V^T W$ 分配进去，我们得到关于 $a$ 的标量线性方程：\n$$V^T W K \\bar{u} + (V^T W K V) a - V^T W f = 0$$\n重新整理此方程以求解 $a$，得到通用降阶方程：\n$$(V^T W K V) a = V^T W f - V^T W K \\bar{u}$$\n该方程的形式为 $K_r a = f_r$，其中 $K_r$ 是降阶刚度，$f_r$ 是降阶力项。\n\n对于所提供的特定示例模型，参数如下：\n$n=2$\n$$\nK=\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix}, \n\\quad \nf=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\n\\quad \n\\bar{u}=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\n\\quad\nV=\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix},\n\\quad\nW=I=\\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}\n$$\n由于 $\\bar{u}$ 是零向量，项 $V^T W K \\bar{u}$ 为零，降阶方程简化为：\n$$(V^T W K V) a = V^T W f$$\n\n首先，我们计算降阶刚度算子 $K_r = V^T W K V$。由于 $W=I$，这便是 $K_r = V^T K V$：\n$$K_r = \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  1\\end{bmatrix}\\right) \\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix}\\right)$$\n$$K_r = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\left(\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix} \\begin{bmatrix}1\\\\ 1\\end{bmatrix}\\right)$$\n$$K_r = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}2(1) - 1(1) \\\\ -1(1) + 2(1)\\end{bmatrix} = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$$\n$$K_r = \\frac{1}{2} (1 \\cdot 1 + 1 \\cdot 1) = \\frac{1}{2}(2) = 1$$\n\n接下来，我们计算降阶力算子 $f_r = V^T W f$。由于 $W=I$，这便是 $f_r = V^T f$：\n$$f_r = \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  1\\end{bmatrix}\\right) \\begin{bmatrix}1\\\\ 0\\end{bmatrix}$$\n$$f_r = \\frac{1}{\\sqrt{2}} (1 \\cdot 1 + 1 \\cdot 0) = \\frac{1}{\\sqrt{2}}$$\n\n因此，降阶标量平衡方程 $K_r a = f_r$ 为：\n$$1 \\cdot a = \\frac{1}{\\sqrt{2}}$$\n\n求解降阶坐标 $a$，我们得到：\n$$a = \\frac{1}{\\sqrt{2}}$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "3553438"}, {"introduction": "POD的一个关键优势是其最优性，它允许我们用少量的基向量创建高精度的近似。但“少量”是多少呢？这个练习解决了模型截断这一实际问题。通过分析奇异值谱，你将学会如何量化因截断POD基而引入的误差，并确定满足特定精度目标所需的最少模态数量。[@problem_id:3553439] 这是开发可靠ROM的一项关键技能。", "problem": "考虑一个饱和、各向异性黏土层中准静态固结的有限元模拟。状态变量是在 $m$ 个离散荷载步下采样的位移场，形成一个快照矩阵 $X \\in \\mathbb{R}^{n \\times m}$。为了反映计算岩土力学中使用的能量内积，设 $W \\in \\mathbb{R}^{n \\times n}$ 为一个对称正定矩阵，它导出的加权内积为 $\\langle u, v \\rangle_{W} = u^{\\top} W v$。定义 $W$-加权快照矩阵为 $X_{W} = W^{1/2} X$。在 $W$-内积下的本征正交分解（POD）是通过对 $X_{W}$ 进行奇异值分解得到的。\n\n从第一性原理出发，利用奇异向量的正交性和秩-$r$ 投影在弗罗贝尼乌斯范数下的最优性，推导最佳秩-$r$ $W$-正交投影的时间平均截断误差关于 $X_{W}$ 的奇异值 $\\{\\sigma_{j}\\}$ 的表达式。然后，利用所提供的数据，计算该误差界限，并确定达到指定相对容差的最小 $r$ 值。\n\n$W$-加权快照矩阵 $X_{W}$ 的奇异值为\n$$\n\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}.\n$$\n假设有 $m = 40$ 个快照，且 $\\varepsilon = 1.0 \\times 10^{-2}$。设截断误差界限为\n$$\n\\eta_{r} = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\operatorname{min}(n,m)} \\sigma_{j}^{2}},\n$$\n相对容差准则为\n$$\n\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon,\n$$\n其中 $\\|X_{W}\\|_{F}$ 表示弗罗贝尼乌斯范数。\n\n报告满足该容差的最小整数 $r$，以及相应的截断误差界限 $\\eta_{r}$ 和达到的相对界限 $\\eta_{r}/\\|X_{W}\\|_{F}$。将后两个量四舍五入到四位有效数字。将最终的无量纲比率表示为一个不带百分号的纯数。", "solution": "用户提供了一个来自计算岩土力学的关于本征正交分解（POD）的问题，要求推导截断误差，然后进行数值计算以确定所需的模型阶数。\n\n**问题验证**\n\n首先，对问题陈述进行验证。\n\n*   **提取已知条件**：\n    1.  背景是准静态固结模拟，其快照矩阵为 $X \\in \\mathbb{R}^{n \\times m}$。\n    2.  定义了能量内积 $\\langle u, v \\rangle_{W} = u^{\\top} W v$，其中 $W$ 是一个对称正定矩阵。\n    3.  $W$-加权快照矩阵为 $X_{W} = W^{1/2} X$。\n    4.  在 $W$-内积下的POD是通过对 $X_{W}$ 进行奇异值分解（SVD）得到的。\n    5.  $X_W$ 的奇异值：$\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}$。$X_W$ 的秩为 $12$。\n    6.  快照数量：$m = 40$。\n    7.  指定相对容差：$\\varepsilon = 1.0 \\times 10^{-2}$。\n    8.  截断误差界限定义：$\\eta_{r} = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\operatorname{min}(n,m)} \\sigma_{j}^{2}}$。\n    9.  相对容差准则：$\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon$。\n*   **验证检查**：\n    - **科学依据**：该问题在基于POD的模型降阶理论中有充分的依据，特别是应用于有限元分析。使用加权范数（能量范数）是力学中的标准且严谨的做法。所有概念都具有科学性。\n    - **适定性**：问题陈述清晰。它要求进行一个标准的推导，然后进行一次计算，所有必要的数据和公式均已提供。存在唯一解。\n    - **客观性**：语言精确且数学化，没有主观成分。\n    - **完备性**：问题是自洽的。虽然没有给出用奇异值表示弗罗贝尼乌斯范数的公式，但这被认为是该主题所需的基础知识。\n    - **现实性**：背景和数据（衰减的奇异值）对于工程应用是现实的。\n\n*   **结论**：该问题是**有效的**。\n\n**第一部分：截断误差的推导**\n\n目标是找到用秩为 $r$ 的截断POD基来近似完整快照集时产生的误差。快照是矩阵 $X$ 的列，记为 $\\{x_k\\}_{k=1}^m$。误差在由矩阵 $W$ 导出的能量范数下进行度量。\n\nPOD基向量 $\\{\\phi_j\\}_{j=1}^{\\mathrm{rank}(X)}$ 是一组最优地表示快照集的向量。在 $W$-内积中，这些基向量是 $W$-正交的：$\\langle\\phi_i, \\phi_j\\rangle_W = \\phi_i^\\top W \\phi_j = \\delta_{ij}$（对于归一化基）。一个快照 $x_k$ 在由前 $r$ 个基向量张成的子空间上的投影由下式给出：\n$$\nx_{k,r} = \\sum_{j=1}^{r} \\langle x_k, \\phi_j \\rangle_W \\phi_j\n$$\n对所有快照求和的总投影误差的平方为\n$$\nE_r = \\sum_{k=1}^{m} \\|x_k - x_{k,r}\\|_W^2 = \\sum_{k=1}^{m} \\langle x_k - x_{k,r}, x_k - x_{k,r} \\rangle_W\n$$\n使用 $W$-内积的定义，这可以利用标准的欧几里得2-范数重写为：\n$$\nE_r = \\sum_{k=1}^{m} (x_k - x_{k,r})^\\top W (x_k - x_{k,r}) = \\sum_{k=1}^{m} \\| W^{1/2}(x_k - x_{k,r}) \\|_2^2\n$$\n“快照法”通过对加权快照矩阵 $X_W = W^{1/2} X$ 进行SVD来找到POD基。设 $X_W$ 的SVD为：\n$$\nX_W = U \\Sigma V^\\top\n$$\n其中 $U \\in \\mathbb{R}^{n \\times n}$ 和 $V \\in \\mathbb{R}^{m \\times m}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{n \\times m}$ 是包含奇异值 $\\sigma_j \\ge 0$ 的对角矩阵。$U$ 的列 $\\{u_j\\}$ 是左奇异向量，在加权空间中被称为POD模态。原始的POD基向量是 $\\phi_j = W^{-1/2} u_j$。\n\n$W^{1/2}x_k$ 项是 $X_W$ 的第 $k$ 列。投影 $x_{k,r}$ 变换为：\n$$\nW^{1/2} x_{k,r} = W^{1/2} \\sum_{j=1}^{r} (x_k^\\top W \\phi_j) \\phi_j = \\sum_{j=1}^{r} ((W^{1/2}x_k)^\\top (W^{1/2}\\phi_j)) (W^{1/2}\\phi_j) = \\sum_{j=1}^{r} (y_k^\\top u_j) u_j\n$$\n其中 $y_k = W^{1/2}x_k$ 是 $X_W$ 的第 $k$ 列。这是 $y_k$ 在由 $\\{u_j\\}_{j=1}^r$ 张成的子空间上的欧几里得投影。该投影可以写作 $U_r U_r^\\top y_k$，其中 $U_r$ 是包含 $U$ 的前 $r$ 列的矩阵。\n\n总误差 $E_r$ 是矩阵 $X_W$ 与其在前 $r$ 个左奇异向量张成的子空间上的投影之间的差的弗罗贝尼乌斯范数的平方：\n$$\nE_r = \\sum_{k=1}^{m} \\|y_k - U_r U_r^\\top y_k\\|_2^2 = \\|X_W - U_r U_r^\\top X_W\\|_F^2\n$$\n根据 Eckart-Young-Mirsky 定理，$X_W$ 在弗罗贝尼乌斯范数下的最佳秩-$r$ 近似是截断SVD，即 $X_{W,r} = U_r \\Sigma_r V_r^\\top$，其中 $\\Sigma_r$ 包含前 $r$ 个奇异值。可以证明 $U_r U_r^\\top X_W = X_{W,r}$。因此，误差为：\n$$\nE_r = \\|X_W - X_{W,r}\\|_F^2\n$$\n利用 $X_W$ 的SVD，误差矩阵为：\n$$\nX_W - X_{W,r} = U \\Sigma V^\\top - U_r \\Sigma_r V_r^\\top = \\sum_{j=1}^{\\mathrm{rank}(X_W)} \\sigma_j u_j v_j^\\top - \\sum_{j=1}^{r} \\sigma_j u_j v_j^\\top = \\sum_{j=r+1}^{\\mathrm{rank}(X_W)} \\sigma_j u_j v_j^\\top\n$$\n弗罗贝尼乌斯范数在正交变换下是不变的，所以：\n$$\nE_r = \\|X_W - X_{W,r}\\|_F^2 = \\left\\| U^\\top (X_W - X_{W,r}) V \\right\\|_F^2 = \\left\\| \\Sigma - \\begin{pmatrix} \\Sigma_r  0 \\\\ 0  0 \\end{pmatrix} \\right\\|_F^2 = \\sum_{j=r+1}^{\\mathrm{rank}(X_W)} \\sigma_j^2\n$$\n问题将时间平均截断误差界限 $\\eta_r$ 定义为 $m$ 个快照的均方根误差：\n$$\n\\eta_r^2 = \\frac{1}{m} E_r = \\frac{1}{m} \\sum_{j=r+1}^{\\operatorname{min}(n,m)} \\sigma_j^2\n$$\n取平方根得到所需的表达式：\n$$\n\\eta_r = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\operatorname{min}(n,m)} \\sigma_j^2}\n$$\n推导到此完成。\n\n**第二部分：数值计算**\n\n我们需要找到满足相对容差准则的最小整数 $r$：\n$$\n\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon\n$$\n已知数据：$m=40$，$\\varepsilon = 1.0 \\times 10^{-2}=0.01$，以及 $\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}$。$X_W$ 的秩为 $12$。\n\n首先，我们利用其奇异值计算 $X_W$ 的弗罗贝尼乌斯范数的平方：\n$$\n\\|X_{W}\\|_{F}^2 = \\sum_{j=1}^{12} \\sigma_{j}^{2}\n$$\n奇异值的平方是：\n$\\sigma_1^2 = 6.0^2 = 36$\n$\\sigma_2^2 = 3.5^2 = 12.25$\n$\\sigma_3^2 = 2.1^2 = 4.41$\n$\\sigma_4^2 = 1.4^2 = 1.96$\n$\\sigma_5^2 = 1.0^2 = 1.0$\n$\\sigma_6^2 = 0.72^2 = 0.5184$\n$\\sigma_7^2 = 0.52^2 = 0.2704$\n$\\sigma_8^2 = 0.36^2 = 0.1296$\n$\\sigma_9^2 = 0.25^2 = 0.0625$\n$\\sigma_{10}^2 = 0.18^2 = 0.0324$\n$\\sigma_{11}^2 = 0.12^2 = 0.0144$\n$\\sigma_{12}^2 = 0.08^2 = 0.0064$\n\n将这些值相加得到：\n$$\n\\|X_{W}\\|_{F}^2 = 36 + 12.25 + 4.41 + 1.96 + 1.0 + 0.5184 + 0.2704 + 0.1296 + 0.0625 + 0.0324 + 0.0144 + 0.0064 = 56.6541\n$$\n所以，$\\|X_{W}\\|_{F} = \\sqrt{56.6541} \\approx 7.5268915$。\n\n容差准则可以重写为：\n$$\n\\eta_r^2 \\le \\varepsilon^2 \\|X_{W}\\|_F^2\n$$\n$$\n\\frac{1}{m} \\sum_{j=r+1}^{12} \\sigma_j^2 \\le \\varepsilon^2 \\sum_{j=1}^{12} \\sigma_j^2\n$$\n代入数值：\n$$\n\\frac{1}{40} \\sum_{j=r+1}^{12} \\sigma_j^2 \\le (0.01)^2 \\times 56.6541\n$$\n$$\n\\sum_{j=r+1}^{12} \\sigma_j^2 \\le 40 \\times 0.0001 \\times 56.6541 = 0.2266164\n$$\n我们需要找到满足此条件的最小整数 $r$。我们计算尾部奇异值平方和，$S_r = \\sum_{j=r+1}^{12} \\sigma_j^2$。\n我们从一个较高的值开始测试 $r$ 的值：\n对于 $r=8$：$S_8 = \\sum_{j=9}^{12} \\sigma_j^2 = \\sigma_9^2+\\sigma_{10}^2+\\sigma_{11}^2+\\sigma_{12}^2 = 0.0625 + 0.0324 + 0.0144 + 0.0064 = 0.1157$。\n由于 $0.1157 \\le 0.2266164$，因此对于 $r=8$ 满足准则。\n\n我们测试 $r=7$ 以确保 $r=8$ 是最小整数：\n对于 $r=7$：$S_7 = \\sum_{j=8}^{12} \\sigma_j^2 = \\sigma_8^2 + S_8 = 0.1296 + 0.1157 = 0.2453$。\n由于 $0.2453  0.2266164$，因此对于 $r=7$ 不满足准则。\n\n因此，满足容差的最小整数 $r$ 是 $r=8$。\n\n最后，我们计算截断误差界限 $\\eta_8$ 和达到的相对界限 $\\eta_8/\\|X_{W}\\|_F$。\n$$\n\\eta_8 = \\sqrt{\\frac{1}{m} \\sum_{j=9}^{12} \\sigma_j^2} = \\sqrt{\\frac{0.1157}{40}} = \\sqrt{0.0028925} \\approx 0.05378196...\n$$\n四舍五入到四位有效数字，$\\eta_8 = 0.05378$。\n\n达到的相对界限是：\n$$\n\\frac{\\eta_8}{\\|X_{W}\\|_F} = \\frac{0.05378196...}{7.5268915...} \\approx 0.0071454...\n$$\n四舍五入到四位有效数字，相对界限为 $0.007145$。该值确实小于或等于指定的容差 $\\varepsilon=0.01$。\n\n所要求的量是：\n- 最小整数 $r$：$8$\n- 截断误差界限 $\\eta_r$：$0.05378$\n- 达到的相对界限 $\\eta_r/\\|X_W\\|_F$：$0.007145$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8  0.05378  0.007145\n\\end{pmatrix}\n}\n$$", "id": "3553439"}]}