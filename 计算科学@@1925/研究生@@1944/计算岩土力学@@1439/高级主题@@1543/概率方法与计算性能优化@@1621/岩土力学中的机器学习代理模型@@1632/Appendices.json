{"hands_on_practices": [{"introduction": "任何有效的本构模型都必须是客观的，也即与观察者的参考系无关。标准的机器学习模型本身不具备这一特性，因此必须对其进行显式检验或在模型设计中加以保证。本练习 [@problem_id:3540297] 提供了一种动手实践的方法，用于量化代理模型的客观性违背程度，帮助我们理解这种违背是如何以及在何时发生的。", "problem": "给定一个代理本构映射，该映射用于从三维小应变张量预测柯西应力张量。目的是通过检查代理模型在正常正交变换下的不变性来评估其客观性（标架无关性）。客观性要求，对于任何正常正交旋转矩阵 $\\mathbf{Q}$（即 $\\mathbf{Q} \\in \\mathbb{R}^{3 \\times 3}$ 且满足 $\\mathbf{Q}^T \\mathbf{Q} = \\mathbf{I}$ 和 $\\det(\\mathbf{Q}) = +1$）以及任何对称小应变张量 $\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^{3 \\times 3}$，本构映射 $\\boldsymbol{\\sigma}(\\cdot)$ 必须满足 $\\boldsymbol{\\sigma}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon})\\mathbf{Q}^T$。对该恒等式的违反程度量化了客观性的缺失。\n\n待测试的代理模型定义如下。对于任何对称小应变张量 $\\boldsymbol{\\varepsilon}$，\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\n=\n\\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I}\n\\;+\\;\n2 \\mu \\, \\boldsymbol{\\varepsilon}\n\\;+\\;\nb \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A},\n$$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\mathbf{I}$ 是单位张量，$b$ 是一个标量偏置系数，$\\mathbf{A}$ 是一个固定的对称无迹张量，该张量编码了一种基底固定的建模偏差。该固定张量为\n$$\n\\mathbf{A} = \\mathrm{diag}\\!\\left(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3}\\right).\n$$\n物理单位和参数如下：\n- 拉梅参数 $\\lambda = 4.0 \\times 10^{10} \\ \\mathrm{Pa}$，\n- 拉梅参数 $\\mu = 3.0 \\times 10^{10} \\ \\mathrm{Pa}$，\n- 偏置系数 $b = 5.0 \\times 10^{8} \\ \\mathrm{Pa}$。\n应变 $\\boldsymbol{\\varepsilon}$ 是无量纲的。应力 $\\boldsymbol{\\sigma}_{\\text{pred}}$ 的单位是 $\\mathrm{Pa}$。\n\n对于任意给定的旋转矩阵 $\\mathbf{Q}$ 和应变张量 $\\boldsymbol{\\varepsilon}$，将客观性违反度量定义为：对旋转后的应变预测的应力与旋转后的预测应力之差的弗罗贝尼乌斯范数 (Frobenius norm (FN))：\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) \\equiv \\left\\| \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;-\\; \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T \\right\\|_F,\n$$\n以 $\\mathrm{Pa}$ 为单位表示。\n\n您的任务是编写一个程序，为以下测试套件评估 $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$。角度以弧度为单位，旋转是围绕 $z$ 轴进行的。围绕 $z$ 轴旋转角度 $\\theta$ 的旋转矩阵是\n$$\n\\mathbf{Q}_z(\\theta) =\n\\begin{bmatrix}\n\\cos(\\theta)   -\\sin(\\theta)  0 \\\\\n\\sin(\\theta)   \\cos(\\theta)    0 \\\\\n0              0               1\n\\end{bmatrix}.\n$$\n测试套件包含五个案例：\n- 案例 1（理想情况，单位旋转）：$\\theta = 0$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}\\!\\left(1.2\\times 10^{-3},\\, -0.3\\times 10^{-3},\\, -0.3\\times 10^{-3}\\right)$。\n- 案例 2（具有体积应变的非平凡旋转）：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}\\!\\left(1.2\\times 10^{-3},\\, -0.3\\times 10^{-3},\\, -0.3\\times 10^{-3}\\right)$。\n- 案例 3（无迹剪切边界情况）：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_2$ 的分量为 $(\\boldsymbol{\\varepsilon}_2)_{12} = (\\boldsymbol{\\varepsilon}_2)_{21} = 5.0\\times 10^{-4}$，所有其他分量均为 $0$。\n- 案例 4（非平凡旋转下的静水应变）：$\\theta = \\tfrac{\\pi}{3}$, $\\boldsymbol{\\varepsilon}_3 = 1.0\\times 10^{-4} \\, \\mathbf{I}$。\n- 案例 5（零应变边界）：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_4 = \\mathbf{0}$。\n\n所有五个案例必须按所列顺序进行评估。您的程序必须：\n- 为指定的 $\\theta$ 构建 $\\mathbf{Q} = \\mathbf{Q}_z(\\theta)$，\n- 构建指定的 $\\boldsymbol{\\varepsilon}$，\n- 使用上述代理模型 $\\boldsymbol{\\sigma}_{\\text{pred}}$ 计算 $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$，\n- 返回五个 $E$ 的值，单位为 $\\mathrm{Pa}$。\n\n将最终结果以帕斯卡 ($\\mathrm{Pa}$) 为单位表示为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[x1,x2,x3,x4,x5]\"），其中每个 $x_i$ 对应于按上述顺序列出的案例 $i$ 的 $E$ 值。", "solution": "该问题旨在评估连续介质力学中一个代理本构模型的客观性。如果一个本构模型的形式在空间参考系的刚体旋转下保持不变，则该模型是客观的（或称标架无关的）。对于作为小应变张量 $\\boldsymbol{\\varepsilon}$ 函数的柯西应力张量 $\\boldsymbol{\\sigma}$，此原理由恒等式 $\\boldsymbol{\\sigma}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon})\\mathbf{Q}^T$ 正式表达，其中 $\\mathbf{Q}$ 为任意正常正交旋转张量。本题要求我们为一个特定的代理模型量化对此恒等式的违反程度。\n\n该代理模型由下式给出\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon}) = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon} \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}\n$$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\mathbf{I}$ 是单位张量，$b$ 是偏置系数，$\\mathbf{A}$ 是一个固定的、基底固定的对称无迹张量。此模型的标准部分 $\\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$ 代表各向同性线弹性，已知是客观的。附加项 $b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}$ 是一个建模偏差，我们将分析其对客观性的影响。\n\n客观性违反的度量定义为差值张量 $\\boldsymbol{\\Delta}$ 的弗罗贝尼乌斯范数：\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) \\equiv \\| \\boldsymbol{\\Delta} \\|_F = \\left\\| \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;-\\; \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T \\right\\|_F\n$$\n\n让我们推导 $\\boldsymbol{\\Delta}$ 的简化表达式。令 $\\boldsymbol{\\varepsilon}' = \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T$。范数中的第一项是：\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon}') = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}') \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon}' \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}') \\, \\mathbf{A}\n$$\n迹算子的一个关键性质是其在循环置换下的不变性，对于正交张量 $\\mathbf{Q}$，这意味着 $\\mathrm{tr}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\mathrm{tr}(\\boldsymbol{\\varepsilon}\\mathbf{Q}^T\\mathbf{Q}) = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$。因此，$\\mathrm{tr}(\\boldsymbol{\\varepsilon}') = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$。代入此式及 $\\boldsymbol{\\varepsilon}'$ 的定义可得：\n$$\n\\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, (\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A}\n$$\n\n范数中的第二项是：\n$$\n\\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T = \\mathbf{Q} \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, \\boldsymbol{\\varepsilon} \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A} \\right) \\mathbf{Q}^T\n$$\n将 $\\mathbf{Q}$ 和 $\\mathbf{Q}^T$ 分配进去，并利用 $\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^T = \\mathbf{I}$ 这一事实，我们得到：\n$$\n\\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2 \\mu \\, (\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) \\;+\\; b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, (\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T)\n$$\n\n现在，我们计算差值张量 $\\boldsymbol{\\Delta}$：\n$$\n\\boldsymbol{\\Delta} = \\boldsymbol{\\sigma}_{\\text{pred}}(\\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T) - \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{\\text{pred}}(\\boldsymbol{\\varepsilon})\\,\\mathbf{Q}^T\n$$\n$$\n\\boldsymbol{\\Delta} = \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 \\mu \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T + b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{A} \\right) - \\left( \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\mathbf{Q}\\boldsymbol{\\varepsilon}\\mathbf{Q}^T + b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right)\n$$\n如客观基础模型所预期的那样，涉及 $\\lambda$ 和 $\\mu$ 的项相互抵消。剩余的项为：\n$$\n\\boldsymbol{\\Delta} = b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{A} - b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\left( \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right)\n$$\n客观性违反度量 $E(\\mathbf{Q}, \\boldsymbol{\\varepsilon})$ 是该张量的弗罗贝尼乌斯范数。对于标量 $c$，使用范数性质 $\\|c\\mathbf{M}\\|_F = |c|\\|\\mathbf{M}\\|_F$：\n$$\nE(\\mathbf{Q}, \\boldsymbol{\\varepsilon}) = \\left\\| b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\left( \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right) \\right\\|_F = |b \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon})| \\left\\| \\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T \\right\\|_F\n$$\n这个简化的表达式表明，如果 $b=0$，或者应变是等容的（即 $\\mathrm{tr}(\\boldsymbol{\\varepsilon})=0$），或者旋转 $\\mathbf{Q}$ 与偏置张量 $\\mathbf{A}$ 对易（即 $\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathbf{A}$），则客观性违反为零。\n\n我们现在将此公式应用于五个测试案例，使用给定的参数：$b = 5.0 \\times 10^{8} \\ \\mathrm{Pa}$ 和 $\\mathbf{A} = \\mathrm{diag}(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3})$。\n\n案例 1：$\\theta = 0$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}(1.2\\times 10^{-3}, -0.3\\times 10^{-3}, -0.3\\times 10^{-3})$。\n对于 $\\theta=0$，旋转矩阵是单位矩阵 $\\mathbf{Q} = \\mathbf{I}$。\n因此，$\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathbf{A} - \\mathbf{I}\\mathbf{A}\\mathbf{I}^T = \\mathbf{A} - \\mathbf{A} = \\mathbf{0}$。\n范数为 $0$，所以 $E_1 = 0 \\ \\mathrm{Pa}$。\n\n案例 2：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_1 = \\mathrm{diag}(1.2\\times 10^{-3}, -0.3\\times 10^{-3}, -0.3\\times 10^{-3})$。\n首先，$\\mathrm{tr}(\\boldsymbol{\\varepsilon}_1) = (1.2 - 0.3 - 0.3) \\times 10^{-3} = 0.6 \\times 10^{-3}$。\n旋转矩阵是 $\\mathbf{Q}_z(\\tfrac{\\pi}{2}) = \\begin{bsmallmatrix} 0   -1  0 \\\\ 1   0   0 \\\\ 0   0   1 \\end{bsmallmatrix}$。\n我们计算 $\\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathrm{diag}(-\\tfrac{1}{3}, \\tfrac{2}{3}, -\\tfrac{1}{3})$。\n差值为 $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\mathrm{diag}(\\tfrac{2}{3}, -\\tfrac{1}{3}, -\\tfrac{1}{3}) - \\mathrm{diag}(-\\tfrac{1}{3}, \\tfrac{2}{3}, -\\tfrac{1}{3}) = \\mathrm{diag}(1, -1, 0)$。\n弗罗贝尼乌斯范数是 $\\| \\mathrm{diag}(1, -1, 0) \\|_F = \\sqrt{1^2 + (-1)^2 + 0^2} = \\sqrt{2}$。\n$E_2 = |5.0 \\times 10^8| \\times |0.6 \\times 10^{-3}| \\times \\sqrt{2} = 3.0 \\times 10^5 \\times \\sqrt{2} \\approx 424264.0687 \\ \\mathrm{Pa}$。\n\n案例 3：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_2$ 的非零分量为 $(\\boldsymbol{\\varepsilon}_2)_{12} = (\\boldsymbol{\\varepsilon}_2)_{21} = 5.0\\times 10^{-4}$。\n迹为 $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_2) = 0$。\n由于 $\\mathrm{tr}(\\boldsymbol{\\varepsilon}_2) = 0$，根据公式直接得出客观性违反 $E_3 = 0 \\ \\mathrm{Pa}$。\n\n案例 4：$\\theta = \\tfrac{\\pi}{3}$, $\\boldsymbol{\\varepsilon}_3 = 1.0\\times 10^{-4} \\, \\mathbf{I}$。\n应变为静水应变。$\\mathrm{tr}(\\boldsymbol{\\varepsilon}_3) = \\mathrm{tr}(1.0\\times 10^{-4} \\, \\mathbf{I}) = 1.0\\times 10^{-4} \\times 3 = 3.0 \\times 10^{-4}$。\n旋转是 $\\mathbf{Q}_z(\\tfrac{\\pi}{3})$。令 $c=\\cos(\\tfrac{\\pi}{3}) = \\tfrac{1}{2}$ 及 $s=\\sin(\\tfrac{\\pi}{3}) = \\tfrac{\\sqrt{3}}{2}$。\n差值张量是 $\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = (a_1-a_2) \\begin{bsmallmatrix} s^2   -cs  0 \\\\ -cs  -s^2  0 \\\\ 0   0   0 \\end{bsmallmatrix}$，其中 $a_1=\\tfrac{2}{3}, a_2=-\\tfrac{1}{3}$。\n$a_1 - a_2 = 1$。所以，$\\mathbf{A} - \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^T = \\begin{bsmallmatrix} (\\sqrt{3}/2)^2   -(\\sqrt{3}/4)  0 \\\\ -(\\sqrt{3}/4)  -(\\sqrt{3}/2)^2  0 \\\\ 0   0   0 \\end{bsmallmatrix} = \\begin{bsmallmatrix} 3/4   -\\sqrt{3}/4  0 \\\\ -\\sqrt{3}/4  -3/4  0 \\\\ 0   0   0 \\end{bsmallmatrix}$。\n弗罗贝尼乌斯范数的平方是 $\\| \\cdot \\|_F^2 = (\\tfrac{3}{4})^2 + (-\\tfrac{\\sqrt{3}}{4})^2 + (-\\tfrac{\\sqrt{3}}{4})^2 + (-\\tfrac{3}{4})^2 = \\tfrac{9}{16} + \\tfrac{3}{16} + \\tfrac{3}{16} + \\tfrac{9}{16} = \\tfrac{24}{16} = \\tfrac{3}{2}$。\n范数是 $\\sqrt{\\tfrac{3}{2}}$。\n$E_4 = |5.0 \\times 10^8| \\times |3.0 \\times 10^{-4}| \\times \\sqrt{\\tfrac{3}{2}} = 1.5 \\times 10^5 \\times \\sqrt{1.5} \\approx 183711.7307 \\ \\mathrm{Pa}$。\n\n案例 5：$\\theta = \\tfrac{\\pi}{2}$, $\\boldsymbol{\\varepsilon}_4 = \\mathbf{0}$。\n应变张量是零张量。$\\mathrm{tr}(\\boldsymbol{\\varepsilon}_4) = 0$。\n因此，客观性违反 $E_5 = 0 \\ \\mathrm{Pa}$。\n\n下面的程序将实现这些计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the objectivity violation measure E(Q, ε) for five test cases.\n    \"\"\"\n    # Define physical and model parameters\n    B_COEFF = 5.0e8  # Bias coefficient b in Pa\n\n    # Define the fixed symmetric traceless tensor A\n    A = np.diag([2/3, -1/3, -1/3])\n\n    # Define the test suite\n    test_cases = [\n        # Case 1: Identity rotation\n        {\n            'theta': 0.0,\n            'epsilon': np.diag([1.2e-3, -0.3e-3, -0.3e-3])\n        },\n        # Case 2: Nontrivial rotation, volumetric strain\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.diag([1.2e-3, -0.3e-3, -0.3e-3])\n        },\n        # Case 3: Trace-free shear\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.array([[0, 5.0e-4, 0], [5.0e-4, 0, 0], [0, 0, 0]])\n        },\n        # Case 4: Hydrostatic strain\n        {\n            'theta': np.pi / 3,\n            'epsilon': 1.0e-4 * np.identity(3)\n        },\n        # Case 5: Zero strain\n        {\n            'theta': np.pi / 2,\n            'epsilon': np.zeros((3, 3))\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        theta = case['theta']\n        epsilon = case['epsilon']\n\n        # Calculate trace of the strain tensor\n        tr_eps = np.trace(epsilon)\n\n        # The objectivity violation is zero if tr(ε) is zero.\n        if np.isclose(tr_eps, 0):\n            E = 0.0\n            results.append(E)\n            continue\n\n        # Construct the rotation matrix Q for rotation about the z-axis\n        c, s = np.cos(theta), np.sin(theta)\n        Q = np.array([[c, -s, 0], \n                      [s,  c, 0], \n                      [0,  0, 1]])\n\n        # Calculate the difference tensor A - Q A Q^T\n        QAQT = Q @ A @ Q.T\n        diff_tensor = A - QAQT\n\n        # Calculate the Frobenius norm of the difference tensor\n        norm_diff = np.linalg.norm(diff_tensor, 'fro')\n\n        # Calculate the objectivity violation measure E\n        E = abs(B_COEFF * tr_eps) * norm_diff\n        results.append(E)\n\n    # Format and print the final results\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3540297"}, {"introduction": "除了基本物理定律，本构模型还必须确保材料的稳定性，这在数学上等价于边值问题的适定性。强椭圆性条件是弹性力学中稳定性的关键判据，它保证了波速为实数。本练习 [@problem_id:3540275] 演示了如何对学习到的弹性模量（如体积模量 $K$ 和剪切模量 $G$）施加正定性约束（$K > 0$, $G > 0$），并验证强椭圆性条件，以确保代理模型能够产生稳定的材料响应。", "problem": "给定一个由机器学习代理模型建模的小应变、增量各向同性弹性切线，该模型将平均应力映射到弹性模量。该代理模型输出体积模量 $K$ 和剪切模量 $G$，它们是平均应力 $p$ 的函数，单位为兆帕 (MPa)。该代理模型必须强制执行正性约束 $K0$ 和 $G0$，任务是当 $p$ 沿着指定的静水应力路径增加时，检验切线刚度的强椭圆性条件。\n\n从线弹性理论的基本出发：在小应变和各向同性假设下，四阶各向同性弹性切线可以用拉梅参数 $\\lambda$ 和 $\\mu$ 表示为\n$$\nC_{ijkl} = \\lambda\\,\\delta_{ij}\\delta_{kl} + \\mu\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right),\n$$\n其中 $\\mu=G$ 且 $\\lambda=K-\\tfrac{2}{3}G$。强椭圆性条件要求对于任意单位向量 $n$ 和任意非零向量 $v$，声学二次型满足 $v_i\\,Q_{ij}(n)\\,v_j0$，其中声学张量为\n$$\nQ_{ij}(n) = C_{ipjq}\\,n_p\\,n_q.\n$$\n对于上述各向同性形式，\n$$\nQ_{ij}(n) = \\left(\\lambda + 2G\\right) n_i n_j + G\\left(\\delta_{ij} - n_i n_j\\right),\n$$\n其特征值不依赖于方向 $n$，由两个等于 $G$ 的重复横向特征值和一个等于 $\\lambda + 2G = K + \\tfrac{4}{3}G$ 的纵向特征值给出。因此，强椭圆性等价于\n$$\nG > 0 \\quad \\text{和} \\quad K + \\tfrac{4}{3}G > 0.\n$$\n该机器学习代理模型通过 Softplus 函数变换原始多项式输出来施加正性约束。具体来说，对于每个给定的平均应力 $p$，\n$$\nk_{\\text{raw}}(p) = a_0 + a_1 p + a_2 p^2, \\\\\ng_{\\text{raw}}(p) = b_0 + b_1 p + b_2 p^2,\n$$\n$$\nK(p) = \\log\\!\\left(1 + e^{k_{\\text{raw}}(p)}\\right) + \\varepsilon_K,\\quad G(p) = \\log\\!\\left(1 + e^{g_{\\text{raw}}(p)}\\right) + \\varepsilon_G,\n$$\n其中 $\\varepsilon_K$ 和 $\\varepsilon_G$ 是小的固定正常数，以确保严格的正性。单位如下：$p$ 的单位是兆帕 (MPa)，$K$ 和 $G$ 的单位也是兆帕 (MPa)。对于每个 $p$，声学张量的最小特征值为\n$$\n\\lambda_{\\min}(p) = \\min\\!\\left(G(p),\\, K(p) + \\tfrac{4}{3}G(p)\\right).\n$$\n给定应力路径 $p \\in \\{0, 50, 100, 200, 400\\}$ (单位为 MPa)，计算该路径上的最小值，\n$$\n\\Lambda_{\\min} = \\min_{p \\in \\{0, 50, 100, 200, 400\\}} \\lambda_{\\min}(p),\n$$\n该值量化了随着应力增加，切线刚度的强椭圆性裕度。\n\n实现一个程序，对于下面定义的每个测试用例，从代理模型评估 $K(p)$ 和 $G(p)$，在每个指定的 $p$ 值处计算 $\\lambda_{\\min}(p)$，并返回 $\\Lambda_{\\min}$，它是一个单位为兆帕 (MPa) 的浮点数，四舍五入到六位小数。使用的 Softplus 函数是自然对数版本：\n$$\n\\operatorname{softplus}(x) = \\log\\!\\left(1 + e^{\\,x}\\right).\n$$\n使用常数 $\\varepsilon_K=\\varepsilon_G=10^{-12}$ (单位为 MPa)。\n\n测试套件规范：\n- 使用静水平均应力路径 $p \\in \\{0, 50, 100, 200, 400\\}$，单位为兆帕 (MPa)。\n- 对于每个测试用例，代理模型参数 $(a_0,a_1,a_2,b_0,b_1,b_2)$ 如下：\n    1. 情况 1（模量递增）：$(5.0,\\,0.1,\\,0.0)$，$(2.0,\\,0.05,\\,0.0)$。\n    2. 情况 2（剪切模量衰减）：$(10.0,\\,0.0,\\,0.0)$，$(1.0,\\,-0.0025,\\,0.0)$。\n    3. 情况 3（近简并剪切）：$(2.0,\\,0.0,\\,0.0)$，$(-10.0,\\,0.0,\\,0.0)$。\n    4. 情况 4（带二次项的非单调剪切）：$(20.0,\\,0.05,\\,0.0)$，$(0.5,\\,0.01,\\,-1.0\\times 10^{-4})$。\n\n你的程序必须生成单行输出，其中包含四个测试用例的结果，结果为逗号分隔的列表，用方括号括起，单位为兆帕 (MPa)，四舍五入到六位小数。例如，一个有效的输出行如下所示\n\"[0.123456,1.234567,0.000001,0.987654]\"。", "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于连续介质力学，问题提法得当，提供了所有必要信息，并且表述客观。该问题要求对一个基于机器学习的各向同性弹性材料代理模型的强椭圆性条件进行评估。下面提供了一个完整的、有理有据的解决方案。\n\n目标是计算增量各向同性弹性材料在指定静水应力路径 $p \\in \\{0, 50, 100, 200, 400\\}\\,\\text{MPa}$ 上的最小稳定性裕度，记为 $\\Lambda_{\\min}$。该裕度由声学张量的最小特征值量化。材料的弹性模量，即体积模量 $K$ 和剪切模量 $G$，是平均应力 $p$ 的函数，并由一个代理模型提供。\n\n对于每个测试用例，通过遵循一个清晰的、分步的程序来获得解决方案。\n\n**1. 代理模型评估**\n\n第一步是计算路径中每个应力值 $p$ 对应的弹性模量 $K(p)$ 和 $G(p)$。该代理模型采用一个两阶段过程。首先，使用二次多项式计算原始值：\n$$\nk_{\\text{raw}}(p) = a_0 + a_1 p + a_2 p^2\n$$\n$$\ng_{\\text{raw}}(p) = b_0 + b_1 p + b_2 p^2\n$$\n系数 $(a_0, a_1, a_2, b_0, b_1, b_2)$ 对每个测试用例都是特定的。所有应力和模量值的单位均为兆帕 (MPa)。\n\n**2. 正性强制**\n\n为确保正定模量的物理约束 $K > 0$ 和 $G > 0$，原始输出通过 Softplus 函数 $\\operatorname{softplus}(x) = \\log(1 + e^x)$ 进行变换，并由小的正常数 $\\varepsilon_K$ 和 $\\varepsilon_G$ 进行平移。因此，模量由以下公式给出：\n$$\nK(p) = \\operatorname{softplus}(k_{\\text{raw}}(p)) + \\varepsilon_K = \\log(1 + e^{k_{\\text{raw}}(p)}) + \\varepsilon_K\n$$\n$$\nG(p) = \\operatorname{softplus}(g_{\\text{raw}}(p)) + \\varepsilon_G = \\log(1 + e^{g_{\\text{raw}}(p)}) + \\varepsilon_G\n$$\n问题指定常数为 $\\varepsilon_K = 10^{-12}$ 和 $\\varepsilon_G = 10^{-12}$。这种构造保证了对于任何有限的原始输出，$K(p)$ 和 $G(p)$ 都是严格为正的。\n\n**3. 强椭圆性条件**\n\n强椭圆性条件是材料稳定性的一个基本要求，确保波速为实数。它要求声学张量 $Q_{ij}(n) = C_{ipjq} n_p n_q$ 对于任意单位向量 $n$ 都是正定的。对于各向同性弹性材料，四阶刚度张量为\n$$\nC_{ijkl} = \\lambda\\,\\delta_{ij}\\delta_{kl} + \\mu\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right)\n$$\n其中拉梅参数通过 $\\mu = G$ 和 $\\lambda = K - \\frac{2}{3}G$ 与模量相关联。相应声学张量的特征值与方向 $n$ 无关，由 $G$（一个重复的横波模式）和 $K + \\frac{4}{3}G$（一个纵波模式）给出。\n因此，当且仅当两个特征值都严格为正时，强椭圆性条件得到满足：\n$$\nG  0 \\quad \\text{和} \\quad K + \\tfrac{4}{3}G  0\n$$\n\n**4. 在每个应力点计算最小特征值**\n\n在给定应力 $p$ 下的稳定性裕度是这两个特征值中较小的一个。我们将其定义为 $\\lambda_{\\min}(p)$：\n$$\n\\lambda_{\\min}(p) = \\min\\!\\left(G(p),\\, K(p) + \\tfrac{4}{3}G(p)\\right)\n$$\n对于每个测试用例，我们为集合 $\\{0, 50, 100, 200, 400\\}$ 中的每个 $p$ 计算 $K(p)$ 和 $G(p)$ 的值，然后计算相应的 $\\lambda_{\\min}(p)$。\n\n**5. 确定总体最小稳定性裕度**\n\n最终所需的量 $\\Lambda_{\\min}$ 代表整个应力路径上最紧的稳定性约束。它是通过取上一步计算出的所有 $\\lambda_{\\min}(p)$ 值的最小值得到的：\n$$\n\\Lambda_{\\min} = \\min_{p \\in \\{0,50,100,200,400\\}} \\lambda_{\\min}(p)\n$$\n对四个提供的测试用例中的每一个都执行此计算。每个用例的最终结果按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum strong ellipticity margin for a surrogate elastic model.\n    \"\"\"\n    \n    # Define constants and the stress path as specified\n    epsilon_K = 1e-12\n    epsilon_G = 1e-12\n    p_path = np.array([0., 50., 100., 200., 400.])\n\n    # Test cases: tuples of (a0, a1, a2, b0, b1, b2)\n    test_cases = [\n        # Case 1: increasing moduli\n        (5.0, 0.1, 0.0, 2.0, 0.05, 0.0),\n        # Case 2: decaying shear modulus\n        (10.0, 0.0, 0.0, 1.0, -0.0025, 0.0),\n        # Case 3: near-degenerate shear\n        (2.0, 0.0, 0.0, -10.0, 0.0, 0.0),\n        # Case 4: nonmonotone shear with quadratic term\n        (20.0, 0.05, 0.0, 0.5, 0.01, -1.0e-4)\n    ]\n\n    # Helper function for the Softplus transformation\n    def softplus(x):\n        return np.log(1 + np.exp(x))\n\n    all_results = []\n    \n    # Iterate through each test case\n    for case in test_cases:\n        a0, a1, a2, b0, b1, b2 = case\n        \n        # --- Step 1  2: Evaluate Surrogate Model with Positivity ---\n        # Calculate raw polynomial outputs for all p in the path (vectorized)\n        k_raw = a0 + a1 * p_path + a2 * p_path**2\n        g_raw = b0 + b1 * p_path + b2 * p_path**2\n        \n        # Apply Softplus transform and add epsilon to get K and G\n        K_p_array = softplus(k_raw) + epsilon_K\n        G_p_array = softplus(g_raw) + epsilon_G\n        \n        # --- Step 3  4: Evaluate Strong Ellipticity Eigenvalues ---\n        # The two eigenvalues of interest for the acoustic tensor are G and K + 4/3*G\n        eig_longitudinal = K_p_array + (4.0/3.0) * G_p_array\n        \n        # Find the minimum eigenvalue at each point p in the path\n        lambda_min_p_array = np.minimum(G_p_array, eig_longitudinal)\n\n        # --- Step 5: Determine Minimum over the Path ---\n        # Find the minimum of these eigenvalues over the entire path\n        Lambda_min = np.min(lambda_min_p_array)\n        \n        all_results.append(Lambda_min)\n\n    # Format the results to exactly six decimal places and produce the final output string\n    formatted_results = [\"{:.6f}\".format(r) for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```", "id": "3540275"}]}