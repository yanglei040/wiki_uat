{"hands_on_practices": [{"introduction": "岩土材料的特性，如刚度模量，在空间上是变化的。我们通常使用随机场来描述这种空间变异性。这个练习探讨了一个核心概念：空间平均如何影响变异性。通过推导一维随机场在给定长度上空间平均的方差，你将亲身体会到相关长度 $\\ell$ 在控制方差折减中的关键作用，这是地质统计学和随机建模中的一个基石。[@problem_id:3553043]", "problem": "考虑一个二阶平稳标量随机场 $E(x)$，它表示一维剖面上土体刚度模量的空间变异性。设其均值为 $\\mu_{E}$，协方差函数为 $C(h)=\\operatorname{Cov}\\!\\big(E(x),E(x+h)\\big)=\\sigma^{2}\\exp\\!\\big(-|h|/\\ell\\big)$，其中 $\\sigma^{2}$ 是方差，$\\ell$ 是相关长度。对于长度为 $L$ 的有限区间 $[0,L]$，定义空间平均 $\\bar{E}_{L}$ 为\n$$\n\\bar{E}_{L}=\\frac{1}{L}\\int_{0}^{L}E(x)\\,\\mathrm{d}x.\n$$\n仅使用二阶平稳场的方差和协方差定义以及积分的基本性质，推导方差 $\\operatorname{Var}(\\bar{E}_{L})$ 的一个仅含 $\\sigma^{2}$、$L$ 和 $\\ell$ 的闭式表达式。然后，根据推导的表达式，定性解释在极限情况 $L\\ll \\ell$ 和 $L\\gg \\ell$ 下，相关长度 $\\ell$ 如何决定 $\\operatorname{Var}(\\bar{E}_{L})$ 随 $L$ 变化的标度关系。给出 $\\operatorname{Var}(\\bar{E}_{L})$ 的最终表达式作为答案。最终表达式中不要包含任何单位。", "solution": "该问题具有科学依据，提法明确且客观。它提出了一个空间变异性材料属性随机建模中的标准任务，这是概率岩土力学的核心内容。所有必要的定义和参数都已给出，不存在矛盾或模糊之处。因此，有必要给出完整的解答。\n\n主要目标是推导二阶平稳随机场 $E(x)$ 在区间 $[0,L]$ 上的空间平均的方差表达式。空间平均 $\\bar{E}_{L}$ 定义为：\n$$\n\\bar{E}_{L} = \\frac{1}{L}\\int_{0}^{L} E(x)\\,\\mathrm{d}x\n$$\n$\\bar{E}_{L}$ 的方差由一般定义 $\\operatorname{Var}(\\bar{E}_{L}) = E[\\bar{E}_{L}^2] - (E[\\bar{E}_{L}])^2$ 给出。首先，我们确定 $\\bar{E}_{L}$ 的期望值。根据期望算子的线性性，我们可以交换期望和积分的顺序：\n$$\nE[\\bar{E}_{L}] = E\\left[\\frac{1}{L}\\int_{0}^{L} E(x)\\,\\mathrm{d}x\\right] = \\frac{1}{L}\\int_{0}^{L} E[E(x)]\\,\\mathrm{d}x\n$$\n由于场 $E(x)$ 是二阶平稳的，其均值 $E[E(x)]$ 对所有 $x$ 都是一个常数 $\\mu_{E}$。\n$$\nE[\\bar{E}_{L}] = \\frac{1}{L}\\int_{0}^{L} \\mu_{E}\\,\\mathrm{d}x = \\frac{1}{L}(\\mu_{E}L) = \\mu_{E}\n$$\n现在，我们使用其定义将 $\\bar{E}_{L}$ 的方差表示为一个二重积分。\n$$\n\\operatorname{Var}(\\bar{E}_{L}) = \\operatorname{Var}\\left(\\frac{1}{L}\\int_{0}^{L} E(x)\\,\\mathrm{d}x\\right) = \\frac{1}{L^2}\\operatorname{Var}\\left(\\int_{0}^{L} E(x)\\,\\mathrm{d}x\\right)\n$$\n积分的方差可以写成：\n$$\n\\operatorname{Var}\\left(\\int_{0}^{L} E(x)\\,\\mathrm{d}x\\right) = E\\left[\\left(\\int_{0}^{L} E(x)\\,\\mathrm{d}x - E\\left[\\int_{0}^{L}E(y)\\,\\mathrm{d}y\\right]\\right)^2\\right]\n$$\n由于 $E\\left[\\int_{0}^{L}E(y)\\,\\mathrm{d}y\\right] = L\\mu_{E}$，这变为：\n$$\nE\\left[\\left(\\int_{0}^{L} (E(x) - \\mu_{E})\\,\\mathrm{d}x\\right)^2\\right] = E\\left[\\left(\\int_{0}^{L} (E(x) - \\mu_{E})\\,\\mathrm{d}x\\right)\\left(\\int_{0}^{L} (E(y) - \\mu_{E})\\,\\mathrm{d}y\\right)\\right]\n$$\n$$\n= E\\left[\\int_{0}^{L}\\int_{0}^{L} (E(x) - \\mu_{E})(E(y) - \\mu_{E})\\,\\mathrm{d}x\\,\\mathrm{d}y\\right]\n$$\n交换期望和积分的顺序得到：\n$$\n\\int_{0}^{L}\\int_{0}^{L} E[(E(x) - \\mu_{E})(E(y) - \\mu_{E})]\\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_{0}^{L}\\int_{0}^{L} \\operatorname{Cov}(E(x), E(y))\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n对于二阶平稳场，协方差是间隔距离 $h = x-y$ 的函数，所以 $\\operatorname{Cov}(E(x), E(y)) = C(x-y)$。因此，平均值的方差是：\n$$\n\\operatorname{Var}(\\bar{E}_{L}) = \\frac{1}{L^2}\\int_{0}^{L}\\int_{0}^{L} C(x-y)\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n问题给出了指数型协方差函数 $C(h) = \\sigma^2 \\exp(-|h|/\\ell)$。将其代入方程：\n$$\n\\operatorname{Var}(\\bar{E}_{L}) = \\frac{\\sigma^2}{L^2}\\int_{0}^{L}\\int_{0}^{L} \\exp\\left(-\\frac{|x-y|}{\\ell}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n这个二重积分可以通过变量替换或识别此类积分的一般性质来高效计算。积分 $\\int_{0}^{L}\\int_{0}^{L} f(|x-y|)\\,\\mathrm{d}x\\,\\mathrm{d}y$ 等价于 $\\int_{-L}^{L} (L-|z|)f(|z|)\\,\\mathrm{d}z$。由于被积函数是 $z$ 的偶函数：\n$$\n\\int_{0}^{L}\\int_{0}^{L} \\exp\\left(-\\frac{|x-y|}{\\ell}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y = 2\\int_{0}^{L} (L-z)\\exp\\left(-\\frac{z}{\\ell}\\right)\\,\\mathrm{d}z\n$$\n我们使用分部积分法 $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$ 来计算这个积分。设 $u = L-z$ 且 $\\mathrm{d}v = \\exp(-z/\\ell)\\,\\mathrm{d}z$。则 $\\mathrm{d}u = -1\\,\\mathrm{d}z$ 且 $v = -\\ell\\exp(-z/\\ell)$。\n\\begin{align*} 2\\int_{0}^{L} (L-z)\\exp\\left(-\\frac{z}{\\ell}\\right)\\,\\mathrm{d}z = 2\\left(\\Big[(L-z)(-\\ell\\exp(-z/\\ell))\\Big]_{0}^{L} - \\int_{0}^{L} (-\\ell\\exp(-z/\\ell))(-1\\,\\mathrm{d}z)\\right) \\\\ = 2\\left(\\Big[0 - (L)(-\\ell)\\Big] - \\ell\\int_{0}^{L} \\exp(-z/\\ell)\\,\\mathrm{d}z\\right) \\\\ = 2\\left(L\\ell - \\ell\\Big[-\\ell\\exp(-z/\\ell)\\Big]_{0}^{L}\\right) \\\\ = 2\\left(L\\ell - \\ell(-\\ell\\exp(-L/\\ell) - (-\\ell))\\right) \\\\ = 2\\left(L\\ell - \\ell^2(1 - \\exp(-L/\\ell))\\right) \\\\ = 2L\\ell - 2\\ell^2(1 - \\exp(-L/\\ell))\\end{align*}\n将此结果代回 $\\operatorname{Var}(\\bar{E}_{L})$ 的表达式中：\n$$\n\\operatorname{Var}(\\bar{E}_{L}) = \\frac{\\sigma^2}{L^2}\\left[2L\\ell - 2\\ell^2\\left(1 - \\exp\\left(-\\frac{L}{\\ell}\\right)\\right)\\right]\n$$\n这个表达式可以重新整理成一个更具洞察力的形式：\n$$\n\\operatorname{Var}(\\bar{E}_{L}) = \\frac{2\\sigma^2 \\ell^2}{L^2}\\left[\\frac{L}{\\ell} - 1 + \\exp\\left(-\\frac{L}{\\ell}\\right)\\right]\n$$\n这就是所求的空间平均方差的闭式表达式。\n\n接下来，我们分析在两种极限情况下 $\\operatorname{Var}(\\bar{E}_{L})$ 的标度关系。设 $\\rho = L/\\ell$ 为平均长度与相关长度的无量纲比率。\n\n情况1：$L \\ll \\ell$ (平均长度远小于相关长度)。\n在此情况下，$\\rho \\to 0$。我们使用 $\\exp(-\\rho)$ 在 $\\rho=0$ 附近的泰勒级数展开：\n$\\exp(-\\rho) = 1 - \\rho + \\frac{\\rho^2}{2!} - \\frac{\\rho^3}{3!} + O(\\rho^4)$。\n将此代入方括号中的项：\n$$\n\\rho - 1 + \\exp(-\\rho) \\approx \\rho - 1 + \\left(1 - \\rho + \\frac{\\rho^2}{2}\\right) = \\frac{\\rho^2}{2}\n$$\n方差变为：\n$$\n\\operatorname{Var}(\\bar{E}_{L}) \\approx \\frac{2\\sigma^2}{\\rho^2}\\left(\\frac{\\rho^2}{2}\\right) = \\sigma^2\n$$\n定性地讲，当 $L$ 相对于 $\\ell$ 非常小时，随机场 $E(x)$ 在区间 $[0,L]$ 上是高度相关的。$E(x)$ 的值近似恒定，因此空间平均 $\\bar{E}_{L}$ 近似等于单个点的值，例如 $E(0)$。因此，平均值的方差接近点方差，$\\operatorname{Var}(\\bar{E}_{L}) \\approx \\operatorname{Var}(E(0)) = \\sigma^2$。平均化带来的方差减小效果可以忽略不计。\n\n情况2：$L \\gg \\ell$ (平均长度远大于相关长度)。\n在此情况下，$\\rho \\to \\infty$。当 $\\rho$ 变大时，项 $\\exp(-\\rho)$ 趋近于 0。方括号中的项近似变为 $(\\rho - 1)$。由于 $\\rho \\gg 1$，这可以进一步近似为 $\\rho$。\n$$\n\\operatorname{Var}(\\bar{E}_{L}) \\approx \\frac{2\\sigma^2 \\ell^2}{L^2}\\left(\\frac{L}{\\ell}\\right) = \\frac{2\\sigma^2\\ell}{L}\n$$\n方差与平均长度 $L$ 成反比。\n定性地讲，当 $L$ 远大于 $\\ell$ 时，$\\bar{E}_{L}$ 的积分是在随机场的许多近似独立的片段上进行平均，每个片段的近似长度与相关长度 $\\ell$ 有关。基于类似中心极限定理的论证，对大约 $N \\approx L/\\ell$ 个独立块进行平均会将方差减小一个因子 $N$。这导致了标度关系 $\\operatorname{Var}(\\bar{E}_{L}) \\propto 1/N \\propto \\ell/L$。本例中的比例常数 $2$ 取决于协方差函数的形式。这种显著的方差减小是地质统计估计和尺度提升中的一个关键原则。", "answer": "$$\n\\boxed{\\frac{2\\sigma^2 \\ell^2}{L^2} \\left(\\frac{L}{\\ell} - 1 + \\exp\\left(-\\frac{L}{\\ell}\\right)\\right)}\n$$", "id": "3553043"}, {"introduction": "在概率岩土力学中，我们经常需要为不确定的参数选择合适的概率分布。虽然正态分布因其数学便利性而被广泛使用，但许多岩土参数（如摩擦角 $\\phi$）受到物理定律的严格约束。这个练习将指导你应用截断正态分布来为这些有界参数建模，并推导其精确的均值和方差，这是确保概率模型物理意义和准确性的关键一步。[@problem_id:3553047]", "problem": "一座土堤采用粒状回填土设计，其抗剪强度使用摩尔-库仑准则进行建模。摩擦角 $\\,\\phi\\,$ 是不确定的，由一个均值为 $\\,\\mu\\,$、标准差为 $\\,\\sigma\\,$ 的正态先验分布表示。但物理原理和场地特征将 $\\,\\phi\\,$ 约束在容许区间 $[20^\\circ,45^\\circ]$ 内。因此，预测模型采用了支撑在 $[20^\\circ,45^\\circ]$ 上的 $\\,\\phi\\,$ 的截断正态分布。令 $\\,\\varphi(z)\\,$ 和 $\\,\\Phi(z)\\,$ 分别表示标准正态概率密度函数和累积分布函数。假设 $\\,\\sigma0\\,$，且 $\\,\\mu\\,$ 和 $\\,\\sigma\\,$ 以度为单位表示，因此 $\\,(\\phi-\\mu)/\\sigma\\,$ 是无量纲的。\n\n从正态概率密度函数以及条件期望和方差的定义出发，仅使用标准化 $\\,z=(\\phi-\\mu)/\\sigma\\,$ 以及 $\\,\\varphi\\,$ 和 $\\,\\Phi\\,$ 的性质，推导在 $[20^\\circ,45^\\circ]$ 上 $\\,\\phi\\,$ 的截断正态模型的均值 $\\,\\mathbb{E}[\\phi]\\,$ 和方差 $\\,\\mathrm{Var}[\\phi]\\,$ 的闭式表达式，表达式须用 $\\,\\mu\\,$, $\\,\\sigma\\,$, $\\,\\varphi(\\cdot)$ 和 $\\,\\Phi(\\cdot)$ 表示。你的最终表达式必须是解析的，且不得包含数值近似。\n\n将 $\\,\\mathbb{E}[\\phi]\\,$ 以度为单位表示，$\\,\\mathrm{Var}[\\phi]\\,$ 以平方度为单位表示。无需四舍五入，你必须提供精确表达式。", "solution": "该问题是良定的，并具有科学依据。它要求推导截断正态分布的均值和方差，这是概率建模中应用于岩土力学现实情境的一个标准程序。我们开始推导。\n\n设摩擦角为随机变量 $\\phi$。其先验分布为均值是 $\\mu$、标准差是 $\\sigma$ 的正态分布，其概率密度函数 (PDF) 由下式给出\n$$ f(\\phi) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{\\phi-\\mu}{\\sigma}\\right)^2\\right) $$\n使用标准正态 PDF 的定义 $\\varphi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^2}{2}\\right)$，我们可以将其写为：\n$$ f(\\phi) = \\frac{1}{\\sigma} \\varphi\\left(\\frac{\\phi-\\mu}{\\sigma}\\right) $$\n变量 $\\phi$ 被截断到区间 $[a, b]$，其中 $a=20^\\circ$，$b=45^\\circ$。为简便起见，我们也用 $\\phi$ 表示该截断变量，其 PDF 由下式给出\n$$ f_{\\text{trunc}}(\\phi) = \\frac{f(\\phi)}{\\int_a^b f(x) \\, dx}, \\quad \\text{for } \\phi \\in [a, b] $$\n其他情况下 $f_{\\text{trunc}}(\\phi) = 0$。\n\n分母是未截断变量落在区间 $[a, b]$ 内的概率。我们可以使用标准正态分布的累积分布函数 (CDF) $\\Phi(z) = \\int_{-\\infty}^z \\varphi(t) \\, dt$ 来计算此积分。\n$$ \\int_a^b f(x) \\, dx = \\int_a^b \\frac{1}{\\sigma} \\varphi\\left(\\frac{x-\\mu}{\\sigma}\\right) \\, dx $$\n我们使用标准化 $z = (x-\\mu)/\\sigma$，这意味着 $dx = \\sigma \\, dz$。积分限变为 $\\alpha = (a-\\mu)/\\sigma$ 和 $\\beta = (b-\\mu)/\\sigma$。\n$$ \\int_a^b f(x) \\, dx = \\int_\\alpha^\\beta \\varphi(z) \\, dz = \\Phi(\\beta) - \\Phi(\\alpha) $$\n因此，截断变量的 PDF 为：\n$$ f_{\\text{trunc}}(\\phi) = \\frac{\\frac{1}{\\sigma} \\varphi\\left(\\frac{\\phi-\\mu}{\\sigma}\\right)}{\\Phi(\\beta) - \\Phi(\\alpha)} $$\n对于 $\\phi \\in [a, b]$，其中 $a=20^\\circ$，$b=45^\\circ$。为简洁起见，令 $K = \\Phi(\\beta) - \\Phi(\\alpha)$。\n\n首先，我们推导均值 $\\mathbb{E}[\\phi]$。\n$$ \\mathbb{E}[\\phi] = \\int_a^b \\phi \\, f_{\\text{trunc}}(\\phi) \\, d\\phi = \\frac{1}{K} \\int_a^b \\phi \\frac{1}{\\sigma} \\varphi\\left(\\frac{\\phi-\\mu}{\\sigma}\\right) \\, d\\phi $$\n使用相同的代换 $z = (\\phi-\\mu)/\\sigma$，我们得到 $\\phi = \\mu + \\sigma z$ 和 $d\\phi = \\sigma \\, dz$。\n$$ \\mathbb{E}[\\phi] = \\frac{1}{K} \\int_\\alpha^\\beta (\\mu + \\sigma z) \\, \\varphi(z) \\, dz $$\n我们可以将该积分分成两部分：\n$$ \\mathbb{E}[\\phi] = \\frac{1}{K} \\left[ \\mu \\int_\\alpha^\\beta \\varphi(z) \\, dz + \\sigma \\int_\\alpha^\\beta z \\varphi(z) \\, dz \\right] $$\n第一个积分是 $\\int_\\alpha^\\beta \\varphi(z) \\, dz = \\Phi(\\beta) - \\Phi(\\alpha) = K$。\n对于第二个积分，我们利用标准正态 PDF 的导数性质 $\\varphi'(z) = -z \\varphi(z)$。因此，$\\int z \\varphi(z) \\, dz = \\int -\\varphi'(z) \\, dz = -\\varphi(z) + C$。\n$$ \\int_\\alpha^\\beta z \\varphi(z) \\, dz = [-\\varphi(z)]_\\alpha^\\beta = -\\varphi(\\beta) - (-\\varphi(\\alpha)) = \\varphi(\\alpha) - \\varphi(\\beta) $$\n将这些结果代回 $\\mathbb{E}[\\phi]$ 的表达式中：\n$$ \\mathbb{E}[\\phi] = \\frac{1}{K} [ \\mu K + \\sigma (\\varphi(\\alpha) - \\varphi(\\beta)) ] = \\mu + \\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)} $$\n\n接下来，我们推导方差 $\\mathrm{Var}[\\phi] = \\mathbb{E}[\\phi^2] - (\\mathbb{E}[\\phi])^2$。我们首先需要计算二阶矩 $\\mathbb{E}[\\phi^2]$。\n$$ \\mathbb{E}[\\phi^2] = \\int_a^b \\phi^2 \\, f_{\\text{trunc}}(\\phi) \\, d\\phi = \\frac{1}{K} \\int_a^b \\phi^2 \\frac{1}{\\sigma} \\varphi\\left(\\frac{\\phi-\\mu}{\\sigma}\\right) \\, d\\phi $$\n再次使用代换 $\\phi = \\mu + \\sigma z$：\n$$ \\mathbb{E}[\\phi^2] = \\frac{1}{K} \\int_\\alpha^\\beta (\\mu + \\sigma z)^2 \\varphi(z) \\, dz = \\frac{1}{K} \\int_\\alpha^\\beta (\\mu^2 + 2\\mu\\sigma z + \\sigma^2 z^2) \\varphi(z) \\, dz $$\n我们将其分为三个积分：\n$$ \\mathbb{E}[\\phi^2] = \\frac{1}{K} \\left[ \\mu^2 \\int_\\alpha^\\beta \\varphi(z) \\, dz + 2\\mu\\sigma \\int_\\alpha^\\beta z \\varphi(z) \\, dz + \\sigma^2 \\int_\\alpha^\\beta z^2 \\varphi(z) \\, dz \\right] $$\n我们已经知道前两个积分。对于第三个积分 $\\int z^2 \\varphi(z) \\, dz$，我们使用分部积分法，令 $u = z$，$dv = z \\varphi(z) \\, dz$。则 $du=dz$，$v = -\\varphi(z)$。\n$$ \\int z^2 \\varphi(z) \\, dz = -z\\varphi(z) - \\int (-\\varphi(z)) \\, dz = -z\\varphi(z) + \\int \\varphi(z) \\, dz = -z\\varphi(z) + \\Phi(z) + C $$\n因此，该定积分为：\n$$ \\int_\\alpha^\\beta z^2 \\varphi(z) \\, dz = [-z\\varphi(z) + \\Phi(z)]_\\alpha^\\beta = (-\\beta\\varphi(\\beta) + \\Phi(\\beta)) - (-\\alpha\\varphi(\\alpha) + \\Phi(\\alpha)) = \\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta) + K $$\n将这三个积分的结果代入 $\\mathbb{E}[\\phi^2]$ 的表达式中：\n$$ \\mathbb{E}[\\phi^2] = \\frac{1}{K} \\left[ \\mu^2 K + 2\\mu\\sigma (\\varphi(\\alpha) - \\varphi(\\beta)) + \\sigma^2 (\\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta) + K) \\right] $$\n$$ \\mathbb{E}[\\phi^2] = \\mu^2 + 2\\mu\\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} + \\sigma^2 \\frac{\\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta)}{K} + \\sigma^2 $$\n现在我们计算方差：$\\mathrm{Var}[\\phi] = \\mathbb{E}[\\phi^2] - (\\mathbb{E}[\\phi])^2$。\n$$ (\\mathbb{E}[\\phi])^2 = \\left( \\mu + \\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} \\right)^2 = \\mu^2 + 2\\mu\\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} + \\sigma^2 \\left( \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} \\right)^2 $$\n从 $\\mathbb{E}[\\phi^2]$ 中减去 $(\\mathbb{E}[\\phi])^2$：\n$$ \\mathrm{Var}[\\phi] = \\left( \\mu^2 + 2\\mu\\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} + \\sigma^2 \\frac{\\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta)}{K} + \\sigma^2 \\right) - \\left( \\mu^2 + 2\\mu\\sigma \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} + \\sigma^2 \\left( \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} \\right)^2 \\right) $$\n包含 $\\mu^2$ 和 $2\\mu\\sigma$ 的项相互抵消，剩下：\n$$ \\mathrm{Var}[\\phi] = \\sigma^2 + \\sigma^2 \\frac{\\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta)}{K} - \\sigma^2 \\left( \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{K} \\right)^2 $$\n提出 $\\sigma^2$ 并代回 $K = \\Phi(\\beta) - \\Phi(\\alpha)$：\n$$ \\mathrm{Var}[\\phi] = \\sigma^2 \\left[ 1 + \\frac{\\alpha\\varphi(\\alpha) - \\beta\\varphi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)} - \\left( \\frac{\\varphi(\\alpha) - \\varphi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)} \\right)^2 \\right] $$\n问题已完全解决。推导出的 $\\mathbb{E}[\\phi]$ 和 $\\mathrm{Var}[\\phi]$ 的表达式是解析的，并以给定的参数和函数表示。标准化后的积分限为 $\\alpha = (20 - \\mu)/\\sigma$ 和 $\\beta = (45 - \\mu)/\\sigma$，其中 $\\mu$ 和 $\\sigma$ 以度为单位。根据要求，$\\mathbb{E}[\\phi]$ 的表达式将以度为单位，而 $\\mathrm{Var}[\\phi]$ 将以平方度为单位。\n\n当 $\\alpha = (20-\\mu)/\\sigma$ 和 $\\beta=(45-\\mu)/\\sigma$ 时，$\\mathbb{E}[\\phi]$ 和 $\\mathrm{Var}[\\phi]$ 的最终表达式为：\n\n均值：\n$$ \\mathbb{E}[\\phi] = \\mu + \\sigma \\frac{\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} $$\n方差：\n$$ \\mathrm{Var}[\\phi] = \\sigma^2 \\left[ 1 + \\frac{\\left(\\frac{20-\\mu}{\\sigma}\\right)\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\left(\\frac{45-\\mu}{\\sigma}\\right)\\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} - \\left( \\frac{\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} \\right)^2 \\right] $$\n对于最终答案，我们使用含 $\\alpha$ 和 $\\beta$ 的紧凑表示法。", "answer": "$$ \\boxed{\\begin{aligned} \\mathbb{E}[\\phi] = \\mu + \\sigma \\frac{\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} \\\\ \\mathrm{Var}[\\phi] = \\sigma^2 \\left( 1 + \\frac{\\left(\\frac{20-\\mu}{\\sigma}\\right)\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\left(\\frac{45-\\mu}{\\sigma}\\right)\\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} - \\left( \\frac{\\varphi\\left(\\frac{20-\\mu}{\\sigma}\\right) - \\varphi\\left(\\frac{45-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{45-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{20-\\mu}{\\sigma}\\right)} \\right)^2 \\right) \\end{aligned}} $$", "id": "3553047"}, {"introduction": "评估岩土工程系统的安全性通常意味着需要计算极端罕见的失效事件的概率，例如边坡失稳。直接的蒙特卡洛模拟在这种情况下是不可行的。本练习让你亲手实践一种强大的高级模拟方法——子集模拟（Subset Simulation），它将一个罕见事件问题转化为一系列更频繁的条件事件。你将学习如何为该方法设计中间阈值，并分析其估计量的方差，从而深入理解其性能和工作原理。[@problem_id:3553129]", "problem": "考虑一个概率性边坡稳定性评估，其中标量性能变量 $Y$ 代表一个由随机抗剪强度和孔隙水压力贡献聚合而成的无量纲安全裕度。假设 $Y$ 被建模为一个高斯随机变量 $Y \\sim \\mathcal{N}(\\mu,\\sigma^2)$，这与当存在许多独立不确定性贡献时中心极限定理 (Central Limit Theorem, CLT) 的结论一致。失效由罕见事件阈值超越 $\\{Y \\ge b_L\\}$ 定义，其概率为 $P_f \\approx 10^{-6}$。为使用子集模拟 (Subset Simulation, SuS) 估计 $P_f$，设计一个嵌套的中间阈值序列 $\\{b_\\ell\\}_{\\ell=1}^L$，使得水平集 $\\{Y \\ge b_1\\} \\supset \\{Y \\ge b_2\\} \\supset \\dots \\supset \\{Y \\ge b_L\\}$ 在每个水平上都满足一个恒定的条件超越概率 $p_0$，并且乘积 $\\prod_{\\ell=1}^L p_0$ 近似于 $P_f$。对于每个水平给定的条件样本量 $m$，SuS 对 $P_f$ 的估计量是在设计的阈值下 $L$ 个超越样本比例的乘积。\n\n从基本概率定义出发，将每个水平内的超越指示变量建模为成功概率为 $p_0$ 的独立伯努利随机变量，这样样本比例就是条件概率的无偏估计量。使用这种独立性理想化作为设计代理，并推导出估计量方差，作为条件样本量 $m$、水平数 $L$ 和恒定条件概率 $p_0$ 的函数。对于阈值设计，使用高斯分位数关系来确定 $b_\\ell$，使得无条件尾部概率满足 $\\mathbb{P}(Y \\ge b_\\ell) = p_0^\\ell$，确保嵌套的罕见事件序列具有预期的尾部概率。\n\n你的程序必须：\n- 对标准化的 $\\mu=0$ 和 $\\sigma=1$ 的高斯变量 $Y$ 实现阈值设计，对于给定的 $p_0$ 和每个水平 $\\ell=1,\\dots,L$，通过标准正态逆累积分布函数计算 $b_\\ell$。\n- 在上述独立性代理模型下，实现 SuS 乘积估计量的方差计算，该方差纯粹用 $m$、$L$ 和 $p_0$ 表示。\n- 使用以下参数集 $(p_0,m,L)$ 的测试套件：\n    1. $(0.1,1000,6)$，作为目标为 $P_f \\approx 10^{-6}$ 的典型罕见事件设计。\n    2. $(0.1,200,6)$，用于检验条件样本量减小时估计量方差的增加。\n    3. $(0.1,10000,6)$，用于检验条件样本量增大时方差的减小。\n    4. $(0.2,800,9)$，用于检验一个产生大致相同目标罕见性水平的不同 $p_0$。\n    5. $(0.05,500,5)$，用于检验一个具有更少水平但更激进的水平概率。\n- 最终输出为一行，包含五个测试用例的估计量方差，形式为方括号内以逗号分隔的列表，例如，“[v1,v2,v3,v4,v5]”。每个条目必须是浮点数。不应打印其他任何文本。\n\n所有量均为无量纲，因此不需要物理单位。不涉及角度。将 $p_0$ 值表示为 $(0,1)$ 内的小数。", "solution": "子集模拟 (SuS) 框架通过将罕见事件概率 $P_f$ 分解为多个更可能发生的条件事件的乘积来对其进行估计。失效事件为 $\\{Y \\ge b_L\\}$，其中 $Y$ 是一个标量性能变量，根据中心极限定理 (CLT)，由于大量不确定性的聚合，这里将其建模为 $Y \\sim \\mathcal{N}(\\mu,\\sigma^2)$。在 SuS 中，我们选择中间阈值 $\\{b_\\ell\\}_{\\ell=1}^L$ 来形成嵌套事件 $\\{Y \\ge b_1\\} \\supset \\dots \\supset \\{Y \\ge b_L\\}$，并设计每个水平的条件超越概率为一个常数 $p_0 \\in (0,1)$。这得到\n$$\nP_f \\approx \\prod_{\\ell=1}^L p_0 = p_0^L,\n$$\n它指导了 $L$ 和 $p_0$ 的选择，使得对于罕见事件的边坡失效，$p_0^L \\approx 10^{-6}$。\n\n高斯模型下的阈值设计利用了尾部概率随阈值的单调性。对于给定的 $p_0$ 和水平索引 $\\ell$，无条件尾部概率要求 $\\mathbb{P}(Y \\ge b_\\ell) = p_0^\\ell$ 通过标准正态累积分布函数 (CDF) $\\Phi(\\cdot)$ 转化为一个分位数方程：\n$$\n\\mathbb{P}(Y \\ge b_\\ell) = 1 - \\Phi\\!\\left(\\frac{b_\\ell - \\mu}{\\sigma}\\right) = p_0^\\ell.\n$$\n解出 $b_\\ell$ 得\n$$\nb_\\ell = \\mu + \\sigma \\,\\Phi^{-1}\\!\\left(1 - p_0^\\ell\\right),\n$$\n其中 $\\Phi^{-1}(\\cdot)$ 表示标准正态分布的逆累积分布函数（分位数函数）。对于标准化的 $Y$（$\\mu=0$ 且 $\\sigma=1$），这简化为\n$$\nb_\\ell = \\Phi^{-1}\\!\\left(1 - p_0^\\ell\\right).\n$$\n这个序列确保了 $\\{Y \\ge b_\\ell\\}$ 是嵌套的，并具有规定的无条件尾部概率。\n\n我们现在推导估计量方差，作为条件样本量 $m$、水平数 $L$ 和恒定条件概率 $p_0$ 的函数。在水平 $\\ell$，抽取 $m$ 个样本并形成指示变量 $I_{\\ell,i}$，如果第 $\\ell$ 个水平的条件满足，则 $I_{\\ell,i}=1$，否则为 $0$。在将 $I_{\\ell,i}$ 视为成功概率为 $p_0$ 的独立同分布伯努利随机变量的设计代理下，样本比例\n$$\n\\hat{p}_\\ell = \\frac{1}{m}\\sum_{i=1}^m I_{\\ell,i}\n$$\n是 $p_0$ 的一个无偏估计量，即 $\\mathbb{E}[\\hat{p}_\\ell] = p_0$，其方差为\n$$\n\\mathrm{Var}(\\hat{p}_\\ell) = \\frac{p_0(1-p_0)}{m}.\n$$\nSuS 对失效概率的估计量是 $L$ 个估计的条件概率的乘积，\n$$\n\\hat{P}_f = \\prod_{\\ell=1}^L \\hat{p}_\\ell.\n$$\n假设各水平的估计量之间相互独立（这是一个标准的设计理想化，当马尔可夫链蒙特卡洛相关性可忽略或得到有效控制时，它提供了方差的下界），我们可以使用独立随机变量 $X_1,\\dots,X_L$ 的恒等式来计算乘积的方差：\n$$\n\\mathrm{Var}\\!\\left(\\prod_{\\ell=1}^L X_\\ell\\right) = \\prod_{\\ell=1}^L \\mathbb{E}[X_\\ell^2] - \\prod_{\\ell=1}^L \\left(\\mathbb{E}[X_\\ell]\\right)^2.\n$$\n这里 $X_\\ell=\\hat{p}_\\ell$，所以我们需要 $\\mathbb{E}[\\hat{p}_\\ell^2]$。对于 $m$ 次成功概率为 $p_0$ 的独立伯努利试验的样本比例，我们有\n$$\n\\mathbb{E}[\\hat{p}_\\ell^2] = \\mathrm{Var}(\\hat{p}_\\ell) + \\left(\\mathbb{E}[\\hat{p}_\\ell]\\right)^2 = \\frac{p_0(1-p_0)}{m} + p_0^2.\n$$\n代入可得\n$$\n\\mathrm{Var}(\\hat{P}_f) = \\prod_{\\ell=1}^L \\left(p_0^2 + \\frac{p_0(1-p_0)}{m}\\right) - \\prod_{\\ell=1}^L p_0^2.\n$$\n因为 $p_0$ 在所有水平上是常数，这简化为\n$$\n\\mathrm{Var}(\\hat{P}_f) = \\left(p_0^2 + \\frac{p_0(1-p_0)}{m}\\right)^L - p_0^{2L}.\n$$\n将 $p_0^{2L}$ 因子化出来会很有启发性：\n$$\n\\mathrm{Var}(\\hat{P}_f) = p_0^{2L}\\left[\\left(1 + \\frac{1-p_0}{m\\,p_0}\\right)^L - 1\\right],\n$$\n这明确地显示了方差如何随 $m$ 变化（随 $m$ 增大而减小）和随 $L$ 变化（对于固定的 $m$ 和 $p_0$，随水平数增多而增大）。注意，估计量的均值为 $\\mathbb{E}[\\hat{P}_f]=p_0^L$，这与独立性假设下的无偏乘积估计量是一致的。\n\n程序的算法设计：\n1. 对于每个测试用例 $(p_0,m,L)$，使用 $b_\\ell=\\Phi^{-1}(1-p_0^\\ell)$（其中 $\\mu=0, \\sigma=1$）为 $\\ell=1,\\dots,L$ 计算水平阈值 $b_\\ell$。这一步验证了阈值设计步骤，但在独立性代理模型下不影响方差表达式。\n2. 使用\n$$\n\\mathrm{Var}(\\hat{P}_f) = \\left(p_0^2 + \\frac{p_0(1-p_0)}{m}\\right)^L - p_0^{2L}\n$$\n计算估计量方差。\n3. 将五个测试用例的方差汇总到一个列表中，并按要求的格式单行打印。\n\n这种方法基于伯努利试验的基本定义和独立随机变量的性质，将岩土力学中的罕见事件估计任务与一个易于处理的统计设计公式联系起来。高斯阈值设计与从无条件尾部概率到分位数的单调映射相一致，确保了在罕见事件情境下为子集模拟提供一个科学上真实且自洽的设置。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef subset_sim_variance(p0: float, m: int, L: int) - float:\n    \"\"\"\n    Compute the variance of the Subset Simulation estimator under\n    the independence surrogate:\n        Var(P_hat_f) = (p0^2 + p0*(1 - p0)/m)^L - p0^(2L)\n    \"\"\"\n    term = (p0 ** 2) + (p0 * (1.0 - p0) / m)\n    return (term ** L) - (p0 ** (2 * L))\n\ndef design_thresholds_gaussian(p0: float, L: int, mu: float = 0.0, sigma: float = 1.0):\n    \"\"\"\n    Design intermediate thresholds for Y ~ N(mu, sigma^2) such that\n    P(Y = b_l) = p0^l for l = 1..L.\n    Returns a list of thresholds [b_1, ..., b_L].\n    \"\"\"\n    thresholds = []\n    for l in range(1, L + 1):\n        tail_prob = p0 ** l\n        # b_l = mu + sigma * Phi^{-1}(1 - p0^l)\n        bl = mu + sigma * norm.ppf(1.0 - tail_prob)\n        thresholds.append(bl)\n    return thresholds\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (p0, m, L)\n    test_cases = [\n        (0.1, 1000, 6),   # Typical rare-event design P_f ≈ 1e-6\n        (0.1, 200, 6),    # Smaller m increases variance\n        (0.1, 10000, 6),  # Larger m decreases variance\n        (0.2, 800, 9),    # Different p0, similar rarity\n        (0.05, 500, 5),   # More aggressive p0 with fewer levels\n    ]\n\n    results = []\n    for p0, m, L in test_cases:\n        # Threshold design (computed but not printed, validates the design step)\n        _thresholds = design_thresholds_gaussian(p0, L, mu=0.0, sigma=1.0)\n\n        # Compute variance of the SuS estimator under independence surrogate\n        var_est = subset_sim_variance(p0, m, L)\n        results.append(var_est)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3553129"}]}