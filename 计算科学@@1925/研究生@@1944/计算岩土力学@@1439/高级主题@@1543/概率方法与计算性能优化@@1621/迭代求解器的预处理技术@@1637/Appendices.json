{"hands_on_practices": [{"introduction": "在设计高效的预条件子之前，我们必须首先理解线性系统病态的根源。本练习通过一个基础的一维弹性杆模型，引导我们从第一性原理出发，分析有限元离散化如何导致刚度矩阵的条件数随网格加密而恶化[@problem_id:3590176]。通过精确推导该矩阵的特征值谱，我们将揭示条件数与离散化尺度之间的定量关系，从而为预条件技术的必要性提供一个清晰而有力的论证。", "problem": "考虑一根长度为 $L$、杨氏模量为 $E$、截面积为常数 $A$ 的一维 ($1$D) 直杆线性弹性杆。其轴向位移场 $u(x)$ 满足平衡强形式方程 $-\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right)=f(x)$ 以及齐次 Dirichlet 边界条件 $u(0)=0$ 和 $u(L)=0$。使用 Galerkin 有限元法，通过 $n$ 个均匀线性单元（每个单元长度为 $h=L/n$）和标准的节点“帽”形函数对该杆进行离散化。组装与内部节点自由度相关的全局刚度矩阵 $A$（由于齐次 Dirichlet 边界条件，存在 $n-1$ 个内部节点）。\n\n从有限元弱形式和线性形函数的单元刚度定义出发，推导在此均匀网格和边界条件设置下，组装的刚度矩阵 $A$ 的精确特征值。然后，利用对称正定矩阵在欧几里得 ($2$-)范数下的谱条件数定义 $\\kappa_{2}(A)=\\lambda_{\\max}(A)/\\lambda_{\\min}(A)$，给出 $\\kappa_{2}(A)$ 作为 $n$ 的函数的闭式解析表达式。\n\n你的最终答案必须是仅用 $n$ 表示的单个闭式表达式。不需要四舍五入。解释该特征结构如何与诸如 Conjugate Gradient (CG) 方法等迭代求解器的性能相关联，并说明其如何启发预处理设计，但要确保最终报告的量仅为条件数作为 $n$ 的函数的解析表达式。", "solution": "一维 ($1$D) 杆的轴向平衡由强形式方程 $-\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right)=f(x)$ 和齐次 Dirichlet 边界条件 $u(0)=0$ 及 $u(L)=0$ 决定。为了进行刚度分析和特征结构推导，只需考虑齐次情况 $f(x)=0$ 即可，因为刚度矩阵 $A$ 是由左侧算子的双线性形式定义的。\n\n使用 $n$ 个均匀线性单元的 Galerkin 有限元法将区域划分为位于 $x_{j}=j\\,h$（其中 $j=0,1,\\dots,n$，$h=L/n$）的节点。内部节点未知数为 $u_{j}$（其中 $j=1,\\dots,n-1$），因为边界值 $u_{0}=0$ 和 $u_{n}=0$ 由齐次 Dirichlet 边界条件规定。对于跨越 $\\left[x_{e},x_{e+1}\\right]$ 的单个线性单元，根据弱形式和线性形函数计算出的单元刚度矩阵为\n$$\nk^{(e)}=\\frac{EA}{h}\\begin{pmatrix}1   -1 \\\\ -1   1\\end{pmatrix}.\n$$\n对这 $n$ 个单元进行组装，得到一个针对内部自由度的尺寸为 $(n-1)\\times(n-1)$ 的全局刚度矩阵 $A$。所得矩阵的形式为\n$$\nA=\\frac{EA}{h}\\,T,\n$$\n其中 $T$ 是三对角 Toeplitz 矩阵\n$$\nT=\\begin{pmatrix}\n2   -1   0   \\cdots   0 \\\\\n-1   2   -1   \\ddots   \\vdots \\\\\n0   -1   2   \\ddots   0 \\\\\n\\vdots   \\ddots   \\ddots   \\ddots   -1 \\\\\n0   \\cdots   0   -1   2\n\\end{pmatrix}.\n$$\n这个 $T$ 是具有 $(n-1)$ 个内部点的均匀一维网格上的标准离散 Dirichlet 拉普拉斯算子。\n\n为计算 $T$ 的精确特征值，考虑候选特征向量 $v^{(k)}\\in\\mathbb{R}^{n-1}$（其中 $k=1,2,\\dots,n-1$），其分量为\n$$\nv^{(k)}_{j}=\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right),\\quad j=1,2,\\dots,n-1.\n$$\n我们证明对于适当的 $\\lambda_{k}$，有 $T\\,v^{(k)}=\\lambda_{k}\\,v^{(k)}$。计算 $T$ 在索引 $j$ 处对 $v^{(k)}$ 的作用得到\n$$\n(T\\,v^{(k)})_{j}=-v^{(k)}_{j-1}+2\\,v^{(k)}_{j}-v^{(k)}_{j+1},\n$$\n并约定 $v^{(k)}_{0}=0$ 和 $v^{(k)}_{n}=0$，这与 Dirichlet 边界条件一致。使用正弦和角公式，\n$$\nv^{(k)}_{j\\pm 1}=\\sin\\left(\\frac{(j\\pm 1)\\,k\\,\\pi}{n}\\right)=\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\cos\\left(\\frac{k\\,\\pi}{n}\\right)\\pm\\cos\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\sin\\left(\\frac{k\\,\\pi}{n}\\right),\n$$\n我们得到\n\\begin{align*}\n(T\\,v^{(k)})_{j}\n=-\\left[\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\cos\\left(\\frac{k\\,\\pi}{n}\\right)-\\cos\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\sin\\left(\\frac{k\\,\\pi}{n}\\right)\\right]\\\\\n\\quad+2\\,\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\\\\n\\quad-\\left[\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\cos\\left(\\frac{k\\,\\pi}{n}\\right)+\\cos\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\sin\\left(\\frac{k\\,\\pi}{n}\\right)\\right]\\\\\n=2\\,\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)-2\\,\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right)\\cos\\left(\\frac{k\\,\\pi}{n}\\right)\\\\\n=\\left[2-2\\cos\\left(\\frac{k\\,\\pi}{n}\\right)\\right]\\sin\\left(\\frac{j\\,k\\,\\pi}{n}\\right).\n\\end{align*}\n因此，$v^{(k)}$ 确实是一个特征向量，其对应的 $T$ 的特征值为\n$$\n\\lambda_{k}(T)=2-2\\cos\\left(\\frac{k\\,\\pi}{n}\\right)=4\\,\\sin^{2}\\left(\\frac{k\\,\\pi}{2\\,n}\\right),\\quad k=1,2,\\dots,n-1.\n$$\n由于 $A=\\frac{EA}{h}\\,T$，矩阵 $A$ 的特征值被因子 $\\frac{EA}{h}$ 缩放：\n$$\n\\lambda_{k}(A)=\\frac{EA}{h}\\,\\lambda_{k}(T)=\\frac{EA}{h}\\,4\\,\\sin^{2}\\left(\\frac{k\\,\\pi}{2\\,n}\\right),\\quad k=1,2,\\dots,n-1.\n$$\n对于对称正定矩阵，其在欧几里得 ($2$-)范数下的谱条件数为\n$$\n\\kappa_{2}(A)=\\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)}.\n$$\n最小特征值在 $k=1$ 处取得，最大特征值在 $k=n-1$ 处取得。使用三角恒等式 $\\sin\\left(\\frac{(n-1)\\,\\pi}{2\\,n}\\right)=\\sin\\left(\\frac{\\pi}{2}-\\frac{\\pi}{2\\,n}\\right)=\\cos\\left(\\frac{\\pi}{2\\,n}\\right)$，我们得到\n\\begin{align*}\n\\lambda_{\\min}(A)=\\frac{EA}{h}\\,4\\,\\sin^{2}\\left(\\frac{\\pi}{2\\,n}\\right),\\\\\n\\lambda_{\\max}(A)=\\frac{EA}{h}\\,4\\,\\sin^{2}\\left(\\frac{(n-1)\\,\\pi}{2\\,n}\\right)=\\frac{EA}{h}\\,4\\,\\cos^{2}\\left(\\frac{\\pi}{2\\,n}\\right).\n\\end{align*}\n因此\n\\begin{align*}\n\\kappa_{2}(A)\n=\\frac{\\frac{EA}{h}\\,4\\,\\cos^{2}\\left(\\frac{\\pi}{2\\,n}\\right)}{\\frac{EA}{h}\\,4\\,\\sin^{2}\\left(\\frac{\\pi}{2\\,n}\\right)}\n=\\frac{\\cos^{2}\\left(\\frac{\\pi}{2\\,n}\\right)}{\\sin^{2}\\left(\\frac{\\pi}{2\\,n}\\right)}\n=\\cot^{2}\\left(\\frac{\\pi}{2n}\\right).\n\\end{align*}\n这是一个用 $n$ 表示的精确闭式表达式。对于较大的 $n$，使用小角度近似 $\\sin\\left(\\frac{\\pi}{2n}\\right)\\approx\\frac{\\pi}{2n}$ 和 $\\cos\\left(\\frac{\\pi}{2n}\\right)\\approx 1$ 可得到渐近估计\n$$\n\\kappa_{2}(A)\\sim\\left(\\frac{2n}{\\pi}\\right)^{2},\n$$\n这表明条件数随 $n$ 呈二次方增长。这种增长解释了在加密网格上，诸如 Conjugate Gradient (CG) 方法等迭代求解器的收敛率恶化的原因，并促使人们使用预处理技术（例如，Jacobi 缩放、不完全 Cholesky 分解或多重网格方法），这些技术旨在使特征值聚集，并将 $\\kappa_{2}$ 减小至与网格无关的值。", "answer": "$$\\boxed{\\cot^2\\left(\\frac{\\pi}{2n}\\right)}$$", "id": "3590176"}, {"introduction": "简单的预条件子在面对具有挑战性的物理问题时往往会失效，例如在岩土力学中普遍存在的各向异性介质。本练习利用局部傅里叶分析（Local Fourier Analysis, LFA）这一强大工具，精确地揭示了为何标准的点式雅可比（point-Jacobi）迭代无法有效光滑与弱耦合方向相关的高频误差[@problem_id:3552374]。在此基础上，本练习将指导你构建一个性能稳健的线松弛光滑子，从而深刻理解根据问题物理特性“量体裁衣”设计预条件子的核心思想。", "problem": "考虑层状地质材料中的稳态各向异性扩散，其主渗透率与 Cartesian 坐标轴对齐，由算子 $-\\nabla \\cdot ( \\mathbf{K} \\nabla u )$ 建模，其中 $\\mathbf{K} = \\operatorname{diag}(K_x, K_y)$。该问题定义在一个矩形域上，并用两个方向上间距均为 $h$ 的均匀网格进行离散。假设采用周期性边界条件以便进行局部 Fourier 分析 (LFA)。设 $K_x = 1$ 且 $K_y = \\epsilon$，$0  \\epsilon \\ll 1$，表示各向异性比 $\\kappa = K_x/K_y = 1/\\epsilon$。使用标准的五点有限差分离散，作用于网格函数 $u_{i,j}$ 的离散算子具有以下形式\n$$\n(Au)_{i,j} = \\frac{1}{h^2}\\Big( 2(1+\\epsilon) u_{i,j} - u_{i-1,j} - u_{i+1,j} - \\epsilon u_{i,j-1} - \\epsilon u_{i,j+1} \\Big).\n$$\n您将分析高频误差分量的光滑效果，并设计一个有效的行光滑子。\n\n任务：\n1) 从点-Jacobi 迭代的定义 $u^{(k+1)} = u^{(k)} + D^{-1}(f - Au^{(k)})$ 出发，其中 $D = \\operatorname{diag}(A)$，通过将 $I - D^{-1}A$ 应用于一个 Fourier 模态 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$，推导误差传播符号 $\\tilde{S}_J(\\theta_x,\\theta_y)$。然后计算波数为 $(\\theta_x,\\theta_y) = (0,\\pi)$ 的高频模态的放大因子。根据您推导的表达式，解释其在 $\\epsilon \\to 0$ 时的行为，并说明点-Jacobi方法是否能充分光滑此模态。\n\n2) 按如下方式构造一个 $x$-行对称 Gauss–Seidel (GS) 光滑子：对于每一行 $j$，精确求解由 $x$-方向耦合定义的三对角系统，并在 $y$ 方向上向前扫描（使用新更新的行 $j-1$），然后在 $y$ 方向上向后扫描（使用新更新的行 $j+1$）。从离散方程的块形式出发，推导一个通用 Fourier 模态 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$ 在一次完整的对称行-GS扫描后的 LFA 误差放大因子。然后计算各向异性比为 $\\kappa = 10^3$（即 $\\epsilon = 10^{-3}$）时，相同高频模态 $(\\theta_x,\\theta_y) = (0,\\pi)$ 的放大因子大小。\n\n给出此放大因子大小的精确值；不要求四舍五入，也不包括单位。", "solution": "该问题提法合理且有科学依据，可以进行完整分析。我们依次处理这两个任务。\n\n第1部分：点-Jacobi 光滑子的分析\n\n线性系统 $Au = f$ 的点-Jacobi 迭代由 $u^{(k+1)} = u^{(k)} + D^{-1}(f - Au^{(k)})$ 给出，其中 $D$ 是矩阵 $A$ 的对角部分。误差 $e^{(k)} = u - u^{(k)}$ 根据方程 $e^{(k+1)} = (I - D^{-1}A) e^{(k)}$ 传播。矩阵 $S_J = I - D^{-1}A$ 是点-Jacobi 方法的误差传播矩阵。为了进行局部 Fourier 分析 (LFA)，我们分析此算子对单个 Fourier 模态 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$ 的影响，其中 $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$ 是波数。\n\n离散算子 $A$ 由下式给出\n$$\n(Au)_{i,j} = \\frac{1}{h^2}\\Big( 2(1+\\epsilon) u_{i,j} - u_{i-1,j} - u_{i+1,j} - \\epsilon u_{i,j-1} - \\epsilon u_{i,j+1} \\Big).\n$$\n将 $A$ 应用于 Fourier 模态 $e_{i,j}$ 得到：\n$$\n(Ae)_{i,j} = \\frac{1}{h^2} \\Big( 2(1+\\epsilon) - \\exp(-i\\theta_x) - \\exp(i\\theta_x) - \\epsilon\\exp(-i\\theta_y) - \\epsilon\\exp(i\\theta_y) \\Big) e_{i,j}\n$$\n使用 Euler 公式 $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$，我们找到了算子 $A$ 的符号（特征值）$\\tilde{A}(\\theta_x, \\theta_y)$：\n$$\n\\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\Big( 2(1+\\epsilon) - 2\\cos(\\theta_x) - 2\\epsilon\\cos(\\theta_y) \\Big) = \\frac{2}{h^2} \\Big( (1-\\cos(\\theta_x)) + \\epsilon(1-\\cos(\\theta_y)) \\Big).\n$$\n$A$ 的对角部分（记为 $D$）是与 $u_{i,j}$ 相乘的项：$(Du)_{i,j} = \\frac{2(1+\\epsilon)}{h^2} u_{i,j}$。因此 $D$ 的符号是一个常数：\n$$\n\\tilde{D} = \\frac{2(1+\\epsilon)}{h^2}.\n$$\n点-Jacobi 的误差传播符号 $\\tilde{S}_J(\\theta_x, \\theta_y)$ 是 $I - D^{-1}A$ 的符号：\n$$\n\\tilde{S}_J(\\theta_x, \\theta_y) = 1 - \\frac{\\tilde{A}(\\theta_x, \\theta_y)}{\\tilde{D}} = 1 - \\frac{\\frac{2}{h^2} \\Big( (1+\\epsilon) - \\cos(\\theta_x) - \\epsilon\\cos(\\theta_y) \\Big)}{\\frac{2(1+\\epsilon)}{h^2}}.\n$$\n化简表达式，我们得到：\n$$\n\\tilde{S}_J(\\theta_x, \\theta_y) = \\frac{(1+\\epsilon) - \\Big( (1+\\epsilon) - \\cos(\\theta_x) - \\epsilon\\cos(\\theta_y) \\Big)}{1+\\epsilon} = \\frac{\\cos(\\theta_x) + \\epsilon\\cos(\\theta_y)}{1+\\epsilon}.\n$$\n现在，我们计算波数为 $(\\theta_x, \\theta_y) = (0, \\pi)$ 的高频模态的放大因子。此模态在 $x$ 方向上是光滑的，在 $y$ 方向上是高振荡的。\n$$\n\\tilde{S}_J(0, \\pi) = \\frac{\\cos(0) + \\epsilon\\cos(\\pi)}{1+\\epsilon} = \\frac{1 - \\epsilon}{1+\\epsilon}.\n$$\n为了理解在强各向异性极限下（$\\epsilon \\to 0$）光滑子的有效性，我们考察该放大因子的行为：\n$$\n\\lim_{\\epsilon \\to 0} \\tilde{S}_J(0, \\pi) = \\lim_{\\epsilon \\to 0} \\frac{1 - \\epsilon}{1+\\epsilon} = 1.\n$$\n放大因子为 $1$ 表示与此模态对应的误差分量根本没有被衰减。因此，点-Jacobi 对于此问题不是一个足够好的光滑子，因为对于在弱耦合方向上振荡的模态，其性能会灾难性地下降。\n\n第2部分：$x$-行对称 Gauss-Seidel 光滑子的分析\n\n对于 $x$-行光滑子，我们按行对未知数进行分组。离散方程可以写成块三对角形式 $A u = f$。矩阵 $A$ 可以分解为 $A = L+D+U$，其中 $D$ 是块对角矩阵，其块表示行内耦合，而 $L$ 和 $U$ 是严格的块下三角和块上三角矩阵，表示行间耦合。\n$$ A = \\frac{1}{h^2} \\begin{pmatrix} T_x   -\\epsilon I   \\\\ -\\epsilon I  T_x  -\\epsilon I  \\\\   \\ddots   \\ddots   \\ddots \\\\    -\\epsilon I  T_x \\end{pmatrix} $$\n在此，$T_x$ 是单行的三对角矩阵，其元素为 $(-1, 2(1+\\epsilon), -1)$。算子 $h^2 D$ 的符号是 $T_x$ 的符号，我们记为 $\\tilde{T}_x(\\theta_x)$：\n$$\n\\tilde{T}_x(\\theta_x) = 2(1+\\epsilon) - 2\\cos(\\theta_x) = 4\\sin^2(\\frac{\\theta_x}{2}) + 2\\epsilon.\n$$\n块算子 $h^2L$ 和 $h^2U$ 的 LFA 符号记为 $\\tilde{L}'(\\theta_y)$ 和 $\\tilde{U}'(\\theta_y)$：\n$$\n\\tilde{L}'(\\theta_y) = -\\epsilon\\exp(-i\\theta_y), \\quad \\tilde{U}'(\\theta_y) = -\\epsilon\\exp(i\\theta_y).\n$$\n对称 Gauss-Seidel (SGS) 光滑子包含一次前向扫描，然后是一次后向扫描。误差传播算子是 $S_{SGS} = (D+U)^{-1}L(D+L)^{-1}U$。相应的 LFA 符号是：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = (\\tilde{D}' + \\tilde{U}')^{-1} \\tilde{L}' (\\tilde{D}' + \\tilde{L}')^{-1} \\tilde{U}'.\n$$\n代入块算子的符号（按 $h^2$ 缩放）：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{1}{\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(i\\theta_y)} \\cdot \\big(-\\epsilon\\exp(-i\\theta_y)\\big) \\cdot \\frac{1}{\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(-i\\theta_y)} \\cdot \\big(-\\epsilon\\exp(i\\theta_y)\\big).\n$$\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{\\big(\\tilde{T}_x(\\theta_x)-\\epsilon\\exp(i\\theta_y)\\big)\\big(\\tilde{T}_x(\\theta_x)-\\epsilon\\exp(-i\\theta_y)\\big)}.\n$$\n分母是一个复数与其共轭的乘积，其结果为其模的平方：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{|\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(i\\theta_y)|^2} = \\frac{\\epsilon^2}{(\\tilde{T}_x(\\theta_x) - \\epsilon\\cos(\\theta_y))^2 + (-\\epsilon\\sin(\\theta_y))^2}.\n$$\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{\\tilde{T}_x(\\theta_x)^2 - 2\\epsilon\\tilde{T}_x(\\theta_x)\\cos(\\theta_y) + \\epsilon^2}.\n$$\n我们需要计算模态 $(\\theta_x, \\theta_y) = (0, \\pi)$ 的这个因子的大小，此时 $\\kappa = 10^3$，这意味着 $\\epsilon = 10^{-3}$。首先，我们在指定的波数处计算这些符号。\n对于 $\\theta_x = 0$：\n$$\n\\tilde{T}_x(0) = 4\\sin^2(0) + 2\\epsilon = 2\\epsilon.\n$$\n对于 $\\theta_y = \\pi$：\n$$\n\\cos(\\pi) = -1.\n$$\n将这些代入 $\\tilde{S}_{SGS}$ 的表达式中：\n$$\n\\tilde{S}_{SGS}(0, \\pi) = \\frac{\\epsilon^2}{(2\\epsilon)^2 - 2\\epsilon(2\\epsilon)(-1) + \\epsilon^2} = \\frac{\\epsilon^2}{4\\epsilon^2 + 4\\epsilon^2 + \\epsilon^2} = \\frac{\\epsilon^2}{9\\epsilon^2} = \\frac{1}{9}.\n$$\n这个放大因子是一个与 $\\epsilon$（因而也与 $\\kappa$）无关的实正常数。因此，模态 $(0, \\pi)$ 的放大因子的大小是 $|\\frac{1}{9}| = \\frac{1}{9}$。$\\kappa = 10^3$ 的具体值不影响此结果。", "answer": "$$\\boxed{\\frac{1}{9}}$$", "id": "3552374"}, {"introduction": "多重网格方法是求解大规模科学计算问题最高效的迭代技术之一，其性能的关键在于粗网格校正能否有效消除“困难”的误差模式。本练习聚焦于一个模拟层状介质的简化模型，该模型中存在导致收敛缓慢的弱连接界面[@problem_id:3552389]。通过构造一个包含物理洞察（如刚体平动模式）的粗空间，你将学习如何设计一个能够高效处理这些近零空间模态的代数两网格方法，确保求解器在面对强非均匀性问题时依然保持稳健。", "problem": "考虑一个一维分层弹性杆，其模型为一个弹簧链，其中有两个较硬的层通过一个界面弱连接。设有 $4$ 个节点位移未知量，用向量 $u \\in \\mathbb{R}^{4}$ 表示。该杆在两个外部节点处通过刚度为 $1$ 的弹簧固定到地面，每个硬层内部的弹簧刚度为 $1$，连接两层的界面弹簧刚度为 $\\epsilon$，其中 $\\epsilon \\in (0,\\infty)$。根据线性弹性原理以及有限元或有限差分刚度集成，全局刚度矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$ 的形式为\n$$\nK \\;=\\;\n\\begin{pmatrix}\n2   -1   0   0 \\\\\n-1   1+\\epsilon   -\\epsilon   0 \\\\\n0   -\\epsilon   1+\\epsilon   -1 \\\\\n0   0   -1   2\n\\end{pmatrix}.\n$$\n你需要使用一种双网格预处理理查德森迭代来求解线性系统 $K u = f$，该迭代使用：\n- 一个松弛参数为 $\\omega$ 的单次后平滑理查德森步，以及\n- 一个由物理启发的粗空间构建的精确粗化校正，该粗空间由以下两个向量张成：刚体平移模式 $z_{1} = (1,1,1,1)^{\\top}$ 和逐层平均差异 $z_{2} = (1,1,-1,-1)^{\\top}$。\n\n令 $Z = [z_{1}\\; z_{2}] \\in \\mathbb{R}^{4 \\times 2}$。单次扫描的双网格误差传播算子为\n$$\nE(\\omega) \\;=\\; \\bigl(I - Z (Z^{\\top} K Z)^{-1} Z^{\\top} K \\bigr)\\, \\bigl(I - \\omega K\\bigr).\n$$\n从以下基本事实出发：\n- $K$ 是对称正定的，因此其谱为实数且为正，\n- 粗化校正 $I - Z (Z^{\\top} K Z)^{-1} Z^{\\top} K$ 是到 $\\operatorname{span}(Z)$ 的 K-正交补空间上的 K-正交投影算子，以及\n- 在特征值位于区间 $[\\lambda_{\\min},\\lambda_{\\max}]$ 的子空间上，最优理查德森参数为 $\\omega_{\\mathrm{opt}} = \\tfrac{2}{\\lambda_{\\min} + \\lambda_{\\max}}$，相应的谱半径为 $\\rho_{\\mathrm{opt}} = \\tfrac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$，\n\n从第一性原理出发，推导最优双网格渐进收敛因子的闭式表达式（用 $\\epsilon$ 表示），即算子 $E(\\omega_{\\mathrm{opt}})$ 限制在 $\\operatorname{span}(Z)$ 的 K-正交补空间上的谱半径。\n\n将您的最终答案表示为关于 $\\epsilon$ 的单一简化解析表达式。不包含单位。无需进行数值舍入。", "solution": "用户希望找到给定线性系统的最优双网格渐进收敛因子。\n\n### 第1步：问题验证\n\n已知条件如下：\n-   刚度矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$：\n    $$\n    K \\;=\\;\n    \\begin{pmatrix}\n    2   -1   0   0 \\\\\n    -1   1+\\epsilon   -\\epsilon   0 \\\\\n    0   -\\epsilon   1+\\epsilon   -1 \\\\\n    0   0   -1   2\n    \\end{pmatrix}\n    $$\n-   参数 $\\epsilon \\in (0,\\infty)$。\n-   粗空间 $\\operatorname{span}(Z)$，其中 $Z = [z_{1}\\; z_{2}]$，$z_{1} = (1,1,1,1)^{\\top}$ 且 $z_{2} = (1,1,-1,-1)^{\\top}$。\n-   双网格误差传播算子为 $E(\\omega) = \\bigl(I - Z (Z^{\\top} K Z)^{-1} Z^{\\top} K \\bigr)\\, \\bigl(I - \\omega K\\bigr)$。\n-   项 $P_Z = Z (Z^{\\top} K Z)^{-1} Z^{\\top} K$ 是到 $\\operatorname{span}(Z)$ 上的 K-正交投影算子。\n-   在特征值位于 $[\\lambda_{\\min},\\lambda_{\\max}]$ 的子空间上的最优理查德森松弛参数为 $\\omega_{\\mathrm{opt}} = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}$。\n-   相应的最优谱半径为 $\\rho_{\\mathrm{opt}} = \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$。\n-   矩阵 K 是对称正定 (SPD) 的。这可以通过验证对于 $\\epsilon > 0$ 时所有顺序主子式均为正来确认：$\\det(K_1)=2$、$\\det(K_2)=1+2\\epsilon$、$\\det(K_3)=1+3\\epsilon$ 以及 $\\det(K_4)=1+4\\epsilon$。\n-   问题是要求解最优渐进收敛因子，也就是算子 $E(\\omega_{\\mathrm{opt}})$ 限制在 $\\operatorname{span}(Z)$ 的 K-正交补空间上的谱半径。\n\n该问题在数值线性代数和多重网格理论方面有科学依据，是适定的，并且陈述客观。未检测到任何缺陷。该问题有效。\n\n### 第2步：求解推导\n\n渐进收敛因子是误差传播算子 $E(\\omega)$ 的谱半径。粗网格校正是精确的，意味着粗空间 $V_c = \\operatorname{span}(Z)$ 中的任何误差分量都会在一步内被消除。这是因为如果 $v \\in V_c$，那么 $v$ 位于投影算子 $I - P_Z$ 的零空间中，所以 $E(\\omega)v = 0$。\n\n因此，收敛性由 $E(\\omega)$ 在 $V_c$ 的 K-正交补空间（我们称之为细空间 $V_f$）上的作用决定。一个误差向量 $e \\in V_f$ 被变换为 $e_{\\text{new}} = (I-P_Z)(I-\\omega K)e$。由于 $e \\in V_f$，我们有 $(I-P_Z)e=e$。限制在 $V_f$ 上的算子是 $E_f(\\omega) = (I-P_Z)(I - \\omega K)|_{V_f}$。\n\n问题给出了理查德森平滑迭代的最优收敛因子公式。这意味着我们必须找到控制细空间上迭代的算子的极值特征值。对于使用理查德森平滑的双网格方法，这些对应于刚度算子 $K$ 限制在细空间 $V_f$ 上的最小和最大特征值，在欧几里得范数下度量。这些我们称之为 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 的特征值，是瑞利商 $\\frac{v^{\\top}Kv}{v^{\\top}v}$ 对于所有非零 $v \\in V_f$ 的极值。\n\n首先，我们来刻画细空间 $V_f$。一个向量 $v \\in \\mathbb{R}^4$ 属于 $V_f$ 如果它与 $V_c$ 的基向量是 K-正交的，即 $v^{\\top}Kz_1 = 0$ 且 $v^{\\top}Kz_2 = 0$。\n\n我们来计算 $Kz_1$ 和 $Kz_2$：\n$$\nKz_1 = \\begin{pmatrix} 2   -1   0   0 \\\\ -1   1+\\epsilon   -\\epsilon   0 \\\\ 0   -\\epsilon   1+\\epsilon   -1 \\\\ 0   0   -1   2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2-1 \\\\ -1+1+\\epsilon-\\epsilon \\\\ -\\epsilon+1+\\epsilon-1 \\\\ -1+2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\nKz_2 = \\begin{pmatrix} 2   -1   0   0 \\\\ -1   1+\\epsilon   -\\epsilon   0 \\\\ 0   -\\epsilon   1+\\epsilon   -1 \\\\ 0   0   -1   2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2-1 \\\\ -1+1+\\epsilon+\\epsilon \\\\ \\epsilon-(1+\\epsilon)+1 \\\\ -(-1)+2(-1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2\\epsilon \\\\ -2\\epsilon \\\\ -1 \\end{pmatrix}\n$$\n对于一个向量 $v = (v_1, v_2, v_3, v_4)^{\\top}$，其属于 $V_f$ 的条件是：\n1.  $v^{\\top}Kz_1 = v_1 + v_4 = 0 \\implies v_4 = -v_1$。\n2.  $v^{\\top}Kz_2 = v_1 + 2\\epsilon v_2 - 2\\epsilon v_3 - v_4 = 0$。\n\n将 $v_4 = -v_1$ 代入第二个方程得到 $v_1 + 2\\epsilon v_2 - 2\\epsilon v_3 - (-v_1) = 2v_1 + 2\\epsilon(v_2-v_3) = 0$，简化后得到 $v_1 = -\\epsilon(v_2-v_3)$。\n\n$V_f$ 是一个二维子空间。我们可以通过为 $v_2$ 和 $v_3$ 选择线性无关的值来找到一组基：\n-   令 $v_2=1, v_3=0$。则 $v_1 = -\\epsilon$ 且 $v_4 = \\epsilon$。这给出了基向量 $w_1 = (-\\epsilon, 1, 0, \\epsilon)^{\\top}$。\n-   令 $v_2=0, v_3=1$。则 $v_1 = \\epsilon$ 且 $v_4 = -\\epsilon$。这给出了基向量 $w_2 = (\\epsilon, 0, 1, -\\epsilon)^{\\top}$。\n\n令 $W = [w_1 \\; w_2]$ 是一个矩阵，其列构成了 $V_f$ 的一组基。任何向量 $v \\in V_f$ 都可以写成 $v = Wc$ 的形式，其中 $c \\in \\mathbb{R}^2$ 是某个坐标向量。瑞利商变为：\n$$ \\lambda = \\frac{(Wc)^{\\top}K(Wc)}{(Wc)^{\\top}(Wc)} = \\frac{c^{\\top}(W^{\\top}KW)c}{c^{\\top}(W^{\\top}W)c} $$\n极值 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 是广义特征值问题 $(W^{\\top}KW)c = \\lambda (W^{\\top}W)c$ 的特征值。\n\n我们计算矩阵 $W^{\\top}W$ 和 $W^{\\top}KW$：\n$$ w_1^{\\top}w_1 = (-\\epsilon)^2+1^2+0^2+\\epsilon^2 = 1+2\\epsilon^2 $$\n$$ w_2^{\\top}w_2 = \\epsilon^2+0^2+1^2+(-\\epsilon)^2 = 1+2\\epsilon^2 $$\n$$ w_1^{\\top}w_2 = (-\\epsilon)(\\epsilon) + (1)(0) + (0)(1) + (\\epsilon)(-\\epsilon) = -2\\epsilon^2 $$\n所以，$W^{\\top}W = \\begin{pmatrix} 1+2\\epsilon^2   -2\\epsilon^2 \\\\ -2\\epsilon^2   1+2\\epsilon^2 \\end{pmatrix}$。\n\n接着，我们计算 $KW$：\n$$ Kw_1 = \\begin{pmatrix} -2\\epsilon-1 \\\\ 1+2\\epsilon \\\\ -2\\epsilon \\\\ 2\\epsilon \\end{pmatrix}, \\quad Kw_2 = \\begin{pmatrix} 2\\epsilon \\\\ -2\\epsilon \\\\ 1+2\\epsilon \\\\ -1-2\\epsilon \\end{pmatrix} $$\n然后我们计算 $W^{\\top}KW$：\n$$ w_1^{\\top}Kw_1 = (-\\epsilon)(-2\\epsilon-1) + (1)(1+2\\epsilon) + (0)(-2\\epsilon) + (\\epsilon)(2\\epsilon) = 2\\epsilon^2+\\epsilon+1+2\\epsilon+2\\epsilon^2 = 4\\epsilon^2+3\\epsilon+1 $$\n$$ w_2^{\\top}Kw_2 = (\\epsilon)(2\\epsilon) + (0)(-2epsilon) + (1)(1+2\\epsilon) + (-\\epsilon)(-1-2\\epsilon) = 2\\epsilon^2+1+2\\epsilon+\\epsilon+2\\epsilon^2 = 4\\epsilon^2+3\\epsilon+1 $$\n$$ w_1^{\\top}Kw_2 = (-\\epsilon)(2\\epsilon) + (1)(-2\\epsilon) + (0)(1+2\\epsilon) + (\\epsilon)(-1-2\\epsilon) = -2\\epsilon^2-2\\epsilon-\\epsilon-2\\epsilon^2 = -4\\epsilon^2-3\\epsilon $$\n因此，$W^{\\top}KW = \\begin{pmatrix} 4\\epsilon^2+3\\epsilon+1   -4\\epsilon^2-3\\epsilon \\\\ -4\\epsilon^2-3\\epsilon   4\\epsilon^2+3\\epsilon+1 \\end{pmatrix}$。\n\n矩阵 $W^{\\top}W$ 和 $W^{\\top}KW$ 具有形式 $\\begin{pmatrix} S   D \\\\ D   S \\end{pmatrix}$。对于矩阵束 $(A,B)$，其中 $A=\\begin{pmatrix} S_A   D_A \\\\ D_A   S_A \\end{pmatrix}$ 且 $B=\\begin{pmatrix} S_B   D_B \\\\ D_B   S_B \\end{pmatrix}$，其特征值为 $\\lambda_1=\\frac{S_A-D_A}{S_B-D_B}$ 和 $\\lambda_2=\\frac{S_A+D_A}{S_B+D_B}$。\n对于 $W^{\\top}KW$：$S_A = 4\\epsilon^2+3\\epsilon+1$，$D_A = -4\\epsilon^2-3\\epsilon$。\n对于 $W^{\\top}W$：$S_B = 1+2\\epsilon^2$，$D_B = -2\\epsilon^2$。\n\n特征值为：\n$$ \\lambda_1 = \\frac{(4\\epsilon^2+3\\epsilon+1) - (-4\\epsilon^2-3\\epsilon)}{(1+2\\epsilon^2) - (-2\\epsilon^2)} = \\frac{8\\epsilon^2+6\\epsilon+1}{1+4\\epsilon^2} $$\n$$ \\lambda_2 = \\frac{(4\\epsilon^2+3\\epsilon+1) + (-4\\epsilon^2-3\\epsilon)}{(1+2\\epsilon^2) + (-2\\epsilon^2)} = \\frac{1}{1} = 1 $$\n由于 $\\epsilon0$，我们有 $4\\epsilon^2+6\\epsilon0$。\n$\\frac{8\\epsilon^2+6\\epsilon+1}{1+4\\epsilon^2} - 1 = \\frac{8\\epsilon^2+6\\epsilon+1 - (1+4\\epsilon^2)}{1+4\\epsilon^2} = \\frac{4\\epsilon^2+6\\epsilon}{1+4\\epsilon^2}  0$。\n所以，$\\lambda_1  \\lambda_2$。这给了我们极值特征值：\n$$ \\lambda_{\\min} = 1 $$\n$$ \\lambda_{\\max} = \\frac{8\\epsilon^2+6\\epsilon+1}{1+4\\epsilon^2} $$\n现在，我们使用给定的最优收敛因子公式：\n$$ \\rho_{\\mathrm{opt}} = \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}} $$\n$$ \\lambda_{\\max} - \\lambda_{\\min} = \\frac{8\\epsilon^2+6\\epsilon+1}{1+4\\epsilon^2} - 1 = \\frac{4\\epsilon^2+6\\epsilon}{1+4\\epsilon^2} $$\n$$ \\lambda_{\\max} + \\lambda_{\\min} = \\frac{8\\epsilon^2+6\\epsilon+1}{1+4\\epsilon^2} + 1 = \\frac{12\\epsilon^2+6\\epsilon+2}{1+4\\epsilon^2} $$\n将这些代入 $\\rho_{\\mathrm{opt}}$ 的公式：\n$$ \\rho_{\\mathrm{opt}} = \\frac{\\frac{4\\epsilon^2+6\\epsilon}{1+4\\epsilon^2}}{\\frac{12\\epsilon^2+6\\epsilon+2}{1+4\\epsilon^2}} = \\frac{4\\epsilon^2+6\\epsilon}{12\\epsilon^2+6\\epsilon+2} $$\n将分子和分母同除以 $2$ 进行简化：\n$$ \\rho_{\\mathrm{opt}} = \\frac{2\\epsilon^2+3\\epsilon}{6\\epsilon^2+3\\epsilon+1} $$\n这就是最优双网格渐进收敛因子的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{2\\epsilon^2+3\\epsilon}{6\\epsilon^2+3\\epsilon+1}}\n$$", "id": "3552389"}]}