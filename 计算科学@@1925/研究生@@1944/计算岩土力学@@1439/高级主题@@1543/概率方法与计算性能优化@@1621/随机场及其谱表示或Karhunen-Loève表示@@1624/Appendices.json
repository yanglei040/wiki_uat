{"hands_on_practices": [{"introduction": "任何随机场模型的建立都始于对其统计特性的表征，例如协方差函数。然而，现实世界的数据总是有限的，这给统计估计带来了挑战。本练习将引导你从第一性原理出发，推导无偏估计量，更重要的是，理解并量化因在有限域上分析数据而产生的系统偏差——这是任何从业者都必须掌握的关键技能。[@problem_id:3554525]", "problem": "考虑一个一维土体，其沿水平坐标 $x$ 占据有限区间 $[0,L]$，其中 $L>0$。令 $Z(x)$ 表示一个标准化的、无量纲的、二阶平稳的零均值高斯随机场，代表一种土壤属性（例如，标准化后的对数转换水力传导系数），其协方差函数 $C(h)=\\mathbb{E}[Z(x)Z(x+h)]$ 仅取决于滞后 $h=|h|$。假设协方差模型为\n$$\nC(h)=\\sigma^{2}\\exp\\!\\left(-\\frac{|h|}{a}\\right),\n$$\n其中 $\\sigma^{2}>0$ 且相关长度 $a>0$。在均匀分布的点 $x_{i}=i\\Delta$（$i=0,1,\\dots,N-1$）处有测量值，其中 $\\Delta=L/(N-1)$ 且 $N\\geq 2$。假设 $N$ 足够大，在指定情况下，求和可以用黎曼积分近似。\n\n要求您从第一性原理出发——即平稳性、协方差和变异函数的定义——推导在有限域 $[0,L]$ 上的无偏经验估计量。然后，分析因忽略有限域重叠而采用的朴素归一化所引入的偏差。具体而言：\n\n1. 对于零均值 $Z(x)$，在滞后 $h=k\\Delta$ 处定义在有限域 $[0,L]$ 上的无偏经验协方差估计量 $\\widehat{C}_{u}(h)$，确保归一化考虑了以 $h$ 分隔的可用数据对的数量。同时，对于零均值 $Z(x)$，定义相应的无偏经验变异函数估计量 $\\widehat{\\gamma}_{u}(h)$，并回顾其定义 $\\gamma(h)=\\frac{1}{2}\\mathbb{E}\\big[(Z(x+h)-Z(x))^{2}\\big]$。\n\n2. 考虑以下朴素协方差估计量，它通过整个域长度 $L$ 进行归一化，而不是通过滞后 $h$ 处的可用重叠长度 $L-h$：\n$$\n\\widetilde{C}(h)=\\frac{1}{L}\\int_{0}^{L-h}Z(x)Z(x+h)\\,\\mathrm{d}x,\n$$\n该估计量可解释为将离散估计量除以 $N$ 而不是 $N-k$ 后的连续极限。使用协方差和平稳性的定义，在 $[0,L]$ 上推导 $\\mathbb{E}[\\widetilde{C}(h)]$，然后计算上述指数协方差模型的偏差 $b(h,L)=\\mathbb{E}[\\widetilde{C}(h)]-C(h)$。\n\n3. 将您的推导与谱/Karhunen-Loève 观点联系起来，不使用简化公式，解释为什么有限域截断的作用类似于一个窗口，其自相关函数控制着协方差估计中的重叠因子。您可以参考 Karhunen–Loève 展开（KLE）和谱表示底层的加窗思想，但您的推导必须基于所述的核心定义。\n\n将最终偏差 $b(h,L)$ 表示为包含 $h$、$L$、$\\sigma^{2}$ 和 $a$ 的单个封闭形式解析表达式。无需四舍五入。由于 $Z(x)$ 是无量纲的，最终表达式中无需报告物理单位。", "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n-   随机场域：一维区间 $[0,L]$，其中 $L>0$。\n-   随机场：$Z(x)$ 是一个标准化的、无量纲的、二阶平稳的、零均值的高斯随机场。\n-   协方差函数：$C(h)=\\mathbb{E}[Z(x)Z(x+h)] = \\sigma^{2}\\exp(-|h|/a)$，其中 $\\sigma^{2}>0$ 是方差，$a>0$ 是相关长度。\n-   离散采样：在 $x_{i}=i\\Delta$（$i=0,1,\\dots,N-1$）处进行测量，其中 $\\Delta=L/(N-1)$ 且 $N\\geq 2$。对于大的 $N$，求和可以用积分近似。\n-   变异函数定义：$\\gamma(h)=\\frac{1}{2}\\mathbb{E}\\big[(Z(x+h)-Z(x))^{2}\\big]$。\n-   朴素协方差估计量：$\\widetilde{C}(h)=\\frac{1}{L}\\int_{0}^{L-h}Z(x)Z(x+h)\\,\\mathrm{d}x$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于随机场理论，这是地质统计学和计算岩土力学中的一个核心课题。使用具有指数协方差函数的平稳高斯场是一个标准且被充分理解的模型。任务涉及推导标准的统计估计量，并分析一个常用但有缺陷的估计量的偏差，这是信号处理和统计学中的一个基本练习。该问题是适定的，为获得唯一解提供了所有必要的定义和约束。语言是客观和数学化的。诸如用积分近似求和等假设都已明确说明。因此，该问题是有效的。\n\n### 步骤 3：进行求解\n\n#### 第 1 部分：无偏经验估计量\n\n对于在点 $x_i = i\\Delta$（$i=0, \\dots, N-1$）处的一组离散测量值 $Z(x_i)$，我们推导在滞后 $h=k\\Delta$（其中 $k$ 为整数）处的协方差和变异函数的无偏估计量。\n\n无偏经验协方差估计量 $\\widehat{C}_u(h)$ 是通过对所有以滞后 $h=k\\Delta$ 分隔的可用测量数据对的乘积进行平均来构建的。可用的数据对为 $(Z(x_i), Z(x_{i+k}))$，其中 $i=0, 1, \\dots, N-1-k$。此类数据对的总数为 $N-k$。该估计量为：\n$$\n\\widehat{C}_u(k\\Delta) = \\frac{1}{N-k} \\sum_{i=0}^{N-1-k} Z(x_i) Z(x_{i+k})\n$$\n为了验证其无偏性，我们计算其期望。根据期望的线性性质：\n$$\n\\mathbb{E}[\\widehat{C}_u(k\\Delta)] = \\frac{1}{N-k} \\sum_{i=0}^{N-1-k} \\mathbb{E}[Z(x_i) Z(x_{i+k})]\n$$\n由于二阶平稳性，乘积的期望仅取决于滞后：$\\mathbb{E}[Z(x_i) Z(x_{i+k})] = C(x_{i+k} - x_i) = C(k\\Delta)$。因此：\n$$\n\\mathbb{E}[\\widehat{C}_u(k\\Delta)] = \\frac{1}{N-k} \\sum_{i=0}^{N-1-k} C(k\\Delta) = \\frac{(N-k)C(k\\Delta)}{N-k} = C(k\\Delta)\n$$\n这证实了 $\\widehat{C}_u(k\\Delta)$ 是真实协方差 $C(k\\Delta)$ 的一个无偏估计量。\n\n无偏经验变异函数估计量 $\\widehat{\\gamma}_u(h)$ 的构建方式类似，即对所有可用数据对的差的平方进行平均。对于滞后 $h=k\\Delta$，使用相同的 $N-k$ 对数据：\n$$\n\\widehat{\\gamma}_u(k\\Delta) = \\frac{1}{2(N-k)} \\sum_{i=0}^{N-1-k} (Z(x_{i+k}) - Z(x_i))^2\n$$\n其期望为：\n$$\n\\mathbb{E}[\\widehat{\\gamma}_u(k\\Delta)] = \\frac{1}{2(N-k)} \\sum_{i=0}^{N-1-k} \\mathbb{E}[(Z(x_{i+k}) - Z(x_i))^2]\n$$\n根据变异函数的定义，$\\mathbb{E}[(Z(x+h)-Z(x))^2] = 2\\gamma(h)$。因此：\n$$\n\\mathbb{E}[\\widehat{\\gamma}_u(k\\Delta)] = \\frac{1}{2(N-k)} \\sum_{i=0}^{N-1-k} 2\\gamma(k\\Delta) = \\frac{(N-k)2\\gamma(k\\Delta)}{2(N-k)} = \\gamma(k\\Delta)\n$$\n这证实了 $\\widehat{\\gamma}_u(k\\Delta)$ 是真实变异函数 $\\gamma(k\\Delta)$ 的一个无偏估计量。对于一个零均值、二阶平稳过程，协方差和变异函数之间的关系为 $\\gamma(h) = C(0) - C(h)$。\n\n#### 第 2 部分：朴素估计量的偏差\n\n朴素协方差估计量的连续形式如下：\n$$\n\\widetilde{C}(h)=\\frac{1}{L}\\int_{0}^{L-h}Z(x)Z(x+h)\\,\\mathrm{d}x, \\quad \\text{for } h \\in [0,L)\n$$\n为了求其偏差，我们首先计算其期望。利用期望的线性性质和 Fubini 定理交换期望和积分的顺序：\n$$\n\\mathbb{E}[\\widetilde{C}(h)] = \\mathbb{E}\\left[\\frac{1}{L}\\int_{0}^{L-h}Z(x)Z(x+h)\\,\\mathrm{d}x\\right] = \\frac{1}{L}\\int_{0}^{L-h}\\mathbb{E}[Z(x)Z(x+h)]\\,\\mathrm{d}x\n$$\n由于 $Z(x)$ 是二阶平稳的，乘积的期望值是协方差函数 $C(h)$，它与位置 $x$ 无关。\n$$\n\\mathbb{E}[\\widetilde{C}(h)] = \\frac{1}{L}\\int_{0}^{L-h}C(h)\\,\\mathrm{d}x = \\frac{C(h)}{L} \\int_{0}^{L-h} 1 \\,\\mathrm{d}x = \\frac{C(h)}{L} (L-h)\n$$\n因此，朴素估计量的期望值为：\n$$\n\\mathbb{E}[\\widetilde{C}(h)] = \\left(1 - \\frac{h}{L}\\right) C(h)\n$$\n偏差 $b(h,L)$ 是估计量的期望值与被估计参数的真实值之间的差：\n$$\nb(h,L) = \\mathbb{E}[\\widetilde{C}(h)] - C(h) = \\left(1 - \\frac{h}{L}\\right)C(h) - C(h) = \\left(1 - \\frac{h}{L} - 1\\right)C(h) = -\\frac{h}{L} C(h)\n$$\n现在，我们代入给定的指数协方差模型 $C(h)=\\sigma^{2}\\exp(-|h|/a)$。对于域内的滞后 $h \\geq 0$，有 $|h|=h$。\n$$\nb(h,L) = -\\frac{h}{L} \\sigma^{2}\\exp\\left(-\\frac{h}{a}\\right)\n$$\n这是偏差的最终表达式。该值为负，表明朴素估计量系统性地低估了真实协方差，且随着滞后 $h$ 接近域大小 $L$，低估的程度会加剧。\n\n#### 第 3 部分：概念性解释及与谱观点的联系\n\n第 2 部分中计算的偏差源于在有限域上观测随机场。这种截断可以通过将无限域场 $Z(x)$ 乘以一个矩形窗函数 $W(x)$ 来建模，定义如下：\n$$\nW(x) = \\begin{cases} 1  \\text{if } x \\in [0,L] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n观测到的过程是 $Z_W(x) = Z(x)W(x)$。朴素估计量中的积分可以用这个在整个实线 $\\mathbb{R}$ 上的加窗过程来表示。注意，乘积 $W(x)W(x+h)$ 仅当 $x \\in [0,L]$ 和 $x+h \\in [0,L]$ 同时成立时才非零（等于 $1$）。对于 $h>0$，这对应于区间 $x \\in [0, L-h]$。因此：\n$$\n\\int_{0}^{L-h} Z(x)Z(x+h)\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} Z(x)Z(x+h)W(x)W(x+h)\\,\\mathrm{d}x\n$$\n对该积分取期望可得：\n$$\n\\mathbb{E}\\left[\\int_{-\\infty}^{\\infty} Z(x)Z(x+h)W(x)W(x+h)\\,\\mathrm{d}x\\right] = \\int_{-\\infty}^{\\infty} \\mathbb{E}[Z(x)Z(x+h)]W(x)W(x+h)\\,\\mathrm{d}x\n$$\n由于平稳性，$\\mathbb{E}[Z(x)Z(x+h)] = C(h)$，因此上式变为：\n$$\nC(h) \\int_{-\\infty}^{\\infty} W(x)W(x+h)\\,\\mathrm{d}x\n$$\n积分 $\\int_{-\\infty}^{\\infty} W(x)W(x+h)\\,\\mathrm{d}x$ 是矩形窗函数 $W(x)$ 在滞后 $h$ 处的自相关。对于 $h \\in [0,L]$，其值为重叠区域的长度，即 $L-h$。\n\n因此，$\\widetilde{C}(h)$ 的分子的期望为 $C(h)(L-h)$。朴素估计量 $\\widetilde{C}(h)$ 将此结果除以 $L$，得到 $\\mathbb{E}[\\widetilde{C}(h)] = \\frac{L-h}{L}C(h)$。因子 $(L-h)$ 是重叠因子，它恰好是窗函数的自相关。偏差的产生是因为朴素估计量的归一化因子 $L$ 是恒定的，而用于估计滞后 $h$ 处协方差的可用信息量随着 $h$ 的增加而减少，且与重叠长度 $L-h$ 成正比。相比之下，无偏估计量通过该重叠因子进行正确归一化（即，在连续情况下为 $L-h$，在离散情况下为 $N-k$ 对）。\n\n从谱的观点来看，Wiener-Khinchin 定理表明协方差函数是功率谱密度的傅里叶变换。截断信号（即在空间域中乘以一个窗函数）对应于在频率域中将其功率谱与窗函数的光谱进行卷积。对于矩形窗，这会引入频谱泄漏，从而扭曲估计的谱。协方差估计中的偏差是这种谱失真在空间域的表现。Karhunen-Loève 展开为有限区间上的过程提供了最优表示，其基函数（特征函数）内在地适应于有限域和协方差结构。像朴素估计量那样，试图在不考虑边界效应的情况下从有限域样本估计无限域协方差，必然会导致可从加窗效应预测的偏差结果。", "answer": "$$\n\\boxed{-\\frac{h}{L}\\sigma^{2}\\exp\\left(-\\frac{h}{a}\\right)}\n$$", "id": "3554525"}, {"introduction": "Karhunen-Loève (KL) 展开是表示随机场的“最优”方法，因为它能以最少的项数捕获最多的场方差。由于完整的 KL 展开包含无限项，任何实际应用都必须进行截断。本练习聚焦于一个核心问题：保留多少项才足够？通过这个练习，你将巩固对截断误差的理解，并掌握在不确定性量化中用于决定截断项数的标准方法。[@problem_id:3554538]", "problem": "考虑一个有界域 $D \\subset \\mathbb{R}^d$ 上的二阶零均值随机场 $Z(\\boldsymbol{x},\\omega)$，它表示某个地质力学参数（例如，土壤层中的对数水力传导率）的涨落。假设 $Z$ 具有一个连续、平方可积的协方差函数 $C(\\boldsymbol{x},\\boldsymbol{x}')$，并在 $L^2(D)$ 上定义自伴、正、迹类积分算子 $\\mathcal{C}$ 为 $(\\mathcal{C}\\varphi)(\\boldsymbol{x})=\\int_D C(\\boldsymbol{x},\\boldsymbol{x}')\\varphi(\\boldsymbol{x}')\\,\\mathrm{d}\\boldsymbol{x}'$。令 $\\{(\\lambda_n,\\phi_n)\\}_{n\\ge 1}$ 为其特征系统，其中特征函数在 $L^2(D)$ 中是标准正交的，并令 $Z$ 的 Karhunen–Loève 展开 (KLE) 为\n$$\nZ(\\boldsymbol{x},\\omega)=\\sum_{n=1}^{\\infty} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}),\n$$\n其中 $\\{\\xi_n\\}$ 是一列不相关、零均值、单位方差的随机变量。对于具有 $N$ 个模态的截断 KLE，\n$$\nZ_N(\\boldsymbol{x},\\omega)=\\sum_{n=1}^{N} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}),\n$$\n定义均方截断误差为均方 $L^2(D)$ 误差\n$$\nE_N \\equiv \\int_D \\mathbb{E}\\big[(Z(\\boldsymbol{x},\\omega)-Z_N(\\boldsymbol{x},\\omega))^2\\big]\\,\\mathrm{d}\\boldsymbol{x}.\n$$\n在计算地质力学中，不确定性量化 (UQ) 的一个常见目标是选择最小的 $N$，使得某个下游的关注量（例如，由 $Z$ 驱动的线性弹性偏微分方程 (PDE) 的位移场解）因 KLE 截断而产生的不确定性得到控制。\n\n哪个选项正确地给出了 $E_N$ 的表达式，并阐述了在实践中选择 $N$ 的一个合理、通用的准则？\n\nA. $E_N$ 等于 $\\mathcal{C}$ 的被忽略特征值的和。一个实际的选择是取最小的整数 $N$，使得保留的累积方差分数满足 $\\sum_{n=1}^{N}\\lambda_n \\,\\big/\\, \\sum_{n=1}^{\\infty}\\lambda_n \\ge 1-\\varepsilon$，其中 $0<\\varepsilon<1$ 是一个预设的容差，因此 $E_N \\le \\varepsilon \\sum_{n=1}^{\\infty}\\lambda_n$。这控制了输入场的均方误差，并且对于线性或 Lipschitz 连续的地质力学模型，它限制了输出统计量中引起的误差。\n\nB. $E_N$ 等于逐点残差方差 $E_N=\\sum_{n=N+1}^{\\infty}\\lambda_n\\,\\phi_n(\\boldsymbol{x})^2$，因此应选择 $N$ 使得单个最大的被忽略特征值满足 $\\lambda_N\\le \\varepsilon\\,\\sigma^2$，其中 $\\sigma^2$ 是 $Z$ 的逐点方差。\n\nC. $E_N$ 等于被忽略特征值的乘积 $E_N=\\prod_{n=N+1}^{\\infty}\\lambda_n$，所以应选择 $N$ 以最小化最大的被忽略特征值，因为它在乘积中占主导地位。\n\nD. $E_N$ 等于被忽略特征值的平方和 $E_N=\\sum_{n=N+1}^{\\infty}\\lambda_n^2$。一个稳健的选择是强制要求 $\\sum_{n=N+1}^{\\infty}\\lambda_n^2 \\le \\varepsilon\\,\\sigma^4$，其中 $\\sigma^2$ 是 $Z$ 的逐点方差。\n\nE. $E_N$ 等于总积分方差 $E_N=\\int_D \\sigma^2(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$，与 $N$ 无关，其中 $\\sigma^2(\\boldsymbol{x})=C(\\boldsymbol{x},\\boldsymbol{x})$，因此 KLE 模态的数量对 UQ 中的均方截断误差没有影响。", "solution": "问题陈述提出了一个关于随机场 Karhunen-Loève 展开 (KLE) 的有效且定义明确的问题，这是计算地质力学和不确定性量化中的一个标准课题。所有给出的定义和条件都是标准的且在数学上是合理的。因此，我们可以着手求解。\n\n问题要求给出均方截断误差 $E_N$ 的正确表达式以及选择截断数 $N$ 的合理准则。$E_N$ 的定义如下：\n$$\nE_N \\equiv \\int_D \\mathbb{E}\\big[(Z(\\boldsymbol{x},\\omega)-Z_N(\\boldsymbol{x},\\omega))^2\\big]\\,\\mathrm{d}\\boldsymbol{x}.\n$$\n\n首先，我们表示完整随机场 $Z(\\boldsymbol{x},\\omega)$ 与其 $N$ 项截断近似 $Z_N(\\boldsymbol{x},\\omega)$ 之间的差。\n$$\nZ(\\boldsymbol{x},\\omega) - Z_N(\\boldsymbol{x},\\omega) = \\sum_{n=1}^{\\infty} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}) - \\sum_{n=1}^{N} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}) = \\sum_{n=N+1}^{\\infty} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}).\n$$\n这个差是截断的残差。接下来，我们对这个表达式进行平方：\n$$\n(Z(\\boldsymbol{x},\\omega) - Z_N(\\boldsymbol{x},\\omega))^2 = \\left( \\sum_{n=N+1}^{\\infty} \\sqrt{\\lambda_n}\\,\\xi_n(\\omega)\\,\\phi_n(\\boldsymbol{x}) \\right) \\left( \\sum_{m=N+1}^{\\infty} \\sqrt{\\lambda_m}\\,\\xi_m(\\omega)\\,\\phi_m(\\boldsymbol{x}) \\right)\n$$\n$$\n= \\sum_{n=N+1}^{\\infty} \\sum_{m=N+1}^{\\infty} \\sqrt{\\lambda_n \\lambda_m} \\,\\xi_n(\\omega)\\,\\xi_m(\\omega)\\,\\phi_n(\\boldsymbol{x})\\phi_m(\\boldsymbol{x}).\n$$\n现在我们计算期望 $\\mathbb{E}[\\cdot]$。由于期望算子是线性的，我们可以将其移到求和号内部（假设收敛，这对 KLE 是有保证的）。\n$$\n\\mathbb{E}\\big[(Z(\\boldsymbol{x},\\omega) - Z_N(\\boldsymbol{x},\\omega))^2\\big] = \\sum_{n=N+1}^{\\infty} \\sum_{m=N+1}^{\\infty} \\sqrt{\\lambda_n \\lambda_m} \\,\\mathbb{E}[\\xi_n(\\omega)\\,\\xi_m(\\omega)]\\,\\phi_n(\\boldsymbol{x})\\phi_m(\\boldsymbol{x}).\n$$\n随机变量 $\\{\\xi_n\\}$ 被设定为不相关、零均值和单位方差。这意味着它们的协方差为 $\\mathbb{E}[\\xi_n \\xi_m] = \\delta_{nm}$，其中 $\\delta_{nm}$ 是克罗内克 δ。将此性质代入方程，双重求和坍缩为单个求和，因为只有当 $n=m$ 时项才非零：\n$$\n\\mathbb{E}\\big[(Z(\\boldsymbol{x},\\omega) - Z_N(\\boldsymbol{x},\\omega))^2\\big] = \\sum_{n=N+1}^{\\infty} \\sum_{m=N+1}^{\\infty} \\sqrt{\\lambda_n \\lambda_m} \\,\\delta_{nm}\\,\\phi_n(\\boldsymbol{x})\\phi_m(\\boldsymbol{x}) = \\sum_{n=N+1}^{\\infty} \\lambda_n\\,\\phi_n(\\boldsymbol{x})^2.\n$$\n该表达式是逐点均方误差，或点 $\\boldsymbol{x}$ 处的残差方差。为了求得 $E_N$，我们必须将此表达式在域 $D$ 上积分：\n$$\nE_N = \\int_D \\left(\\sum_{n=N+1}^{\\infty} \\lambda_n\\,\\phi_n(\\boldsymbol{x})^2\\right) \\mathrm{d}\\boldsymbol{x}.\n$$\n根据 Fubini-Tonelli 定理（因为所有项都是非负的），我们可以交换求和与积分的顺序：\n$$\nE_N = \\sum_{n=N+1}^{\\infty} \\lambda_n \\int_D \\phi_n(\\boldsymbol{x})^2\\,\\mathrm{d}\\boldsymbol{x}.\n$$\n问题陈述特征函数 $\\{\\phi_n\\}$ 在 $L^2(D)$ 中是标准正交的。根据定义，这意味着 $\\int_D \\phi_n(\\boldsymbol{x}) \\phi_m(\\boldsymbol{x}) \\mathrm{d}\\boldsymbol{x} = \\delta_{nm}$。对于 $n=m$ 的情况，我们有 $\\int_D \\phi_n(\\boldsymbol{x})^2\\,\\mathrm{d}\\boldsymbol{x} = 1$。将此代入我们关于 $E_N$ 的表达式中，得到：\n$$\nE_N = \\sum_{n=N+1}^{\\infty} \\lambda_n.\n$$\n因此，均方 $L^2(D)$ 截断误差恰好是与被忽略的模态相对应的特征值的和。\n\n这个结果与场的总积分方差有关。场在点 $\\boldsymbol{x}$ 的方差是 $\\sigma^2(\\boldsymbol{x}) = \\mathbb{E}[Z(\\boldsymbol{x})^2] = C(\\boldsymbol{x},\\boldsymbol{x})$。根据 Mercer 定理，$C(\\boldsymbol{x},\\boldsymbol{x})=\\sum_{n=1}^\\infty \\lambda_n \\phi_n(\\boldsymbol{x})^2$。总积分方差为：\n$$\n\\int_D C(\\boldsymbol{x},\\boldsymbol{x}) \\mathrm{d}\\boldsymbol{x} = \\int_D \\left(\\sum_{n=1}^\\infty \\lambda_n \\phi_n(\\boldsymbol{x})^2\\right) \\mathrm{d}\\boldsymbol{x} = \\sum_{n=1}^\\infty \\lambda_n \\int_D \\phi_n(\\boldsymbol{x})^2 \\mathrm{d}\\boldsymbol{x} = \\sum_{n=1}^\\infty \\lambda_n.\n$$\n这是积分算子 $\\mathcal{C}$ 的迹。因此，$E_N$ 表示未被 $N$ 项截断捕获的那部分总积分方差。\n\n一个选择 $N$ 的标准且实用的准则，是确保截断级数保留了总方差（或“能量”）的足够大的部分。具体来说，选择最小的 $N$ 使得保留的方差与总方差之比超过某个阈值 $1-\\varepsilon$，其中 $\\varepsilon \\in (0,1)$ 是一个小的容差：\n$$\n\\frac{\\sum_{n=1}^{N} \\lambda_n}{\\sum_{n=1}^{\\infty} \\lambda_n} \\ge 1-\\varepsilon.\n$$\n这等价于限制相对误差：\n$$\n\\frac{E_N}{\\sum_{n=1}^{\\infty} \\lambda_n} = \\frac{\\sum_{n=N+1}^{\\infty} \\lambda_n}{\\sum_{n=1}^{\\infty} \\lambda_n} \\le \\varepsilon, \\quad \\text{或} \\quad E_N \\le \\varepsilon \\sum_{n=1}^{\\infty} \\lambda_n.\n$$\n这个准则被广泛使用，因为控制输入随机场的误差为控制由其计算出的关注量的误差提供了基础，特别是当正向模型是线性或 Lipschitz 连续的时候。\n\n现在，我们评估每个选项。\n\nA. $E_N$ 等于 $\\mathcal{C}$ 的被忽略特征值的和。一个实际的选择是取最小的整数 $N$，使得保留的累积方差分数满足 $\\sum_{n=1}^{N}\\lambda_n \\,\\big/\\, \\sum_{n=1}^{\\infty}\\lambda_n \\ge 1-\\varepsilon$，其中 $0<\\varepsilon<1$ 是一个预设的容差，因此 $E_N \\le \\varepsilon \\sum_{n=1}^{\\infty}\\lambda_n$。这控制了输入场的均方误差，并且对于线性或 Lipschitz 连续的地质力学模型，它限制了输出统计量中引起的误差。\n该选项正确地指出 $E_N = \\sum_{n=N+1}^{\\infty}\\lambda_n$。它还提出了基于保留方差分数的标准、被广泛接受的选择 $N$ 的准则。所提供的理由也是合理的，并代表了 UQ 中的一个关键原则：控制输入不确定性以限制输出不确定性。**正确。**\n\nB. $E_N$ 等于逐点残差方差 $E_N=\\sum_{n=N+1}^{\\infty}\\lambda_n\\,\\phi_n(\\boldsymbol{x})^2$，因此应选择 $N$ 使得单个最大的被忽略特征值满足 $\\lambda_N\\le \\varepsilon\\,\\sigma^2$，其中 $\\sigma^2$ 是 $Z$ 的逐点方差。\n$E_N$ 的表达式不正确。它将积分误差 $E_N$ 与逐点均方误差混淆了，后者是 $\\boldsymbol{x}$ 的函数。此外，基于单个特征值的准则不如基于被忽略特征值之和的准则稳健，而且使用一个通用的 $\\sigma^2$ 是模糊的，因为逐点方差通常不是常数。**不正确。**\n\nC. $E_N$ 等于被忽略特征值的乘积 $E_N=\\prod_{n=N+1}^{\\infty}\\lambda_n$，所以应选择 $N$ 以最小化最大的被忽略特征值，因为它在乘积中占主导地位。\n$E_N$ 的表达式不正确。误差是被忽略特征值的和，而不是乘积。**不正确。**\n\nD. $E_N$ 等于被忽略特征值的平方和 $E_N=\\sum_{n=N+1}^{\\infty}\\lambda_n^2$。一个稳健的选择是强制要求 $\\sum_{n=N+1}^{\\infty}\\lambda_n^2 \\le \\varepsilon\\,\\sigma^4$，其中 $\\sigma^2$ 是 $Z$ 的逐点方差。\n$E_N$ 的表达式不正确。误差是特征值的和 $\\sum \\lambda_n$，而不是它们平方的和 $\\sum \\lambda_n^2$。后者与残差协方差算子的 Hilbert-Schmidt 范数有关。**不正确。**\n\nE. $E_N$ 等于总积分方差 $E_N=\\int_D \\sigma^2(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$，与 $N$ 无关，其中 $\\sigma^2(\\boldsymbol{x})=C(\\boldsymbol{x},\\boldsymbol{x})$，因此 KLE 模态的数量对 UQ 中的均方截断误差没有影响。\n这个陈述有根本性的错误。$E_N$ 是由于截断产生的*误差*，并且明确地依赖于 $N$，当 $N \\to \\infty$ 时趋于 $0$。表达式 $\\int_D \\sigma^2(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$ 是总积分方差，即 $\\sum_{n=1}^{\\infty} \\lambda_n$，它是 $N \\to 0$ 时误差的极限，而不是对于一个通用 $N$ 的误差。模态数量没有影响的结论是错误的。**不正确。**\n\n基于详细的推导，只有选项 A 在其所有部分都是正确的：$E_N$ 的公式，选择 $N$ 的实用准则，以及其在 UQ 中使用的理由。", "answer": "$$\\boxed{A}$$", "id": "3554538"}, {"introduction": "从表示理论转向随机场的生成。基于快速傅里叶变换 ($\\text{FFT}$) 的方法是生成平稳随机场样本的最高效途径之一。本练习将深入探讨“循环嵌入”技术，这是一种克服简单 $\\text{FFT}$ 方法中人为边界效应的强大策略。你将直面一个常见的数值陷阱——协方差矩阵失去正定性，并学习如何诊断和修正它，从而深入理解高级模拟算法的内部机制。[@problem_id:3554544]", "problem": "一个平稳的、零均值的高斯随机场 $Z(x)$ 被用于在计算地质力学中模拟一维土柱上水力传导率的归一化对数。该场在 $N$ 个等距位置上进行采样，间距为 $\\Delta x$，因此采样点为 $x_{n} = n \\Delta x$，其中 $n = 0, 1, \\dots, N-1$。目标协方差函数为指数型，\n$$\nC(h) = \\sigma^{2} \\exp\\!\\left(-\\frac{|h|}{\\ell}\\right),\n$$\n其中 $\\sigma^{2} > 0$ 是方差，$\\ell > 0$ 是相关长度。目标是使用基于快速傅里叶变换 (FFT) 的循环嵌入方法，生成离散化场 $\\{Z(x_{n})\\}_{n=0}^{N-1}$ 的一个样本。\n\n请从协方差、正定性以及通过离散傅里叶变换 (DFT) 对循环矩阵进行对角化的基本定义出发，按以下步骤进行：\n\n1) 定义由 $C(h)$ 在网格上导出的托普利茨 (Toeplitz) 协方差序列 $\\{c_{k}\\}$，其中 $c_{k} = C(k \\Delta x)$，$k \\in \\mathbb{Z}$。使用大小为 $m$（其中 $m$ 为偶数且 $m \\ge 2N$）的标准零填充循环嵌入，构造嵌入的循环矩阵的第一行 $\\{r_{k}\\}_{k=0}^{m-1}$，其中\n- $r_{0} = c_{0}$,\n- $r_{k} = c_{k}$ 对于 $k = 1, \\dots, N-1$,\n- $r_{k} = 0$ 对于 $k = N, \\dots, m-N$,\n- $r_{k} = c_{m-k}$ 对于 $k = m-N+1, \\dots, m-1$。\n\n2) 证明该循环矩阵可由酉 DFT 矩阵对角化，并根据余弦级数推导出特征值 $\\{\\lambda_{j}\\}_{j=0}^{m-1}$\n$$\n\\lambda_{j} = c_{0} + 2 \\sum_{k=1}^{N-1} c_{k} \\cos\\!\\left(\\frac{2\\pi j k}{m}\\right), \\quad j = 0, 1, \\dots, m-1.\n$$\n陈述嵌入协方差为正定的充要条件，并从离散谱密度非负性的角度对其进行物理解释。\n\n3) 针对指数协方差进行特例分析，参数选择为离散相关比 $ \\rho \\equiv \\exp(-\\Delta x/\\ell) = 0.9$，方差 $\\sigma^{2} = 1$，网格大小 $N = 6$，间距 $\\Delta x = 1$ 米，嵌入大小 $m = 16$。在进行最终数值计算前，仅使用符号操作，推导出嵌入循环矩阵最小特征值的闭式表达式。论证哪个离散频率 $j$ 达到最小值，并在该频率下计算表达式以获得最小特征值。\n\n4) 假设由于最小特征值为负而导致正定性不成立。一种标准的补救方法是在零延迟处向协方差中添加一个非负的“块金”方差 $\\tau^{2}$，即将 $C(0)$ 替换为 $C(0) + \\tau^{2}$。解释这将如何改变循环矩阵的特征值，并推导恢复所有特征值非负性的最小 $\\tau^{2}$ 的公式。然后，为上述参数计算这个最小 $\\tau^{2}$。将答案四舍五入到五位有效数字。以与 $Z$ 相同的方差单位表示块金，对于这个归一化场，该单位是无量纲的。\n\n此外，如果给定嵌入下的正定性不成立，请指出从业者可以采用的至少另外两种补救措施，并从谱的观点证明它们为什么有效。您的推导必须从指定的定义出发，不得假设任何未经证明的快捷公式。全程使用弧度作为角度单位。您最终报告的值必须是第 4 部分所要求的最小 $\\tau^{2}$ 的数值。", "solution": "我们从基本定义开始。对于一个具有协方差函数 $C(h)$ 的平稳零均值高斯随机场 $Z(x)$，在网格间距为 $k$ 时的离散协方差为 $c_{k} = C(k \\Delta x)$。$\\{Z(x_{n})\\}_{n=0}^{N-1}$ 的协方差矩阵是托普利茨 (Toeplitz) 矩阵，其第一行为 $(c_{0}, c_{1}, \\dots, c_{N-1})$。\n\n为了能够通过循环嵌入进行基于快速傅里叶变换 (FFT) 的采样，我们将 $N \\times N$ 的托普利茨 (Toeplitz) 协方差嵌入到一个 $m \\times m$ 的循环矩阵中，其中 $m \\ge 2N$ 且 $m$ 为偶数。第一行 $\\{r_{k}\\}_{k=0}^{m-1}$ 是通过对托普利茨 (Toeplitz) 序列进行零填充和反射来构造的：\n- $r_{0} = c_{0}$,\n- $r_{k} = c_{k}$ 对于 $k = 1, \\dots, N-1$,\n- $r_{k} = 0$ 对于 $k = N, \\dots, m-N$,\n- $r_{k} = c_{m-k}$ 对于 $k = m-N+1, \\dots, m-1$。\n\n一个第一行为 $\\{r_{k}\\}$ 的循环矩阵可由离散傅里叶变换 (DFT) 矩阵对角化。将 DFT 频率写为 $\\theta_{j} = \\frac{2\\pi j}{m}$，$j = 0, 1, \\dots, m-1$，其特征对由傅里叶模式给出，特征值是 $\\{r_{k}\\}$ 的 DFT：\n$$\n\\lambda_{j} = \\sum_{k=0}^{m-1} r_{k} \\exp(-\\mathrm{i} \\theta_{j} k).\n$$\n因为 $r_{k}$ 是实的，并且在 $r_{k} = r_{m-k}$ 的意义上是对称的，所以特征值是实的，可以写成余弦级数。代入零填充的构造，并对整数 $j$ 使用恒等式 $\\exp(-\\mathrm{i} \\theta (m-k)) = \\exp(-\\mathrm{i} \\theta m)\\exp(+\\mathrm{i} \\theta k) = \\exp(+\\mathrm{i} \\theta k)$，我们得到\n$$\n\\begin{aligned}\n\\lambda_{j} = r_{0} + \\sum_{k=1}^{N-1} c_{k} \\exp(-\\mathrm{i} \\theta_{j} k) + \\sum_{k=m-N+1}^{m-1} c_{m-k} \\exp(-\\mathrm{i} \\theta_{j} k) \\\\\n= c_{0} + \\sum_{k=1}^{N-1} c_{k} \\left[ \\exp(-\\mathrm{i} \\theta_{j} k) + \\exp(+\\mathrm{i} \\theta_{j} k) \\right] \\\\\n= c_{0} + 2 \\sum_{k=1}^{N-1} c_{k} \\cos(\\theta_{j} k).\n\\end{aligned}\n$$\n因此，\n$$\n\\lambda_{j} \\;=\\; c_{0} + 2 \\sum_{k=1}^{N-1} c_{k} \\cos\\!\\left(\\frac{2\\pi j k}{m}\\right).\n$$\n嵌入协方差为半正定的充要条件是对于所有 $j = 0, 1, \\dots, m-1$，都有 $\\lambda_{j} \\ge 0$。从物理上看，由于特征值是周期化（混叠）离散谱密度的样本，此条件要求在离散傅里叶频率处的混叠谱为非负。\n\n我们现在特例分析指数协方差，\n$$\nC(h) = \\sigma^{2} \\exp\\!\\left(-\\frac{|h|}{\\ell}\\right),\n$$\n因此网格上的托普利茨 (Toeplitz) 序列是\n$$\nc_{k} = C(k \\Delta x) = \\sigma^{2} \\exp\\!\\left(-\\frac{k \\Delta x}{\\ell}\\right) = \\sigma^{2} \\rho^{k}, \\quad \\rho \\equiv \\exp\\!\\left(-\\frac{\\Delta x}{\\ell}\\right).\n$$\n使用此记法，特征值为\n$$\n\\lambda_{j} = \\sigma^{2} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\rho^{k} \\cos\\!\\left(\\frac{2\\pi j k}{m}\\right) \\right].\n$$\n\n我们按如下方式符号化地设置参数：$N = 6$，$\\sigma^{2} = 1$，$\\rho = \\exp(-\\Delta x/\\ell)$，以及 $m = 16$。角度以弧度为单位。则\n$$\n\\lambda_{j} = 1 + 2 \\sum_{k=1}^{5} \\rho^{k} \\cos\\!\\left(\\frac{2\\pi j k}{16}\\right).\n$$\n为了找出最小特征值，观察到对于 $k \\ge 1$，$\\cos(k \\theta)$ 在 $\\theta \\in [0,\\pi]$ 上的最小值在 $\\theta = \\pi$ 处取得。因为所有系数 $\\rho^{k}$ 都是正的，并且当 $m$ 为偶数时，离散集合 $\\{\\theta_{j}\\}_{j=0}^{m-1}$ 包含 $\\theta_{m/2} = \\pi$，所以和在 $j = \\frac{m}{2}$ 处最小化：\n$$\n\\theta_{\\min} = \\pi \\quad \\Rightarrow \\quad j_{\\min} = \\frac{m}{2}.\n$$\n因此，\n$$\n\\lambda_{\\min} = \\lambda_{m/2} = 1 + 2 \\sum_{k=1}^{5} \\rho^{k} \\cos(k \\pi) = 1 + 2 \\sum_{k=1}^{5} \\rho^{k} (-1)^{k}.\n$$\n这个交错有限几何级数的和有闭式形式\n$$\n\\sum_{k=1}^{5} (\\!-\\rho)^{k} = \\frac{(-\\rho)\\left(1 - (-\\rho)^{5}\\right)}{1 + \\rho}.\n$$\n因此，\n$$\n\\lambda_{\\min} = 1 + 2 \\cdot \\frac{(-\\rho)\\left(1 - (-\\rho)^{5}\\right)}{1 + \\rho}.\n$$\n因为 $(-\\rho)^{5} = -\\rho^{5}$，这可以简化为\n$$\n\\lambda_{\\min} = 1 - \\frac{2 \\rho \\left(1 + \\rho^{5}\\right)}{1 + \\rho}.\n$$\n\n如果最小特征值为负，一个标准的补救方法是向零延迟协方差中添加一个非负的“块金”方差 $\\tau^{2}$，即用 $c_{0} + \\tau^{2}$ 替换 $c_{0}$。在循环嵌入中，这会将 $\\tau^{2}$ 加到 $r_{0}$ 上，而保持所有其他 $r_{k}$ 不变。因为在 $k=0$ 处的克罗内克 (Kronecker) δ 函数的 DFT 是常数函数，所以这将使每个特征值平移相同的量：\n$$\n\\lambda_{j} \\;\\mapsto\\; \\lambda_{j} + \\tau^{2}.\n$$\n因此，恢复非负性的最小块金方差是\n$$\n\\tau^{2}_{\\min} = \\max\\!\\left\\{ 0, \\; -\\min_{0 \\le j \\le m-1} \\lambda_{j} \\right\\} = \\max\\!\\left\\{ 0, \\; -\\lambda_{\\min} \\right\\}.\n$$\n代入 $\\lambda_{\\min}$ 的符号表达式，我们得到\n$$\n\\tau^{2}_{\\min} = \\max\\!\\left\\{ 0, \\; \\frac{2 \\rho \\left(1 + \\rho^{5}\\right)}{1 + \\rho} - 1 \\right\\}.\n$$\n\n对于指定的参数 $\\sigma^{2} = 1$，$\\Delta x = 1$ (米)，以及 $\\rho = \\exp(-\\Delta x/\\ell) = 0.9$，我们计算\n$$\n\\tau^{2}_{\\min} = \\frac{2 \\rho \\left(1 + \\rho^{5}\\right)}{1 + \\rho} - 1 \\quad \\text{其中} \\quad \\rho = 0.9.\n$$\n首先进行符号计算：\n$$\n\\tau^{2}_{\\min} = \\frac{2 \\rho (1 + \\rho^{5})}{1 + \\rho} - 1.\n$$\n现在代入 $\\rho = 0.9$：\n$$\n\\begin{aligned}\n\\rho^{5} = 0.9^{5} = 0.59049, \\quad 1 + \\rho^{5} = 1.59049, \\\\\n2 \\rho (1 + \\rho^{5}) = 1.8 \\times 1.59049 = 2.862882, \\\\\n1 + \\rho = 1.9, \\quad \\frac{2 \\rho (1 + \\rho^{5})}{1 + \\rho} = \\frac{2.862882}{1.9} = 1.50678, \\\\\n\\tau^{2}_{\\min} = 1.50678 - 1 = 0.50678.\n\\end{aligned}\n$$\n因此，对于给定的参数，恢复所有特征值非负性所需的最小块金方差为 $0.50678$（无量纲方差）。按要求四舍五入到五位有效数字，结果为 $0.50678$。\n\n最后，如果在给定嵌入下正定性不成立，其他补救措施包括：\n- 增加嵌入大小 $m$（例如，重复将 $m$ 加倍），这样离散频率可以更精细地对混叠谱进行采样，并且协方差的周期化具有更小的环绕干扰。从谱的观点来看，这通过趋近连续正谱密度来减轻由截断和零填充引入的负偏移。\n- 在嵌入前修改或对协方差函数进行锥削（例如，乘以一个紧支集正定锥削函数），使得嵌入的第一行衰减得更快，并且其 DFT 保持非负。从谱的观点来看，锥削对应于将谱与一个正核进行卷积，这可以保持非负性，并能消除由离散化和混叠引入的微小负特征值。\n其他可行的补救措施包括，在可用时，在有界域上使用精确的 Karhunen–Loève 截断，或者用一个与之紧密匹配的 Matérn 类成员替换目标协方差，该成员的离散嵌入已知对于所选的 $m$ 会产生非负特征值。", "answer": "$$\\boxed{0.50678}$$", "id": "3554544"}]}