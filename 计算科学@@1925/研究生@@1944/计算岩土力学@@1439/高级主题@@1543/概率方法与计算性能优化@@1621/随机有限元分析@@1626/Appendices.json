{"hands_on_practices": [{"introduction": "在任何随机分析中，第一步都是为不确定性建立一个数学模型。在岩土力学中，这通常意味着描述土体性质的空间变异性。本练习将演示如何将一个标准的地质统计学模型（指数半变异函数）与经验数据进行拟合，这是将现场勘察结果转化为可用的随机场模型的关键技能。[@problem_id:3563275]", "problem": "将不排水抗剪强度的水平剖面建模为一个二阶平稳随机场，通过卡尔胡宁-洛伊展开（Karhunen–Loève expansion）将其作为输入，用于计算岩土力学分析中的随机有限元法（SFEM）。基于原位锥形贯入试验数据，在多个滞后距上计算了经验半变异函数。假设由于微观尺度的变异性和测量误差，存在一个指数协方差模型和一个非零的块金效应。\n\n对于一个协方差为 $\\,C(h)\\,$ 的二阶平稳场，从其半变异函数的定义 $\\,\\gamma(h) = \\frac{1}{2}\\,\\mathrm{Var}[X(\\mathbf{x}+ \\mathbf{h}) - X(\\mathbf{x})]\\,$ 出发，并回想对于指数协方差模型有 $\\,C(h) = \\sigma^{2}\\exp(-h/\\theta)\\,$，其中 $\\,\\sigma^{2}\\,$ 是结构方差，$\\,\\theta\\,$ 是相关长度。于是，半变异函数具有如下参数形式\n$$\n\\gamma(h) = c_{0} + \\sigma^{2}\\bigl(1 - \\exp(-h/\\theta)\\bigr),\n$$\n其中 $\\,c_{0}\\,$ 是块金效应，$\\,c_{0} + \\sigma^{2}\\,$ 等于基台值。使用此模型，建立一个用于估计 $\\,\\theta\\,$ 和 $\\,c_{0}\\,$ 的最小二乘估计程序，该程序适用于为随机有限元法（SFEM）离散化校准随机场。请从上述定义出发，不要使用任何专门的拟合公式。请清楚地说明您使用的任何变换以及所最小化的相关目标函数。\n\n提供了来自原位试验的以下经验半变异函数值 $\\,\\hat{\\gamma}(h)\\,$，其滞后距（单位：米）为：$\\,h = 0.5, 1.0, 2.0, 4.0\\,$，具体数值如下\n- $\\,\\hat{\\gamma}(0.5) = 10.66938\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(1.0) = 14.73166\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(2.0) = 19.72806\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(4.0) = 23.61033\\,\\text{(kPa)}^{2}\\,$.\n\n此外，同点重复测量得到了一个经验性的近零滞后距估计值 $\\,\\hat{\\gamma}(0^{+}) = 5.000\\,\\text{(kPa)}^{2}\\,$，该值应被解释为块金效应；该场的样本方差为 $\\,25.000\\,\\text{(kPa)}^{2}\\,$，应被解释为基台值。请使用这些信息进行最小二乘估计，然后根据所提供的数据计算 $\\,\\theta\\,$ 和 $\\,c_{0}\\,$ 的数值估计。\n\n将最终的数值估计四舍五入到四位有效数字。相关长度以米为单位表示；块金效应应以 $\\,\\text{(kPa)}^{2}\\,$ 为单位表示。最终答案必须仅由这两个估计值组成，以单行矩阵的形式按 $\\,(\\theta, c_{0})\\,$ 的顺序列出。", "solution": "问题要求为半变异函数模型的参数建立一个最小二乘估计程序，并随后使用提供的经验数据计算这些参数。\n\n首先，我们验证问题陈述及其给定条件。\n半变异函数模型由下式给出\n$$ \\gamma(h) = c_{0} + \\sigma^{2}\\bigl(1 - \\exp(-h/\\theta)\\bigr) $$\n其中 $c_{0}$ 是块金效应，$\\sigma^{2}$ 是结构方差，$\\theta$ 是相关长度。基台值（或总方差）为 $S = c_{0} + \\sigma^{2}$。我们可以根据基台值 $S$ 将模型重写为\n$$ \\gamma(h) = c_{0} + (S-c_{0})\\bigl(1 - \\exp(-h/\\theta)\\bigr) $$\n问题提供了一组经验半变异函数值 $(\\hat{\\gamma}(h_i), h_i)$，其中 $i=1, \\dots, 4$：\n- $h_1 = 0.5\\,\\text{m}, \\hat{\\gamma}(h_1) = 10.66938\\,\\text{(kPa)}^{2}$\n- $h_2 = 1.0\\,\\text{m}, \\hat{\\gamma}(h_2) = 14.73166\\,\\text{(kPa)}^{2}$\n- $h_3 = 2.0\\,\\text{m}, \\hat{\\gamma}(h_3) = 19.72806\\,\\text{(kPa)}^{2}$\n- $h_4 = 4.0\\,\\text{m}, \\hat{\\gamma}(h_4) = 23.61033\\,\\text{(kPa)}^{2}$\n\n此外，它还提供了用于块金效应和基台值的明确数值：\n- 块金效应：$c_0$ 取自经验估计值 $\\hat{\\gamma}(0^{+})$，因此 $c_0 = 5.000\\,\\text{(kPa)}^{2}$。\n- 基台值：$S$ 取自样本方差，因此 $S = 25.000\\,\\text{(kPa)}^{2}$。\n\n该问题具有科学依据，使用了地质统计学中的标准模型和方法。其提法恰当且客观，并提供了充分且一致的数据以得到唯一解。因此，该问题被认为是有效的。\n\n任务是为 $\\theta$ 和 $c_0$ 建立一个最小二乘估计程序。在一般情况下，当 $\\theta$ 和 $c_0$ 均未知（但基台值 $S$ 已知）时，目标是找到使模型与经验数据之间的平方误差和（SSE）最小化的参数对 $(\\theta, c_0)$。要最小化的目标函数是：\n$$ J(\\theta, c_0) = \\sum_{i=1}^{N} \\left[ \\hat{\\gamma}(h_i) - \\gamma(h_i; \\theta, c_0) \\right]^2 = \\sum_{i=1}^{N} \\left[ \\hat{\\gamma}(h_i) - \\left( c_0 + (S-c_0)(1 - \\exp(-h_i/\\theta)) \\right) \\right]^2 $$\n这是一个非线性最小二乘问题，通常使用数值优化算法来求解。\n\n然而，问题为 $c_0$ 和基台值 $S$ 提供了具体数值。我们被要求使用这些值进行估计。\n给定 $c_0 = 5.000$ 和 $S = 25.000$，结构方差为 $\\sigma^2 = S - c_0 = 25.000 - 5.000 = 20.000 \\, (\\text{kPa})^2$。\n模型简化为一个只含单个未知参数 $\\theta$ 的函数：\n$$ \\gamma(h; \\theta) = 5.000 + 20.000 \\left(1 - \\exp(-h/\\theta)\\right) $$\n估计问题现在简化为寻找能够最佳拟合数据的最优 $\\theta$。我们可以将其表述为一个一维最小二乘问题，即最小化：\n$$ J(\\theta) = \\sum_{i=1}^{4} \\left[ \\hat{\\gamma}(h_i) - \\left( 5.000 + 20.000 \\left(1 - \\exp(-h_i/\\theta)\\right) \\right) \\right]^2 $$\n为了找到解，我们可以通过变量变换将模型线性化。重排模型方程：\n$$ \\hat{\\gamma}(h_i) - 5.000 = 20.000(1 - \\exp(-h_i/\\theta)) $$\n$$ \\frac{\\hat{\\gamma}(h_i) - 5.000}{20.000} = 1 - \\exp(-h_i/\\theta) $$\n$$ \\exp(-h_i/\\theta) = 1 - \\frac{\\hat{\\gamma}(h_i) - 5.000}{20.000} = \\frac{20.000 - \\hat{\\gamma}(h_i) + 5.000}{20.000} = \\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000} $$\n对两边取自然对数，得到一个线性关系：\n$$ -\\frac{h_i}{\\theta} = \\ln\\left(\\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000}\\right) $$\n我们定义一个变换后的变量 $y_i = \\ln\\left(\\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000}\\right)$ 和一个斜率 $m = -1/\\theta$。模型变成一个强制通过原点的线性方程：\n$$ y_i = m \\cdot h_i $$\n在这个变换后的空间中，最小化的相关目标是该线性模型的残差平方和：\n$$ L(m) = \\sum_{i=1}^{4} (y_i - m h_i)^2 $$\n为了找到使 $L(m)$ 最小化的 $m$ 值，我们对 $m$ 求导并令其为零：\n$$ \\frac{dL}{dm} = \\sum_{i=1}^{4} 2(y_i - m h_i)(-h_i) = 0 $$\n$$ \\sum_{i=1}^{4} (-y_i h_i + m h_i^2) = 0 $$\n$$ m \\sum_{i=1}^{4} h_i^2 = \\sum_{i=1}^{4} y_i h_i $$\n因此，斜率 $m$ 的最小二乘估计值为：\n$$ m = \\frac{\\sum_{i=1}^{4} y_i h_i}{\\sum_{i=1}^{4} h_i^2} $$\n我们现在根据提供的数据计算必要的值。\n首先，我们计算变换后的变量 $y_i$：\n- 对于 $h_1=0.5$：$y_1 = \\ln\\left(\\frac{25.000 - 10.66938}{20.000}\\right) = \\ln(0.716531) \\approx -0.333334$\n- 对于 $h_2=1.0$：$y_2 = \\ln\\left(\\frac{25.000 - 14.73166}{20.000}\\right) = \\ln(0.513417) \\approx -0.666667$\n- 对于 $h_3=2.0$：$y_3 = \\ln\\left(\\frac{25.000 - 19.72806}{20.000}\\right) = \\ln(0.263597) \\approx -1.333331$\n- 对于 $h_4=4.0$：$y_4 = \\ln\\left(\\frac{25.000 - 23.61033}{20.000}\\right) = \\ln(0.0694835) \\approx -2.666669$\n\n接下来，我们计算和 $\\sum y_i h_i$ 与 $\\sum h_i^2$：\n- $\\sum h_i^2 = (0.5)^2 + (1.0)^2 + (2.0)^2 + (4.0)^2 = 0.25 + 1.0 + 4.0 + 16.0 = 21.25$\n- $\\sum y_i h_i = (-0.333334)(0.5) + (-0.666667)(1.0) + (-1.333331)(2.0) + (-2.666669)(4.0)$\n  $\\sum y_i h_i = -0.166667 - 0.666667 - 2.666662 - 10.666676 = -14.166672$\n\n现在我们计算斜率 $m$：\n$$ m = \\frac{-14.166672}{21.25} \\approx -0.666666917 $$\n这个值显然是 $m = -2/3$。\n最后，我们根据斜率 $m$ 估计相关长度 $\\theta$：\n$$ \\theta = -\\frac{1}{m} = -\\frac{1}{-2/3} = \\frac{3}{2} = 1.5 $$\n所以，相关长度的估计值为 $\\theta = 1.5$ 米。\n\n估计的参数是相关长度 $\\theta$ 和块金效应 $c_0$。$c_0$ 的值已在问题陈述中直接给出。按要求四舍五入到四位有效数字：\n- $\\theta = 1.500$ m\n- $c_0 = 5.000$ $(\\text{kPa})^2$\n\n最终答案由这两个值组成。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.500  & 5.000 \\end{pmatrix} } $$", "id": "3563275"}, {"introduction": "定义了随机场后，必须将其表示在有限元网格上。此练习探讨了方差折减的概念，展示了在一个有限元区域上对属性进行平均如何降低其相对于场内逐点变异性的变异程度。这是理解网格尺寸如何影响随机模拟结果的一个至关重要的概念。[@problem_id:3563295]", "problem": "考虑一个二维地质力学域，其中杨氏模量的空间变异性由一个二阶平稳随机场 $E(\\boldsymbol{x},\\omega)$ 建模，其均值为 $\\mu_{E}$，方差为 $\\sigma_{E}^{2}$，其中 $\\boldsymbol{x} \\in \\mathbb{R}^{2}$，$\\omega$ 表示在底层概率空间中的一个实现。在随机有限元方法 (SFEM) 中，单元级别的等效属性通常通过在单元域 $A$ 上的空间平均值 $\\bar{E}_{A} = |A|^{-1} \\int_{A} E(\\boldsymbol{x},\\omega)\\,d\\boldsymbol{x}$ 来定义。假设 $A$ 是一个矩形 $[0,L_{x}] \\times [0,L_{y}]$，其面积为 $|A| = L_{x}L_{y}$，并且 $E$ 的协方差是各向异性的、可分离的指数核函数\n$$\nC(\\boldsymbol{r}) = \\operatorname{Cov}\\big(E(\\boldsymbol{x},\\omega),E(\\boldsymbol{x}+\\boldsymbol{r},\\omega)\\big) = \\sigma_{E}^{2}\\,\\exp\\!\\big(-|r_{x}|/a_{x}\\big)\\,\\exp\\!\\big(-|r_{y}|/a_{y}\\big),\n$$\n其中 $\\boldsymbol{r} = (r_{x},r_{y})$，$a_{x}>0$ 和 $a_{y}>0$ 分别是沿 $x$ 和 $y$ 方向的相关长度。\n\n从二阶平稳随机场的空间平均和协方差的定义出发，推导在矩形域 $A$ 上的空间平均值 $\\bar{E}_{A}$ 的方差的精确、闭式表达式，该表达式应以 $L_{x}$、$L_{y}$、$a_{x}$、$a_{y}$ 和 $\\sigma_{E}^{2}$ 表示。然后，仅使用推导出的公式和指数函数的标准渐近性，解释当平均面积增加时方差如何缩放，特别是在 $L_{x}\\gg a_{x}$ 和 $L_{y}\\gg a_{y}$ 的情况下。\n\n将您的最终结果以 $\\operatorname{Var}(\\bar{E}_{A})$ 的单个解析表达式的形式提供，用 $L_{x}$、$L_{y}$、$a_{x}$、$a_{y}$ 和 $\\sigma_{E}^{2}$ 表示。最终表达式中不要包含单位，也不要进行任何数值取整。", "solution": "该问题具有科学依据，提法明确，且解决问题所需的所有信息均已提供。因此，我们可以开始推导。\n\n空间平均值 $\\bar{E}_{A}$ 的方差由二阶平稳随机场 $E(\\boldsymbol{x},\\omega)$ 的通用公式给出：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\operatorname{Var}\\left(\\frac{1}{|A|} \\int_A E(\\boldsymbol{x},\\omega) \\,d\\boldsymbol{x}\\right) = \\frac{1}{|A|^2} \\int_A \\int_A \\operatorname{Cov}\\big(E(\\boldsymbol{x}_1,\\omega), E(\\boldsymbol{x}_2,\\omega)\\big) \\,d\\boldsymbol{x}_1 \\,d\\boldsymbol{x}_2\n$$\n由于平稳性，协方差仅取决于分离向量 $\\boldsymbol{r} = \\boldsymbol{x}_1 - \\boldsymbol{x}_2$。令 $\\operatorname{Cov}\\big(E(\\boldsymbol{x}_1,\\omega), E(\\boldsymbol{x}_2,\\omega)\\big) = C(\\boldsymbol{x}_1 - \\boldsymbol{x}_2)$。方差变为：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\frac{1}{|A|^2} \\int_A \\int_A C(\\boldsymbol{x}_1 - \\boldsymbol{x}_2) \\,d\\boldsymbol{x}_1 \\,d\\boldsymbol{x}_2\n$$\n问题指定域 $A$ 为一个矩形 $[0,L_{x}] \\times [0,L_{y}]$，因此其面积为 $|A| = L_x L_y$。协方差函数是各向异性的、可分离的指数核函数：\n$$\nC(\\boldsymbol{r}) = \\sigma_{E}^{2}\\,\\exp\\!\\big(-|r_{x}|/a_{x}\\big)\\,\\exp\\!\\big(-|r_{y}|/a_{y}\\big)\n$$\n其中 $\\boldsymbol{r} = (r_x, r_y)$。令 $\\boldsymbol{x}_1 = (x_1, y_1)$ 和 $\\boldsymbol{x}_2 = (x_2, y_2)$。方差表达式是一个四重积分：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\frac{\\sigma_{E}^{2}}{(L_x L_y)^2} \\int_{0}^{L_y} \\int_{0}^{L_x} \\int_{0}^{L_y} \\int_{0}^{L_x} \\exp\\left(-\\frac{|x_1 - x_2|}{a_x}\\right) \\exp\\left(-\\frac{|y_1 - y_2|}{a_y}\\right) \\,dx_2 \\,dy_2 \\,dx_1 \\,dy_1\n$$\n因为被积函数和积分域是可分离的，我们可以将四重积分分解为两个二重积分的乘积：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\sigma_{E}^{2} \\left[ \\frac{1}{L_x^2} \\int_{0}^{L_x} \\int_{0}^{L_x} \\exp\\left(-\\frac{|x_1 - x_2|}{a_x}\\right) \\,dx_1 \\,dx_2 \\right] \\left[ \\frac{1}{L_y^2} \\int_{0}^{L_y} \\int_{0}^{L_y} \\exp\\left(-\\frac{|y_1 - y_2|}{a_y}\\right) \\,dy_1 \\,dy_2 \\right]\n$$\n括号中的两项具有相同的函数形式。让我们求解一般的一维情况：\n$$\nI(L, a) = \\int_{0}^{L} \\int_{0}^{L} \\exp\\left(-\\frac{|u - v|}{a}\\right) \\,du \\,dv\n$$\n积分域是 $(u,v)$-平面上边长为 $L$ 的正方形。被积函数关于直线 $u=v$ 对称。我们可以在 $0 \\le v \\le u \\le L$ 的三角形区域上积分，然后将结果乘以 2：\n$$\nI(L, a) = 2 \\int_{0}^{L} \\left[ \\int_{0}^{u} \\exp\\left(-\\frac{u-v}{a}\\right) \\,dv \\right] \\,du\n$$\n首先，我们求解关于 $v$ 的内层积分：\n$$\n\\int_{0}^{u} \\exp\\left(-\\frac{u-v}{a}\\right) \\,dv = \\exp\\left(-\\frac{u}{a}\\right) \\int_{0}^{u} \\exp\\left(\\frac{v}{a}\\right) \\,dv = \\exp\\left(-\\frac{u}{a}\\right) \\left[ a\\exp\\left(\\frac{v}{a}\\right) \\right]_{v=0}^{v=u}\n$$\n$$\n= \\exp\\left(-\\frac{u}{a}\\right) \\left( a\\exp\\left(\\frac{u}{a}\\right) - a\\exp(0) \\right) = a \\left(1 - \\exp\\left(-\\frac{u}{a}\\right)\\right)\n$$\n接下来，我们将此结果代入关于 $u$ 的外层积分中：\n$$\nI(L, a) = 2 \\int_{0}^{L} a \\left(1 - \\exp\\left(-\\frac{u}{a}\\right)\\right) \\,du = 2a \\left[ u - \\left(-a\\exp\\left(-\\frac{u}{a}\\right)\\right) \\right]_{0}^{L}\n$$\n$$\n= 2a \\left[ u + a\\exp\\left(-\\frac{u}{a}\\right) \\right]_{0}^{L} = 2a \\left[ \\left( L + a\\exp\\left(-\\frac{L}{a}\\right) \\right) - \\left( 0 + a\\exp(0) \\right) \\right]\n$$\n$$\n= 2a \\left( L + a\\exp\\left(-\\frac{L}{a}\\right) - a \\right) = 2a^2 \\left( \\frac{L}{a} - 1 + \\exp\\left(-\\frac{L}{a}\\right) \\right)\n$$\n现在我们可以写出方差的表达式。$x$ 方向括号中的因子是 $\\frac{1}{L_x^2}I(L_x, a_x)$，$y$ 方向的是 $\\frac{1}{L_y^2}I(L_y, a_y)$。\n$$\n\\frac{I(L_x, a_x)}{L_x^2} = \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right)\n$$\n$$\n\\frac{I(L_y, a_y)}{L_y^2} = \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)\n$$\n将这些因子与 $\\sigma_E^2$ 相乘，得到空间平均值方差的精确、闭式表达式：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\sigma_{E}^{2} \\left[ \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\right] \\left[ \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = 4\\sigma_{E}^{2} \\frac{a_x^2 a_y^2}{L_x^2 L_y^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)\n$$\n这是最终的解析表达式。\n\n对于问题的第二部分，我们分析当平均面积远大于相关长度时（即 $L_x \\gg a_x$ 和 $L_y \\gg a_y$）方差的缩放行为。这对应于极限 $L_x/a_x \\to \\infty$ 和 $L_y/a_y \\to \\infty$。\n让我们考察无量纲项 $\\left( \\frac{L}{a} - 1 + \\exp\\left(-\\frac{L}{a}\\right) \\right)$ 在 $\\frac{L}{a} \\to \\infty$ 时的行为。\n使用指数函数的标准渐近性，$\\lim_{z \\to \\infty} \\exp(-z) = 0$。在我们的例子中，$z=L/a$，所以 $\\exp(-L/a)$ 项消失。\n括号中的表达式变为 $\\left(\\frac{L}{a} - 1\\right)$。对于 $L/a \\gg 1$，这可以很好地近似为 $\\frac{L}{a}$。\n因此，对于 $L_x \\gg a_x$：\n$$\n\\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\approx \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} \\right) = \\frac{2a_x}{L_x}\n$$\n类似地，对于 $L_y \\gg a_y$：\n$$\n\\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right) \\approx \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} \\right) = \\frac{2a_y}{L_y}\n$$\n将这些渐近形式代回 $\\operatorname{Var}(\\bar{E}_{A})$ 的表达式中：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) \\approx \\sigma_{E}^{2} \\left( \\frac{2a_x}{L_x} \\right) \\left( \\frac{2a_y}{L_y} \\right) = \\frac{4\\sigma_{E}^{2} a_x a_y}{L_x L_y}\n$$\n由于平均面积为 $|A| = L_x L_y$，我们有：\n$$\n\\operatorname{Var}(\\bar{E}_{A}) \\approx \\frac{4\\sigma_{E}^{2} a_x a_y}{|A|}\n$$\n这个结果表明，随着平均面积 $|A|$ 的增加，空间平均值的方差 $\\operatorname{Var}(\\bar{E}_{A})$ 与面积成反比减小，即 $\\operatorname{Var}(\\bar{E}_{A}) \\propto |A|^{-1}$。这是相关随机场大数定律的一种体现，其中方差的减小由“相关面积”（与 $a_x a_y$ 相关）与总平均面积的比值决定。", "answer": "$$\n\\boxed{4\\sigma_{E}^{2} \\frac{a_x^2 a_y^2}{L_x^2 L_y^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)}\n$$", "id": "3563295"}, {"introduction": "蒙特卡洛方法是随机有限元法常用的引擎，但其结果是统计估计值。本练习解决了一个基本的实践问题：需要多少次模拟才能使平均沉降等输出达到期望的精度？通过从中心极限定理推导样本量公式，您将学会如何设计随机分析的计算量并证明其合理性。[@problem_id:3563260]", "problem": "一个宽度为 $B$ 的方形浅基础，坐落于弹塑性土层上，使用随机有限元法 (SFEM) 进行分析，其中杨氏模量场的空间变异性被建模为具有有限方差和有限四阶矩的二阶平稳随机场。每次蒙特卡洛 (MC) 实现都会对一个独立的场进行抽样，求解有限元法 (FEM) 边值问题，并输出基础中心的沉降 $S$。设 $S$ 是一个具有有限均值 $\\mu_{s}$ 和方差 $\\sigma_{s}^{2}$ 的正随机变量。将平均沉降和方差的 MC 估计量定义为样本均值 $\\bar{S}_{N}$ 和根据 $N$ 次独立 FEM 实现计算出的贝塞尔校正样本方差 $\\hat{\\sigma}_{s,N}^{2}$。\n\n您需要选择 MC 样本量 $N$，使得平均沉降估计量的相对误差满足以下要求：在置信度为 $1-\\alpha$ 的情况下，$\\mu_{s}$ 的双侧置信区间的半宽度不大于 $\\epsilon\\,|\\mu_{s}|$。假设中心极限定理 (CLT) 适用于 $\\bar{S}_{N}$，并且 $S$ 的分布具有有限四阶矩，因此贝塞尔校正样本方差是 $\\sigma_{s}^{2}$ 的一致估计量。为了使 $N$ 的选择具有可操作性，您进行了一次包含 $M$ 次独立实现的初步试验，以获得初步估计值 $\\hat{\\mu}_{s,M}$ 和 $\\hat{\\sigma}_{s,M}$。\n\n仅从 MC 估计量的定义、实现的独立性和 CLT 出发，推导所需样本量 $N$ 的闭式表达式，该表达式用标准正态分布的分位数 $z_{1-\\alpha/2}$、相对误差目标 $\\epsilon$ 以及初步估计值 $\\hat{\\mu}_{s,M}$ 和 $\\hat{\\sigma}_{s,M}$ 来表示。您的表达式必须通过限制基于 CLT 的置信区间的半宽度来强制满足置信度要求，并且必须考虑到 $N$ 的整数性质。\n\n将您的最终答案表示为 $N$ 的单一解析表达式。不需要进行数值计算。如果您引入任何辅助符号，请明确定义它们。不允许使用任何中间公式或简化公式。最终答案中不需要单位。", "solution": "该问题被认为是有效的，因为它在概率论和统计学方面具有科学依据，问题陈述清晰，客观，并包含足够的信息以获得唯一解。在计算岩土力学中使用随机有限元法 (SFEM) 的背景是恰当的，并且所提供的假设（中心极限定理的适用性，估计量的一致性）对于这类分析是标准的。\n\n目标是推导所需蒙特卡洛实现次数 $N$ 的表达式，以便在指定的精度和置信度下估计平均沉降 $\\mu_s$。\n\n设 $S_1, S_2, \\ldots, S_N$ 是从 $N$ 次独立同分布 (i.i.d.) 的有限元法 (FEM) 实现中获得的沉降值序列。每个 $S_i$ 都是从一个分布中抽取的随机变量，其真实均值为 $E[S_i] = \\mu_s$，真实方差为 $\\text{Var}(S_i) = \\sigma_s^2$。问题指出 $S$ 是一个正随机变量，这意味着 $\\mu_s > 0$。\n\n平均沉降 $\\mu_s$ 的蒙特卡洛估计量是样本均值 $\\bar{S}_N$，定义为：\n$$ \\bar{S}_N = \\frac{1}{N} \\sum_{i=1}^{N} S_i $$\n\n该估计量的期望值为：\n$$ E[\\bar{S}_N] = E\\left[\\frac{1}{N} \\sum_{i=1}^{N} S_i\\right] = \\frac{1}{N} \\sum_{i=1}^{N} E[S_i] = \\frac{1}{N} (N \\mu_s) = \\mu_s $$\n因此，$\\bar{S}_N$ 是 $\\mu_s$ 的无偏估计量。\n\n利用样本的独立同分布特性，该估计量的方差为：\n$$ \\text{Var}(\\bar{S}_N) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} S_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\text{Var}(S_i) = \\frac{1}{N^2} (N \\sigma_s^2) = \\frac{\\sigma_s^2}{N} $$\n样本均值的标准差，也称为标准误差，是 $\\text{SE}(\\bar{S}_N) = \\frac{\\sigma_s}{\\sqrt{N}}$。\n\n根据假设适用的中心极限定理 (CLT)，对于足够大的样本量 $N$，标准化样本均值的分布收敛于标准正态分布：\n$$ Z = \\frac{\\bar{S}_N - \\mu_s}{\\text{SE}(\\bar{S}_N)} = \\frac{\\bar{S}_N - \\mu_s}{\\sigma_s / \\sqrt{N}} \\xrightarrow{d} \\mathcal{N}(0,1) $$\n其中 $\\mathcal{N}(0,1)$ 表示标准正态分布。\n\n这个关系用于构建置信水平为 $1-\\alpha$ 的 $\\mu_s$ 的双侧置信区间。设 $z_{1-\\alpha/2}$ 是标准正态分布的上 $1-\\alpha/2$ 分位数，定义为 $P(Z \\le z_{1-\\alpha/2}) = 1-\\alpha/2$，或等价地，$P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha$。\n\n根据 CLT，我们可以陈述近似概率：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\bar{S}_N - \\mu_s}{\\sigma_s / \\sqrt{N}} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\n重新整理不等式以分离出真实均值 $\\mu_s$，得到置信区间：\n$$ P\\left(\\bar{S}_N - z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} \\le \\mu_s \\le \\bar{S}_N + z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}}\\right) \\approx 1-\\alpha $$\n该置信区间的半宽度 $H$ 为：\n$$ H = z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} $$\n\n问题要求这个半宽度不大于真实均值绝对值的一个分数 $\\epsilon$，即 $\\epsilon |\\mu_s|$。由于沉降 $S$ 是一个正随机变量，其均值 $\\mu_s$ 也是正的，所以 $|\\mu_s| = \\mu_s$。因此要求是：\n$$ H \\le \\epsilon \\mu_s $$\n代入 $H$ 的表达式：\n$$ z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} \\le \\epsilon \\mu_s $$\n\n为了找到所需的最小样本量 $N$，我们对这个不等式求解 $N$：\n$$ \\sqrt{N} \\ge \\frac{z_{1-\\alpha/2} \\sigma_s}{\\epsilon \\mu_s} $$\n$$ N \\ge \\left( \\frac{z_{1-\\alpha/2} \\sigma_s}{\\epsilon \\mu_s} \\right)^2 $$\n\n这个所需样本量的表达式依赖于未知的总体参数 $\\mu_s$ 和 $\\sigma_s$。为了使其具有可操作性，我们使用从一个样本量为 $M$ 的初步研究中获得的这些参数的估计值。问题提供了初步估计值 $\\hat{\\mu}_{s,M}$ 和 $\\hat{\\sigma}_{s,M}$。问题指出贝塞尔校正样本方差是一个一致估计量，这意味着 $\\hat{\\sigma}_{s,M}$ 是 $\\sigma_s$ 的一个一致估计量。样本均值 $\\hat{\\mu}_{s,M}$ 也是 $\\mu_s$ 的一个一致估计量。\n\n我们将这些初步估计值代入不等式中：\n$$ N \\ge \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^2 $$\n\n由于实现次数 $N$ 必须是整数，我们必须选择满足此条件的最小整数。这可以通过对不等式右侧取上整来实现。上取整函数，记为 $\\lceil x \\rceil$，给出大于或等于 $x$ 的最小整数。\n\n因此，所需样本量 $N$ 的最终表达式为：\n$$ N = \\left\\lceil \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^2 \\right\\rceil $$\n该表达式根据初步研究的信息，提供了为满足指定精度和置信度要求所需的最小蒙特卡洛实现次数。", "answer": "$$\n\\boxed{\nN = \\left\\lceil \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^{2} \\right\\rceil\n}\n$$", "id": "3563260"}]}