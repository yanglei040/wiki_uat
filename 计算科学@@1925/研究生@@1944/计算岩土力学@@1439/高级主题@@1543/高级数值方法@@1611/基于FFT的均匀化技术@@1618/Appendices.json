{"hands_on_practices": [{"introduction": "基于FFT的方法其核心在于利用傅里叶空间中的乘法运算来替代真实空间中的微分运算。这个练习将引导您推导对称梯度算子的离散傅里叶形式，并通过一个光滑的单模场来验证其精确性。通过这个实践[@problem_id:3524687]，您将亲身体会到谱方法在处理周期性光滑函数时所具有的卓越精度，这是该方法的一个核心优势。", "problem": "考虑一个在计算岩土力学中使用的小应变假设下的周期性代表性体积单元 (RVE) $\\Omega=[0,L]^{3}$，其中的应变定义为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{x})=\\mathrm{sym}\\,\\nabla\\boldsymbol{u}(\\boldsymbol{x})=\\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u}(\\boldsymbol{x})+\\nabla\\boldsymbol{u}(\\boldsymbol{x})^{\\top}\\right)$。设位移场 $\\boldsymbol{u}:\\Omega\\rightarrow\\mathbb{R}^{3}$ 是光滑且周期的。快速傅里叶变换 (FFT) 用于在傅里叶空间中对离散网格进行操作，以近似空间梯度。该网格每个方向有 $N$ 个等距点，网格间距为 $h=L/N$，离散波矢量为 $\\boldsymbol{k}=\\frac{2\\pi}{L}\\boldsymbol{m}$，其中 $\\boldsymbol{m}\\in\\{-\\frac{N}{2},\\ldots,\\frac{N}{2}-1\\}^{3}$。\n\n从傅里叶变换的连续定义及其微分性质出发，推导作用于位移场的对称梯度算子的傅里叶空间表示，以及其在基于 FFT 的均匀化方法中使用的离散对应形式。然后，考虑一个特定的光滑周期性测试场\n$$\n\\boldsymbol{u}(\\boldsymbol{x})=\\boldsymbol{A}\\,\\exp\\!\\left(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}\\right),\n$$\n其中 $\\boldsymbol{A}\\in\\mathbb{C}^{3}$ 是一个恒定振幅矢量，$\\boldsymbol{q}=\\frac{2\\pi}{L}\\boldsymbol{m}_{0}$（其中 $\\boldsymbol{m}_{0}\\in\\{-\\frac{N}{2}+1,\\ldots,\\frac{N}{2}-1\\}^{3}$）是一个严格低于奈奎斯特极限的单一容许离散波矢量。使用推导出的离散傅里叶空间算子，计算离散逆变换以获得该 $\\boldsymbol{u}(\\boldsymbol{x})$ 的物理空间应变场 $\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x})$，并将其与精确的连续应变 $\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x})$ 进行比较。\n\n通过 Frobenius 范数定义逐点一致性误差大小\n$$\nE(\\boldsymbol{x})=\\left\\|\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x})-\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x})\\right\\|_{F}.\n$$\n对于上述测试场，计算所有 $\\boldsymbol{x}\\in\\Omega$ 处的 $E(\\boldsymbol{x})$，并将其值以单个无量纲标量的形式给出。如果需要数值近似，则四舍五入到四位有效数字；然而，在本问题中，请给出精确值。", "solution": "该问题要求评估针对特定光滑周期位移场的基于 FFT 的应变计算的一致性误差。对问题陈述的验证表明，该问题在科学上是合理的、适定的，并包含了所有必要信息。我们可以开始求解。\n\n首先，我们推导对称梯度算子在连续傅里叶空间中的表示。应变张量 $\\boldsymbol{\\varepsilon}(\\boldsymbol{x})$ 定义为位移梯度 $\\nabla\\boldsymbol{u}(\\boldsymbol{x})$ 的对称部分：\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\frac{1}{2}\\left(\\nabla\\boldsymbol{u}(\\boldsymbol{x}) + (\\nabla\\boldsymbol{u}(\\boldsymbol{x}))^{\\top}\\right)\n$$\n设 $\\hat{f}(\\boldsymbol{k})$ 表示函数 $f(\\boldsymbol{x})$ 的傅里叶变换。傅里叶变换的一个基本性质是它将微分运算转换为乘法运算。具体来说，偏导数 $\\frac{\\partial}{\\partial x_j} f(\\boldsymbol{x})$ 的傅里叶变换是 $i k_j \\hat{f}(\\boldsymbol{k})$，其中 $\\boldsymbol{k}$ 是波矢量。将此性质逐分量地应用于矢量场 $\\boldsymbol{u}(\\boldsymbol{x})$ 的梯度，我们得到：\n$$\n\\mathcal{F}\\left[ (\\nabla \\boldsymbol{u})_{ij} \\right](\\boldsymbol{k}) = \\mathcal{F}\\left[ \\frac{\\partial u_i}{\\partial x_j} \\right](\\boldsymbol{k}) = i k_j \\hat{u}_i(\\boldsymbol{k})\n$$\n用张量表示法，这可以写成 $\\mathcal{F}[\\nabla\\boldsymbol{u}](\\boldsymbol{k}) = i \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\otimes \\boldsymbol{k}$。将傅里叶变换应用于应变定义并利用其线性性质，我们得到应变张量的傅里叶空间表示 $\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k})$：\n$$\n\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k}) = \\frac{1}{2}\\left( \\mathcal{F}[\\nabla\\boldsymbol{u}](\\boldsymbol{k}) + \\mathcal{F}[(\\nabla\\boldsymbol{u})^\\top](\\boldsymbol{k}) \\right)\n$$\n转置 $(\\nabla\\boldsymbol{u})^\\top$ 的傅里叶变换是变换后梯度的转置，但波矢量和场的下标进行了交换。具体来说，$\\mathcal{F}[(\\nabla\\boldsymbol{u})^\\top]_{ij}(\\boldsymbol{k}) = \\mathcal{F}[(\\nabla\\boldsymbol{u})_{ji}](\\boldsymbol{k}) = i k_i \\hat{u}_j(\\boldsymbol{k})$。这对应于张量 $i \\boldsymbol{k} \\otimes \\hat{\\boldsymbol{u}}(\\boldsymbol{k})$。因此，\n$$\n\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k}) = \\frac{i}{2}\\left( i \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\otimes \\boldsymbol{k} + i \\boldsymbol{k} \\otimes \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\right) = \\frac{i}{2}\\left( \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\otimes \\boldsymbol{k} + \\boldsymbol{k} \\otimes \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\right)\n$$\n用分量形式表示：\n$$\n\\hat{\\varepsilon}_{ij}(\\boldsymbol{k}) = \\frac{i}{2}\\left( \\hat{u}_i(\\boldsymbol{k}) k_j + \\hat{u}_j(\\boldsymbol{k}) k_i \\right)\n$$\n基于 FFT 的均匀化方法使用此关系的离散版本。一个定义在 $N^3$ 个点组成的网格上的场，通过离散傅里叶变换 (DFT) 进行变换，然后对每个离散波矢量 $\\boldsymbol{k}$ 执行上述代数运算，最后使用离散傅里叶逆变换 (IDFT) 将结果变换回物理空间。\n\n接下来，我们计算给定测试位移场 $\\boldsymbol{u}(\\boldsymbol{x})=\\boldsymbol{A}\\,\\exp\\!\\left(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}\\right)$ 的精确应变场 $\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x})$，其中 $\\boldsymbol{A}$ 是一个常矢量。我们计算梯度 $\\nabla\\boldsymbol{u}(\\boldsymbol{x})$：\n$$\n(\\nabla\\boldsymbol{u})_{ij}(\\boldsymbol{x}) = \\frac{\\partial u_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( A_i \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}) \\right) = A_i (i q_j) \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x})\n$$\n所以，$\\nabla\\boldsymbol{u}(\\boldsymbol{x}) = i (\\boldsymbol{A} \\otimes \\boldsymbol{q}) \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}) = i \\boldsymbol{u}(\\boldsymbol{x}) \\otimes \\boldsymbol{q}$。\n其对称部分为：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x}) = \\frac{1}{2} \\left[ i \\boldsymbol{u}(\\boldsymbol{x}) \\otimes \\boldsymbol{q} + (i \\boldsymbol{u}(\\boldsymbol{x}) \\otimes \\boldsymbol{q})^\\top \\right] = \\frac{i}{2} \\left[ \\boldsymbol{u}(\\boldsymbol{x}) \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{u}(\\boldsymbol{x}) \\right]\n$$\n将 $\\boldsymbol{u}(\\boldsymbol{x})$ 代回：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x}) = \\frac{i}{2} \\left[ (\\boldsymbol{A} \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x})) \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes (\\boldsymbol{A} \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x})) \\right] = \\frac{i}{2} \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}) \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right)\n$$\n\n现在，我们使用离散的基于 FFT 的程序来计算应变场 $\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x})$。该程序如下：\n1.  计算在网格点 $\\boldsymbol{x}_{\\boldsymbol{p}} = (L/N)\\boldsymbol{p}$（其中 $\\boldsymbol{p} \\in \\{0, \\dots, N-1\\}^3$）上的 $\\boldsymbol{u}(\\boldsymbol{x})$ 的 DFT。\n离散波矢量 $\\boldsymbol{k} = (2\\pi/L)\\boldsymbol{m}$ 的 DFT 系数 $\\hat{\\boldsymbol{u}}(\\boldsymbol{k})$ 由下式给出：\n$$\n\\hat{\\boldsymbol{u}}(\\boldsymbol{k}) = \\sum_{\\boldsymbol{p}=\\{0..N-1\\}^3} \\boldsymbol{u}(\\boldsymbol{x}_{\\boldsymbol{p}}) \\exp(-i \\boldsymbol{k} \\cdot \\boldsymbol{x}_{\\boldsymbol{p}}) = \\sum_{\\boldsymbol{p}} \\boldsymbol{A} \\exp(i \\boldsymbol{q} \\cdot \\boldsymbol{x}_{\\boldsymbol{p}}) \\exp(-i \\boldsymbol{k} \\cdot \\boldsymbol{x}_{\\boldsymbol{p}})\n$$\n$$\n\\hat{\\boldsymbol{u}}(\\boldsymbol{k}) = \\boldsymbol{A} \\sum_{\\boldsymbol{p}} \\exp(i (\\boldsymbol{q}-\\boldsymbol{k}) \\cdot \\boldsymbol{x}_{\\boldsymbol{p}}) = \\boldsymbol{A} \\sum_{\\boldsymbol{p}} \\exp\\left(i \\frac{2\\pi}{N}(\\boldsymbol{m}_0-\\boldsymbol{m})\\cdot\\boldsymbol{p}\\right)\n$$\n仅当 $\\boldsymbol{m}_0 - \\boldsymbol{m}$ 在每个分量上都是 $N$ 的倍数时，求和项 $\\sum_{\\boldsymbol{p}} \\exp(i \\frac{2\\pi}{N}(\\boldsymbol{m}_0-\\boldsymbol{m})\\cdot\\boldsymbol{p})$ 才不为零。由于 $\\boldsymbol{m}$ 和 $\\boldsymbol{m}_0$ 都在范围 $\\{-\\frac{N}{2}, \\ldots, \\frac{N}{2}-1\\}^3$ 内（$\\boldsymbol{m}_0$ 的范围甚至更小），它们的差在 $\\{-(N-1), \\dots, N-1\\}^3$ 范围内。在此范围内，$N$ 的唯一倍数是 $0$。因此，仅当 $\\boldsymbol{m} = \\boldsymbol{m}_0$（即 $\\boldsymbol{k}=\\boldsymbol{q}$）时，求和项才不为零。在这种情况下，指数项为 $1$，求和结果等于 $N^3$。\n因此，该测试场的 DFT 只有一个非零系数：\n$$\n\\hat{\\boldsymbol{u}}(\\boldsymbol{k}) = N^3 \\boldsymbol{A} \\delta_{\\boldsymbol{k},\\boldsymbol{q}}\n$$\n其中 $\\delta_{\\boldsymbol{k},\\boldsymbol{q}}$ 是克罗内克 δ。\n\n2.  在傅里叶空间中应用离散对称梯度算子。\n$$\n\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k}) = \\frac{i}{2} \\left( \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\otimes \\boldsymbol{k} + \\boldsymbol{k} \\otimes \\hat{\\boldsymbol{u}}(\\boldsymbol{k}) \\right)\n$$\n由于除了在 $\\boldsymbol{k}=\\boldsymbol{q}$ 处，$\\hat{\\boldsymbol{u}}(\\boldsymbol{k})$ 处处为零，所以 $\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k})$ 也除了在 $\\boldsymbol{k}=\\boldsymbol{q}$ 处，处处为零。在 $\\boldsymbol{k}=\\boldsymbol{q}$ 处：\n$$\n\\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{q}) = \\frac{i}{2} \\left( (N^3 \\boldsymbol{A}) \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes (N^3 \\boldsymbol{A}) \\right) = N^3 \\frac{i}{2} \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right)\n$$\n\n3.  计算离散傅里叶逆变换以返回物理空间。IDFT 定义为：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) = \\frac{1}{N^3} \\sum_{\\boldsymbol{m}} \\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{k}_{\\boldsymbol{m}}) \\exp(i \\boldsymbol{k}_{\\boldsymbol{m}} \\cdot \\boldsymbol{x})\n$$\n该求和对于 $\\boldsymbol{m}=\\boldsymbol{m}_0$（即 $\\boldsymbol{k}=\\boldsymbol{q}$）简化为单项：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) = \\frac{1}{N^3} \\hat{\\boldsymbol{\\varepsilon}}(\\boldsymbol{q}) \\exp(i \\boldsymbol{q} \\cdot \\boldsymbol{x}) = \\frac{1}{N^3} \\left[ N^3 \\frac{i}{2} \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right) \\right] \\exp(i \\boldsymbol{q} \\cdot \\boldsymbol{x})\n$$\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) = \\frac{i}{2} \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right) \\exp(i \\boldsymbol{q} \\cdot \\boldsymbol{x})\n$$\n这个表达式定义了穿过从 IDFT 获得的网格点值的三角插值函数。\n\n最后，我们评估逐点一致性误差 $E(\\boldsymbol{x})$。比较精确应变和基于 FFT 的应变的表达式：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x}) = \\frac{i}{2} \\exp(i\\,\\boldsymbol{q}\\cdot\\boldsymbol{x}) \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right)\n$$\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) = \\frac{i}{2} \\left( \\boldsymbol{A} \\otimes \\boldsymbol{q} + \\boldsymbol{q} \\otimes \\boldsymbol{A} \\right) \\exp(i \\boldsymbol{q} \\cdot \\boldsymbol{x})\n$$\n这两个表达式是相同的。这是因为测试函数是一个单一的傅里叶模式，它可以被离散网格完美表示，并且不处于奈奎斯特频率。对于此类函数，伪谱微分是精确的。\n差值为零张量：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) - \\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x}) = \\boldsymbol{0}\n$$\n一致性误差大小是此差值的 Frobenius 范数：\n$$\nE(\\boldsymbol{x}) = \\left\\|\\boldsymbol{\\varepsilon}_{\\mathrm{FFT}}(\\boldsymbol{x}) - \\boldsymbol{\\varepsilon}_{\\mathrm{exact}}(\\boldsymbol{x})\\right\\|_{F} = \\|\\boldsymbol{0}\\|_{F} = \\sqrt{\\sum_{i=1}^3 \\sum_{j=1}^3 |0_{ij}|^2} = 0\n$$\n对于所有 $\\boldsymbol{x}\\in\\Omega$，误差均为 $0$。问题要求将此值作为一个无量纲标量给出。", "answer": "$$\n\\boxed{0}\n$$", "id": "3524687"}, {"introduction": "Hill-Mandel条件是连接微观尺度能量耗散与宏观尺度能量耗散的基本桥梁，是任何有效均质化理论的基石。本练习[@problem_id:3524646]要求您首先从基本原理出发推导这一重要条件。随后，您将使用一组给定的数值模拟数据来验证该条件，从而加深对均质化过程中能量守恒性的理解。", "problem": "考虑一个岩土材料的二维平面应变周期性代表体积单元 (RVE)，该单元在一个与基于快速傅里叶变换 (FFT) 的求解器一致的均匀配置网格上进行离散。微观位移场在周期性边界条件下是运动学容许的，微观应力场在周期性面力下是静力学容许的。设微观小应变张量用 $\\boldsymbol{\\varepsilon}(\\boldsymbol{x})$ 表示，微观柯西应力张量用 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$ 表示。宏观应变 $\\boldsymbol{E}$ 和宏观应力 $\\boldsymbol{\\Sigma}$ 定义为周期性边界条件下微观场的体积平均。局部应力功率密度为 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$，其中对称 $2\\times 2$ 张量的双点积为 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\sigma_{11}\\varepsilon_{11} + \\sigma_{22}\\varepsilon_{22} + 2\\,\\sigma_{12}\\varepsilon_{12}$。\n\n仅从运动学容许性 $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$（其中 $\\tilde{\\boldsymbol{u}}$ 是周期性的）、静力学容许性 $\\nabla\\cdot\\boldsymbol{\\sigma}(\\boldsymbol{x})=\\boldsymbol{0}$（在周期性单元边界上具有周期性面力）以及微观功率密度的定义出发，推导周期性均匀化的宏观能量平衡恒等式。然后，使用给定的离散场，计算标量差异\n$$\\delta \\equiv \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle - \\boldsymbol{\\Sigma}:\\boldsymbol{E},$$\n其中离散体积平均 $\\langle \\cdot \\rangle$ 是在所有配置点上的均匀算术平均（等权重，与周期性积分的梯形法则一致）。\n\n对于一个具有 $2\\times 2$ 个配置点 $p=1,2,3,4$ 的单元胞，从一个收敛的基于 FFT 的均匀化步骤中得到的数据如下。宏观应变分量为 $E_{11}=0.010$, $E_{22}=-0.005$, $E_{12}=0.004$。宏观应力分量为 $\\Sigma_{11}=120$ MPa, $\\Sigma_{22}=60$ MPa, $\\Sigma_{12}=40$ MPa。四个等权重配置点处的微观对称应变和应力分量为：\n- 在点 $p=1$ 处：$\\varepsilon_{11}^{(1)}=0.012$, $\\varepsilon_{22}^{(1)}=-0.005$, $\\varepsilon_{12}^{(1)}=0.005$；$\\sigma_{11}^{(1)}=130$ MPa, $\\sigma_{22}^{(1)}=60$ MPa, $\\sigma_{12}^{(1)}=45$ MPa。\n- 在点 $p=2$ 处：$\\varepsilon_{11}^{(2)}=0.008$, $\\varepsilon_{22}^{(2)}=-0.005$, $\\varepsilon_{12}^{(2)}=0.003$；$\\sigma_{11}^{(2)}=110$ MPa, $\\sigma_{22}^{(2)}=60$ MPa, $\\sigma_{12}^{(2)}=45$ MPa。\n- 在点 $p=3$ 处：$\\varepsilon_{11}^{(3)}=0.010$, $\\varepsilon_{22}^{(3)}=-0.002$, $\\varepsilon_{12}^{(3)}=0.003$；$\\sigma_{11}^{(3)}=120$ MPa, $\\sigma_{22}^{(3)}=\\frac{160}{3}$ MPa, $\\sigma_{12}^{(3)}=35$ MPa。\n- 在点 $p=4$ 处：$\\varepsilon_{11}^{(4)}=0.010$, $\\varepsilon_{22}^{(4)}=-0.008$, $\\varepsilon_{12}^{(4)}=0.005$；$\\sigma_{11}^{(4)}=120$ MPa, $\\sigma_{22}^{(4)}=\\frac{200}{3}$ MPa, $\\sigma_{12}^{(4)}=35$ MPa。\n\n使用离散平均计算 $\\delta$，并以 MPa 为单位表示您的最终答案。不要假设任何超出所述内容的附加本构关系。您的最终答案必须是一个实数。如果需要四舍五入，则保留四位有效数字。否则，报告数据所隐含的精确值。", "solution": "该问题要求完成两项任务：首先，推导周期性均匀化的宏观能量平衡恒等式；其次，使用数值模拟提供的离散数据计算特定的标量差异 $\\delta$。\n\n宏观能量平衡恒等式，也称为 Hill-Mandel 条件，将微观应力功率的体积平均与宏观应力功率联系起来。我们从给定的定义和容许性条件开始推导。在体积为 $V$ 的代表体积单元 (RVE) 上，微观应力功率密度 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 的体积平均由 $\\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\frac{1}{V}\\int_V \\boldsymbol{\\sigma}(\\boldsymbol{x}):\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) \\,dV$ 给出。\n\n微观位移场 $\\boldsymbol{u}(\\boldsymbol{x})$ 是运动学容许的，并由分解式 $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$ 给出，其中 $\\boldsymbol{E}$ 是恒定的宏观应变张量，$\\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$ 是一个周期性扰动场。微观小应变张量 $\\boldsymbol{\\varepsilon}(\\boldsymbol{x})$ 是位移梯度的对称部分：\n$$ \\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\frac{1}{2}\\left(\\nabla\\boldsymbol{u}(\\boldsymbol{x}) + (\\nabla\\boldsymbol{u}(\\boldsymbol{x}))^T\\right) $$\n代入位移分解式，梯度为 $\\nabla\\boldsymbol{u} = \\nabla(\\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}) = \\boldsymbol{E} + \\nabla\\tilde{\\boldsymbol{u}}$。应变张量变为：\n$$ \\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\frac{1}{2}\\left( (\\boldsymbol{E} + \\nabla\\tilde{\\boldsymbol{u}}) + (\\boldsymbol{E} + \\nabla\\tilde{\\boldsymbol{u}})^T \\right) = \\frac{1}{2}(\\boldsymbol{E} + \\boldsymbol{E}^T) + \\frac{1}{2}(\\nabla\\tilde{\\boldsymbol{u}} + (\\nabla\\tilde{\\boldsymbol{u}})^T) $$\n由于应变张量 $\\boldsymbol{E}$ 是对称的（$\\boldsymbol{E} = \\boldsymbol{E}^T$），这可以简化为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\boldsymbol{E} + \\tilde{\\boldsymbol{\\varepsilon}}(\\boldsymbol{x})$，其中 $\\tilde{\\boldsymbol{\\varepsilon}}(\\boldsymbol{x}) = \\frac{1}{2}(\\nabla\\tilde{\\boldsymbol{u}} + (\\nabla\\tilde{\\boldsymbol{u}})^T)$ 是应变扰动。\n\n现在，我们将此应变分解式代入平均微观功率的表达式中：\n$$ \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\frac{1}{V}\\int_V \\boldsymbol{\\sigma}:(\\boldsymbol{E} + \\tilde{\\boldsymbol{\\varepsilon}}) \\, dV = \\frac{1}{V}\\int_V \\boldsymbol{\\sigma}:\\boldsymbol{E} \\, dV + \\frac{1}{V}\\int_V \\boldsymbol{\\sigma}:\\tilde{\\boldsymbol{\\varepsilon}} \\, dV $$\n在第一项中，由于 $\\boldsymbol{E}$ 是一个常数张量，它可以被提到积分外面：\n$$ \\frac{1}{V}\\int_V \\boldsymbol{\\sigma}:\\boldsymbol{E} \\, dV = \\left(\\frac{1}{V}\\int_V \\boldsymbol{\\sigma} \\, dV\\right):\\boldsymbol{E} = \\langle\\boldsymbol{\\sigma}\\rangle:\\boldsymbol{E} $$\n根据定义，宏观应力为 $\\boldsymbol{\\Sigma} = \\langle\\boldsymbol{\\sigma}\\rangle$。因此，第一项正是宏观应力功率 $\\boldsymbol{\\Sigma}:\\boldsymbol{E}$。这得到：\n$$ \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\boldsymbol{\\Sigma}:\\boldsymbol{E} + \\langle \\boldsymbol{\\sigma}:\\tilde{\\boldsymbol{\\varepsilon}} \\rangle $$\n宏观能量平衡恒等式 $\\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\boldsymbol{\\Sigma}:\\boldsymbol{E}$ 成立，当且仅当第二项为零：$\\langle \\boldsymbol{\\sigma}:\\tilde{\\boldsymbol{\\varepsilon}} \\rangle = 0$。让我们证明这一项为零。使用指标表示法（对重复指标求和）：\n$$ \\langle \\boldsymbol{\\sigma}:\\tilde{\\boldsymbol{\\varepsilon}} \\rangle = \\frac{1}{V}\\int_V \\sigma_{ij}\\tilde{\\varepsilon}_{ij} \\, dV = \\frac{1}{V}\\int_V \\sigma_{ij}\\tilde{u}_{i,j} \\, dV $$\n其中我们利用了应力张量的对称性 $\\sigma_{ij} = \\sigma_{ji}$ 和 $\\tilde{\\varepsilon}_{ij} = \\frac{1}{2}(\\tilde{u}_{i,j} + \\tilde{u}_{j,i})$ 的定义。\n使用分部积分（或散度定理）：\n$$ \\int_V \\sigma_{ij}\\tilde{u}_{i,j} \\,dV = \\int_V (\\sigma_{ij}\\tilde{u}_i)_{,j} \\,dV - \\int_V \\sigma_{ij,j}\\tilde{u}_i \\,dV $$\n微观应力场是静力学容许的，意味着它在没有体力的情况下满足平衡方程：$\\nabla\\cdot\\boldsymbol{\\sigma} = \\boldsymbol{0}$，或 $\\sigma_{ij,j}=0$。因此，第二个体积分消失。对第一个积分应用散度定理：\n$$ \\int_V (\\sigma_{ij}\\tilde{u}_i)_{,j} \\,dV = \\int_{\\partial V} \\sigma_{ij}\\tilde{u}_i n_j \\,dS $$\n其中 $\\partial V$ 是 RVE 的边界，$\\boldsymbol{n}$ 是其外向单位法向量。项 $\\sigma_{ij}n_j$ 是作用在边界上的面力矢量 $t_i$。该积分变为 $\\int_{\\partial V} t_i\\tilde{u}_i \\,dS$。\n由于 RVE 的周期性，边界 $\\partial V$ 由成对的相对面组成，在这些面上，面力是反周期的（一个面上的 $t_i$ 是对面上的 $-t_i$），而扰动位移 $\\tilde{u}_i$ 是周期的。在整个边界 $\\partial V$ 上的积分是这些成对面上积分的总和。对于任何一对相对面，其贡献相互抵消，导致 $\\int_{\\partial V} t_i\\tilde{u}_i \\,dS = 0$。\n因此，$\\langle \\boldsymbol{\\sigma}:\\tilde{\\boldsymbol{\\varepsilon}} \\rangle = 0$，这就完成了宏观能量平衡恒等式的推导：\n$$ \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\boldsymbol{\\Sigma}:\\boldsymbol{E} $$\n这个恒等式就是我们现在必须进行数值验证的。差异定义为 $\\delta \\equiv \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle - \\boldsymbol{\\Sigma}:\\boldsymbol{E}$。理论上，对于一个完全收敛的理想解，$\\delta$ 必须为零。\n\n接下来，我们使用提供的离散数据计算差异的两项。离散平均 $\\langle \\cdot \\rangle$ 是算术平均值。\n\n首先，我们计算宏观应力功率 $\\boldsymbol{\\Sigma}:\\boldsymbol{E}$：\n$\\boldsymbol{\\Sigma}:\\boldsymbol{E} = \\Sigma_{11}E_{11} + \\Sigma_{22}E_{22} + 2 \\Sigma_{12}E_{12}$。\n使用给定的宏观值：\n$E_{11}=0.010$, $E_{22}=-0.005$, $E_{12}=0.004$。\n$\\Sigma_{11}=120$ MPa, $\\Sigma_{22}=60$ MPa, $\\Sigma_{12}=40$ MPa。\n$$ \\boldsymbol{\\Sigma}:\\boldsymbol{E} = (120)(0.010) + (60)(-0.005) + 2(40)(0.004) $$\n$$ \\boldsymbol{\\Sigma}:\\boldsymbol{E} = 1.2 - 0.3 + 0.32 = 1.22 \\, \\text{MPa} $$\n\n其次，我们计算平均微观应力功率 $\\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\frac{1}{4} \\sum_{p=1}^{4} (\\boldsymbol{\\sigma}^{(p)}:\\boldsymbol{\\varepsilon}^{(p)})$。\n我们计算 4 个配置点中每个点的微观应力功率 $W^{(p)} = \\sigma_{11}^{(p)}\\varepsilon_{11}^{(p)} + \\sigma_{22}^{(p)}\\varepsilon_{22}^{(p)} + 2\\sigma_{12}^{(p)}\\varepsilon_{12}^{(p)}$。\n\n对于点 $p=1$：\n$W^{(1)} = (130)(0.012) + (60)(-0.005) + 2(45)(0.005) = 1.56 - 0.30 + 0.45 = 1.71$ MPa。\n\n对于点 $p=2$：\n$W^{(2)} = (110)(0.008) + (60)(-0.005) + 2(45)(0.003) = 0.88 - 0.30 + 0.27 = 0.85$ MPa。\n\n对于点 $p=3$：\n$W^{(3)} = (120)(0.010) + \\left(\\frac{160}{3}\\right)(-0.002) + 2(35)(0.003) = 1.2 - \\frac{0.32}{3} + 0.21 = 1.41 - \\frac{0.32}{3}$。\n$W^{(3)} = \\frac{141}{100} - \\frac{32}{300} = \\frac{423}{300} - \\frac{32}{300} = \\frac{391}{300}$ MPa。\n\n对于点 $p=4$：\n$W^{(4)} = (120)(0.010) + \\left(\\frac{200}{3}\\right)(-0.008) + 2(35)(0.005) = 1.2 - \\frac{1.6}{3} + 0.35 = 1.55 - \\frac{1.6}{3}$。\n$W^{(4)} = \\frac{155}{100} - \\frac{160}{300} = \\frac{465}{300} - \\frac{160}{300} = \\frac{305}{300}$ MPa。\n\n现在，我们将这些值相加并计算平均值：\n$$ \\sum_{p=1}^{4} W^{(p)} = 1.71 + 0.85 + \\frac{391}{300} + \\frac{305}{300} = 2.56 + \\frac{696}{300} $$\n将所有数转换为分母为 300 的分数：\n$1.71 = \\frac{171}{100} = \\frac{513}{300}$。\n$0.85 = \\frac{85}{100} = \\frac{255}{300}$。\n$$ \\sum_{p=1}^{4} W^{(p)} = \\frac{513}{300} + \\frac{255}{300} + \\frac{391}{300} + \\frac{305}{300} = \\frac{513+255+391+305}{300} = \\frac{1464}{300} $$\n平均值为：\n$$ \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle = \\frac{1}{4} \\left( \\frac{1464}{300} \\right) = \\frac{366}{300} = \\frac{122}{100} = 1.22 \\, \\text{MPa} $$\n\n最后，我们计算差异 $\\delta$：\n$$ \\delta = \\langle \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\rangle - \\boldsymbol{\\Sigma}:\\boldsymbol{E} = 1.22 - 1.22 = 0 \\, \\text{MPa} $$\n差异恰好为零，这证实了所提供的离散场数据与 Hill-Mandel 条件完全一致，正如从一个保持此恒等式的数值格式得到的收敛解所预期的那样。", "answer": "$$\\boxed{0}$$", "id": "3524646"}, {"introduction": "理论的优雅之外，FFT方法的实际应用还要求我们深刻理解其计算成本。这个实践练习[@problem_id:3524704]提供了一个估算大规模模拟中内存占用和运行时间的机会。通过完成这个练习，您将对这些技术的计算可扩展性和可行性获得至关重要的实践洞察。", "problem": "考虑一个非均质岩土地质材料的三维代表性体积单元 (RVE)，该单元在一个均匀的周期性网格上进行离散化，每个空间方向上有 $N=512$ 个体素，因此总共有 $M=N^{3}$ 个体素。一个用于小应变力学的、基于迭代快速傅里叶变换 (FFT) 的均匀化求解器被用来求解 Lippmann–Schwinger 方程。该求解器作用于对称二阶张量（应变和应力），在三维空间中有 $6$ 个独立分量。该算法采用复数值的三维 FFT。硬件提供持续的浮点吞吐量 $R=2.0 \\times 10^{11}$ 次浮点运算每秒。\n\n使用以下基本且广为接受的事实和假设：\n- 长度为 $n$ 的一维复数 FFT 大约需要 $5 n \\log_{2} n$ 次浮点运算。一个在 $n \\times n \\times n$ 网格上的三维复数 FFT 由 $3 n^{2}$ 个长度为 $n$ 的一维变换组成，因此其运算量为 $15 n^{3} \\log_{2} n$ 次浮点运算。\n- 双精度实数和复数分别占用 $8$ 字节和 $16$ 字节。\n- 在线性弹性情况（对极化场进行不动点迭代）下，每个全局迭代执行以下谱方法步骤：对 $6$ 分量的极化张量场进行一次正向三维 FFT，以及对 $6$ 分量的应变张量场进行一次逆向三维 FFT，总计每个全局迭代进行 $12$ 次复数三维 FFT。求解器在 $n_{\\mathrm{iter,L}}=50$ 次全局迭代后收敛。\n- 在采用 Newton–Krylov 策略求解的、带各向同性硬化的非线性 $J_{2}$ 弹塑性情况中，有 $n_{\\mathrm{N}}=8$ 次全局 Newton 迭代。每次 Newton 迭代使用一个共轭梯度 (CG) 求解器，该求解器执行 $n_{\\mathrm{CG}}=40$ 次矩阵向量积运算。每次矩阵向量积运算需要对 $6$ 分量场进行一次正向和一次逆向三维 FFT，总计每次矩阵向量积运算进行 $12$ 次复数三维 FFT。\n- 傅里叶域中的格林算子是动态计算的，不进行存储。\n- 实空间本构更新会给每个体素带来额外的浮点运算：在线性情况下，每个全局迭代中每个体素需要 $f_{\\mathrm{lin}}=50$ 次浮点运算；在非线性情况下，每个全局 Newton 迭代中每个体素需要 $f_{\\mathrm{nl}}=1000$ 次浮点运算。\n\n对于内存计算，假设在线性情况下，稳态时存储以下数组：\n- 实空间数组：应变 $\\varepsilon$（$6$ 个分量）、应力 $\\sigma$（$6$ 个分量）、极化 $p$（$6$ 个分量）以及各向同性材料标量 $(\\lambda,\\mu)$（$2$ 个标量），总计每个体素 $20$ 个实数标量。\n- 傅里叶空间数组：$\\hat{\\varepsilon}$（$6$ 个复数分量）和 $\\hat{p}$（$6$ 个复数分量），总计每个体素 $12$ 个复数标量。\n\n对于非线性情况，除了上述所有数组外，还需存储以下实空间数组：\n- 塑性应变 $\\varepsilon^{p}$（$6$ 个分量）、等效塑性应变 $\\bar{\\varepsilon}^{p}$（$1$ 个标量）、一致弹塑性切线模量 $\\mathbb{C}_{\\mathrm{ep}}$（假设主对称性，存储为 $21$ 个独立分量）、试探应力 $\\sigma^{\\mathrm{trial}}$（$6$ 个分量）和屈服函数值（$1$ 个标量）。这在线性情况的基础上，每个体素额外增加了 $6+1+21+6+1=35$ 个实数标量。\n\n任务：\n1. 从 $M=N^{3}$ 和给定的存储假设出发，推导线性和非线性情况下的总内存占用，单位为吉比字节 (GiB)。\n2. 在计算密集型假设下，使用指定的 FFT 运算次数、迭代/内积次数以及实空间本构更新成本 $f_{\\mathrm{lin}}$ 和 $f_{\\mathrm{nl}}$，推导线性和非线性情况下的预期总运行时间，单位为秒。\n\n最终的内存结果以 GiB 表示，最终的运行时间结果以秒表示。将所有四个量四舍五入到三位有效数字。将最终答案表示为一个单行矩阵，按顺序包含线性情况内存、非线性情况内存、线性情况运行时间和非线性情况运行时间。", "solution": "该问题具有科学依据，提法明确，并包含足够的信息来确定唯一解。它描述了计算力学中的一个标准场景，所提供的参数是符合实际的。我们将进行所要求的两项推导：线性和非线性情况下的内存占用和总运行时间。\n\n首先，我们根据问题陈述确定基本参数。代表性体积单元 (RVE) 在一个每边有 $N=512$ 个体素的均匀网格上离散化。总体素数为 $M=N^{3}$。\n$$M = 512^3 = (2^9)^3 = 2^{27} = 134,217,728$$\n浮点数的存储大小为：双精度实数 $8$ 字节，双精度复数 $16$ 字节。我们将使用转换因子 $1 \\text{ GiB} = 2^{30}$ 字节。硬件的持续浮点吞吐量为 $R=2.0 \\times 10^{11}$ 次浮点运算每秒 (FLOPS)。\n\n**第一部分：内存占用推导**\n\n我们将计算存储线性和非线性情况下所有指定数组所需的内存。\n\n**线性情况内存 ($Mem_{\\mathrm{lin}}$)：**\n对于线性情况，内存存储由实空间数组和傅里叶空间数组组成。\n- 实空间存储：问题指定了应变 ($\\varepsilon$)、应力 ($\\sigma$) 和极化 ($p$) 的数组，每个都有 $6$ 个分量，外加材料标量 $(\\lambda, \\mu)$ 有 $2$ 个分量。每个体素总共有 $6+6+6+2 = 20$ 个实数标量。\n- 傅里叶空间存储：应变 ($\\hat{\\varepsilon}$) 和极化 ($\\hat{p}$) 的傅里叶变换数组，每个都有 $6$ 个复数分量。每个体素总共有 $6+6=12$ 个复数标量。\n\n总内存（以字节为单位）计算如下：\n$$Mem_{\\mathrm{lin, bytes}} = M \\times (\\text{real scalars} \\times \\text{bytes/real} + \\text{complex scalars} \\times \\text{bytes/complex})$$\n$$Mem_{\\mathrm{lin, bytes}} = 2^{27} \\times (20 \\times 8 + 12 \\times 16) = 2^{27} \\times (160 + 192) = 2^{27} \\times 352$$\n为了将其转换为吉比字节 (GiB)，我们除以 $2^{30}$：\n$$Mem_{\\mathrm{lin}} = \\frac{2^{27} \\times 352}{2^{30}} = \\frac{352}{2^3} = \\frac{352}{8} = 44 \\text{ GiB}$$\n\n**非线性情况内存 ($Mem_{\\mathrm{nl}}$)：**\n非线性情况需要线性情况下的所有数组，外加几个额外的实空间数组：塑性应变 $\\varepsilon^{p}$（$6$ 个分量）、等效塑性应变 $\\bar{\\varepsilon}^{p}$（$1$ 个标量）、一致弹塑性切线模量 $\\mathbb{C}_{\\mathrm{ep}}$（$21$ 个分量）、试探应力 $\\sigma^{\\mathrm{trial}}$（$6$ 个分量）和屈服函数值（$1$ 个标量）。这导致每个体素额外增加 $6+1+21+6+1=35$ 个实数标量。\n\n额外的内存（以字节为单位）为：\n$$Mem_{\\mathrm{add, bytes}} = M \\times (\\text{additional real scalars} \\times \\text{bytes/real}) = 2^{27} \\times 35 \\times 8 = 2^{27} \\times 280$$\n非线性情况的总内存是线性情况内存与此额外内存之和：\n$$Mem_{\\mathrm{nl, bytes}} = Mem_{\\mathrm{lin, bytes}} + Mem_{\\mathrm{add, bytes}} = 2^{27} \\times 352 + 2^{27} \\times 280 = 2^{27} \\times (352+280) = 2^{27} \\times 632$$\n转换为 GiB：\n$$Mem_{\\mathrm{nl}} = \\frac{2^{27} \\times 632}{2^{30}} = \\frac{632}{2^3} = \\frac{632}{8} = 79 \\text{ GiB}$$\n四舍五入到三位有效数字，内存占用为 $Mem_{\\mathrm{lin}} = 44.0$ GiB 和 $Mem_{\\mathrm{nl}} = 79.0$ GiB。\n\n**第二部分：总运行时间推导**\n\n我们首先计算在 $N \\times N \\times N$ 网格上进行单次三维复数 FFT 的浮点运算次数 (FLOPs)。\n当 $n=N=512$ 时，运算次数由下式给出：\n$$F_{\\mathrm{FFT}} = 15 n^3 \\log_{2} n = 15 N^3 \\log_{2} N = 15 M \\log_{2}(512) = 15 M \\times 9 = 135 M$$\n因此，一次三维 FFT 需要 $135 M$ FLOPs。\n\n**线性情况运行时间 ($T_{\\mathrm{lin}}$)：**\n线性求解器执行 $n_{\\mathrm{iter,L}} = 50$ 次全局迭代。每次迭代包括：\n- 谱方法计算：$12$ 次复数三维 FFT。FLOP 计数为 $12 \\times F_{\\mathrm{FFT}} = 12 \\times 135 M = 1620 M$。\n- 实空间计算：本构更新每个体素耗费 $f_{\\mathrm{lin}} = 50$ FLOPs，总计为 $M \\times f_{\\mathrm{lin}} = 50 M$ FLOPs。\n\n每次迭代的总 FLOPs 为 $1620 M + 50 M = 1670 M$。在所有迭代中，总 FLOPs 为：\n$$F_{\\mathrm{lin,tot}} = n_{\\mathrm{iter,L}} \\times (1670 M) = 50 \\times 1670 M = 83500 M$$\n代入 $M=2^{27}$：\n$$F_{\\mathrm{lin,tot}} = 83500 \\times 2^{27} \\approx 1.1207 \\times 10^{13} \\text{ FLOPs}$$\n运行时间是总 FLOPs 除以硬件吞吐量 $R$：\n$$T_{\\mathrm{lin}} = \\frac{F_{\\mathrm{lin,tot}}}{R} = \\frac{83500 \\times 2^{27}}{2.0 \\times 10^{11}} \\approx 56.036 \\text{ s}$$\n\n**非线性情况运行时间 ($T_{\\mathrm{nl}}$)：**\n非线性求解器执行 $n_{\\mathrm{N}} = 8$ 次 Newton 迭代。每次 Newton 迭代包括：\n- CG 求解器计算：一个共轭梯度求解器执行 $n_{\\mathrm{CG}} = 40$ 次矩阵向量积。每次此类乘积需要 $12$ 次复数三维 FFT。一次 Newton 迭代中 CG 部分的 FLOP 计数为：\n$$F_{\\mathrm{CG, Newton}} = n_{\\mathrm{CG}} \\times (12 \\times F_{\\mathrm{FFT}}) = 40 \\times 12 \\times (135 M) = 480 \\times 135 M = 64800 M$$\n- 实空间计算：本构更新每个体素耗费 $f_{\\mathrm{nl}} = 1000$ FLOPs，每次 Newton 迭代总计为 $M \\times f_{\\mathrm{nl}} = 1000 M$ FLOPs。\n\n每次 Newton 迭代的总 FLOPs 为 $64800 M + 1000 M = 65800 M$。在所有 Newton 迭代中，总 FLOPs 为：\n$$F_{\\mathrm{nl,tot}} = n_{\\mathrm{N}} \\times (65800 M) = 8 \\times 65800 M = 526400 M$$\n代入 $M=2^{27}$：\n$$F_{\\mathrm{nl,tot}} = 526400 \\times 2^{27} \\approx 7.0666 \\times 10^{13} \\text{ FLOPs}$$\n运行时间为：\n$$T_{\\mathrm{nl}} = \\frac{F_{\\mathrm{nl,tot}}}{R} = \\frac{526400 \\times 2^{27}}{2.0 \\times 10^{11}} \\approx 353.33 \\text{ s}$$\n\n将最终运行时间结果四舍五入到三位有效数字，我们得到 $T_{\\mathrm{lin}} = 56.0$ 秒和 $T_{\\mathrm{nl}} = 353$ 秒。\n\n总而言之，所要求的四个量是：\n1.  线性情况内存：$44.0$ GiB\n2.  非线性情况内存：$79.0$ GiB\n3.  线性情况运行时间：$56.0$ s\n4.  非线性情况运行时间：$353$ s", "answer": "$$\n\\boxed{\\begin{pmatrix} 44.0 & 79.0 & 56.0 & 353 \\end{pmatrix}}\n$$", "id": "3524704"}]}