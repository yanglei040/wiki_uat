{"hands_on_practices": [{"introduction": "此练习关注等几何分析的一个核心概念：在不改变精确几何形状的前提下丰富求解空间的能力。通过对 B 样条曲线进行升阶，您将亲自推导如何在保证几何表示不变的情况下，提高基函数的次数（一种 $p$ 型加密）。这项实践对于理解等几何分析如何将几何描述与分析层面的加密分离开来至关重要 [@problem_id:3535326]。", "problem": "考虑一个用于描述平面应变地质力学模型中一维边界曲线的等几何映射。该曲线由参数域 $[0,1]$ 上的一个 $p=2$ 次的钳位B样条表示，其开放节点矢量为 $\\{0,0,0,1,1,1\\}$，控制点为 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$ 和 $\\mathbf{P}_2=(2,0)$。假设为非有理设置，权重为单位权重，因此映射为\n$$\n\\mathbf{x}(u)=\\sum_{i=0}^{2} N_{i,2}(u)\\,\\mathbf{P}_i,\\quad u\\in[0,1],\n$$\n其中 $N_{i,2}(u)$ 是二次B样条基函数。由于节点矢量只有一个非平凡区间，基函数退化为 $[0,1]$ 上的 $p$ 次伯恩斯坦多项式，该曲线是一个单独的贝塞尔曲线段。\n\n进行从 $p$ 次到 $p+1$ 次的升阶，以获得新的控制多边形 $\\{\\mathbf{Q}_i\\}_{i=0}^{3}$ 和一个三次映射\n$$\n\\tilde{\\mathbf{x}}(u)=\\sum_{i=0}^{3} \\tilde{N}_{i,3}(u)\\,\\mathbf{Q}_i,\n$$\n该映射具有与单个区间相同的钳位节点矢量结构，因此三次基退化为 $[0,1]$ 上的 $p+1$ 次伯恩斯坦多项式。仅使用B样条/伯恩斯坦基的基本性质（单位分解性、非负性和几何映射的线性性），推导确定升阶后控制点 $\\{\\mathbf{Q}_i\\}$ 所需的关系式，以使几何映射保持不变，即对于所有 $u\\in[0,1]$，都有 $\\tilde{\\mathbf{x}}(u)=\\mathbf{x}(u)$。\n\n然后，在 $u=\\tfrac{1}{2}$ 处对两个映射求值，并计算它们差值的欧几里得范数，即\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|.\n$$\n将此实数作为您的最终答案。假设所有坐标都是无量纲的；报告最终答案时不带单位。最终答案无需四舍五入。", "solution": "该问题要求推导二次贝塞尔曲线的升阶关系式，并随后计算在特定参数值下原始曲线映射与升阶后曲线映射之间差值的范数。\n\n初始曲线是一个二次B样条，其节点矢量为 $\\{0,0,0,1,1,1\\}$。这种结构中，起始和末尾节点的重复度为 $p+1=3$，使得B样条基函数 $N_{i,2}(u)$ 与定义域 $u \\in [0,1]$ 上的二次伯恩斯坦多项式 $B_{i,2}(u)$ 完全相同。因此，该曲线是一个二次贝塞尔曲线：\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} B_{i,2}(u) \\mathbf{P}_i\n$$\n其中 $p=2$ 次的伯恩斯坦多项式为：\n$$\nB_{0,2}(u) = \\binom{2}{0}(1-u)^2 u^0 = (1-u)^2 \\\\\nB_{1,2}(u) = \\binom{2}{1}(1-u)^1 u^1 = 2u(1-u) \\\\\nB_{2,2}(u) = \\binom{2}{2}(1-u)^0 u^2 = u^2\n$$\n给定的控制点为 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$ 和 $\\mathbf{P}_2=(2,0)$。\n\n升阶过程旨在为三次贝塞尔曲线 $\\tilde{\\mathbf{x}}(u)$ 寻找一组新的控制点 $\\{\\mathbf{Q}_i\\}_{i=0}^3$，使得其几何形状与原始曲线完全相同，即对于所有 $u \\in [0,1]$，都有 $\\tilde{\\mathbf{x}}(u) = \\mathbf{x}(u)$。\n$$\n\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i\n$$\n为了找到 $\\{\\mathbf{P}_i\\}$ 和 $\\{\\mathbf{Q}_i\\}$ 之间的关系，我们可以提升原始曲线基函数的次数。我们利用基函数构成单位分解这一性质，即 $\\sum B_{i,p}(u) = 1$，在最简单的情况下可表示为 $(1-u)+u=1$。我们将 $\\mathbf{x}(u)$ 的表达式乘以 1：\n$$\n\\mathbf{x}(u) = ((1-u) + u) \\sum_{j=0}^{2} B_{j,2}(u) \\mathbf{P}_j = \\sum_{j=0}^{2} (1-u)B_{j,2}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} uB_{j,2}(u)\\mathbf{P}_j\n$$\n我们使用定义 $B_{j,p}(u) = \\binom{p}{j}u^j(1-u)^{p-j}$ 来分析这些乘积：\n$$\n(1-u)B_{j,p}(u) = (1-u)\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j}} \\binom{p+1}{j}u^j(1-u)^{p+1-j} = \\frac{p+1-j}{p+1} B_{j,p+1}(u)\n$$\n$$\nuB_{j,p}(u) = u\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j+1}} \\binom{p+1}{j+1}u^{j+1}(1-u)^{p-j} = \\frac{j+1}{p+1} B_{j+1,p+1}(u)\n$$\n将这些 $p=2$ 时的恒等式代入 $\\mathbf{x}(u)$ 的表达式中：\n$$\n\\mathbf{x}(u) = \\sum_{j=0}^{2} \\frac{3-j}{3}B_{j,3}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} \\frac{j+1}{3}B_{j+1,3}(u)\\mathbf{P}_j\n$$\n让我们基于三次伯恩斯坦基函数 $B_{i,3}(u)$ 展开并合并各项：\n第一个求和项给出：\n$$\n\\frac{3}{3}B_{0,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{1,3}(u)\\mathbf{P}_1 + \\frac{1}{3}B_{2,3}(u)\\mathbf{P}_2\n$$\n第二个求和项给出（索引已平移）：\n$$\n\\frac{1}{3}B_{1,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{2,3}(u)\\mathbf{P}_1 + \\frac{3}{3}B_{3,3}(u)\\mathbf{P}_2\n$$\n按 $B_{i,3}(u)$ 合并和分组各项：\n$$\n\\mathbf{x}(u) = B_{0,3}(u)[\\mathbf{P}_0] + B_{1,3}(u)[\\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1] + B_{2,3}(u)[\\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2] + B_{3,3}(u)[\\mathbf{P}_2]\n$$\n通过将其与 $\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i$ 进行比较，我们得到新的控制点 $\\{\\mathbf{Q}_i\\}$：\n$$\n\\mathbf{Q}_0 = \\mathbf{P}_0 \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1 \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2 \\\\\n\\mathbf{Q}_3 = \\mathbf{P}_2\n$$\n从 $p$ 次升阶到 $p+1$ 次的通用公式为 $\\mathbf{Q}_i = \\frac{i}{p+1}\\mathbf{P}_{i-1} + (1-\\frac{i}{p+1})\\mathbf{P}_i$ 对于 $i=1,\\ldots,p$，其中 $\\mathbf{Q}_0 = \\mathbf{P}_0$ 和 $\\mathbf{Q}_{p+1} = \\mathbf{P}_p$。我们对 $p=2$ 的推导与此通用结果相符。\n\n现在，我们将这些关系应用于给定的控制点 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$、$\\mathbf{P}_2=(2,0)$:\n$$\n\\mathbf{Q}_0 = (0,0) \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}(0,0) + \\frac{2}{3}(1,2) = \\left(\\frac{2}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}(1,2) + \\frac{1}{3}(2,0) = \\left(\\frac{2}{3}+\\frac{2}{3}, \\frac{4}{3}+0\\right) = \\left(\\frac{4}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_3 = (2,0)\n$$\n问题要求计算 $\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|$。根据我们的推导，几何映射在升阶下保持不变，这意味着对于所有 $u \\in [0,1]$，都有 $\\mathbf{x}(u) = \\tilde{\\mathbf{x}}(u)$。因此，对于任何 $u$ 值，差向量 $\\mathbf{x}(u) - \\tilde{\\mathbf{x}}(u)$ 都是零向量 $\\mathbf{0}$。\n\n为了完整起见，我们可以在 $u=\\frac{1}{2}$ 处明确地验证这一点。\n对于原始的二次曲线：\n$$\n\\mathbf{x}\\left(\\frac{1}{2}\\right) = B_{0,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_0 + B_{1,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_1 + B_{2,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_2 \\\\\n= \\left(1-\\frac{1}{2}\\right)^2 \\mathbf{P}_0 + 2\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\mathbf{P}_1 + \\left(\\frac{1}{2}\\right)^2 \\mathbf{P}_2 \\\\\n= \\frac{1}{4}(0,0) + \\frac{1}{2}(1,2) + \\frac{1}{4}(2,0) = \\left(0+\\frac{1}{2}+\\frac{2}{4}, 0+1+0\\right) = (1,1)\n$$\n对于升阶后的三次曲线：\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = B_{0,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_0 + B_{1,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_1 + B_{2,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_2 + B_{3,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_3\n$$\n在 $u=\\frac{1}{2}$ 处的三次伯恩斯坦值为 $B_{0,3}=\\frac{1}{8}$, $B_{1,3}=\\frac{3}{8}$, $B_{2,3}=\\frac{3}{8}$, $B_{3,3}=\\frac{1}{8}$。\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = \\frac{1}{8}(0,0) + \\frac{3}{8}\\left(\\frac{2}{3}, \\frac{4}{3}\\right) + \\frac{3}{8}\\left(\\frac{4}{3}, \\frac{4}{3}\\right) + \\frac{1}{8}(2,0) \\\\\n= \\left(0 + \\frac{6}{24} + \\frac{12}{24} + \\frac{2}{8}, 0 + \\frac{12}{24} + \\frac{12}{24} + 0\\right) \\\\\n= \\left(\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4}, \\frac{1}{2} + \\frac{1}{2}\\right) = (1,1)\n$$\n验证确认了 $\\mathbf{x}(\\frac{1}{2})=\\tilde{\\mathbf{x}}(\\frac{1}{2})=(1,1)$。差值为：\n$$\n\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right) = (1,1) - (1,1) = (0,0)\n$$\n最后，我们计算这个差向量的欧几里得范数：\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\| = \\|(0,0)\\| = \\sqrt{0^2 + 0^2} = 0\n$$\n这个结果是曲线在升阶下几何不变性的直接推论。", "answer": "$$\n\\boxed{0}\n$$", "id": "3535326"}, {"introduction": "NURBS 的一个关键特征是权重的使用，它为表示如圆锥截面等复杂几何形状提供了极大的灵活性。这项动手练习要求您建立一个数值计算流程，以研究刚度矩阵对这些权重变化的敏感性。这项实践突出了等几何分析中几何与分析之间的紧密耦合关系，并培养了理解基于 NURBS 的模型性能的关键技能 [@problem_id:3535319]。", "problem": "考虑一个用于计算岩土力学中标量扩散问题等几何伽辽金离散化的二维非均匀有理B样条（NURBS）曲面片。此问题中的所有量都是无量纲的，因此最终的数值是无量纲的。参数域是闭合正方形 $[0,1]\\times[0,1]$，其张量积、开放、夹持的节点向量在 $\\xi$ 方向为 $U = [0,0,0,1,1,1]$，在 $\\eta$ 方向为 $V = [0,0,0,1,1,1]$，多项式次数为 $p = 2$ 和 $q = 2$。设二元B样条基由一元基函数通过张量积构建。NURBS基函数由带有正权重的张量积B样条进行有理化来定义。\n\n从参数域到物理域的几何映射 $\\boldsymbol{X}(\\xi,\\eta)$ 由等几何概念给出，使用与场近似相同的NURBS基函数。具体来说，定义一组 $n = 9$ 个控制点和 $n$ 个正权重。设控制点排列成一个 $3\\times 3$ 的网格，并通过索引映射 $i = i_\\xi + 3\\,i_\\eta$（其中 $i_\\xi \\in \\{0,1,2\\}$ 和 $i_\\eta \\in \\{0,1,2\\}$）按行主序进行扁平化。控制点坐标 $\\boldsymbol{P}_i = (X_i,Y_i)$ 如下：\n- $i=0$：$(0,0)$，\n- $i=1$：$(0.5,-0.05)$，\n- $i=2$：$(1,0)$，\n- $i=3$：$(0,0.5)$，\n- $i=4$：$(0.5,0.6)$，\n- $i=5$：$(1,0.5)$，\n- $i=6$：$(0,1)$，\n- $i=7$：$(0.5,1.05)$，\n- $i=8$：$(1,1)$。\n\n设基础（未扰动）权重为向量 $\\boldsymbol{w} \\in \\mathbb{R}^9$，其分量为\n- $w_0 = 1$， $w_1 = 1$， $w_2 = 1$，\n- $w_3 = 1$， $w_4 = 1.8$， $w_5 = 1$，\n- $w_6 = 1$， $w_7 = 1$， $w_8 = 1$。\n\n对于 $(\\xi,\\eta) \\in [0,1]\\times[0,1]$，令 $B_i(\\xi,\\eta)$ 表示张量积B样条基函数（非有理），并令 $W(\\xi,\\eta) = \\sum_{j=0}^{8} w_j B_j(\\xi,\\eta)$ 表示NURBS权重函数。有理NURBS基函数为 $R_i(\\xi,\\eta) = \\dfrac{w_i B_i(\\xi,\\eta)}{W(\\xi,\\eta)}$。几何映射为 $\\boldsymbol{X}(\\xi,\\eta) = \\sum_{i=0}^{8} R_i(\\xi,\\eta)\\,\\boldsymbol{P}_i$。该映射的雅可比矩阵是 $2\\times 2$ 矩阵 $\\boldsymbol{J}(\\xi,\\eta) = \\left[\\dfrac{\\partial \\boldsymbol{X}}{\\partial \\xi} \\ \\ \\dfrac{\\partial \\boldsymbol{X}}{\\partial \\eta}\\right]$，度量张量是 $\\boldsymbol{G}(\\xi,\\eta) = \\boldsymbol{J}^\\top(\\xi,\\eta)\\,\\boldsymbol{J}(\\xi,\\eta)$，基函数的物理梯度通过协变变换 $\\nabla_{\\boldsymbol{x}} R_i(\\xi,\\eta) = \\boldsymbol{J}^{-\\top}(\\xi,\\eta)\\, \\begin{bmatrix} \\dfrac{\\partial R_i}{\\partial \\xi}(\\xi,\\eta) \\\\ \\dfrac{\\partial R_i}{\\partial \\eta}(\\xi,\\eta) \\end{bmatrix}$ 获得。\n\n在一个具有单位各向同性电导率的标量扩散模型问题中，对应于基索引 $a$ 和 $b$ 的代表性刚度矩阵项是在物理曲面片上计算的双线性形式，\n$$\nK_{ab} = \\int_{\\Omega} \\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b \\, d\\Omega = \\int_{0}^{1} \\int_{0}^{1} \\left( \\nabla_{\\boldsymbol{x}} R_a(\\xi,\\eta) \\cdot \\nabla_{\\boldsymbol{x}} R_b(\\xi,\\eta) \\right) \\, \\left|\\det \\boldsymbol{J}(\\xi,\\eta)\\right| \\, d\\xi \\, d\\eta,\n$$\n其中 $\\Omega$ 是曲面片在映射 $\\boldsymbol{X}(\\xi,\\eta)$下的物理图像。\n\n您的任务是量化单个权重 $w_k$ 的变化如何通过其对刚度矩阵项 $K_{ab}$ 的影响来影响度量和形函数梯度。从上述基本定义（B样条、有理NURBS、几何映射、雅可比矩阵、度量张量和协变梯度变换）出发，构建一个数值程序，对于给定的索引 $k$ 和一个小的扰动 $\\varepsilon > 0$，计算代表性刚度项 $K_{ab}$ 关于 $w_k$ 的灵敏度的中心有限差分估计，\n$$\n\\frac{\\partial K_{ab}}{\\partial w_k} \\approx \\frac{K_{ab}(w_k + \\varepsilon) - K_{ab}(w_k - \\varepsilon)}{2\\,\\varepsilon}.\n$$\n在所有评估中，取代表性索引 $a = 4$ 和 $b = 0$ 为固定值。使用在每个参数方向上阶数为 $3$ 的张量积高斯求积（从 $[-1,1]$ 映射到 $[0,1]$）来执行参数域积分。\n\n实现以下测试套件，每个测试都是一个元组 $(k,\\varepsilon)$，指示要扰动的单个权重索引和扰动幅度：\n- 测试 $1$：$(k,\\varepsilon) = (4, 10^{-4})$，\n- 测试 $2$：$(k,\\varepsilon) = (1, 10^{-6})$，\n- 测试 $3$：$(k,\\varepsilon) = (8, 10^{-2})$。\n\n对于每个测试，使用上述中心差分公式计算 $\\dfrac{\\partial K_{ab}}{\\partial w_k}$ 的有限差分估计。如果需要保持扰动权重的正性，请确保 $w_k + \\varepsilon$ 和 $w_k - \\varepsilon$ 都保持严格为正；给定的测试满足此要求。\n\n您的程序必须输出单行，其中包含一个包含三个浮点数的列表，每个浮点数是按上述顺序列出的相应测试的中心差分估计。输出必须打印为用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3]$。报告的三个值是无量纲实数。", "solution": "该问题要求在一个等几何分析框架内，计算刚度矩阵项相对于特定NURBS权重的灵敏度。这将通过构建一个基于等几何基本原理的数值程序并应用中心有限差分格式来完成。该问题是适定的，具有科学依据，并为获得唯一解提供了所有必要的信息。\n\n\\textbf{1. B样条和NURBS基函数}\n\n等几何模型的基础在于其基函数。我们从一元B样条基函数开始，对于给定的开放、夹持节点向量 $U=V=[0,0,0,1,1,1]$ 和多项式次数 $p=q=2$，它们简化为区间 $[0,1]$ 上的标准2次伯恩斯坦多项式。对于参数坐标 $\\xi \\in [0,1]$，三个非零基函数 $N_{i_\\xi, 2}(\\xi)$ 为：\n$$\n\\begin{aligned}\nN_{0,2}(\\xi) = (1-\\xi)^2 \\\\\nN_{1,2}(\\xi) = 2\\xi(1-\\xi) \\\\\nN_{2,2}(\\xi) = \\xi^2\n\\end{aligned}\n$$\n它们关于 $\\xi$ 的一阶导数为：\n$$\n\\begin{aligned}\n\\frac{d N_{0,2}}{d\\xi}(\\xi) = -2(1-\\xi) \\\\\n\\frac{d N_{1,2}}{d\\xi}(\\xi) = 2(1-2\\xi) \\\\\n\\frac{d N_{2,2}}{d\\xi}(\\xi) = 2\\xi\n\\end{aligned}\n$$\n对于 $i \\in \\{0, 1, ..., 8\\}$，二元B样条基函数 $B_i(\\xi, \\eta)$ 由一元函数的张量积形成。使用行主序索引映射 $i = i_\\xi + 3i_\\eta$（其中 $i_\\xi, i_\\eta \\in \\{0,1,2\\}$），我们有：\n$$\nB_i(\\xi, \\eta) = N_{i_\\xi, 2}(\\xi) N_{i_\\eta, 2}(\\eta)\n$$\n偏导数相应地计算如下：\n$$\n\\frac{\\partial B_i}{\\partial \\xi}(\\xi, \\eta) = \\frac{d N_{i_\\xi, 2}}{d\\xi}(\\xi) N_{i_\\eta, 2}(\\eta) \\quad \\text{和} \\quad \\frac{\\partial B_i}{\\partial \\eta}(\\xi, \\eta) = N_{i_\\xi, 2}(\\xi) \\frac{d N_{i_\\eta, 2}}{d\\eta}(\\eta)\n$$\n有理NURBS基函数 $R_i(\\xi, \\eta)$ 是通过引入权重 $w_i > 0$ 和分母函数 $W(\\xi, \\eta) = \\sum_{j=0}^{8} w_j B_j(\\xi, \\eta)$ 来构建的。\n$$\nR_i(\\xi, \\eta) = \\frac{w_i B_i(\\xi, \\eta)}{W(\\xi, \\eta)}\n$$\nNURBS基函数的参数导数使用商法则求得。例如，关于 $\\xi$ 的导数为：\n$$\n\\frac{\\partial R_i}{\\partial \\xi} = \\frac{w_i \\frac{\\partial B_i}{\\partial \\xi} W - w_i B_i \\frac{\\partial W}{\\partial \\xi}}{W^2}, \\quad \\text{其中} \\quad \\frac{\\partial W}{\\partial \\xi} = \\sum_{j=0}^{8} w_j \\frac{\\partial B_j}{\\partial \\xi}\n$$\n关于 $\\eta$ 的导数也有类似的表达式。\n\n\\textbf{2. 等几何映射和刚度公式}\n\n物理域 $\\Omega$ 的几何形状由等几何映射 $\\boldsymbol{X}(\\xi, \\eta)$ 描述，该映射使用相同的NURBS基函数：\n$$\n\\boldsymbol{X}(\\xi, \\eta) = \\sum_{i=0}^{8} R_i(\\xi, \\eta) \\boldsymbol{P}_i\n$$\n其中 $\\boldsymbol{P}_i$ 是控制点坐标。从参数域到物理域的变换由雅可比矩阵 $\\boldsymbol{J}(\\xi, \\eta)$ 表征：\n$$\n\\boldsymbol{J} = \\begin{bmatrix} \\frac{\\partial \\boldsymbol{X}}{\\partial \\xi} & \\frac{\\partial \\boldsymbol{X}}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\xi} X_i & \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\eta} X_i \\\\ \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\xi} Y_i & \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\eta} Y_i \\end{bmatrix}\n$$\n对于使用相同基函数近似的标量场变量 $u(\\boldsymbol{x}) = \\sum_a u_a R_a(\\boldsymbol{x})$，基函数在物理坐标中的梯度 $\\nabla_{\\boldsymbol{x}} R_a$ 可通过其参数梯度 $\\nabla_{\\boldsymbol{\\xi}} R_a = \\begin{bmatrix} \\partial R_a/\\partial \\xi & \\partial R_a/\\partial \\eta \\end{bmatrix}^\\top$ 和雅可比矩阵的逆转置求得：\n$$\n\\nabla_{\\boldsymbol{x}} R_a = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_a\n$$\n对于单位电导率的扩散问题，刚度矩阵项 $K_{ab}$ 由物理梯度在物理域 $\\Omega$ 上的点积的积分给出：\n$$\nK_{ab} = \\int_{\\Omega} \\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b \\, d\\Omega\n$$\n将变量转换到参数域 $[0,1] \\times [0,1]$，积分变为：\n$$\nK_{ab} = \\int_{0}^{1} \\int_{0}^{1} (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})| \\, d\\xi d\\eta\n$$\n\n\\textbf{3. 数值程序}\n\n$K_{ab}$ 的积分使用张量积高斯求积法则进行数值计算。问题指定每个方向的阶数为 $3$。\n\n\\textbf{求积方案：}对于 $[-1,1]$ 上的一维积分，$3$ 点高斯-勒让德求积使用点 $\\hat{t}_k = \\{-\\sqrt{3/5}, 0, \\sqrt{3/5}\\}$ 和权重 $\\hat{w}_k = \\{5/9, 8/9, 5/9\\}$。为了在 $[0,1]$ 上积分，我们使用线性映射 $\\xi = (\\hat{t}+1)/2$。$[0,1]$ 中的求积点是 $\\xi_k = \\{(1-\\sqrt{3/5})/2, 1/2, (1+\\sqrt{3/5})/2\\}$，权重是 $w_k = \\hat{w}_k/2 = \\{5/18, 8/18, 5/18\\}$。然后积分由以下和式近似：\n$$\nK_{ab} \\approx \\sum_{k=1}^{3} \\sum_{l=1}^{3} w_k w_l \\left[ (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})| \\right]_{(\\xi_k, \\eta_l)}\n$$\n\n\\textbf{刚度项计算算法：}对于给定的权重向量 $\\boldsymbol{w}$，$K_{ab}$ 的值按以下步骤计算：\n1.  初始化 $K_{ab} = 0$。\n2.  为区间 $[0,1]$ 定义求积点集 $\\{\\xi_k\\}$ 和权重集 $\\{w_k\\}$。\n3.  对每个求积点对 $(\\xi_k, \\eta_l)$ 进行循环：\n    a. 评估一元伯恩斯坦基函数 $N_{i,2}(\\xi_k)$、$N_{i,2}(\\eta_l)$ 及其导数。\n    b. 计算所有 $9$ 个二元B样条基函数 $B_i(\\xi_k, \\eta_l)$ 的值及其偏导数 $\\partial B_i/\\partial \\xi$、$\\partial B_i/\\partial \\eta$。\n    c. 计算分母函数 $W(\\xi_k, \\eta_l)$ 及其导数 $\\partial W/\\partial \\xi$、$\\partial W/\\partial \\eta$。\n    d. 对于所有 $i=0,\\dots,8$，计算在 $(\\xi_k, \\eta_l)$ 处的参数导数 $\\partial R_i/\\partial \\xi$ 和 $\\partial R_i/\\partial \\eta$。\n    e. 使用这些导数和控制点坐标 $\\boldsymbol{P}_i$ 组装雅可比矩阵 $\\boldsymbol{J}$。\n    f. 计算行列式 $\\det(\\boldsymbol{J})$ 和逆转置矩阵 $\\boldsymbol{J}^{-\\top}$。\n    g. 对于指定的索引 $a=4$ 和 $b=0$，形成参数梯度向量 $\\nabla_{\\boldsymbol{\\xi}} R_a$ 和 $\\nabla_{\\boldsymbol{\\xi}} R_b$。\n    h. 将它们转换为物理梯度：$\\nabla_{\\boldsymbol{x}} R_a = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_a$ 和 $\\nabla_{\\boldsymbol{x}} R_b = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_b$。\n    i. 计算被积函数的值：$f(\\xi_k, \\eta_l) = (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})|$。\n    j. 将贡献加到总和中：$K_{ab} = K_{ab} + w_k w_l f(\\xi_k, \\eta_l)$。\n4.  返回 $K_{ab}$ 的最终值。\n\n\\textbf{4. 灵敏度分析}\n\n$K_{ab}$ 相对于权重 $w_k$ 的灵敏度使用二阶中心有限差分公式估算：\n$$\n\\frac{\\partial K_{ab}}{\\partial w_k} \\approx \\frac{K_{ab}(\\boldsymbol{w}^+) - K_{ab}(\\boldsymbol{w}^-)}{2\\varepsilon}\n$$\n这里，$\\varepsilon$ 是一个小的扰动。向量 $\\boldsymbol{w}^+$ 和 $\\boldsymbol{w}^-$ 是基础权重向量 $\\boldsymbol{w}$ 的第 $k$ 个分量分别扰动为 $w_k+\\varepsilon$ 和 $w_k-\\varepsilon$ 后的向量。该数值程序涉及两次调用上述的刚度计算算法，每次对应一个扰动后的权重向量。然后使用结果来评估有限差分表达式。对每个提供的测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the isogeometric sensitivity analysis problem.\n    \"\"\"\n    # Define problem data from the statement\n    control_points_list = [\n        (0,0), (0.5,-0.05), (1,0),\n        (0,0.5), (0.5,0.6), (1,0.5),\n        (0,1), (0.5,1.05), (1,1)\n    ]\n    control_points = np.array(control_points_list, dtype=float)\n\n    base_weights_list = [\n        1, 1, 1,\n        1, 1.8, 1,\n        1, 1, 1\n    ]\n    base_weights = np.array(base_weights_list, dtype=float)\n\n    # Indices for the stiffness matrix entry K_ab\n    a, b = 4, 0\n\n    # Gaussian quadrature of order 3 for interval [0, 1]\n    # Mapped from standard [-1, 1] points and weights\n    gauss_pts_std = np.array([-np.sqrt(3.0/5.0), 0.0, np.sqrt(3.0/5.0)])\n    gauss_wts_std = np.array([5.0/9.0, 8.0/9.0, 5.0/9.0])\n    \n    gauss_points = 0.5 * (gauss_pts_std + 1.0)\n    gauss_weights = 0.5 * gauss_wts_std\n\n    def calculate_stiffness_entry(weights_vec):\n        \"\"\"\n        Calculates the stiffness matrix entry K_ab for a given set of weights.\n        \"\"\"\n        stiffness_val = 0.0\n\n        for i in range(len(gauss_points)):\n            xi = gauss_points[i]\n            w_xi = gauss_weights[i]\n            for j in range(len(gauss_points)):\n                eta = gauss_points[j]\n                w_eta = gauss_weights[j]\n                \n                # Evaluate integrand at the current quadrature point (xi, eta)\n                \n                # 1. Univariate Bernstein basis functions (p=2) and their derivatives\n                N_xi = np.array([(1-xi)**2, 2*xi*(1-xi), xi**2])\n                dN_xi = np.array([-2*(1-xi), 2 - 4*xi, 2*xi])\n                \n                N_eta = np.array([(1-eta)**2, 2*eta*(1-eta), eta**2])\n                dN_eta = np.array([-2*(1-eta), 2 - 4*eta, 2*eta])\n\n                # 2. Tensor-product B-spline basis and derivatives\n                B = np.zeros(9)\n                dB_dxi = np.zeros(9)\n                dB_deta = np.zeros(9)\n                for i_eta in range(3):\n                    for i_xi in range(3):\n                        idx = i_xi + 3 * i_eta\n                        B[idx] = N_xi[i_xi] * N_eta[i_eta]\n                        dB_dxi[idx] = dN_xi[i_xi] * N_eta[i_eta]\n                        dB_deta[idx] = N_xi[i_xi] * dN_eta[i_eta]\n                \n                # 3. NURBS denominator W and its derivatives\n                W_val = np.dot(weights_vec, B)\n                dW_dxi = np.dot(weights_vec, dB_dxi)\n                dW_deta = np.dot(weights_vec, dB_deta)\n\n                # 4. Parametric derivatives of all NURBS basis functions\n                dR_dxi = (weights_vec * dB_dxi * W_val - weights_vec * B * dW_dxi) / (W_val**2)\n                dR_deta = (weights_vec * dB_deta * W_val - weights_vec * B * dW_deta) / (W_val**2)\n\n                # 5. Jacobian matrix of the geometric map\n                # dX/dxi = sum(dRi/dxi * Pi)\n                dX_dxi = dR_dxi @ control_points # shape (2,)\n                dX_deta = dR_deta @ control_points # shape (2,)\n                J = np.array([[dX_dxi[0], dX_deta[0]], [dX_dxi[1], dX_deta[1]]])\n                \n                # 6. Jacobian determinant and inverse transpose\n                detJ = np.linalg.det(J)\n                if abs(detJ)  1e-12: continue  # Avoid singularity\n                invJ_T = np.linalg.inv(J).T\n                \n                # 7. Physical gradients of basis functions a and b\n                grad_param_Ra = np.array([dR_dxi[a], dR_deta[a]])\n                grad_param_Rb = np.array([dR_dxi[b], dR_deta[b]])\n\n                grad_phys_Ra = invJ_T @ grad_param_Ra\n                grad_phys_Rb = invJ_T @ grad_param_Rb\n                \n                # 8. Integrand value: (grad(Ra) . grad(Rb)) * |det(J)|\n                dot_product = np.dot(grad_phys_Ra, grad_phys_Rb)\n                integrand = dot_product * np.abs(detJ)\n                \n                # Accumulate weighted integrand value\n                stiffness_val += integrand * w_xi * w_eta\n        \n        return stiffness_val\n\n    # Test suite from the problem statement\n    test_cases = [\n        (4, 1e-4),\n        (1, 1e-6),\n        (8, 1e-2),\n    ]\n\n    results = []\n    for k, epsilon in test_cases:\n        # Perturb weights for central difference\n        weights_plus = base_weights.copy()\n        weights_plus[k] += epsilon\n        \n        weights_minus = base_weights.copy()\n        weights_minus[k] -= epsilon\n        \n        # Calculate stiffness for perturbed weights\n        K_plus = calculate_stiffness_entry(weights_plus)\n        K_minus = calculate_stiffness_entry(weights_minus)\n        \n        # Compute central difference sensitivity\n        sensitivity = (K_plus - K_minus) / (2.0 * epsilon)\n        results.append(sensitivity)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3535319"}, {"introduction": "岩土力学中的许多关键问题（如孔隙弹性力学）都使用混合格式进行建模，而这种格式必须满足诸如 inf-sup 条件之类的稳定性条件。本练习旨在挑战您分析特定等几何位移和压力空间配对的稳定性。通过计算离散 inf-sup 常数，您将发现等几何分析的一个重要理论优势：能够构建内在稳定的高阶连续单元配对 [@problem_id:3535320]。", "problem": "考虑参数域 $\\Omega = [0,1]$ 上的一维近不可压缩固体在小应变地质力学中的混合位移-压力格式。设位移空间是由具有单一单元的二次 ($p = 2$) 开放节点矢量构建的等几何空间，压力空间是由具有相同单一单元的线性 ($p-1 = 1$) 开放节点矢量构建的等几何空间。假设几何映射为恒等映射，并施加齐次本质边界条件 $u(0) = 0$ 以消除刚体模态。\n\n设与体积耦合相关的双线性形式为\n$$\nb(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx,\n$$\n并为离散位移空间和压力空间配备以下范数\n$$\n\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}, \n\\qquad\n\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}.\n$$\n离散 inf–sup (Ladyzhenskaya–Babuška–Brezzi) 常数定义为\n$$\n\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}.\n$$\n\n使用以上设置：\n- 构建由单一单元上的开放节点矢量诱导的 $V_{h}$ 和 $Q_{h}$ 的基函数。\n- 在离散设置中一致地施加 $u(0)=0$。\n- 从 $\\beta_{h}$ 的定义出发，推导离散 inf-sup 常数关于离散算子的可计算表达式，并针对此网格和这些等几何空间精确地计算其值。\n\n最后，解释您获得的值与节点配置和连续性的关系；特别是，定性地讨论插入一个内部节点（从而引入多个单元并降低连续性）预期会如何影响离散 inf-sup 常数。将上述单一单元开放节点配置的 $\\beta_{h}$ 的精确值作为您的最终结果。该常数是无量纲的，因此不需要单位，也不需要四舍五入。", "solution": "该问题要求计算特定一维等几何单元配对的离散 inf-sup 常数 $\\beta_h$，并对结果进行后续讨论。\n\n首先对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 格式：混合位移-压力格式。\n- 域：$\\Omega = [0,1]$。\n- 位移空间 ($V_h$): 由二次 ($p=2$) 开放节点矢量构建的等几何空间，单一单元。\n- 压力空间 ($Q_h$): 由线性 ($p-1=1$) 开放节点矢量构建的等几何空间，单一单元。\n- 几何映射：恒等映射，$x(\\xi) = \\xi$。\n- 边界条件：齐次本质边界条件 $u(0) = 0$。\n- 双线性形式：$b(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx$。\n- 位移范数：$\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}$。\n- 压力范数：$\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}$。\n- 离散 inf-sup 常数的定义：$\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据、是适定的和客观的。它在混合有限元方法理论中，特别是在等几何分析的框架内，提出了一个标准的、非平凡的问题。其格式、定义和空间都是该领域的标准。该问题是自洽的，没有矛盾、歧义或不合理的假设。\n\n**第三步：结论和行动**\n该问题是有效的。将提供完整的解答。\n\n**解答推导**\n\n**第一部分：基函数的构造**\n对于域 $[0,1]$ 上具有开放节点矢量的单一单元，B 样条基函数简化为 Bernstein 多项式。\n\n- **位移空间 $V_h$ ($p=2$):**\n单个二次单元的开放节点矢量为 $\\Xi_u = \\{0, 0, 0, 1, 1, 1\\}$。基函数是二次 Bernstein 多项式：\n$$\n\\begin{aligned}\nN_{1,2}(x) = (1-x)^2 = 1 - 2x + x^2 \\\\\nN_{2,2}(x) = 2x(1-x) = 2x - 2x^2 \\\\\nN_{3,2}(x) = x^2\n\\end{aligned}\n$$\n离散位移场 $u_h(x)$ 表示为 $u_h(x) = \\sum_{i=1}^{3} c_i N_{i,2}(x)$。\n\n- **压力空间 $Q_h$ ($p=1$):**\n单个线性单元的开放节点矢量为 $\\Xi_q = \\{0, 0, 1, 1\\}$。基函数是线性 Bernstein 多项式：\n$$\n\\begin{aligned}\nQ_{1,1}(x) = 1-x \\\\\nQ_{2,1}(x) = x\n\\end{aligned}\n$$\n离散压力场 $q_h(x)$ 表示为 $q_h(x) = \\sum_{k=1}^{2} d_k Q_{k,1}(x)$。\n\n**第二部分：施加边界条件 $u(0)=0$**\n必须对离散位移空间施加条件 $u(0)=0$。在 $x=0$ 处，基函数的计算结果为：\n$N_{1,2}(0) = 1$, $N_{2,2}(0) = 0$, $N_{3,2}(0) = 0$。\n因此，$u_h(0) = c_1 N_{1,2}(0) + c_2 N_{2,2}(0) + c_3 N_{3,2}(0) = c_1$。\n条件 $u_h(0)=0$ 意味着 $c_1=0$。因此，受约束的位移空间由 $\\{N_{2,2}(x), N_{3,2}(x)\\}$ 张成。令 $\\mathbf{c} = \\begin{pmatrix} c_2  c_3 \\end{pmatrix}^T$ 为有效自由度向量。\n\n**第三部分：inf-sup 常数的矩阵形式**\n我们将 $\\beta_h$ 定义中的各项表示为矩阵形式。令 $\\mathbf{d} = \\begin{pmatrix} d_1  d_2 \\end{pmatrix}^T$。\n- $b(u_h, q_h) = \\int_{0}^{1} (\\mathbf{d}^T \\mathbf{Q}(x)) (\\mathbf{N}'(x)^T \\mathbf{c}) dx = \\mathbf{d}^T \\mathbf{B} \\mathbf{c}$，其中 $\\mathbf{B}_{kj} = \\int_0^1 Q_{k,1}(x) N'_{j+1,2}(x) dx$。\n- $\\|u_h\\|_V^2 = \\int_{0}^{1} |\\frac{du_h}{dx}|^2 dx = \\mathbf{c}^T \\mathbf{K} \\mathbf{c}$，其中 $\\mathbf{K}_{ij} = \\int_0^1 N'_{i+1,2}(x) N'_{j+1,2}(x) dx$。\n- $\\|q_h\\|_Q^2 = \\int_{0}^{1} |q_h|^2 dx = \\mathbf{d}^T \\mathbf{M} \\mathbf{d}$，其中 $\\mathbf{M}_{kl} = \\int_0^1 Q_{k,1}(x) Q_{l,1}(x) dx$。\n\n离散 inf-sup 常数由 $\\beta_h^2 = \\lambda_{\\min}$ 给出，其中 $\\lambda$ 是以下广义特征值问题的特征值：\n$$\n(\\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T) \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}\n$$\n\n**第四部分：矩阵计算**\n所需的位移基函数的导数为：\n$N'_{2,2}(x) = 2 - 4x$\n$N'_{3,2}(x) = 2x$\n\n- **刚度矩阵 $\\mathbf{K}$** (针对受约束空间)：\n$K_{11} = \\int_0^1 (2-4x)^2 dx = \\int_0^1 (4 - 16x + 16x^2) dx = \\left[4x - 8x^2 + \\frac{16}{3}x^3\\right]_0^1 = 4-8+\\frac{16}{3} = \\frac{4}{3}$。\n$K_{12} = K_{21} = \\int_0^1 (2-4x)(2x) dx = \\int_0^1 (4x - 8x^2) dx = \\left[2x^2 - \\frac{8}{3}x^3\\right]_0^1 = 2-\\frac{8}{3} = -\\frac{2}{3}$。\n$K_{22} = \\int_0^1 (2x)^2 dx = \\int_0^1 4x^2 dx = \\left[\\frac{4}{3}x^3\\right]_0^1 = \\frac{4}{3}$。\n$$ \\mathbf{K} = \\begin{pmatrix} \\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{2}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\n\n- **压力质量矩阵 $\\mathbf{M}$**：\n$M_{11} = \\int_0^1 (1-x)^2 dx = \\left[-\\frac{(1-x)^3}{3}\\right]_0^1 = \\frac{1}{3}$。\n$M_{12} = M_{21} = \\int_0^1 x(1-x) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{2}-\\frac{1}{3} = \\frac{1}{6}$。\n$M_{22} = \\int_0^1 x^2 dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3}$。\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n- **耦合矩阵 $\\mathbf{B}$**：\n$B_{11} = \\int_0^1 (1-x)(2-4x) dx = \\int_0^1 (2-6x+4x^2) dx = \\left[2x - 3x^2 + \\frac{4}{3}x^3\\right]_0^1 = 2-3+\\frac{4}{3} = \\frac{1}{3}$。\n$B_{12} = \\int_0^1 (1-x)(2x) dx = \\int_0^1 (2x-2x^2) dx = \\left[x^2 - \\frac{2}{3}x^3\\right]_0^1 = 1-\\frac{2}{3} = \\frac{1}{3}$。\n$B_{21} = \\int_0^1 x(2-4x) dx = \\int_0^1 (2x-4x^2) dx = \\left[x^2 - \\frac{4}{3}x^3\\right]_0^1 = 1-\\frac{4}{3} = -\\frac{1}{3}$。\n$B_{22} = \\int_0^1 x(2x) dx = \\int_0^1 2x^2 dx = \\left[\\frac{2}{3}x^3\\right]_0^1 = \\frac{2}{3}$。\n$$ \\mathbf{B} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{3} \\\\ -\\frac{1}{3}  \\frac{2}{3} \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} $$\n\n**第五部分：求解特征值问题**\n首先，我们求 $\\mathbf{K}^{-1}$：\n$\\det(\\mathbf{K}) = (\\frac{2}{3})^2(2 \\cdot 2 - (-1)(-1)) = \\frac{4}{9}(3) = \\frac{4}{3}$。\n$$ \\mathbf{K}^{-1} = \\frac{1}{4/3} \\begin{pmatrix} \\frac{4}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{3}{4} \\frac{2}{3} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} $$\n接着，我们计算矩阵 $\\mathbf{S} = \\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T$。\n$$ \\mathbf{B} \\mathbf{K}^{-1} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1+\\frac{1}{2}  \\frac{1}{2}+1 \\\\ -1+1  -\\frac{1}{2}+2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{3}{2}  \\frac{3}{2} \\\\ 0  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n$$ \\mathbf{S} = (\\mathbf{B} \\mathbf{K}^{-1})\\mathbf{B}^T = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 1  -1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{1}{2}+\\frac{1}{2}  -\\frac{1}{2}+1 \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} $$\n我们观察到 $\\mathbf{S} = \\mathbf{M}$。因此，广义特征值问题 $\\mathbf{S} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}$ 变为：\n$$ \\mathbf{M} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d} $$\n由于 $\\mathbf{M}$ 是可逆的（因为 $\\det(\\mathbf{M}) = \\frac{1}{9}-\\frac{1}{36} \\neq 0$），我们可以两边乘以 $\\mathbf{M}^{-1}$ 得到 $\\mathbf{I} \\mathbf{d} = \\lambda \\mathbf{d}$。特征值是单位矩阵的特征值，因此 $\\lambda_1 = \\lambda_2 = 1$。最小特征值为 $\\lambda_{\\min} = 1$。\n离散 inf-sup 常数为 $\\beta_h = \\sqrt{\\lambda_{\\min}} = \\sqrt{1} = 1$。\n\n**第六部分：讨论**\n计算出的值 $\\beta_h = 1$ 是 inf-sup 常数的最大可能值，表明这是一个完全稳定的单元配对。这个最优结果是为单一单元选择特定等几何空间的直接后果。对于 Bernstein 多项式，$p$ 次多项式的导数所张成的空间与 $(p-1)$ 次多项式空间完全相同。在我们的例子中，施加边界条件后，受约束的二次位移基函数的导数空间 $V'_h = \\text{span}\\{2-4x, 2x\\}$，恰好是所有线性多项式的空间。线性压力基 $Q_h = \\text{span}\\{1-x, x\\}$ 也张成了所有线性多项式的空间。因此，$V'_h = Q_h$。\n\n这意味着对于任何离散压力 $q_h \\in Q_h$，都存在一个唯一的离散位移 $u_h \\in V_h$，使得 $\\frac{du_h}{dx} = q_h$。在 $\\beta_h$ 定义的上确界计算中选择这个特定的 $u_h$ 会得到：\n$$ \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{\\int q_h \\frac{du_h}{dx} dx}{\\|u_h\\|_V \\|q_h\\|_Q} \\ge \\frac{\\int q_h \\cdot q_h dx}{\\|\\frac{dq_h}{dx}\\|_{L^2}^{-1} \\|q_h\\|_Q} = \\frac{\\|q_h\\|_Q^2}{\\|q_h\\|_Q \\|q_h\\|_Q} = 1 $$\n根据柯西-施瓦茨不等式，该比率永远不会超过 $1$，因此对于任何 $q_h$，上确界都恰好是 $1$。因此，在所有 $q_h$ 上的下确界也是 $1$。\n\n如果插入一个内部节点（例如，在 $x=1/2$ 处），则会创建一个多单元网格。位移基函数将变为 $C^1$ 连续的二次样条，而压力基将是 $C^0$ 连续的线性样条。尽管 $C^1$ 二次样条空间的导数是 $C^0$ 线性样条空间，并且导数空间 $V'_h$ 和压力空间 $Q_h$ 的维数将保持相等，但由于导数公式中使用的底层节点矢量与基函数定义中的不同，这两个空间在函数形式上不再相同。$V'_h=Q_h$ 这一性质的丧失意味着，对于某些压力模态 $q_h$，计算中的上确界部分将得到一个严格小于 $1$ 的值。因此，插入一个内部节点并降低基函数的全局连续性，预期将会使离散 inf-sup 常数从其完美值 $1$ 下降。该单元配对将保持稳定 ($\\beta_h  0$)，但不再是“完全”稳定的。", "answer": "$$\n\\boxed{1}\n$$", "id": "3535320"}]}