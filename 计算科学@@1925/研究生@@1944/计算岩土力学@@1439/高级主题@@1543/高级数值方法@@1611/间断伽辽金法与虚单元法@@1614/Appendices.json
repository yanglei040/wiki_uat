{"hands_on_practices": [{"introduction": "在计算地球力学中，准确模拟地震波等波传播现象至关重要。此练习将指导您通过数值频散分析，来评估间断 Galerkin (DG) 方法的两个核心数值通量（中心通量和迎风通量）的性能。通过推导一维弹性杆中波传播的数值相速度，您将深入理解数值格式如何影响波的传播特性，这是保证动力学模拟精度的基础。[@problem_id:3518428]", "problem": "考虑均匀一维弹性杆中的小振幅纵波，其受线性弹性动力学的一阶对称双曲形式控制：\n- 动量平衡：$\\rho\\, v_{t} = \\sigma_{x}$，\n- 运动学和本构律：$\\sigma_{t} = E\\, v_{x}$，\n其中 $v(x,t)$ 是质点速度，$\\sigma(x,t)$ 是轴向应力，$\\rho$ 是质量密度，$E$ 是杨氏模量。波速为 $c = \\sqrt{E/\\rho}$。将该系统写为 $q_{t} + B\\, q_{x} = 0$ 的形式，其中 $q = \\begin{pmatrix} v \\\\ \\sigma \\end{pmatrix}$ 且 $B = \\begin{pmatrix} 0  -\\rho^{-1} \\\\ -E  0 \\end{pmatrix}$。\n\n用尺寸为 $h$ 的均匀网格和周期性边界条件对空间域进行离散化。使用多项式次数为 $k=0$（每个单元内为分片常数）的间断伽辽金（DG）方法。令 $I_{j}$ 表示第 $j$ 个单元，令 $q_{j}(t)$ 为 $q$ 在 $I_{j}$ 上的单元平均值。半离散 DG 格式为\n$$\nh\\, \\frac{d q_{j}}{dt} + \\widehat{f}\\!\\left(q_{j}^{-}, q_{j+1}^{+}\\right) - \\widehat{f}\\!\\left(q_{j-1}^{-}, q_{j}^{+}\\right) = 0,\n$$\n其中数值通量 $\\widehat{f}$ 在单元界面处近似物理通量 $f(q) = B\\, q$。考虑两种标准选择：\n- 中心通量：$\\widehat{f}_{\\mathrm{c}}(q^{-},q^{+}) = \\tfrac{1}{2}\\, B\\, (q^{-} + q^{+})$，\n- 迎风（精确黎曼）通量：$\\widehat{f}_{\\mathrm{u}}(q^{-},q^{+}) = B^{+} q^{-} + B^{-} q^{+}$, 其中 $B = R \\Lambda R^{-1}$ 是特征分解，$\\Lambda = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}) = \\mathrm{diag}(c,-c)$ 且 $B^{\\pm} = R\\, \\Lambda^{\\pm} R^{-1}$，$\\Lambda^{+} = \\mathrm{diag}(c,0)$，$\\Lambda^{-} = \\mathrm{diag}(0,-c)$。\n\n假设一个 Bloch 波拟设 $q_{j}(t) = \\widehat{q}\\, \\exp\\!\\left( \\mathrm{i}\\, j\\, \\theta - \\mathrm{i}\\, \\omega\\, t \\right)$，其中无量纲波数为 $\\theta = \\kappa h$，$\\kappa$ 是物理波数。对于每种通量选择，计算半离散数值色散关系 $\\omega(\\theta)$，然后将归一化数值相速度定义为\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = \\frac{|\\Re(\\omega(\\theta))|}{c\\, \\kappa} = \\frac{h\\, |\\Re(\\omega(\\theta))|}{c\\, \\theta}.\n$$\n\n对 $\\dfrac{c_{\\mathrm{p, num}}}{c}$ 在 $\\theta = 0$ 附近进行泰勒展开，形式如下\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = 1 - \\alpha\\, \\theta^{2} + \\mathcal{O}(\\theta^{4}),\n$$\n并确定以下情况的系数 $\\alpha$：\n- 中心通量，和\n- 迎风通量。\n\n将您的最终答案以单行矩阵的形式给出，其中包含两个精确系数 $\\alpha$（中心通量在前，迎风通量在后）。无需四舍五入。", "solution": "我们从均匀一维弹性杆的一阶对称双曲系统开始：\n$$\nq_{t} + B\\, q_{x} = 0, \\quad q = \\begin{pmatrix} v \\\\ \\sigma \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0  -\\rho^{-1} \\\\ -E  0 \\end{pmatrix}.\n$$\n$B$ 的特征值为 $\\lambda_{1} = c$ 和 $\\lambda_{2} = -c$，其中 $c = \\sqrt{E/\\rho}$。这可以通过计算 $\\det(\\lambda I - B) = \\lambda^{2} - E/\\rho = \\lambda^{2} - c^{2}$ 来验证，因此 $\\lambda = \\pm c$。\n\n我们将空间域离散化为大小为 $h$ 的均匀单元网格 $\\{I_{j}\\}$。使用多项式次数为 $k=0$（每个单元内为分片常数）的间断伽辽金方法和周期性边界条件，在单元 $I_{j}$ 上对常数 $1$ 的测试函数进行半离散平衡，得到\n$$\nh\\, \\frac{d q_{j}}{dt} + \\widehat{f}\\!\\left(q_{j}^{-}, q_{j+1}^{+}\\right) - \\widehat{f}\\!\\left(q_{j-1}^{-}, q_{j}^{+}\\right) = 0,\n$$\n其中 $\\widehat{f}$ 是在界面 $x_{j \\pm 1/2}$ 处近似 $f(q) = B q$ 的数值通量，上标 $-$ 和 $+$ 分别表示从左侧和右侧的迹。对于 $k=0$，$q_{j}^{-} = q_{j}^{+} = q_{j}$。\n\n我们采用一个 Bloch 波拟设：\n$$\nq_{j}(t) = \\widehat{q}\\, \\exp\\!\\left(\\mathrm{i}\\, j\\, \\theta - \\mathrm{i}\\, \\omega\\, t\\right), \\quad \\theta = \\kappa h,\n$$\n因此 $q_{j+1} = e^{\\mathrm{i}\\theta}\\, q_{j}$ 且 $q_{j-1} = e^{-\\mathrm{i}\\theta}\\, q_{j}$。将此拟设代入半离散格式，得到定义每种通量选择的数值色散关系 $\\omega(\\theta)$ 的代数特征问题。\n\n**中心通量**\n\n对于中心通量，\n$$\n\\widehat{f}_{\\mathrm{c}}(q_{j}, q_{j+1}) = \\tfrac{1}{2}\\, B\\, (q_{j} + q_{j+1}) = \\tfrac{1}{2}\\, B\\, (1 + e^{\\mathrm{i}\\theta})\\, q_{j},\n$$\n以及\n$$\n\\widehat{f}_{\\mathrm{c}}(q_{j-1}, q_{j}) = \\tfrac{1}{2}\\, B\\, (q_{j-1} + q_{j}) = \\tfrac{1}{2}\\, B\\, (e^{-\\mathrm{i}\\theta} + 1)\\, q_{j}.\n$$\n因此，\n$$\nh\\, \\frac{d q_{j}}{dt} + \\tfrac{1}{2}\\, B\\, \\big[(1 + e^{\\mathrm{i}\\theta}) - (e^{-\\mathrm{i}\\theta} + 1)\\big]\\, q_{j} = 0\n\\;\\;\\Longrightarrow\\;\\;\n- \\mathrm{i}\\, \\omega\\, h\\, q_{j} + \\mathrm{i}\\, B\\, \\sin\\theta\\, q_{j} = 0.\n$$\n因此，离散空间算子的特征值是 $B$ 的特征值乘以 $\\sin\\theta$，数值色散关系为\n$$\n\\omega_{\\mathrm{c}}(\\theta) = \\pm \\frac{c}{h}\\, \\sin\\theta.\n$$\n归一化数值相速度为\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = \\frac{|\\Re(\\omega_{\\mathrm{c}})|}{c\\, \\kappa} = \\frac{(c/h)\\, |\\sin\\theta|}{c\\, \\kappa} = \\frac{\\sin\\theta}{\\theta},\n$$\n这里我们使用了 $\\kappa = \\theta/h$ 并考虑 $0 \\le \\theta \\le \\pi$，因此 $\\sin\\theta \\ge 0$。对小 $\\theta$ 进行展开，\n$$\n\\sin\\theta = \\theta - \\frac{\\theta^{3}}{3!} + \\frac{\\theta^{5}}{5!} - \\cdots,\n$$\n得到\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = \\frac{\\sin\\theta}{\\theta} = 1 - \\frac{\\theta^{2}}{3!} + \\frac{\\theta^{4}}{5!} - \\cdots = 1 - \\frac{1}{6}\\, \\theta^{2} + \\mathcal{O}(\\theta^{4}).\n$$\n因此，对于中心通量，$\\alpha_{\\mathrm{c}} = \\frac{1}{6}$。\n\n**迎风通量**\n\n对于迎风（精确黎曼）通量，记 $B = R \\Lambda R^{-1}$，其中 $\\Lambda = \\mathrm{diag}(c,-c)$，并定义 $B^{\\pm} = R \\Lambda^{\\pm} R^{-1}$，其中 $\\Lambda^{+} = \\mathrm{diag}(c,0)$ 且 $\\Lambda^{-} = \\mathrm{diag}(0,-c)$。那么\n$$\n\\widehat{f}_{\\mathrm{u}}(q_{j}, q_{j+1}) = B^{+} q_{j} + B^{-} q_{j+1} = \\big(B^{+} + B^{-} e^{\\mathrm{i}\\theta}\\big)\\, q_{j},\n$$\n以及\n$$\n\\widehat{f}_{\\mathrm{u}}(q_{j-1}, q_{j}) = B^{+} q_{j-1} + B^{-} q_{j} = \\big(B^{+} e^{-\\mathrm{i}\\theta} + B^{-}\\big)\\, q_{j}.\n$$\n因此，半离散方程变为\n$$\n- \\mathrm{i}\\, \\omega\\, h\\, q_{j} + \\Big[B^{+}\\big(1 - e^{-\\mathrm{i}\\theta}\\big) + B^{-}\\big(e^{\\mathrm{i}\\theta} - 1\\big)\\Big]\\, q_{j} = 0.\n$$\n在特征变量 $w = R^{-1} q$ 中对角化，使得上述方程简化为两个关于右行和左行特征场 $w_{+}$ 和 $w_{-}$ 的解耦标量关系：\n- 对于速度为 $+c$ 的 $+$ 场：\n$$\n- \\mathrm{i}\\, \\omega\\, h + c \\big(1 - e^{-\\mathrm{i}\\theta}\\big) = 0\n\\;\\;\\Longrightarrow\\;\\;\n\\omega_{+}(\\theta) = -\\mathrm{i}\\, \\frac{c}{h}\\, \\big(1 - e^{-\\mathrm{i}\\theta}\\big) = - \\frac{c}{h}\\, \\sin\\theta + \\mathrm{i}\\, \\frac{c}{h}\\, \\big(1 - \\cos\\theta\\big).\n$$\n- 对于速度为 $-c$ 的 $-$ 场：\n$$\n- \\mathrm{i}\\, \\omega\\, h - c \\big(e^{\\mathrm{i}\\theta} - 1\\big) = 0\n\\;\\;\\Longrightarrow\\;\\;\n\\omega_{-}(\\theta) = \\mathrm{i}\\, \\frac{c}{h}\\, \\big(e^{\\mathrm{i}\\theta} - 1\\big) = \\frac{c}{h}\\, \\sin\\theta + \\mathrm{i}\\, \\frac{c}{h}\\, \\big(1 - \\cos\\theta\\big).\n$$\n两个分支具有相同的实部大小，\n$$\n|\\Re(\\omega_{\\mathrm{u}}(\\theta))| = \\frac{c}{h}\\, \\sin\\theta,\n$$\n并且具有非负虚部 $\\Im(\\omega_{\\mathrm{u}}(\\theta)) = \\frac{c}{h}\\, (1 - \\cos\\theta)$，这反映了数值耗散。因此，通过实部定义的归一化数值相速度在大小上与中心通量情况相同：\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = \\frac{h\\, |\\Re(\\omega_{\\mathrm{u}}(\\theta))|}{c\\, \\theta} = \\frac{\\sin\\theta}{\\theta} = 1 - \\frac{1}{6}\\, \\theta^{2} + \\mathcal{O}(\\theta^{4}).\n$$\n因此，对于迎风通量，$\\alpha_{\\mathrm{u}} = \\frac{1}{6}$。\n\n**结论**\n\n对于具有均匀网格尺寸 $h$ 的一维弹性杆的分片常数（$k=0$）间断伽辽金离散化，中心通量和迎风通量在归一化相速度的小 $\\theta$ 展开中，都产生相同的主阶色散误差系数，\n$$\n\\frac{c_{\\mathrm{p, num}}}{c} = 1 - \\alpha\\, \\theta^{2} + \\mathcal{O}(\\theta^{4}), \\quad \\alpha_{\\mathrm{c}} = \\alpha_{\\mathrm{u}} = \\frac{1}{6}.\n$$\n迎风通量通过 $\\omega(\\theta)$ 的非零虚部额外引入了数值耗散，但这并不改变从实部导出的主阶色散系数。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{6}  \\frac{1}{6} \\end{pmatrix}}$$", "id": "3518428"}, {"introduction": "显式时间积分方案在求解动力学问题时效率很高，但其稳定性受到严格的时间步长限制，即 Courant–Friedrichs–Lewy (CFL) 条件。本练习将引导您为对称内罚间断 Galerkin (SIPG) 方法在弹性动力学中的应用，推导其稳定性约束。通过运用数值分析中的标准不等式，您将揭示多项式次数 $p$、网格尺寸 $h$ 和罚参数 $\\gamma$ 如何共同决定最大允许时间步长，从而掌握在实践中平衡精度、稳定性和计算成本的关键。[@problem_id:3518386]", "problem": "考虑一根密度为 $\\rho$、杨氏模量为 $E$ 的均匀杆中的一维小应变纵向弹性动力学，其控制方程为\n$$\n\\rho\\, \\ddot{u}(x,t) = \\frac{\\partial}{\\partial x}\\!\\big(E\\, u_{x}(x,t)\\big)\\quad \\text{for } x \\in \\Omega,\n$$\n在域 $\\Omega$ 上施加周期性边界条件，该域被划分为尺寸为 $h$ 的均匀单元网格。令 $c = \\sqrt{E/\\rho}$ 表示弹性波速。空间上采用多项式次数为 $p \\ge 1$ 的对称内部罚函数伽辽金（SIPG）方法（一种间断伽辽金方法）进行离散，使用均匀网格和内部罚函数\n$$\n\\sigma \\;=\\; \\gamma\\, \\frac{E\\, p^{2}}{h},\n$$\n其中固定无量纲稳定化参数 $\\gamma = 2$。假设采用精确的对角质量集中，使得半离散系统为\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}, \\quad \\text{with } \\mathbf{M} = \\rho\\, \\mathbf{I}\\,,\n$$\n其中 $\\mathbf{I}$ 是系数空间中的单位矩阵，刚度矩阵 $\\mathbf{K}$ 对应于 SIPG 双线性形式\n$$\na_{h}(v,w) \\;=\\; \\sum_{K}\\int_{K} E\\, v_{x}\\, w_{x}\\, dx \\;-\\; \\sum_{F}\\big(\\{E v_{x}\\}\\,[w] + \\{E w_{x}\\}\\,[v]\\big) \\;+\\; \\sum_{F} \\sigma\\,[v]\\,[w],\n$$\n其中在面 $F$ 上采用通常的平均 $\\{\\cdot\\}$ 和跳跃 $[\\cdot]$ 记号。\n\n对一维均匀网格上次数为 $p$ 的分片多项式，使用以下经过充分检验的估计式：\n- SIPG 连续性界：存在一个与网格和 $p$ 无关的常数（取其值为 2），使得\n$$\na_{h}(v,v) \\;\\le\\; 2\\, E\\, \\sum_{K}\\|v_{x}\\|_{L^{2}(K)}^{2} \\;+\\; 2\\, \\sigma \\sum_{F} [v]^{2}.\n$$\n- 逆不等式：存在常数 $C_{I}=2$，使得\n$$\n\\sum_{K}\\|v_{x}\\|_{L^{2}(K)}^{2} \\;\\le\\; C_{I}\\, \\frac{p^{4}}{h^{2}}\\, \\|v\\|_{L^{2}(\\Omega)}^{2}.\n$$\n- 离散迹不等式：存在常数 $C_{T}=2$，使得\n$$\n\\sum_{F}[v]^{2} \\;\\le\\; C_{T}\\, \\frac{p^{2}}{h}\\, \\|v\\|_{L^{2}(\\Omega)}^{2}.\n$$\n\n时间积分采用显式中心差分法。该二阶线性系统的稳定性限制由最大的半离散角频率 $\\omega_{\\max}$ 控制，其中 $\\omega_{\\max}^{2}$ 是广义特征问题 $\\mathbf{K}\\mathbf{v} = \\omega^{2}\\mathbf{M}\\mathbf{v}$ 的最大特征值。已知中心差分法在以下条件下是稳定的：\n$$\n\\Delta t \\;\\le\\; \\frac{2}{\\omega_{\\max}}.\n$$\n\n任务：\n1) 从给定的估计式出发，推导 $\\omega_{\\max}^{2}$ 的一个上界，并由此推导出形式为 $\\Delta t \\le C\\, h/(p^{2} c)$ 的 Courant–Friedrichs–Lewy (CFL) 型稳定性界。计算在 $\\gamma = 2$ 的特定情况下的显式常数 $C$。\n2) 利用 SIPG 刚度算子的谱特性，简要论证增加 $\\gamma$ 如何抑制虚假的单元间模式，以及这如何影响 CFL 常数。\n\n将最大稳定时间步长的最终答案表示为关于 $h$、$p$ 和 $c$ 的封闭解析表达式。时间步长以秒为单位。在方框内的最终答案中不要包含单位。", "solution": "1) 推导CFL稳定性界\n\n我们的目标是找到半离散系统最大角频率 $\\omega_{\\max}$ 的一个上界。$\\omega_{\\max}^2$ 是广义特征值问题 $\\mathbf{K}\\mathbf{v} = \\omega^{2}\\mathbf{M}\\mathbf{v}$ 的最大特征值。根据瑞利商的性质，对于任意非零函数 $v$ 及其对应的系数向量 $\\mathbf{v}$，我们有：\n$$\n\\omega^2 = \\frac{\\mathbf{v}^T \\mathbf{K} \\mathbf{v}}{\\mathbf{v}^T \\mathbf{M} \\mathbf{v}} = \\frac{a_h(v, v)}{\\rho \\mathbf{v}^T \\mathbf{I} \\mathbf{v}}\n$$\n在假设对角质量集中的情况下，分母与函数 $v$ 的 $L^2$ 范数的平方成正比，即 $\\rho \\|v\\|_{L^2(\\Omega)}^2$。因此，最大特征值可以通过在离散函数空间 $V_h$ 中最大化瑞利商来界定：\n$$\n\\omega_{\\max}^2 = \\max_{v \\in V_h \\setminus \\{0\\}} \\frac{a_h(v,v)}{\\rho \\|v\\|_{L^2(\\Omega)}^2}\n$$\n为了给分子 $a_h(v,v)$ 找一个上界，我们首先应用给定的SIPG连续性界：\n$$\na_{h}(v,v) \\le 2\\, E\\, \\sum_{K}\\|v_{x}\\|_{L^{2}(K)}^{2} + 2\\, \\sigma \\sum_{F} [v]^{2}\n$$\n接着，我们将逆不等式和离散迹不等式代入上式，用 $\\|v\\|_{L^2(\\Omega)}^2$ 来表示右侧的项：\n\\begin{align*} a_{h}(v,v) \\le 2\\, E \\left(C_{I}\\, \\frac{p^{4}}{h^{2}}\\, \\|v\\|_{L^{2}(\\Omega)}^{2}\\right) + 2\\, \\sigma \\left(C_{T}\\, \\frac{p^{2}}{h}\\, \\|v\\|_{L^{2}(\\Omega)}^{2}\\right) \\\\ = \\left( 2 E C_I \\frac{p^4}{h^2} + 2 \\sigma C_T \\frac{p^2}{h} \\right) \\|v\\|_{L^2(\\Omega)}^2 \\end{align*}\n现在将这个 $a_h(v,v)$ 的上界代入 $\\omega_{\\max}^2$ 的表达式中，$\\|v\\|_{L^2(\\Omega)}^2$ 项被消去：\n$$\n\\omega_{\\max}^2 \\le \\frac{1}{\\rho} \\left( 2 E C_I \\frac{p^4}{h^2} + 2 \\sigma C_T \\frac{p^2}{h} \\right)\n$$\n代入罚参数的定义 $\\sigma = \\gamma \\frac{E p^2}{h}$ 和波速 $c^2 = E/\\rho$：\n\\begin{align*} \\omega_{\\max}^2 \\le \\frac{1}{\\rho} \\left( 2 E C_I \\frac{p^4}{h^2} + 2 \\left(\\gamma \\frac{E p^2}{h}\\right) C_T \\frac{p^2}{h} \\right) \\\\ = 2 \\frac{E}{\\rho} \\frac{p^4}{h^2} (C_I + \\gamma C_T) \\\\ = 2 c^2 (C_I + \\gamma C_T) \\frac{p^4}{h^2} \\end{align*}\n现在，我们代入题目给定的常数值：$\\gamma = 2$, $C_I = 2$, $C_T = 2$。\n$$\n\\omega_{\\max}^2 \\le 2 c^2 (2 + 2 \\cdot 2) \\frac{p^4}{h^2} = 12 c^2 \\frac{p^4}{h^2}\n$$\n显式中心差分法的稳定性条件为 $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$，这等价于 $\\Delta t^2 \\le \\frac{4}{\\omega_{\\max}^2}$。使用我们推导出的上界：\n$$\n\\Delta t^2 \\le \\frac{4}{12 c^2 \\frac{p^4}{h^2}} = \\frac{1}{3} \\frac{h^2}{c^2 p^4}\n$$\n对两边取平方根，我们得到 CFL 稳定性界：\n$$\n\\Delta t \\le \\frac{1}{\\sqrt{3}} \\frac{h}{p^2 c}\n$$\n因此，常数 $C = \\frac{1}{\\sqrt{3}}$。\n\n2) 罚参数 $\\gamma$ 的影响\n\n罚参数 $\\gamma$ 直接控制着罚项 $\\sum_{F} \\sigma\\,[v]^2$ 的大小，该项旨在惩罚单元间的位移跳跃 $[v]$。在 DG 方法中，虚假的、非物理的数值模式通常表现为单元间的高频振荡，这会导致较大的位移跳跃 $[v]$，但单元内部的梯度可能很小。通过增加 $\\gamma$，可以显著增大对这些跳跃的能量惩罚，从而提高与这些虚假模式对应的特征值（即频率）。这有效地将它们从解的物理相关谱中“推开”，从而起到了稳定和抑制作用。\n\n然而，这种稳定作用是有代价的。从我们推导出的上界 $\\omega_{\\max}^2 \\le 2 c^2 (C_I + \\gamma C_T) \\frac{p^4}{h^2}$ 可以看出，$\\omega_{\\max}^2$ 随 $\\gamma$ 的增加而增加。由于显式时间积分的稳定性步长 $\\Delta t \\le 2/\\omega_{\\max}$ 与最大频率成反比，增加 $\\gamma$ 会导致 $\\omega_{\\max}$ 增大，从而使得最大允许时间步长 $\\Delta t$ 变小。因此，增加 $\\gamma$ 会使 CFL 条件更加严格，即 CFL 常数 $C$ 会减小。", "answer": "$$\n\\boxed{\\frac{h}{\\sqrt{3} p^{2} c}}\n$$", "id": "3518386"}, {"introduction": "岩体中的断裂是不连续性的典型代表，对流体流动和力学行为有决定性影响，准确地模拟它们是计算地球力学的核心挑战之一。本练习将虚拟单元法 (VEM) 的灵活性与界面罚函数的思想相结合，构建一个含断裂的岩体模型。通过亲手实现并组装一个包含体单元和界面单元的刚度矩阵，您将掌握使用现代数值方法处理几何复杂性和物理不连续性的实践技能，并观察界面刚度对系统整体力学响应的影响。[@problem_id:3518433]", "problem": "考虑一个二维标量反平面剪切模型，用于描述一个均匀、各向同性的岩石域，其面外位移场表示为 $u$。在没有断裂的情况下，弹性势能由 Sobolev 空间 $H^1(\\Omega)$ 上的双线性形式表示，\n$$\na(u,v) = \\int_{\\Omega} \\mu \\, \\nabla u \\cdot \\nabla v \\, d\\Omega,\n$$\n其中 $\\mu$ 是一个正剪切模量，为进行归一化而取为无量纲常数。断裂被视为一个低维界面 $\\Gamma$，位移在该界面上可能是不连续的。一个内聚能对跨越 $\\Gamma$ 的位移跳跃 $[u]$ 进行惩罚，从而产生一个附加的双线性形式\n$$\nc(u,v) = \\int_{\\Gamma} \\kappa \\, [u] \\,[v] \\, ds,\n$$\n其中 $\\kappa \\ge 0$ 是一个无量纲的界面刚度参数，$[u]$ 表示 $u$ 从 $\\Gamma$ 左侧到右侧的跳跃。该设置与界面的间断 Galerkin (DG) 表示以及体区域的虚单元法 (VEM) 表示是兼容的。\n\n在多边形单元上使用最低阶的虚单元法 (VEM) 来离散化体区域的双线性形式。对于每个具有 $N$ 个顶点 $\\{\\boldsymbol{x}_i\\}_{i=1}^N$（按逆时针顺序排列）和面积 $|E|$ 的多边形单元 $E$，定义其一致 VEM 刚度贡献\n$$\n\\boldsymbol{K}^{\\text{cons}}_E = |E| \\, \\boldsymbol{G}_E^\\top \\boldsymbol{G}_E,\n$$\n其中 $2 \\times N$ 矩阵 $\\boldsymbol{G}_E$ 的列向量为\n$$\n\\boldsymbol{g}_i = \\frac{1}{|E|} \\left( \\frac{1}{2} \\left( \\ell_{i-1} \\boldsymbol{n}_{i-1} + \\ell_i \\boldsymbol{n}_i \\right) \\right), \\quad i=1,\\dots,N,\n$$\n其中 $\\ell_i$ 是边 $i$ 的长度，$\\boldsymbol{n}_i$ 是其单位外法向量（索引模 $N$）。用一个稳定项来增强一致项，该稳定项控制 VEM 空间中的非多项式分量。令 $\\boldsymbol{R}_E$ 为一个 $N \\times 2$ 的矩阵，其第 $i$ 行为 $\\boldsymbol{x}_i - \\boldsymbol{x}_c$，其中 $\\boldsymbol{x}_c$ 是 $E$ 的形心，并令 $\\boldsymbol{1}$ 为全一的 $N$ 维向量。定义\n$$\n\\boldsymbol{c}_E = \\frac{1}{N} \\boldsymbol{R}_E^\\top \\boldsymbol{1}, \\quad \\boldsymbol{P}_E = \\frac{1}{N} \\boldsymbol{1}\\boldsymbol{1}^\\top + \\left( \\boldsymbol{R}_E - \\boldsymbol{1}\\boldsymbol{c}_E^\\top \\right) \\boldsymbol{G}_E.\n$$\n使用一个正的稳定化参数 $\\tau_E$，VEM 稳定项为\n$$\n\\boldsymbol{K}^{\\text{stab}}_E = \\tau_E \\, (\\boldsymbol{I} - \\boldsymbol{P}_E)^\\top (\\boldsymbol{I} - \\boldsymbol{P}_E),\n$$\n单元刚度为\n$$\n\\boldsymbol{K}_E = \\boldsymbol{K}^{\\text{cons}}_E + \\boldsymbol{K}^{\\text{stab}}_E.\n$$\n\n将断裂表示为一条折线 $\\Gamma$，它与两个相邻多边形单元之间的公共边重合，并使用与界面上线性形函数一致的对称内部罚跳跃泛函来离散化 $c(u,v)$。对于一个长度为 $L$、每侧有两个节点的单一平直界面段，且局部节点跳跃向量排序为 $[u_{L,1}, u_{L,2}, u_{R,1}, u_{R,2}]$，界面单元刚度为\n$$\n\\boldsymbol{K}_\\Gamma = \\kappa L \\begin{bmatrix}\n\\frac{1}{3}  \\frac{1}{6}  -\\frac{1}{3}  -\\frac{1}{6} \\\\\n\\frac{1}{6}  \\frac{1}{3}  -\\frac{1}{6}  -\\frac{1}{3} \\\\\n-\\frac{1}{3}  -\\frac{1}{6}  \\frac{1}{3}  \\frac{1}{6} \\\\\n-\\frac{1}{6}  -\\frac{1}{3}  \\frac{1}{6}  \\frac{1}{3}\n\\end{bmatrix}.\n$$\n\n构建一个单位正方形域 $[0,1] \\times [0,1]$，将其划分为两个凸四边形：\n- 左单元 $E_L$，顶点按逆时针顺序为 $(0,0), (0.5,0), (0.5,1), (0,1)$。\n- 右单元 $E_R$，顶点按逆时针顺序为 $(0.5,0), (1,0), (1,1), (0.5,1)$。\n\n将位于 $x=0.5$ 的公共垂直边视为断裂界面 $\\Gamma$。为允许位移在 $\\Gamma$ 上发生跳跃，在组装全局矩阵时，不要合并两个单元在界面上的自由度 (DOF)；而是为每一侧保留独立的自由度，并仅通过 $\\boldsymbol{K}_\\Gamma$ 将它们耦合起来。\n\n通过从全局系统中消除相应的自由度，在 $x=0$ 和 $x=1$ 的外部边界顶点（即 $(0,0), (0,1), (1,0), (1,1)$）上施加均匀 Dirichlet 边界条件 $u=0$。所有量均为无量纲。\n\n实现一个程序，该程序：\n1. 根据给定的多边形几何形状，使用上述一阶 VEM 的公式构建 $\\boldsymbol{K}_{E_L}$ 和 $\\boldsymbol{K}_{E_R}$。\n2. 在断裂界面上使用独立的自由度组装全局刚度矩阵，并根据每侧节点 $(0.5,0), (0.5,1)$ 对应的排序 $[u_{L, \\text{bottom}}, u_{L, \\text{top}}, u_{R, \\text{bottom}}, u_{R, \\text{top}}]$ 添加界面贡献 $\\boldsymbol{K}_\\Gamma$。\n3. 通过消除边界自由度来施加均匀 Dirichlet 边界条件。\n4. 对每个测试用例，计算所得对称正定矩阵的最大特征值。\n\n测试套件：\n- 用例 1：$\\kappa = 0.0$，两个单元的 $\\tau_E = 1.0$。\n- 用例 2：$\\kappa = 10^3$，两个单元的 $\\tau_E = 1.0$。\n- 用例 3：$\\kappa = 10^6$，两个单元的 $\\tau_E = 1.0$。\n- 用例 4：$\\kappa = 10^3$，两个单元的 $\\tau_E = 10.0$。\n\n您的程序应生成单行输出，其中包含四个用例的最大特征值，格式为用逗号分隔的列表并用方括号括起（例如，“[result1,result2,result3,result4]”）。所有输出均以无单位的无量纲浮点数表示。", "solution": "本问题的求解思路是首先为两个四边形单元构建虚单元法(VEM)的局部刚度矩阵。然后，根据断裂的罚函数定义，构建界面刚度矩阵。接着，将这些矩阵组装成一个考虑了界面自由度不连续的全局刚度矩阵。最后，通过消除对应于外部边界的自由度来施加Dirichlet边界条件，并计算得到的简化系统矩阵的最大特征值。剪切模量 $\\mu$ 根据归一化声明取为1。\n\n**1. 离散化与自由度**\n\n域 $\\Omega = [0,1] \\times [0,1]$ 被划分为两个矩形单元：\n- $E_L$: 顶点 $\\{(0,0), (0.5,0), (0.5,1), (0,1)\\}$\n- $E_R$: 顶点 $\\{(0.5,0), (1,0), (1,1), (0.5,1)\\}$\n\n由于断裂的存在，界面 $\\Gamma$ (位于 $x=0.5$) 上的自由度是重复的。我们为所有8个节点位移建立一个全局自由度编号系统：\n1. $(0,0)$ 处的 $u_1$\n2. $(0,1)$ 处的 $u_2$\n3. 单元 $E_L$ 在 $(0.5,0)$ 处的 $u_3$（断裂左侧）\n4. 单元 $E_L$ 在 $(0.5,1)$ 处的 $u_4$（断裂左侧）\n5. 单元 $E_R$ 在 $(0.5,0)$ 处的 $u_5$（断裂右侧）\n6. 单元 $E_R$ 在 $(0.5,1)$ 处的 $u_6$（断裂右侧）\n7. $(1,0)$ 处的 $u_7$\n8. $(1,1)$ 处的 $u_8$\n\n对于单元 $E_L$（顶点按逆时针顺序为 $(0,0), (0.5,0), (0.5,1), (0,1)$），其局部到全局的自由度映射为 $\\{1, 2, 3, 4\\} \\to \\{1, 3, 4, 2\\}$。\n对于单元 $E_R$（顶点按逆时针顺序为 $(0.5,0), (1,0), (1,1), (0.5,1)$），其映射为 $\\{1, 2, 3, 4\\} \\to \\{5, 7, 8, 6\\}$。\n\n**2. VEM 单元刚度矩阵与界面刚度矩阵**\n\n我们首先计算左单元 $E_L$ 的刚度矩阵 $\\boldsymbol{K}_{E_L}$。由于 $E_L$ 和 $E_R$ 是全等的矩形，它们的局部刚度矩阵 $\\boldsymbol{K}_E$ 是相同的。经过详细计算 VEM 公式，对于一个 $0.5 \\times 1.0$ 的矩形单元，其局部刚度矩阵 $\\boldsymbol{K}_E = \\boldsymbol{K}^{\\text{cons}}_E + \\boldsymbol{K}^{\\text{stab}}_E$ 的对界面自由度（局部节点2和3）的贡献可表示为一个 $2 \\times 2$ 子矩阵 $\\boldsymbol{A}$。\n界面刚度矩阵 $\\boldsymbol{K}_\\Gamma$ 耦合了断裂两侧的自由度 $\\{u_3, u_4, u_5, u_6\\}$。\n\n**3. 组装与边界条件**\n\n我们组装一个 $8 \\times 8$ 的全局刚度矩阵。施加的均匀Dirichlet边界条件意味着与自由度 $\\{u_1, u_2, u_7, u_8\\}$ 相关的行和列将被消除。问题简化为求解与界面自由度 $\\{u_3, u_4, u_5, u_6\\}$ 对应的 $4 \\times 4$ 子矩阵 $\\boldsymbol{K}_{final}$ 的特征值问题。\n\n该 $4 \\times 4$ 矩阵 $\\boldsymbol{K}_{final}$ 是通过对这些自由度，将来自 $E_L$, $E_R$ 和 $\\Gamma$ 的贡献相加得到的。由于几何对称性，来自 $E_L$ 和 $E_R$ 的体贡献是相同的，我们将其表示为 $2 \\times 2$ 矩阵 $\\boldsymbol{A}$。$\\boldsymbol{K}_{final}$ 具有如下块结构：\n$$\n\\boldsymbol{K}_{final} = \\begin{pmatrix} \\boldsymbol{A}  \\boldsymbol{0} \\\\ \\boldsymbol{0}  \\boldsymbol{A} \\end{pmatrix} + \\boldsymbol{K}_\\Gamma = \\begin{pmatrix} \\boldsymbol{A}  \\boldsymbol{0} \\\\ \\boldsymbol{0}  \\boldsymbol{A} \\end{pmatrix} + \\begin{pmatrix} \\boldsymbol{B}  -\\boldsymbol{B} \\\\ -\\boldsymbol{B}  \\boldsymbol{B} \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{A}+\\boldsymbol{B}  -\\boldsymbol{B} \\\\ -\\boldsymbol{B}  \\boldsymbol{A}+\\boldsymbol{B} \\end{pmatrix}\n$$\n其中 $\\boldsymbol{B} = \\kappa \\begin{pmatrix} 1/3  1/6 \\\\ 1/6  1/3 \\end{pmatrix}$。\n\n**4. 特征值分析**\n\n这个块循环矩阵的特征值是矩阵 $\\boldsymbol{A}$ 和 $\\boldsymbol{A}+2\\boldsymbol{B}$ 的特征值的集合。\n通过计算，可以得到矩阵 $\\boldsymbol{A}$ 的形式为：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 0.625+0.25\\tau_E  0.375-0.25\\tau_E \\\\ 0.375-0.25\\tau_E  0.625+0.25\\tau_E \\end{pmatrix}\n$$\n$\\boldsymbol{A}$ 的特征值为 $\\lambda(\\boldsymbol{A}) = \\{1.0, \\quad 0.25+0.5\\tau_E\\}$。\n\n$\\boldsymbol{A}+2\\boldsymbol{B}$ 的特征值为 $\\lambda(\\boldsymbol{A}+2\\boldsymbol{B}) = \\{1.0+\\kappa, \\quad 0.25+0.5\\tau_E+\\kappa/3\\}$。\n\n因此，$\\boldsymbol{K}_{final}$ 的四个特征值为:\n$$\n\\{1.0, \\quad 0.25+0.5\\tau_E, \\quad 1.0+\\kappa, \\quad 0.25+0.5\\tau_E+\\kappa/3 \\}\n$$\n我们要找的最大特征值是 $\\lambda_{\\max} = \\max(1.0+\\kappa, \\quad 0.25+0.5\\tau_E+\\kappa/3)$。\n\n**5. 测试用例计算**\n\n- **用例 1:** $\\kappa = 0.0$, $\\tau_E = 1.0$。\n$\\lambda_{\\max} = \\max(1.0+0, 0.25+0.5(1)+0) = \\max(1.0, 0.75) = 1.0$。\n\n- **用例 2:** $\\kappa = 10^3$, $\\tau_E = 1.0$。\n$\\lambda_{\\max} = \\max(1.0+1000, 0.25+0.5(1)+1000/3) = \\max(1001, 334.08...) = 1001.0$。\n\n- **用例 3:** $\\kappa = 10^6$, $\\tau_E = 1.0$。\n$\\lambda_{\\max} = \\max(1.0+10^6, 0.25+0.5(1)+10^6/3) = \\max(1000001, 333334.08...) = 1000001.0$。\n\n- **用例 4:** $\\kappa = 10^3$, $\\tau_E = 10.0$。\n$\\lambda_{\\max} = \\max(1.0+1000, 0.25+0.5(10)+1000/3) = \\max(1001, 338.58...) = 1001.0$。", "answer": "[1.0,1001.0,1000001.0,1001.0]", "id": "3518433"}]}