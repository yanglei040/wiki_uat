## 引言
在现代计算岩[土力学](@entry_id:180264)领域，如何精确模拟具有复杂几何边界、内部[不连续性](@entry_id:144108)（如断层和裂缝）以及[非线性](@entry_id:637147)材料行为的地质体，是传统数值方法面临的重大挑战。标准的连续有限元方法在处理这些问题时常显得力不从心。为了突破这些局限，间断伽辽金(DG)方法和虚单元(VEM)方法应运而生，并迅速成为计算科学的前沿工具。它们凭借处理任意[多边形网格](@entry_id:753564)的灵活性和扎实的数学基础，为解决先前难以处理的工程与科学问题开辟了新的途径。

本文旨在为读者提供一份关于DG和VEM方法的全面指南。我们将系统地剖析这两种方法，从基本原理到前沿应用，帮助读者建立深刻的理解。文章将分为三个核心部分：首先，在“原理与机制”一章中，我们将深入探讨支撑这两种方法的数学框架，解释它们如何通过数值通量和投影-稳定化等独特机制工作。接着，在“应用与跨学科联系”一章中，我们将展示这些方法在解决[弹塑性](@entry_id:193198)、断裂力学、[多物理场耦合](@entry_id:171389)等实际岩土工程问题中的强大能力。最后，“动手实践”部分将提供具体的编程练习，让读者能够将理论知识转化为实践技能。通过本文的学习，您将掌握使用DG和VEM解决复杂岩土力学问题的理论基础与实践方法。

## 原理与机制

本章旨在深入探讨间断伽辽金（Discontinuous Galerkin, DG）方法与虚单元（Virtual Element, VEM）方法的核心科学原理与内在工作机制。我们将从两种方法所依赖的数学基础出发，系统地阐述其公式构建、稳定性保障以及在处理复杂岩土力学问题时的独特优势。本章内容假设读者已对有限元方法的基本概念有所了解，并将在此基础上，揭示这些先进数值方法如何突破传统方法的局限。

### [函数空间](@entry_id:143478)基础：为不连续场量身定制的数学框架

在计算岩土力学中，我们经常遇到具有内在[不连续性](@entry_id:144108)的物理场，例如沿断层或岩[体节](@entry_id:187163)理的位移错动。传统的基于连续有限元的方法，其近似函数空间是标准索博列夫空间（如 $H^1(\Omega)$）的[子空间](@entry_id:150286)，这要求函数在整个求解域 $\Omega$ 上是连续的。这种连续性假设显然无法直接描述上述的物理不连续现象。为了在数学上严谨地处理这些问题，我们需要引入一种新的函数空间。

让我们首先理解为何标准[索博列夫空间](@entry_id:141995) $H^1(\Omega)$ 不适用于含跳变的函数。一个函数 $v$ 属于 $H^1(\Omega)$ 的条件是它本身及其[弱导数](@entry_id:189356)（distributional derivative）在 $\Omega$ 上都是平方可积的（即属于 $L^2(\Omega)$）。考虑一个在一维区域上具有跳变的函数 $v$。其[弱导数](@entry_id:189356)的定义依赖于对任意光滑且具有[紧支集](@entry_id:276214)的[检验函数](@entry_id:166589) $\phi$ 的积分：$\int_\Omega v \phi' dx = - \int_\Omega v' \phi dx$。若 $v$ 在某点存在跳变，通过[分部积分](@entry_id:136350)可以证明，其[弱导数](@entry_id:189356)将包含一个在该点处取值的狄拉克 $\delta$ 函数。由于 $\delta$ 函数不是一个 $L^2$ 函数，因此这个含跳变的函数 $v$ 并不属于 $H^1(\Omega)$。[@problem_id:3518357]

为了容纳这[类函数](@entry_id:146970)，我们引入**破损索博列夫空间 (broken Sobolev space)** 的概念。给定一个被剖分为一系列非重叠单元（如三角形、多边形） $K$ 的区域 $\Omega$，其剖分记为 $\mathcal{T}_h$。破损[索博列夫空间](@entry_id:141995) $H^1(\mathcal{T}_h)$ 被定义为所有在每个单元 $K$ 内部都属于标准索博列夫空间 $H^1(K)$ 的 $L^2(\Omega)$ 函数的集合。形式上：
$$
H^1(\mathcal{T}_h) = \{ v \in L^2(\Omega) \mid \forall K \in \mathcal{T}_h, v|_K \in H^1(K) \}
$$
其中 $v|_K$ 是函数 $v$ 在单元 $K$ 上的限制。这个空间天然地允许函数在单元边界上存在跳变。其范数也通过逐单元贡献的求和来定义：
$$
\|v\|_{H^1(\mathcal{T}_h)}^2 = \sum_{K \in \mathcal{T}_h} \|v\|_{H^1(K)}^2 = \sum_{K \in \mathcal{T}_h} \left( \|v\|_{L^2(K)}^2 + \|\nabla v\|_{L^2(K)}^2 \right)
$$
这里的 $\nabla v$ 是逐单元定义的梯度。显然，标准空间 $H^1(\Omega)$ 是破损空间 $H^1(\mathcal{T}_h)$ 的一个[真子集](@entry_id:152276)，该[子集](@entry_id:261956)由那些在所有内部单元边界上跳均为零（即连续）的函数构成。$H^1(\mathcal{T}_h)$ 为[DG方法](@entry_id:748369)提供了坚实的理论基础，使其能够自然地处理位移不连续等问题。[@problem_id:3518357]

### 间断伽辽金(DG)方法：格式与通量

DG方法的核心思想是在剖分的每个单元上独立构建弱形式，并通过精心设计的**数值通量 (numerical flux)** 来处理单元间的耦合。这种方法赋予了[DG方法](@entry_id:748369)高度的灵活性。

#### 从强形式到单元弱形式

我们以一个典型的[稳态](@entry_id:182458)[渗流](@entry_id:158786)问题为例，其控制方程为 $-\nabla \cdot (\kappa \nabla u) = f$，其中 $\kappa$ 是[渗透系数](@entry_id:152559)。在传统有限元中，我们在整个区域 $\Omega$ 上乘以[检验函数](@entry_id:166589) $v$ 并进行[分部积分](@entry_id:136350)。而在DG方法中，我们在单个单元 $K$ 上进行同样的操作：
$$
- \int_K (\nabla \cdot (\kappa \nabla u)) v \,dx = \int_K f v \,dx
$$
对左侧进行分部积分（使用[格林公式](@entry_id:173118)），得到：
$$
\int_K \kappa \nabla u \cdot \nabla v \,dx - \int_{\partial K} (\kappa \nabla u \cdot \boldsymbol{n}_K) v \,ds = \int_K f v \,dx
$$
其中 $\boldsymbol{n}_K$ 是单元 $K$ 边界 $\partial K$ 上的单位外法向向量。这个方程是在单个单元上成立的。将所有单元的方程相加，我们会发现在相邻单元 $K^+$ 和 $K^-$ 共享的内部界面 $F$ 上，来自两个单元的边界积分项 $(\kappa \nabla u \cdot \boldsymbol{n}_{K^+}) v$ 和 $(\kappa \nabla u \cdot \boldsymbol{n}_{K^-}) v$ 不会像连续方法那样自动抵消，因为近似解 $u_h$ 和检验函数 $v_h$ 在界面 $F$ 上的值（迹）可以来自不同侧，即 $u_h^+$ 和 $u_h^-$，它们不一定相等。

#### 数值通量的角色

为了弥合这一“间隙”并定义单元间的相互作用，DG方法引入了数值通量的概念。我们将边界积分项中的物理通量 $(\kappa \nabla u \cdot \boldsymbol{n})$ 替换为一个在界面上单值的数值通量 $\widehat{\kappa \nabla u \cdot \boldsymbol{n}}$。这个数值通量是近似解在界面两侧迹的函数，即 $\widehat{\kappa \nabla u \cdot \boldsymbol{n}} = \mathcal{F}(u_h^+, u_h^-, \nabla u_h^+, \nabla u_h^-)$。[数值通量](@entry_id:752791)的设计是DG方法的核心，它必须保证方法的**相容性 (consistency)**（即当代入真解时，数值通量等于物理通量）和**稳定性 (stability)**。

#### 定义通量的工具：[跳跃与平均算子](@entry_id:750963)

为了系统地设计数值通量，我们引入两个基本算子：**跳跃 (jump)** 算子 $[[\cdot]]$ 和**平均 (average)** 算子 $\{\!\{\cdot\}\!\}$。对于一个共享界面 $F = \partial K^+ \cap \partial K^-$ 的两个单元，我们固定一个法向 $\boldsymbol{n}_F$（例如，从 $K^+$ 指向 $K^-$）。设 $u^+$ 和 $u^-$ 分别是来自 $K^+$ 和 $K^-$ 的迹。对于不同类型的场，这些算子有标准定义：[@problem_id:3518367]

- **标量场** $u$：
  - 平均：$\{\!\{u\}\!\} := \frac{1}{2}(u^+ + u^-)$ （标量）
  - 跳跃：$[[u]] := u^+ - u^-$ （标量）。有时也定义为向量 $u^+\boldsymbol{n}^+ + u^-\boldsymbol{n}^- = (u^+ - u^-)\boldsymbol{n}_F$。为清晰起见，本章采用前者。

- **向量场** $\boldsymbol{u}$：
  - 平均：$\{\!\{\boldsymbol{u}\}\!\} := \frac{1}{2}(\boldsymbol{u}^+ + \boldsymbol{u}^-)$ （向量）
  - 跳跃：$[[\boldsymbol{u}]] := \boldsymbol{u}^+ \cdot \boldsymbol{n}^+ + \boldsymbol{u}^- \cdot \boldsymbol{n}^-$ （标量）。根据张量阶数，也可定义为张量 $(\boldsymbol{u}^+ - \boldsymbol{u}^-)\otimes \boldsymbol{n}_F$。

- **张量场** $\boldsymbol{\sigma}$：
  - 平均：$\{\!\{\boldsymbol{\sigma}\}\!\} := \frac{1}{2}(\boldsymbol{\sigma}^+ + \boldsymbol{\sigma}^-)$ （张量）
  - 跳跃：$[[\boldsymbol{\sigma}]] := \boldsymbol{\sigma}^+ \boldsymbol{n}^+ + \boldsymbol{\sigma}^- \boldsymbol{n}^-$ （向量）

这些定义对于建立严谨且性质良好的[DG格式](@entry_id:178043)至关重要。

#### [对称内部罚](@entry_id:755719)分伽辽金(SIPG)格式

以**[对称内部罚](@entry_id:755719)分伽辽金 (Symmetric Interior Penalty Galerkin, SIPG)** 格式为例，其[数值通量](@entry_id:752791)设计充分体现了DG方法的思想。对于上述[渗流](@entry_id:158786)问题，[数值通量](@entry_id:752791)取为：
$$
\widehat{\kappa \nabla u_h \cdot \boldsymbol{n}} = \{\!\{\kappa \nabla u_h\}\!\} \cdot \boldsymbol{n}_F - \sigma [[u_h]]
$$
以及一个对称项。最终的DG双线性形式包含三个部分：
1.  **体积项**：$\sum_K \int_K \kappa \nabla u_h \cdot \nabla v_h \,dx$。
2.  **相容性项**：使用物理通量的**平均值**，如 $-\sum_F \int_F (\{\!\{\kappa \nabla u_h\}\!\} \cdot \boldsymbol{n}_F [[v_h]] + \{\!\{\kappa \nabla v_h\}\!\} \cdot \boldsymbol{n}_F [[u_h]]) \,ds$。这保证了当真解代入时，格式能退化为原始的[弱形式](@entry_id:142897)。
3.  **稳定性（罚）项**：$\sum_F \int_F \sigma [[u_h]] [[v_h]] \,ds$。这一项惩罚了位移（或压力）在界面上的跳跃，从而[弱形式](@entry_id:142897)地施加了连续性。罚参数 $\sigma$ 必须足够大，以保证整个[双线性形式](@entry_id:746794)的强制性，从而确保[解的唯一性](@entry_id:143619)和稳定性。[@problem_id:3518367]

#### 双曲问题的通量设计：[迎风格式](@entry_id:756374)

DG方法的灵活性不仅体现在[椭圆问题](@entry_id:146817)上，更在[双曲守恒律](@entry_id:147752)问题中大放异彩，例如模拟[多孔介质](@entry_id:154591)中[两相流](@entry_id:153752)饱和度运移的方程。这类问题以[平流](@entry_id:270026)为主导，信息沿流速方向传播。此时，采用中心化的平均通量会导致非物理的[数值振荡](@entry_id:163720)。[DG方法](@entry_id:748369)通过**[迎风通量](@entry_id:143931) (upwind flux)** 巧妙地解决了这个问题。

[迎风格式](@entry_id:756374)的原则是：在界面上计算通量时，所用的物理状态（如饱和度 $S_w$）应取自“上游”(upwind) 单元。流动的方向由总达西速度的法向分量 $u_n = \boldsymbol{u}_t \cdot \boldsymbol{n}_F$ 的符号决定。[@problem_id:3518377]
- 如果 $u_n \ge 0$，流动从 $K^+$ 到 $K^-$，则上游状态为 $S_w^+$，[数值通量](@entry_id:752791) $\mathcal{F}^*$ 基于 $f_w(S_w^+)$ 计算。
- 如果 $u_n  0$，流动从 $K^-$ 到 $K^+$，则上游状态为 $S_w^-$，[数值通量](@entry_id:752791) $\mathcal{F}^*$ 基于 $f_w(S_w^-)$ 计算。

这种基于物理背景的设计，将正确的耗散引入格式，有效地抑制了[振荡](@entry_id:267781)，保证了数值解的稳定性和物理真实性。

#### [DG方法](@entry_id:748369)的分析：[能量守恒](@entry_id:140514)

对[DG格式](@entry_id:178043)进行理论分析是验证其性质的关键。以线性[弹性动力学](@entry_id:175818)为例，我们可以研究离散系统的能量演化。通过在半离散的[DG弱形式](@entry_id:748377)（只在空间上离散）中，选取[检验函数](@entry_id:166589) $v_h$ 为解的时间导数 $\partial_t u_h$，可以推导出离散能量 $E_h(t)$ 的时间变化率。[@problem_id:3518397]

可以证明，如果[数值通量](@entry_id:752791)是对称且非耗散的（如[中心通量](@entry_id:747204)），并且没有外力做功，那么离散系统的[总机械能](@entry_id:167353)是守恒的，即 $\frac{d}{dt}E_h(t) = 0$。这个性质对于模拟波传播等需要长期保真度的动力学问题至关重要。这也再次说明了[数值通量](@entry_id:752791)的设计直接决定了离散格式的宏观物理性质。

### 虚单元(VEM)方法：超越显式[基函数](@entry_id:170178)

虚单元方法（VEM）是一种处理任意多边形（或多面体）网格的强大新技术。其最引人注目的特点是，它在单元内部并不需要构造和使用显式的[基函数](@entry_id:170178)，这也是其“虚”的由来。

#### 核心思想：未知中的可知

VEM的出发点是，即便我们不知道单元内部[基函数](@entry_id:170178)的具体形式，只要我们能够精确计算出它们在一个预设的多项式空间上的投影，我们就能构造出一个稳定且收敛的数值格式。[@problem_id:3518393]

#### VEM空间及其自由度

在每个多边形单元 $E$ 上，我们定义一个局部的、抽象的VEM[函数空间](@entry_id:143478) $V_k(E)$。这个空间被设计为包含所有次数不超过 $k$ 的多项式 $\mathbb{P}_k(E)$，并且其成员函数在单元边界上的迹是次数不超过 $k$ 的多项式。为了操作这个抽象空间，我们不定义[基函数](@entry_id:170178)，而是定义一组**自由度 (Degrees of Freedom, DoFs)**。一个典型的VEM自由度集合包括：[@problem_id:3518392]
- 函数在单元所有**顶点**处的值。
- 当 $k \ge 2$ 时，函数在每条**边**上关于次数不超过 $k-2$ 的多项式的矩（即积分）。
- 当 $k \ge 2$ 时，函数在单元**内部**关于次数不超过 $k-2$ 的多项式的矩。

这些自由度的选择并非随意，其关键在于它们足以唯一确定函数在多项式空间 $\mathbb{P}_k(E)$ 上的投影。

#### 投影-稳定化机制

VEM的计算核心是**投影-稳定化 (projection-stabilization)** 机制。由于我们无法直接计算包含未知[基函数](@entry_id:170178)的单元刚度阵 $\int_E \mathbb{C} : \boldsymbol{\varepsilon}(u_h) : \boldsymbol{\varepsilon}(v_h) dx$，VEM将其分解为两部分：

1.  **相容性项 (Consistency Term)**：这一部分通过一个可计算的**[投影算子](@entry_id:154142)** $\Pi$ 来定义，例如到[多项式空间](@entry_id:144410) $\mathbb{P}_k(E)$ 的能量投影 $\Pi_k^\nabla$。我们计算投影后的多项式之间的[能量内积](@entry_id:167297)，即 $a(\Pi_k^\nabla u_h, \Pi_k^\nabla v_h)$。
    - **投影的[可计算性](@entry_id:276011)**：这是VEM最精妙之处。投影算子 $\Pi_k^\nabla u_h$ 的定义本身（例如，$a(\Pi_k^\nabla u_h, q) = a(u_h, q)$ 对所有 $q \in \mathbb{P}_k(E)$ 成立）涉及了未知的 $u_h$。但通过对右侧项 $a(u_h, q)$ 进行分部积分，可以将其转化为 $u_h$ 在单元边界和内部与多项式 $q$ 的导数和[拉普拉斯算子](@entry_id:146319)的积分。这些积分恰好就是我们预先定义的自由度（边界矩和内部矩）！因此，我们可以在不知道 $u_h$ 的情况下，仅凭其自由度计算出它在[多项式空间](@entry_id:144410)上的投影。[@problem_id:3518393]
    - **多项式相容性**：由于这一项是基于精确的多项式投影计算的，VEM格式能够精确地再现多项式解，保证了方法的精度。

2.  **稳定化项 (Stabilization Term)**：仅有相容性项不足以保证方法的强制性，因为它“看不见”函数中非多项式的部分（即 $u_h - \Pi_k^\nabla u_h$）。为此，必须添加一个**稳定化项** $S((I-\Pi_k^\nabla)u_h, (I-\Pi_k^\nabla)v_h)$。这个稳定化项是一个对称正定的双线性形式，它作用于函数的“高阶”或“波动”部分。它的设计也必须仅依赖于自由度，并且其尺度要与真实的能量相当，以确保整个离散格式的稳定性和最优收敛性。[@problem_id:3518393]

最终的VEM单元刚度阵由这两部分相加而成：$K_E^h = K_E^{\text{consist}} + K_E^{\text{stab}}$。

#### 实践考量与比较

- **免求积装配**：由于相容性项是多项式的积分（可以精确计算或用低阶求积），而稳定化项是自由度向量的代数运算，VEM避免了对复杂非多项式[基函数](@entry_id:170178)进行[数值求积](@entry_id:136578)的需要。这与DG方法形成对比，后者通常需要在单元体积和所有面上进行[高斯求积](@entry_id:146011)。在某些情况下，VEM的“免求积”特性可以带来显著的计算效率优势。[@problem_id:3518360]

- **几何约束**：VEM的强大灵活性并非没有代价。其理论分析和稳定性保证依赖于单元的几何形状满足一定的[正则性条件](@entry_id:166962)。最核心的条件是单元关于某个球体是**星形的 (star-shaped)**，并且其**“矮胖”参数 (“chunkiness” parameter)** $\gamma_K = h_K / \rho_K$（其中 $h_K$ 是单元直径，$\rho_K$ 是该球体半径）有一个不依赖于网格尺寸的统一上界。如果单元变得过于细长或扭曲（即 $\gamma_K$ 很大），那么用于计算投影的局部矩阵会变得病态，导致投影精度下降，进而影响整个方法的稳定性和准确性。[@problem_id:3518364]

### 在岩土力学中的高等应用

DG和VEM方法不仅在理论上优美，更在解决岩土工程中的棘手问题时展示出强大的威力。

#### 处理材料强非均质性

岩土材料通常具有高度的非均质性，材料参数（如[弹性模量](@entry_id:198862) $E$）在空间上可能存在[数量级](@entry_id:264888)的跳变。在这种情况下，数值方法的**鲁棒性 (robustness)** 至关重要。以[SIPG方法](@entry_id:754927)为例，罚参数 $\sigma$ 的设计直接影响其鲁棒性。如果罚参数简单地使用材料参数的**算术平均 (arithmetic average)**，当界面两侧材料性质差异巨大时，可能会导致罚分不足，从而破坏方法的稳定性。[@problem_id:3518398]

一个更鲁棒的选择是使用**谐和平均 (harmonic average)** 来计算罚参数中的材料部分。例如，$\sigma \propto \frac{2E_L E_R}{E_L+E_R}$。其物理直觉是，跨界面的通量（无论是热流、水流还是应力）往往受到“瓶颈”一侧，即刚度或渗透性较低一侧的限制。谐和平均能够更好地反映这种物理行为，确保罚参数在整个参数空间内都保持在合适的量级，从而使格式的稳定性对材料参数的剧烈跳变不敏感。这一设计原则同样适用于VEM中稳定化项的尺度选择。

#### 克服体积闭锁

在模拟[近不可压缩材料](@entry_id:752388)（如饱和黏土）时，标准的低阶位移[有限元法](@entry_id:749389)会遭遇**体积闭锁 (volumetric locking)** 现象。当材料的拉梅参数 $\lambda \gg \mu$ 时，[应变能](@entry_id:162699)中的体积项 $\lambda (\nabla \cdot \boldsymbol{u})^2$ 变得非常大，迫使离散解满足近乎处处为零的体积应变条件 $\nabla \cdot \boldsymbol{u}_h \approx 0$。然而，低阶单元（如线性三角形元）的函数空间过于“贫乏”，无法在满足该约束的同时还能很好地逼近真实解，导致数值结果异常偏硬，失去物理意义。[@problem_id:3518423]

DG和VEM都提供了有效的解决方案：
- **DG的[混合格式](@entry_id:167436)**：DG方法可以通过引入一个独立的压力变量 $p_h$ 来作为不可压缩约束的[拉格朗日乘子](@entry_id:142696)，从而构建稳定的[混合格式](@entry_id:167436)。这种方法的成功依赖于位移和压力近似空间的选择必须满足关键的LBB（Ladyzhenskaya–Babuška–Brezzi）稳定化条件。DG框架的灵活性使得构造满足[LBB条件](@entry_id:746626)的单元对（如$P_k-P_{k-1}$）相对容易。

- **VEM的投影方法**：VEM可以采用一种更直接的方式。在其位移格式中，将能量[双线性形式](@entry_id:746794)分解为偏量[部分和](@entry_id:162077)体积部分。然后，用一个基于低阶投影的项来替换原来的体积项。例如，用 $\int_E \lambda (\Pi^0(\nabla \cdot \boldsymbol{u}_h))(\Pi^0(\nabla \cdot \boldsymbol{v}_h)) dx$ 替换 $\int_E \lambda (\nabla \cdot \boldsymbol{u}_h)(\nabla \cdot \boldsymbol{v}_h) dx$，其中 $\Pi^0$ 是到分片常数空间的 $L^2$ 投影。这种做法放宽了不可压缩约束，效果类似于传统FEM中的“[选择性减缩积分](@entry_id:168281)”(SRI)，但VEM通过其严谨的投影-稳定化框架，能够在避免闭锁的同时，依然保持对多项式解的精确再现能力，从而避免了SRI可能带来的精度损失问题。[@problem_id:3518423]

综上所述，DG和VEM通过截然不同但都极具创造性的方式，扩展了[数值模拟](@entry_id:137087)的能力边界。[DG方法](@entry_id:748369)通过在单元间引入[数值通量](@entry_id:752791)，获得了处理[不连续性](@entry_id:144108)和双曲问题的灵活性；而VEM通过放弃显式[基函数](@entry_id:170178)，利用投影和代数稳定化，实现了在任意形状网格上的高阶逼近。这些原理和机制为解决计算岩[土力学](@entry_id:180264)中的前沿挑战提供了强有力的理论工具。