{"hands_on_practices": [{"introduction": "颗粒材料的宏观力学行为，如刚度和强度，深刻地受到其内部接触网络几何排列的影响。这种排列方式，即所谓的“组构”（fabric），是连接微观结构与宏观响应的关键。本练习将指导您如何通过计算组构张量来量化这种结构上的各向异性，这是分析离散元模拟（DEM）结果和理解材料内部状态的一项基本技能。[@problem_id:3507288]", "problem": "一个三维周期性颗粒代表体积元 (RVE) 包含一个由离散元法 (DEM) 模拟解析得到的小的接触集合。RVE 是一个边长为 $L$、体积为 $V=L^{3}$ 的立方体，周期性边界条件确保分支向量采用最小镜像约定。接触几何以一组连接颗粒中心的分支向量 $\\{\\boldsymbol{\\ell}^{(c)}\\}$ 及其相关的单位接触法向量 $\\{\\boldsymbol{n}^{(c)}\\}$ 的形式给出，其中 $c=1,\\dots,N_{c}$ 且 $N_{c}=6$。数据如下：\n- $c=1$: $\\boldsymbol{\\ell}^{(1)}=(1.2\\times 10^{-3},\\,0,\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(1)}=(1,\\,0,\\,0)$,\n- $c=2$: $\\boldsymbol{\\ell}^{(2)}=(1.1\\times 10^{-3},\\,0,\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(2)}=(1,\\,0,\\,0)$,\n- $c=3$: $\\boldsymbol{\\ell}^{(3)}=(0,\\,0.9\\times 10^{-3},\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(3)}=(0,\\,1,\\,0)$,\n- $c=4$: $\\boldsymbol{\\ell}^{(4)}=(0,\\,0.8\\times 10^{-3},\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(4)}=(0,\\,1,\\,0)$,\n- $c=5$: $\\boldsymbol{\\ell}^{(5)}=(0,\\,0,\\,0.7\\times 10^{-3})\\,\\text{m}$, $\\boldsymbol{n}^{(5)}=(0,\\,0,\\,1)$,\n- $c=6$: $\\boldsymbol{\\ell}^{(6)}=(0,\\,0,\\,0.6\\times 10^{-3})\\,\\text{m}$, $\\boldsymbol{n}^{(6)}=(0,\\,0,\\,1)$。\n\n从组构的基本定义（即单位球面上接触方向分布的二阶矩）出发，并认识到在周期性单元中，分支长度为离散接触提供了一种物理上合理的空间加权度量，请推导一个用 $\\{\\boldsymbol{n}^{(c)}\\}$ 和 $\\{|\\boldsymbol{\\ell}^{(c)}|\\}$ 表示的、自洽的、迹归一化的组构张量 $F_{ij}$ 表达式。使用该表达式计算给定数据的 $F_{ij}$ 分量。然后，计算 $F_{ij}$ 的特征值和特征向量，以及各向异性指数\n$$\na=\\frac{\\lambda_{\\max}-\\lambda_{\\min}}{\\lambda_{\\max}+\\lambda_{\\min}}\\,,\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $F_{ij}$ 的最大和最小特征值。在颗粒材料的计算微观力学框架内，解释 $F_{ij}$、其主方向以及 $a$ 的物理意义，重点关注周期性和分支长度加权如何影响这些量。\n\n将最终的各向异性指数四舍五入到四位有效数字。用小数表示各向异性指数，且不包含单位。", "solution": "该问题被评估为有效，因为它科学地基于计算微观力学的原理，问题提法良好，数据充分且一致，并以客观、正式的语言陈述。该问题要求推导和计算离散颗粒系统的组构张量，这是该领域的标准程序。\n\n组构张量 $F_{ij}$ 是描述颗粒材料接触网络几何各向异性的一个描述符。它被定义为接触方向分布函数 $E(\\boldsymbol{n})$ 在单位球面 $\\Omega$ 上的二阶矩。对于连续分布，其表达式为：\n$$\nF_{ij} = \\int_{\\Omega} n_i n_j E(\\boldsymbol{n}) d\\Omega\n$$\n对于一个包含 $N_c$ 个接触的离散系统，该积分变为一个加权和：\n$$\nF_{ij} = C \\sum_{c=1}^{N_c} w^{(c)} n_i^{(c)} n_j^{(c)}\n$$\n其中 $\\boldsymbol{n}^{(c)}$ 是接触 $c$ 的单位法向量， $w^{(c)}$ 是一个加权因子， $C$ 是一个归一化常数。\n\n问题指明，分支长度 $\\{|\\boldsymbol{\\ell}^{(c)}|\\}$ 应用作物理上合理的加权因子，因此 $w^{(c)} = |\\boldsymbol{\\ell}^{(c)}|$。因此，未归一化的组构张量 $\\tilde{F}_{ij}$ 为：\n$$\n\\tilde{F}_{ij} = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_i^{(c)} n_j^{(c)}\n$$\n问题要求一个迹归一化的表达式，这意味着最终张量的迹 $\\text{tr}(\\boldsymbol{F}) = F_{kk} = \\sum_{k=1}^3 F_{kk}$ 必须等于 1。我们首先计算未归一化张量 $\\tilde{F}_{ij}$ 的迹：\n$$\n\\text{tr}(\\tilde{\\boldsymbol{F}}) = \\sum_{k=1}^3 \\tilde{F}_{kk} = \\sum_{k=1}^3 \\left( \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_k^{(c)} n_k^{(c)} \\right) = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| \\left( \\sum_{k=1}^3 n_k^{(c)} n_k^{(c)} \\right)\n$$\n由于每个 $\\boldsymbol{n}^{(c)}$ 都是单位向量，内部的和为 $|\\boldsymbol{n}^{(c)}|^2 = 1$。这将迹简化为：\n$$\n\\text{tr}(\\tilde{\\boldsymbol{F}}) = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}|\n$$\n为实现迹归一化，我们必须将 $\\tilde{F}_{ij}$ 除以其迹。这就得到了组构张量的自洽、迹归一化的表达式：\n$$\nF_{ij} = \\frac{\\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_i^{(c)} n_j^{(c)}}{\\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}|}\n$$\n现在，我们使用给定的数据计算 $F_{ij}$ 的分量。首先，我们计算分支向量的模及其总和。\n对于 $c=1$, $|\\boldsymbol{\\ell}^{(1)}| = 1.2 \\times 10^{-3}\\,\\text{m}$.\n对于 $c=2$, $|\\boldsymbol{\\ell}^{(2)}| = 1.1 \\times 10^{-3}\\,\\text{m}$.\n对于 $c=3$, $|\\boldsymbol{\\ell}^{(3)}| = 0.9 \\times 10^{-3}\\,\\text{m}$.\n对于 $c=4$, $|\\boldsymbol{\\ell}^{(4)}| = 0.8 \\times 10^{-3}\\,\\text{m}$.\n对于 $c=5$, $|\\boldsymbol{\\ell}^{(5)}| = 0.7 \\times 10^{-3}\\,\\text{m}$.\n对于 $c=6$, $|\\boldsymbol{\\ell}^{(6)}| = 0.6 \\times 10^{-3}\\,\\text{m}$.\n\n归一化分母是这些长度的总和：\n$$\n\\sum_{c=1}^{6} |\\boldsymbol{\\ell}^{(c)}| = (1.2 + 1.1 + 0.9 + 0.8 + 0.7 + 0.6) \\times 10^{-3}\\,\\text{m} = 5.3 \\times 10^{-3}\\,\\text{m}\n$$\n接下来，我们计算未归一化张量 $\\tilde{F}_{ij}$ 的分量。项 $n_i^{(c)} n_j^{(c)}$ 是法向量与其自身的外积。\n接触 $c=1$ 和 $c=2$ 的法向量为 $\\boldsymbol{n}=(1,0,0)$。它们的贡献仅在于 $\\tilde{F}_{11}$。\n$\\tilde{F}_{11} = |\\boldsymbol{\\ell}^{(1)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(2)}| (1 \\cdot 1) = (1.2 + 1.1) \\times 10^{-3} = 2.3 \\times 10^{-3}\\,\\text{m}$。\n接触 $c=3$ 和 $c=4$ 的法向量为 $\\boldsymbol{n}=(0,1,0)$。它们的贡献仅在于 $\\tilde{F}_{22}$。\n$\\tilde{F}_{22} = |\\boldsymbol{\\ell}^{(3)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(4)}| (1 \\cdot 1) = (0.9 + 0.8) \\times 10^{-3} = 1.7 \\times 10^{-3}\\,\\text{m}$。\n接触 $c=5$ 和 $c=6$ 的法向量为 $\\boldsymbol{n}=(0,0,1)$。它们的贡献仅在于 $\\tilde{F}_{33}$。\n$\\tilde{F}_{33} = |\\boldsymbol{\\ell}^{(5)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(6)}| (1 \\cdot 1) = (0.7 + 0.6) \\times 10^{-3} = 1.3 \\times 10^{-3}\\,\\text{m}$。\n所有 $i \\neq j$ 的非对角分量 $\\tilde{F}_{ij}$ 均为零，因为没有一个接触法向量具有多于一个的非零分量。\n未归一化的张量为：\n$$\n\\tilde{\\boldsymbol{F}} = \\begin{pmatrix} 2.3  & 0 & 0 \\\\ 0 & 1.7 & 0 \\\\ 0 & 0 & 1.3 \\end{pmatrix} \\times 10^{-3}\\,\\text{m}\n$$\n用 $\\sum |\\boldsymbol{\\ell}^{(c)}| = 5.3 \\times 10^{-3}\\,\\text{m}$ 进行归一化：\n$$\n\\boldsymbol{F} = \\frac{1}{5.3} \\begin{pmatrix} 2.3 & 0 & 0 \\\\ 0 & 1.7 & 0 \\\\ 0 & 0 & 1.3 \\end{pmatrix} = \\begin{pmatrix} \\frac{2.3}{5.3} & 0 & 0 \\\\ 0 & \\frac{1.7}{5.3} & 0 \\\\ 0 & 0 & \\frac{1.3}{5.3} \\end{pmatrix}\n$$\n组构张量是对角的。因此，其特征值是对角元素，其特征向量是标准基向量。\n特征值为：\n$\\lambda_1 = \\lambda_{\\max} = \\frac{2.3}{5.3}$\n$\\lambda_2 = \\frac{1.7}{5.3}$\n$\\lambda_3 = \\lambda_{\\min} = \\frac{1.3}{5.3}$\n相应的特征向量（组构的主方向）是：\n$\\boldsymbol{v}_1 = (1, 0, 0)^T$\n$\\boldsymbol{v}_2 = (0, 1, 0)^T$\n$\\boldsymbol{v}_3 = (0, 0, 1)^T$\n\n现在我们计算各向异性指数 $a$：\n$$\na = \\frac{\\lambda_{\\max}-\\lambda_{\\min}}{\\lambda_{\\max}+\\lambda_{\\min}} = \\frac{\\frac{2.3}{5.3} - \\frac{1.3}{5.3}}{\\frac{2.3}{5.3} + \\frac{1.3}{5.3}} = \\frac{2.3 - 1.3}{2.3 + 1.3} = \\frac{1.0}{3.6} = \\frac{1}{3.6}\n$$\n计算数值并四舍五入到四位有效数字：\n$a = \\frac{1}{3.6} = 0.27777... \\approx 0.2778$。\n\n在计算微观力学中，这些量的物理意义如下：\n组构张量 $F_{ij}$ 量化了颗粒组合体几何结构的各向异性。其分量描述了接触的优势方向。一个没有优先接触方向的各向同性材料，其组构张量应为 $F_{ij} = \\frac{1}{3}\\delta_{ij}$。由于 $F_{11} > F_{22} > F_{33}$，计算出的张量显然是各向异性的。\n$F_{ij}$ 的主方向（其特征向量）是几何结构呈现极值的坐标轴。相应的特征值代表了沿这些主方向分布的接触的统计权重。在本问题中，最大特征值 $\\lambda_{\\max} = \\lambda_1$ 对应于 $x_1$ 方向，表明这是几何组构最强的方向。这与输入数据一致，其中与 $x_1$ 方向对齐的接触具有最大的总分支长度权重。\n各向异性指数 $a$ 是一个将组构各向异性程度压缩为单个数字的标量度量，其范围从0（对于各向同性组构，$\\lambda_{\\max} = \\lambda_{\\min}$）到1（对于纯一维组构，例如所有接触都沿一个方向排列）。计算出的值 $a \\approx 0.2778$ 表明中等程度的结构各向异性。\n使用周期性边界条件对于确保小的RVE能够统计上代表一个更大的（理论上无限的）颗粒介质至关重要，因为它消除了混淆的表面效应。分支向量采用最小镜像约定进行定义，这能正确捕捉该周期性空间中的最近邻距离。按分支长度 $|\\boldsymbol{\\ell}^{(c)}|$ 加权，强调了跨越较长距离的接触所做的贡献，因此提供了一个对整体空间排列敏感的度量，而不仅仅是对特定方向上接触数量的度量。这种特定的加权选择使组构张量成为描述颗粒堆积结构骨架的指标。", "answer": "$$\\boxed{0.2778}$$", "id": "3507288"}, {"introduction": "计算微观力学的一个核心任务是将离散颗粒间的接触力“升尺度”为连续介质力学中的应力张量。Love-Weber（或称维里）应力公式为此提供了理论桥梁，但其有效性与代表性体积元（RVE）的边界条件假设密切相关。本编码练习旨在通过对比不同边界条件下（周期性与伺服控制）由维里公式和边界反力计算出的应力，深入探讨这一关键联系，并揭示均质变形假设下应力计算的精妙之处。[@problem_id:3507321]", "problem": "给定一个二维离散组合体，代表一个具有摩擦性、线弹性颗粒接触的代表性体积单元 (RVE)。该RVE是一个边长为 $L_x = L_y = 1.0$ 米的正方形，其中包含四个相同的圆形颗粒，半径为 $r = 0.12$ 米，其中心初始位置分别在 $(r,r)$、$(L_x - r, r)$、$(r, L_y - r)$ 和 $(L_x - r, L_y - r)$。接触遵循线弹性定律，包括一个法向弹簧（刚度 $k_n = 1.0\\times 10^5$ 牛顿/米）和一个切向弹簧（刚度 $k_t = 5.0\\times 10^4$ 牛顿/米）。接触法向力仅在压缩时起作用；切向弹簧在两个方向上均有响应。运动是均匀的，由变形梯度 $F$ 定义，并且接触运动学采用小应变假设。所有量必须以国际单位制 (SI) 表示，任何应力必须以帕斯卡为单位。\n\n基本原理：\n- 牛顿第二定律和线性动量守恒。\n- Cauchy 应力的定义，即跨越RVE边界传递的平均牵引力。\n- 离散系统中应力的 Love–Weber 维里表达式，它汇集了接触力和分支向量。\n- 与均匀变形引起的微小相对运动学一致的线弹性接触定律。\n\n建模假设：\n1. 在由 $F$ 给出的均匀变形下，两个相互作用点（颗粒-颗粒或颗粒-壁面接触）之间的任何分支向量 $l_0$ 映射为 $l' = F \\, l_0$。相对位移为 $\\Delta = l' - l_0$。\n2. 对于每个接触，令 $n_0 = l_0/\\|l_0\\|$ 为初始接触法向方向，并将 $\\Delta$ 分解为 $\\Delta_n = (n_0 \\cdot \\Delta)$ 和 $\\Delta_t = \\Delta - \\Delta_n n_0$。\n3. 单边法向接触定律为 $f_n = k_n \\max(0, -\\Delta_n)$（沿 $n_0$ 方向），切向弹性定律为 $f_t = k_t \\Delta_t$，从而得到接触力 $f = f_n n_0 + f_t$。\n4. 对于周期性边界，相互作用的颗粒对包括根据每个坐标上的最小镜像约定跨越域边界的颗粒对；分支向量 $l_0$ 是最小镜像差。\n5. 对于伺服控制边界，边界運動學是均匀的，颗粒-壁面接触由沿壁面法線方向、大小为 $r$ 的初始分支向量定義，这些向量通过 $F$ 映射并遵循相同的線性定律。通过对每个壁面上的颗粒-壁面接触力的相反向量求和来获得反作用力。\n\n所需计算：\n- 通过两种方法计算宏观 Cauchy 应力张量 $\\sigma_{ij}$：\n  a) Love–Weber 方法：$\\sigma_{ij}$ 通过对接触力和分支向量的并矢积进行RVE平均得到。使用由 $\\Delta$ 引起的接触力 $f$ 和当前分支向量 $l'$。\n  b) 伺服控制边界的反作用力方法：$\\sigma_{ij}$ 通过对立面上的牵引力进行平均，从壁面反作用力中获得。对于外法线为 $\\pm \\hat{e}_x$ 的垂直面，定义总反作用力 $F_{\\mathrm{left}}$ 和 $F_{\\mathrm{right}}$（向量），并计算与 $\\hat{e}_x$ 相关的列为 $\\sigma \\cdot \\hat{e}_x = \\left(F_{\\mathrm{left}} - F_{\\mathrm{right}}\\right) / \\left(2 L_y\\right)$。对于外法线为 $\\pm \\hat{e}_y$ 的水平面，定义 $F_{\\mathrm{bottom}}$ 和 $F_{\\mathrm{top}}$ 并计算 $\\sigma \\cdot \\hat{e}_y = \\left(F_{\\mathrm{bottom}} - F_{\\mathrm{top}}\\right) / \\left(2 L_x\\right)$。\n- 对于周期性边界，通过最小镜像法则确定相互作用的颗粒对，并仅使用 Love–Weber 方法计算 $\\sigma_{ij}$。\n\n使用的接触集：\n- 周期性边界：包括在水平或垂直方向上最小镜像距离等于 $2r$（容差为 $10^{-12}$ 米）的颗粒对。\n- 伺服控制边界：包括初始接触壁面的颗粒的颗粒-壁面接触。具体来说，位于 $(r,r)$ 的颗粒接触左壁和底壁，$(L_x - r,r)$ 接触右壁和底壁，$(r,L_y - r)$ 接触左壁和顶壁，$(L_x - r,L_y - r)$ 接触右壁和顶壁。将壁面接触分支向量 $l_0$ 视为左/右壁的 $(\\pm r,0)$ 和底/顶壁的 $(0,\\pm r)$。\n\n均匀变形测试套件：\n- 情况 A (单剪切)：$F = \\begin{bmatrix} 1 & \\gamma \\\\ 0 & 1 \\end{bmatrix}$，其中 $\\gamma = 0.02$ (无量纲)。\n- 情况 B (各向同性压缩)：$F = (1 + s) I$，其中 $s = -0.01$ (无量纲)。\n- 情况 C (无变形)：$F = I$。\n\n任务：\n1. 对于每个测试情况，使用周期性对接触和当前分支向量，通过 Love–Weber 方法计算周期性边界情况下的 $\\sigma_{ij}$。\n2. 对于伺服控制边界情况，使用颗粒-壁面接触，通过 Love–Weber 方法计算 $\\sigma_{ij}$，并独立地使用壁面反作用力和上述指定的牵引力平均法，通过反作用力方法计算 $\\sigma_{ij}$。\n3. 对于每个测试情况，评估均匀变形下的边界条件不变性：如果 (i) 周期性边界下的 Love–Weber 应力与伺服控制边界下的 Love–Weber 应力在分量上相等到绝对容差 $10^{-9}$ 帕斯卡以内，并且 (ii) 伺服边界下的 Love–Weber 应力与伺服边界下的基于反作用力的应力在相同容差内相等，则返回布尔值 `true`。如果两个条件都满足，则该测试情况返回 `true`；否则，返回 `false`。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，`[resultA,resultB,resultC]`），其中每个条目是分别对应于情况 A、情况 B 和情况 C 的布尔值。", "solution": "问题要求计算一个二维颗粒组合体在三种不同均匀变形下的 Cauchy 应力张量 $\\sigma$ 并进行比较。应力将使用源于两种不同边界条件 (BC) 模型（周期性和伺服控制）的三种不同方法计算。最终目标是评估这些方法对于每种变形情况是否产生相同的结果。所有量均以国际单位制 (SI) 表示。\n\n基本参数为代表性体积单元 (RVE) 边长 $L_x = L_y = 1.0$ 米，颗粒半径 $r = 0.12$ 米，法向接触刚度 $k_n = 1.0 \\times 10^5$ 牛/米，切向接触刚度 $k_t = 5.0 \\times 10^4$ 牛/米。RVE 面积为 $V = L_x L_y = 1.0$ 米$^2$。\n\n计算的核心是确定给定变形梯度 $F$ 下的接触力 $f$。对于一个初始分支向量 $l_0$，新的分支向量为 $l' = F l_0$。相对位移为 $\\Delta = l' - l_0 = (F-I) l_0$。初始单位法向量为 $n_0 = l_0/\\|l_0\\|$。位移的法向分量为 $\\Delta_n = \\Delta \\cdot n_0$。切向位移向量为 $\\Delta_t = \\Delta - \\Delta_n n_0$。接触力则为 $f = f_n n_0 + f_t$，其中法向力为 $f_n = k_n \\max(0, -\\Delta_n)$（仅压缩），切向力为 $f_t = k_t \\Delta_t$。\n\n需要比较的三个应力张量是：\n1.  $\\sigma_{\\text{periodic, LW}}$：周期性边界条件情况下的 Love-Weber 应力。\n2.  $\\sigma_{\\text{servo, LW}}$：伺服控制边界条件情况下的 Love-Weber 应力。\n3.  $\\sigma_{\\text{servo, reaction}}$：伺服控制边界条件情况下根据壁面反作用力计算的应力。\n\nLove-Weber 应力由 $\\sigma_{LW} = \\frac{1}{V} \\sum_{c} f^{(c)} \\otimes l'^{(c)}$ 给出，其中求和遍及所有接触 $c$。反作用力应力根据壁面对颗粒施加的总力（$F_{\\text{left}}, F_{\\text{right}}, F_{\\text{bottom}}, F_{\\text{top}}$）计算得出，公式为 $\\sigma \\cdot \\hat{e}_x = (F_{\\text{left}} - F_{\\text{right}}) / (2 L_y)$ 和 $\\sigma \\cdot \\hat{e}_y = (F_{\\text{bottom}} - F_{\\text{top}}) / (2 L_x)$。\n\n必须为每个边界条件模型建立初始接触构型。\n对于周期性边界条件，四个颗粒形成一个方形晶格。水平和垂直方向上相邻颗粒之间的最小镜像距离为 $2r = 0.24$ 米。这导致四个激活的接触：两个水平接触和两个垂直接触。采用分支向量从索引较低的颗粒指向索引较高的颗粒（具有周期性包裹）的约定，初始分支向量为：\n$l_{0,\\text{p}}^{(1,2)} = (-0.24, 0)$ 米 和 $l_{0,\\text{p}}^{(3,4)} = (0, -0.24)$ 米，每种出现两次。\n\n对于伺服控制边界条件，四个角落的颗粒各接触两个壁面。这导致八个颗粒-壁面接触。分支向量从壁面指向颗粒中心，大小为 $r = 0.12$ 米。初始分支向量集合为：\n$l_{0,\\text{s}}$：两个接触向量为 $(0.12, 0)$，两个为 $(-0.12, 0)$，两个为 $(0, 0.12)$，两个为 $(0, -0.12)$。\n\n我们现在分析每种变形情况。\n\n**情况 A：单剪切**\n\n变形梯度为 $F = \\begin{bmatrix} 1 & \\gamma \\\\ 0 & 1 \\end{bmatrix}$，其中 $\\gamma = 0.02$。因此，$F-I = \\begin{bmatrix} 0 & 0.02 \\\\ 0 & 0 \\end{bmatrix}$。\n\n1.  **周期性边界条件，Love-Weber 应力 ($\\sigma_{\\text{p,LW}}$):**\n    对于水平接触 $l_{0} = (\\pm 0.24, 0)$，$\\Delta = (F-I)l_0 = (0, 0)$。力为零。\n    对于垂直接触 $l_{0} = (0, \\pm 0.24)$，$\\Delta = (F-I)l_0 = ( \\mp (0.02)(0.24), 0) = (\\mp 0.0048, 0)$。\n    取 $l_{0}=(0, -0.24)$，则 $n_0 = (0, -1)$。$\\Delta = (-0.0048, 0)$，所以 $\\Delta_n = \\Delta \\cdot n_0 = 0$。法向力为零。\n    切向位移为 $\\Delta_t = \\Delta = (-0.0048, 0)$。\n    切向力为 $f_t = k_t \\Delta_t = (5 \\times 10^4) (-0.0048, 0) = (-240, 0)$ 牛。所以，$f = (-240, 0)$ 牛。\n    当前分支向量为 $l' = F l_0 = (-0.0048, -0.24)$ 米。\n    并矢积为 $f \\otimes l' = \\begin{pmatrix} -240 \\\\ 0 \\end{pmatrix} \\otimes (-0.0048, -0.24) = \\begin{bmatrix} 1.152 & 57.6 \\\\ 0 & 0 \\end{bmatrix}$ 帕·米$^3$。\n    有两个这样的垂直接触。总应力为 $\\sigma_{\\text{p,LW}} = \\frac{2}{1.0} \\begin{bmatrix} 1.152 & 57.6 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 2.304 & 115.2 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n\n2.  **伺服边界条件，Love-Weber 应力 ($\\sigma_{\\text{s,LW}}$):**\n    对于水平接触 $l_{0} = (\\pm 0.12, 0)$，$\\Delta = (0, 0)$ 且 $f=0$。\n    对于垂直接触 $l_{0} = (0, \\pm 0.12)$，$\\Delta = (\\mp (0.02)(0.12), 0) = (\\mp 0.0024, 0)$。$\\Delta_n=0$，所以 $f_n=0$。\n    $f_t = k_t \\Delta_t = \\pm (5 \\times 10^4)(-0.0024, 0) = \\mp (120, 0)$ 牛。\n    对于 $l_0 = (0, -0.12)$，$f = (-120, 0)$ 牛且 $l' = (-0.0024, -0.12)$ 米。并矢为 $f \\otimes l' = \\begin{bmatrix} 0.288 & 14.4 \\\\ 0 & 0 \\end{bmatrix}$。\n    对于 $l_0 = (0, 0.12)$，$f = (120, 0)$ 牛且 $l' = (0.0024, 0.12)$ 米。并矢为 $f \\otimes l' = \\begin{bmatrix} 0.288 & 14.4 \\\\ 0 & 0 \\end{bmatrix}$。\n    每种类型的垂直接触有两个。总应力为 $\\sigma_{\\text{s,LW}} = \\frac{1}{1.0} (2+2) \\begin{bmatrix} 0.288 & 14.4 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1.152 & 57.6 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n\n3.  **伺服边界条件，反作用力应力 ($\\sigma_{\\text{s,react}}$):**\n    水平壁面接触的力为零。$F_{\\text{left}} = F_{\\text{right}} = (0,0)$。\n    两个底壁接触（$l_0 = (0,0.12)$）的力均为 $f=(120, 0)$ 牛。$F_{\\text{bottom}} = (240, 0)$ 牛。\n    两个顶壁接触（$l_0 = (0,-0.12)$）的力均为 $f=(-120, 0)$ 牛。$F_{\\text{top}} = (-240, 0)$ 牛。\n    $\\sigma \\cdot \\hat{e}_x = (F_{\\text{left}} - F_{\\text{right}}) / 2 = (0,0)$，所以 $\\sigma_{xx} = \\sigma_{yx} = 0$。\n    $\\sigma \\cdot \\hat{e}_y = (F_{\\text{bottom}} - F_{\\text{top}}) / 2 = ((240,0) - (-240,0))/2 = (240, 0)$，所以 $\\sigma_{xy}=240$, $\\sigma_{yy}=0$。\n    $\\sigma_{\\text{s,react}} = \\begin{bmatrix} 0 & 240 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n\n三个应力张量不相等。因此，情况 A 的条件为 **false**。\n\n**情况 B：各向同性压缩**\n\n变形为 $F = (1+s)I = 0.99 I$，其中 $s = -0.01$。因此，$F-I = -0.01 I$。\n\n1.  **周期性边界条件，Love-Weber 应力 ($\\sigma_{\\text{p,LW}}$):**\n    对于水平接触 $l_{0} = (-0.24, 0)$，$\\Delta = (-0.01)l_0 = (0.0024, 0)$。$n_0=(-1,0)$，所以 $\\Delta_n = -0.0024$。$\\Delta_t=0$。\n    $f_n = k_n(-\\Delta_n) = (10^5)(0.0024) = 240$ 牛。$f=f_n n_0 = (-240, 0)$ 牛。\n    $l' = 0.99 l_0 = (-0.2376, 0)$ 米。\n    $f \\otimes l' = \\begin{pmatrix} -240 \\\\ 0 \\end{pmatrix} \\otimes (-0.2376, 0) = \\begin{bmatrix} 57.024 & 0 \\\\ 0 & 0 \\end{bmatrix}$。\n    对于垂直接触 $l_{0} = (0, -0.24)$，类似地，$f=(0, -240)$ 牛，$l'=(0, -0.2376)$ 米。\n    $f \\otimes l' = \\begin{bmatrix} 0 & 0 \\\\ 0 & 57.024 \\end{bmatrix}$。\n    每种类型有两个接触，$\\sigma_{\\text{p,LW}} = \\frac{2}{1.0} (\\begin{bmatrix} 57.024 & 0 \\\\ 0 & 0 \\end{bmatrix} + \\begin{bmatrix} 0 & 0 \\\\ 0 & 57.024 \\end{bmatrix}) = \\begin{bmatrix} 114.048 & 0 \\\\ 0 & 114.048 \\end{bmatrix}$ 帕。\n\n2.  **伺服边界条件，Love-Weber 应力 ($\\sigma_{\\text{s,LW}}$):**\n    对于 $l_0 = (0.12, 0)$，$\\Delta = (-0.0012, 0)$，$\\Delta_n = -0.0012$，$f_n=120$ 牛，$f=(120,0)$ 牛。$l'=(0.1188, 0)$ 米。\n    $f \\otimes l' = \\begin{bmatrix} 14.256 & 0 \\\\ 0 & 0 \\end{bmatrix}$。\n    根据对称性，所有四个水平接触都贡献这个并矢。\n    所有四个垂直接触都贡献 $\\begin{bmatrix} 0 & 0 \\\\ 0 & 14.256 \\end{bmatrix}$。\n    总应力 $\\sigma_{\\text{s,LW}} = \\frac{4}{1.0}(\\begin{bmatrix} 14.256 & 0 \\\\ 0 & 0 \\end{bmatrix} + \\begin{bmatrix} 0 & 0 \\\\ 0 & 14.256 \\end{bmatrix}) = \\begin{bmatrix} 57.024 & 0 \\\\ 0 & 57.024 \\end{bmatrix}$ 帕。\n\n3.  **伺服边界条件，反作用力应力 ($\\sigma_{\\text{s,react}}$):**\n    左壁：两个接触力为 $f=(120,0)$ 牛，所以 $F_{\\text{left}}=(240,0)$ 牛。\n    右壁：两个接触力为 $f=(-120,0)$ 牛，所以 $F_{\\text{right}}=(-240,0)$ 牛。\n    底壁：两个接触力为 $f=(0,120)$ 牛，所以 $F_{\\text{bottom}}=(0,240)$ 牛。\n    顶壁：两个接触力为 $f=(0,-120)$ 牛，所以 $F_{\\text{top}}=(0,-240)$ 牛。\n    $\\sigma \\cdot \\hat{e}_x = ((240,0) - (-240,0))/2 = (240,0)$。\n    $\\sigma \\cdot \\hat{e}_y = ((0,240) - (0,-240))/2 = (0,240)$。\n    $\\sigma_{\\text{s,react}} = \\begin{bmatrix} 240 & 0 \\\\ 0 & 240 \\end{bmatrix}$ 帕。\n\n三个应力张量不相等。因此，情况 B 的条件为 **false**。\n\n**情况 C：无变形**\n\n变形为 $F = I$。因此，$F-I = 0$ 且对所有接触 $\\Delta=0$。\n这立即意味着所有接触力均为零，$f=0$。\n因此，所有三个应力张量都是零张量：\n$\\sigma_{\\text{p,LW}} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n$\\sigma_{\\text{s,LW}} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n$\\sigma_{\\text{s,react}} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$ 帕。\n由于所有三个张量都相同，因此满足条件。情况 C 的结果为 **true**。\n\n情况 A 和 B 中应力值的差异突出表明，微观 (Love-Weber) 和宏观 (边界牵引力) 应力定义之间的等价性，以及对边界条件的不变性，取决于关于 RVE 和边界运动学的特定假设，而这个理想化问题中提供的定义并未完全满足所有这些假设。\n\n最终评估：\n- 情况 A: false\n- 情况 B: false\n- 情况 C: true", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stresses for a granular assembly under different deformation cases\n    and boundary conditions, then assesses their equivalence.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    Lx, Ly = 1.0, 1.0\n    V = Lx * Ly\n    r = 0.12\n    kn = 1.0e5\n    kt = 5.0e4\n    tol = 1.0e-9\n\n    # --- Deformation Gradients for Test Cases ---\n    F_A = np.array([[1.0, 0.02], [0.0, 1.0]])\n    F_B = np.array([[0.99, 0.0], [0.0, 0.99]])\n    F_C = np.array([[1.0, 0.0], [0.0, 1.0]])\n    test_cases = [F_A, F_B, F_C]\n    \n    # --- Contact Definitions ---\n    # Periodic BCs: Branch vectors determined by minimum image convention.\n    # The setup results in four contacts of length 2r=0.24m.\n    # Two horizontal contacts arise from particle pairs (1,2) and (3,4).\n    # Two vertical contacts arise from particle pairs (1,3) and (2,4).\n    l0_list_periodic = [\n        np.array([-2.0 * r, 0.0]),  # Horizontal contact\n        np.array([-2.0 * r, 0.0]),  # Horizontal contact\n        np.array([0.0, -2.0 * r]),  # Vertical contact\n        np.array([0.0, -2.0 * r])   # Vertical contact\n    ]\n\n    # Servo-controlled BCs: Branch vectors from wall to particle center.\n    # Each of the 4 particles has 2 wall contacts, for a total of 8.\n    l0_list_servo = [\n        # Particle 1 at (r,r)\n        (np.array([r, 0.0]), 'left'),    \n        (np.array([0.0, r]), 'bottom'),\n        # Particle 2 at (Lx-r, r)\n        (np.array([-r, 0.0]), 'right'),\n        (np.array([0.0, r]), 'bottom'),\n        # Particle 3 at (r, Ly-r)\n        (np.array([r, 0.0]), 'left'),\n        (np.array([0.0, -r]), 'top'),\n        # Particle 4 at (Lx-r, Ly-r)\n        (np.array([-r, 0.0]), 'right'),\n        (np.array([0.0, -r]), 'top')\n    ]\n\n    # --- Helper Functions ---\n    def calculate_force(l0, F, kn_val, kt_val):\n        \"\"\"Calculates contact force based on displacement.\"\"\"\n        l0_norm = np.linalg.norm(l0)\n        if l0_norm == 0:\n            return np.zeros(2)\n        \n        I = np.identity(2)\n        delta = (F - I) @ l0\n        \n        n0 = l0 / l0_norm\n        delta_n_scalar = np.dot(delta, n0)\n        \n        # Normal force (compressive only)\n        fn_scalar = kn_val * max(0.0, -delta_n_scalar)\n        fn_vec = fn_scalar * n0\n        \n        # Tangential force\n        delta_t_vec = delta - delta_n_scalar * n0\n        ft_vec = kt_val * delta_t_vec\n        \n        return fn_vec + ft_vec\n\n    def calculate_love_weber_stress(l0_list, F, kn_val, kt_val, V_val):\n        \"\"\"Calculates Love-Weber stress tensor for a list of contacts.\"\"\"\n        sigma_lw = np.zeros((2, 2))\n        for l0 in l0_list:\n            f = calculate_force(l0, F, kn_val, kt_val)\n            l_prime = F @ l0\n            sigma_lw += np.outer(f, l_prime)\n        return sigma_lw / V_val\n\n    def calculate_servo_stresses(l0_list_s, F, kn_val, kt_val, V_val, Lx_val, Ly_val):\n        \"\"\"Calculates both Love-Weber and Reaction stresses for servo BCs.\"\"\"\n        sigma_lw = np.zeros((2, 2))\n        wall_forces = {\n            'left': np.zeros(2), 'right': np.zeros(2),\n            'bottom': np.zeros(2), 'top': np.zeros(2)\n        }\n        \n        for l0, wall_id in l0_list_s:\n            f = calculate_force(l0, F, kn_val, kt_val)\n            l_prime = F @ l0\n            sigma_lw += np.outer(f, l_prime)\n            wall_forces[wall_id] += f\n        \n        sigma_lw /= V_val\n\n        # Reaction stress calculation\n        sigma_react = np.zeros((2, 2))\n        col1 = (wall_forces['left'] - wall_forces['right']) / (2.0 * Ly_val)\n        col2 = (wall_forces['bottom'] - wall_forces['top']) / (2.0 * Lx_val)\n        sigma_react[:, 0] = col1\n        sigma_react[:, 1] = col2\n\n        return sigma_lw, sigma_react\n\n    results = []\n    for F_matrix in test_cases:\n        # 1. Periodic BCs - Love-Weber\n        sigma_p_lw = calculate_love_weber_stress(l0_list_periodic, F_matrix, kn, kt, V)\n\n        # 2. Servo BCs - Love-Weber and Reaction\n        sigma_s_lw, sigma_s_react = calculate_servo_stresses(l0_list_servo, F_matrix, kn, kt, V, Lx, Ly)\n        \n        # 3. Assessment\n        # Condition (i): periodic LW vs servo LW\n        cond1 = np.allclose(sigma_p_lw, sigma_s_lw, atol=tol, rtol=0)\n        # Condition (ii): servo LW vs servo reaction\n        cond2 = np.allclose(sigma_s_lw, sigma_s_react, atol=tol, rtol=0)\n        \n        results.append(cond1 and cond2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```", "id": "3507321"}, {"introduction": "计算模型的预测能力取决于其底层物理定律的准确性。在颗粒材料模拟中，选择合适的接触本构模型（例如，线性模型与赫兹模型）至关重要，因为它直接决定了材料在不同压力下的宏观响应。本练习将引导您使用一个强大的统计推断框架——贝叶斯模型选择，来判断哪种接触模型更能得到宏观实验数据的支持，这代表了现代计算力学中一种先进的模型验证与校准方法。[@problem_id:3507353]", "problem": "考虑一种无粘性颗粒材料，将其理想化为由半径为 $R$、有效杨氏模量为 $E^{*}$、平均配位数为 $z$ 的相同球形颗粒组成的随机、各向同性的堆积。在各向同性围压 $p$ 和可忽略的摩擦滑动条件下，于小应变时，宏观剪切模量 $G$ 通过基于牛顿运动定律和接触力-位移关系的有效介质理论，与有效法向接触刚度 $k_{n}$ 存在标度关系。对于由施加压力 $p$ 产生的平均法向接触力 $F_{n}$，考虑两种相互竞争的微观力学接触定律：\n\n- 线性接触定律：$F_{n} = k_{n} \\delta$，这意味着 $k_{n}$ 与 $F_{n}$ 和压力 $p$ 无关；升尺度后得到一个与压力无关的 $G$，建模为 $G(p; A, \\alpha=0) = A p^{0}$，其中 $A$ 是一个正的前置因子，综合了诸如 $z$、$R$ 和 $E^{*}$ 等微观结构常数。\n- Hertz (Hertz-Mindlin) 接触定律：$F_{n} = c \\delta^{3/2}$，其中 $c$ 取决于 $E^{*}$ 和 $R$，这意味着 $k_{n} = \\frac{dF_{n}}{d\\delta} \\propto \\delta^{1/2} \\propto F_{n}^{1/3}$；因为平均 $F_{n}$ 与 $p$ 成正比，升尺度后得到 $G \\propto p^{1/3}$，建模为 $G(p; A, \\alpha=1/3) = A p^{1/3}$，其中 $A$ 是一个正的前置因子。\n\n假设宏观测量的以下数据模型：给定压力 $\\{p_{i}\\}_{i=1}^{N}$ 和测量的剪切模量 $\\{G_{i}\\}_{i=1}^{N}$，对于一个指数为 $\\alpha \\in \\{0, 1/3\\}$、前置因子参数为 $A > 0$ 的接触定律模型 $\\mathcal{M}$，其数据似然为\n$$\np(\\mathcal{D} \\mid A, \\mathcal{M}) = \\prod_{i=1}^{N} \\mathcal{N}\\!\\left(G_{i} \\mid A p_{i}^{\\alpha}, \\sigma^{2}\\right),\n$$\n其中 $\\mathcal{N}(\\cdot \\mid \\mu, \\sigma^{2})$ 表示均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯（正态）密度，$\\sigma > 0$ 是一个已知的测量标准差，在给定测试用例中对所有 $i$ 均相同。设 $A$ 的先验为参数是 $(\\mu_{A}, \\sigma_{A})$ 的对数正态分布，即\n$$\np(A \\mid \\mathcal{M}) = \\frac{1}{A \\, \\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln A - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right), \\quad A > 0.\n$$\n模型 $\\mathcal{M}$ 的贝叶斯模型证据（边缘似然）为\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{0}^{\\infty} p(\\mathcal{D} \\mid A, \\mathcal{M}) \\, p(A \\mid \\mathcal{M}) \\, dA.\n$$\n使用变换 $y = \\ln A$，该积分可计算为\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} \\left[ \\prod_{i=1}^{N} \\mathcal{N}\\!\\left(G_{i} \\mid e^{y} p_{i}^{\\alpha}, \\sigma^{2}\\right) \\right] \\, \\mathcal{N}\\!\\left(y \\mid \\mu_{A}, \\sigma_{A}^{2}\\right) \\, dy.\n$$\n\n您的任务是编写一个完整、可运行的程序，对下文中的每个测试用例，计算线性模型（$\\alpha = 0$）和Hertz模型（$\\alpha = 1/3$）的证据 $\\mathcal{Z}$，对它们进行比较，并以整数形式输出每个测试用例所选的模型：如果线性模型的证据更大或相等，则输出 $0$；如果Hertz模型的证据更大，则输出 $1$。所有物理量必须以帕斯卡（Pa）为单位处理。不涉及角度。数值先验参数应设置为 $\\mu_{A} = \\ln(10^{6})$ 和 $\\sigma_{A} = 2$，这表示一个覆盖了合理的前置因子量级的广泛先验。高斯似然必须对每个测试用例使用所提供的 $\\sigma$。\n\n程序必须使用一维数值积分法，在变换后的变量 $y = \\ln A$ 上，对一个能有效捕获所有先验质量的有限区间（例如，一个围绕 $\\mu_{A}$ 的、跨越多个标准差的对称区间）进行数值计算，以评估 $\\mathcal{Z}$ 的积分。为确保数值稳健性，请在对数空间中实现被积函数，并仅在积分点上进行指数运算。\n\n测试套件：\n- 用例 $1$（预期为类Hertz标度关系）：$p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [2.80 \\cdot 10^{6}, 3.45 \\cdot 10^{6}, 4.70 \\cdot 10^{6}]$ Pa, $\\sigma = 1.5 \\cdot 10^{5}$ Pa。\n- 用例 $2$（预期为类线性标度关系）：$p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [3.25 \\cdot 10^{6}, 3.15 \\cdot 10^{6}, 3.28 \\cdot 10^{6}]$ Pa, $\\sigma = 1.2 \\cdot 10^{5}$ Pa。\n- 用例 $3$（在更宽压力范围内呈现强类Hertz标度关系）：$p = [10^{5}, 10^{6}, 5 \\cdot 10^{6}]$ Pa, $G = [2.30 \\cdot 10^{6}, 5.05 \\cdot 10^{6}, 8.60 \\cdot 10^{6}]$ Pa, $\\sigma = 5.0 \\cdot 10^{4}$ Pa。\n- 用例 $4$（因高噪声和近乎恒定的模量而具有模糊性）：$p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [3.00 \\cdot 10^{6}, 3.00 \\cdot 10^{6}, 3.00 \\cdot 10^{6}]$ Pa, $\\sigma = 5.0 \\cdot 10^{5}$ Pa。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的模型选择结果，形式为方括号内由逗号分隔的整数列表（例如，\"[0,1,1,0]\"）。整数必须按照上面列出的测试用例的顺序排列。\n\n所有计算必须在国际单位制（SI）中执行，压力和模量以帕斯卡（Pa）为单位。最终选择必须是指定的整数，除了所需的单行输出外，不应有任何额外的文本或格式。", "solution": "基本依据是在颗粒尺度上应用的牛顿第二定律 $m \\, d^{2}\\mathbf{x}/dt^{2} = \\sum \\mathbf{F}$，以及球形颗粒间的接触力-位移关系。对于小的准静态应变，惯性可以忽略不计，宏观应力源于系综平均的静态接触力和组构。在各向同性的随机堆积中，宏观剪切模量 $G$ 与平均法向接触刚度 $k_{n}$ 成比例，并乘以取决于配位数 $z$、颗粒半径 $R$ 和堆积密度的几何因子。这是从标准的均匀化论证中得出的，其中宏观应力-应变关系是通过对接触贡献求和并对小增量进行线性化来推导的。\n\n对于线性接触定律，法向力-位移关系为 $F_{n} = k_{n} \\delta$，其中 $\\delta$ 是法向重叠量。在小应变增量下，$k_{n}$ 是常数且与 $F_{n}$ 无关，从而导致宏观 $G$ 随围压 $p$ 近似为常数。我们将此常数参数化为一个正前置因子 $A$ 并写为 $G(p; A, \\alpha=0) = A p^{0} = A$。\n\n对于 Hertz (Hertz-Mindlin) 接触定律，两个半径为 $R$、有效模量为 $E^{*}$ 的等大球体之间的法向力-位移关系是 $F_{n} = \\frac{4}{3} E^{*} \\sqrt{R} \\, \\delta^{3/2}$。增量刚度为 $k_{n} = dF_{n}/d\\delta = 2 E^{*} \\sqrt{R} \\, \\delta^{1/2}$。平均接触力 $F_{n}$ 与围压 $p$ 成比例，因为平均接触力在接触网络上平衡了宏观应力。从 $F_{n} \\propto \\delta^{3/2}$ 中解出 $\\delta$ 得到 $\\delta \\propto F_{n}^{2/3}$，因此 $G \\propto k_{n} \\propto p^{1/3}$。因此，宏观剪切模量的标度关系为 $G \\propto p^{1/3}$，我们将其建模为 $G(p; A, \\alpha=1/3) = A p^{1/3}$，其中 $A > 0$ 综合了微观结构的前置因子。\n\n我们将测量值 $\\{(p_{i}, G_{i})\\}_{i=1}^{N}$ 处理为围绕模型预测值的高斯分布，其标准差 $\\sigma$ 在一个测试用例内是共享的：\n$$\np(\\mathcal{D} \\mid A, \\mathcal{M}) = \\prod_{i=1}^{N} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{\\left(G_{i} - A p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} \\right).\n$$\n我们对 $A$ 设置一个对数正态先验，\n$$\np(A \\mid \\mathcal{M}) = \\frac{1}{A \\, \\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln A - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right), \\quad A > 0,\n$$\n其中 $\\mu_{A} = \\ln(10^{6})$ 和 $\\sigma_{A} = 2$，这是一个广泛的选择，它在尊重正性的同时，为尺度提供了弱信息。\n\n贝叶斯证据是\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{0}^{\\infty} p(\\mathcal{D} \\mid A, \\mathcal{M}) \\, p(A \\mid \\mathcal{M}) \\, dA.\n$$\n变换变量为 $y = \\ln A$ 可以简化积分，因为 $dA = e^{y} dy$ 且对数正态分布中的 $1/A$ 因子被消去：\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} \\left[ \\prod_{i=1}^{N} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{\\left(G_{i} - e^{y} p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} \\right) \\right] \\frac{1}{\\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(y - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right) \\, dy.\n$$\n定义对数被积函数\n$$\n\\ell(y) = -\\sum_{i=1}^{N} \\frac{\\left(G_{i} - e^{y} p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} - N \\ln\\!\\left(\\sigma \\sqrt{2\\pi}\\right) - \\frac{(y - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} - \\ln\\!\\left(\\sigma_{A} \\sqrt{2\\pi}\\right).\n$$\n那么被积函数为 $I(y) = \\exp(\\ell(y))$，证据为 $\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} I(y) \\, dy$。在数值上，我们将积分截断至 $y \\in [\\mu_{A} - L \\sigma_{A}, \\mu_{A} + L \\sigma_{A}]$，其中L取一个较大值（例如L=10），这基本上捕获了所有的先验质量。然后可以应用一维数值积分（例如自适应Gauss-Kronrod方法）。为避免下溢并保持稳定性，我们在对数空间中计算 $\\ell(y)$，并在积分器内部进行指数运算以获得 $I(y)$。\n\n对于每个测试用例，我们计算线性模型（$\\alpha=0$）的证据 $\\mathcal{Z}(\\alpha=0)$ 和Hertz模型（$\\alpha=1/3$）的证据 $\\mathcal{Z}(\\alpha=1/3)$，然后选择证据较大的模型。由于先验分布很宽，比较主要由每种标度关系在给定压力范围内解释数据的好坏程度决定，并通过积分所编码的参数不确定性进行了适当的惩罚。\n\n程序中实现的算法步骤：\n- 将测试用例编码，包含以帕斯卡为单位的压力向量 $\\mathbf{p}$ 和模量观测值 $\\mathbf{G}$，以及以帕斯卡为单位的标量噪声 $\\sigma$。\n- 对于给定的模型指数 $\\alpha$，使用上述表达式定义对数被积函数 $\\ell(y)$，并计算 $I(y) = \\exp(\\ell(y))$。\n- 使用自适应求积法在 $y \\in [\\mu_{A} - 10 \\sigma_{A}, \\mu_{A} + 10 \\sigma_{A}]$ 上对 $I(y)$ 进行积分以获得 $\\mathcal{Z}$。\n- 比较 $\\alpha = 0$ 和 $\\alpha = 1/3$ 之间的 $\\mathcal{Z}$；如果线性模型的证据更大或相等，则输出0，否则输出1。\n- 将四个测试用例的输出聚合为单行，格式为方括号内的逗号分隔列表。\n\n通过将宏观模量标度关系建立在接触力学和有效介质推理的基础上，应用与实验测量一致的噪声模型，并使用具有物理意义的先验（正性和广泛的合理性），确保了科学的真实性。测试套件提供了覆盖范围：预期为类Hertz标度关系（用例1）、预期为类线性标度关系（用例2）、在更宽压力范围内呈现强类Hertz标度关系（用例3），以及一个模糊的高噪声场景（用例4）。最终输出是符合要求的整数，并且所有物理量都按要求以帕斯卡（Pa）为单位处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef evidence(p, G, sigma, alpha, mu_prior, sigma_prior):\n    \"\"\"\n    Compute the Bayesian evidence Z for model exponent alpha\n    with Log-Normal prior on A using integration over y = ln A.\n    \"\"\"\n    p = np.asarray(p, dtype=float)\n    G = np.asarray(G, dtype=float)\n    n = G.size\n\n    # Define log-integrand ell(y)\n    def log_integrand(y):\n        A = np.exp(y)\n        residuals = G - A * (p ** alpha)\n        # Log-likelihood\n        ll = -0.5 * np.sum((residuals / sigma) ** 2) - n * np.log(sigma * np.sqrt(2.0 * np.pi))\n        # Log-prior in y-space: Normal(y | mu_prior, sigma_prior^2)\n        lp = -0.5 * ((y - mu_prior) ** 2) / (sigma_prior ** 2) - np.log(sigma_prior * np.sqrt(2.0 * np.pi))\n        return ll + lp\n\n    def integrand(y):\n        return np.exp(log_integrand(y))\n\n    # Integrate over a wide interval capturing prior mass\n    y_min = mu_prior - 10.0 * sigma_prior\n    y_max = mu_prior + 10.0 * sigma_prior\n\n    val, err = quad(integrand, y_min, y_max, epsabs=1e-12, epsrel=1e-10, limit=200)\n    return val\n\ndef solve():\n    # Prior parameters for A (Log-Normal)\n    mu_prior = np.log(1e6)\n    sigma_prior = 2.0\n\n    # Test cases: (p_list, G_list, sigma)\n    test_cases = [\n        # Case 1: Hertz-like scaling\n        (np.array([1e5, 2e5, 5e5]), np.array([2.80e6, 3.45e6, 4.70e6]), 1.5e5),\n        # Case 2: Linear-like scaling\n        (np.array([1e5, 2e5, 5e5]), np.array([3.25e6, 3.15e6, 3.28e6]), 1.2e5),\n        # Case 3: Strong Hertz-like scaling across wider pressure span\n        (np.array([1e5, 1e6, 5e6]), np.array([2.30e6, 5.05e6, 8.60e6]), 5.0e4),\n        # Case 4: Ambiguous due to high noise\n        (np.array([1e5, 2e5, 5e5]), np.array([3.00e6, 3.00e6, 3.00e6]), 5.0e5),\n    ]\n\n    alpha_linear = 0.0\n    alpha_hertz = 1.0 / 3.0\n\n    results = []\n    for p, G, sigma in test_cases:\n        Z_linear = evidence(p, G, sigma, alpha_linear, mu_prior, sigma_prior)\n        Z_hertz = evidence(p, G, sigma, alpha_hertz, mu_prior, sigma_prior)\n        winner = 0 if Z_linear >= Z_hertz else 1\n        results.append(winner)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3507353"}]}