## 引言
颗粒物质，如沙土、谷物和粉末，在自然界和工业生产中无处不在。它们的力学行为异常复杂，兼具类固体和类流体的双重特性，准确预测其行为是岩土工程、[行星科学](@entry_id:158926)等众多领域面临的核心挑战。传统的[连续介质力学](@entry_id:155125)方法往往忽略了材料的离散本性，难以捕捉[应变局部化](@entry_id:176973)、[力链](@entry_id:199587)等关键现象。因此，建立一个能够从单个颗粒的相互作用出发，预测颗粒系统宏观响应的理论框架，成为连接微观机理与宏观行为的关键。

[计算微观力学](@entry_id:747626)通过直接模拟大量颗粒的运动和相互作用，为解决这一难题提供了强有力的“自下而上”的途径，让我们能够洞察宏观现象背后的微观起源。

本文将系统性地介绍这一前沿领域。第一章“原理与机制”将奠定理论基础，深入探讨颗粒间的接触力学模型以及离散元方法（DEM）的核心算法。第二章“应用与跨学科关联”将通过一系列实例，展示这些基本原理如何在不同科学和工程领域中解决实际问题。最后，在“动手实践”部分，我们提供了具体的编程练习，帮助读者将理论知识转化为实践能力。

通过这段结构化的学习旅程，读者将深入理解单个颗粒间精密的相互作用是如何共同“编排”出颗粒物质复杂的宏观力学行为的。

## 原理与机制

本章旨在深入探讨颗粒物质[计算微观力学](@entry_id:747626)的核心原理和机制。我们将从单个颗粒间的接触力学模型出发，逐步构建起描述颗粒系统整体行为的框架。内容将涵盖颗粒间相互作用的基本定律、多颗粒系统[数值模拟](@entry_id:137087)的关键技术，以及从微观结构和力学响应推导宏观[本构关系](@entry_id:186508)的均质化方法。通过本章的学习，读者将能够理解离散元方法（DEM）的理论基础，并掌握连接微观颗粒行为与宏观材料响应的分析工具。

### 颗粒间[接触力学](@entry_id:177379)

颗粒系统的宏观力学行为源于其组成颗粒之间在接触点上的相互作用。因此，精确描述这些相互作用的接触模型是[计算微观力学](@entry_id:747626)的第一步。这些模型必须能够捕捉颗粒间的法向排斥、切向摩擦、滚动阻抗以及可能的内聚力效应。

#### 弹性和[摩擦接触](@entry_id:749595)

最简单的接触模型是线性弹簧阻尼器模型，它假设法向力和切向力与相对位移成正比，并引入阻尼项来耗散能量。然而，对于大多数[地质材料](@entry_id:749838)和工程材料，颗粒间的接触行为是[非线性](@entry_id:637147)的。**Hertz-Mindlin模型** 是描述光滑弹性球体间接触的一个更为精确和广泛应用的理论基础 [@problem_id:3507317]。

该模型结合了Hertz关于法向接触的理论和Mindlin关于[切向接触](@entry_id:201927)的理论。对于两个半径分别为 $R_1$ 和 $R_2$、材料参数分别为 $(E_1, \nu_1)$ 和 $(E_2, \nu_2)$ 的弹性球体，其接触行为可以通过等效半径 $R$ 和等效杨氏模量 $E^*$ 来描述：
$$ \frac{1}{R} = \frac{1}{R_1} + \frac{1}{R_2} $$
$$ \frac{1}{E^*} = \frac{1 - \nu_1^2}{E_1} + \frac{1 - \nu_2^2}{E_2} $$

根据Hertz理论，当两个球体发生法向重叠（接近量）$\delta$ 时，它们之间会产生一个圆形的接触区域，其半径 $a$ 和产生的法向排斥力 $F_n$ 分别为：
$$ a = (R \delta)^{1/2} $$
$$ F_n = \frac{4}{3} E^* R^{1/2} \delta^{3/2} $$
从这些关系中可以明显看出Hertz接触的[非线性](@entry_id:637147)特征：[法向力](@entry_id:174233)与重叠量的 $3/2$ 次方成正比。这与线性弹簧模型（$F_n = k_n \delta$）形成鲜明对比，后者的法向刚度 $k_n$ 是一个常数，而Hertz模型的法向刚度 $k_n = dF_n/d\delta = 2E^*a$ 是随载荷（或重叠量）变化的。

在切向方向上，Mindlin理论描述了在[法向力](@entry_id:174233)作用下，接触面如何抵抗切向相对位移。在发生宏观滑动之前（即处于“粘滞”状态），[切向接触](@entry_id:201927)刚度 $k_t$ 与接触面半径 $a$ 成正比：
$$ k_t = 8 G^* a $$
其中，$G^*$ 是等效剪切模量，其定义为 $\frac{1}{G^*} = \frac{2 - \nu_1}{G_1} + \frac{2 - \nu_2}{G_2}$。由于 $k_t$ 依赖于 $a$，而 $a$ 又依赖于法向重叠量 $\delta$，因此切向刚度是**载荷依赖**的。法向力越大，接触面越大，切向刚度也越大。这是Hertz-Mindlin模型的一个核心特征，也是它与使用恒定切向刚度的[线性模型](@entry_id:178302)的重要区别。

当然，切向力不能无限增长。它的大小受到**[库仑摩擦定律](@entry_id:747943)**的限制。当切向力 $F_t$ 的大小达到[法向力](@entry_id:174233) $F_n$ 与[静摩擦系数](@entry_id:163255) $\mu$ 的乘积时，即 $|F_t| \ge \mu F_n$，接触面将发生宏观滑动。在离散元模拟中，必须追踪每个接触点的切向力历史，并判断其是处于[粘滞](@entry_id:201265)状态还是滑动状态。

在计算上，处理这种具有历史依赖性的[弹塑性](@entry_id:193198)摩擦行为，通常采用**[弹性预测-塑性修正](@entry_id:748860)**算法（也称为[返回映射算法](@entry_id:168456)）[@problem_id:3507326]。在一个时间步内，算法流程如下：
1.  **弹性预测**：假设整个时间步内的相对切向位移增量 $\Delta \boldsymbol{s}_t^{\mathrm{trial}}$ 完全是弹性的。基于上一步的弹性切向位移 $\boldsymbol{\xi}_t^{(n)}$，计算一个试验性的弹性位移 $\boldsymbol{\xi}_t^{\mathrm{trial}} = \boldsymbol{\xi}_t^{(n)} + \Delta \boldsymbol{s}_t^{\mathrm{trial}}$ 和相应的试验切向力 $\boldsymbol{F}_t^{\mathrm{trial}} = -k_t \boldsymbol{\xi}_t^{\mathrm{trial}}$。
2.  **屈服判断**：检查试验切向力的大小是否超出了摩擦极限。计算当前的法向力 $F_n$ 和最大允许的切向力 $F_t^{\mathrm{max}} = \mu F_n$。如果 $|\boldsymbol{F}_t^{\mathrm{trial}}| \le F_t^{\mathrm{max}}$，则接触处于[粘滞](@entry_id:201265)状态，预测值即为最[终值](@entry_id:141018)，无滑动发生。
3.  **塑性修正**：如果 $|\boldsymbol{F}_t^{\mathrm{trial}}| > F_t^{\mathrm{max}}$，则接触发生滑动。必须将试验力“[拉回](@entry_id:160816)”到屈服面（即半径为 $F_t^{\mathrm{max}}$ 的圆）上。修正后的最终切向力 $\boldsymbol{F}_t^{(n+1)}$ 的方向与试验力相同，但大小被缩减至 $F_t^{\mathrm{max}}$：
    $$ \boldsymbol{F}_t^{(n+1)} = F_t^{\mathrm{max}} \frac{\boldsymbol{F}_t^{\mathrm{trial}}}{|\boldsymbol{F}_t^{\mathrm{trial}}|} $$
    总的切向位移增量被分解为弹性部分和塑性（滑动）部分 $\Delta \boldsymbol{s}_t^{\mathrm{trial}} = \Delta \boldsymbol{\xi}_t^{\mathrm{elastic}} + \Delta \boldsymbol{s}_t^{\mathrm{slip}}$。滑动位移 $\Delta \boldsymbol{s}_t^{\mathrm{slip}}$ 可以根据更新后的弹性位移计算得出。这个过程确保了[库仑摩擦](@entry_id:169196)条件在每一步都得到满足。

#### 高级接触模型

为了更真实地模拟[颗粒材料](@entry_id:750005)，尤其是不规则形状颗粒的行为，还需要引入更高级的接触模型。

**滚动阻抗**
对于非球形或棱角状颗粒，其接触力通常不会通过颗粒中心，从而会产生抵抗相对滚动的力矩。为了在仍然使用计算上更高效的球形颗粒模型的同时近似这种效应，可以引入**滚动阻抗模型** [@problem_id:3507334]。一个常用的模型是[弹塑性](@entry_id:193198)滚动阻抗模型。该模型在接触点引入一个抵抗相对滚动[角位移](@entry_id:171094) $\theta_r$ 的力矩 $M_r$。
- **弹性阶段**：在滚动角度较小时，力矩与角度成[线性关系](@entry_id:267880)，$M_r = k_r \theta_r$，其中 $k_r$ 是滚动刚度。在此阶段，变形是可恢复的，能量以弹性势能 $U_r = \frac{1}{2} k_r \theta_r^2$ 的形式储存起来。
- **塑性阶段**：当力矩达到一个极限值 $|M_r| \ge M_{r,\max}$ 时，发生塑性滚动。力矩的大小保持在 $M_{r,\max}$，而颗粒继续发生相对滚动。在这个过程中，能量以 $ \mathcal{D} = M_{r,\max} |\dot{\theta}_r| $ 的速率被耗散掉。这保证了模型的耗散特性符合热力学第二定律。
这种现象学模型通过引入一个额外的自由度和相应的[广义力](@entry_id:169699)（力矩），有效地“集总”了颗粒形状不规则性带来的力学效应。模型的参数（如 $k_r$ 和 $M_{r,\max}$）可以通过匹配更精细的、考虑真实形状的接触模拟或实验结果来标定。例如，滚动刚度 $k_r$ 可以通过匹配真实角状接触的初始力矩-转角曲线的斜率来确定。

**内聚力**
除了排斥力和[摩擦力](@entry_id:171772)，颗粒间还可能存在吸[引力](@entry_id:175476)，即内聚力。这种力在湿[颗粒材料](@entry_id:750005)或涉及范德华力的微米级颗粒中尤为重要。
- **[毛细力](@entry_id:181817)**：在湿[颗粒材料](@entry_id:750005)中，颗粒间形成的液桥会产生显著的吸[引力](@entry_id:175476)，即**[毛细力](@entry_id:181817)** [@problem_id:3507289]。这种力主要由两部分贡献：液-气界面的表面张力，以及由于弯曲液面内外压力差（由**[Young-Laplace方程](@entry_id:138854)** $\Delta p = \gamma (1/R_1 + 1/R_2)$ 描述）导致的液体负压。对于一个轴对称的液桥，其产生的总吸[引力](@entry_id:175476)可以表示为：
    $$ F_{\mathrm{cap}} = 2\pi \gamma r_m \sin\alpha - \pi r_m^2 \Delta p $$
    其中 $r_m$ 是液桥最窄处的半径，$\alpha$ 是该处液面的[切线](@entry_id:268870)与颗粒中心连线的夹角。该模型在低饱和度、液桥呈[离散分布](@entry_id:193344)的悬挂态（pendular regime）时最为适用。
- **干黏附力**：即使在干燥条件下，由于短程分子间作用力，颗粒间也可能存在黏附。**Johnson-Kendall-Roberts (JKR) 理论**是描述这种现象的模型之一 [@problem_id:3507289]。它适用于柔性、大尺寸、具有强短程黏附的材料（对应于大的[Tabor参数](@entry_id:197289) $\mu_T \gg 1$）。[JKR理论](@entry_id:196605)预测，将两个接触的弹性球体拉开需要一个有限的[拉脱力](@entry_id:194410)，对于两个相同的球体，该力为：
    $$ F_{\mathrm{JKR}}^{\mathrm{pull-off}} = \frac{3}{2}\pi R W $$
    其中 $W$ 是单位面积的[黏附功](@entry_id:181907)。这与由液体引起的[毛细力](@entry_id:181817)在物理来源和适用范围上都有本质区别。

### 模拟颗粒系统

在建立了单个接触的力学模型后，下一步是模拟由大量颗粒组成的系统。这涉及到求解每个颗粒的[运动方程](@entry_id:170720)，并处理好系统的边界条件。

#### DEM模拟循环与[数值积分](@entry_id:136578)

离散元方法（DEM）的核心是一个时间步进循环。在每个时间步中，对系统中的所有颗粒执行以下操作：
1.  **接触搜索**：确定哪些颗粒对正在接触。
2.  **力计算**：根据前述的接触模型，计算所有接触点上的接触力。同时计算重力等体力。
3.  **[运动方程](@entry_id:170720)积分**：根据作用在每个颗粒上的合力与[合力矩](@entry_id:166772)，利用[牛顿第二定律](@entry_id:274217)（$m\ddot{\mathbf{x}} = \mathbf{F}$ 和 $I\dot{\boldsymbol{\omega}} = \mathbf{M}$）更新每个颗粒的位置和速度。

为了在计算效率和精度之间取得平衡，DEM模拟通常采用[显式时间积分](@entry_id:165797)格式。其中，**[显式中心差分法](@entry_id:168074)**，也称为**[蛙跳法](@entry_id:751210)（Leapfrog integration）**，因其[二阶精度](@entry_id:137876)和良好的稳定性而备受青睐 [@problem_id:3507348]。
该方法的关键在于**时间交错存储**：颗粒的位置 $\mathbf{x}$ 定义在整数时间步 $t^n, t^{n+1}, \dots$ 上，而速度 $\mathbf{v}$ 则定义在半整数时间步 $t^{n-1/2}, t^{n+1/2}, \dots$ 上。
一个时间步的[更新过程](@entry_id:273573)如下：
1.  已知 $t^n$ 时的位置 $\mathbf{x}^n$ 和 $t^{n-1/2}$ 时的速度 $\mathbf{v}^{n-1/2}$。首先根据位置 $\mathbf{x}^n$ 计算出此时的合力 $\mathbf{F}^n$。
2.  利用在 $t^n$ 处的加速度 $\mathbf{a}^n = \mathbf{F}^n/m$，将速度从 $t^{n-1/2}$ 更新到 $t^{n+1/2}$：
    $$ \mathbf{v}^{n+1/2} = \mathbf{v}^{n-1/2} + \frac{\Delta t}{m} \mathbf{F}^n $$
3.  利用新的半步速度 $\mathbf{v}^{n+1/2}$，将位置从 $t^n$ 更新到 $t^{n+1}$：
    $$ \mathbf{x}^{n+1} = \mathbf{x}^n + \Delta t \mathbf{v}^{n+1/2} $$
这种交错的更新方式，本质上是用中心差分来近似时间导数，从而实现了 $O(\Delta t^2)$ 的二阶精度。它与将所有变量存储在同一时间点的欧拉法（[一阶精度](@entry_id:749410)）或Velocity-[Verlet算法](@entry_id:150873)（也是[二阶精度](@entry_id:137876)，但实现方式不同）有所区别。

#### 边界条件

为了模拟无限大或大体积的材料，避免边界效应对结果的干扰，**周期性边界条件（Periodic Boundary Conditions, PBC）** 被广泛使用 [@problem_id:3507292]。
在一个由三个[晶格矢量](@entry_id:161583) $\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3$ 张成的周期性单元（体积为 $V$）中，当一个颗粒移出该单元时，它会从相对的另一面以相同的速度重新进入。这相当于将空间看作是由该单元无限平铺而成的。
在实施PBC时，必须正确处理跨越边界的相互作用。关键在于采用**[最小镜像约定](@entry_id:142070)（minimum-image convention）** 来计算任意两个颗粒 $i$ 和 $j$ 之间的相对位置矢量，也称为**枝向量（branch vector）** $\boldsymbol{\ell}^{(ij)}$。这个矢量必须是连接颗粒 $i$ 和颗粒 $j$ 所有周期性镜像之间最短的那一个。
正确的计算步骤如下：
1.  **位置包裹**：通常将颗粒的真实坐标 $\mathbf{x}_i$ 转换为在周期性单元内的分数坐标 $\mathbf{s}_i = H^{-1} \mathbf{x}_i$，其中 $H = [\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3]$ 是[晶格](@entry_id:196752)矩阵。通过取小数部分（$\mathbf{s}_i \leftarrow \mathbf{s}_i - \lfloor \mathbf{s}_i \rfloor$）可以将所有颗粒“包裹”在参考单元 $[0,1)^3$ 内。
2.  **枝向量计算**：对于一对颗粒 $i$ 和 $j$，首先计算它们分数坐标的差值 $\Delta \mathbf{s} = \mathbf{s}_j - \mathbf{s}_i$。然后，找到一个整数矢量 $\mathbf{n}_{ij}$，它是 $\Delta \mathbf{s}$ 的最近整数。最小镜像的枝向量 $\boldsymbol{\ell}^{(ij)}$ 就可以通过将相对位置从这个最近的镜像点[拉回](@entry_id:160816)原点来计算：
    $$ \boldsymbol{\ell}^{(ij)} = H ((\mathbf{s}_j - \mathbf{s}_i) - \mathbf{n}_{ij}) $$
    这个计算出的 $\boldsymbol{\ell}^{(ij)}$ 才是接触计算（如力计算、应力计算）中应该使用的正确几何量。如果直接使用包裹后坐标的差值，对于跨越边界的接触，会得到一个“绕远路”的错误矢量。

### 从微观结构到宏观行为

[计算微观力学](@entry_id:747626)的最终目标之一是建立微观颗粒尺度上的物理量与宏观[连续介质力学](@entry_id:155125)中的物理量（如应力、应变、弹性模量）之间的联系。这一过程称为均质化。

#### 微观[结构表征](@entry_id:181604)

为了建立微-宏观联系，首先需要定量地描述颗粒系统的微观结构。
- **[配位数](@entry_id:143221)（Coordination Number, $Z$）**：这是一个最基本也是最重要的结构参数，定义为平均每个颗粒的接触数。对于一个有 $N_p$ 个颗粒和 $N_c$ 个接触的系统，[配位数](@entry_id:143221)为 $Z = 2N_c / N_p$ [@problem_id:3507333]。它直接反映了颗粒堆积的紧密程度。

- **[组构张量](@entry_id:181734)（Fabric Tensor, $F_{ij}$）**：颗粒系统的力学性质通常是各向异性的，这种各向异性源于接触网络在[空间分布](@entry_id:188271)上的不均匀性。**[组构张量](@entry_id:181734)**是描述这种结构各向异性的关键工具 [@problem_id:3507340]。二阶[组构张量](@entry_id:181734)定义为所有[接触法](@entry_id:152214)向矢量 $\mathbf{n}^{(c)}$ 的二阶矩的平均值：
    $$ F_{ij} = \frac{1}{N_c} \sum_{c=1}^{N_c} n_i^{(c)} n_j^{(c)} = \langle n_i n_j \rangle $$
    该张量是对称的，且其迹 $\operatorname{tr}(\mathbf{F}) = \sum_i F_{ii} = 1$。对于一个完全各向同性的接触网络， $F_{ij} = \frac{1}{3}\delta_{ij}$（其中 $\delta_{ij}$ 是克罗内克符号）。[组构张量](@entry_id:181734)偏离 $\frac{1}{3}\mathbf{I}$ 的程度，即其偏量部分 $\mathbf{F}' = \mathbf{F} - \frac{1}{3}\mathbf{I}$，定量地描述了接触[分布](@entry_id:182848)的二阶各向异性。需要注意的是，[组构张量](@entry_id:181734)只是对接触**方向[分布函数](@entry_id:145626)（Orientation Distribution Function, ODF）** $p(\mathbf{n})$ 的一个低阶矩描述，它捕捉了主要的各向异性特征，但丢失了ODF中包含的更高阶的、更精细的结构信息。

#### 力学稳定性与等静定性

一个颗粒堆积体要能承载外力，必须是力学稳定的。**等静定（isostatic）** 概念为分析颗粒系统的力学稳定性提供了一个强大的理论框架 [@problem_id:3507333]。一个等静定系统，其内部的约束数量恰好等于自由度的数量，不多也不少。对于颗粒系统，约束来自于每个颗粒的力平衡和[力矩平衡](@entry_id:752138)方程，而自由度则来自于每个接触点上未知的力分量。
通过对约束和自由度进行计数，可以推导出达到等静定状态所需的最小配位数：
- **无摩擦刚性球体**：在 $d$ 维空间中，每个接触只能传递一个[法向力](@entry_id:174233)分量（1个未知数）。每个颗粒有 $d$ 个力[平衡方程](@entry_id:172166)（[力矩平衡](@entry_id:752138)自动满足，因为所有力都通过中心）。因此，总未知数 $N_c \times 1$ 必须等于总约束数 $N_p \times d$。由此可得，等静定[配位数](@entry_id:143221)为 $Z_{\text{frictionless}} = 2d$。例如，在三维空间中，$Z=6$。

- **有摩擦刚性球体**：每个接触可以传递一个完整的力矢量（$d$ 个未知数）。每个颗粒则有 $d$ 个力[平衡方程](@entry_id:172166)和 $\frac{d(d-1)}{2}$ 个独立的[力矩平衡](@entry_id:752138)方程（因为切向力会产生力矩）。平衡未知数和约束数， $N_c \times d = N_p \times (d + \frac{d(d-1)}{2})$，可以解出等静定配位数为 $Z_{\text{frictional}} = d+1$。例如，在三维空间中，$Z=4$。
这些等静定值是颗粒系统达到力学稳定性的[临界点](@entry_id:144653)。配位数低于此值的系统（除非有特殊[排列](@entry_id:136432)）是不稳定的。

#### 均质化：应力与刚度

均质化的核心是将离散的[微观力学](@entry_id:195009)量（力和位移）平均为宏观的连续介质场量（应力和应变）。
- **柯西[应力张量](@entry_id:148973)**：颗粒系统中的平均柯西应力可以通过著名的**Love-Weber公式**计算 [@problem_id:3507292, 3507354]：
    $$ \sigma_{ij} = \frac{1}{V} \sum_c f_i^{(c)} \ell_j^{(c)} $$
    该公式表明，宏观应力是所有接触上的力与枝向量的[并矢积](@entry_id:748716) $(\mathbf{f} \otimes \boldsymbol{\ell})$ 在体积 $V$ 上的平均。这清晰地揭示了宏观应力源于微观接触力的传递。在周期性边界条件下，枝向量 $\boldsymbol{\ell}^{(c)}$ 必须使用前述的[最小镜像约定](@entry_id:142070)来正确计算。

- **均质化[切线刚度](@entry_id:166213)**：类似于应力，材料的宏观弹性刚度也可以从微观参数中导出。宏观[切线刚度](@entry_id:166213)张量 $C_{ijkl}$ 定义了宏观应力增量 $d\sigma_{ij}$ 和应变增量 $d\epsilon_{kl}$ 之间的线性关系：$d\sigma_{ij} = C_{ijkl} d\epsilon_{kl}$。通过将应力增量表达式与基于**仿射应变假设**（即微观[接触位移](@entry_id:747788)由宏观应变场决定，$d\boldsymbol{\delta}^{(c)} = d\boldsymbol{\epsilon} \cdot \boldsymbol{\ell}^{(c)}$）的[接触力](@entry_id:165079)增量联系起来，可以推导出 $C_{ijkl}$ 的表达式 [@problem_id:3507354]。对于线性接触模型，该表达式为：
    $$ C_{ijkl} = \frac{l^2}{V} \sum_c \left[ (k_n - k_t) n_i n_j n_k n_l + \frac{k_t}{4} (\delta_{ik}n_j n_l + \delta_{il}n_j n_k + \delta_{jk}n_i n_l + \delta_{jl}n_i n_k) \right] $$
    这个公式优美地将宏观刚度 $C_{ijkl}$ 与微观[接触刚度](@entry_id:181039) $k_n, k_t$ 以及由[接触法](@entry_id:152214)向[分布](@entry_id:182848)（即组构）决定的几何项联系在一起。它也可以用二阶和四阶[组构张量](@entry_id:181734)来表示，从而明确了宏观响应对微观结构的依赖性。

- **能量一致性：[Hill-Mandel条件](@entry_id:163076)**：任何有效的均质化方案都必须满足[能量守恒](@entry_id:140514)。**[Hill-Mandel条件](@entry_id:163076)**正是这一要求的体现 [@problem_id:3507354]。它指出，在[代表性体积元](@entry_id:164290)上，宏观尺度上的[功率密度](@entry_id:194407)（[应力与应变率](@entry_id:263123)的乘积）必须等于微观尺度上所有耗散和[储能](@entry_id:264866)机制[功率密度](@entry_id:194407)的体积平均。对于颗粒系统，这意味着：
    $$ \sigma_{ij} \dot{\epsilon}_{ij} = \frac{1}{V} \sum_c f_i^{(c)} \dot{\delta}_i^{(c)} $$
    这个条件在理论上是恒等的（只要采用仿射应变假设），在数值上，它可以作为一个强有力的验证工具，检查DEM代码中应力、应变、力和位移的计算是否一致和正确。

#### [颗粒流](@entry_id:750004)变学：惯性的作用

[颗粒材料](@entry_id:750005)的力学行为不仅取决于其准静态结构，还强烈地依赖于变形速率。**[惯性数](@entry_id:750626)（Inertial Number, $I$）** 是一个关键的无量纲数，用于描述[颗粒流](@entry_id:750004)动的不同流态 [@problem_id:3507290]。它被定义为两个时间尺度的比值：一个是颗粒在压力 $p$ 下重排的微观时间尺度 $t_{\text{micro}} \sim d\sqrt{\rho/p}$（其中 $d$ 是粒径，$\rho$ 是材料密度），另一个是宏观剪切变形的时间尺度 $t_{\text{macro}} \sim 1/\dot{\gamma}$（其中 $\dot{\gamma}$ 是剪切率）。
$$ I = \frac{t_{\text{micro}}}{t_{\text{macro}}} = \dot{\gamma} d \sqrt{\frac{\rho}{p}} $$
[惯性数](@entry_id:750626)衡量了惯性效应相对于围压约束的相对重要性。根据 $I$ 的大小，[颗粒流](@entry_id:750004)动可以划分为三个主要流态：
1.  **准静态[流态](@entry_id:152820) ($I \lesssim 10^{-3}$)**：变形速率极低，惯性可以忽略。颗粒间的接触是持久的，形成强大的、能够传递应力的“[力链](@entry_id:199587)”网络。宏观应力几乎不随剪切率变化，摩擦耗散是主要的能量耗散机制。
2.  **稠密惯性[流态](@entry_id:152820) ($10^{-3} \lesssim I \lesssim 10^{-1}$)**：惯性效应变得显著。接触变得短暂，颗粒以瞬态团簇的形式运动。平均[配位数](@entry_id:143221)下降。宏观应力同时依赖于摩擦和颗粒碰撞，并开始表现出与剪切率平方相关的 Bagnold 式标度关系。
3.  **碰撞/气体流态 ($I \gtrsim 10^{-1}$)**：流动由几乎瞬时的、独立的二元碰撞主导。持久的接触和[力链](@entry_id:199587)基本消失。系统的行为类似于“[颗粒气体](@entry_id:201841)”，可以使用[气体动理学](@entry_id:140543)理论进行描述。宏观应力强烈依赖于剪切率。

[惯性数](@entry_id:750626)的引入成功地统一了从极慢到极快的[颗粒流](@entry_id:750004)动行为，为建立一个跨越不同[流态](@entry_id:152820)的统一流变本构模型（即 $\mu(I)$ [流变学](@entry_id:138671)）奠定了基础。