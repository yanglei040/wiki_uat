{"hands_on_practices": [{"introduction": "本练习旨在揭示沙漏模式的根本性质。通过分析一个采用减缩积分的 bilinear 四边形单元，你将构建一个非平凡的节点位移模式，该模式虽然导致了可见的变形，但在单元的积分点上产生的应变为零。这项实践 [@problem_id:3555206] 对于建立沙漏模式为何会出现以及为何它们在有限元模拟中构成重大挑战的直观理解至关重要。", "problem": "考虑一个用于计算岩土力学的平面应变下单四节点双线性等参四边形有限元。该单元是一个边长为 $2L$、厚度为 $t$ 的正方形，节点位于物理坐标 $(x,y)$ 处：节点 $1$ 在 $(-L,-L)$，节点 $2$ 在 $(L,-L)$，节点 $3$ 在 $(L,L)$，节点 $4$ 在 $(-L,L)$。在平面应变条件下，材料是线弹性、均质和各向同性的，其杨氏模量为 $E$，泊松比为 $\\nu$。刚度矩阵是在自然坐标系中，通过在单元中心 $(\\xi,\\eta)=(0,0)$ 使用单点高斯积分（即减缩积分）形成的。\n\n采用关于自然坐标 $(\\xi,\\eta)$ 的标准双线性形函数，以及标准等参映射 $x=L\\xi$，$y=L\\eta$。设节点位移向量排序如下\n$$\n\\boldsymbol{u}=\\begin{pmatrix}u_1  v_1  u_2  v_2  u_3  v_3  u_4  v_4\\end{pmatrix}^{\\mathsf{T}},\n$$\n其中 $u_i$ 和 $v_i$ 分别是节点 $i$ 的 $x$ 和 $y$ 方向位移。\n\n仅在单元中心使用单点高斯积分且不进行任何沙漏控制稳定化的情况下，通过寻找一个特定的节点位移向量 $\\boldsymbol{u}$（归一化使其欧几里得范数为 $1$），确定一个非平凡的沙漏模式，使得在中心点计算的应变向量恒为零。然后，使用内能的单点有限元近似，验证并计算内能\n$$\nU=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{K}$ 是通过不带稳定化的单点积分得到的单元刚度矩阵。\n\n提供：\n- 归一化沙漏节点位移向量 $\\boldsymbol{u}$ 的分量。\n- 相应的内能 $U$。\n\n内能以焦耳为单位表示。无需进行数值舍入。将最终答案以一个单行矩阵的形式返回，其中包含 $\\boldsymbol{u}$ 的八个分量，后跟 $U$。", "solution": "用户要求我解决一个计算岩土力学中的问题，具体涉及有限元分析。\n\n我的计划如下：\n1.  **验证问题陈述：** 检查其科学合理性、适定性和完整性。\n    *   **已知条件：**\n        *   单元：四节点双线性等参四边形，平面应变。\n        *   几何形状：正方形，边长 $2L$，厚度 $t$。\n        *   节点（物理坐标）：$1(-L,-L)$、$2(L,-L)$、$3(L,L)$、$4(-L,L)$。\n        *   材料：线弹性、均质、各向同性（杨氏模量 $E$，泊松比 $\\nu$）。\n        *   积分：在 $(\\xi, \\eta) = (0,0)$ 处的单点高斯积分。\n        *   映射：$x=L\\xi$, $y=L\\eta$，从自然坐标 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$。\n        *   位移：$\\boldsymbol{u}=\\begin{pmatrix}u_1  v_1  u_2  v_2  u_3  v_3  u_4  v_4\\end{pmatrix}^{\\mathsf{T}}$。\n        *   任务1：找到一个非平凡、归一化的沙漏模式 $\\boldsymbol{u}$（欧几里得范数为1），使其在中心点的应变为零。\n        *   任务2：计算此模式下的内能 $U=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u}$，其中 $\\boldsymbol{K}$ 是未稳定的、单点积分的刚度矩阵。\n        *   特殊说明：“内能以焦耳为单位表示。”和“无需进行数值舍入。”\n    *   **验证：**\n        *   该问题在科学上基于有限元方法（FEM）的理论。\n        *   该设置是演示减缩积分单元中沙漏现象的标准方法。\n        *   最初的担忧是，对于一个带有符号参数（$E, L, t, \\nu$）的问题，要求以“焦耳”为单位提供能量。这似乎存在矛盾，因为没有数值就无法指定单位。\n        *   然而，让我们分析问题的核心。根据定义，减缩积分单元的“沙漏模式”是一种在积分点产生零应变的节点位移模式。通过有限元积分法则近似的内能是这些积分点处应变的函数。\n        *   具体来说，单元内能为 $U \\approx \\frac{1}{2} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c))^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c)) \\times V_{eff}$，其中 $\\boldsymbol{x}_c$ 是积分点，$V_{eff}$ 是有效体积。\n        *   如果根据所研究模式的定义，$\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c) = \\boldsymbol{0}$，那么计算出的内能 $U$ 必须恰好为 $0$。\n        *   值 $0$ 与单位系统无关。“0 焦耳”是一个完全有效且明确的陈述。\n        *   因此，该问题没有矛盾，而是一个精心设计的问题，用以测试对沙漏模式的基本理解。它是有效的。\n\n2.  **继续求解：**\n    *   定义双线性形函数 $N_i(\\xi, \\eta)$。\n    *   定义等参映射并计算雅可比矩阵 $\\boldsymbol{J}$。\n    *   推导应变-位移矩阵 $\\boldsymbol{B}$，它通过 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\boldsymbol{u}$ 将应变向量 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_x  \\varepsilon_y  \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$ 与节点位移向量 $\\boldsymbol{u}$ 联系起来。\n    *   在积分点 $(\\xi, \\eta) = (0,0)$ 处计算 $\\boldsymbol{B}$。\n    *   在 $\\boldsymbol{B}(0,0)$ 的零空间中找到一个非平凡向量 $\\boldsymbol{u}$。该向量代表一个沙漏模式。\n    *   将此向量归一化，使其欧几里得范数为1。\n    *   使用单点积分正式写出单元刚度矩阵 $\\boldsymbol{K}$ 的表达式。\n    *   将其代入内能表达式 $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$。\n    *   证明由于 $\\boldsymbol{u}$ 是一个沙漏模式，能量 $U$ 的计算结果为零。\n    *   将最终答案组合成一个行矩阵。\n\n**分步执行：**\n\n*   **形函数：**\n    $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n*   **雅可比矩阵：**\n    $x = \\sum N_i x_i = L\\xi$, $y = \\sum N_i y_i = L\\eta$.\n    $\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} L  0 \\\\ 0  L \\end{pmatrix}$.\n    $\\boldsymbol{J}^{-1} = \\begin{pmatrix} 1/L  0 \\\\ 0  1/L \\end{pmatrix}$. $\\det(\\boldsymbol{J}) = L^2$.\n*   **中心点处的B矩阵：**\n    在 $(\\xi, \\eta) = (0,0)$ 处：\n    $\\frac{\\partial N_1}{\\partial \\xi}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}=-\\frac{1}{4}$.\n    $\\frac{\\partial N_1}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}=\\frac{1}{4}$.\n    B矩阵将应变与位移关联起来：$\\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix} = \\sum_{i=1}^4 \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}$.\n    使用 $\\frac{\\partial N_i}{\\partial x} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial y} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\eta}$，可得在中心点处的B矩阵 $\\boldsymbol{B}(0,0)$ 为：\n    $\\boldsymbol{B}(0,0) = \\frac{1}{4L} \\begin{pmatrix} -1  0  1  0  1  0  -1  0 \\\\ 0  -1  0  -1  0  1  0  1 \\\\ -1  -1  -1  1  1  1  1  -1 \\end{pmatrix}$.\n*   **沙漏模式：**\n    我们需要找到一个非零向量 $\\boldsymbol{u}$ 使得 $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$。一个标准的沙漏模式，即所谓的“弯曲”或“弓形”模式，可以由位移向量 $\\boldsymbol{u}_{raw} = \\begin{pmatrix} 1  0  -1  0  1  0  -1  0 \\end{pmatrix}^{\\mathsf{T}}$ 来表示。通过将该向量代入在积分中心点计算的应变表达式 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}(0,0)\\boldsymbol{u}$，可以验证结果为零向量，即在积分点处不产生应变。\n*   **归一化：**\n    $||\\boldsymbol{u}_{raw}||_2 = \\sqrt{1^2 + 0^2 + (-1)^2 + 0^2 + 1^2 + 0^2 + (-1)^2 + 0^2} = \\sqrt{4} = 2$.\n    $\\boldsymbol{u} = \\frac{1}{2} \\boldsymbol{u}_{raw} = \\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0 \\end{pmatrix}^{\\mathsf{T}}$.\n*   **内能：**\n    $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$.\n    使用单点积分，刚度矩阵为 $\\boldsymbol{K} = V_q \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)$，其中 $V_q = w \\det(\\boldsymbol{J}) t = 4 L^2 t$。\n    $U = \\frac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} (4 L^2 t \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)) \\boldsymbol{u}$\n    $U = 2 L^2 t (\\boldsymbol{B}(0,0)\\boldsymbol{u})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{B}(0,0)\\boldsymbol{u})$.\n    根据构造，所选的 $\\boldsymbol{u}$ 是一个沙漏模式，所以 $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$。\n    $U = 2 L^2 t (\\boldsymbol{0})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{0}) = 0$.\n*   **最终答案：**\n    向量分量为 $\\frac{1}{2}, 0, -\\frac{1}{2}, 0, \\frac{1}{2}, 0, -\\frac{1}{2}, 0$。\n    能量为 $U=0$。\n    最终答案是一个行矩阵：$\\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0  0 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  0  -\\frac{1}{2}  0  \\frac{1}{2}  0  -\\frac{1}{2}  0  0 \\end{pmatrix}}\n$$", "id": "3555206"}, {"introduction": "在理解了零能模式的起源之后，我们现在转向如何抑制它们。本练习 [@problem_id:3555177] 介绍了一种广泛应用的稳定技术，即在单元的公式中加入一个惩罚能量项来抵抗沙漏变形。你将从这个能量势函数中推导出相应的沙漏控制力，从而为如何数学上构建和实施一个稳健的三维单元控制方案提供一个具体的例子。", "problem": "考虑有限元法 (FEM) 中的一个未畸变的三线性 ($Q_1$) 八节点六面体有限元，它占据一个边长为 $h$ 的立方体，其节点处的局部等参坐标 $(\\xi,\\eta,\\zeta)$ 取值为 $\\pm 1$。该单元由各向同性线弹性材料构成，其杨氏模量为 $E$，泊松比为 $\\nu$。该单元使用单个高斯点进行积分（减缩积分）。为解决沙漏（零能）模式的出现，采用一种基于刚度的沙漏控制方法，该方法向单元中添加一个稳定能。\n\n定义位移 $x$ 分量的标量离散沙漏度量为\n$$\nq \\equiv \\sum_{i=1}^{8} u_{x,i}\\,\\xi_i\\,\\eta_i,\n$$\n其中 $u_{x,i}$ 是节点 $i$ 处位移的 $x$ 分量，$(\\xi_i,\\eta_i,\\zeta_i)\\in\\{-1,1\\}^3$ 是节点 $i$ 的局部坐标。引入稳定能\n$$\nW_{hg} \\equiv \\frac{1}{2}\\,\\beta\\,q^2,\n$$\n其中网格尺寸缩放因子 $\\beta = \\alpha\\,E\\,h$，而 $\\alpha0$ 是一个无量纲控制参数。\n\n假设在单元节点上给定以下离散位移场：\n$$\nu_{x,i} = U_0\\,\\xi_i\\,\\eta_i,\\qquad u_{y,i}=0,\\qquad u_{z,i}=0,\n$$\n对所有 $i=1,\\dots,8$ 成立，其中 $U_0$ 是一个恒定振幅。该场代表了减缩积分下的一个纯沙漏模式。\n\n任务：\n1. 从保守内力的虚功原理出发，通过对 $u_{x,i}$ 求适当的导数，推导由 $W_{hg}$ 隐含的沙漏节点力 $f^{hg}_{x,i}$。\n2. 对给定的位移场计算 $q$，并得到用 $\\alpha$、$E$、$h$ 和 $U_0$ 表示的 $f^{hg}_{x,i}$ 的显式形式。\n3. 对给定的场计算总稳定能 $W_{hg}$，并验证当 $\\alpha0$ 时其为非负。\n\n将最终的稳定能 $W_{hg}$ 表示为以 $\\alpha$、$E$、$h$ 和 $U_0$ 表示的封闭形式表达式，单位为焦耳。在最终的方框答案中不要包含单位。", "solution": "该问题经验证具有科学依据、适定、客观且自洽。它描述了在固体力学的有限元法 (FEM) 背景下进行沙漏控制的标准流程。所有定义和数据都已提供，足以执行所要求的推导和计算。\n\n解答过程按照问题陈述的要求分为三个部分。\n\n### 第 1 部分：沙漏节点力的推导\n\n沙漏节点力 $f^{hg}_{x,i}$ 是从沙漏稳定势能 $W_{hg}$ 推导出的保守力。根据保守系统的虚功原理，节点力是势能相对于相应广义坐标（即节点位移 $u_{x,i}$）的负偏导数。\n\n稳定能由下式给出：\n$$\nW_{hg} = \\frac{1}{2}\\,\\beta\\,q^2\n$$\n节点 $i$ 处位移 $x$ 分量的沙漏节点力为：\n$$\nf^{hg}_{x,i} = -\\frac{\\partial W_{hg}}{\\partial u_{x,i}}\n$$\n我们应用链式法则来计算这个导数：\n$$\nf^{hg}_{x,i} = -\\frac{\\partial}{\\partial u_{x,i}} \\left( \\frac{1}{2}\\,\\beta\\,q^2 \\right) = -\\frac{1}{2}\\,\\beta \\cdot (2q) \\cdot \\frac{\\partial q}{\\partial u_{x,i}} = -\\beta\\,q\\,\\frac{\\partial q}{\\partial u_{x,i}}\n$$\n沙漏度量 $q$ 被定义为节点位移 $u_{x,j}$ 的线性函数：\n$$\nq = \\sum_{j=1}^{8} u_{x,j}\\,\\xi_j\\,\\eta_j\n$$\n现在，我们计算 $q$ 相对于 $u_{x,i}$ 的偏导数：\n$$\n\\frac{\\partial q}{\\partial u_{x,i}} = \\frac{\\partial}{\\partial u_{x,i}} \\left( \\sum_{j=1}^{8} u_{x,j}\\,\\xi_j\\,\\eta_j \\right)\n$$\n由于节点位移 $u_{x,j}$ 是独立变量，导数 $\\frac{\\partial u_{x,j}}{\\partial u_{x,i}}$ 等于克罗内克 δ (Kronecker delta)，$\\delta_{ij}$。\n$$\n\\frac{\\partial q}{\\partial u_{x,i}} = \\sum_{j=1}^{8} \\frac{\\partial u_{x,j}}{\\partial u_{x,i}}\\,\\xi_j\\,\\eta_j = \\sum_{j=1}^{8} \\delta_{ij}\\,\\xi_j\\,\\eta_j = \\xi_i\\,\\eta_i\n$$\n将此结果代回沙漏力的表达式，我们得到沙漏节点力的一般形式：\n$$\nf^{hg}_{x,i} = -\\beta\\,q\\,\\xi_i\\,\\eta_i\n$$\n\n### 第 2 部分：对给定 位移场的评估\n\n问题规定了一个纯沙漏位移场：\n$$\nu_{x,i} = U_0\\,\\xi_i\\,\\eta_i, \\qquad u_{y,i}=0, \\qquad u_{z,i}=0\n$$\n首先，我们对这个特定的位移场评估标量沙漏度量 $q$。\n$$\nq = \\sum_{i=1}^{8} u_{x,i}\\,\\xi_i\\,\\eta_i = \\sum_{i=1}^{8} (U_0\\,\\xi_i\\,\\eta_i)\\,\\xi_i\\,\\eta_i = U_0 \\sum_{i=1}^{8} (\\xi_i\\,\\eta_i)^2 = U_0 \\sum_{i=1}^{8} \\xi_i^2\\,\\eta_i^2\n$$\n对于六面体单元的每个节点 $i$，其局部坐标 $\\xi_i$ 和 $\\eta_i$ 要么是 $-1$，要么是 $1$。因此，它们的平方总是 1：\n$$\n\\xi_i^2 = (\\pm 1)^2 = 1 \\qquad \\text{和} \\qquad \\eta_i^2 = (\\pm 1)^2 = 1\n$$\n因此，对于所有 $i=1, \\dots, 8$，$\\xi_i^2\\,\\eta_i^2 = 1$。求和变为：\n$$\nq = U_0 \\sum_{i=1}^{8} 1 = 8\\,U_0\n$$\n现在，我们可以通过将 $q=8\\,U_0$ 和 $\\beta=\\alpha\\,E\\,h$ 的表达式代入第 1 部分推导出的公式，来写出沙漏节点力 $f^{hg}_{x,i}$ 的显式形式。\n$$\nf^{hg}_{x,i} = -\\beta\\,q\\,\\xi_i\\,\\eta_i = -(\\alpha\\,E\\,h)\\,(8\\,U_0)\\,\\xi_i\\,\\eta_i\n$$\n$$\nf^{hg}_{x,i} = -8\\,\\alpha\\,E\\,h\\,U_0\\,\\xi_i\\,\\eta_i\n$$\n\n### 第 3 部分：总稳定能的计算\n\n总稳定能 $W_{hg}$ 是使用其定义和上面推导出的值来计算的。\n$$\nW_{hg} = \\frac{1}{2}\\,\\beta\\,q^2\n$$\n代入 $\\beta = \\alpha\\,E\\,h$ 和 $q = 8\\,U_0$：\n$$\nW_{hg} = \\frac{1}{2}\\,(\\alpha\\,E\\,h)\\,(8\\,U_0)^2 = \\frac{1}{2}\\,\\alpha\\,E\\,h\\,(64\\,U_0^2)\n$$\n$$\nW_{hg} = 32\\,\\alpha\\,E\\,h\\,U_0^2\n$$\n为了验证该能量为非负，我们检查表达式中每一项的符号：\n- 控制参数 $\\alpha$ 给定为正：$\\alpha  0$。\n- 杨氏模量 $E$ 是一种物理材料属性，对于任何真实材料都是正的：$E  0$。\n- 单元边长 $h$ 是一个几何尺寸，必须为正：$h  0$。\n- 振幅的平方 $U_0^2$ 对于任何实数值 $U_0$ 都是非负的：$U_0^2 \\ge 0$。\n\n因此，这些项的乘积 $W_{hg} = 32\\,\\alpha\\,E\\,h\\,U_0^2$ 必须是非负的 ($W_{hg} \\ge 0$)。只有当沙漏模式的振幅为零 ($U_0=0$) 时，能量才为零，这是稳定项所期望的行为。\n\n总稳定能的最终表达式为 $32\\,\\alpha\\,E\\,h\\,U_0^2$。", "answer": "$$\n\\boxed{32\\,\\alpha\\,E\\,h\\,U_0^2}\n$$", "id": "3555177"}, {"introduction": "一个有效的数值方法不仅要能解决像沙漏这样的伪影问题，还必须保持其基本的准确性。“Patch Test”（小块检验）是验证有限元列式一致性的基石。在最后一项实践中 [@problem_id:3555182]，你将对一小块单元施加一个恒定应变状态，并验证内部节点力处于平衡状态，从而证明带有沙漏控制的减缩积分方案能够精确地再现常数应变场。", "problem": "考虑一个处于小应变、二维平面应变状态下的均匀、各向同性、线弹性介质。其本构关系由一个恒定的弹性张量给出，柯西应力场通过常规的线性映射从应变计算得出。一个网格片由一个 $2 \\times 2$ 的未变形、轴对齐的双线性四边形单元（Q1单元）阵列组成，这些单元铺满了方形区域 $\\Omega = [-a,a] \\times [-a,a]$。每个单元都是边长为 $a$ 的正方形，因此这四个单元分别占据象限 $(-a,0) \\times (-a,0)$、$(0,a) \\times (-a,0)$、$(-a,0) \\times (0,a)$ 和 $(0,a) \\times (0,a)$。设全局节点矩阵包含一个 $3 \\times 3$ 的节点网格，节点坐标为 $(x,y) \\in \\{-a,0,a\\} \\times \\{-a,0,a\\}$，并将位于 $(0,0)$ 的中心内部节点标记为节点 $I$。\n\n施加一个精确的线性位移场\n$$\nu(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y, \\qquad v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y,\n$$\n其中常数 $\\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\beta_{0}, \\beta_{1}, \\beta_{2} \\in \\mathbb{R}$。不存在体力，且边界牵引力被假定为能使网格片与施加位移所引起的恒定应力场保持平衡。每个单元使用单点减缩高斯积分，积分点位于母空间中的 $(\\xi,\\eta) = (0,0)$ 及其相关权重，并对每个单元使用从母正方形 $[-1,1] \\times [-1,1]$ 到物理单元的仿射等参映射。\n\n对于与节点 $I$ 相邻的四个单元中的每一个，使用线弹性的弱形式、标准的双线性形函数和小应变定义，汇编在节点 $I$ 处的内节点力贡献。然后将这四个贡献相加，得到节点 $I$ 在该网格片上的残余内节点力向量。假设一种沙漏控制方案，其稳定力贡献对于物理坐标中至多为线性的任何位移场都为零，并将其纳入评估。\n\n计算节点 $I$ 在该网格片上的残余内节点力向量的欧几里得范数（包括沙漏控制的贡献）。将最终答案表示为以牛顿为单位的单个实数。如果值非零，则将答案四舍五入到四位有效数字；否则，报告精确值。", "solution": "用户希望我解决一个与计算地质力学相关的问题。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n*   **介质与力学**：一个处于小应变、二维平面应变状态下的均匀、各向同性、线弹性介质。其本构关系是一个恒定的弹性张量。\n*   **网格几何**：一个 $2 \\times 2$ 的未变形、轴对齐的双线性四边形单元（Q1）阵列，铺满方形区域 $\\Omega = [-a,a] \\times [-a,a]$。\n*   **单元**：四个边长为 $a$ 的正方形单元。\n*   **节点布局**：一个 $3 \\times 3$ 的节点网格，坐标为 $(x,y) \\in \\{-a,0,a\\} \\times \\{-a,0,a\\}$。位于 $(0,0)$ 的中心内部节点被标记为节点 $I$。\n*   **位移场**：施加的精确线性位移场：\n    $$ u(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y $$\n    $$ v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y $$\n    其中 $\\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\beta_{0}, \\beta_{1}, \\beta_{2}$ 是实常数。\n*   **载荷**：无体力。边界牵引力与所施加的场一致并确保平衡。\n*   **数值积分**：每个单元在母空间点 $(\\xi,\\eta) = (0,0)$ 处进行单点减缩高斯积分。\n*   **单元格式**：从母正方形 $[-1,1] \\times [-1,1]$ 的仿射等参映射。\n*   **沙漏控制**：假设采用一种沙漏控制方案，其稳定力贡献对于物理坐标中至多为线性的任何位移场都为零。\n*   **目标**：计算节点 $I$ 处的残余内节点力向量的欧几里得范数（包括沙漏控制的贡献）。\n\n**第二步：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题完全属于有限元法（FEM）应用于线弹性理论的既定范畴。双线性四边形单元、减缩积分、等参映射和沙漏控制等概念是计算力学中的标准内容。所描述的情景是一个经典的“网格片检验”（patch test），这是有限元格式的一个基本验证程序。该问题在科学上是合理的。\n*   **适定性**：该问题是适定的。它提供了计算所要求数量所需的所有必要信息（几何形状、单元类型、积分规则、位移场）。保证了唯一且有意义的解的存在。\n*   **客观性**：该问题以精确、客观、专业的技术语言陈述，没有任何主观性或模糊性。\n*   **一致性与完整性**：该问题的设置是自洽且一致的。指定的线性位移场会引起一个恒定的应变和应力状态。任务是验证所选的数值方法（采用1点积分的Q1单元）是否能精确表示这种状态，这表现为内部节点上的残余力为零。考虑到材料属性和位移系数的符号性质，为最终答案指定单位“牛顿”略显多余，但这并不会造成矛盾，因为零的结果与单位无关。\n\n**第三步：结论与行动**\n\n*   **结论**：问题**有效**。\n*   **行动**：继续进行详细求解。\n\n### 求解\n\n该问题要求计算一个承受线性位移场的 $2 \\times 2$ 双线性四边形单元网格片中心节点的残余内节点力。这是一个经典的网格片检验，旨在验证一个单元是否能够精确再现恒定应变状态。\n\n首先，让我们分析由施加的线性位移场产生的应变状态：\n$$ u(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y $$\n$$ v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y $$\n小应变张量 $\\boldsymbol{\\epsilon}$ 的分量为：\n$$ \\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\alpha_{1} $$\n$$ \\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = \\beta_{2} $$\n$$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = \\alpha_{2} + \\beta_{1} $$\n由于 $\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}$ 是常数，应变场在整个域 $\\Omega$ 中是均匀的。由于材料是均匀和线弹性的，柯西应力场 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\epsilon}$（其中 $\\mathbf{D}$ 是恒定弹性张量）在整个网格片中也是均匀的。设这个恒定的应力向量表示为 $\\boldsymbol{\\sigma}_{0}$。\n\n单个有限元 $(e)$ 的内力向量是通过在单元域上对应力与形函数导数进行积分来计算的：\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\int_{\\Omega^{(e)}} \\mathbf{B}^{T} \\boldsymbol{\\sigma} \\, d\\Omega $$\n这里，$\\mathbf{B}$ 是应变-位移矩阵，它将节点位移与应变联系起来。使用从母单元域 $\\Omega_{p} = [-1,1] \\times [-1,1]$ 的等参映射，该积分变为：\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}^{T}(\\xi, \\eta) \\boldsymbol{\\sigma}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta $$\n问题指定了单点高斯求积。这通过在母单元中心 $(\\xi, \\eta) = (0,0)$ 处计算被积函数，并乘以积分域的面积（即 $2 \\times 2 = 4$）来近似该积分。\n$$ \\mathbf{f}_{\\text{int}}^{(e)} \\approx \\left[ \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}(0,0) \\det(\\mathbf{J}(0,0)) \\right] \\times 4 $$\n由于应力场 $\\boldsymbol{\\sigma}$ 是恒定的，$\\boldsymbol{\\sigma}(0,0) = \\boldsymbol{\\sigma}_{0}$。对于边长为 $a$ 的未变形正方形单元，雅可比矩阵 $\\mathbf{J}$ 是恒定的对角矩阵，$\\mathbf{J} = \\text{diag}(a/2, a/2)$，所以其行列式为 $\\det(\\mathbf{J}) = a^2/4$。单元面积为 $A^{(e)} = a^2$。因此，近似值为：\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}_{0} \\left(\\frac{a^2}{4}\\right) (4) = a^2 \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}_{0} $$\n这个结果是精确的，因为被积函数是常数。\n\n一个四节点单元的应变-位移矩阵 $\\mathbf{B}$ 是每个节点 $j=1,2,3,4$ 的矩阵 $\\mathbf{B}_j$ 的集合：$\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$。节点 $j$ 的矩阵为：\n$$ \\mathbf{B}_j = \\begin{pmatrix} \\frac{\\partial N_j}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_j}{\\partial y} \\\\ \\frac{\\partial N_j}{\\partial y}  \\frac{\\partial N_j}{\\partial x} \\end{pmatrix} $$\n形函数 $N_j$ 的空间导数是通过链式法则，使用雅可比矩阵的逆矩阵 $\\mathbf{J}^{-1} = \\text{diag}(2/a, 2/a)$ 来求得的：\n$$ \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial x} \\\\ \\frac{\\partial N_j}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial \\xi} \\\\ \\frac{\\partial N_j}{\\partial \\eta} \\end{Bmatrix} $$\n形函数为 $N_j(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_j \\xi)(1+\\eta_j \\eta)$。它们在 $(\\xi, \\eta)=(0,0)$ 处的导数为：\n$$ \\left. \\frac{\\partial N_j}{\\partial \\xi} \\right|_{(0,0)} = \\frac{\\xi_j}{4}, \\quad \\left. \\frac{\\partial N_j}{\\partial \\eta} \\right|_{(0,0)} = \\frac{\\eta_j}{4} $$\n其中 $(\\xi_j, \\eta_j)$ 是节点 $j$ 在母单元中的坐标。因此，在积分点处：\n$$ \\left. \\frac{\\partial N_j}{\\partial x} \\right|_{(0,0)} = \\frac{2}{a} \\left(\\frac{\\xi_j}{4}\\right) = \\frac{\\xi_j}{2a}, \\quad \\left. \\frac{\\partial N_j}{\\partial y} \\right|_{(0,0)} = \\frac{2}{a} \\left(\\frac{\\eta_j}{4}\\right) = \\frac{\\eta_j}{2a} $$\n单元 $(e)$ 对其局部节点 $j$ 的内力贡献是 $\\mathbf{f}_{j, \\text{int}}^{(e)} = a^2 \\mathbf{B}_j^{T}(0,0) \\boldsymbol{\\sigma}_{0}$。\n\n位于 $(0,0)$ 的中心全局节点 $I$ 被所有四个单元共享。我们必须将来自每个单元在该节点上的力贡献相加。我们为四个单元中的每一个确定与节点 $I$ 对应的局部节点编号（使用从母单元的 $(-\\!1,-\\!1)$ 角点开始的逆时针局部编号）：\n*   单元1（右上，$[0,a]\\!\\times\\![0,a]$）：位于 $(0,0)$ 的节点 $I$ 是局部节点1，母坐标为 $(\\xi_1, \\eta_1)=(-1,-1)$。\n*   单元2（左上，$[-a,0]\\!\\times\\![0,a]$）：位于 $(0,0)$ 的节点 $I$ 是局部节点2，母坐标为 $(\\xi_2, \\eta_2)=(1,-1)$。\n*   单元3（左下，$[-a,0]\\!\\times\\![-a,0]$）：位于 $(0,0)$ 的节点 $I$ 是局部节点3，母坐标为 $(\\xi_3, \\eta_3)=(1,1)$。\n*   单元4（右下，$ [0,a]\\!\\times\\![-a,0]$）：位于 $(0,0)$ 的节点 $I$ 是局部节点4，母坐标为 $(\\xi_4, \\eta_4)=(-1,1)$。\n\n节点 $I$ 上的总内力向量是这些贡献的总和：\n$$ \\mathbf{F}_{I, \\text{int}} = \\mathbf{f}_{1, \\text{int}}^{(1)} + \\mathbf{f}_{2, \\text{int}}^{(2)} + \\mathbf{f}_{3, \\text{int}}^{(3)} + \\mathbf{f}_{4, \\text{int}}^{(4)} $$\n$$ \\mathbf{F}_{I, \\text{int}} = a^2 \\left( \\mathbf{B}_1^{(1)T}(0,0) + \\mathbf{B}_2^{(2)T}(0,0) + \\mathbf{B}_3^{(3)T}(0,0) + \\mathbf{B}_4^{(4)T}(0,0) \\right) \\boldsymbol{\\sigma}_{0} $$\n我们来写出 $\\mathbf{B}_j^T$：\n$$ \\mathbf{B}_j^T(0,0) = \\begin{pmatrix} \\frac{\\partial N_j}{\\partial x}  0  \\frac{\\partial N_j}{\\partial y} \\\\ 0  \\frac{\\partial N_j}{\\partial y}  \\frac{\\partial N_j}{\\partial x} \\end{pmatrix}_{(0,0)} = \\frac{1}{2a} \\begin{pmatrix} \\xi_j  0  \\eta_j \\\\ 0  \\eta_j  \\xi_j \\end{pmatrix} $$\n现在我们将这个矩阵对与节点 $I$ 对应的四个局部节点求和：\n$$ \\sum_{j \\in \\{1,2,3,4\\}} \\mathbf{B}_j^T(0,0) = \\frac{1}{2a} \\left[ \\begin{pmatrix} -1  0  -1 \\\\ 0  -1  -1 \\end{pmatrix} + \\begin{pmatrix} 1  0  -1 \\\\ 0  -1  1 \\end{pmatrix} + \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} + \\begin{pmatrix} -1  0  1 \\\\ 0  1  -1 \\end{pmatrix} \\right] $$\n对矩阵的各分量求和：\n*   第 (1,1) 项：$(-1)+1+1+(-1)=0$\n*   第 (1,2) 项：$0+0+0+0=0$\n*   第 (1,3) 项：$(-1)+(-1)+1+1=0$\n*   第 (2,1) 项：$0+0+0+0=0$\n*   第 (2,2) 项：$(-1)+(-1)+1+1=0$\n*   第 (2,3) 项：$(-1)+1+1+(-1)=0$\n总和是零矩阵：\n$$ \\sum_{j \\in \\{1,2,3,4\\}} \\mathbf{B}_j^{T}(0,0) = \\frac{1}{2a} \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\mathbf{0}^{2 \\times 3} $$\n因此，来自单元刚度的总内力为零：\n$$ \\mathbf{F}_{I, \\text{int}} = a^2 (\\mathbf{0}^{2 \\times 3}) \\boldsymbol{\\sigma}_{0} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\n接下来，我们考虑沙漏稳定力 $\\mathbf{F}_{I, \\text{stab}}$。问题陈述沙漏控制方案的设计使得其力贡献“对于物理坐标中至多为线性的任何位移场都为零”。所施加的位移场是线性的，因此根据定义：\n$$ \\mathbf{F}_{I, \\text{stab}} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\n节点 $I$ 处的总残余内节点力向量是标准贡献和稳定贡献之和：\n$$ \\mathbf{F}_{I, \\text{residual}} = \\mathbf{F}_{I, \\text{int}} + \\mathbf{F}_{I, \\text{stab}} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} + \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\n问题要求计算该向量的欧几里得范数：\n$$ ||\\mathbf{F}_{I, \\text{residual}}||_2 = \\sqrt{0^2 + 0^2} = 0 $$\n结果恰好为零，这证实了该单元格式通过了网格片检验。该结果与材料属性、单元尺寸 $a$ 以及线性位移场的具体系数无关。", "answer": "$$\n\\boxed{0}\n$$", "id": "3555182"}]}