{"hands_on_practices": [{"introduction": "要掌握单元收敛性，最基本的要求是单元能够精确表示一个恒定应变状态，这对应于一个线性位移场。这个练习 [@problem_id:3548732] 从第一性原理出发，展示了为何标准的等参单元（如 Q4 单元）天生就具备这一关键特性。理解这一点是掌握Patch Test的基石。", "problem": "考虑一个单一的等参双线性四边形有限元，在有限元法（FEM）中通常表示为 Q4，用于计算岩土力学中的二维小应变分析。该单元的物理节点坐标在全局笛卡尔坐标系中按逆时针顺序给出，分别为 $\\left(0,0\\right)$、$\\left(2,0\\right)$、$\\left(2,1\\right)$ 和 $\\left(0,2\\right)$。令 $\\left(\\xi,\\eta\\right)$ 表示与母单元正方形 $\\left[-1,1\\right] \\times \\left[-1,1\\right]$ 相关的自然坐标，并使用标准的双线性形函数。几何形状通过将应用于节点坐标的相同双线性形函数，从母单元域等参映射到物理单元。\n\n定义单元物理域上的精确位移场为 $u\\left(x,y\\right)=x$ 和 $v\\left(x,y\\right)=y$。在等参格式中，离散位移场 $\\left(u_{h},v_{h}\\right)$ 是通过在 $\\left(\\xi,\\eta\\right)$ 处求值的相同双线性形函数以及节点位移值 $\\left(u_{i},v_{i}\\right)$（$i=1,2,3,4$）进行插值得到的，其中节点位移值是在相应物理节点处求值的精确场。\n\n使用物理单元域上的精确积分，计算位移重现误差\n$$\nE \\;=\\; \\int_{\\Omega_{e}} \\left[\\left(u_{h}\\left(x,y\\right)-x\\right)^{2} + \\left(v_{h}\\left(x,y\\right)-y\\right)^{2}\\right] \\,\\mathrm{d}\\Omega,\n$$\n其中 $\\Omega_{e}$ 是物理单元的面积。请将您的最终答案表示为一个无量纲数。无需四舍五入。", "solution": "问题要求计算单个等参双线性四边形单元的位移重现误差。该误差由以下积分量化：\n$$\nE = \\int_{\\Omega_{e}} \\left[\\left(u_{h}\\left(x,y\\right)-x\\right)^{2} + \\left(v_{h}\\left(x,y\\right)-y\\right)^{2}\\right] \\,\\mathrm{d}\\Omega\n$$\n其中 $\\Omega_e$ 是物理单元的域，$(x,y)$ 是物理坐标，$(u,v)$ 是精确位移场，而 $(u_h, v_h)$ 是由有限元近似得到的插值位移场。\n\n所考虑的单元是等参双线性四边形 ($Q4$)。在等参格式中，单元内的物理坐标 $(x,y)$ 是从母单元正方形域 $\\left[-1,1\\right] \\times \\left[-1,1\\right]$ 的自然坐标 $(\\xi, \\eta)$ 映射而来，使用的形函数与插值位移场时所用的相同。\n\n标准的双线性形函数为：\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n这些形函数具有单位分解的基本性质：\n$$\n\\sum_{i=1}^{4} N_i(\\xi, \\eta) = 1\n$$\n对于母单元域中的所有 $(\\xi, \\eta)$ 均成立。\n\n从自然坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的等参映射定义为：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\\\\ny(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n其中 $(x_i, y_i)$ 是第 $i$ 个节点的坐标。\n\n离散位移场 $(u_h, v_h)$ 是使用相同的形函数从节点位移 $(u_i, v_i)$ 插值得到的：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i \\\\\nv_h(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i\n$$\n\n问题指出，精确位移场由 $u(x,y) = x$ 和 $v(x,y) = y$ 给出。节点位移 $(u_i, v_i)$ 是通过在物理节点 $(x_i, y_i)$ 处计算该精确场得到的。\n因此，对于每个节点 $i=1, 2, 3, 4$：\n$$\nu_i = u(x_i, y_i) = x_i \\\\\nv_i = v(x_i, y_i) = y_i\n$$\n\n现在，我们将这些节点位移代入 $u_h$ 和 $v_h$ 的插值公式。\n对于插值位移的水平分量 $u_h$：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i\n$$\n将此表达式与 $x$ 坐标的等参映射定义进行比较，我们发现它们是相同的：\n$$\nu_h(\\xi, \\eta) = x(\\xi, \\eta)\n$$\n这个等式对单元内的每个点都成立。这意味着在任何物理点 $(x,y)$ 处的插值位移 $u_h$ 都精确等于该点的坐标 $x$。因此，我们有 $u_h(x,y) = x$。\n\n类似地，对于插值位移的垂直分量 $v_h$：\n$$\nv_h(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n将此与 $y$ 坐标的等参映射进行比较，我们发现：\n$$\nv_h(\\xi, \\eta) = y(\\xi, \\eta)\n$$\n这意味着在任何物理点 $(x,y)$ 处的插值位移 $v_h$ 都精确等于该点的坐标 $y$。因此，我们有 $v_h(x,y) = y$。\n\n这种等参插值能精确重现空间坐标的任何线性函数的性质，是有限元法的基石之一。它是Patch Test的基础，该检验用于验证单元能否精确表示恒定应变状态（由线性位移场引起）。所提供的特定节点坐标 $\\left(0,0\\right)$、$\\left(2,0\\right)$、$\\left(2,1\\right)$ 和 $\\left(0,2\\right)$ 定义了一个有效的、非退化的四边形，但此结果是通用的，对任何此类单元均成立。\n\n现在我们可以计算误差积分 $E$。被积函数是：\n$$\n(u_h(x,y) - x)^2 + (v_h(x,y) - y)^2 = (x - x)^2 + (y - y)^2 = 0^2 + 0^2 = 0\n$$\n在单元域 $\\Omega_e$ 内的每个点 $(x,y)$ 处，被积函数都恒等于零。一个处处为零的函数在任何域上的积分都为零。\n$$\nE = \\int_{\\Omega_{e}} 0 \\,\\mathrm{d}\\Omega = 0\n$$\n位移重现误差精确为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "3548732"}, {"introduction": "在单个单元的基础上，我们将视野扩展到由多个单元组成的“斑块”（patch）。一个有效的有限元格式必须能够在任意形状的单元斑块上表示恒定应力状态，而不产生虚假的内部节点力。这个练习 [@problem_id:3548751] 巧妙地运用散度定理，证明了对于协调网格，内部节点上的内力贡献会精确抵消，从而确保该方法能够通过这一核心的平衡检验。", "problem": "考虑一个平面应变地质力学中的矩形域，其平面外厚度为 $t$，宽度为 $L_x$，高度为 $L_y$。该域通过一个均匀的 $2 \\times 2$ 等参四节点四边形（Q4）单元网格进行离散化。节点坐标如下：\n- 节点 $1$：$(0,0)$，节点 $2$：$\\left(\\frac{L_x}{2},0\\right)$，节点 $3$：$(L_x,0)$，\n- 节点 $4$：$(0,\\frac{L_y}{2})$，节点 $5$：$\\left(\\frac{L_x}{2},\\frac{L_y}{2}\\right)$，节点 $6$：$(L_x,\\frac{L_y}{2})$，\n- 节点 $7$：$(0,L_y)$，节点 $8$：$\\left(\\frac{L_x}{2},L_y\\right)$，节点 $9$：$(L_x,L_y)$。\n\n不存在体力。在整个域上给定一个恒定的 Cauchy 应力张量，\n$$\n\\boldsymbol{\\sigma}=\n\\begin{pmatrix}\n\\sigma_{xx} & \\tau_{xy} \\\\\n\\tau_{xy} & \\sigma_{yy}\n\\end{pmatrix},\n$$\n其中 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\tau_{xy}$ 是均匀常数。在整个边界 $\\partial \\Omega$ 上，面力场给定为 $\\mathbf{t}=\\boldsymbol{\\sigma}\\,\\mathbf{n}$，其中 $\\mathbf{n}$ 是外单位法向量。有限元法（FEM）的一致节点外力向量在每个单元边上定义为\n$$\n\\mathbf{f}_{\\mathrm{ext}}^{e}=\\int_{\\partial \\Omega^{e}} \\mathbf{N}^{T}\\,\\mathbf{t}\\,t\\,\\mathrm{d}\\Gamma,\n$$\n而单元内力向量定义为\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e}=\\int_{\\Omega^{e}} \\mathbf{B}^{T}\\,\\boldsymbol{\\sigma}\\,t\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{N}$ 是 Q4 单元的等参形式标量形函数矩阵，$\\mathbf{B}$ 是 Voigt 记法下的标准应变-位移矩阵。将内部节点 $5$（中间节点）处的全局节点残余力组装为\n$$\n\\mathbf{r}_5=\\sum_{e \\in \\mathcal{T}(5)} \\left(\\mathbf{f}_{\\mathrm{int}}^{e}\\right)_5 + \\sum_{e \\in \\mathcal{T}_{\\partial}(5)} \\left(\\mathbf{f}_{\\mathrm{ext}}^{e}\\right)_5,\n$$\n其中 $\\mathcal{T}(5)$ 是与节点 $5$ 相邻的单元集合，$\\mathcal{T}_{\\partial}(5)$ 是与节点 $5$ 相邻的边界边集合。\n\n仅使用基本动量平衡、散度定理和上述定义，计算节点 $5$ 处组装的节点残余力的模 $\\|\\mathbf{r}_5\\|$，并验证在给定的均匀应力状态和一致的边界牵引力下，当不存在体力时，内力会精确抵消。以牛顿为单位表示您的最终答案。如果得到精确值，则无需四舍五入。", "solution": "该问题要求计算一个 $2 \\times 2$ 四节点四边形（Q4）单元网格的内部节点 $5$ 处组装的节点残余力 $\\mathbf{r}_5$ 的模。该域承受一个恒定的 Cauchy 应力场 $\\boldsymbol{\\sigma}$ 和一致的边界牵引力 $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$。不存在体力。\n\n节点 $5$ 处的节点残余力由问题陈述定义为：\n$$\n\\mathbf{r}_5=\\sum_{e \\in \\mathcal{T}(5)} \\left(\\mathbf{f}_{\\mathrm{int}}^{e}\\right)_5 + \\sum_{e \\in \\mathcal{T}_{\\partial}(5)} \\left(\\mathbf{f}_{\\mathrm{ext}}^{e}\\right)_5\n$$\n其中 $\\mathcal{T}(5)$ 是与节点 $5$ 相邻的单元集合，而 $\\mathcal{T}_{\\partial}(5)$ 是与节点 $5$ 相邻的全局域 $\\partial\\Omega$ 的边界边的集合。节点 $5$ 的坐标为 $(\\frac{L_x}{2}, \\frac{L_y}{2})$，是 $2 \\times 2$ 网格的中心节点，因此是一个内部节点。它不与全局边界 $\\partial\\Omega$ 上的任何边相邻。因此，集合 $\\mathcal{T}_{\\partial}(5)$ 为空，第二个求和项为零：\n$$\n\\sum_{e \\in \\mathcal{T}_{\\partial}(5)} \\left(\\mathbf{f}_{\\mathrm{ext}}^{e}\\right)_5 = \\mathbf{0}\n$$\n因此，节点 $5$ 处的残余力简化为与其相邻的单元的内力贡献之和：\n$$\n\\mathbf{r}_5 = \\sum_{e \\in \\mathcal{T}(5)} \\left(\\mathbf{f}_{\\mathrm{int}}^{e}\\right)_5\n$$\n集合 $\\mathcal{T}(5)$ 由网格中的所有四个单元组成。我们将它们标记为 $e=1, 2, 3, 4$。\n\n单元 $e$ 的内力向量由下式给出：\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e}=\\int_{\\Omega^{e}} \\mathbf{B}^{T}\\,\\boldsymbol{\\sigma}\\,t\\,\\mathrm{d}\\Omega\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Voigt 记法下的应力向量，$\\mathbf{B}$ 是应变-位移矩阵。通过考虑 $\\mathbf{B}$ 矩阵的相应块 $\\mathbf{B}_i$，可以将该力对单元内特定节点 $i$ 的贡献写出。单元 $e$ 的节点 $i$ 处的力向量 $(\\mathbf{f}_{\\mathrm{int}}^e)_i$ 具有以下分量：\n\\begin{align*}\n(f_x)_i^e = \\int_{\\Omega^e} \\left( \\frac{\\partial N_i}{\\partial x} \\sigma_{xx} + \\frac{\\partial N_i}{\\partial y} \\tau_{xy} \\right) t \\, \\mathrm{d}A \\\\\n(f_y)_i^e = \\int_{\\Omega^e} \\left( \\frac{\\partial N_i}{\\partial x} \\tau_{xy} + \\frac{\\partial N_i}{\\partial y} \\sigma_{yy} \\right) t \\, \\mathrm{d}A\n\\end{align*}\n其中 $N_i$ 是节点 $i$ 的形函数，且 $\\mathrm{d}A = \\mathrm{d}x\\mathrm{d}y$。这可以写成紧凑的向量形式：\n$$\n(\\mathbf{f}_{\\mathrm{int}}^e)_i = t \\int_{\\Omega^e} (\\nabla N_i)^T \\boldsymbol{\\sigma} \\, \\mathrm{d}A\n$$\n其中 $\\boldsymbol{\\sigma}$ 是原始的 $2 \\times 2$ Cauchy 应力张量。\n\n问题陈述指出，应力张量 $\\boldsymbol{\\sigma}$ 在整个域上是恒定的。在没有体力的情况下，静态动量平衡的基本方程是 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。对于一个恒定的应力张量，其散度恒等于零：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\begin{pmatrix} \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\tau_{xy}}{\\partial y} \\\\ \\frac{\\partial \\tau_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 0+0 \\\\ 0+0 \\end{pmatrix} = \\mathbf{0}\n$$\n这证实了给定的应力场处于平衡状态。\n\n现在我们按建议使用散度定理。考虑标量函数 $N_i$ 和张量 $\\boldsymbol{\\sigma}$ 乘积的向量恒等式：\n$$\n\\nabla \\cdot (N_i \\boldsymbol{\\sigma}) = (\\nabla N_i)^T \\boldsymbol{\\sigma} + N_i (\\nabla \\cdot \\boldsymbol{\\sigma})\n$$\n由于 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$，这简化为：\n$$\n(\\nabla N_i)^T \\boldsymbol{\\sigma} = \\nabla \\cdot (N_i \\boldsymbol{\\sigma})\n$$\n将此代入节点内力的表达式中：\n$$\n(\\mathbf{f}_{\\mathrm{int}}^e)_i = t \\int_{\\Omega^e} \\nabla \\cdot (N_i \\boldsymbol{\\sigma}) \\, \\mathrm{d}A\n$$\n对此表达式应用散度定理，我们将单元域 $\\Omega^e$ 上的面积分转换为其边界 $\\partial\\Omega^e$ 上的线积分：\n$$\n(\\mathbf{f}_{\\mathrm{int}}^e)_i = t \\int_{\\partial\\Omega^e} (N_i \\boldsymbol{\\sigma}) \\mathbf{n}^e \\, \\mathrm{d}\\Gamma = t \\int_{\\partial\\Omega^e} N_i (\\boldsymbol{\\sigma} \\mathbf{n}^e) \\, \\mathrm{d}\\Gamma\n$$\n此处，$\\mathbf{n}^e$ 是单元 $e$ 边界的外单位法向量。项 $\\boldsymbol{\\sigma} \\mathbf{n}^e$ 是单元边界上的牵引力向量 $\\mathbf{t}^e$。因此我们有：\n$$\n(\\mathbf{f}_{\\mathrm{int}}^e)_i = t \\int_{\\partial\\Omega^e} N_i \\mathbf{t}^e \\, \\mathrm{d}\\Gamma\n$$\n这个结果表明，节点内力可以从单元边界上的牵引力计算得出。\n\n现在我们通过对在该节点相交的所有四个单元（$e=1, 2, 3, 4$）的贡献求和，来组装节点 $5$ 处的总力 $\\mathbf{r}_5$：\n$$\n\\mathbf{r}_5 = \\sum_{e=1}^4 (\\mathbf{f}_{\\mathrm{int}}^e)_5 = \\sum_{e=1}^4 \\left( t \\int_{\\partial\\Omega^e} N_5^e \\mathbf{t}^e \\, \\mathrm{d}\\Gamma \\right)\n$$\n其中 $N_5^e$ 是单元 $e$ 内与节点 $5$ 关联的形函数。\n\n四个单元边界的并集 $\\bigcup_{e=1}^4 \\partial\\Omega^e$ 由 $2 \\times 2$ 网格块的全局边界和在节点 $5$ 处相交的四条内部边组成。形函数 $N_5$ 在全局边界边上为零。它仅在以节点 $5$ 为顶点的内部边上非零。\n\n让我们考虑一条任意的内部边 $\\Gamma_{int}$，它由两个相邻单元（例如 $e_a$ 和 $e_b$）共享。在这条边上，单元 $e_a$ 的外法线与单元 $e_b$ 的外法线方向相反：$\\mathbf{n}^a = -\\mathbf{n}^b$。\n因此，这条边上的牵引力向量大小相等，方向相反：\n$$\n\\mathbf{t}^a = \\boldsymbol{\\sigma} \\mathbf{n}^a = \\boldsymbol{\\sigma} (-\\mathbf{n}^b) = -\\mathbf{t}^b\n$$\nQ4 单元的形函数跨单元边界是连续的，因此沿着 $\\Gamma_{int}$，节点 $5$ 的形函数值是相同的，无论从哪个单元计算：$N_5^a = N_5^b = N_5$。\n\n来自这条共享边对节点 $5$ 处力的贡献之和为：\n$$\nt \\int_{\\Gamma_{int}} N_5^a \\mathbf{t}^a \\, \\mathrm{d}\\Gamma + t \\int_{\\Gamma_{int}} N_5^b \\mathbf{t}^b \\, \\mathrm{d}\\Gamma = t \\int_{\\Gamma_{int}} N_5 \\mathbf{t}^a \\, \\mathrm{d}\\Gamma + t \\int_{\\Gamma_{int}} N_5 (-\\mathbf{t}^a) \\, \\mathrm{d}\\Gamma$$\n$$= t \\int_{\\Gamma_{int}} N_5 (\\mathbf{t}^a - \\mathbf{t}^a) \\, \\mathrm{d}\\Gamma = \\mathbf{0}\n$$\n这种精确抵消对每条内部边都会发生。内部节点 $5$ 处的总组装内力 $\\mathbf{r}_5$ 是在节点 $5$ 处相交的四条内部边贡献的总和。由于来自相邻单元的贡献沿着这些内部边中的每一条都两两抵消，因此总和为零。\n$$\n\\mathbf{r}_5 = \\mathbf{0}\n$$\n这个结果被称为通过Patch Test，它证实了 Q4 单元可以精确表示恒定应力状态，而不会在内部节点产生虚假的节点力。\n\n问题要求计算节点 $5$ 处组装的节点残余力的模 $\\|\\mathbf{r}_5\\|$。由于 $\\mathbf{r}_5 = \\mathbf{0}$，其模为：\n$$\n\\|\\mathbf{r}_5\\| = \\sqrt{0^2 + 0^2} = 0\n$$\n问题要求答案以牛顿为单位。", "answer": "$$\n\\boxed{0}\n$$", "id": "3548751"}, {"introduction": "通过线性斑块检验是保证收敛的必要条件，但对于保证高阶精度而言，这还不够。这个更深入的练习 [@problem_id:3548775] 探讨了为何一个高阶单元（如 serendipity Q8 单元）在扭曲网格上可能无法通过二次斑块检验。它揭示了单元几何、形函数的多项式完备性以及其再现高阶场能力之间至关重要的相互作用。", "problem": "考虑计算岩土力学中的一个平面应变八节点等参 serendipity 四边形（Q8）有限元。母单元的坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$。八个节点按顺序位于 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1),(0,-1),(1,0),(0,1),(-1,0)$。该单元采用标准的 Q8 serendipity 形函数 $N_{i}(\\xi,\\eta)$，$i\\in\\{1,\\dots,8\\}$，其表达式为\n$$\nN_{1}=\\frac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1),\\quad\nN_{2}=\\frac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1),\\quad\nN_{3}=\\frac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1),\\quad\nN_{4}=\\frac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1),\n$$\n$$\nN_{5}=\\frac{1}{2}(1-\\xi^{2})(1-\\eta),\\quad\nN_{6}=\\frac{1}{2}(1+\\xi)(1-\\eta^{2}),\\quad\nN_{7}=\\frac{1}{2}(1-\\xi^{2})(1+\\eta),\\quad\nN_{8}=\\frac{1}{2}(1-\\xi)(1-\\eta^{2}).\n$$\n通过指定节点物理坐标 $(x_{i},y_{i})$ 来规定到物理单元 $(x,y)$ 的等参映射，具体如下\n$$\nx_{i}=\\xi_{i}+\\alpha\\,\\xi_{i}\\eta_{i},\\qquad y_{i}=\\eta_{i},\n$$\n其中 $\\alpha$ 是一个实数扭曲参数，$(\\xi_{i},\\eta_{i})$ 是节点 $i$ 的母单元坐标。通过等参插值，物理映射可表示为\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{8}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{8}N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\n在此单个单元上，考虑目标精确位移场分量\n$$\nu(x,y)=x^{2},\n$$\n该位移场是关于物理坐标 $x$ 的二次函数，且与 $y$ 无关。在标准的斑块检验中，等参有限元近似采用的节点自由度等于在物理节点处的精确值，即 $u_{i}=u(x_{i},y_{i})=x_{i}^{2}$，并通过插值得到\n$$\nu_{h}(\\xi,\\eta)=\\sum_{i=1}^{8}N_{i}(\\xi,\\eta)\\,u_{i}.\n$$\n利用链式法则讨论复合函数 $u(x(\\xi,\\eta),y(\\xi,\\eta))$ 以及给定的等参映射，计算单元中心的插值误差，\n$$\ne:=u_{h}(0,0)-u\\big(x(0,0),y(0,0)\\big),\n$$\n该误差应表示为关于 $\\alpha$ 的闭式解析表达式。仅提供 $e$ 的最终表达式，不要进行四舍五入或包含单位。", "solution": "该问题要求计算在单个八节点等参四边形 ($Q8$) 单元上特定位移场的插值误差。误差需在单元中心处进行评估。\n\n插值误差 $e$ 定义为：\n$$\ne := u_{h}(0,0) - u\\big(x(0,0), y(0,0)\\big)\n$$\n其中 $u_{h}$ 是位移场 $u$ 的有限元近似，$(x,y)$ 是从母单元坐标 $(\\xi, \\eta)$ 映射过来的物理坐标。\n\n首先，我们建立从母域 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 到物理域 $(x,y)$ 的等参坐标映射的显式形式。该映射由下式给出：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{8} N_{i}(\\xi,\\eta)\\,x_{i}, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{8} N_{i}(\\xi,\\eta)\\,y_{i}\n$$\n物理节点坐标 $(x_i, y_i)$ 由母单元节点坐标 $(\\xi_i, \\eta_i)$ 和扭曲参数 $\\alpha$ 定义如下：\n$$\nx_{i} = \\xi_{i} + \\alpha\\,\\xi_{i}\\eta_{i}, \\qquad y_{i} = \\eta_{i}\n$$\n标准的 Q8 serendipity 形函数 $N_i(\\xi, \\eta)$ 构成了由 $\\{1, \\xi, \\eta, \\xi^2, \\eta^2, \\xi\\eta, \\xi^2\\eta, \\xi\\eta^2\\}$ 张成的多项式空间的一组基。这些形函数的一个重要性质是它们可以精确再现此空间内的任何多项式。也就是说，如果 $p(\\xi, \\eta)$ 是此空间中的一个多项式，那么 $\\sum_{i=1}^{8} N_i(\\xi, \\eta) p(\\xi_i, \\eta_i) = p(\\xi, \\eta)$。\n\n将此性质应用于坐标映射：\n对于 $y$ 坐标，由于 $y_i = \\eta_i$ 且函数 $p(\\xi, \\eta) = \\eta$ 位于基中，因此插值是精确的：\n$$\ny(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) y_i = \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\eta_i = \\eta\n$$\n对于 $x$ 坐标，我们有 $x_i = \\xi_i + \\alpha \\xi_i \\eta_i$。函数 $p_1(\\xi, \\eta) = \\xi$ 和 $p_2(\\xi, \\eta) = \\xi\\eta$ 均位于基中。因此：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) x_i = \\sum_{i=1}^{8} N_i(\\xi, \\eta) (\\xi_i + \\alpha \\xi_i \\eta_i) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i + \\alpha \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i \\eta_i\n$$\n$$\nx(\\xi, \\eta) = \\xi + \\alpha \\xi \\eta\n$$\n因此，完整的坐标映射为 $(x(\\xi, \\eta), y(\\xi, \\eta)) = (\\xi + \\alpha \\xi \\eta, \\eta)$。\n\n目标精确位移场为 $u(x,y) = x^2$。通过将其与坐标映射进行复合，我们得到以母单元坐标表示的精确位移场：\n$$\nu_{exact}(\\xi, \\eta) := u(x(\\xi, \\eta), y(\\xi, \\eta)) = (\\xi + \\alpha \\xi \\eta)^2 = \\xi^2 (1 + \\alpha \\eta)^2 = \\xi^2 (1 + 2\\alpha \\eta + \\alpha^2 \\eta^2)\n$$\n$$\nu_{exact}(\\xi, \\eta) = \\xi^2 + 2\\alpha \\xi^2\\eta + \\alpha^2 \\xi^2\\eta^2\n$$\n误差表达式的第二项是该精确场在母单元中心 $(\\xi, \\eta) = (0,0)$ 处的值：\n$$\nu\\big(x(0,0), y(0,0)\\big) = u_{exact}(0,0) = 0^2 + 2\\alpha(0^2)(0) + \\alpha^2(0^2)(0^2) = 0\n$$\n\n接下来，我们计算有限元近似解 $u_h(\\xi, \\eta)$。它通过插值精确的节点值来定义：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_i\n$$\n其中 $u_i = u(x_i, y_i) = x_i^2$。由于 $x_i = \\xi_i + \\alpha \\xi_i \\eta_i$，我们有 $u_i = (\\xi_i + \\alpha \\xi_i \\eta_i)^2$。这意味着 $u_i = u_{exact}(\\xi_i, \\eta_i)$。\n因此，有限元近似解 $u_h(\\xi, \\eta)$ 是函数 $u_{exact}(\\xi, \\eta)$ 的等参插值：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{exact}(\\xi_i, \\eta_i)\n$$\n代入 $u_{exact}$ 的表达式：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) (\\xi_i^2 + 2\\alpha \\xi_i^2\\eta_i + \\alpha^2 \\xi_i^2\\eta_i^2)\n$$\n利用求和的线性性质和形函数的再现性质：\n$$\nu_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i \\xi_i^2 + 2\\alpha \\sum_{i=1}^{8} N_i \\xi_i^2\\eta_i + \\alpha^2 \\sum_{i=1}^{8} N_i \\xi_i^2\\eta_i^2\n$$\n项 $\\xi^2$ 和 $\\xi^2\\eta$ 存在于 Q8 单元的基中。因此，它们的插值是精确的：\n$$\n\\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i^2 = \\xi^2 \\quad \\text{and} \\quad \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i^2\\eta_i = \\xi^2\\eta\n$$\n然而，项 $\\xi^2\\eta^2$ 不在 Q8 serendipity 单元的基中。其插值不是精确的。因此，$u_h$ 的表达式变为：\n$$\nu_h(\\xi, \\eta) = \\xi^2 + 2\\alpha\\xi^2\\eta + \\alpha^2 \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i^2\\eta_i^2\n$$\n插值误差为 $e(\\xi, \\eta) = u_h(\\xi, \\eta) - u_{exact}(\\xi, \\eta)$。\n$$\ne(\\xi, \\eta) = \\left( \\xi^2 + 2\\alpha\\xi^2\\eta + \\alpha^2 \\sum_{i=1}^{8} N_i \\xi_i^2\\eta_i^2 \\right) - \\left( \\xi^2 + 2\\alpha \\xi^2\\eta + \\alpha^2 \\xi^2\\eta^2 \\right)\n$$\n$$\ne(\\xi, \\eta) = \\alpha^2 \\left( \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\xi_i^2\\eta_i^2 - \\xi^2\\eta^2 \\right)\n$$\n此表达式表明，误差与 $\\alpha^2$ 成正比，并且完全是由于 Q8 形函数无法再现由几何扭曲产生的 $\\xi^2\\eta^2$ 项所引起的。\n\n我们必须在单元中心 $(\\xi, \\eta) = (0,0)$ 处评估此误差：\n$$\ne(0,0) = \\alpha^2 \\left( \\sum_{i=1}^{8} N_i(0,0) \\xi_i^2\\eta_i^2 - 0 \\right) = \\alpha^2 \\sum_{i=1}^{8} N_i(0,0) \\xi_i^2\\eta_i^2\n$$\n形函数在中心点的值为：\n$N_1(0,0)=N_2(0,0)=N_3(0,0)=N_4(0,0) = -1/4$\n$N_5(0,0)=N_6(0,0)=N_7(0,0)=N_8(0,0) = 1/2$\n\n节点上 $\\xi_i^2\\eta_i^2$ 的值为：\n对于角节点 $i \\in \\{1,2,3,4\\}$，其中 $|\\xi_i|=1$ 且 $|\\eta_i|=1$，我们有 $\\xi_i^2\\eta_i^2 = 1^2 \\cdot 1^2 = 1$。\n对于边中节点 $i \\in \\{5,6,7,8\\}$，其中 $\\xi_i=0$ 或 $\\eta_i=0$，我们有 $\\xi_i^2\\eta_i^2 = 0$。\n\n现在，我们计算该和：\n$$\n\\sum_{i=1}^{8} N_i(0,0) \\xi_i^2\\eta_i^2 = N_1(0,0)(1) + N_2(0,0)(1) + N_3(0,0)(1) + N_4(0,0)(1) + \\sum_{i=5}^{8} N_i(0,0)(0)\n$$\n$$\n\\sum_{i=1}^{8} N_i(0,0) \\xi_i^2\\eta_i^2 = \\left(-\\frac{1}{4}\\right) + \\left(-\\frac{1}{4}\\right) + \\left(-\\frac{1}{4}\\right) + \\left(-\\frac{1}{4}\\right) = 4 \\left(-\\frac{1}{4}\\right) = -1\n$$\n最后，将此值代回到中心点误差的表达式中：\n$$\ne = e(0,0) = \\alpha^2(-1) = -\\alpha^2\n$$\n\n单元中心的插值误差为 $-\\alpha^2$。这表明，虽然该单元即使在扭曲时也能通过常应变（线性场）的斑块检验，但它未能在扭曲的几何形状上精确再现二次场，其误差与扭曲参数 $\\alpha$ 的平方成正比。", "answer": "$$\n\\boxed{-\\alpha^{2}}\n$$", "id": "3548775"}]}