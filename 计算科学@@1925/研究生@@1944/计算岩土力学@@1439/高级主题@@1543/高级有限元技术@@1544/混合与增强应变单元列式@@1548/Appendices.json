{"hands_on_practices": [{"introduction": "在深入研究高级单元配方的解决方案之前，首先必须从根本上理解并量化体积锁定的问题。此练习将指导您直接计算在近不可压缩情况下，标准位移单元所产生的伪应变能。通过这个推导，体积锁定这一抽象概念将变得具体可见，为后续学习混合法和增强应变法的必要性奠定坚实基础。[@problem_id:3543469]", "problem": "考虑一个二维双线性四边形有限元，在平面应变假设下，该单元占据方形区域 $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$。该材料是各向同性、线性弹性的近不可压缩材料，由拉梅参数 $\\lambda$ 和 $\\mu$ 以及小应变运动学表征。施加了一个与单元的双线性插值一致的位移场：\n$$u_{x}(x,y) = \\gamma x y,\\qquad u_{y}(x,y) = -\\gamma x y,$$\n其中 $\\gamma$ 是一个常数振幅。这种运动模式具有空间变化的体积应变，其在单元上的积分为零。在这种情况下，已知纯位移格式会表现出体积自锁，而混合或增强应变格式可以缓解此问题。\n\n从小应变运动学和线性弹性本构律的基本定义出发，并使用由这些原理推导出的应变能密度定义 $W$，计算以下两种格式之间的单元级体积内能差 $\\Delta E_{\\mathrm{vol}}$：\n- 标准的基于位移的格式（该格式惩罚逐点的体积应变），以及\n- 通过增强假定应变（EAS）或 $\\bar{B}$ 方法获得的体积缓解格式（该格式在形成对应变能密度 $W$ 的体积贡献之前，用单元平均值替换体积应变）。\n\n假设该缓解方法仅修改 $W$ 的体积部分，而保持其偏量部分不变。请将 $\\Delta E_{\\mathrm{vol}}$ 表示为仅含 $\\lambda$、$\\gamma$ 和 $L$ 的单一闭式解析表达式。最终答案中请勿包含单位。无需进行数值计算或四舍五入。", "solution": "用户希望针对一个特定情况，计算标准位移格式和混合格式（$\\bar{B}$ 或 EAS）之间的体积内能差 $\\Delta E_{vol}$。\n\n### 步骤1：提取已知条件\n- **单元几何**：一个二维双线性四边形有限元，占据方形区域 $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$。\n- **物理假设**：平面应变。\n- **材料属性**：各向同性、线性弹性、近不可压缩，由拉梅参数 $\\lambda$ 和 $\\mu$ 表征。\n- **运动学**：小应变。\n- **位移场**：$u_{x}(x,y) = \\gamma x y$, $u_{y}(x,y) = -\\gamma x y$，其中 $\\gamma$ 是一个常数。\n- **格式定义**：\n    - **标准位移格式**：惩罚逐点的体积应变。\n    - **缓解格式（EAS/$\\bar{B}$）**：用单元平均值替换体积应变。此修改仅适用于应变能密度 $W$ 的体积部分。\n- **待求量**：两种格式之间的单元级体积内能差 $\\Delta E_{\\mathrm{vol}}$，用 $\\lambda$、$\\gamma$ 和 $L$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在固体力学和有限元法理论中有充分依据。它探讨了近不可压缩材料中众所周知的体积自锁现象，以及像 $\\bar{B}$ 方法或增强假定应变（EAS）方法这样的标准缓解技术。所有概念（平面应变、拉梅参数、应变能、双线性单元）都是该领域的标准概念。\n- **适定性**：该问题是适定的。几何形状、材料行为和运动场都有明确的定义。待计算的量也已明确指定，可以根据给定信息确定唯一解。\n- **客观性**：问题陈述使用精确、客观和正式的语言编写，没有任何主观性或模糊性。\n\n### 步骤3：结论与行动\n该问题是有效的。它是计算力学中一个标准的、可解的问题。我将继续进行求解。\n\n***\n\n求解过程首先从给定的位移场推导应变场。然后，分别计算标准格式和缓解格式下的体积应变能。这两种能量之差即为最终答案。\n\n**1. 应变场计算**\n\n小应变张量分量 $\\epsilon_{ij}$ 是从给定的位移场 $\\mathbf{u} = (u_x, u_y)$ 推导出来的。对于二维问题，相关分量为：\n$$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} $$\n$$ \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} $$\n$$ \\gamma_{xy} = 2\\epsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} $$\n\n代入给定的位移场 $u_{x}(x,y) = \\gamma x y$ 和 $u_{y}(x,y) = -\\gamma x y$：\n$$ \\epsilon_{xx}(x,y) = \\frac{\\partial}{\\partial x}(\\gamma x y) = \\gamma y $$\n$$ \\epsilon_{yy}(x,y) = \\frac{\\partial}{\\partial y}(-\\gamma x y) = -\\gamma x $$\n$$ \\gamma_{xy}(x,y) = \\frac{\\partial}{\\partial y}(\\gamma x y) + \\frac{\\partial}{\\partial x}(-\\gamma x y) = \\gamma x - \\gamma y = \\gamma(x - y) $$\n\n体积应变或膨胀 $\\epsilon_v$ 是应变张量的迹。对于二维平面应变情况，定义为：\n$$ \\epsilon_v(x,y) = \\epsilon_{xx}(x,y) + \\epsilon_{yy}(x,y) = \\gamma y - \\gamma x = \\gamma(y-x) $$\n这表明体积应变在单元内呈线性变化。\n\n**2. 标准格式下的体积应变能**\n\n对于各向同性线性弹性材料，应变能密度 $W$ 可以分解为体积部分和偏量部分。在标准格式中，对于近不可压缩材料，体积部分会受到惩罚，其表达式为：\n$$ W_{\\mathrm{vol}} = \\frac{1}{2} \\lambda \\epsilon_v^2 $$\n其中 $\\lambda$ 是拉梅第一参数，对于近不可压缩材料，该值非常大，从而惩罚非零的体积应变。\n\n标准格式的总 体积内能 $E_{\\mathrm{vol}}^{\\mathrm{std}}$ 是体积应变能密度在单元面积 $A$ 上的积分：\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\int_A W_{\\mathrm{vol}}(x,y) \\,dA = \\int_0^L \\int_0^L \\frac{1}{2} \\lambda [\\epsilon_v(x,y)]^2 \\,dx\\,dy $$\n代入 $\\epsilon_v(x,y) = \\gamma(y-x)$：\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy $$\n我们计算该二重积分：\n$$ \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy = \\int_0^L \\int_0^L (y^2 - 2xy + x^2) \\,dx\\,dy $$\n首先对 $x$ 积分：\n$$ \\int_0^L (y^2 - 2xy + x^2) \\,dx = \\left[ y^2x - x^2y + \\frac{x^3}{3} \\right]_0^L = Ly^2 - L^2y + \\frac{L^3}{3} $$\n接着将结果对 $y$ 积分：\n$$ \\int_0^L \\left( Ly^2 - L^2y + \\frac{L^3}{3} \\right) \\,dy = \\left[ \\frac{Ly^3}{3} - \\frac{L^2y^2}{2} + \\frac{L^3y}{3} \\right]_0^L = \\frac{L^4}{3} - \\frac{L^4}{2} + \\frac{L^4}{3} = \\frac{2L^4}{3} - \\frac{L^4}{2} = \\frac{L^4}{6} $$\n将此结果代回 $E_{\\mathrm{vol}}^{\\mathrm{std}}$ 的表达式中：\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\left( \\frac{L^4}{6} \\right) = \\frac{\\lambda\\gamma^2L^4}{12} $$\n\n**3. 缓解格式下的体积应变能**\n\nEAS 或 $\\bar{B}$ 方法通过在能量计算中用单元平均体积应变 $\\bar{\\epsilon}_v$ 替换逐点体积应变 $\\epsilon_v$ 来缓解体积自锁。\n$$ \\bar{\\epsilon}_v = \\frac{1}{A} \\int_A \\epsilon_v(x,y) \\,dA $$\n单元的面积为 $A = L \\times L = L^2$。\n$$ \\bar{\\epsilon}_v = \\frac{1}{L^2} \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy $$\n我们计算该积分：\n$$ \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy = \\gamma \\int_0^L \\left[ yx - \\frac{x^2}{2} \\right]_0^L \\,dy = \\gamma \\int_0^L \\left( Ly - \\frac{L^2}{2} \\right) \\,dy $$\n$$ = \\gamma \\left[ \\frac{Ly^2}{2} - \\frac{L^2y}{2} \\right]_0^L = \\gamma \\left( \\frac{L^3}{2} - \\frac{L^3}{2} \\right) = 0 $$\n因此，对于这种特定的变形模式，平均体积应变为零：\n$$ \\bar{\\epsilon}_v = 0 $$\n缓解格式下的体积应变能密度为 $W_{\\mathrm{vol}}^{\\mathrm{mit}} = \\frac{1}{2} \\lambda \\bar{\\epsilon}_v^2$。由于 $\\bar{\\epsilon}_v = 0$，所以在整个单元内 $W_{\\mathrm{vol}}^{\\mathrm{mit}} = 0$。\n\n缓解格式的总体积内能 $E_{\\mathrm{vol}}^{\\mathrm{mit}}$ 为：\n$$ E_{\\mathrm{vol}}^{\\mathrm{mit}} = \\int_A W_{\\mathrm{vol}}^{\\mathrm{mit}} \\,dA = \\int_A 0 \\,dA = 0 $$\n\n**4. 能量差计算**\n\n问题要求计算标准格式和缓解格式下的体积内能之差 $\\Delta E_{\\mathrm{vol}}$。\n$$ \\Delta E_{\\mathrm{vol}} = E_{\\mathrm{vol}}^{\\mathrm{std}} - E_{\\mathrm{vol}}^{\\mathrm{mit}} $$\n$$ \\Delta E_{\\mathrm{vol}} = \\frac{\\lambda\\gamma^2L^4}{12} - 0 = \\frac{\\lambda\\gamma^2L^4}{12} $$\n该结果代表了标准位移格式对一个有效的、零体积变化的变形模式所施加的伪能惩罚，这是体积自锁的一个特征性症状。缓解格式正确地为该模式赋予了零能量，从而避免了自锁。", "answer": "$$\\boxed{\\frac{\\lambda\\gamma^{2}L^{4}}{12}}$$", "id": "3543469"}, {"introduction": "理解了问题的根源之后，下一步自然是构建解决方案。本练习聚焦于增强假设应变（Enhanced Assumed Strain, EAS）方法的一个关键组成部分——“气泡”增强函数。您将学习如何设计这些内部函数来丰富单元内部的应变场，同时确保它们不会影响单元边界的力学行为，这是高级单元开发中的一项基本技能。[@problem_id:3543518]", "problem": "考虑一个在参考域 $\\widehat{\\Omega} = [-1,1]^3$ 上的标准三线性六面体单元 ($Q_1$)，其在等参坐标系下的局部坐标为 $(\\xi,\\eta,\\zeta)$。在计算岩土力学的混合及增强假设应变 (EAS) 有限元列式中，常引入基于位移的“气泡”增强项，以在保持协调性和避免虚假的边界贡献的同时改善性能。\n\n请在参考单元上进行计算，并仅使用以下基本事实：单元层级的虚功原理指出，外部边界虚功项是单元边界上牵引力与虚位移迹的乘积的积分；函数在边界上的迹决定了它是否对该边界积分有贡献；内部气泡增强项在 $\\partial\\widehat{\\Omega}$ 上的迹应为零；以及 $L^2$-归一化由函数在 $\\widehat{\\Omega}$ 上的平方积分定义。\n\n你的任务如下。首先，在 $\\widehat{\\Omega}$ 上构造一个标量气泡增强项 $\\widehat{b}(\\xi,\\eta,\\zeta)$，该函数是一个在 $(\\xi,\\eta,\\zeta)$ 上可分、关于每个坐标是偶函数、在开内部严格为正、且其在 $\\partial\\widehat{\\Omega}$ 上的迹为零的最低阶非平凡三元多项式。证明你的选择满足这些性质，并计算其梯度 $\\nabla_{\\xi\\eta\\zeta}\\widehat{b}$。然后，利用单元层级的虚功原理和迹的性质，解释为何新增的模式对单元边界项没有贡献。最后，引入一个正常数归一化常数 $\\alpha$ 并定义归一化的气泡函数 $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$，然后确定唯一的正 $\\alpha$ 使得下式成立：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta \\;=\\; 1.\n$$\n请以无单位的闭式精确表达式给出你最终的 $\\alpha$ 值。不要四舍五入。", "solution": "该问题陈述经核实具有科学依据、问题适定且客观。这是有限元理论中的一个标准问题，具体涉及为增强假设应变 (EAS) 方法构造增强函数。所有必需信息均已提供，问题没有矛盾或歧义。\n\n按照要求，该问题分四个部分进行解答。\n\n首先，我们在参考域 $\\widehat{\\Omega} = [-1,1]^3$ 上构造标量气泡增强项 $\\widehat{b}(\\xi,\\eta,\\zeta)$。该函数必须满足以下几个性质：\n1.  **在 $\\partial\\widehat{\\Omega}$ 上迹为零**: 立方体的边界 $\\partial\\widehat{\\Omega}$ 由平面 $\\xi = \\pm 1$、$\\eta = \\pm 1$ 或 $\\zeta = \\pm 1$ 组成。如果一个函数在边界上任意一点的取值都为 $0$，则其在边界上的迹为零。\n2.  **在 $(\\xi,\\eta,\\zeta)$ 上可分**: 该函数可以写成三个单变量函数的乘积，即 $\\widehat{b}(\\xi,\\eta,\\zeta) = f(\\xi)g(\\eta)h(\\zeta)$。为使该乘积在 $\\partial\\widehat{\\Omega}$ 上的迹为零，只需每个分量函数在其定义域的端点处为零即可，即 $f(\\pm 1) = 0$，$g(\\pm 1) = 0$ 和 $h(\\pm 1) = 0$。\n3.  **最低阶非平凡三元多项式**: 为满足 $f(\\pm 1) = 0$，单变量多项式 $f(\\xi)$ 必须在 $\\xi=1$ 和 $\\xi=-1$ 处有根。具有这些根的最低阶非平凡多项式是一个二次多项式，形式为 $c(\\xi-1)(\\xi+1) = c(\\xi^2-1)$，其中 $c$ 为非零常数。\n4.  **关于每个坐标是偶函数**: 多项式 $\\xi^2-1$ 是关于 $\\xi$ 的偶函数。为了让 $\\widehat{b}$ 满足此性质，我们选择 $f$、$g$ 和 $h$ 均为偶函数。形式 $c(\\xi^2-1)$ 符合此要求。\n5.  **在开内部严格为正**: 定义域的内部是 $(\\xi,\\eta,\\zeta) \\in (-1,1)^3$。对于 $\\xi \\in (-1,1)$，项 $\\xi^2-1$ 是负的。为确保气泡函数在内部为正，我们可以选择单变量函数为 $1-\\xi^2$，它在 $\\xi \\in (-1,1)$ 时为正。\n\n综合这些要求，在立方体所有面上都为零的最简单可分多项式，是在每个坐标区间端点为零的最简单（二次）多项式的乘积。我们定义该函数为：\n$$\n\\widehat{b}(\\xi,\\eta,\\zeta) = (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\n$$\n该函数是一个 6 次多项式。如上所述，任何在 $\\partial\\widehat{\\Omega}$ 上迹为零的可分多项式 $\\widehat{b}=fgh$ 都要求 $f, g, h$ 的次数至少为 2，这使得 $\\widehat{b}$ 的总次数至少为 6。因此，我们的选择代表了满足所有陈述条件的最低阶多项式。它关于每个坐标都是偶函数，因为每个因子 $(1-x^2)$ 都是偶函数。它在内部严格为正，因为对于在 $(-1,1)$ 内的坐标，每个因子都严格为正。\n\n第二，我们计算 $\\widehat{b}(\\xi,\\eta,\\zeta)$ 的梯度。使用乘法法则求导：\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\xi} = \\frac{\\partial}{\\partial\\xi}\\left[(1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\\right] = (-2\\xi)(1-\\eta^2)(1-\\zeta^2)\n$$\n根据对称性，其他的偏导数为：\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\eta} = (-2\\eta)(1-\\xi^2)(1-\\zeta^2)\n$$\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\zeta} = (-2\\zeta)(1-\\xi^2)(1-\\eta^2)\n$$\n因此，梯度向量为：\n$$\n\\nabla_{\\xi\\eta\\zeta}\\widehat{b} = \\begin{pmatrix} -2\\xi(1-\\eta^2)(1-\\zeta^2) \\\\ -2\\eta(1-\\xi^2)(1-\\zeta^2) \\\\ -2\\zeta(1-\\xi^2)(1-\\eta^2) \\end{pmatrix}\n$$\n\n第三，我们解释为何该气泡模式对单元边界虚功没有贡献。虚功原理指出，在单元边界 $\\partial\\Omega_e$ 上由外牵引力 $\\mathbf{t}$ 所做的虚功由积分 $W_{ext}^{bnd} = \\int_{\\partial\\Omega_e} \\mathbf{t}\\cdot\\delta\\mathbf{u}\\,\\mathrm{d}S$ 给出，其中 $\\delta\\mathbf{u}$ 是虚位移场。增强列式增加了一个基于气泡函数的内部位移模式，因此虚位移可以写为 $\\delta\\mathbf{u} = \\delta\\mathbf{u}_{std} + \\delta\\mathbf{u}_{bubble}$，其中 $\\delta\\mathbf{u}_{std}$ 是来自节点自由度的标准部分，$\\delta\\mathbf{u}_{bubble}$ 是增强项。对于向量位移场，一个典型的增强项是 $\\delta\\mathbf{u}_{bubble} = \\widehat{b} \\delta\\mathbf{a}$，其中 $\\delta\\mathbf{a}$ 是虚系数向量。气泡模式对边界虚功的贡献是 $\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S$。等参映射将物理单元边界 $\\partial\\Omega_e$ 关联到参考单元边界 $\\partial\\widehat{\\Omega}$。根据构造，我们的气泡函数 $\\widehat{b}$ 在 $\\partial\\widehat{\\Omega}$ 上的迹为零。这意味着对于任何点 $(\\xi,\\eta,\\zeta) \\in \\partial\\widehat{\\Omega}$，都有 $\\widehat{b}(\\xi,\\eta,\\zeta)=0$。因此，虚位移增强项 $\\delta\\mathbf{u}_{bubble}$ 在物理单元边界 $\\partial\\Omega_e$ 上恒为零。所以，该积分的计算结果为零：\n$$\n\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S = \\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\mathbf{0}\\,\\mathrm{d}S = 0\n$$\n因此，新增的模式是一个真正的“气泡”或“内部”模式，它增强了单元内部的应变场，但不对边界上所做的功产生贡献，从而保持了 C0 连续性并且不干扰施加的牵引力边界条件。\n\n最后，我们确定归一化气泡函数 $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$ 的正常数归一化常数 $\\alpha$，使其在参考单元上的 $L^2$-范数为 1。归一化条件是：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\n代入 $\\widehat{b}_N$ 和 $\\widehat{b}$ 的表达式：\n$$\n\\alpha^2 \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2) \\right]^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\n该积分是可分的：\n$$\n\\alpha^2 \\left(\\int_{-1}^{1} (1-\\xi^2)^2\\,\\mathrm{d}\\xi\\right) \\left(\\int_{-1}^{1} (1-\\eta^2)^2\\,\\mathrm{d}\\eta\\right) \\left(\\int_{-1}^{1} (1-\\zeta^2)^2\\,\\mathrm{d}\\zeta\\right) = 1\n$$\n令 $I = \\int_{-1}^{1} (1-x^2)^2\\,\\mathrm{d}x$。方程变为 $\\alpha^2 I^3 = 1$。我们首先计算 $I$ 的值：\n$$\nI = \\int_{-1}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x\n$$\n由于被积函数是偶函数，我们可以将积分计算为：\n$$\nI = 2 \\int_{0}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x = 2 \\left[ x - \\frac{2}{3}x^3 + \\frac{1}{5}x^5 \\right]_0^1\n$$\n$$\nI = 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15-10+3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\n现在我们求解 $\\alpha$。由于 $\\alpha$ 必须为正：\n$$\n\\alpha^2 \\left(\\frac{16}{15}\\right)^3 = 1 \\implies \\alpha = \\sqrt{\\left(\\frac{15}{16}\\right)^3} = \\left(\\frac{15}{16}\\right)^{3/2}\n$$\n$$\n\\alpha = \\frac{15^{3/2}}{16^{3/2}} = \\frac{15\\sqrt{15}}{(\\sqrt{16})^3} = \\frac{15\\sqrt{15}}{4^3} = \\frac{15\\sqrt{15}}{64}\n$$\n这是归一化常数 $\\alpha$ 的唯一正值。", "answer": "$$\\boxed{\\frac{15\\sqrt{15}}{64}}$$", "id": "3543518"}, {"introduction": "从解析构造过渡到数值实现，本练习将对比施加不可压缩约束的两种主要策略：混合法（使用拉格朗日乘子）和罚函数法。通过一个简化的编程任务，您将亲手发现这两种方法在求解精度和系统矩阵的数值条件数方面的实际权衡。这有助于理解在实际有限元程序中选择不同约束执行方式所带来的后果。[@problem_id:3543495]", "problem": "考虑一个处于平面应变状态下的二维四边形有限元，该单元具有恒定的体积应变和一个增强假设应变（EAS）体积模式。设由节点位移引起的几何体积应变由单个标量自由度 $\\epsilon$ 表示，EAS 体积模式由单个内部标量参数 $\\alpha$ 表示。在小应变体积近似下，变形梯度的雅可比行列式满足 $J \\approx 1 + \\epsilon + \\alpha$。近不可压缩性通过压力拉格朗日乘子（混合法）或罚函数项来施加。您将比较在存在体积 EAS 模式的情况下，通过压力拉格朗日乘子和罚函数 $\\frac{\\lambda}{2}(J-1)^2$ 弱形式施加不可压缩性的两种方法，并量化 $J$ 的差异以及单元级切向矩阵的条件数。\n\n基本原理：\n- 有限应变的不可压缩性约束为 $\\det(\\mathbf{F}) = 1$。在适用于具有恒定体积模式的近不可压缩响应的小应变体积近似中，这表示为 $J - 1 \\approx \\epsilon + \\alpha$。\n- 总势能的驻值条件导出代数平衡（一阶最优性）条件。切向矩阵是总势能关于离散未知量的黑塞矩阵。\n- 增强假设应变（EAS）通过内部参数增强应变场，以提高稳定性并减轻闭锁现象；此处它由具有稳定化刚度 $k_{\\text{eas}}$ 的单个内部模式 $\\alpha$ 表示。\n\n模型：\n- 设通过对几何体积应变 $\\epsilon$ 与目标值 $\\epsilon_0$ 的偏差施加二次罚函数来施加体积载荷，其刚度为 $k_u > 0$：总能量贡献为 $\\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2$。\n- 设 EAS 模式通过 $\\frac{k_{\\text{eas}}}{2}\\alpha^2$ 进行稳定化，其中 $k_{\\text{eas}} > 0$。\n- 混合格式（压力拉格朗日乘子）：通过一个类压力拉格朗日乘子 $p$ 施加 $J-1 \\approx \\epsilon + \\alpha = 0$。总能量为 $\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)$。代数切向矩阵是其黑塞矩阵\n$$\n\\mathbf{K}_{\\text{mix}} = \n\\begin{bmatrix}\nk_u  0  1 \\\\\n0  k_{\\text{eas}}  1 \\\\\n1  1  0\n\\end{bmatrix}\n$$\n相对于排序 $[\\epsilon,\\alpha,p]$。\n- 罚函数格式：用罚函数项 $\\frac{\\lambda}{2}(J-1)^2 \\approx \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$ 替换拉格朗日乘子，其中 $\\lambda > 0$。总能量为 $\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$。代数切向矩阵（黑塞矩阵）是\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda  \\lambda \\\\\n\\lambda  k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\n相对于排序 $[\\epsilon,\\alpha]$。\n\n任务：\n- 对于每个指定的参数集 $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda)$，计算：\n    1. 通过求解 $\\Pi_{\\text{mix}}$ 的一阶最优性条件，得到混合法解 $(\\epsilon_{\\text{mix}},\\alpha_{\\text{mix}},p_{\\text{mix}})$。然后计算 $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$。\n    2. 通过求解 $\\Pi_{\\text{pen}}$ 的一阶最优性条件，得到罚函数法解 $(\\epsilon_{\\text{pen}},\\alpha_{\\text{pen}})$。然后计算 $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$。\n    3. 绝对差 $|J_{\\text{pen}} - J_{\\text{mix}}|$。\n    4. $\\mathbf{K}_{\\text{pen}}$ 和 $\\mathbf{K}_{\\text{mix}}$ 的条件数（谱2范数）。使用基于奇异值的条件数来处理混合法矩阵的不定性。两个条件数都是无量纲的。\n\n- 将所有结果表示为无量纲浮点数。不涉及角度。\n\n测试集：\n- 案例 $1$：$(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10, 10000)$。\n- 案例 $2$：$(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.05, 500, 1000, 100)$。\n- 案例 $3$：$(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.0, 200, 5, 1000000)$。\n- 案例 $4$：$(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (-0.03, 1500, 50, 100000)$。\n- 案例 $5$：$(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10000, 1)$。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含所有测试用例的聚合结果，形式为一个用方括号括起来的逗号分隔的扁平列表。对于每个测试用例，按顺序 $[|J_{\\text{pen}} - J_{\\text{mix}}|,\\ \\text{cond}(\\mathbf{K}_{\\text{pen}}),\\ \\text{cond}(\\mathbf{K}_{\\text{mix}})]$ 将三个浮点数附加到输出列表中。例如，$N$ 个案例的总体输出格式为 $[d_1,c_{\\text{pen},1},c_{\\text{mix},1},\\dots,d_N,c_{\\text{pen},N},c_{\\text{mix},N}]$。", "solution": "该问题要求在一个简化的有限元背景下，对两种施加近不可压缩性的常用方法进行对比分析：使用拉格朗日乘子的混合格式和罚函数格式。分析的重点是由此产生的体积变化以及相关单元级切向矩阵的条件。我们将首先推导每种格式的状态变量的解析解，然后建立待计算量的表达式。\n\n首先，我们分析混合格式。混合格式的总势能由下式给出\n$$\n\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)\n$$\n其中 $\\epsilon$ 是几何体积应变，$\\alpha$ 是增强假设应变（EAS）模式，而 $p$ 是类压力拉格朗日乘子。参数 $k_u$ 和 $k_{\\text{eas}}$ 分别是体积载荷和 EAS 稳定化的刚度系数，$\\epsilon_0$ 是目标体积应变。\n\n平衡状态 $(\\epsilon_{\\text{mix}}, \\alpha_{\\text{mix}}, p_{\\text{mix}})$ 位于 $\\Pi_{\\text{mix}}$ 的驻点，在该点，总势能对所有变量的一阶偏导数均为零。\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial p} = \\epsilon + \\alpha = 0\n$$\n这个线性方程组可以写成矩阵形式：\n$$\n\\begin{bmatrix}\nk_u  0  1 \\\\\n0  k_{\\text{eas}}  1 \\\\\n1  1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0 \\\\\n0\n\\end{bmatrix}\n$$\n根据第三个方程，我们有 $\\alpha = -\\epsilon$。将其代入第二个方程得到 $p = k_{\\text{eas}}\\epsilon$。将这两个关系代入第一个方程得到：\n$$\nk_u(\\epsilon - \\epsilon_0) + k_{\\text{eas}}\\epsilon = 0 \\implies (k_u + k_{\\text{eas}})\\epsilon = k_u \\epsilon_0\n$$\n求解 $\\epsilon_{\\text{mix}}$、$\\alpha_{\\text{mix}}$ 和 $p_{\\text{mix}}$ 可得：\n$$\n\\epsilon_{\\text{mix}} = \\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\n\\alpha_{\\text{mix}} = -\\epsilon_{\\text{mix}} = -\\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\np_{\\text{mix}} = k_{\\text{eas}}\\epsilon_{\\text{mix}} = \\frac{k_u k_{\\text{eas}}}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n混合格式的雅可比行列式近似为 $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$。由于 $\\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}} = 0$，约束被精确满足，因此 $J_{\\text{mix}} = 1$。切向矩阵是黑塞矩阵，对于这个线性系统，它就是系数矩阵：\n$$\n\\mathbf{K}_{\\text{mix}} =\n\\begin{bmatrix}\nk_u  0  1 \\\\\n0  k_{\\text{eas}}  1 \\\\\n1  1  0\n\\end{bmatrix}\n$$\n\n接下来，我们分析罚函数格式。总势能为\n$$\n\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2\n$$\n其中 $\\lambda$ 是罚参数。平衡状态 $(\\epsilon_{\\text{pen}}, \\alpha_{\\text{pen}})$ 位于 $\\Pi_{\\text{pen}}$ 的驻点。\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + \\lambda(\\epsilon + \\alpha) = (k_u + \\lambda)\\epsilon + \\lambda\\alpha - k_u\\epsilon_0 = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + \\lambda(\\epsilon + \\alpha) = \\lambda\\epsilon + (k_{\\text{eas}} + \\lambda)\\alpha = 0\n$$\n该方程组为：\n$$\n\\begin{bmatrix}\nk_u + \\lambda  \\lambda \\\\\n\\lambda  k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n$$\n求解这个 $2 \\times 2$ 系统，例如通过矩阵求逆，可得到解。矩阵的行列式为 $D = (k_u + \\lambda)(k_{\\text{eas}} + \\lambda) - \\lambda^2 = k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})$。解为：\n$$\n\\begin{bmatrix}\n\\epsilon_{\\text{pen}} \\\\\n\\alpha_{\\text{pen}}\n\\end{bmatrix}\n= \\frac{1}{D}\n\\begin{bmatrix}\nk_{\\text{eas}} + \\lambda  -\\lambda \\\\\n-\\lambda  k_u + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\frac{k_u(k_{\\text{eas}} + \\lambda)}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\\\\n\\frac{-k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n\\end{bmatrix}\n$$\n罚函数法中雅可比行列式的体积应变项为：\n$$\n\\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}} = \\frac{k_u(k_{\\text{eas}} + \\lambda) - k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 = \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\n于是，雅可比行列式近似为 $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$，所以\n$$\nJ_{\\text{pen}} = 1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\n罚函数格式的切向矩阵是 $\\Pi_{\\text{pen}}$ 的黑塞矩阵：\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda  \\lambda \\\\\n\\lambda  k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\n\n现在我们可以为每个参数集 $(\\epsilon_0, k_u, k_{\\text{eas}}, \\lambda)$ 定义待计算的量。\n1. 雅可比行列式的绝对差为：\n$$\n|J_{\\text{pen}} - J_{\\text{mix}}| = \\left| \\left(1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right) - 1 \\right| = \\left| \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right|\n$$\n2. $\\mathbf{K}_{\\text{pen}}$ 的条件数，记为 $\\text{cond}(\\mathbf{K}_{\\text{pen}})$，使用谱2范数计算。由于 $\\mathbf{K}_{\\text{pen}}$ 是对称正定的，该条件数等于其最大特征值与最小特征值之比，即 $\\lambda_{\\text{max}}/\\lambda_{\\text{min}}$。\n3. $\\mathbf{K}_{\\text{mix}}$ 的条件数，记为 $\\text{cond}(\\mathbf{K}_{\\text{mix}})$，基于其奇异值计算为 $\\sigma_{\\text{max}}/\\sigma_{\\text{min}}$，这适用于不定对称矩阵 $\\mathbf{K}_{\\text{mix}}$。\n这些量将通过编程为每个测试案例计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    For each case, it compares a mixed formulation and a penalty formulation\n    for enforcing near-incompressibility in a simplified finite element model.\n    It calculates the difference in the resulting volume change (Jacobian) and\n    the condition numbers of the respective tangent matrices.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon_0, k_u, k_eas, lambda)\n        (0.02, 1000, 10, 10000),      # Case 1\n        (0.05, 500, 1000, 100),       # Case 2\n        (0.0, 200, 5, 1000000),      # Case 3\n        (-0.03, 1500, 50, 100000),    # Case 4\n        (0.02, 1000, 10000, 1),       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilon_0, k_u, k_eas, lambd = case\n\n        # --- Mixed Formulation ---\n        # The Jacobian for the mixed formulation is exactly 1, as the constraint\n        # epsilon_mix + alpha_mix = 0 is enforced strongly by the Lagrange multiplier.\n        J_mix = 1.0\n\n        # --- Penalty Formulation ---\n        # Analytically derived solution for J_pen = 1 + epsilon_pen + alpha_pen\n        # This avoids numerical errors from solving the linear system.\n        vol_strain_pen_numerator = k_u * k_eas * epsilon_0\n        vol_strain_pen_denominator = k_u * k_eas + lambd * (k_u + k_eas)\n        \n        # Handle the case where the denominator might be zero, although constraints\n        # k_u > 0, k_eas > 0, lambda > 0 prevent this.\n        if vol_strain_pen_denominator == 0:\n            # This case is not expected under problem constraints\n            vol_strain_pen = 0.0\n        else:\n            vol_strain_pen = vol_strain_pen_numerator / vol_strain_pen_denominator\n            \n        J_pen = 1.0 + vol_strain_pen\n\n        # --- Task 1: Absolute difference in Jacobian ---\n        diff_J = np.abs(J_pen - J_mix)\n\n        # --- Task 2  3: Condition numbers ----\n        \n        # Tangent matrix for the mixed formulation\n        K_mix = np.array([\n            [k_u, 0.0, 1.0],\n            [0.0, k_eas, 1.0],\n            [1.0, 1.0, 0.0]\n        ], dtype=float)\n\n        # Tangent matrix for the penalty formulation\n        K_pen = np.array([\n            [k_u + lambd, lambd],\n            [lambd, k_eas + lambd]\n        ], dtype=float)\n\n        # Compute condition numbers using the 2-norm (spectral norm).\n        # np.linalg.cond uses SVD, which is appropriate for both matrices\n        # as per the problem description.\n        cond_mix = np.linalg.cond(K_mix)\n        cond_pen = np.linalg.cond(K_pen)\n        \n        # Append results for the current case\n        results.extend([diff_J, cond_pen, cond_mix])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3543495"}]}