## 引言
在计算岩[土力学](@entry_id:180264)领域，精确模拟饱和土体等[近不可压缩材料](@entry_id:752388)的力学行为是至关重要但又充满挑战的任务。标准的位移[有限元法](@entry_id:749389)在处理这类问题时，会遭遇一种名为“[体积锁定](@entry_id:172606)”的严重数值缺陷，导致解的精度和可靠性急剧下降。为了克服这一障碍，学术界发展了多种高级单元技术。本文旨在系统性地介绍其中两类最重要且应用最广泛的方法：**混合单元列式 (mixed formulations)** 和 **增强应变单元列式 (enhanced strain formulations)**。

本文将通过三个章节，带领读者从理论基础走向工程应用。在第一章 **《原理与机制》** 中，我们将深入剖析[体积锁定](@entry_id:172606)的根源，并详细阐述混合与增强应变方法背后的[变分原理](@entry_id:198028)、稳定性要求（如[LBB条件](@entry_id:746626)）和一致性准则。接着，在第二章 **《应用与跨学科联系》** 中，我们将展示这些先进单元如何在高等孔隙岩[土力学](@entry_id:180264)、[非线性固体力学](@entry_id:171757)、[失效分析](@entry_id:266723)以及结构工程等多个领域中发挥关键作用，揭示其强大的问题解决能力和跨学科价值。最后，在第三章 **《动手实践》** 中，读者将通过一系列精心设计的实践问题，将理论知识转化为实际的分析与编程技能，加深对核心概念的理解。通过本次学习，您将掌握克服[体积锁定](@entry_id:172606)、构建稳健可靠有限元模型的关键知识。

## 原理与机制

在计算岩[土力学](@entry_id:180264)中，对饱和土、粘土或其他低[渗透性](@entry_id:154559)多孔介质的许多分析都涉及到[近不可压缩](@entry_id:752387)或完全不可压缩的力学行为。虽然标准位移[有限元法](@entry_id:749389)是求解弹性问题的有力工具，但在处理这种[不可压缩性约束](@entry_id:750592)时，它会遇到一种被称为**[体积锁定](@entry_id:172606) (volumetric locking)** 的严重数值病症。本章深入探讨了这一现象的根本原因，并系统地介绍了为克服此问题而发展的两类高级单元列式：**混合单元 (mixed formulations)** 和**增强应变单元 (enhanced strain formulations)**。我们将阐明这些方法背后的变分原理、稳定性要求以及确保其一致性的关键准则。

### [近不可压缩性](@entry_id:752381)挑战：[体积锁定](@entry_id:172606)

为了理解[体积锁定](@entry_id:172606)的根源，我们首先考察线弹性材料的[应变能密度](@entry_id:200085) $W$。通过将其分解为偏量部分（形状改变）和体积部分（体积改变），可以更清晰地揭示其物理内涵。对于各向同性材料，[应变能密度](@entry_id:200085)可以表示为：

$W(\boldsymbol{\varepsilon}) = \mu\,\mathrm{dev}\boldsymbol{\varepsilon}:\mathrm{dev}\boldsymbol{\varepsilon} + \frac{K}{2}\,(\mathrm{tr}\boldsymbol{\varepsilon})^2$

其中，$\boldsymbol{\varepsilon}$ 是[小应变张量](@entry_id:754968)，$\mathrm{dev}\boldsymbol{\varepsilon}$ 是其偏量部分，$\mathrm{tr}\boldsymbol{\varepsilon}$ 是其迹（即[体积应变](@entry_id:267252) $\nabla \cdot \boldsymbol{u}$）。$\mu$ 是[剪切模量](@entry_id:167228)，而 $K$ 是[体积模量](@entry_id:160069)，定义为 $K = \lambda + \frac{2}{3}\mu$，其中 $\lambda$ 是拉梅第一参数。这个表达式明确显示，材料抵抗形状改变的能力由剪切模量 $\mu$ 控制，而抵[抗体](@entry_id:146805)积改变的能力由[体积模量](@entry_id:160069) $K$ 控制 [@problem_id:3543485]。

在[近不可压缩](@entry_id:752387)极限下，例如在不排水加载条件下的饱和土体，体积模量 $K$ 相对于[剪切模量](@entry_id:167228) $\mu$ 变得非常大，即 $K \to \infty$。在这种情况下，应变能中的体积项 $\frac{K}{2}\,(\mathrm{tr}\boldsymbol{\varepsilon})^2$ 起到了一个[罚函数](@entry_id:638029)的作用。为了使系统的总[势能](@entry_id:748988)保持有限，[位移场](@entry_id:141476)必须近似满足**[不可压缩性约束](@entry_id:750592)**：

$\mathrm{tr}(\boldsymbol{\varepsilon}) = \nabla \cdot \boldsymbol{u} \approx 0$

这个约束必须在整个求解域上以弱形式或积分形式得到满足 [@problem_id:3543485]。

问题在于，标准的低阶位移有限元，如四节点双线性[四边形单元](@entry_id:176937) ($Q_1$)，其离散运动学假设过于严格，无法在满足一般加载条件的同时有效地满足这个约束。对于一个 $Q_1$ 单元，其位移场是双线性的，这导致其散度 $\nabla \cdot \boldsymbol{u}_h$ 在单元内部通常是坐标的线性函数，而非一个常数。在[纯弯曲](@entry_id:202969)等变形模式下，单元会产生非零的、线性变化的[体积应变](@entry_id:267252)。当 $K$ 非常大时，[罚函数](@entry_id:638029)项会极力抵抗这种变形，导致单元表现出虚假的、病态的刚度。这种现象就是**[体积锁定](@entry_id:172606) (volumetric locking)** [@problem_id:3543529]。

从根本上说，锁定是由于离散位移空间无法在不引入虚假体积应变的情况下准确表示某些基本变形模式（如弯曲）而引起的。位移自由度和体积应变自由度之间的不良耦合，导致在强制施加 $\nabla \cdot \boldsymbol{u}_h \approx 0$ 约束时，也过分地限制了单元的物理变形能力 [@problem_id:3543529]。

### [混合变分原理](@entry_id:165106)：引入独立场

克服[体积锁定](@entry_id:172606)的一种经典方法是采用**混合列式 (mixed formulation)**。其核心思想是，不再通过罚函数（即巨大的 $K$）来隐式地施加约束，而是引入一个独立的场（通常是一个[拉格朗日乘子](@entry_id:142696)）来显式地、[弱形式](@entry_id:142897)地施加该约束。

#### u-p 列式

对于[不可压缩性](@entry_id:274914)问题，最自然的独立场是静水压力 $p$。我们将其视为一个独立的未知量，并用它来施加体积约束。例如，压力与体积应变的关系 $p = -K\,\nabla\cdot\boldsymbol{u}$ 不再被直接代入，而是作为一个附加的方程在弱形式下求解 [@problem_id:3543485]。这样，位移 $\boldsymbol{u}$ 和压力 $p$ 就构成了混合未知场。

#### Hellinger-Reissner [变分原理](@entry_id:198028)

更广泛地说，混合方法植根于更一般的[变分原理](@entry_id:198028)。一个重要的例子是两场（位移-应力）**Hellinger-Reissner (H-R) [变分原理](@entry_id:198028)**。与仅有位移作为未知量的[最小势能原理](@entry_id:173340)不同，H-R 原理将位移 $\boldsymbol{u}$ 和对称[应力张量](@entry_id:148973) $\boldsymbol{\sigma}$ 都视为独立变量。其泛函 $\Pi_{\mathrm{HR}}$ 可以通过[对势能](@entry_id:203104)泛函进行勒让德变换得到：

$\Pi_{\mathrm{HR}}(u,\sigma) = \int_{\Omega} \left( \frac{1}{2}\,\sigma : \mathbb{S} : \sigma - \sigma : \varepsilon(u) \right)\,\mathrm{d}\Omega + \int_{\Omega} b \cdot u \,\mathrm{d}\Omega + \int_{\Gamma_t} \bar{t} \cdot u \,\mathrm{d}\Gamma$

这里，$\mathbb{S}$ 是柔度张量（[刚度张量](@entry_id:176588) $\mathbb{C}$ 的逆），$b$ 是[体力](@entry_id:174230)，$\bar{t}$ 是在边界 $\Gamma_t$ 上施加的已知面力。

对该泛函求关于 $\boldsymbol{u}$ 和 $\boldsymbol{\sigma}$ 的[驻点](@entry_id:136617)，其欧拉-拉格朗日方程能够自然地恢复所有控制方程：
1.  对 $\boldsymbol{\sigma}$ 的变分 ($\delta\sigma$) 得到几何协调方程（以柔度形式表示的[本构关系](@entry_id:186508)）：$\mathbb{S}:\sigma - \varepsilon(u) = 0$。
2.  对 $\boldsymbol{u}$ 的变分 ($\delta u$) 并进行[分部积分](@entry_id:136350)，得到平衡方程 $\nabla\cdot \sigma + b = 0$ 和自然边界条件 $\sigma n = \bar{t}$ [@problem_id:3543542]。

#### [本质边界条件与自然边界条件](@entry_id:146051)

在混合列式中，区分**[本质边界条件](@entry_id:173524) (essential boundary conditions)** 和**自然边界条件 (natural boundary conditions)** 至关重要。[本质边界条件](@entry_id:173524)是直接施加在[试探函数](@entry_id:756165)空间上的，例如在边界 $\Gamma_u$ 上指定位移 $u = \bar{u}$ 或在 $\Gamma_p$ 上指定压力 $p = \bar{p}$。相应的，[检验函数](@entry_id:166589)在这些边界上的值必须为零。

自然边界条件则是通过[弱形式](@entry_id:142897)中的边界积分项来施加的。它们是变分过程的产物。例如，在推导力学[平衡方程](@entry_id:172166)的[弱形式](@entry_id:142897)时，通过[分部积分](@entry_id:136350)会出现边界项 $\int_{\Gamma} (\sigma n) \cdot v \, \mathrm{d}\Gamma$。在未指定位移的边界部分 $\Gamma_t$ 上，我们可以施加指定的面力 $\bar{t}$，该项就变为 $\int_{\Gamma_t} \bar{t} \cdot v \, \mathrm{d}\Gamma$。同理，在孔压-位移耦合问题（如Biot[固结理论](@entry_id:747736)）中，达西定律的[弱形式](@entry_id:142897)会产生流速边界项，允许我们在边界 $\Gamma_q$ 上施加指定的流量 $\bar{q}$ [@problem_id:3543551]。

### 稳定性要求：LBB (Inf-Sup) 条件

然而，简单地选择任意的离散位移空间 $V_h$ 和压力空间 $Q_h$ 并不足以保证混合方法的成功。为了获得稳定且收敛的解，这对[离散空间](@entry_id:155685)必须满足一个关键的相容性条件，即 **Ladyzhenskaya–Babuška–Brezzi (LBB) 条件**，也称为 **[inf-sup 条件](@entry_id:174538)**。

对于 $u-p$ 列式，LBB 条件要求存在一个与网格尺寸 $h$ 无关的正常数 $\beta_0$，使得：

$\beta_h := \inf_{q_h \in Q_h} \sup_{v_h \in V_h} \frac{\left|\,\int_{\Omega} q_h \,\nabla \cdot v_h \,\mathrm{d}x\,\right|}{\|v_h\|_{H^1(\Omega)}\,\|q_h\|_{L^2(\Omega)}} \ge \beta_0 > 0$

这里，$\|\cdot\|_{H^1(\Omega)}$ 和 $\|\cdot\|_{L^2(\Omega)}$ 分别是标准的 $H^1$ 和 $L^2$ 范数。该条件直观上意味着，对于压力空间 $Q_h$ 中的任何一个非零[压力模](@entry_id:159654)式 $q_h$，位移空间 $V_h$ 中必须存在一个位移场 $v_h$，其散度 $\nabla \cdot v_h$ 与该[压力模](@entry_id:159654)式“不垂直”（即它们的 $L^2$ [内积](@entry_id:158127)不为零），并且这个位移场的范数是受控的。换句话说，离散位移空间必须足够“丰富”，能够控制住离散压力空间中的所有可能的[压力模](@entry_id:159654)式 [@problem_id:3543490]。

如果 LBB 条件不被满足，即 $\beta_h \to 0$ 或 $\beta_h = 0$，离散系统中就会存在虚假的、无法被位移场感知的[压力模](@entry_id:159654)式。这些模式是耦合[双线性](@entry_id:146819)形 $b(v,q)$ 的离散核的元素，它们会导致压力解出现非物理性的、棋盘格状的[振荡](@entry_id:267781)，从而使数值解完全失效。

#### LBB 条件失效的典型案例：$Q_1$-$Q_1$ 单元

等阶[双线性](@entry_id:146819)位移-压力单元（$Q_1$-$Q_1$）是 LBB 条件失效的一个经典例子。在规则的四边形网格上，考虑一个节点压力值为 $[1, -1, 1, -1]$ 的[压力模](@entry_id:159654)式。在单元的自然[坐标系](@entry_id:156346) $(\xi, \eta)$ 中，这个[压力模](@entry_id:159654)式对应于函数 $p_h(\xi, \eta) = \xi\eta$。然而，双线性[位移场](@entry_id:141476) $v_h \in (Q_1)^2$ 的散度 $\nabla \cdot v_h$ 只是一个关于 $(\xi, \eta)$ 的线性函数，即属于 $\mathrm{span}\{1, \xi, \eta\}$。由于函数 $\xi\eta$ 在 $[-1,1]^2$ 上与 $\{1, \xi, \eta\}$ 中的所有[基函数](@entry_id:170178)正交，我们有：

$\int_{-1}^1\int_{-1}^1 p_h(\xi,\eta) (\nabla \cdot v_h) \,\mathrm{d}\xi\mathrm{d}\eta = 0, \quad \forall v_h \in (Q_1)^2$

这意味着存在一个非零的[压力模](@entry_id:159654)式 $p_h$，它对于所有可能的离散[位移场](@entry_id:141476)都是“不可见”的。这直接导致了 inf-sup 常数 $\beta_h=0$，从而违反了 LBB 条件，并产生了所谓的**棋盘格 (checkerboarding)** 压力[振荡](@entry_id:267781) [@problem_id:3543507]。

### 稳定与不稳定的单元对：实践指南

LBB 理论为我们选择合适的单元组合提供了坚实的理论基础。以下是一些在岩土工程计算中常见的单元对及其稳定性特征：

*   **稳定的单元对**：
    *   **Taylor-Hood 单元族**：这类单元采用比压力阶次高一阶的多项式来插值位移。例如，在三角形网格上的 $P_2$-$P_1$ 单元（二次连续位移，线性连续压力）和在四边形网格上的 $Q_2$-$Q_1$ 单元（双二次连续位移，[双线性](@entry_id:146819)连续压力）都是经典且鲁棒的 LBB 稳定单元。它们在形函数规则的网格上表现优异，是许多商业和开源软件的黄金标准 [@problem_id:3543511]。
    *   **MINI 单元**：对于等阶插值（如线性位移-线性压力），可以通过丰富位移空间来恢复稳定性。MINI 单元（在三角形上为 $P_1^b$-$P_1$）在标准的连续线性位移空间中，为每个单元增加了一个“泡状”位移模式（一个在单元边界为零但在内部非零的函数）。这个额外的、不连续的位移模式提供了足够的运动自由度来控制线性压[力场](@entry_id:147325)，从而满足 LBB 条件。证明其稳定性的数学工具是构建一个满足特定性质的 **Fortin 投影算子** [@problem_id:3543473]。

*   **不稳定的单元对及常见“修正”**：
    *   **$Q_1$-$P_0$ 单元**：双线性连续位移与单元常数压力的组合。这是一个著名的 LBB 不稳定单元，尽管它在某些情况下看似能够缓解锁定，但它会引入自己的压力[振荡](@entry_id:267781)模式 [@problem_id:3543511] [@problem_id:3543529]。
    *   **带[选择性减缩积分 (SRI)](@entry_id:754659) 的 $Q_1$-$Q_1$ 单元**：通过对体积能项或压力耦合项使用低阶积分（如单点[高斯积分](@entry_id:187139)），可以缓解 $Q_1$ 单元的[体积锁定](@entry_id:172606)。然而，这种方法并没有从根本上修复 LBB 条件的缺陷。它实际上是通过积分“看不见”不稳定的[压力模](@entry_id:159654)式来工作，但这往往会引入新的[零能模式](@entry_id:172472)，即所谓的**[沙漏模式](@entry_id:174855) (hourglass modes)**，需要额外的[沙漏控制](@entry_id:163812)技术来稳定，这使得该方法的理论基础不如真正的 LBB 稳定单元坚实 [@problem_id:3543511]。

### 增强假定应变 (EAS) 方法

除了混合列式，**增强假定应变 (Enhanced Assumed Strain, EAS)** 方法提供了另一种绕开[体积锁定](@entry_id:172606)的有效途径。EAS 的思想不是引入全局的独立场（如压力），而是在单元层面“增强”应变场本身。

其核心运动学假设是，单元内的总应变 $\boldsymbol{\varepsilon}_h$ 是两部分之和：

$\boldsymbol{\varepsilon}_h = \boldsymbol{\varepsilon}(\boldsymbol{u}_h) + \boldsymbol{\varepsilon}^*(\boldsymbol{\alpha})$

其中，$\boldsymbol{\varepsilon}(\boldsymbol{u}_h)$ 是由节点位移 $\boldsymbol{u}_h$ 产生的标准**协调应变 (compatible strain)**，而 $\boldsymbol{\varepsilon}^*(\boldsymbol{\alpha})$ 是一个附加的、仅依赖于单元内部参数 $\boldsymbol{\alpha}$ 的**增强应变场** [@problem_id:3543525]。

为了保证方法的一致性，增强应变场 $\boldsymbol{\varepsilon}^*$ 并非任意选取。它必须源于一个在单元边界上为零的“泡状”[位移场](@entry_id:141476) $\boldsymbol{u}^*$ 的对称梯度。这一要求确保了增强应变不会破坏单元间的位移连续性，并且其对应的[虚功](@entry_id:176403)仅限于单元内部。内部参数 $\boldsymbol{\alpha}$ 可以在单元层面通过**静力凝聚 (static condensation)** 的方式求解并消除，最终得到的[刚度矩阵](@entry_id:178659)仍然只涉及节点位移自由度，这在计算上十分高效 [@problem_id:3543525]。通过精心设计增强应变模式，可以使单元在保持位移协调性的同时，能够表示更复杂的应变状态（如[纯弯曲](@entry_id:202969)下的零体积应变），从而有效地消除锁定。

### [一致性与收敛性](@entry_id:747723)：面片检验

一个数值稳定的单元（无论是混合的还是增强的）要成为一个可靠的工具，还必须满足**一致性 (consistency)** 的要求。一致性保证了当网格无限加密时，数值解能够收敛到正确的连续介质解。**面片检验 (patch test)** 是验证[有限元列式](@entry_id:164720)一致性的一个基本数值测试。

线性面片检验要求，对于任意一个由单元组成的“面片”，当施加的边界条件对应于一个精确的常应变（线性位移）解时，有限元模型必须能够精确地（达到机器精度）重现这个常应变和常应力状态 [@problem_id:3543504]。

为了通过面片检验，不同的单元列式必须满足特定条件：
*   **基本要求**：对于所有类型的单元，位移[插值函数](@entry_id:262791)必须能够精确表示任意线性场（即包含常数和线性项），并且数值积分方案必须足够精确，能够准确计算在线性[位移场](@entry_id:141476)下弱形式中的所有积分项。
*   **Hellinger-Reissner 混合单元**：除了基本要求外，其应力插值空间必须能够精确表示任意常数应力张量 [@problem_id:3543504]。
*   **增强假定应变 (EAS) 单元**：除了基本要求外，增强应变空间必须与常数应力空间（在能量上）正交。即 $\int_{\Omega_e} \boldsymbol{\sigma}_{\text{const}} : \boldsymbol{\varepsilon}^* \, dV = 0$。这个[正交性条件](@entry_id:168905)确保了在常应变状态下，增强模式不会被“激活”，单元的行为退化为标准的协调单元，从而正确地传递常应力状态 [@problem_id:3543504]。

值得强调的是，稳定性（LBB 条件）和一致性（面片检验）是评价一个高级单元性能的两个独立且同等重要的标准。一个单元必须同时满足这两个条件，才能被认为是可靠和收敛的。