{"hands_on_practices": [{"introduction": "要真正掌握“后验”误差估计，我们必须首先理解其基本构成。本实践练习将引导您详细计算有限元解中误差的两个主要来源：衡量单元内部不平衡的单元残差，以及量化单元间非物理牵引力不连续性的跳跃残差。通过这个关于分层土体的具体例子，您将对这些数学术语如何直接关联于数值模型中的物理不平衡获得切实的理解。[@problem_id:3499439]", "problem": "考虑在一个二维小应变线性弹性模型中，两个相邻的线性三角形有限元。该模型用于分析垂直荷载作用下的层状土，并假定为平面应变问题。设顶部单元用 $K$ 表示（位于上层），底部单元用 $K'$ 表示（位于下层）。全局坐标系为 $(x,y)$，其中 $y$ 轴正方向朝上，地表位于 $y=0$。共享的内部边 $e$ 是水平的，位于 $y=-1$，从 $(0,-1)$ 到 $(2,-1)$，边 $e$ 上从 $K$ 指向 $K'$ 的单位法向量为 $n_e=(0,-1)^{\\mathsf{T}}$。\n\n几何与运动学：\n- 单元 $K$ 的顶点为 $x_1=(0,-1)$, $x_2=(2,-1)$, $x_3=(0,0)$。\n- 单元 $K'$ 的顶点为 $x_1'=(0,-1)$, $x_2'=(2,-1)$, $x_3'=(0,-2)$。\n- 协调的分片线性位移场 $u_h=(u_{h,x},u_{h,y})^{\\mathsf{T}}$ 在各顶点的指定值如下（单位：米）：\n  - 在 $K$ 上：$u_h(x_1)=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_2)=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_3)=(-0.8\\times 10^{-4},\\,0)$。\n  - 在 $K'$ 上：$u_h(x_1')=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_2')=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$，$u_h(x_3')=(-1.3\\times 10^{-4},\\,-1.2\\times 10^{-3})$。\n\n本构行为和体力：\n- 上层（单元 $K$）：杨氏模量 $E_1=5.0\\times 10^{7}$，泊松比 $\\nu_1=0.3$。\n- 下层（单元 $K'$）：杨氏模量 $E_2=1.5\\times 10^{8}$，泊松比 $\\nu_2=0.25$。\n- 假定为平面应变。Cauchy 应力为 $\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$，其中 $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$，$\\mu=\\dfrac{E}{2(1+\\nu)}$，以及 $\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$，其中 $(E,\\nu)$ 取各单元的值。\n- $K$ 内的体力是分片常数，代表自重：$f=(0,\\,-\\rho_1 g)^{\\mathsf{T}}$，其中 $\\rho_1=1800$，g=9.81。假设 $K$ 内部体力没有变化，并且本次计算不需要来自 $K'$ 的体力数据。\n\n平衡与残差：\n- 平衡的强形式为 $-\\nabla\\cdot\\sigma(u)=f$。$K$ 上的单元残差定义为 $L^2$-范数 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$，$e$ 上的内部边跳跃残差定义为 $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$，其中 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$。\n\n任务：\n1) 从小应变的运动学关系和平面应变各向同性线性弹性定律出发，计算 $K$ 和 $K'$ 上的 $\\nabla u_h$，然后计算每个单元上的 $\\varepsilon(u_h)$ 和 $\\sigma(u_h)$。使用指定的节点值来确定每个线性三角形上的常数梯度。\n\n2) 使用平衡方程以及 $\\sigma(u_h)$ 在每个具有常数系数的线性三角形上是常数这一事实，确定 $K$ 上的 $f+\\nabla\\cdot\\sigma(u_h)$，并计算单元残差范数 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$。\n\n3) 计算 $e$ 上的牵引力跳跃向量 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$，然后计算其 $L^2$-范数 $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$。\n\n4) 设单元尺寸参数为 $h_K$，定义为 $K$ 的最长边的长度。构建无量纲比率\n$$\nR \\;=\\; \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}.\n$$\n计算 $R$ 并将最终答案四舍五入到四位有效数字。将 $R$ 表示为一个无量纲的纯数。\n\n5) 根据您的计算值和层状土在垂直荷载作用下的物理情景，简要解释在自适应算法中，单元残差和跳跃残差将各自如何驱动网格细化。\n\n注意：始终使用国际单位制（SI）。最终报告的答案必须是 $R$ 作为无量纲数的单个四舍五入值。", "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n- **单元**：二维平面应变模型中的两个相邻线性三角形有限元，$K$（顶部）和 $K'$（底部）。\n- **几何**：\n    - 共享边 $e$ 是水平的，从 $(0, -1)$ 到 $(2, -1)$。\n    - 从 $K$ 指向 $K'$ 的边 $e$ 上的单位法向量为 $n_e = (0, -1)^{\\mathsf{T}}$。\n    - $K$ 的顶点：$x_1=(0, -1)$, $x_2=(2, -1)$, $x_3=(0, 0)$。\n    - $K'$ 的顶点：$x_1'=(0, -1)$, $x_2'=(2, -1)$, $x_3'=(0, -2)$。\n- **位移场 ($u_h$)**：协调的分片线性场，节点值（单位：米）：\n    - 在 $K$ 上：$u_h(x_1)=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_2)=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_3)=(-0.8\\times 10^{-4}, 0)$。\n    - 在 $K'$ 上：$u_h(x_1')=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_2')=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$，$u_h(x_3')=(-1.3\\times 10^{-4}, -1.2\\times 10^{-3})$。\n- **材料属性**：\n    - 层 $K$：杨氏模量 $E_1=5.0\\times 10^{7}$ Pa，泊松比 $\\nu_1=0.3$。\n    - 层 $K'$：杨氏模量 $E_2=1.5\\times 10^{8}$ Pa，泊松比 $\\nu_2=0.25$。\n- **本构定律**：平面应变线性弹性，$\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$，其中应变为 $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$，Lamé 参数为 $\\mu=\\dfrac{E}{2(1+\\nu)}$，$\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- **体力**：在 $K$ 上，$f=(0, -\\rho_1 g)^{\\mathsf{T}}$，其中 $\\rho_1=1800$ kg/m$^3$，g=9.81$ m/s$^2$。\n- **残差定义**：\n    - $K$ 上的单元残差：$\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$。\n    - $e$ 上的跳跃残差：$\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$，其中 $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$。\n- **任务**：计算无量纲比率 $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$，其中 $h_K$ 是 $K$ 的最长边的长度。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在理论上根植于线性弹性和有限元方法，特别使用了计算力学中的*后验*误差估计概念。材料属性和荷载的值在岩土力学背景下是物理上现实的。\n- **良态性**：该问题是基于所提供的数据和有限元方法的标准公式进行的一系列直接计算。所有必要信息都已给出，可以计算出 $R$ 的唯一数值。\n- **客观性**：问题陈述使用了精确、客观和标准的技术术语。\n- **一致性和完整性**：单元的几何数据是一致的。位移场在共享节点 $x_1$ 和 $x_2$ 处的连续性得到检查，数值匹配，证实了陈述中的协调性。所有需要的常数和定义都已提供。问题是自包含的。\n- **其他缺陷**：问题没有表现出任何其他缺陷，如过于简单、隐喻性或科学上不可验证。\n\n### 步骤 3：结论和行动\n问题是有效的。有必要给出完整解答。\n\n### 解答\n解答过程遵循问题陈述中列出的五个任务。所有计算均使用国际单位制（SI）。\n\n**1) 计算每个单元上的位移梯度、应变和应力。**\n\n对于线性三角形单元，分片线性位移场 $u_h$ 的梯度是常数。梯度张量 $\\nabla u_h$ 的分量可以用公式 $\\frac{\\partial u_\\alpha}{\\partial x_\\beta} = \\frac{1}{2A} \\sum_{i=1}^3 c_{i\\beta} u_{i\\alpha}$ 计算，其中 $A$ 是单元面积，系数由节点坐标导出。为更直接地计算，我们使用标准公式，其中梯度分量为 $\\partial_x u_k = \\frac{1}{2A}\\sum_i b_i u_{ik}$ 和 $\\partial_y u_k = \\frac{1}{2A}\\sum_i c_i u_{ik}$，其中 $k \\in \\{x,y\\}$，$b_i = y_j - y_k$，$c_i = x_k - x_j$，节点 $(i, j, k)$ 按循环顺序排列。\n\n_在单元 $K$ 上（顶点 $x_1=(0,-1)$, $x_2=(2,-1)$, $x_3=(0,0)$）：_\n面积为 $A_K = \\frac{1}{2} |(x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1)| = \\frac{1}{2} |(2)(1) - (0)(0)| = 1$。\n系数为：\n$b_1 = y_2 - y_3 = -1 - 0 = -1$, $c_1 = x_3 - x_2 = 0 - 2 = -2$。\n$b_2 = y_3 - y_1 = 0 - (-1) = 1$, $c_2 = x_1 - x_3 = 0 - 0 = 0$。\n$b_3 = y_1 - y_2 = -1 - (-1) = 0$, $c_3 = x_2 - x_1 = 2 - 0 = 2$。\n节点位移为 $u_1=(-1, -5) \\times 10^{-4}$, $u_2=(-1.2, -5) \\times 10^{-4}$, $u_3=(-0.8, 0) \\times 10^{-4}$。\n\n$\\partial_x u_{h,x} = \\frac{1}{2(1)}[(-1)(-1.0) + (1)(-1.2) + (0)(-0.8)]\\times 10^{-4} = -0.1 \\times 10^{-4}$。\n$\\partial_y u_{h,x} = \\frac{1}{2(1)}[(-2)(-1.0) + (0)(-1.2) + (2)(-0.8)]\\times 10^{-4} = 0.2 \\times 10^{-4}$。\n$\\partial_x u_{h,y} = \\frac{1}{2(1)}[(-1)(-5.0) + (1)(-5.0) + (0)(0)]\\times 10^{-4} = 0$。\n$\\partial_y u_{h,y} = \\frac{1}{2(1)}[(-2)(-5.0) + (0)(-5.0) + (2)(0)]\\times 10^{-4} = 5.0 \\times 10^{-4}$。\n所以，$(\\nabla u_h)_K = \\begin{pmatrix} -0.1  0.2 \\\\ 0  5.0 \\end{pmatrix} \\times 10^{-4}$。\n\n应变张量为 $\\varepsilon_K = \\frac{1}{2}((\\nabla u_h)_K + (\\nabla u_h)_K^{\\mathsf{T}}) = \\begin{pmatrix} -0.1  0.1 \\\\ 0.1  5.0 \\end{pmatrix} \\times 10^{-4}$。\n迹为 $\\mathrm{tr}(\\varepsilon_K) = (-0.1 + 5.0) \\times 10^{-4} = 4.9 \\times 10^{-4}$。\n$K$ 的材料属性：$E_1=5.0\\times 10^{7}$，$\\nu_1=0.3$。\n$\\mu_1 = \\frac{5.0 \\times 10^7}{2(1+0.3)} = \\frac{25}{13}\\times 10^7$。\n$\\lambda_1 = \\frac{(5.0 \\times 10^7)(0.3)}{(1+0.3)(1-2 \\times 0.3)} = \\frac{75}{26}\\times 10^7$。\n应力张量为 $\\sigma_K = 2\\mu_1\\varepsilon_K + \\lambda_1\\mathrm{tr}(\\varepsilon_K)I$：\n$\\sigma_{xx,K} = 2(\\frac{25}{13}\\times 10^7)(-0.1\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = 13750$ Pa。\n$\\sigma_{yy,K} = 2(\\frac{25}{13}\\times 10^7)(5.0\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = \\frac{867500}{26} \\approx 33365.38$ Pa。\n$\\sigma_{xy,K} = 2(\\frac{25}{13}\\times 10^7)(0.1\\times 10^{-4}) = \\frac{5000}{13} \\approx 384.62$ Pa。\n因此，$\\sigma_K \\approx \\begin{pmatrix} 13750  384.62 \\\\ 384.62  33365.38 \\end{pmatrix}$ Pa。\n\n_在单元 $K'$ 上（顶点 $x_1'=(0,-1)$, $x_2'=(2,-1)$, $x_3'=(0,-2)$）：_\n面积为 $A_{K'} = \\frac{1}{2} |(2)(-1) - (0)(0)| = 1$。\n系数为：\n$b_1' = y_2' - y_3' = -1 - (-2) = 1$, $c_1' = x_3' - x_2' = 0 - 2 = -2$。\n$b_2' = y_3' - y_1' = -2 - (-1) = -1$, $c_2' = x_1' - x_3' = 0 - 0 = 0$。\n$b_3' = y_1' - y_2' = -1 - (-1) = 0$, $c_3' = x_2' - x_1' = 2 - 0 = 2$。\n节点位移 $u_1'=(-1, -5) \\times 10^{-4}$, $u_2'=(-1.2, -5) \\times 10^{-4}$, $u_3'=(-1.3, -12) \\times 10^{-4}$。\n$(\\nabla u_h)_{K'} = \\begin{pmatrix} 0.1  -0.3 \\\\ 0  -7.0 \\end{pmatrix} \\times 10^{-4}$。\n\n应变张量为 $\\varepsilon_{K'} = \\begin{pmatrix} 0.1  -0.15 \\\\ -0.15  -7.0 \\end{pmatrix} \\times 10^{-4}$。\n迹为 $\\mathrm{tr}(\\varepsilon_{K'}) = (0.1 - 7.0) \\times 10^{-4} = -6.9 \\times 10^{-4}$。\n$K'$ 的材料属性：$E_2=1.5\\times 10^8$, $\\nu_2=0.25$。\n$\\mu_2 = \\frac{1.5 \\times 10^8}{2(1+0.25)} = 6.0\\times 10^7$。\n$\\lambda_2 = \\frac{(1.5 \\times 10^8)(0.25)}{(1+0.25)(1-2 \\times 0.25)} = 6.0\\times 10^7$。\n应力张量为 $\\sigma_{K'} = 2\\mu_2\\varepsilon_{K'} + \\lambda_2\\mathrm{tr}(\\varepsilon_{K'})I$：\n$\\sigma_{xx,K'} = 2(6\\times 10^7)(0.1\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -40200$ Pa。\n$\\sigma_{yy,K'} = 2(6\\times 10^7)(-7.0\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -125400$ Pa。\n$\\sigma_{xy,K'} = 2(6\\times 10^7)(-0.15\\times 10^{-4}) = -1800$ Pa。\n因此，$\\sigma_{K'} = \\begin{pmatrix} -40200  -1800 \\\\ -1800  -125400 \\end{pmatrix}$ Pa。\n\n**2) 计算 $K$ 上的单元残差范数。**\n单元残差为 $r_K = f + \\nabla \\cdot \\sigma(u_h)$。对于线性三角形单元，计算出的应力张量 $\\sigma(u_h)$ 在整个单元内是常数。因此，其散度为零：$\\nabla \\cdot \\sigma(u_h) = 0$。残差简化为体力项，$r_K = f$。\n体力为 $f = (0, -\\rho_1 g)^{\\mathsf{T}} = (0, -1800 \\times 9.81)^{\\mathsf{T}} = (0, -17658)^{\\mathsf{T}}$ N/m$^3$。\n残差的 $L^2$-范数为 $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K} = \\|f\\|_{0,K} = \\left(\\int_K |f|^2 dA\\right)^{1/2}$。\n由于 $f$ 是常数，这简化为 $|f| \\sqrt{A_K}$。\n$\\|f\\|_{0,K} = \\sqrt{0^2 + (-17658)^2} \\times \\sqrt{1} = 17658$。单位是 N/m$^2$。\n\n**3) 计算 $e$ 上的跳跃残差范数。**\n跳跃向量为 $J = [\\![\\sigma(u_h)n_e]\\!] = (\\sigma_K - \\sigma_{K'})n_e$。法向量为 $n_e = (0, -1)^{\\mathsf{T}}$。\n首先，我们计算应力张量的差值：\n$\\Delta\\sigma = \\sigma_K - \\sigma_{K'} = \\begin{pmatrix} 13750 - (-40200)  \\frac{5000}{13} - (-1800) \\\\ \\frac{5000}{13} - (-1800)  \\frac{867500}{26} - (-125400) \\end{pmatrix} = \\begin{pmatrix} 53950  \\frac{28400}{13} \\\\ \\frac{28400}{13}  \\frac{2063950}{13} \\end{pmatrix}$ Pa。\n跳跃向量为 $J = \\Delta\\sigma n_e = \\begin{pmatrix} 53950  \\frac{28400}{13} \\\\ \\frac{28400}{13}  \\frac{2063950}{13} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{28400}{13} \\\\ -\\frac{2063950}{13} \\end{pmatrix}$ Pa。\n$J \\approx (-2184.62, -158765.38)^{\\mathsf{T}}$ Pa。\n$L^2$-范数为 $\\|J\\|_{0,e} = \\left(\\int_e |J|^2 ds\\right)^{1/2}$。由于 $J$ 沿着边 $e$ 是常数，这变为 $|J|\\sqrt{L_e}$，其中 $L_e$ 是 $e$ 的长度。\n边 $e$ 连接 $(0, -1)$ 和 $(2, -1)$，所以其长度为 $L_e = 2$ m。\n$|J|^2 = \\left(-\\frac{28400}{13}\\right)^2 + \\left(-\\frac{2063950}{13}\\right)^2 = \\frac{1}{169}(28400^2 + 2063950^2) = \\frac{4260827582500}{169}$。\n$\\|J\\|_{0,e} = \\sqrt{2 \\times \\frac{4260827582500}{169}} = \\frac{\\sqrt{8521655165000}}{13} \\approx 224552.87$。单位是 N/m$^{3/2}$。\n\n**4) 计算无量纲比率 $R$。**\n比率为 $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$。\n首先，确定 $h_K$，即 $K$ 的最长边的长度。$K$ 的边长为：\n$L_{12} = \\sqrt{(2-0)^2 + (-1-(-1))^2} = 2$。\n$L_{23} = \\sqrt{(0-2)^2 + (0-(-1))^2} = \\sqrt{4+1} = \\sqrt{5}$。\n$L_{31} = \\sqrt{(0-0)^2 + (-1-0)^2} = 1$。\n最长边是 $h_K = \\sqrt{5}$ m。\n现在，我们计算 $R$：\n$R = \\frac{(\\sqrt{5})^{1/2} \\times 17658}{224552.87} = \\frac{5^{1/4} \\times 17658}{224552.87}$。\n$5^{1/4} \\approx 1.49534878$。\n$R \\approx \\frac{1.49534878 \\times 17658}{224552.87} \\approx \\frac{26405.303}{224552.87} \\approx 0.117591$。\n四舍五入到四位有效数字得到 $R=0.1176$。\n\n**5) 对自适应网格细化的物理解释。**\n这两个残差量化了数值解中误差的不同方面。\n**单元残差** $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$，衡量了单元内部不满足平衡的程度。对于线性单元，该项简化为 $\\|f\\|_{0,K}$，表明常数应力无法平衡非零体力。该残差驱动在那些受力项需要更复杂（例如，非常数）应力场的区域进行网格细化。\n**跳跃残差** $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$，衡量了跨单元边界的牵引力连续性的违反程度，而牵引力连续性是平衡的一个要求（牛顿第三定律）。大的跳跃表示相邻单元之间存在大的、非物理的力不平衡。这通常是材料界面处的主要误差来源，在这些界面上，刚度不连续性导致剧烈的应力梯度，而分片多项式应力场对此的近似效果很差。\n在本问题中，比率 $R \\approx 0.1176$ 很小，这表明在适当缩放后，跳跃残差项显著大于单元残差项。这意味着误差的主要来源是跨材料界面的大牵引力不平衡，而不是单元内部无法平衡自重。因此，自适应算法会优先细化两个土层之间的边界（边 $e$）处的网格，以更好地解析界面处的应力集中。", "answer": "$$\\boxed{0.1176}$$", "id": "3499439"}, {"introduction": "在残差概念的基础上，更先进的误差估计器依赖于构建一个“更好”的、满足平衡条件的应力场，以便与原始数值解进行比较。本练习聚焦于此方法的一个核心原则：确保局部平衡和牵引力连续性。您将建立并求解一个局部片问题，以确定内部单元边界上满足这些平衡条件的唯一牵引力，为理解和实现平衡恢复技术提供基础技能。[@problem_id:3499358]", "problem": "考虑一个平面应变岩土力学基准问题，其中平衡应力重构通过一个误差估计器来驱动自适应网格加密。其目标是恢复一个应力场 $\\hat{\\sigma}_{h}$，该应力场全局平衡且位于平方可积散度的索博列夫空间 $\\mathrm{H}(\\mathrm{div})$ 中，实现方式是通过在内部边上强制边牵引力向量 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 的连续性，并引入给定的牵引力边界数据。\n\n从一个惯性可忽略的线性弹性体的静力平衡强形式出发，\n$$\n\\nabla \\cdot \\sigma + \\boldsymbol{f} = \\boldsymbol{0} \\quad \\text{in } \\Omega, \\qquad \\sigma \\boldsymbol{n} = \\boldsymbol{t} \\quad \\text{on } \\Gamma_{t},\n$$\n其中 $\\Omega \\subset \\mathbb{R}^{2}$ 是域，$\\sigma$ 是 Cauchy 应力张量，$\\boldsymbol{f}$ 是单位体积的体力，$\\Gamma_{t} \\subset \\partial \\Omega$ 是牵引力边界，$\\boldsymbol{n}$ 是边界的外向单位法向量。\n\n给定域 $\\Omega = (0,1) \\times (0,1)$，通过从 $(0,0)$ 到 $(1,1)$ 的对角线将其离散为两个三角形有限元。将顶点为 $\\{(0,0),(1,0),(1,1)\\}$ 的单元记为 $K_{1}$，顶点为 $\\{(0,0),(0,1),(1,1)\\}$ 的单元记为 $K_{2}$。内部边是位于 $(0,0)$ 和 $(1,1)$ 之间的 $E_{d}$，其长度为 $|E_{d}|=\\sqrt{2}$。设 $K_{1}$ 的外向单位法向量为：右边为 $\\boldsymbol{n}_{r}=(1,0)$，底边为 $\\boldsymbol{n}_{b}=(0,-1)$，对角线边为 $\\boldsymbol{n}_{d}^{(1)}=\\frac{1}{\\sqrt{2}}(-1,1)$。对于 $K_{2}$，设其外向单位法向量为：左边为 $\\boldsymbol{n}_{l}=(-1,0)$，顶边为 $\\boldsymbol{n}_{t}=(0,1)$，对角线边为 $\\boldsymbol{n}_{d}^{(2)}=\\frac{1}{\\sqrt{2}}(1,-1)$。假设体力为零，即 $\\boldsymbol{f}=\\boldsymbol{0}$。\n\n牵引力边界数据规定如下：在右边界上，$\\boldsymbol{t}=(T,0)$；在左边界上，$\\boldsymbol{t}=(-T,0)$；在顶边界和底边界上，$\\boldsymbol{t}=\\boldsymbol{0}$。这些数据满足边界载荷的全局平衡。应力重构的目标是在每个单元上得到一个分片常数的对称张量 $\\hat{\\sigma}_{h}$，该张量是平衡的，并强制内部边 $E_{d}$ 上的边牵引力向量 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 连续。\n\n通过施加单元级平衡\n$$\n\\int_{\\partial K} \\hat{\\sigma}_{h}\\boldsymbol{n}\\, \\mathrm{d}s = \\boldsymbol{0},\n$$\n和边牵引力约束\n$$\n\\hat{\\sigma}_{h}\\boldsymbol{n} = \\boldsymbol{q}_{E} \\quad \\text{在每个边 } E \\subset \\partial K \\text{ 上为常数},\n$$\n来构建每个单元 $K$ 上的局部片问题，其中 $\\boldsymbol{q}_{E}$ 在内部边上是单值的（确保 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 跨越 $E$ 的连续性），并且在边界边上等于给定的边界牵引力 $\\boldsymbol{t}$。对于上述特定的网格和载荷，确定与内部对角线边 $E_{d}$ 相关联的唯一常数向量 $\\boldsymbol{q}_{d}$，该向量强制全局平衡以及 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 在 $E_{d}$ 上的连续性。用 $T$ 来表示您关于 $\\boldsymbol{q}_{d}$ 的最终答案。\n\n你的最终答案必须是单一的解析表达式，并以行向量的形式给出。无需四舍五入。最终表达式中不应包含单位。", "solution": "用户提供了一个来自计算岩土力学领域的有效问题陈述。该问题科学基础扎实、提法恰当、目标明确，并包含足够的信息来确定唯一解。下面将进行详细推导。\n\n该问题要求我们确定一个双单元网格的内部对角线边 $E_{d}$ 上的唯一常数牵引力向量 $\\boldsymbol{q}_{d}$。该解是通过对重构的、分片常数的应力场 $\\hat{\\sigma}_{h}$ 强制局部、单元级的平衡来导出的。\n\n每个单元 $K$ 上的局部片问题的控制原理是在体力为零（$\\boldsymbol{f}=\\boldsymbol{0}$）时的积分形式的静力平衡。鉴于重构的应力张量 $\\hat{\\sigma}_{h}$ 在每个单元内是常数，条件 $\\nabla \\cdot \\hat{\\sigma}_h = \\boldsymbol{0}$ 在单元内部被平凡满足。平衡约束在单元边界 $\\partial K$ 上表示为：\n$$\n\\int_{\\partial K} \\hat{\\sigma}_{h}\\boldsymbol{n}\\, \\mathrm{d}s = \\boldsymbol{0}\n$$\n其中 $\\boldsymbol{n}$ 是单元边界的外向单位法向量。问题陈述指出，牵引力向量 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 在每个边 $E \\subset \\partial K$ 上是常数，记为 $\\boldsymbol{q}_{E}$。因此，积分平衡方程简化为单元各边上的代数和：\n$$\n\\sum_{E \\subset \\partial K} \\boldsymbol{q}_{E} |E| = \\boldsymbol{0}\n$$\n其中 $|E|$ 是边 $E$ 的长度。\n\n域 $\\Omega = (0,1) \\times (0,1)$ 被划分为两个三角形单元：顶点为 $\\{(0,0),(1,0),(1,1)\\}$ 的 $K_{1}$ 和顶点为 $\\{(0,0),(0,1),(1,1)\\}$ 的 $K_{2}$。内部边 $E_d$ 是连接 $(0,0)$ 和 $(1,1)$ 的对角线，其长度为 $|E_d| = \\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$。域的外部边长度为 $1$。\n\n问题规定了“内部边上边牵引力向量 $\\hat{\\sigma}_{h}\\boldsymbol{n}$ 的连续性”，并且相关的向量 $\\boldsymbol{q}_{E}$ 在“内部边上是单值的”。物理上，单元 $K_1$ 施加于 $K_2$ 的牵引力必须与 $K_2$ 施加于 $K_1$ 的牵引力大小相等、方向相反。设 $\\boldsymbol{n}_{d}^{(1)}$ 和 $\\boldsymbol{n}_{d}^{(2)}$ 分别为从单元 $K_1$ 和 $K_2$ 指向边 $E_d$ 的外向单位法向量。给定 $\\boldsymbol{n}_{d}^{(1)} = -\\boldsymbol{n}_{d}^{(2)}$。牵引力连续性条件为 $\\hat{\\sigma}_{h,1} \\boldsymbol{n}_{d}^{(1)} + \\hat{\\sigma}_{h,2} \\boldsymbol{n}_{d}^{(2)} = \\boldsymbol{0}$。\n\n“单值”的措辞意味着可以相对于为该边选择的单个法向量唯一定义牵引力。让我们为边 $E_d$ 定义一个参考法向量为 $\\boldsymbol{n}_{d} = \\boldsymbol{n}_{d}^{(2)} = \\frac{1}{\\sqrt{2}}(1,-1)$。唯一的牵引力向量 $\\boldsymbol{q}_d$ 随后被定义为应力作用于该法向量的结果，即 $\\boldsymbol{q}_d = \\hat{\\sigma}_{h,1}\\boldsymbol{n}_d = \\hat{\\sigma}_{h,2}\\boldsymbol{n}_d$。\n\n单元边界上的牵引力由 $\\hat{\\sigma}_h \\boldsymbol{n}_{\\text{outward}}$ 给出。\n对于单元 $K_2$，其对角线上的外向法向量为 $\\boldsymbol{n}_{d}^{(2)} = \\boldsymbol{n}_d$。因此，该边界上的牵引力为 $\\boldsymbol{q}_{E_d, 2} = \\hat{\\sigma}_{h,2}\\boldsymbol{n}_{d}^{(2)} = \\hat{\\sigma}_{h,2}\\boldsymbol{n}_d = \\boldsymbol{q}_d$。\n对于单元 $K_1$，其对角线上的外向法向量为 $\\boldsymbol{n}_{d}^{(1)} = -\\boldsymbol{n}_d$。因此，该边界上的牵引力为 $\\boldsymbol{q}_{E_d, 1} = \\hat{\\sigma}_{h,1}\\boldsymbol{n}_{d}^{(1)} = \\hat{\\sigma}_{h,1}(-\\boldsymbol{n}_d) = -(\\hat{\\sigma}_{h,1}\\boldsymbol{n}_d) = -\\boldsymbol{q}_d$。\n\n现在，我们可以对任一单元应用代数平衡方程来求解 $\\boldsymbol{q}_d$。\n\n让我们考虑单元 $K_{2}$（顶点为 $\\{(0,0),(0,1),(1,1)\\}$）。其边界由左边（$E_l$）、顶边（$E_t$）和对角线边（$E_d$）组成。\n各边的长度为 $|E_l|=1$、 $|E_t|=1$ 和 $|E_d|=\\sqrt{2}$。\n外部边上的牵引力由边界数据给出：\n- 在左边上： $\\boldsymbol{q}_{l} = \\boldsymbol{t} = (-T,0)$。\n- 在顶边上： $\\boldsymbol{q}_{t} = \\boldsymbol{t} = \\boldsymbol{0} = (0,0)$。\n如上所导，内部边 $E_d$ 上的牵引力为 $\\boldsymbol{q}_d$。\n\n$K_2$ 的平衡方程为：\n$$\n\\boldsymbol{q}_{l}|E_l| + \\boldsymbol{q}_{t}|E_t| + \\boldsymbol{q}_{d}|E_d| = \\boldsymbol{0}\n$$\n代入已知值：\n$$\n(-T,0) \\cdot 1 + (0,0) \\cdot 1 + \\boldsymbol{q}_{d} \\cdot \\sqrt{2} = \\boldsymbol{0}\n$$\n$$\n(-T,0) + \\sqrt{2}\\boldsymbol{q}_{d} = \\boldsymbol{0}\n$$\n求解 $\\boldsymbol{q}_{d}$：\n$$\n\\sqrt{2}\\boldsymbol{q}_{d} = (T,0)\n$$\n$$\n\\boldsymbol{q}_{d} = \\left(\\frac{T}{\\sqrt{2}}, 0\\right)\n$$\n\n为了验证我们解释的一致性，我们可以对单元 $K_1$（顶点为 $\\{(0,0),(1,0),(1,1)\\}$）进行相同的计算。其边界由底边（$E_b$）、右边（$E_r$）和对角线边（$E_d$）组成。\n长度为 $|E_b|=1$、 $|E_r|=1$ 和 $|E_d|=\\sqrt{2}$。\n外部边上的牵引力为：\n- 在底边上： $\\boldsymbol{q}_{b} = \\boldsymbol{t} = \\boldsymbol{0} = (0,0)$。\n- 在右边上： $\\boldsymbol{q}_{r} = \\boldsymbol{t} = (T,0)$。\n$K_1$ 在内部边 $E_d$ 上的牵引力为 $-\\boldsymbol{q}_d$。\n\n$K_1$ 的平衡方程为：\n$$\n\\boldsymbol{q}_{b}|E_b| + \\boldsymbol{q}_{r}|E_r| + (-\\boldsymbol{q}_{d})|E_d| = \\boldsymbol{0}\n$$\n代入已知值：\n$$\n(0,0) \\cdot 1 + (T,0) \\cdot 1 - \\boldsymbol{q}_{d}\\sqrt{2} = \\boldsymbol{0}\n$$\n$$\n(T,0) - \\sqrt{2}\\boldsymbol{q}_{d} = \\boldsymbol{0}\n$$\n求解 $\\boldsymbol{q}_{d}$：\n$$\n\\sqrt{2}\\boldsymbol{q}_{d} = (T,0)\n$$\n$$\n\\boldsymbol{q}_{d} = \\left(\\frac{T}{\\sqrt{2}}, 0\\right)\n$$\n两次计算都得到了相同的唯一向量 $\\boldsymbol{q}_d$，这证实了问题是适定的，并且我们的解释是正确的。与内部对角线边相关联的唯一常数向量是 $\\boldsymbol{q}_d = (\\frac{T}{\\sqrt{2}}, 0)$。此结果也可以通过首先求解分片常数应力张量 $\\hat{\\sigma}_{h,1}$ 和 $\\hat{\\sigma}_{h,2}$（两者均被求得为 $\\begin{pmatrix} T  0 \\\\ 0  0 \\end{pmatrix}$），然后计算牵引力 $\\hat{\\sigma}_h \\boldsymbol{n}_d$ 来证实。\n\n最终答案要求为行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{T}{\\sqrt{2}}  0\n\\end{pmatrix}\n}\n$$", "id": "3499358"}, {"introduction": "最后的这项实践将前面的概念整合到一个强大的、基于能量的误差估计框架中。您将推导并计算一个平衡误差估计器，该估计器在柔度范数（等效于应变能）下度量误差。这个问题不仅提供了计算力学的实践，还关键性地要求您解释为何在具有挑战性的近乎不可压缩极限下，该估计器表现更优越——这是岩土力学中常见且可能导致简单估计器失效的场景。[@problem_id:3499389]", "problem": "考虑一个二维空间中的准静态小应变线性弹性问题，该问题是针对在平面应变状态下的多孔地质材料，求解域为一个凸多边形域 $\\Omega \\subset \\mathbb{R}^{2}$，其边界为 $\\partial \\Omega$。设体力为 $\\boldsymbol{b} = \\boldsymbol{0}$，边界牵引力为 $\\boldsymbol{g}=\\boldsymbol{0}$。平衡方程的强形式为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$（在 $\\Omega$ 内）和 $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$（在 $\\partial \\Omega$ 上），其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{n}$ 是 $\\partial \\Omega$ 上的单位外法向量。本构关系为各向同性定律 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$，其中拉梅参数 $\\lambda  0$、$\\mu  0$，位移为 $\\boldsymbol{u}$，应变为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$，单位张量为 $\\boldsymbol{I}$，$\\operatorname{tr}(\\cdot)$ 表示迹。假设单位厚度。\n\n一种混合 $H(\\operatorname{div})$-相容的应力-位移列式可得到一个离散应力场 $\\boldsymbol{\\sigma}_{h}$，该应力场位于对称张量值 $H(\\operatorname{div})$ 空间中，同时在网格骨架上得到混合位移未知数。一个平衡后验估计器旨在寻求一个重建应力 $\\boldsymbol{\\sigma}^{\\star}$，该应力是静力允许的（在给定体力下逐单元无散度，且法向牵引力在界面上连续），并使用材料柔度来度量应力误差。\n\n从平衡定律和各向同性线性弹性的柔度算子出发，推导一个平衡后验误差估计器，该估计器：\n- 使用一个满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$ 在每个单元内成立，并且法向牵引力 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ 在内侧面上连续的应力重建 $\\boldsymbol{\\sigma}^{\\star}$，\n- 通过双点积 $\\boldsymbol{\\tau} : \\boldsymbol{\\eta} = \\sum_{i,j} \\tau_{ij} \\eta_{ij}$ 以柔度范数度量误差。\n\n然后，对于以下在方形域 $\\Omega = (0,1) \\times (0,1)$ 上的特定双三角形网格，该网格由从 $(0,0)$ 到 $(1,1)$ 的对角线划分（因此有两个面积为 $|K_{1}|=|K_{2}|=\\frac{1}{2}$ 的单元 $K_{1}$ 和 $K_{2}$），其离散应力场为\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6}  0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6}  0.2 \\times 10^{6}\n\\end{pmatrix},\n$$\n选择平衡重建 $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$（其满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$ 和 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}=\\boldsymbol{0}$）。假设拉梅参数为 $\\mu = 1.0 \\times 10^{8}$ 和 $\\lambda = 1.0 \\times 10^{10}$，并使用标准的弗罗贝尼乌斯双点积以及二维张量的偏量和体量部分分解。\n\n将平衡估计器的平方表示为\n$$\n\\eta^{2} = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x,\n$$\n其中 $\\boldsymbol{S}$ 是柔度张量。根据给定数据计算 $\\eta^{2}$ 的数值。将 $\\eta^{2}$ 的最终数值四舍五入至四位有效数字。以焦耳为单位表示最终结果。\n\n最后，根据您的推导，解释为何这种应力平衡估计器在不可压缩极限（大 $\\lambda$）下优于基于位移的残差估计器，并参考柔度如何分离偏量和体量贡献，以及法向牵引力连续性如何有助于鲁棒性。\n\n注：在所有迹和偏量分解中，使用 $n=2$（二维），即 $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，并使用适用于二维各向同性线性弹性的柔度映射 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。全程使用单位厚度。", "solution": "首先根据指定标准验证问题。\n\n**第1步：提取已知条件**\n- **问题：** 准静态小应变线性弹性，二维（$2$D）平面应变。\n- **域：** 凸多边形域 $\\Omega \\subset \\mathbb{R}^{2}$，边界为 $\\partial \\Omega$。\n- **载荷：** 体力 $\\boldsymbol{b} = \\boldsymbol{0}$，边界牵引力 $\\boldsymbol{g} = \\boldsymbol{0}$。\n- **平衡方程：** 在 $\\Omega$ 内 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$，在 $\\partial \\Omega$ 上 $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$。\n- **本构定律：** $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$，拉梅参数 $\\lambda  0, \\mu  0$。\n- **运动学：** $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$。\n- **估计器：** 以柔度范数度量应力误差的平衡后验估计器。\n- **重建应力：** $\\boldsymbol{\\sigma}^{\\star}$ 在每个单元内满足 $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$，且法向牵引力 $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ 在内侧面上连续。\n- **误差估计器公式：** $\\eta^{2} = \\sum_{K} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x$。\n- **特定几何：** 域 $\\Omega = (0,1) \\times (0,1)$，由从 $(0,0)$ 到 $(1,1)$ 的对角线划分为两个三角形 $K_{1}$ 和 $K_{2}$。面积 $|K_{1}|=|K_{2}|=\\frac{1}{2}$。\n- **离散应力场：**\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6}  0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6}  0.2 \\times 10^{6}\n\\end{pmatrix}\n$$\n- **特定重建应力：** $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$。\n- **材料参数：** $\\mu = 1.0 \\times 10^{8}$，$\\lambda = 1.0 \\times 10^{10}$。\n- **定义：** 维度 $n=2$，偏量分解 $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，柔度映射 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。单位厚度。\n- **任务：**\n  1. 计算 $\\eta^{2}$ 的数值，四舍五入至四位有效数字，以焦耳为单位。\n  2. 解释该估计器在不可压缩极限下的优点。\n\n**第2步：问题陈述的验证**\n该问题在科学上基于线性弹性理论和有限元方法的后验误差估计，这两个领域都是完善的学科。所有术语均根据连续介质力学和计算工程中的标准惯例定义。所提供的数据，包括材料属性和应力场，在内部是自洽的，在物理上是合理的。选择 $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$ 是一个有效虽然简单的平衡应力场，因为它满足 $\\nabla \\cdot \\boldsymbol{0} + \\boldsymbol{0} = \\boldsymbol{0}$ 并且法向牵引力为零，从而确保了连续性。该问题是适定的，为所需的计算和理论解释提供了所有必要的信息。它没有违反任何无效性标准。\n\n**第3步：结论与行动**\n问题被判定为有效。将提供完整的解决方案。\n\n**误差估计器被积函数的推导**\n误差估计器的平方由下式给出\n$$ \\eta^{2} = \\sum_{K} \\int_{K} (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) : \\boldsymbol{S} : (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) \\, \\mathrm{d}x $$\n令 $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}$。被积函数为 $\\boldsymbol{\\tau} : \\boldsymbol{S} : \\boldsymbol{\\tau}$。我们首先需要推导二维平面应变情况下的柔度张量 $\\boldsymbol{S}$，它是给定本构关系 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}$ 的逆。\n\n对二维本构方程取迹：\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}) = 2\\mu \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\operatorname{tr}(\\boldsymbol{I}) $$\n在二维中，$\\operatorname{tr}(\\boldsymbol{I}) = 1+1=2$。\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = (2\\mu + 2\\lambda) \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\implies \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) $$\n将此结果代回本构定律以求解 $\\boldsymbol{\\varepsilon}$：\n$$ \\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\left(\\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma})\\right) \\boldsymbol{I} $$\n$$ 2\\mu \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma} - \\frac{\\lambda}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2\\mu} \\boldsymbol{\\sigma} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\n该表达式定义了柔度张量 $\\boldsymbol{S}$ 的作用，即 $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$。\n\n为了简化被积函数，我们将应力张量 $\\boldsymbol{\\tau}$ 分解为其偏量部分和球量部分：$\\boldsymbol{\\tau} = \\operatorname{dev}(\\boldsymbol{\\tau}) + \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}$。\n应变能密度可以写为 $\\boldsymbol{\\tau} : \\boldsymbol{\\varepsilon} = \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau})$。让我们代入 $\\boldsymbol{\\varepsilon}$ 的表达式：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\boldsymbol{\\tau} : \\left( \\frac{1}{2\\mu} \\boldsymbol{\\tau} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\tau}) \\boldsymbol{I} \\right) = \\frac{1}{2\\mu} (\\boldsymbol{\\tau} : \\boldsymbol{\\tau}) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau})) (\\boldsymbol{\\tau} : \\boldsymbol{I}) $$\n由于 $\\boldsymbol{\\tau}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{\\tau})$，我们有：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} ||\\boldsymbol{\\tau}||_F^2 - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n其中 $||\\cdot||_F$ 是弗罗贝尼乌斯范数。我们可以用偏量和球量部分来表示它。回想 $||\\boldsymbol{\\tau}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + ||\\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2 (\\boldsymbol{I}:\\boldsymbol{I}) = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2$。\n将此代入能量密度的表达式中：\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} \\left(||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2\\right) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{1}{4\\mu} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{\\mu+\\lambda-\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n这是被积函数的最终形式。\n\n**$\\eta^2$ 的数值计算**\n给定 $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$，我们有 $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_h$。离散应力 $\\boldsymbol{\\sigma}_h$ 在每个单元 $K_1$ 和 $K_2$ 上是常数。因此，在单元 $K$ 上的积分等于被积函数的值乘以单元的面积 $|K|$。\n$$ \\eta^2 = \\sum_{K \\in \\{K_1, K_2\\}} |K| \\left[ \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_h|_K)||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_h|_K))^2 \\right] $$\n材料参数为 $\\mu = 1.0 \\times 10^8$ 和 $\\lambda = 1.0 \\times 10^{10}$。单元面积为 $|K_1|=|K_2|=\\frac{1}{2}$。\n因此，$2\\mu = 2.0 \\times 10^8$ 且 $4(\\mu+\\lambda) = 4(1.0 \\times 10^8 + 1.0 \\times 10^{10}) = 4(1.01 \\times 10^{10}) = 4.04 \\times 10^{10}$。\n\n对于单元 $K_1$：\n$\\boldsymbol{\\sigma}_1 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} = \\begin{pmatrix} 2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\ 1.0 \\times 10^{6}  0 \\end{pmatrix}$。\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_1) = (2.0 + 0) \\times 10^{6} = 2.0 \\times 10^{6}$。\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_1))^2 = (2.0 \\times 10^{6})^2 = 4.0 \\times 10^{12}$。\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_1) = \\boldsymbol{\\sigma}_1 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_1)\\boldsymbol{I} = \\begin{pmatrix} 2.0  1.0 \\\\ 1.0  0 \\end{pmatrix} \\times 10^6 - \\frac{1}{2}(2.0 \\times 10^6) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1.0  1.0 \\\\ 1.0  -1.0 \\end{pmatrix} \\times 10^6$。\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_1)||_F^2 = (1.0^2 + 1.0^2 + 1.0^2 + (-1.0)^2) \\times (10^6)^2 = 4.0 \\times 10^{12}$。\n来自 $K_1$ 的贡献，记为 $\\eta_1^2$，为：\n$$ \\eta_1^2 = \\frac{1}{2} \\left[ \\frac{4.0 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{4.0 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [2.0 \\times 10^4 + 0.990099 \\times 10^2] = \\frac{1}{2}[20000 + 99.0099] = 10049.505 $$\n\n对于单元 $K_2$：\n$\\boldsymbol{\\sigma}_2 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} = \\begin{pmatrix} 1.5 \\times 10^{6}  0.8 \\times 10^{6} \\\\ 0.8 \\times 10^{6}  0.2 \\times 10^{6} \\end{pmatrix}$。\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_2) = (1.5 + 0.2) \\times 10^{6} = 1.7 \\times 10^{6}$。\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_2))^2 = (1.7 \\times 10^6)^2 = 2.89 \\times 10^{12}$。\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_2) = \\boldsymbol{\\sigma}_2 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_2)\\boldsymbol{I} = \\begin{pmatrix} 1.5  0.8 \\\\ 0.8  0.2 \\end{pmatrix} \\times 10^{6} - \\frac{1}{2}(1.7 \\times 10^6) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.65  0.8 \\\\ 0.8  -0.65 \\end{pmatrix} \\times 10^6$。\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_2)||_F^2 = (0.65^2 + 0.8^2 + 0.8^2 + (-0.65)^2) \\times (10^6)^2 = (2 \\times 0.4225 + 2 \\times 0.64) \\times 10^{12} = 2.125 \\times 10^{12}$。\n来自 $K_2$ 的贡献，记为 $\\eta_2^2$，为：\n$$ \\eta_2^2 = \\frac{1}{2} \\left[ \\frac{2.125 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{2.89 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [1.0625 \\times 10^4 + 0.715346 \\times 10^2] = \\frac{1}{2}[10625 + 71.5346] = 5348.267 $$\n\n总的估计器平方值为：\n$$ \\eta^2 = \\eta_1^2 + \\eta_2^2 = 10049.505 + 5348.267 = 15397.772 $$\n单位是焦耳，因为能量密度（Pa）在体积（m$^3$，假设单位厚度为米）上的积分是能量（J）。\n四舍五入到四位有效数字，$\\eta^2 = 1.540 \\times 10^4$。\n\n**在不可压缩极限下优点的解释**\n在接近不可压缩的极限下，即当 $\\lambda \\to \\infty$ 时，基于平衡应力的后验误差估计器相对于标准的基于位移的残差估计器的优势变得至关重要。\n\n1.  **对不可压缩性的鲁棒性：**\n    推导出的误差度量表达式为 $\\eta^2 = \\sum_K \\int_K \\left( \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_{err}))^2 \\right) \\mathrm{d}x$，其中 $\\boldsymbol{\\sigma}_{err} = \\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$。当 $\\lambda \\to \\infty$ 时，体量（与压力相关）项的系数 $\\frac{1}{4(\\mu+\\lambda)}$ 趋于零。因此，估计器的值渐近地独立于体量应力误差：\n    $$ \\lim_{\\lambda\\to\\infty} \\eta^2 = \\sum_K \\int_K \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 \\, \\mathrm{d}x $$\n    这意味着估计器的值由应力误差的偏量（剪切）部分控制，该部分由剪切模量 $\\mu$ 进行缩放。当材料变得不可压缩时，该估计器不会“锁定”或性能下降。相比之下，标准的基于位移的残差估计器（通常涉及诸如 $||\\nabla \\cdot \\boldsymbol{\\sigma}_h||^2$ 的项）变得不可靠。在不可压缩极限下，$\\boldsymbol{\\sigma}_h$ 中的压力项（从位移计算）可能会表现出大的、非物理的振荡，导致残差成为实际位移误差的不良指标。\n\n2.  **关注平衡性：**\n    该估计器的核心是构建一个静力允许的应力场 $\\boldsymbol{\\sigma}^{\\star}$，该应力场满足逐点平衡（$\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} = -\\boldsymbol{b}$）以及跨单元面的法向牵引力连续性。真实的应力场 $\\boldsymbol{\\sigma}$ 也满足这些条件。数值应力 $\\boldsymbol{\\sigma}_h$（尤其是在混合或杂交方法中）被设计为在单元内部满足平衡，但通常在单元间界面上表现出法向牵引力的跳跃。因此，误差度量 $\\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$ 直接反映了这种单元间牵引力不连续的缺陷，而这是误差的主要来源。通过关注平衡性，该方法规避了与强制实施运动学约束 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$ 相关的数值困难，这些困难困扰着基于位移的列式及其在不可压缩极限下的相应估计器。平衡重建为误差测量提供了一个稳定、具有物理意义的参考，无论 $\\lambda$ 的值如何，它都保持有效。\n\n总而言之，将柔度分离为偏量和体量部分确保了估计器的量值不受锁定现象的污染，而要求应力重建满足平衡和牵引力连续性则提供了一种鲁棒的误差测量机制，使其在处理近不可压缩材料时优于基于位移的残差。", "answer": "$$\n\\boxed{1.540 \\times 10^{4}}\n$$", "id": "3499389"}]}