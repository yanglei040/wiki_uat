{"hands_on_practices": [{"introduction": "单元刚度矩阵是有限元模型的基本构建模块，它将节点力与节点位移联系起来。本练习将带您回归第一性原理，通过解析方法推导一维二次杆单元的刚度矩阵。通过构建形函数并进行精确积分，您将对单元物理特性如何被数学地公式化有一个具体的理解。[@problem_id:3529889]", "problem": "考虑一个在计算岩土力学中代表加筋单元的、直的、等截面的一维弹性杆单元。该杆单元具有恒定的杨氏模量 $E$ 和横截面积 $A$。该单元使用三节点二次等参格式建模，其自然坐标为 $\\xi \\in [-1, 1]$，节点位于 $\\xi = -1$、$\\xi = 0$ 和 $\\xi = 1$。设节点的物理坐标为 $x_1$、$x_2$ 和 $x_3$，且 $x_2 = \\frac{x_1 + x_3}{2}$，从而保证映射是直线的且雅可比为常数。用 $L = x_3 - x_1$ 表示单元长度。\n\n从最小势能原理和一维线性弹性的标准平衡弱形式出发，推导在 $[-1, 1]$ 上、节点位于 $-1$、0 和 $1$ 的二次拉格朗日插值形函数。然后，使用等参映射和精确解析积分（而非数值积分），组装在小应变下发生轴向变形的单元刚度矩阵，该矩阵表示为 $\\mathbf{K}_e$，其元素为 $K_{ij} = \\int A E \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$，其中 $N_i$ 是推导出的形函数，且 $i, j \\in \\{1, 2, 3\\}$。\n\n将最终的刚度矩阵 $\\mathbf{K}_e$ 表示为仅含 $E$、$A$ 和 $L$ 的单个闭式解析表达式。不要代入数值。最终表达式中不要求四舍五入，也不应提供单位。", "solution": "该问题经检验在科学上是合理的、适定的和客观的。这是有限元法中的一个标准推导，常应用于计算岩土力学和其他工程分析领域。所有必要信息均已提供，问题没有矛盾或歧义。\n\n一维弹性杆的单元刚度矩阵 $\\mathbf{K}_e$ 的推导始于势能泛函中的应变能项。对于杨氏模量为 $E$、横截面积为 $A$ 的杆，其应变能由 $U = \\frac{1}{2} \\int_V \\sigma \\epsilon \\, dV$ 给出，其中 $\\sigma$ 是轴向应力，$\\epsilon$ 是轴向应变。在小应变情况下，使用本构关系 $\\sigma = E\\epsilon$ 和运动学关系 $\\epsilon = \\frac{du}{dx}$（其中 $u(x)$ 是轴向位移），应变能变为 $U = \\frac{1}{2} \\int_L A E (\\frac{du}{dx})^2 \\, dx$。在有限元法中，单元内的位移场通过形函数 $N_i(x)$ 从节点位移 $u_i$ 插值得到：$u(x) = \\sum_{j} N_j(x) u_j$。那么应变为 $\\frac{du}{dx} = \\sum_{j} \\frac{dN_j}{dx} u_j$。将此式代入能量表达式，并对节点位移 $u_i$ 和 $u_j$ 求二阶偏导数，即可得到单元刚度矩阵的元素 $K_{ij} = \\frac{\\partial^2 U}{\\partial u_i \\partial u_j} = \\int_L A E \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$，这正是问题陈述中给出的表达式。推导过程分四步进行：推导形函数，计算坐标变换的雅可比，确定物理坐标系中的形函数导数，以及最后通过积分求出矩阵分量。\n\n**1. 推导二次拉格朗日形函数**\n该单元在自然坐标系中有三个节点，分别位于 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$。拉格朗日形函数 $N_i(\\xi)$ 是满足条件 $N_i(\\xi_j) = \\delta_{ij}$ 的二次多项式，其中 $\\delta_{ij}$ 是克罗内克δ。\n\n对于 $N_1(\\xi)$，我们要求 $N_1(-1) = 1$、$N_1(0) = 0$ 和 $N_1(1) = 0$。在 $\\xi=0$ 和 $\\xi=1$ 处的根意味着其形式为 $N_1(\\xi) = C(\\xi-0)(\\xi-1)$。条件 $N_1(-1)=1$ 给出 $1 = C(-1)(-1-1) = 2C$，因此 $C = 1/2$。\n$$ N_1(\\xi) = \\frac{1}{2}\\xi(\\xi-1) = \\frac{1}{2}(\\xi^2 - \\xi) $$\n\n对于 $N_2(\\xi)$，我们要求 $N_2(-1) = 0$、$N_2(0) = 1$ 和 $N_2(1) = 0$。在 $\\xi=-1$ 和 $\\xi=1$ 处的根意味着其形式为 $N_2(\\xi) = C(\\xi+1)(\\xi-1)$。条件 $N_2(0)=1$ 给出 $1 = C(1)(-1) = -C$，因此 $C = -1$。\n$$ N_2(\\xi) = -( \\xi^2 - 1 ) = 1 - \\xi^2 $$\n\n对于 $N_3(\\xi)$，我们要求 $N_3(-1) = 0$、$N_3(0) = 0$ 和 $N_3(1) = 1$。在 $\\xi=-1$ 和 $\\xi=0$ 处的根意味着其形式为 $N_3(\\xi) = C(\\xi+1)(\\xi)$。条件 $N_3(1)=1$ 给出 $1 = C(1+1)(1) = 2C$，因此 $C=1/2$。\n$$ N_3(\\xi) = \\frac{1}{2}\\xi(\\xi+1) = \\frac{1}{2}(\\xi^2 + \\xi) $$\n\n**2. 等参映射与雅可比**\n等参格式使用相同的形函数将自然坐标映射到物理坐标：\n$$ x(\\xi) = N_1(\\xi)x_1 + N_2(\\xi)x_2 + N_3(\\xi)x_3 $$\n给定中间节点居中的条件 $x_2 = \\frac{x_1 + x_3}{2}$，我们将其和形函数代入映射中：\n$$ x(\\xi) = \\frac{1}{2}(\\xi^2 - \\xi)x_1 + (1 - \\xi^2)\\left(\\frac{x_1 + x_3}{2}\\right) + \\frac{1}{2}(\\xi^2 + \\xi)x_3 $$\n$$ x(\\xi) = \\frac{1}{2} [ (\\xi^2 - \\xi)x_1 + (1 - \\xi^2)(x_1+x_3) + (\\xi^2 + \\xi)x_3 ] $$\n展开并合并 $x_1$ 和 $x_3$ 的项：\n$$ x(\\xi) = \\frac{1}{2} [ (\\xi^2 - \\xi + 1 - \\xi^2)x_1 + (1 - \\xi^2 + \\xi^2 + \\xi)x_3 ] $$\n$$ x(\\xi) = \\frac{1}{2} [ (1 - \\xi)x_1 + (1 + \\xi)x_3 ] = \\frac{x_1+x_3}{2} + \\frac{x_3-x_1}{2}\\xi $$\n变换的雅可比 $J$ 是 $x$ 对 $\\xi$ 的导数：\n$$ J = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{x_1+x_3}{2} + \\frac{x_3-x_1}{2}\\xi \\right) = \\frac{x_3-x_1}{2} $$\n给定单元长度为 $L = x_3 - x_1$，雅可比是一个常数：\n$$ J = \\frac{L}{2} $$\n\n**3. 形函数关于 $x$ 的导数**\n刚度矩阵需要形函数对物理坐标 $x$ 的导数。我们使用链式法则：$\\frac{dN_i}{dx} = \\frac{dN_i}{d\\xi} \\frac{d\\xi}{dx}$。因为 $\\frac{d\\xi}{dx} = \\frac{1}{J} = \\frac{2}{L}$，我们有 $\\frac{dN_i}{dx} = \\frac{2}{L} \\frac{dN_i}{d\\xi}$。\n首先，我们计算对 $\\xi$ 的导数：\n$$ \\frac{dN_1}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{1}{2}(\\xi^2 - \\xi) \\right) = \\xi - \\frac{1}{2} $$\n$$ \\frac{dN_2}{d\\xi} = \\frac{d}{d\\xi} \\left( 1 - \\xi^2 \\right) = -2\\xi $$\n$$ \\frac{dN_3}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{1}{2}(\\xi^2 + \\xi) \\right) = \\xi + \\frac{1}{2} $$\n\n**4. 单元刚度矩阵的组装**\n刚度矩阵的元素由 $K_{ij} = \\int_{x_1}^{x_3} A E \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$ 给出。我们将积分变换到自然坐标系，其中 $dx = J\\,d\\xi = \\frac{L}{2}\\,d\\xi$，积分限为从 $-1$ 到 $1$。\n$$ K_{ij} = \\int_{-1}^{1} A E \\left(\\frac{2}{L}\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{2}{L}\\frac{dN_j}{d\\xi}\\right) \\left(\\frac{L}{2}\\,d\\xi\\right) $$\n$$ K_{ij} = \\frac{2AE}{L} \\int_{-1}^{1} \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} \\, d\\xi $$\n我们计算所需的定积分。我们将使用标准结果：$\\int_{-1}^{1} d\\xi = 2$、$\\int_{-1}^{1} \\xi \\, d\\xi = 0$ 和 $\\int_{-1}^{1} \\xi^2 \\, d\\xi = \\frac{2}{3}$。\n\n$K_{11} = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi - \\frac{1}{2})^2 \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi^2 - \\xi + \\frac{1}{4}) \\, d\\xi = \\frac{2AE}{L} (\\frac{2}{3} - 0 + \\frac{1}{4}(2)) = \\frac{2AE}{L} (\\frac{2}{3} + \\frac{1}{2}) = \\frac{2AE}{L}(\\frac{7}{6}) = \\frac{7AE}{3L}$。\n\n$K_{22} = \\frac{2AE}{L} \\int_{-1}^{1} (-2\\xi)^2 \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} 4\\xi^2 \\, d\\xi = \\frac{2AE}{L} (4 \\cdot \\frac{2}{3}) = \\frac{16AE}{3L}$。\n\n$K_{33} = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi + \\frac{1}{2})^2 \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi^2 + \\xi + \\frac{1}{4}) \\, d\\xi = \\frac{2AE}{L} (\\frac{2}{3} + 0 + \\frac{1}{4}(2)) = \\frac{7AE}{3L}$。\n\n$K_{12} = K_{21} = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi - \\frac{1}{2})(-2\\xi) \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} (-2\\xi^2 + \\xi) \\, d\\xi = \\frac{2AE}{L} (-2 \\cdot \\frac{2}{3} + 0) = -\\frac{8AE}{3L}$。\n\n$K_{13} = K_{31} = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi - \\frac{1}{2})(\\xi + \\frac{1}{2}) \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} (\\xi^2 - \\frac{1}{4}) \\, d\\xi = \\frac{2AE}{L} (\\frac{2}{3} - \\frac{1}{4}(2)) = \\frac{2AE}{L} (\\frac{2}{3}-\\frac{1}{2}) = \\frac{2AE}{L} (\\frac{1}{6}) = \\frac{AE}{3L}$。\n\n$K_{23} = K_{32} = \\frac{2AE}{L} \\int_{-1}^{1} (-2\\xi)(\\xi + \\frac{1}{2}) \\, d\\xi = \\frac{2AE}{L} \\int_{-1}^{1} (-2\\xi^2 - \\xi) \\, d\\xi = \\frac{2AE}{L} (-2 \\cdot \\frac{2}{3} - 0) = -\\frac{8AE}{3L}$。\n\n将这些分量组装成矩阵 $\\mathbf{K}_e$：\n$$ \\mathbf{K}_e = \\begin{pmatrix} K_{11} & K_{12} & K_{13} \\\\ K_{21} & K_{22} & K_{23} \\\\ K_{31} & K_{32} & K_{33} \\end{pmatrix} = \\begin{pmatrix} \\frac{7AE}{3L} & -\\frac{8AE}{3L} & \\frac{AE}{3L} \\\\ -\\frac{8AE}{3L} & \\frac{16AE}{3L} & -\\frac{8AE}{3L} \\\\ \\frac{AE}{3L} & -\\frac{8AE}{3L} & \\frac{7AE}{3L} \\end{pmatrix} $$\n提出公因子 $\\frac{AE}{3L}$，得到单元刚度矩阵的最终表达式。\n$$ \\mathbf{K}_e = \\frac{AE}{3L} \\begin{pmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{pmatrix} $$\n对该矩阵的检验确认了其对称性，并且每行元素之和为零，这满足了物理一致性的要求（代表单元对刚体运动的响应）。", "answer": "$$\n\\boxed{\\frac{AE}{3L} \\begin{pmatrix} 7  & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{pmatrix}}\n$$", "id": "3529889"}, {"introduction": "高阶单元的一个主要优势是它们能够捕捉复杂的变形模式。本练习将进入二维空间，探讨二次三角形单元如何表示非恒定应变场。您将推导核心的应变-位移（$B$）矩阵并用其计算应变，从而直接观察这些单元能够模拟的线性应变变化。[@problem_id:3529872]", "problem": "在小应变、平面应变条件下，考虑一个用于计算岩土力学的二维六节点二次三角形有限元，该单元在有限元法（FEM）的框架下使用。此单元使用满足 $L_{1}+L_{2}+L_{3}=1$ 的面积（重心）坐标 $L_{1}$、$L_{2}$ 和 $L_{3}$。标准的二次形函数为\n$$\nN_{1} = L_{1}(2L_{1}-1), \\quad\nN_{2} = L_{2}(2L_{2}-1), \\quad\nN_{3} = L_{3}(2L_{3}-1),\n$$\n$$\nN_{4} = 4 L_{1} L_{2}, \\quad\nN_{5} = 4 L_{2} L_{3}, \\quad\nN_{6} = 4 L_{3} L_{1}.\n$$\n小应变张量分量定义为\n$$\n\\varepsilon_{x} = \\frac{\\partial u_{x}}{\\partial x}, \\quad\n\\varepsilon_{y} = \\frac{\\partial u_{y}}{\\partial y}, \\quad\n\\gamma_{xy} = \\frac{\\partial u_{x}}{\\partial y} + \\frac{\\partial u_{y}}{\\partial x},\n$$\n其中 $(u_{x},u_{y})$ 是位移分量。\n\n1. 推导该单元的应变-位移矩阵（$B$-矩阵），其形式如下\n$$\n\\begin{pmatrix}\n\\varepsilon_{x} \\\\\n\\varepsilon_{y} \\\\\n\\gamma_{xy}\n\\end{pmatrix}\n=\nB\n\\begin{pmatrix}\nu_{1x} \\\\ u_{1y} \\\\ u_{2x} \\\\ u_{2y} \\\\ u_{3x} \\\\ u_{3y} \\\\ u_{4x} \\\\ u_{4y} \\\\ u_{5x} \\\\ u_{5y} \\\\ u_{6x} \\\\ u_{6y}\n\\end{pmatrix},\n$$\n将 $B$ 显式地用形函数关于 $x$ 和 $y$ 的导数、面积坐标 $L_{1}$、$L_{2}$、$L_{3}$ 及其空间导数表示。\n\n2. 考虑一个具有以下顶点坐标的特定直边三角形\n$$\n\\mathbf{x}_{1}=(0,0), \\quad \\mathbf{x}_{2}=(1,0), \\quad \\mathbf{x}_{3}=(0,1),\n$$\n和边中点节点\n$$\n\\mathbf{x}_{4}=\\frac{\\mathbf{x}_{1}+\\mathbf{x}_{2}}{2}=(0.5,0), \\quad\n\\mathbf{x}_{5}=\\frac{\\mathbf{x}_{2}+\\mathbf{x}_{3}}{2}=(0.5,0.5), \\quad\n\\mathbf{x}_{6}=\\frac{\\mathbf{x}_{3}+\\mathbf{x}_{1}}{2}=(0,0.5).\n$$\n使用此三角形的线性面积坐标，\n$$\nL_{1} = 1 - x - y, \\quad L_{2} = x, \\quad L_{3} = y,\n$$\n及其恒定的空间导数，\n$$\n\\frac{\\partial L_{1}}{\\partial x} = -1, \\quad \\frac{\\partial L_{1}}{\\partial y} = -1, \\quad\n\\frac{\\partial L_{2}}{\\partial x} = 1, \\quad \\frac{\\partial L_{2}}{\\partial y} = 0, \\quad\n\\frac{\\partial L_{3}}{\\partial x} = 0, \\quad \\frac{\\partial L_{3}}{\\partial y} = 1,\n$$\n计算在单元形心 $(x,y)=(\\tfrac{1}{3},\\tfrac{1}{3})$ 处的 $B$-矩阵。\n\n3. 对于以下节点位移集（单位一致，使得应变为无量纲），\n$$\nu_{1x}=0, \\quad u_{1y}=0, \\quad\nu_{2x}=0.02, \\quad u_{2y}=0, \\quad\nu_{3x}=0, \\quad u_{3y}=0.03, \\quad\nu_{4x}=0.01, \\quad u_{4y}=0, \\quad\nu_{5x}=0.015, \\quad u_{5y}=0.015, \\quad\nu_{6x}=-0.005, \\quad u_{6y}=0.01,\n$$\n计算在单元面积上平均的面内膨胀（面内小应变张量的迹）。根据形函数导数的形式，评述单元内部应变的空间变化。\n\n将最终的平均面内膨胀表示为一个十进制数，四舍五入到四位有效数字。最终数值不需要单位。", "solution": "该问题被评估为有效，因为它科学地基于有限元法的原理，提法良好，具有唯一且有意义的解，并且陈述客观。所有必要的数据均已提供且内部一致。我们将按逻辑顺序处理这三个部分，进行求解。\n\n### 第一部分：应变-位移矩阵（$B$-矩阵）的推导\n\n单元内的位移场 $(u_x, u_y)$ 是通过使用单元的形函数 $N_i$ 从节点位移插值得到的：\n$$\nu_x(L_1, L_2, L_3) = \\sum_{i=1}^{6} N_i(L_1, L_2, L_3) u_{ix}\n$$\n$$\nu_y(L_1, L_2, L_3) = \\sum_{i=1}^{6} N_i(L_1, L_2, L_3) u_{iy}\n$$\n其中 $(u_{ix}, u_{iy})$ 是节点 $i$ 处的位移分量。\n\n小应变张量分量是通过对位移场关于笛卡尔坐标 $(x, y)$ 求导得到的。使用链式法则，我们有：\n$$\n\\varepsilon_x = \\frac{\\partial u_x}{\\partial x} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial x} u_{ix}\n$$\n$$\n\\varepsilon_y = \\frac{\\partial u_y}{\\partial y} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial y} u_{iy}\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\sum_{i=1}^{6} \\left( \\frac{\\partial N_i}{\\partial y} u_{ix} + \\frac{\\partial N_i}{\\partial x} u_{iy} \\right)\n$$\n\n这些方程可以表示为矩阵形式 $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$，其中 $\\boldsymbol{\\varepsilon} = (\\varepsilon_x, \\varepsilon_y, \\gamma_{xy})^T$ 是应变向量，$\\mathbf{d} = (u_{1x}, u_{1y}, \\dots, u_{6x}, u_{6y})^T$ 是节点位移向量。应变-位移矩阵 $B$ 是一个 $3 \\times 12$ 的矩阵，由六个 $3 \\times 2$ 的子矩阵 $B_i$ 组成：\n$$\nB = [B_1, B_2, B_3, B_4, B_5, B_6]\n$$\n其中节点 $i$ 的子矩阵由下式给出：\n$$\nB_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\n形函数的空间导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 是使用链式法则求得的，因为形函数 $N_i$ 是面积坐标 $L_k$ 的函数，而面积坐标又是 $(x, y)$ 的函数：\n$$\n\\frac{\\partial N_i}{\\partial x} = \\sum_{k=1}^{3} \\frac{\\partial N_i}{\\partial L_k} \\frac{\\partial L_k}{\\partial x}\n\\quad \\text{和} \\quad\n\\frac{\\partial N_i}{\\partial y} = \\sum_{k=1}^{3} \\frac{\\partial N_i}{\\partial L_k} \\frac{\\partial L_k}{\\partial y}\n$$\n首先，我们求出形函数关于面积坐标的导数：\n$$\n\\frac{\\partial N_1}{\\partial L_1} = 4L_1-1, \\quad \\frac{\\partial N_2}{\\partial L_2} = 4L_2-1, \\quad \\frac{\\partial N_3}{\\partial L_3} = 4L_3-1\n$$\n$$\n\\frac{\\partial N_4}{\\partial L_1} = 4L_2, \\quad \\frac{\\partial N_4}{\\partial L_2} = 4L_1\n$$\n$$\n\\frac{\\partial N_5}{\\partial L_2} = 4L_3, \\quad \\frac{\\partial N_5}{\\partial L_3} = 4L_2\n$$\n$$\n\\frac{\\partial N_6}{\\partial L_3} = 4L_1, \\quad \\frac{\\partial N_6}{\\partial L_1} = 4L_3\n$$\n所有其他的 $\\frac{\\partial N_i}{\\partial L_k}$ 均为零。将这些代入链式法则表达式即可得到 $B$ 矩阵的分量。例如，对于节点 $i=1$：\n$$ \\frac{\\partial N_1}{\\partial x} = (4L_1-1) \\frac{\\partial L_1}{\\partial x}, \\quad \\frac{\\partial N_1}{\\partial y} = (4L_1-1) \\frac{\\partial L_1}{\\partial y} $$\n对于节点 $i=4$：\n$$ \\frac{\\partial N_4}{\\partial x} = 4L_2 \\frac{\\partial L_1}{\\partial x} + 4L_1 \\frac{\\partial L_2}{\\partial x}, \\quad \\frac{\\partial N_4}{\\partial y} = 4L_2 \\frac{\\partial L_1}{\\partial y} + 4L_1 \\frac{\\partial L_2}{\\partial y} $$\n其他节点的表达式可类似推得。这就完成了第一部分所要求的 $B$-矩阵的正式推导。\n\n### 关于应变变化的评述\n\n对于直边三角形，面积坐标 $L_k$ 是笛卡尔坐标 $(x,y)$ 的线性函数。形函数关于面积坐标的导数 $\\frac{\\partial N_i}{\\partial L_k}$ 是 $L_k$ 的线性函数。面积坐标的空间导数 $\\frac{\\partial L_k}{\\partial x}$ 和 $\\frac{\\partial L_k}{\\partial y}$ 是常数。因此，形函数的空间导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 是 $(x,y)$ 的线性函数。由于应变分量 $\\varepsilon_x, \\varepsilon_y, \\gamma_{xy}$ 是这些导数的线性组合，因此在二次三角形单元内，应变场在整个单元上呈线性变化。\n\n### 第二部分与第三部分：平均膨胀的计算\n\n面内膨胀是面内应变张量的迹，即 $\\varepsilon_v = \\varepsilon_x + \\varepsilon_y$。在单元面积 $A$ 上的平均膨胀由下式给出：\n$$\n\\bar{\\varepsilon}_v = \\frac{1}{A} \\int_A \\varepsilon_v(x,y) \\,dA = \\frac{1}{A} \\int_A (\\varepsilon_x(x,y) + \\varepsilon_y(x,y)) \\,dA\n$$\n如上所述，应变场是 $(x,y)$ 的线性函数。在三角形上积分的一个基本性质是，线性函数的平均值等于其在单元形心处的值。形心对应于面积坐标 $(L_1, L_2, L_3) = (\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3})$。因此，我们可以通过计算形心处的应变来计算平均膨胀：\n$$\n\\bar{\\varepsilon}_v = \\varepsilon_x(x_c, y_c) + \\varepsilon_y(x_c, y_c)\n$$\n其中 $(x_c, y_c) = (\\tfrac{1}{3}, \\tfrac{1}{3})$ 是指定单元的形心。\n\n我们首先使用给定的面积坐标的常数导数来计算形心处形函数的空间导数：\n$\\frac{\\partial L_1}{\\partial x} = -1$, $\\frac{\\partial L_1}{\\partial y} = -1$, $\\frac{\\partial L_2}{\\partial x} = 1$, $\\frac{\\partial L_2}{\\partial y} = 0$, $\\frac{\\partial L_3}{\\partial x} = 0$, $\\frac{\\partial L_3}{\\partial y} = 1$.\n在形心处，$L_1=L_2=L_3=\\tfrac{1}{3}$。\n\n对于 $i=1$: $\\frac{\\partial N_1}{\\partial x}|_c = (4(\\tfrac{1}{3})-1)(-1) = -\\frac{1}{3}$, $\\frac{\\partial N_1}{\\partial y}|_c = (4(\\tfrac{1}{3})-1)(-1) = -\\frac{1}{3}$。\n对于 $i=2$: $\\frac{\\partial N_2}{\\partial x}|_c = (4(\\tfrac{1}{3})-1)(1) = \\frac{1}{3}$, $\\frac{\\partial N_2}{\\partial y}|_c = (4(\\tfrac{1}{3})-1)(0) = 0$。\n对于 $i=3$: $\\frac{\\partial N_3}{\\partial x}|_c = (4(\\tfrac{1}{3})-1)(0) = 0$, $\\frac{\\partial N_3}{\\partial y}|_c = (4(\\tfrac{1}{3})-1)(1) = \\frac{1}{3}$。\n对于 $i=4$: $\\frac{\\partial N_4}{\\partial x}|_c = 4(\\tfrac{1}{3})(-1) + 4(\\tfrac{1}{3})(1) = 0$, $\\frac{\\partial N_4}{\\partial y}|_c = 4(\\tfrac{1}{3})(-1) + 4(\\tfrac{1}{3})(0) = -\\frac{4}{3}$。\n对于 $i=5$: $\\frac{\\partial N_5}{\\partial x}|_c = 4(\\tfrac{1}{3})(1) + 4(\\tfrac{1}{3})(0) = \\frac{4}{3}$, $\\frac{\\partial N_5}{\\partial y}|_c = 4(\\tfrac{1}{3})(0) + 4(\\tfrac{1}{3})(1) = \\frac{4}{3}$。\n对于 $i=6$: $\\frac{\\partial N_6}{\\partial x}|_c = 4(\\tfrac{1}{3})(-1) + 4(\\tfrac{1}{3})(0) = -\\frac{4}{3}$, $\\frac{\\partial N_6}{\\partial y}|_c = 4(\\tfrac{1}{3})(-1) + 4(\\tfrac{1}{3})(1) = 0$。\n\n现在，我们使用给定的节点位移计算平均应变 $\\bar{\\varepsilon}_x$ 和 $\\bar{\\varepsilon}_y$：\n$\\mathbf{u}_x = \\{0, 0.02, 0, 0.01, 0.015, -0.005\\}$\n$\\mathbf{u}_y = \\{0, 0, 0.03, 0, 0.015, 0.01\\}$\n\n$$\n\\bar{\\varepsilon}_x = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial x}|_c u_{ix} = (-\\tfrac{1}{3})(0) + (\\tfrac{1}{3})(0.02) + (0)(0) + (0)(0.01) + (\\tfrac{4}{3})(0.015) + (-\\tfrac{4}{3})(-0.005)\n$$\n$$\n\\bar{\\varepsilon}_x = \\frac{1}{3} (0.02 + 4(0.015) + 4(0.005)) = \\frac{1}{3} (0.02 + 0.06 + 0.02) = \\frac{0.1}{3}\n$$\n$$\n\\bar{\\varepsilon}_y = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial y}|_c u_{iy} = (-\\tfrac{1}{3})(0) + (0)(0) + (\\tfrac{1}{3})(0.03) + (-\\tfrac{4}{3})(0) + (\\tfrac{4}{3})(0.015) + (0)(0.01)\n$$\n$$\n\\bar{\\varepsilon}_y = \\frac{1}{3} (0.03 + 4(0.015)) = \\frac{1}{3} (0.03 + 0.06) = \\frac{0.09}{3}\n$$\n平均面内膨胀是这两个值的和：\n$$\n\\bar{\\varepsilon}_v = \\bar{\\varepsilon}_x + \\bar{\\varepsilon}_y = \\frac{0.1}{3} + \\frac{0.09}{3} = \\frac{0.19}{3} \\approx 0.063333...\n$$\n四舍五入到四位有效数字，我们得到 $0.06333$。", "answer": "$$\\boxed{0.06333}$$", "id": "3529872"}, {"introduction": "我们如何确定我们的有限元代码是正确的？“斑块检验”（Patch Test）是验证单元公式和实现正确性的基本数值程序。在这个计算练习中，您将设计并运行一个斑块检验，以验证一个二次 serendipity 单元能够精确再现哪些多项式位移场，从而揭示单元完备性与几何映射之间的深层联系。[@problem_id:3529897]", "problem": "考虑平面应变运动学下的二次 serendipity 四边形单元（通常称为 $Q8$ 单元）。您需要设计一个计算性 patch test，用以检验两类位移场：常应变（仿射）场和产生线性变化应变的弯曲类场。其目的是通过算法确定，对于单个等参二次 serendipity 单元，哪些多项式位移场可以被精确再现，这取决于单元的几何映射。\n\n从以下基本概念出发：平面问题的小应变运动学、有限元的等参插值范式，以及在自然坐标系下双单位正方形上的二次 serendipity 形函数的定义。具体而言，令 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 表示自然坐标。令 $N_i(\\xi,\\eta)$，$i=1,\\dots,8$，表示双单位正方形上的标准二次 serendipity 形函数，节点排序方式为先逆时针排列四个角点，然后是中边节点：\n- 节点 $1$：$(\\xi,\\eta)=(-1,-1)$，\n- 节点 $2$：$(\\xi,\\eta)=(+1,-1)$，\n- 节点 $3$：$(\\xi,\\eta)=(+1,+1)$，\n- 节点 $4$：$(\\xi,\\eta)=(-1,+1)$，\n- 节点 $5$：$(\\xi,\\eta)=(0,-1)$，\n- 节点 $6$：$(\\xi,\\eta)=(+1,0)$，\n- 节点 $7$：$(\\xi,\\eta)=(0,+1)$，\n- 节点 $8$：$(\\xi,\\eta)=(-1,0)$。\n\n使用等参映射到物理坐标 $(x,y)$，通过 $x(\\xi,\\eta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,x_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,y_i$ 实现，其中 $(x_i,y_i)$ 是物理节点坐标。位移插值为 $u_h(\\xi,\\eta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,u_i$ 和 $v_h(\\xi,\\eta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,v_i$，其中 $(u_i,v_i)$ 是节点位移。对于任意给定的精确场 $(u(x,y),v(x,y))$，通过在物理节点位置 $(x_i,y_i)$ 对精确场进行采样来定义节点值。\n\n设计一个程序，对于单个单元，如果在一个指定的单元内部采样点集合上的最大绝对插值误差低于容差 $\\varepsilon$，则将多项式位移场 $(u(x,y),v(x,y))$ 分类为被精确再现，即如果\n$$\n\\max_{(\\xi,\\eta)\\in\\mathcal{S}} \\left\\{ \\left| u_h(\\xi,\\eta) - u(x(\\xi,\\eta),y(\\xi,\\eta)) \\right|, \\left| v_h(\\xi,\\eta) - v(x(\\xi,\\eta),y(\\xi,\\eta)) \\right| \\right\\} \\le \\varepsilon.\n$$\n使用以下容差和采样设置：\n- 容差 $\\varepsilon = 10^{-10}$。\n- $(\\xi,\\eta)$ 空间中一个由 $n_s\\times n_s$ 个等距采样点组成的张量积集合 $\\mathcal{S}$，其中 $n_s=7$ 个值在 $[-1,1]$ 内均匀分布。\n\n定义三种单元几何形状（坐标顺序如上所述），选择它们以检验不同的映射类型：\n- 几何形状 $\\mathcal{G}_1$（未变形正方形；恒等映射）：\n  - 角点：$(-1,-1)$, $(+1,-1)$, $(+1,+1)$, $(-1,+1)$,\n  - 中边点：$(0,-1)$, $(+1,0)$, $(0,+1)$, $(-1,0)$。\n- 几何形状 $\\mathcal{G}_2$（仿射平行四边形）：\n  - 角点：$(0,0)$, $(2,0)$, $(3,1)$, $(1,1)$,\n  - 中边点：物理空间中相邻角点的中点。\n- 几何形状 $\\mathcal{G}_3$（扭曲双线性四边形）：\n  - 角点：$(0,0)$, $(2,0.2)$, $(2.2,1.1)$, $(-0.1,0.9)$,\n  - 中边点：物理空间中相邻角点的中点。\n\n定义以下多项式位移场集合，旨在测试常应变和弯曲类行为。每个场由 $(u(x,y),v(x,y))$ 指定：\n- 常数和线性场（常应变类）：\n  - $\\mathcal{F}_1$: $(1,0)$,\n  - $\\mathcal{F}_2$: $(x,0)$,\n  - $\\mathcal{F}_3$: $(y,0)$,\n  - $\\mathcal{F}_4$: $(0,1)$,\n  - $\\mathcal{F}_5$: $(0,x)$,\n  - $\\mathcal{F}_6$: $(0,y)$。\n- 二次场（弯曲类，具有线性变化的应变）：\n  - $\\mathcal{F}_7$: $(x^2,0)$,\n  - $\\mathcal{F}_8$: $(xy,0)$,\n  - $\\mathcal{F}_9$: $(y^2,0)$,\n  - $\\mathcal{F}_{10}$: $(0,x^2)$,\n  - $\\mathcal{F}_{11}$: $(0,xy)$,\n  - $\\mathcal{F}_{12}$: $(0,y^2)$。\n- 三次场（超出二次完备性，用于反面对照）：\n  - $\\mathcal{F}_{13}$: $(x^2 y,0)$,\n  - $\\mathcal{F}_{14}$: $(0, x y^2)$。\n\n对于每种几何形状 $\\mathcal{G}_k$，$k\\in\\{1,2,3\\}$，以及每个场 $\\mathcal{F}_j$，$j\\in\\{1,\\dots,14\\}$，根据上述误差准则确定该场是否被精确再现。您的程序必须实现：\n- 显式的二次 serendipity 形函数 $N_i(\\xi,\\eta)$。\n- 使用这些形函数和给定的节点坐标进行等参映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$。\n- 通过在物理节点位置对精确场进行采样来分配节点值。\n- 在 $\\mathcal{S}$ 上进行误差评估，并使用容差 $\\varepsilon$ 进行布尔分类。\n\n测试套件和输出规范：\n- 完全按照定义使用几何形状 $\\mathcal{G}_1$、$\\mathcal{G}_2$ 和 $\\mathcal{G}_3$。\n- 完全按照定义使用场 $\\mathcal{F}_1$ 到 $\\mathcal{F}_{14}$。\n- 设置 $n_s=7$ 和 $\\varepsilon=10^{-10}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按以下顺序包含 $42$ 个布尔值：按 $\\mathcal{G}_1$、$\\mathcal{G}_2$、$\\mathcal{G}_3$ 的顺序遍历几何形状；对于每种几何形状，按 $\\mathcal{F}_1,\\mathcal{F}_2,\\dots,\\mathcal{F}_{14}$ 的顺序遍历场。即，输出格式为\n$$\n[\\text{G1F1},\\text{G1F2},\\dots,\\text{G1F14},\\text{G2F1},\\dots,\\text{G2F14},\\text{G3F1},\\dots,\\text{G3F14}],\n$$\n其中，每个条目（如 $\\text{G1F7}$）是几何形状 $\\mathcal{G}_1$ 和场 $\\mathcal{F}_7$ 的布尔结果。", "solution": "问题陈述已经过严格验证，被确定为计算力学中一个适定、有科学依据且计算上可行的练习。所有必要的数据、定义和条件均已提供，不存在内部矛盾或违反基本原则的情况。任务是为单个二次 serendipity（$Q8$）有限元执行一个计算性 patch test，以确定其在不同单元几何形状下精确再现一组多项式位移场的能力。这检验了等参映射和单元完备性的核心概念。\n\n解决方案通过计算实现 patch test。总体过程包括遍历每种指定的单元几何形状，并对每种几何形状，遍历每个指定的位移场。对于每一对几何形状和场，我们确定有限元插值是否在给定的数值容差内精确再现该场。\n\n仿真的基本组成部分是：\n1.  **$Q8$ 单元形函数**：单元的行为由其形函数 $N_i(\\xi, \\eta)$ 决定，这些函数定义在父域上，即一个双单位正方形，其中 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$。八个形函数对应四个角点和四个中边节点。对于问题中指定的节点排序（角点 1-4 从 $(-1,-1)$ 开始逆时针排序，然后中边节点 5-8 从节点 1 和 2 之间的边开始逆时针排序），形函数为：\n    \n    对于自然坐标为 $(\\xi_i, \\eta_i)$ 的角点 $i \\in \\{1, 2, 3, 4\\}$：\n    $$ N_i(\\xi, \\eta) = \\frac{1}{4} (1 + \\xi\\xi_i) (1 + \\eta\\eta_i) (\\xi\\xi_i + \\eta\\eta_i - 1) $$\n    对于水平边上的中边节点 $i \\in \\{5, 7\\}$（其中 $\\xi_i = 0, \\eta_i = \\pm 1$）：\n    $$ N_i(\\xi, \\eta) = \\frac{1}{2} (1 - \\xi^2) (1 + \\eta\\eta_i) $$\n    对于垂直边上的中边节点 $i \\in \\{6, 8\\}$（其中 $\\eta_i = 0, \\xi_i = \\pm 1$）：\n    $$ N_i(\\xi, \\eta) = \\frac{1}{2} (1 + \\xi\\xi_i) (1 - \\eta^2) $$\n    这些函数构成一个基，它张成了多项式空间 $\\{1, \\xi, \\eta, \\xi^2, \\eta^2, \\xi\\eta, \\xi^2\\eta, \\xi\\eta^2\\}$。\n\n2.  **等参映射**：单元内任意点的物理坐标 $(x, y)$ 是使用相同的形函数从节点物理坐标 $(x_i, y_i)$ 插值得到的：\n    $$ x(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) x_i \\quad \\text{和} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) y_i $$\n    三种指定的几何形状（$\\mathcal{G}_1$：正方形，$\\mathcal{G}_2$：平行四边形，$\\mathcal{G}_3$：扭曲四边形）由它们的八个节点坐标定义。对于 $\\mathcal{G}_2$ 和 $\\mathcal{G}_3$，中边节点被明确定义为其相邻角点的物理中点。\n\n3.  **位移场插值**：类似地，插值位移场 $(u_h, v_h)$ 是从节点位移 $(u_i, v_i)$ 计算得出的：\n    $$ u_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_i \\quad \\text{和} \\quad v_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) v_i $$\n\n4.  **Patch Test 逻辑**：对于给定的几何形状 $\\mathcal{G}_k$ 和精确位移场 $\\mathcal{F}_j = (u(x,y), v(x,y))$，测试按以下步骤执行：\n    a. 建立几何形状 $\\mathcal{G}_k$ 的 8 个节点的物理坐标 $(x_i, y_i)$。\n    b. 通过在节点坐标处计算精确场来计算节点位移 $(u_i, v_i)$：$u_i = u(x_i, y_i)$ 和 $v_i = v(x_i, y_i)$。\n    c. 在父域 $(\\xi, \\eta)$ 中创建一个 $n_s \\times n_s$ 的采样点网格（其中 $n_s = 7$）。\n    d. 对于网格中的每个采样点 $(\\xi_s, \\eta_s)$：\n        i. 计算形函数 $N_i(\\xi_s, \\eta_s)$。\n        ii. 使用等参映射计算与 $(\\xi_s, \\eta_s)$ 对应的物理坐标 $(x_s, y_s)$。\n        iii. 通过在 $(x_s, y_s)$ 处计算场函数来计算精确位移 $(u_{exact}, v_{exact})$。\n        iv. 使用形函数和步骤 (b) 中的节点位移计算插值位移 $(u_h, v_h)$。\n        v. 计算每个分量的绝对误差：$|u_h - u_{exact}|$ 和 $|v_h - v_{exact}|$。\n    e. 将在所有采样点和两个位移分量中找到的最大误差与容差 $\\varepsilon = 10^{-10}$ 进行比较。如果最大误差小于或等于 $\\varepsilon$，则该场被分类为精确再现 (True)；否则，不被精确再现 (False)。\n\n对所有 3 种几何形状和 14 个场系统地重复此过程，生成一个包含 42 个布尔值结果的列表。根据有限元理论，我们期望所有等参单元都能精确再现常数和线性位移场（$\\mathcal{F}_1$ 到 $\\mathcal{F}_6$）。对于具有仿射映射的单元（几何形状 $\\mathcal{G}_1$ 和 $\\mathcal{G}_2$），所有包含在单元形函数基中的多项式场也应该被再现。扭曲单元 ($\\mathcal{G}_3$) 具有非仿射映射，预计对于非线性场将无法再现。特定的三次场（$\\mathcal{F}_{13}$、$\\mathcal{F}_{14}$）只有在它们恰好能精确映射到基函数 $\\xi^2\\eta$ 和 $\\xi\\eta^2$ 上时才能被再现，而这仅对 $\\mathcal{G}_1$ 的恒等映射成立。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a computational patch test for a Q8 serendipity element.\n    \"\"\"\n    # Define problem parameters\n    epsilon = 1e-10\n    ns = 7\n\n    def get_shape_functions(xi, eta):\n        \"\"\"\n        Calculates the Q8 serendipity shape functions at a point (xi, eta).\n        Node ordering: 1-4 corners CCW, 5-8 midsides CCW.\n        Array indices 0-7 correspond to nodes 1-8.\n        \"\"\"\n        N = np.zeros(8)\n        \n        # Corner nodes (i=0..3 for nodes 1..4)\n        N[0] = 0.25 * (1 - xi) * (1 - eta) * (-xi - eta - 1)  # Node 1 (-1, -1)\n        N[1] = 0.25 * (1 + xi) * (1 - eta) * (xi - eta - 1)   # Node 2 (1, -1)\n        N[2] = 0.25 * (1 + xi) * (1 + eta) * (xi + eta - 1)   # Node 3 (1, 1)\n        N[3] = 0.25 * (1 - xi) * (1 + eta) * (-xi + eta - 1)  # Node 4 (-1, 1)\n        \n        # Midside nodes (i=4..7 for nodes 5..8)\n        N[4] = 0.5 * (1 - xi**2) * (1 - eta)                    # Node 5 (0, -1)\n        N[5] = 0.5 * (1 + xi) * (1 - eta**2)                   # Node 6 (1, 0)\n        N[6] = 0.5 * (1 - xi**2) * (1 + eta)                   # Node 7 (0, 1)\n        N[7] = 0.5 * (1 - xi) * (1 - eta**2)                   # Node 8 (-1, 0)\n        \n        return N\n\n    def setup_geometries():\n        \"\"\"\n        Defines the nodal coordinates for the three element geometries.\n        \"\"\"\n        # G1: Undistorted square\n        G1_coords = np.array([\n            [-1., -1.], [+1., -1.], [+1., +1.], [-1., +1.],  # Corners\n            [ 0., -1.], [+1.,  0.], [ 0., +1.], [-1.,  0.]   # Midsides\n        ])\n\n        # G2: Affine parallelogram\n        g2_corners = np.array([[0.0, 0.0], [2.0, 0.0], [3.0, 1.0], [1.0, 1.0]])\n        g2_midsides = np.array([\n            0.5 * (g2_corners[0] + g2_corners[1]), # Node 5 (between 1-2)\n            0.5 * (g2_corners[1] + g2_corners[2]), # Node 6 (between 2-3)\n            0.5 * (g2_corners[2] + g2_corners[3]), # Node 7 (between 3-4)\n            0.5 * (g2_corners[3] + g2_corners[0]), # Node 8 (between 4-1)\n        ])\n        G2_coords = np.vstack((g2_corners, g2_midsides))\n\n        # G3: Warped quadrilateral\n        g3_corners = np.array([[0.0, 0.0], [2.0, 0.2], [2.2, 1.1], [-0.1, 0.9]])\n        g3_midsides = np.array([\n            0.5 * (g3_corners[0] + g3_corners[1]), # Node 5\n            0.5 * (g3_corners[1] + g3_corners[2]), # Node 6\n            0.5 * (g3_corners[2] + g3_corners[3]), # Node 7\n            0.5 * (g3_corners[3] + g3_corners[0]), # Node 8\n        ])\n        G3_coords = np.vstack((g3_corners, g3_midsides))\n\n        return [G1_coords, G2_coords, G3_coords]\n\n    def setup_fields():\n        \"\"\"\n        Defines the list of polynomial displacement fields to test.\n        \"\"\"\n        fields = [\n            lambda x, y: np.array([1.0, 0.0]),      # F1\n            lambda x, y: np.array([x, 0.0]),          # F2\n            lambda x, y: np.array([y, 0.0]),          # F3\n            lambda x, y: np.array([0.0, 1.0]),      # F4\n            lambda x, y: np.array([0.0, x]),          # F5\n            lambda x, y: np.array([0.0, y]),          # F6\n            lambda x, y: np.array([x**2, 0.0]),      # F7\n            lambda x, y: np.array([x * y, 0.0]),      # F8\n            lambda x, y: np.array([y**2, 0.0]),      # F9\n            lambda x, y: np.array([0.0, x**2]),      # F10\n            lambda x, y: np.array([0.0, x * y]),      # F11\n            lambda x, y: np.array([0.0, y**2]),      # F12\n            lambda x, y: np.array([x**2 * y, 0.0]), # F13\n            lambda x, y: np.array([0.0, x * y**2]), # F14\n        ]\n        return fields\n\n    geometries = setup_geometries()\n    fields = setup_fields()\n    results = []\n\n    # Create tensor-product sample points in the parent element\n    xi_eta_vals = np.linspace(-1.0, 1.0, ns)\n    sample_points = []\n    for xi in xi_eta_vals:\n        for eta in xi_eta_vals:\n            sample_points.append((xi, eta))\n\n    # Main loop: iterate over geometries and fields\n    for G_coords in geometries:\n        for F_func in fields:\n            # 1. Calculate nodal displacements by sampling the exact field\n            nodal_displacements = np.array([F_func(x, y) for x, y in G_coords])\n\n            # 2. Iterate over sample points to find max interpolation error\n            max_error = 0.0\n            for xi_s, eta_s in sample_points:\n                # Get shape functions at sample point\n                N = get_shape_functions(xi_s, eta_s)\n\n                # Interpolate physical position (x,y)\n                pos_xy = N @ G_coords\n\n                # Evaluate exact displacement at this physical position\n                u_v_exact = F_func(pos_xy[0], pos_xy[1])\n\n                # Interpolate FE displacement using nodal values\n                u_v_h = N @ nodal_displacements\n\n                # Calculate error and update maximum\n                error = np.max(np.abs(u_v_h - u_v_exact))\n                if error > max_error:\n                    max_error = error\n            \n            # 3. Classify based on tolerance\n            is_reproduced = (max_error = epsilon)\n            results.append(is_reproduced)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3529897"}]}