{"hands_on_practices": [{"introduction": "任何基于守恒律的数值模型，其首要任务是确保其模拟的物理量是守恒的。本练习为任何 Richards 方程求解器提供了一项基本检验：验证全局质量平衡。通过利用一个假设的模拟数据，您将亲手计算存储量变化、边界通量以及源/汇项，从而量化质量平衡误差 [@problem_id:3557197]，这是模型验证和调试过程中的一项关键技能。", "problem": "考虑一个一维、刚性、均质的多孔柱，占据空间域 $\\Omega = [0,L]$，其横截面积 $A$ 为常数。该柱体内的瞬态非饱和流由理查兹方程（Richards' equation）模拟，其中体积含水量为 $\\theta(\\mathbf{x},t)$，达西通量（Darcy flux）为 $\\mathbf{q}(\\mathbf{x},t)$，单位体积的体积源/汇项为 $S(\\mathbf{x},t)$。假设流体不可压缩且密度恒定，固体骨架不变形，因此质量守恒由连续性关系控制。在有限时间区间 $[0,T]$ 内，水相的累积质量平衡应在净边界流入/流出量、内部源/汇项和储水量变化之间保持一致。从质量守恒原理和散度定理出发，推导时空积分平衡方程，并定义在 $[0,T]$ 上的累积质量平衡误差残差 $E$（对于一个完全守恒的计算，该残差应恒等于零）。然后，对于下面给出的具体、科学上真实的场景，计算 $E$ 和归一化误差 $\\varepsilon$，以评估质量守恒性。\n\n几何与数据：\n- 区域长度 $L = 10\\,\\mathrm{m}$，横截面积 $A = 5\\,\\mathrm{m}^{2}$，因此总体积为 $V = A L$。\n- 最终时间 $T = 3600\\,\\mathrm{s}$。\n- 在 $[0,T]$ 时间内，边界通量在每个端面上均匀分布且不随时间变化。使用边界上的单位外法向量 $\\mathbf{n}$：\n  - 在 $x=0$ 处：$\\mathbf{q}\\cdot\\mathbf{n} = -1.2 \\times 10^{-5}\\,\\mathrm{m/s}$（负号表示流入 $\\Omega$）。\n  - 在 $x=L$ 处：$\\mathbf{q}\\cdot\\mathbf{n} = +4.0 \\times 10^{-6}\\,\\mathrm{m/s}$（正号表示流出 $\\Omega$）。\n- 源项在空间上均匀且在时间上恒定：在 $\\Omega \\times [0,T]$ 上，$S(\\mathbf{x},t) = 1.0 \\times 10^{-7}\\,\\mathrm{s}^{-1}$。\n- 在初始和最终时刻，体积含水量在空间上是均匀的：$\\theta(\\mathbf{x},0) = 0.20$ 和 $\\theta(\\mathbf{x},T) = 0.203$。\n\n任务：\n1. 使用质量守恒原理和散度定理，写出在 $[0,T]$ 上的时空积分水量平衡方程，并确定理想值为零的累积质量平衡误差残差 $E$。\n2. 对于给定的数据，明确计算以下量值：\n   - 净边界水体积交换量 $\\displaystyle \\int_{0}^{T}\\int_{\\partial\\Omega} \\mathbf{q}\\cdot\\mathbf{n}\\, d\\Gamma\\, dt$。\n   - 累积源贡献量 $\\displaystyle \\int_{0}^{T}\\int_{\\Omega} S\\, d\\Omega\\, dt$。\n   - 储水量变化 $\\displaystyle \\int_{\\Omega}\\theta(\\mathbf{x},T)\\, d\\Omega - \\int_{\\Omega}\\theta(\\mathbf{x},0)\\, d\\Omega$。\n   - 使用你推导的表达式计算累积质量平衡误差残差 $E$。\n3. 通过将 $|E|$ 用一个有意义的正参考体积 $M_{\\mathrm{ref}}$（由物理上可加和的流入量和源项构成）进行归一化，定义一个无量纲的归一化误差 $\\varepsilon$，该误差适用于报告瞬态模拟中的累积质量守恒性能（不要使用任何百分比表示法）。为给定数据计算 $\\varepsilon$。\n4. 在非饱和流的高级计算岩土力学模拟中，陈述一个科学上合理的 $\\varepsilon$ 可接受容差范围，并评估计算出的 $\\varepsilon$ 是否可接受。\n\n仅报告 $\\varepsilon$ 的值作为你的最终数值答案。将你的最终数值答案四舍五入到四位有效数字。以无量纲分数形式表示最终答案（无单位）。", "solution": "问题陈述已经过验证，被认为是科学合理的、适定的、客观的和自洽的。所有提供的数据都是物理上真实的，并且足以进行所需的计算。\n\n分析始于不可压缩流体在不变形多孔介质中的质量守恒原理。在偏微分形式下，连续性方程（在此背景下也称为理查兹方程）表示为：\n$$\n\\frac{\\partial \\theta}{\\partial t} + \\nabla \\cdot \\mathbf{q} = S\n$$\n其中 $\\theta$ 是体积含水量（无量纲），$\\mathbf{q}$ 是达西通量矢量 [L/T]， $S$ 是体积源/汇项 [1/T]， $t$ 是时间 [T]， $\\nabla \\cdot$ 是散度算子 [1/L]。\n\n1. 累积质量平衡误差残差 $E$ 的推导\n\n为推导时空积分水量平衡，我们首先将连续性方程在整个空间域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\frac{\\partial \\theta}{\\partial t} \\,d\\Omega + \\int_{\\Omega} \\nabla \\cdot \\mathbf{q} \\,d\\Omega = \\int_{\\Omega} S \\,d\\Omega\n$$\n对通量项应用散度定理，我们将体积分转换成边界 $\\partial\\Omega$ 上的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\mathbf{q} \\,d\\Omega = \\int_{\\partial\\Omega} \\mathbf{q} \\cdot \\mathbf{n} \\,d\\Gamma\n$$\n其中 $\\mathbf{n}$ 是边界表面 $\\partial\\Omega$ 上的向外单位法向量。由于区域 $\\Omega$ 是刚性的（不变形），时间导数可以移到空间积分之外（莱布尼茨积分法则）：\n$$\n\\int_{\\Omega} \\frac{\\partial \\theta}{\\partial t} \\,d\\Omega = \\frac{d}{dt} \\int_{\\Omega} \\theta \\,d\\Omega\n$$\n将这些代回，得到整个区域的瞬时质量平衡方程：\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\theta \\,d\\Omega + \\int_{\\partial\\Omega} \\mathbf{q} \\cdot \\mathbf{n} \\,d\\Gamma = \\int_{\\Omega} S \\,d\\Omega\n$$\n接下来，我们将此方程在时间区间 $[0, T]$ 上积分：\n$$\n\\int_{0}^{T} \\left( \\frac{d}{dt} \\int_{\\Omega} \\theta \\,d\\Omega \\right) dt + \\int_{0}^{T} \\left( \\int_{\\partial\\Omega} \\mathbf{q} \\cdot \\mathbf{n} \\,d\\Gamma \\right) dt = \\int_{0}^{T} \\left( \\int_{\\Omega} S \\,d\\Omega \\right) dt\n$$\n根据微积分基本定理，第一项的计算结果是从 $t=0$ 到 $t=T$ 区域内总储水量的变化：\n$$\n\\int_{0}^{T} \\left( \\frac{d}{dt} \\int_{\\Omega} \\theta \\,d\\Omega \\right) dt = \\left[ \\int_{\\Omega} \\theta \\,d\\Omega \\right]_{t=0}^{t=T} = \\int_{\\Omega} \\theta(\\mathbf{x}, T) \\,d\\Omega - \\int_{\\Omega} \\theta(\\mathbf{x}, 0) \\,d\\Omega\n$$\n对于一个完全守恒的数值模拟或解析解，积分平衡必须精确成立。累积质量平衡误差残差 $E$ 定义为将所有项移到一边后表达式的值。一个非零的 $E$ 量化了整个模拟期间的总质量守恒误差。\n$$\nE = \\left( \\int_{\\Omega}\\theta(\\mathbf{x},T)\\, d\\Omega - \\int_{\\Omega}\\theta(\\mathbf{x},0)\\, d\\Omega \\right) + \\int_{0}^{T}\\int_{\\partial\\Omega} \\mathbf{q}\\cdot\\mathbf{n}\\, d\\Gamma\\, dt - \\int_{0}^{T}\\int_{\\Omega} S\\, d\\Omega\\, dt\n$$\n该表达式定义了理想值为零的残差 $E$。它代表（储量变化）+（净流出量）-（总源项）= $0$。\n\n2. 根据给定数据计算各量值\n\n问题是一维的，区域为 $\\Omega = [0,L]$，长度 $L = 10\\,\\mathrm{m}$，横截面积 $A = 5\\,\\mathrm{m}^{2}$。总体积为 $V = A L = 50\\,\\mathrm{m}^{3}$。边界 $\\partial\\Omega$ 由 $x=0$ 和 $x=L$ 处的两个面组成。\n\n- **净边界水体积交换量：**\n边界通量不随时间变化，且在各个面上是均匀的。该积分简化为：\n$$\n\\int_{0}^{T}\\int_{\\partial\\Omega} \\mathbf{q}\\cdot\\mathbf{n}\\, d\\Gamma\\, dt = \\int_{0}^{T} \\left[ (\\mathbf{q}\\cdot\\mathbf{n}|_{x=L})A + (\\mathbf{q}\\cdot\\mathbf{n}|_{x=0})A \\right] dt\n$$\n根据给定值，$(\\mathbf{q}\\cdot\\mathbf{n}|_{x=L}) = 4.0 \\times 10^{-6}\\,\\mathrm{m/s}$ 和 $(\\mathbf{q}\\cdot\\mathbf{n}|_{x=0}) = -1.2 \\times 10^{-5}\\,\\mathrm{m/s}$，以及 $T = 3600\\,\\mathrm{s}$：\n$$\nM_{\\text{boundary}} = A T \\left( (\\mathbf{q}\\cdot\\mathbf{n}|_{x=L}) + (\\mathbf{q}\\cdot\\mathbf{n}|_{x=0}) \\right) \\\\\nM_{\\text{boundary}} = (5\\,\\mathrm{m}^2)(3600\\,\\mathrm{s}) \\left( 4.0 \\times 10^{-6}\\,\\mathrm{m/s} - 1.2 \\times 10^{-5}\\,\\mathrm{m/s} \\right) \\\\\nM_{\\text{boundary}} = 18000 \\left( -8.0 \\times 10^{-6} \\right) \\mathrm{m}^3 = -0.144\\,\\mathrm{m}^3\n$$\n该项表示在时间段 $[0, T]$ 内从区域流出的净体积量。负号表示净流入。\n\n- **累积源贡献量：**\n源项 $S = 1.0 \\times 10^{-7}\\,\\mathrm{s}^{-1}$ 在空间和时间上是均匀的。\n$$\nM_{\\text{source}} = \\int_{0}^{T}\\int_{\\Omega} S\\, d\\Omega\\, dt = S \\cdot V \\cdot T \\\\\nM_{\\text{source}} = (1.0 \\times 10^{-7}\\,\\mathrm{s}^{-1})(50\\,\\mathrm{m}^3)(3600\\,\\mathrm{s}) = 0.018\\,\\mathrm{m}^3\n$$\n\n- **储水量变化：**\n初始和最终含水量 $\\theta(\\mathbf{x},0) = 0.20$ 和 $\\theta(\\mathbf{x},T) = 0.203$ 在空间上是均匀的。\n$$\n\\Delta M_{\\text{storage}} = \\int_{\\Omega}\\theta(\\mathbf{x},T)\\, d\\Omega - \\int_{\\Omega}\\theta(\\mathbf{x},0)\\, d\\Omega = (\\theta(T) - \\theta(0))V \\\\\n\\Delta M_{\\text{storage}} = (0.203 - 0.20)(50\\,\\mathrm{m}^3) = (0.003)(50\\,\\mathrm{m}^3) = 0.15\\,\\mathrm{m}^3\n$$\n\n- **累积质量平衡误差残差 $E$：**\n将计算出的值代入 $E$ 的表达式中：\n$$\nE = \\Delta M_{\\text{storage}} + M_{\\text{boundary}} - M_{\\text{source}} \\\\\nE = 0.15\\,\\mathrm{m}^3 + (-0.144\\,\\mathrm{m}^3) - 0.018\\,\\mathrm{m}^3 = -0.012\\,\\mathrm{m}^3\n$$\n\n3. 归一化误差 $\\varepsilon$ 的定义与计算\n\n无量纲归一化误差 $\\varepsilon$ 的定义是通过将残差的绝对值 $|E|$ 用一个参考体积 $M_{\\text{ref}}$ 进行归一化得到的。问题规定 $M_{\\text{ref}}$ 是一个由可加和的流入量和源项构成的物理上有意义的体积。系统的水量输入包括 $x=0$ 处的流入和内部源 $S$。\n\n- **总流入体积：** $x=0$ 处的流入通量由 $\\mathbf{q}\\cdot\\mathbf{n} = -1.2 \\times 10^{-5}\\,\\mathrm{m/s}$ 给出。负号表示流入。体积速率为 $|-1.2 \\times 10^{-5}\\,\\mathrm{m/s}| \\times A = (1.2 \\times 10^{-5}\\,\\mathrm{m/s}) \\times (5\\,\\mathrm{m}^2) = 6.0 \\times 10^{-5}\\,\\mathrm{m}^3/\\mathrm{s}$。\n在时间 $T$ 内，此流入的总体积为：\n$$ V_{\\text{inflow}} = (6.0 \\times 10^{-5}\\,\\mathrm{m}^3/\\mathrm{s}) \\times (3600\\,\\mathrm{s}) = 0.216\\,\\mathrm{m}^3 $$\n- **总源体积：** 这是先前计算的 $M_{\\text{source}} = 0.018\\,\\mathrm{m}^3$。\n\n参考体积 $M_{\\text{ref}}$ 是所有输入项的总和：\n$$\nM_{\\text{ref}} = V_{\\text{inflow}} + M_{\\text{source}} = 0.216\\,\\mathrm{m}^3 + 0.018\\,\\mathrm{m}^3 = 0.234\\,\\mathrm{m}^3\n$$\n归一化误差 $\\varepsilon$ 为：\n$$\n\\varepsilon = \\frac{|E|}{M_{\\text{ref}}} = \\frac{|-0.012\\,\\mathrm{m}^3|}{0.234\\,\\mathrm{m}^3} = \\frac{0.012}{0.234} \\approx 0.05128205...\n$$\n四舍五入到四位有效数字，$\\varepsilon \\approx 0.05128$。\n\n4. 归一化误差的评估\n\n在高级计算岩土力学和水文地质学中，保持较低的质量平衡误差对于确保模拟结果的物理真实性和可靠性至关重要。归一化误差 $\\varepsilon$ 为此提供了一个定量度量。$\\varepsilon$ 的可接受容差取决于具体应用，但对于高保真度的科学和工程模拟，通常期望误差非常小。\n- $\\varepsilon  10^{-4}$（或 $0.01\\%$）的值通常被认为是优秀的。\n- $\\varepsilon  10^{-3}$（或 $0.1\\%$）的值通常被认为是良好的。\n- $\\varepsilon  10^{-2}$（或 $1\\%$）的值对于某些筛选级模型可能是可接受的，但对于严谨的分析来说则偏高。\n\n计算值为 $\\varepsilon \\approx 0.05128$，相当于约 $5.1\\%$ 的质量平衡误差。该值显著高于高级模拟的典型容差水平。这样的误差将被视为不可接受，并需要审查数值模型的参数，如时间步长、空间离散化（网格细化）以及非线性求解器的收敛标准，以改善计算的守恒性。\n\n最终答案要求是四舍五入到四位有效数字的 $\\varepsilon$ 的数值。\n$$ \\varepsilon \\approx 0.05128 $$", "answer": "$$\\boxed{0.05128}$$", "id": "3557197"}, {"introduction": "求解高度非线性的 Richards 方程需要稳健的迭代方法，但我们如何判断迭代何时“收敛”到了足够精确的解？本练习要求您为牛顿求解器定义一套全面的停止准则，超越简单的残差检查，并引入基于物理缩放的修正量和累积质量平衡控制。理解这些准则对于开发高效、可靠的模拟至关重要，能有效避免过早终止或不必要的计算浪费 [@problem_id:3557218]。", "problem": "考虑非均质多孔介质中非饱和流的瞬态 Richards 方程，以体积含水量的守恒形式写为\n$$\n\\frac{\\partial \\theta(h)}{\\partial t} + \\nabla \\cdot \\mathbf{q}(h) = S,\n$$\n其中 $\\theta(h)$ 是体积含水量，$\\mathbf{q}(h) = -K(h)\\left(\\nabla h + \\nabla z\\right)$ 是达西通量，其中 $K(h)$ 是导水率，$z$ 是高程水头，$S$ 是一个体积源项（注入时为正）。设 $\\Omega$ 是空间域，其边界为 $\\Gamma = \\Gamma_q \\cup \\Gamma_h$，其中 $\\Gamma_q$ 承载给定的通量 $\\mathbf{q}\\cdot\\mathbf{n}$，$\\Gamma_h$ 承载给定的压力水头 $h$。时间上采用时间步长为 $\\Delta t$ 的后向欧拉法进行离散化，空间上采用稳定协调的有限元法或有限体积法进行离散化。在每个时间步 $t^n$，未知节点向量 $h^n \\in \\mathbb{R}^N$ 的离散非线性残差表示为 $r(h^n) \\in \\mathbb{R}^N$，牛顿迭代通过求解线性化系统 $J^{n,k} \\, \\delta h^{n,k} = -r^{n,k}$ 来更新 $h^{n,k+1} = h^{n,k} + \\delta h^{n,k}$，其中 $J^{n,k}$ 是 $r$ 在 $h^{n,k}$ 处的雅可比矩阵。\n\n您的任务是为非线性求解器选择一套停止准则，以同时确保：(i) 非线性方程的求解精度与离散化和物理特性相称，(ii) 分量化的牛顿修正量相对于适当的变量尺度而言很小，以避免过冲和伪振荡，(iii) 瞬态计算过程中的累积质量守恒相对于总流入量受到控制。此外，您必须确定能够揭示由变量缩放或病态导致的停滞的诊断工具。\n\n从质量守恒定律以及离散残差和牛顿更新量的定义出发，以下哪个选项给出了一个科学上一致的组合停止准则和适当的诊断工具？\n\nA. 要求，在每个时间步 $t^n$ 和牛顿迭代 $k$ 时：\n- 非线性残差减小：当\n$$\n\\|r^{n,k}\\|_2 \\le \\tau_{\\mathrm{abs}} + \\tau_{\\mathrm{rel}} \\, \\|r^{n,0}\\|_2,\n$$\n成立时停止，容差为 $\\tau_{\\mathrm{abs}}  0$ 和 $\\tau_{\\mathrm{rel}}  0$。\n- 具有物理动机缩放的最大分量修正限制：定义对角缩放矩阵 $D^{n,k} = \\mathrm{diag}\\left(|h^{n,k}_i| + s_i\\right)$，其中 $s_i  0$ 为每个自由度编码了一个水头尺度（例如，特征毛细水头），并要求\n$$\n\\| (D^{n,k})^{-1} \\, \\delta h^{n,k} \\|_{\\infty} \\le \\eta_{\\mathrm{corr}},\n$$\n其中 $\\eta_{\\mathrm{corr}}  0$ 足够小。\n- 瞬态过程中的累积质量平衡误差阈值：对于每个接受的时间步，定义每步的全局质量平衡残差（单位为体积流量）\n$$\nE_{\\mathrm{mb}}^n = \\left| \\frac{1}{\\Delta t} \\int_{\\Omega} \\left(\\theta^n - \\theta^{n-1}\\right) \\, \\mathrm{d}\\Omega + \\int_{\\Gamma} \\mathbf{q}^n \\cdot \\mathbf{n} \\, \\mathrm{d}\\Gamma - \\int_{\\Omega} S^n \\, \\mathrm{d}\\Omega \\right|,\n$$\n及其累积质量误差（单位为质量）\n$$\nE_{\\mathrm{cum}}^n = \\rho_w \\sum_{j=1}^{n} E_{\\mathrm{mb}}^j \\, \\Delta t,\n$$\n由累积流入质量进行归一化\n$$\nM_{\\mathrm{in}}^{1:n} = \\rho_w \\sum_{j=1}^{n} \\Delta t \\int_{\\Gamma_q^{\\mathrm{in}}} q^j \\, \\mathrm{d}\\Gamma,\n$$\n并要求 $E_{\\mathrm{cum}}^n \\le \\epsilon_{\\mathrm{mb}} \\, M_{\\mathrm{in}}^{1:n}$，其中 $\\epsilon_{\\mathrm{mb}}  0$。\n针对缩放导致的停滞的诊断：监测 $\\|(D^{n,k})^{-1} \\delta h^{n,k}\\|_{\\infty}$ 以及残差下降比 $\\|r^{n,k+1}\\|_2 / \\|r^{n,k}\\|_2$；如果残差停滞而缩放步长接近机器精度，则怀疑缩放不良。估计缩放后雅可比矩阵的条件数 $\\kappa\\!\\left((D^{n,k})^{-1} J^{n,k} D^{n,k}\\right)$；大的 $\\kappa$ 值表明变量缩放不佳。检查每个分量的缩放残差 $|(D^{n,k})^{-1} r^{n,k}|$ 以识别其单位或量级在范数中占主导地位的变量。\n\nB. 如果 $\\|r^{n,k}\\|_2 \\le \\tau_{\\mathrm{abs}}$ 或 $\\|\\delta h^{n,k}\\|_{\\infty} \\le \\eta_{\\mathrm{corr}}$（未缩放）之一成立，则停止牛顿迭代，并强制执行一个每步质量平衡条件\n$$\nE_{\\mathrm{mb}}^n \\le \\epsilon_{\\mathrm{mb}} \\left|\\int_{\\Gamma} \\mathbf{q}^n \\cdot \\mathbf{n} \\, \\mathrm{d}\\Gamma \\right|,\n$$\n不进行累积跟踪。仅通过计算迭代次数来诊断停滞；跨时间步的迭代次数增加表明存在缩放问题。\n\nC. 当 $\\|r^{n,k}\\|_2 \\le \\tau_{\\mathrm{rel}} \\, \\|r^{n,0}\\|_2$（没有绝对下限）且 $\\max_i |\\delta h^{n,k}_i| / |h^{n,k}_i| \\le \\eta_{\\mathrm{corr}}$（其中 $s_i = 0$）时接受解。通过要求\n$$\nE_{\\mathrm{cum}}^n \\le \\epsilon_{\\mathrm{mb}} \\left( \\rho_w \\sum_{j=1}^{n} \\Delta t \\left| \\int_{\\Gamma_q^{\\mathrm{out}}} q^j \\, \\mathrm{d}\\Gamma \\right| + \\int_{\\Omega} \\left|\\theta^n - \\theta^0\\right| \\, \\mathrm{d}\\Omega \\right)\n$$\n来对流出量和存储变化的总和强制执行累积质量平衡。通过检查 $\\|J^{n,k}\\|_2$ 是否很大来诊断缩放问题。\n\nD. 使用 $1$-范数下的残差准则，$\\|r^{n,k}\\|_1 \\le \\tau_{\\mathrm{rel}} \\, \\|r^{n,0}\\|_1$，无绝对容差，以及一个基于\n$$\n\\left\\| H^{-1} \\delta h^{n,k} \\right\\|_{\\infty} \\le \\eta_{\\mathrm{corr}},\n$$\n的修正准则，其中 $H$ 是所有节点上 $|h^{n,k}|$ 的调和平均值。使用\n$$\n\\frac{E_{\\mathrm{cum}}^n}{\\rho_w \\sum_{j=1}^{n} \\Delta t \\int_{\\Gamma} |q^j| \\, \\mathrm{d}\\Gamma} \\le \\epsilon_{\\mathrm{mb}},\n$$\n定义一个质量平衡阈值，并仅通过监测线性求解器残差 $\\|J^{n,k} \\delta h^{n,k} + r^{n,k}\\|_2$ 来诊断停滞。\n\nE. 当区域平均残差 $\\left|\\Omega\\right|^{-1} \\int_{\\Omega} |r^{n,k}| \\, \\mathrm{d}\\Omega \\le \\tau_{\\mathrm{abs}}$ 且修正约束 $\\max_i |\\delta h^{n,k}_i| \\, C(h^{n,k}_i) \\le \\eta_{\\mathrm{corr}}$ 成立时停止，其中 $C(h)$ 是比储水能力。通过要求每个单元的误差低于局部阈值来控制质量平衡，不进行全局累积归一化。通过检查 $\\theta$ 的空间分布模式来诊断缩放停滞；干锋附近的大变化表明存在缩放问题。\n\n选择一个与控制守恒律一致、在非线性求解中尊重变量缩放、并为因缩放引起的停滞提供严谨诊断的选项。", "solution": "用户提供了一个关于为瞬态 Richards 方程的数值解选择合适的非线性求解器停止准则和诊断工具的问题。首先必须验证问题陈述本身的科学和逻辑一致性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **控制方程**：$\\frac{\\partial \\theta(h)}{\\partial t} + \\nabla \\cdot \\mathbf{q}(h) = S$，Richards 方程的守恒形式。\n- **本构关系**：$\\theta(h)$ 是体积含水量，$\\mathbf{q}(h) = -K(h)\\left(\\nabla h + \\nabla z\\right)$ 是 Darcy 通量。\n- **变量和参数**：$h$ 是压力水头，$\\theta$ 是体积含水量，$K$ 是导水率，$z$ 是高程水头，$S$ 是源/汇项，$t$ 是时间。\n- **域和边界条件**：空间域 $\\Omega$，其边界为 $\\Gamma = \\Gamma_q \\cup \\Gamma_h$，分别用于给定通量和给定水头。\n- **数值方法**：时间上采用后向 Euler 法（步长 $\\Delta t$）离散。空间上采用稳定协调的有限元或有限体积法离散。\n- **非线性求解器**：在每个时间步 $t^n$，对离散残差 $r(h^n) \\in \\mathbb{R}^N$ 使用 Newton 法。在 Newton 迭代 $k$ 中，更新量 $\\delta h^{n,k}$ 的线性系统为 $J^{n,k} \\, \\delta h^{n,k} = -r^{n,k}$，更新公式为 $h^{n,k+1} = h^{n,k} + \\delta h^{n,k}$。\n- **要求目标**：准则必须确保：(i) 精度与离散化相称，(ii) 分量化的修正量相对于适当的尺度而言很小，以及 (iii) 累积质量守恒得到控制。诊断工具必须能识别由于缩放或病态导致的停滞。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于标准的 Richards 方程，这是水文地质学和土壤物理学中的一个基本模型。所描述的数值方法（Backward Euler、FE/FV、Newton's method）是求解该方程的标准且稳健的方法。该问题在科学上是合理的。\n- **适定性**：该问题要求从一系列选项中确定最科学一致的准则集。这是数值分析和科学计算领域中一个定义明确的任务。其结构旨在使选项中有一个唯一的最佳答案。\n- **客观性**：语言技术性强、精确且客观。\n- **完整性和一致性**：该问题提供了足够的背景信息，可以根据非线性偏微分方程数值方法的既定原则来评估所提出的准则。没有矛盾之处。\n\n**步骤 3：结论和行动**\n问题陈述是有效的。这是一个关于基于物理模型的计算科学中最佳实践的、表述良好的问题。我现在将通过分析选项来推导解决方案。\n\n### 分析与推导\n\n目标是为 Newton 求解器找到一套稳健、具有物理意义且能应对 Richards 方程特有挑战（强非线性、非均质特性、变量量级范围广）的停止准则和诊断工具。\n\n对于用 Newton 法求解的非线性问题 $r(x) = 0$，一套稳健的停止准则通常包括以下组合检查：\n1.  **残差检查**：残差向量 $r$ 衡量当前迭代满足离散方程的程度。形式为 $\\|r^k\\| \\le \\tau_{\\mathrm{abs}} + \\tau_{\\mathrm{rel}} \\|r^0\\|$ 的准则是标准做法。相对部分（$\\tau_{\\mathrm{rel}}$）确保从非线性求解的初始状态取得进展，而绝对部分（$\\tau_{\\mathrm{abs}}$）提供了一个下限，确保最终残差在绝对意义上很小，这在初始残差 $\\|r^0\\|$ 已经很小的情况下至关重要。\n2.  **更新（步长）检查**：更新向量 $\\delta x^k$ 应该变得很小，表明解不再有显著变化。关键在于，对于像压力水头 $h$ 这样可以跨越多个数量级的变量，简单的范数 $\\|\\delta h^k\\|$ 是不够的。修正量必须相对于变量本身的量级进行缩放。像 $\\|\\left(D^k\\right)^{-1} \\delta h^k\\|_{\\infty} \\le \\eta_{\\mathrm{corr}}$ 这样的分量化缩放准则是最先进的技术，其中 $D^k = \\mathrm{diag}(|h_i^k| + s_i)$。$s_i0$ 这一项是与问题相关的缩放因子，可防止除以零，并为当 $|h_i|$ 接近零时什么构成“小”变化提供了物理上有意义的尺度。\n3.  **守恒性检查**：Richards 方程是一个守恒律。数值解应在全局上遵守这一原则。由于离散化和非线性解的截断误差，每个时间步都可能出现小的质量平衡误差。对于长期瞬态模拟，监测*累积*质量平衡误差并确保其保持为相关物理量（例如流入域的总质量）的一小部分是至关重要的。\n\n停滞（即不收敛）的诊断工具应能揭示其原因。停滞通常是由雅可比矩阵 $J$ 的病态引起的，而变量缩放不当会加剧这种情况。\n1.  **停滞检测**：残差减小停滞（即 $\\|r^{k+1}\\|/\\|r^k\\| \\approx 1$）而缩放步长已经非常小（接近机器精度）是停滞的经典指标。\n2.  **条件数分析**：雅可比矩阵的条件数 $\\kappa(J)$ 衡量了解对扰动的敏感性。更相关的是，*缩放后*的雅可比矩阵的条件数，例如 $\\kappa\\left(D^{-1} J D\\right)$，可以诊断变量缩放对缓解数值条件问题的效果。一个大的值表明在该 Newton 步上存在一个内在病态的线性系统。\n\n在建立了这些原则之后，我现在将评估每个选项。\n\n### 逐项分析\n\n**选项 A：**\n- **非线性残差准则**：提出 $\\|r^{n,k}\\|_2 \\le \\tau_{\\mathrm{abs}} + \\tau_{\\mathrm{rel}} \\, \\|r^{n,0}\\|_2$。这是标准的、稳健的混合绝对/相对准则。**正确**。\n- **修正准则**：提出 $\\| (D^{n,k})^{-1} \\, \\delta h^{n,k} \\|_{\\infty} \\le \\eta_{\\mathrm{corr}}$，并带有物理上合理、分量化的缩放矩阵 $D^{n,k} = \\mathrm{diag}\\left(|h^{n,k}_i| + s_i\\right)$。这正确地解决了缩放问题。**正确**。\n- **质量平衡准则**：通过对每步全局质量平衡残差 $E_{\\mathrm{mb}}^j$ 求和来定义累积质量误差 $E_{\\mathrm{cum}}^n$。$E_{\\mathrm{mb}}^n$ 的公式正确地代表了离散全局守恒律。它通过总流入质量 $M_{\\mathrm{in}}^{1:n}$ 进行归一化，这是物理上最稳健的尺度选择。**正确**。\n- **诊断**：建议监测残差下降比、缩放步长，并在前者停滞而后者很小时检查停滞。这是一个正确的程序。它还建议估计适当缩放的雅可比矩阵的条件数 $\\kappa\\!\\left((D^{n,k})^{-1} J^{n,k} D^{n,k}\\right)$ 以诊断缩放/条件问题。这是一种先进且高效的诊断方法。最后一个建议检查每个分量的缩放残差 $|(D^{n,k})^{-1} r^{n,k}|$ 在量纲上不一致（单位为[长度]$^2$/[时间]），这在一个原本出色的描述中是一个小瑕疵。然而，考虑到该选项其他所有部分的卓越质量和正确性，它仍然是遥遥领先的最科学合理的选择。\n- **结论**：该选项几乎完美地符合现代科学计算中处理此类问题的最佳实践。**正确**。\n\n**选项 B：**\n- **停止准则**：在绝对残差检查和未缩放修正检查之间使用逻辑或。或条件是有问题的，并且缺少相对残差检查和缩放修正是严重的缺陷。**不正确**。\n- **质量平衡**：仅强制执行每步的、非累积的检查，并按净边界通量归一化。这不足以控制长期误差，而且归一化因子可能为零，使准则无用。**不正确**。\n- **诊断**：建议仅计算迭代次数，这是一种原始的诊断方法，无法洞察不收敛的原因。**不正确**。\n- **结论**：该选项存在根本性缺陷，表明对非线性系统的数值方法理解不足。**不正确**。\n\n**选项 C：**\n- **残差准则**：使用仅相对的准则，如果初始残差很小，可能会过早终止。**不正确**。\n- **修正准则**：使用没有下限值（$s_i = 0$）的相对缩放，当任何 $h^{n,k}_i$ 接近零时会导致除零错误。压力水头可以为零或负，使得该方法无法使用。**不正确**。\n- **质量平衡**：对累积误差使用了一个有问题的归一化量，涉及流出量和总存储变化。按流入量归一化更优越。**不正确**。\n- **诊断**：建议监测未缩放雅可比矩阵的范数 $\\|J^{n,k}\\|_2$，这不是病态的可靠指标。条件数才是正确的度量。**不正确**。\n- **结论**：该选项在稳健数值实践方面包含多个概念性错误。**不正确**。\n\n**选项 D：**\n- **残差准则**：使用 $L_1$-范数，这是可以接受的，但缺乏绝对容差，这是一个显著的弱点。**不正确**。\n- **修正准则**：使用单个标量（所有 $|h_i|$ 值的调和平均数）来缩放整个更新向量。这是不正确的；缩放必须是分量化的，因为水头值在空间上是变化的。**不正确**。\n- **质量平衡**：通过总绝对边界通量进行归一化，这是一个貌似可行的选择，但通常不如按流入量归一化稳健。\n- **诊断**：建议监测线性求解器残差 $\\|J^{n,k} \\delta h^{n,k} + r^{n,k}\\|_2$。这只衡量了牛顿步的线性系统求解得有多好；它不提供关于外部非线性迭代收敛性的信息。这是一个根本性错误。**不正确**。\n- **结论**：该选项的特点是对缩放和非线性求解器诊断存在根本性误解。**不正确**。\n\n**选项 E：**\n- **残差准则**：使用非标准的、仅绝对值的准则，基于区域平均值，这不稳健。**不正确**。\n- **修正准则**：使用比储水能力 $C(h)$ 进行缩放。虽然有物理动机，但这并不稳健，因为 $C(h)$ 在饱和或非常干燥的区域可能接近于零，从而允许在 $h$ 中出现过大、无约束的更新。**不正确**。\n- **质量平衡**：仅提出局部的、基于单元的误差控制，没有全局累积跟踪，这无法控制全局质量误差随时间的累积。**不正确**。\n- **诊断**：将物理特征（干锋处的大梯度）与缩放问题的数值诊断混淆。这不是一种定量或可靠的方法。**不正确**。\n- **结论**：该选项由非标准且构思不佳的准则和诊断组成。**不正确**。\n\n**结论**\n选项A为停止准则和诊断提供了一个全面、复杂且科学合理的框架。它正确地指出了混合残差容差、适当缩放的更新检查、具有稳健归一化的累积质量平衡控制以及基于缩放雅可比矩阵的先进诊断的需求。其他所有选项都包含多个根本性缺陷。尽管其建议的一个诊断在量纲分析上存在轻微的不一致，但选项A仍然是压倒性的最佳且唯一正确的选择。", "answer": "$$\\boxed{A}$$", "id": "3557218"}, {"introduction": "非饱和土的行为具有路径依赖性；其含水量与毛细管压力之间的关系取决于其经历的润湿和干燥历史。这种被称为“滞回”的现象，要求我们使用能够追踪材料记忆的高级本构模型。本练习将引导您探索实现一个物理上一致的滞回模型的核心要求，重点关注“返回点记忆”等概念以及在数值模拟中捕捉这种复杂行为所必需的内部状态变量 [@problem_id:3557254]。", "problem": "考虑在小应变条件下，可变形多孔介质中等温、变饱和流的 Richards 方程，该方程以含水量 $\\theta$ 和水头 $h$ 写成混合形式：$$\\frac{\\partial \\theta}{\\partial t} = \\nabla \\cdot \\left( K(S) \\nabla h \\right) + q,$$ 其中 $K(S)$ 是依赖于饱和度 $S$ 的非饱和导水率，$q$ 是一个给定的源或汇。毛细管压力定义为 $$p_c = p_a - p_w,$$ 其中 $p_a$ 是空气压力，$p_w$ 是水压力，有效饱和度为 $$S_e = \\frac{S - S_r}{S_s - S_r},$$ 其中 $S_r$ 是残余饱和度，$S_s$ 是满饱和时的饱和度。在非饱和土中，$p_c$ 和 $S$ 之间的本构映射表现出滞回现象：对于相同的 $S$，毛细管压力 $p_c$ 会因介质是处于湿润还是干燥过程而不同，并且中间扫描曲线连接着主湿润曲线和主干燥曲线。\n\n根据质量守恒和等温条件下的热力学第二定律 (SLT)，一个一致的毛细管压力-饱和度关系的滞回模型必须至少满足以下性质：\n- 路径依赖性，由内部状态变量表示，使得映射 $$S = \\mathcal{G}(p_c; \\boldsymbol{\\xi})$$ 或 $$p_c = \\mathcal{H}(S; \\boldsymbol{\\xi})$$ 依赖于一个捕捉反转历史的有限维记忆变量集 $\\boldsymbol{\\xi}$。\n- 回归点记忆 (RPM)：如果加载（以 $p_c$ 或 $h$ 计）发生反转，随后又回到先前的反转状态，则响应将恢复该状态，而不会产生伪残差。\n- 环路耗散非负性：每个滞回循环耗散的能量，由 $$\\oint p_c \\, \\mathrm{d} S,$$ 给出，必须满足 $$\\oint p_c \\, \\mathrm{d} S \\ge 0,$$ 这可以防止不符合物理的能量产生。\n- 物理边界：中间扫描曲线保持在主湿润曲线和主干燥曲线之间，因此对于所有容许的 $S$，有 $$p_c^{\\mathrm{wet}}(S) \\le p_c^{\\mathrm{scan}}(S) \\le p_c^{\\mathrm{dry}}(S)$$。\n\n您正在一个用于求解 Richards 方程的有限元法 (FEM) 代码中实现滞回功能，该代码使用隐式时间积分器和 Newton–Raphson 迭代。您可以使用基于主曲线派生的 Preisach 滞回算子模型或扫描曲线模型。在每个高斯点，您必须维护内部变量，并在解随着湿润（$\\dot{p}_c  0$ 或等效地 $S$ 增加）和干燥（$\\dot{p}_c  0$ 或等效地 $S$ 减少）循环推进时更新它们。\n\n哪个选项正确地指出了必要的内部状态变量，并提供了一种算法更新策略，该策略能够强制实现回归点记忆和非负环路耗散，并为 Newton 迭代产生一致切线？\n\nA. 在每个积分点维护一个反转点堆栈 $$\\{(p_c^{(k)}, S^{(k)})\\}_{k=1}^{N}$$ 和一个分支指示器 $$\\beta \\in \\{\\mathrm{wet}, \\mathrm{dry}\\}$$。当 $\\dot{p}_c$ 的符号改变时，将当前的 $(p_c, S)$ 压入堆栈。在同一分支内随后的单调演化中，评估由最近的反转饱和度 $$S^{\\mathrm{rev}}$$ 参数化并受主曲线 $$p_c^{\\mathrm{wet}}(S)$$ 和 $$p_c^{\\mathrm{dry}}(S)$$ 界定的扫描曲线 $$p_c^{\\mathrm{scan},\\beta}(S; S^{\\mathrm{rev}})$$。如果轨迹重新进入先前的反转点，则弹出堆栈以恢复该状态 (RPM)。确保从所选的扫描曲线计算 $$\\frac{\\partial p_c}{\\partial S}$$ 以提供一致切线。选择扫描曲线以使 $$p_c^{\\mathrm{wet}}(S) \\le p_c^{\\mathrm{scan},\\beta}(S; S^{\\mathrm{rev}}) \\le p_c^{\\mathrm{dry}}(S)$$ 和 $$\\oint p_c \\, \\mathrm{d} S \\ge 0$$。\n\nB. 在每个积分点仅跟踪当前的分支指示器 $$\\beta \\in \\{\\mathrm{wet}, \\mathrm{dry}\\}$$。当 $\\dot{S}$ 的符号改变时，切换 $\\beta$。当 $\\beta = \\mathrm{wet}$ 时使用 $$p_c^{\\mathrm{wet}}(S)$$，当 $\\beta = \\mathrm{dry}$ 时使用 $$p_c^{\\mathrm{dry}}(S)$$。不存储反转点，也不使用扫描曲线。切线 $$\\frac{\\partial p_c}{\\partial S}$$ 直接从与 $\\beta$ 对应的主曲线中获取。\n\nC. 仅存储最后两个反转点 $$\\{(p_c^{(N-1)}, S^{(N-1)}), (p_c^{(N)}, S^{(N)})\\}$$ 而从不移除较早的点，并通过在 $(S, p_c)$ 平面中进行线性插值来构造它们之间的扫描曲线。根据 $\\dot{S}$ 的符号切换分支，并在 $\\dot{S}$ 改变符号时添加新的反转点，但不移除任何先前存储的反转点。使用一个恒定的切线 $$\\frac{\\partial p_c}{\\partial S}$$，其值等于线性段的斜率。\n\nD. 使用一个标量累积湿度指数 $$m(t) = \\int_{0}^{t} \\phi(\\dot{S}(\\tau)) \\, \\mathrm{d} \\tau$$ 作为唯一的状态变量，其中 $\\phi$ 是一个选定的非线性函数。定义 $$p_c = \\tilde{p}_c(S, m)$$，使得 $m$ 增加对应于干燥，$m$ 减少对应于湿润，并且不存储反转点或分支指示器。每个时间步通过 $$m^{n+1} = m^{n} + \\phi(\\dot{S}^{n+1}) \\Delta t$$ 更新 $$m$$。切线 $$\\frac{\\partial p_c}{\\partial S}$$ 从 $$\\tilde{p}_c$$ 计算。\n\nE. 实现一个 Preisach 滞回算子，其在阈值对 $$(\\alpha, \\beta)$$（其中 $$\\alpha \\ge \\beta$$）上具有密度 $$\\mu(\\alpha, \\beta) \\ge 0$$。通过集合 $$\\mathcal{P}(t) = \\{(\\alpha, \\beta) \\, | \\, \\text{relay with thresholds } (\\alpha, \\beta) \\text{ is ON at time } t\\}$$ 的边界 $$\\Gamma(t)$$ 来表示记忆状态，该边界在 $$(\\alpha, \\beta)$$ 平面上形成一条阶梯曲线。当 $p_c$ 增加（干燥）时，通过移动水平段来更新 $$\\Gamma(t)$$；当 $p_c$ 减少（湿润）时，通过移动垂直段来更新。在反转点使用推入/弹出操作以强制实现 RPM。将饱和度计算为 $$S(t) = S_r + (S_s - S_r) \\int\\!\\!\\!\\int_{\\mathcal{P}(t)} \\mu(\\alpha, \\beta) \\, \\mathrm{d}\\alpha \\, \\mathrm{d}\\beta$$，确保当 $$\\mu(\\alpha, \\beta) \\ge 0$$ 时，$$p_c^{\\mathrm{wet}}(S) \\le p_c^{\\mathrm{scan}}(S) \\le p_c^{\\mathrm{dry}}(S)$$ 和 $$\\oint p_c \\, \\mathrm{d} S \\ge 0$$。通过 Preisach 算子相对于 $p_c$ 的 Fréchet 导数提供一致切线。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- **控制方程**：可变形介质中变饱和流的 Richards 方程：$$\\frac{\\partial \\theta}{\\partial t} = \\nabla \\cdot \\left( K(S) \\nabla h \\right) + q$$，其中 $\\theta$ 是含水量，$t$ 是时间，$K(S)$ 是依赖于饱和度 $S$ 的非饱和导水率，$h$ 是水头，$q$ 是源/汇项。\n- **本构关系**：\n    - 毛细管压力：$$p_c = p_a - p_w$$，其中 $p_a$ 是空气压力，$p_w$ 是水压力。\n    - 有效饱和度：$$S_e = \\frac{S - S_r}{S_s - S_r}$$，其中 $S_r$ 是残余饱和度，$S_s$ 是满饱和度。\n- **滞回现象**：毛细管压力 $p_c$ 和饱和度 $S$ 之间的关系是路径依赖的，对湿润和干燥过程表现出不同的曲线，并有中间扫描曲线。\n- **滞回模型所需属性**：\n    1. **路径依赖性**：本构关系依赖于一组内部记忆变量 $\\boldsymbol{\\xi}$，表示为 $$S = \\mathcal{G}(p_c; \\boldsymbol{\\xi})$$ 或 $$p_c = \\mathcal{H}(S; \\boldsymbol{\\xi})$$。\n    2. **回归点记忆 (RPM)**：重新穿过先前的反转状态会抹去中间滞回路径的记忆。\n    3. **非负环路耗散**：任何闭合循环中耗散的能量必须为非负，即 $$\\oint p_c \\, \\mathrm{d} S \\ge 0$$。\n    4. **物理边界**：扫描曲线必须位于主湿润和主干燥曲线之间：$$p_c^{\\mathrm{wet}}(S) \\le p_c^{\\mathrm{scan}}(S) \\le p_c^{\\mathrm{dry}}(S)$$。\n- **数值背景**：该模型将在一个使用隐式时间积分器和 Newton–Raphson 迭代的有限元法 (FEM) 代码中实现。这需要一个鲁棒的内部变量更新策略和一个用于雅可比矩阵的一致切线。\n- **过程指示器**：湿润对应于 $\\dot{p}_c  0$（$S$ 增加），干燥对应于 $\\dot{p}_c  0$（$S$ 减少）。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：问题陈述牢固地基于多孔介质物理学（Richards 方程）和含记忆材料热力学的既定原理。$p_c-S$ 关系中的滞回是土壤科学和水文学中有据可查且至关重要的现象。所列出的属性（RPM、非负耗散、边界性）是物理上有意义的滞回模型的标准、严格要求。\n- **适定性**：问题是适定的。它要求根据一套清晰的物理和数值标准，从一组选项中确定一个用于实现滞回本构律的正确算法和概念框架。\n- **客观性**：语言技术性强、精确且客观，使用了计算力学和水文学的标准术语。\n\n验证清单未发现任何缺陷。该问题在科学上是合理的、可形式化的、完整的且结构良好。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将通过对照既定原则分析所提出的选项来推导解决方案。\n\n### 推导与选项分析\n\n问题的核心是确定一种用于数值模拟毛细管压力-饱和度滞回的正确算法，该算法需与物理定律一致，并适用于基于 Newton-Raphson 的有限元求解器。关键要求包括一个用于存储路径历史（记忆）的数据结构、一个强制实现回归点记忆 (RPM) 的更新规则，以及一种为迭代求解器计算一致切线导数的方法。已知两大类模型，即扫描曲线模型和 Preisach 模型，可以满足这些要求。我们在此背景下评估每个选项。\n\n**选项A分析**\n此选项描述了一个经典的扫描曲线模型。\n- **内部状态变量**：一个反转点堆栈 $$\\{(p_c^{(k)}, S^{(k)})\\}_{k=1}^{N}$$ 和一个分支指示器 $$\\beta$$。这种数据结构是专门为存储加载路径中转折点的历史而设计的。\n- **算法更新**：在反转时（$\\dot{p}_c$ 的符号改变），当前状态被压入堆栈。这正确地更新了系统的记忆。活动曲线是由堆栈上最新反转点参数化的扫描曲线。\n- **回归点记忆 (RPM)**：指令“如果轨迹重新进入先前的反转点，则弹出堆栈以恢复该状态”是 RPM 的精确算法实现。它正确地指定了应擦除所包含子环的记忆。\n- **一致切线**：要求从当前活动的扫描曲线计算 $$\\frac{\\partial p_c}{\\partial S}$$，为 Newton–Raphson 方法的二次收敛提供了所需的一致切线。\n- **物理约束**：该选项正确地指出，所选的扫描曲线模型必须满足物理边界和非负耗散条件。\n此选项提供了对一个正确且鲁棒的扫描曲线滞回模型实现的教科书式描述。\n**结论：正确**\n\n**选项B分析**\n此选项提出了一个大大简化的模型。\n- **内部状态变量**：只有一个分支指示器 $$\\beta$$。\n- **算法更新**：该模型只跟踪过程的当前方向（湿润/干燥），并使用相应的主曲线（$$p_c^{\\mathrm{wet}}(S)$$ 或 $$p_c^{\\mathrm{dry}}(S)$$）。它不存储关于过去反转点的任何信息。\n- **回归点记忆 (RPM)**：由于没有过去反转点的记忆，该模型无法表现出扫描曲线或满足 RPM。任何反转只会导致从一条主曲线跳到另一条。这对于主滞回包线内的子环来说在物理上是不准确的。\n这个模型过于简单，无法捕捉滞回的基本物理特性。\n**结论：不正确**\n\n**选项C分析**\n此选项描述了一个有缺陷的记忆管理方案。\n- **内部状态变量**：它建议存储反转点，但规则是“从不移除较早的点”。\n- **回归点记忆 (RPM)**：在重新穿过反转点时不移除（或“弹出”）它们，这明确违反了 RPM 原则。内部子环的记忆没有被擦除，如果加载路径继续沿先前的分支行进，将导致不符合物理的行为。系统的记忆将无界且不正确地增长。\n- **扫描曲线构造**：线性插值是构造扫描曲线的一种可能方法，尽管通常过于简单。然而，根本的缺陷在于记忆更新规则。\n该模型的记忆管理不正确，并违反了一个关键的物理要求。\n**结论：不正确**\n\n**选项D分析**\n此选项提出了一个基于单个标量内部变量的模型。\n- **内部状态变量**：一个标量累积指数 $$m(t) = \\int_{0}^{t} \\phi(\\dot{S}(\\tau)) \\, \\mathrm{d} \\tau$$。\n- **回归点记忆 (RPM)**：单个标量变量不足以捕捉 RPM 所需的复杂路径历史。RPM 需要了解反转点（$p_c$ 或 $S$ 的极值）的具体序列。不同的加载历史，特别是那些涉及返回到先前状态的子环，无法通过像 $$m(t)$$ 这样的单个积分量来唯一区分。因此，该模型无法保证它会正确返回到先前的状态。这种形式的模型被称为非局部模型，通常不满足 RPM。\n该模型缺乏正确表示滞回所需的必要状态信息。\n**结论：不正确**\n\n**选项E分析**\n此选项描述了滞回的 Preisach 模型。\n- **内部状态变量**：记忆由 Preisach 平面（$(\\alpha, \\beta)$-平面）中的边界线 $$\\Gamma(t)$$ 表示，该边界线分隔“开”和“关”的基本滞回算子（继电器）。这个边界是一个包含主要输入极值完整历史的函数。\n- **算法更新**：$$\\Gamma(t)$$ 的更新规则（输入 $p_c$ 增加时移动水平段，减少时移动垂直段）是 Preisach 模型的标准、正确的几何解释。\n- **回归点记忆 (RPM)**：Preisach 模型的几何更新规则内在地满足 RPM。当输入完成一个子环并返回到反转点时，边界 $$\\Gamma(t)$$ 会精确地返回到子环之前的配置，从而正确地清除该路径的记忆。\n- **物理约束**：它正确地指出，非负密度函数 $$\\mu(\\alpha, \\beta) \\ge 0$$ 是确保非负耗散（$$\\oint p_c \\, \\mathrm{d} S \\ge 0$$）的充分条件。该模型通过对主曲线的校准来定义，这确保了边界属性。\n- **一致切线**：使用 Preisach 算子的 Fréchet 导数是为 Newton–Raphson 方案获得一致切线的数学上严谨的方法。\n此选项提供了对 Preisach 模型的正确和完整的描述，它是扫描曲线模型的一个有效且强大的替代方案。\n**结论：正确**\n\n**结论**\n选项A和选项E都描述了在 Richards 方程背景下实现滞回的有效、物理一致且数值鲁棒的框架。问题陈述明确允许使用扫描曲线模型（在A中描述）或 Preisach 算子模型（在E中描述）。两个选项都正确地指出了它们各自模型类别所需的的状态变量和算法过程。选项B、C和D在记忆表示和回归点记忆的强制实现方面存在根本性缺陷。因此，A和E都是正确答案。", "answer": "$$\\boxed{AE}$$", "id": "3557254"}]}