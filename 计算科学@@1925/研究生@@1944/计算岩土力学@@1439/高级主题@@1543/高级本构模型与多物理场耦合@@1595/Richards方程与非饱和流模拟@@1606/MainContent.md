## 引言
在地球科学与工程的广阔领域中，从农业灌溉、地下水补给到[边坡稳定性](@entry_id:190607)和[污染物迁移](@entry_id:165650)，无数关键过程都受控于一个共同的物理现象：非饱和[多孔介质中的流体流动](@entry_id:749470)。与饱和介质中相对简单的流动不同，非饱和区的流体行为极其复杂，其导水能力和储水特性会随含水量的变化而发生数个[数量级](@entry_id:264888)的剧烈改变。准确描述并预测这一动态过程，是理解和管理我们水土资源的核心挑战。

本文旨在系统性地剖析用于应对这一挑战的基石理论——[理查兹方程](@entry_id:754356)。我们将超越简单的公式罗列，深入其物理内涵、数学特性和数值求解的复杂性。文章旨在填补基础理论与高级应用之间的知识鸿沟，使读者不仅理解方程“是什么”，更能掌握“如何用”以及“为何这样用”。

为实现这一目标，本文将分为三个核心章节。在“原理与机制”一章中，我们将从第一性原理出发，推导[理查兹方程](@entry_id:754356)，并详细阐述其求解所依赖的关键[本构关系](@entry_id:186508)（如[van Genuchten模型](@entry_id:756414)），同时分析其固有的[非线性](@entry_id:637147)和数值刚度等挑战。接下来，在“应用与交叉学科联系”一章中，我们将展示该理论的强大生命力，通过一系列实例，探讨如何利用和扩展[理查兹方程](@entry_id:754356)来解决从地表-大气交换、非均质介质流动到土-水-力耦合和生物组织灌注等多样化的实际问题。最后，“动手实践”部分将提供一系列精心设计的问题，旨在将理论知识转化为解决实际工程问题的计算技能。通过这一结构化的学习路径，读者将能够建立起对[非饱和流](@entry_id:756345)模拟的全面而深刻的理解。

## 原理与机制

本章旨在深入阐述控制非饱和[多孔介质](@entry_id:154591)中流体流动的基本物理原理，并详细介绍用于描述和模拟这些过程的数学模型和机制。我们将从质量守恒和流体运动定律出发，推导出[理查兹方程](@entry_id:754356)，进而探讨其求解所需的关键[本构关系](@entry_id:186508)，分析方程的数学特性，并讨论在[计算模型](@entry_id:152639)中实现这些原理所需的高级数值策略。

### [非饱和流](@entry_id:756345)动的基本方程

对[非饱和流](@entry_id:756345)动的精确描述始于对驱动[流体运动](@entry_id:182721)的[能量势](@entry_id:748988)以及流体通量与该势之间关系的正确表述。

#### [水头](@entry_id:750444)与[势能](@entry_id:748988)

在[多孔介质](@entry_id:154591)[水文学](@entry_id:186250)中，[流体运动](@entry_id:182721)的驱动力通常用**[水头](@entry_id:750444) (head)** 来量化，它代表了单位重量流体的[机械能](@entry_id:162989)。总[水头](@entry_id:750444) $h$ 由两个主要部分组成：高程水头和压力水头。

**高程[水头](@entry_id:750444) (gravitational head)**，记为 $z$，代表了流体因其在重[力场](@entry_id:147325)中的位置而具有的[势能](@entry_id:748988)。通常，我们设定一个基准面，并以向上为正方向来度量高程 $z$。因此，高程水头直接等于该点的高程坐标。

**压力水头 (pressure head)**，记为 $\psi$，代表了[流体压力](@entry_id:142203)所做的功或流能量。在[非饱和土](@entry_id:756348)壤中，水相的压力 $p_w$ 通常低于周围气相的压力（通常为大[气压](@entry_id:140697) $p_a$）。这种压力差 $p_w - p_a$ 称为[基质吸力](@entry_id:751740)或张力。压力水头定义为这个压力差除以水的单位重量 $\rho_w g$，其中 $\rho_w$ 是水的密度，$g$ 是[重力加速度](@entry_id:173411)。

$$ \psi = \frac{p_w - p_a}{\rho_w g} $$

在非饱和条件下，$p_w  p_a$，因此压力水头 $\psi$ 为负值。这个负的压力水头通常被称为**基质势 (matric potential)** 或 **吸力水头 (suction head)**。

**总水头 (total head)** $h$ 便是这两部分之和，代表了单位重量流体的[总机械能](@entry_id:167353)（忽略了通常可忽略不计的动能项）：[@problem_id:3557186]

$$ h = \psi + z $$

流体总是从总[水头](@entry_id:750444)高的区域流向总水头低的区域。

#### 达西-白金汉定律与流速关系

亨利·达西 (Henry Darcy) 的实验定律描述了饱和[多孔介质](@entry_id:154591)中的流动。白金汉 (Buckingham) 将其推广至非饱和介质，形成了**达西-白金汉定律 (Darcy-Buckingham law)**。该定律指出，单位[横截面](@entry_id:154995)积的[体积流率](@entry_id:265771)，即**[达西流](@entry_id:748165)速 (Darcy flux)** 或称比流量 $\mathbf{q}$，与总水头的梯度 $\nabla h$ 成正比。

$$ \mathbf{q} = -K \nabla h = -K(\psi) \nabla(\psi + z) $$

这里的比例系数 $K$ 是**[水力传导](@entry_id:165048)率 (hydraulic conductivity)**。在非饱和介质中，[水力传导](@entry_id:165048)率不是一个常数，而是压力水头 $\psi$（或等效地，含水量）的强函数，记为 $K(\psi)$。负号表示流动方向与水头增加最快的方向相反，即顺着水头梯度下降的方向。

需要注意的是，[达西流](@entry_id:748165)速 $\mathbf{q}$ 是一个[表观速度](@entry_id:152020)，它被定义为通过介质总[横截面](@entry_id:154995)积（包括固体和孔隙）的流量。而水分子在孔隙中实际流动的平均速度，即**平均孔隙水速 (average pore water velocity)** $\mathbf{v}_w$，则要快得多。这两者之间的关系取决于可供水流动的实际[截面](@entry_id:154995)积。在一个孔隙度为 $\phi$、水饱和度为 $S_w$ 的介质中，水所占的体积份数为 $\theta = \phi S_w$，水流动的有效[截面](@entry_id:154995)积与总面积之比也为 $\phi S_w$。因此，二者的关系为：[@problem_id:3557186]

$$ \mathbf{v}_w = \frac{\mathbf{q}}{\phi S_w} $$

由于 $\phi S_w \le 1$，平均孔隙水速的大小总是大于或等于[达西流](@entry_id:748165)速的大小。这个关系在分析[溶质运移](@entry_id:755044)等问题时至关重要。

#### [质量守恒](@entry_id:204015)与[理查兹方程](@entry_id:754356)

描述[非饱和流](@entry_id:756345)动的控制方程源于[质量守恒](@entry_id:204015)原理。对于一个固定的[控制体](@entry_id:143882)，水的质量变化率必须等于进出该控制体的净通量，加上内部源或汇的贡献。对于不可压缩的流体（密度 $\rho_w$ 恒定）和不变形的介质，[质量守恒](@entry_id:204015)可以表示为[体积守恒](@entry_id:276587)：

$$ \frac{\partial \theta}{\partial t} + \nabla \cdot \mathbf{q} + S = 0 $$

其中 $\theta$ 是**体积含水量 (volumetric water content)**（单位体积介质中水的体积），$t$ 是时间，$\nabla \cdot \mathbf{q}$ 是[达西流](@entry_id:748165)速的散度（代表单位体积的净流出率），$S$ 是单位体积的源汇项（正值代表汇，如植物[根系](@entry_id:198970)吸水）。

将达西-白金汉定律代入上述[质量守恒](@entry_id:204015)方程，即可得到非饱和带流动的通用控制方程，即**[理查兹方程](@entry_id:754356) (Richards' equation)**：

$$ \frac{\partial \theta}{\partial t} = \nabla \cdot [K(\psi) \nabla(\psi + z)] - S $$

这个方程是[非线性](@entry_id:637147)的，因为其中的两个关键参数——体积含水量 $\theta$ 和[水力传导](@entry_id:165048)率 $K$——都依赖于求解变量 $\psi$。为了求解该方程，我们必须提供这两个参数与 $\psi$ 之间的具体函数关系，即本构关系。

### 本构关系

[理查兹方程](@entry_id:754356)的求解需要两个核心的[本构关系](@entry_id:186508)来“闭合”方程：描述水储存特性的**土壤-水[特征曲线](@entry_id:175176) (Soil-Water Characteristic Curve, SWCC)**，也称为**持水曲线 (Water Retention Curve, WRC)**，即 $\theta(\psi)$ 的关系；以及描述水传输特性的**非饱和[水力传导](@entry_id:165048)函数 (Unsaturated Hydraulic Conductivity Function)**，即 $K(\psi)$ 的关系。

#### 有效饱和度的核心作用

在建立这些[本构关系](@entry_id:186508)时，引入一个[标准化](@entry_id:637219)的无量纲变量——**有效饱和度 (effective saturation)** $S_e$——是非常有益的。土壤中的水并非都能[自由流](@entry_id:159506)动；一部分水被强力吸附在土粒表面或被困在极小的孔隙中，这部分水在常见的水力梯度下被认为是不可移动的，其对应的体积含水量称为**残余含水量 (residual water content)** $\theta_r$。水的最大体积含量是**饱和含水量 (saturated water content)** $\theta_s$（在刚性介质中通常等于孔隙度 $\phi$）。

因此，介质中可参与流动的水的体积份数范围是 $[\theta_r, \theta_s]$。有效饱和度 $S_e$ 被定义为当前可移动水量 ($\theta - \theta_r$) 与最大可能可移动水量 ($\theta_s - \theta_r$) 的比值：

$$ S_e = \frac{\theta - \theta_r}{\theta_s - \theta_r} $$

$S_e$ 的取值范围为 $[0, 1]$，它代表了“有效”孔隙空间被水填充的比例。这个变量之所以核心，是因为它提供了一个物理意义明确的平台，用以统一描述水的储存和传导行为。许多理论模型，如 Mualem 模型，都假设相对[水力传导](@entry_id:165048)率是 $S_e$ 的函数。通过 SWCC 建立 $\psi \to S_e$ 的关系，再通过传导率模型建立 $S_e \to K$ 的关系，就构建了完整的 $\psi \to K$ 的本构链条。[@problem_id:3557188]

#### 常用持[水模型](@entry_id:171414)

描述 $\theta(\psi)$ 或 $S_e(\psi)$ 关系的模型有多种，其中最著名的是 van Genuchten 模型和 Brooks-Corey 模型。

##### van Genuchten 模型

van Genuchten (1980) 提出的模型因其光滑的函数形式和与传导率模型的良好兼容性而得到广泛应用。其表达式为：[@problem_id:3557194]

$$ S_e(\psi) = \frac{\theta(\psi) - \theta_r}{\theta_s - \theta_r} = \left[ 1 + (|\alpha \psi|)^n \right]^{-m} \quad (\psi  0) $$

该模型包含四个参数：$\theta_r$、$\theta_s$、$\alpha$ 和 $n$（$m$ 通常与 $n$ 相关）。
-   $\theta_r$ 和 $\theta_s$ 分别是残余和饱和含水量，定义了含水量的范围。
-   参数 $\alpha$ 的单位是长度的倒数 ($L^{-1}$)，它与土壤的**进气值 (air-entry value)** 相关。$1/|\alpha|$ 可被视为一个特征吸力水头，标志着土壤开始显著脱水的吸力范围。$\alpha$ 值越大，土壤在越低的吸力下开始排水，通常对应于孔隙较大的粗粒土。
-   参数 $n$ 是一个无量纲的形状参数，与孔隙大小[分布](@entry_id:182848)的[均匀性](@entry_id:152612)有关。$n$ 值越大，孔隙大小[分布](@entry_id:182848)越均匀，持水曲线的过渡段越陡峭。
-   参数 $m$ 通常与 $n$ 关联，最常见的关系是 $m=1-1/n$ (for $n1$)，这个约束在与 Mualem [水力传导](@entry_id:165048)率模型结合时，可以得到解析解。

##### Brooks-Corey 模型

Brooks-Corey (1964) 模型是另一个经典模型，其特点是具有一个明确的**进气吸力水头 (air-entry suction head)** $\psi_b$。

$$ S_e(\psi) = \begin{cases} 1  \text{for } |\psi| \le |\psi_b| \\ (|\psi_b|/|\psi|)^\lambda  \text{for } |\psi|  |\psi_b| \end{cases} $$

-   $\psi_b$ 是一个阈值。当吸力小于等于这个值时，[土壤保持](@entry_id:199173)饱和。一旦吸力超过 $\psi_b$，含水量开始按[幂律](@entry_id:143404)形式下降。
-   $\lambda$ 是一个[无量纲参数](@entry_id:169335)，类似于 van Genuchten 模型中的 $n$，反映了孔隙大小[分布](@entry_id:182848)的特征。

与 van Genuchten 模型光滑的过渡曲线不同，Brooks-Corey 模型在 $\psi = \psi_b$ 处存在一个“拐点”，导致其导数不连续。这种特性使得它在模拟中会产生一个非常尖锐、类似活[塞流](@entry_id:151327)的湿润锋，而 van Genuchten 模型由于其平滑的特性，通常会产生一个相对更弥散的湿润锋。[@problem_id:3557251]

#### 非饱和[水力传导](@entry_id:165048)率的预测

直接测量非饱和[水力传导](@entry_id:165048)率 $K(\psi)$ 非常困难。因此，发展了许多基于更易测量的 SWCC 来预测 $K(\psi)$ 的模型。Mualem (1976) 模型是其中最成功和最常用的一个。

Mualem 模型基于孔隙网络的统计概念，它假设相对[水力传导](@entry_id:165048)率 $k_r = K/K_s$（其中 $K_s$ 是饱和[水力传导](@entry_id:165048)率）可以从 SWCC 曲线的形状推导出来。其通用表达式涉及一个积分：

$$ k_r(S_e) = S_e^{\ell} \left[ \frac{\int_0^{S_e} \frac{1}{|\psi(x)|} dx}{\int_0^1 \frac{1}{|\psi(x)|} dx} \right]^2 $$

-   参数 $\ell$ 是一个经验性的**孔隙连通性-迂曲度参数 (pore-connectivity and tortuosity parameter)**，它修正了模型以考虑水在部分饱和孔隙中流动的额外阻力。$\ell$ 的常见取值为 $0.5$，代表了对孔隙网络中水流路径的平均统计效应。[@problem_id:3557230]

当将 van Genuchten 的 SWCC 表达式代入 Mualem 模型的积[分时](@entry_id:274419)，通常无法得到解析解。然而，van Genuchten 发现，如果施加 $m=1-1/n$ 的约束，该积分便可以解析地求出，得到一个简洁的闭合形式表达式：[@problem_id:3557194]

$$ k_r(S_e) = S_e^{\ell} \left[ 1 - (1 - S_e^{1/m})^m \right]^2 $$

这种 van Genuchten-Mualem (VGM) 耦合模型因其数学上的便利性和在多种土壤中的良好表现而成为[非饱和流](@entry_id:756345)模拟中的标准配置。

### 控制方程的分析

深入理解[理查兹方程](@entry_id:754356)的数学和物理特性对于其数值求解至关重要。

#### 比水容量与[水力扩散率](@entry_id:750440)

在分析[瞬态流](@entry_id:756109)动时，两个关键的派生参数是比水容量和[水力扩散率](@entry_id:750440)。

**比水容量 (specific moisture capacity)**，记为 $C(\psi)$，定义为体积含水量随[压力水头](@entry_id:141368)的变化率：

$$ C(\psi) = \frac{d\theta}{d\psi} $$

$C(\psi)$ 的物理意义是**增量储水系数 (incremental storage coefficient)**：它表示当[压力水头](@entry_id:141368)发生单位变化时，单位体积土壤中储存的水量会发生多大的变化。它实质上是 SWCC [曲线的斜率](@entry_id:178976)。由于 $\theta(\psi)$ 通常是S形曲线， $C(\psi)$ 在近[饱和区](@entry_id:262273)和残余区很小，而在土壤开始大量脱水的过渡区（即进气区附近）会呈现一个尖锐的峰值。$C(\psi)$ 的单位是长度的倒数 ($L^{-1}$)。[@problem_id:3557227]

**[水力扩散率](@entry_id:750440) (hydraulic diffusivity)**，记为 $D(\psi)$，定义为[水力传导](@entry_id:165048)率与比水容量的比值：

$$ D(\psi) = \frac{K(\psi)}{C(\psi)} $$

如果忽略重力项，[理查兹方程](@entry_id:754356)可以写成一个[扩散](@entry_id:141445)型方程：$\frac{\partial \psi}{\partial t} \approx \nabla \cdot (D(\psi) \nabla \psi)$。因此，$D(\psi)$ 控制着[压力水头](@entry_id:141368)扰动的传播和消散速率。$D$ 值大的区域，压力梯度会迅速“抹平”，导致弥散的锋面；$D$ 值小的区域，则有利于维持尖锐的锋面。有趣的是，在近饱和区，$K(\psi)$ 很大而 $C(\psi)$ 趋于零，导致 $D(\psi)$ 变得极大。这解释了为什么湿润锋的饱和部分传播得非常快。[@problem_id:3557251]

#### [理查兹方程](@entry_id:754356)的形式

[理查兹方程](@entry_id:754356)可以根据主要求解变量的不同，写成几种不同的形式。最常见的两种是**[水头](@entry_id:750444)形式 (head-based form)** 和 **混合形式 (mixed form)**。[@problem_id:3557200]

利用[链式法则](@entry_id:190743) $\frac{\partial \theta}{\partial t} = \frac{d\theta}{d\psi} \frac{\partial \psi}{\partial t} = C(\psi) \frac{\partial \psi}{\partial t}$，我们可以将[理查兹方程](@entry_id:754356)完全用压力水头 $\psi$ 来表达，得到[水头](@entry_id:750444)形式：

$$ C(\psi) \frac{\partial \psi}{\partial t} = \nabla \cdot [K(\psi) \nabla(\psi + z)] - S $$

而保留时间导数项为 $\frac{\partial \theta}{\partial t}$ 的形式，则被称为混合形式，因为它同时包含了 $\theta$ 和 $\psi$ 两个变量：

$$ \frac{\partial \theta}{\partial t} = \nabla \cdot [K(\psi) \nabla(\psi + z)] - S $$

这两种形式在数学上是等价的，但在数值求解中却有显著差异。
-   **混合形式**在离散化后能更好地保证**[质量守恒](@entry_id:204015)**。因为它直接计算了每个控制体内含水量的变化，这对于精确追踪急剧变化的湿润锋至关重要。
-   **水头形式**的主要问题是**退化 (degeneracy)**。在非常干燥的区域，$\theta$ 趋于常数 $\theta_r$，导致 $C(\psi) = d\theta/d\psi \to 0$。这使得方程的时间导数项消失，方程从抛物线型退化为椭圆型，给数值求解带来极大的稳定性和收敛性困难。
-   因此，对于涉及干湿剧烈变化的问题，**混合形式**通常是更稳健和首选的数值方法。而在近饱和、性质变化平缓的区域，[水头](@entry_id:750444)形式也可以有效使用。[@problem_id:3557200, @problem_id:3557227]

#### [非线性](@entry_id:637147)与刚度

[理查兹方程](@entry_id:754356)的强[非线性](@entry_id:637147)（$C$ 和 $K$ 随 $\psi$ 变化数个[数量级](@entry_id:264888)）和不同区域动态响应的巨大差异（由 $D(\psi)$ 控制）导致了数值上的**刚度 (stiffness)**。在空间离散后，[理查兹方程](@entry_id:754356)会转化为一个[常微分方程(ODE)](@entry_id:162988)组。系统中不同空间位置的特征响应时间尺度 $\tau \sim \ell^2 C(\psi)/K(\psi)$ (其中 $\ell$ 是[特征长度](@entry_id:265857)) 可能相差巨大。例如，湿润区响应快，干燥区响应慢。这种时间尺度的巨大差异使得 ODE 系统成为“刚性”系统，对[显式时间积分](@entry_id:165797)格式的稳定性步长提出了极为苛刻的限制，因此必须采用[隐式时间积分](@entry_id:171761)方法。这种刚性也体现在隐式求解的[雅可比矩阵](@entry_id:264467)中，导致其条件数非常大，给线性方程组的求解带来了挑战。[@problem_id:3557227]

### 高级建模专题

#### 滞回现象

在许多土壤中，SWCC 并不是唯一的，而是依赖于其润湿和干燥的历史。这种现象称为**滞回 (hysteresis)**。通常，在相同的吸力水头 $\psi$ 下，干燥过程中土壤的含水量要高于润湿过程中的含水量。这种现象的物理原因主要有二：一是孔隙几何形状不规则（所谓的“[墨水瓶效应](@entry_id:750657)”），导致排水时空气进入孔隙所需的压力大于润湿时水进入孔隙所需的压力；二是固液接触角在前进和后退时存在差异。

#### 滞回模型

模拟滞回现象需要在主干燥曲线 $\theta_d(\psi)$ 和主[润湿](@entry_id:147044)曲线 $\theta_w(\psi)$ 之间引入**扫描曲线 (scanning curves)**。当[润湿](@entry_id:147044)/干燥过程发生逆转时，状态点 $(\psi, \theta)$ 会离开原来的曲线，沿着一条新的扫描曲线移动。一个有效且常用的滞回模型框架是基于对[主曲线](@entry_id:161549)的缩放。[@problem_id:3557187]

例如，当状态点从主干燥曲线上的某点 $(\psi_r, \theta(\psi_r))$ 开始转为[润湿](@entry_id:147044)时，可以定义一条润湿扫描曲线。这条曲线通过该逆转点，并最终在 $\psi \to 0$ 时与主[润湿](@entry_id:147044)曲线汇合。一种常见的实现方式是，将扫描曲线表示为主润湿曲线和主干燥曲线的加权平均：

$$ S_e(\psi) = (1-\xi) S_{e,w}(\psi) + \xi S_{e,d}(\psi) $$

其中 $S_{e,w}$ 和 $S_{e,d}$ 分别是主润湿和主干燥曲线对应的有效饱和度。权重因子 $\xi$ 在逆转点 $\psi_r$ 处计算并保持不变，以确保扫描曲线通过该点：

$$ \xi = \frac{S_e(\psi_r) - S_{e,w}(\psi_r)}{S_{e,d}(\psi_r) - S_{e,w}(\psi_r)} $$

这种模型确保了在逆转点处含水量的连续性，并且扫描曲线始终被[主曲线](@entry_id:161549)所包围。在[数值模拟](@entry_id:137087)中，必须根据当前所处的曲线（[主曲线](@entry_id:161549)或某条扫描曲线）来计算相应的比水容量 $C(\psi)$，即对当前激活的 $\theta(\psi)$ 关系求导。

### 数值求解策略

求解[理查兹方程](@entry_id:754356)的离散形式，需要在每个时间步内求解一个大型[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组 $\mathbf{R}(\boldsymbol{\psi}) = 0$。

#### [非线性求解器](@entry_id:177708)

两种经典的迭代方法是 Picard 法和 Newton 法。[@problem_id:3557213]

-   **Picard [迭代法](@entry_id:194857)**：这是一种简单的[定点迭代法](@entry_id:168837)。在第 $k+1$ 次迭代中，[非线性](@entry_id:637147)系数 $C(\psi)$ 和 $K(\psi)$ 使用上一步迭代 $k$ 的结果 $\boldsymbol{\psi}^k$ 来计算，从而将原问题转化为一个易于求解的[线性方程组](@entry_id:148943)。这种方法的优点是**稳健性**。其[迭代矩阵](@entry_id:637346)通常具有良好的性质（如 [M-矩阵](@entry_id:189121)特性），有助于抑制非物理[振荡](@entry_id:267781)，尤其是在初始猜测较差时。然而，其[收敛速度](@entry_id:636873)通常是线性的，对于强[非线性](@entry_id:637147)问题可能需要很多次迭代。

-   **Newton 法** (或 [Newton-Raphson](@entry_id:177436) 法)：此方法通过对残差方程 $\mathbf{R}(\boldsymbol{\psi})$ 进行一阶[泰勒展开](@entry_id:145057)来求解。在每次迭代中，需要求解一个线性系统 $\mathbf{J}(\boldsymbol{\psi}^k) \delta \boldsymbol{\psi} = -\mathbf{R}(\boldsymbol{\psi}^k)$，其中 $\mathbf{J} = \partial \mathbf{R} / \partial \boldsymbol{\psi}$ 是[雅可比矩阵](@entry_id:264467)。Newton 法的巨大优势在于，当初始猜测足够接近真解时，它具有**二次收敛**速度，非常高效。然而，它的[收敛域](@entry_id:269722)较小。对于强[非线性](@entry_id:637147)问题或较差的初始猜测，完整的 Newton 步长 $\delta \boldsymbol{\psi}$ 可能过大，导致迭代发散或产生非物理结果（如负含水量）。

为了结合 Newton 法的快速收敛和 Picard 法的稳健性，通常需要对 Newton 法进行“全局化”处理，例如采用**阻尼 (damping)** 或 **线搜索 (line search)** 策略。这些策略通过引入一个步长因子 $\alpha \in (0,1]$ 来缩短 Newton 步，即 $\boldsymbol{\psi}^{k+1} = \boldsymbol{\psi}^k + \alpha \delta \boldsymbol{\psi}$，以确保每次迭代都能充分降低[残差范数](@entry_id:754273)或维持解的物理有效性。

#### [自适应时间步长](@entry_id:261403)

由于[非饱和流](@entry_id:756345)动过程的动态性（例如，降雨入渗初期的快速变化和后期缓慢的再[分布](@entry_id:182848)），使用固定的时间步长 $\Delta t$ 往往效率低下。一个理想的算法应该能够在过程变化剧烈时自动采用小步长，而在变化平缓时采用大步长。这就是**[自适应时间步长](@entry_id:261403) (adaptive time-stepping)** 算法。

一个先进的[自适应时间步长](@entry_id:261403)控制器通常综合考虑两个方面的信息：[@problem_id:3557190]

1.  **时间离散[误差控制](@entry_id:169753)**：通过使用嵌入式的[时间积分方法](@entry_id:136323)（如嵌入式 Runge-Kutta 法），可以得到每个时间步的**[局部截断误差](@entry_id:147703) (local truncation error)** 的估计值 $\hat{e}$。根据该误差与用户设定的容差 $\tau$ 的比较，可以预测下一个满足精度要求的步长。对于一个 $p$ 阶的积分方法，新的建议步长 $\Delta t_{new}$ 与当前步长 $\Delta t$ 的关系约为：
    $$ \Delta t_{new} \approx \Delta t \left( \frac{\tau}{|\hat{e}|} \right)^{1/(p+1)} $$

2.  **[非线性求解器](@entry_id:177708)性能控制**：每个时间步内 Newton 法的迭代次数 $n_{it}$ 是问题[非线性](@entry_id:637147)程度的直接反映。如果迭代次数过多，说明时间步长可能太大了。可以设定一个目标迭代次数 $n_{target}$，并根据实际迭代次数来调整步长，例如：
    $$ \Delta t_{new} \approx \Delta t \left( \frac{n_{target}}{n_{it}} \right)^{\alpha} $$
    其中 $\alpha$ 是一个[控制器增益](@entry_id:262009)系数。

一个完整的[自适应算法](@entry_id:142170)会结合这两个标准，取它们建议的步长中的较小值，并设置步长的上下限。如果一个时间步因误差超限或求解器不收敛而失败，算法会拒绝该步，用一个更小的步长重试。这种智能控制策略是高效、准确、稳健地求解[理查兹方程](@entry_id:754356)等复杂[非线性](@entry_id:637147)问题的关键。