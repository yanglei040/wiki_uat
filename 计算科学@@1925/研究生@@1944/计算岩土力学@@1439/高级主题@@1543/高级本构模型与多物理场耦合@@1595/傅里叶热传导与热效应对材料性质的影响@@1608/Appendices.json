{"hands_on_practices": [{"introduction": "掌握计算岩土力学始于对基本物理学及其数学描述的深刻理解。第一个实践练习将挑战你在一个简单而基础的情景中推导温度分布：具有恒定内部热源的一维稳态热传导 [@problem_id:3525671]。通过从能量守恒和傅里叶定律这些基本原理出发，你将建立控制微分方程并对其进行解析求解，从而加深你对这些物理定律如何转化为预测性数学模型的理解。", "problem": "一个厚度为 $L$ 的均质土层占据区域 $x \\in [0,L]$，其侧向绝热，因此热流严格沿 $x$ 轴一维 ($1$D) 传导。该土壤的导热系数 $k$ 为常数，并承受一个空间均匀的体积生热率 $q$（当向土壤加热时，$q$ 为正值）。该土层处于稳态，其两端温度给定为：$T(0)=T_{0}$ 和 $T(L)=T_{L}$。从局部能量守恒和傅里叶热传导定律出发，推导在这些条件下稳态温度场 $T(x)$（对于 $x \\in [0,L]$）的闭合形式表达式。清晰地陈述推导所需的任何假设。将您的最终答案表示为 $T(x)$ 的单一闭合形式解析表达式。无需进行数值计算。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- 一个厚度为 $L$ 的均质土层占据区域 $x \\in [0,L]$。\n- 热流沿 $x$ 轴一维 ($1$D) 传导（侧向绝热）。\n- 导热系数 $k$ 为常数。\n- 存在一个空间均匀的体积生热率，记为 $q$。\n- 系统处于稳态。\n- 给定边界条件：$T(0)=T_{0}$ 和 $T(L)=T_{L}$。\n- 推导必须从局部能量守恒和傅里叶热传导定律开始。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题是热传递原理的经典应用，特别是带源项的稳态热方程。这是物理学和工程学（包括岩土力学）中的一个基本概念。其前提是科学合理的。\n- **适定性**：该问题描述了一个带有两个指定边界条件（狄利克雷条件）的二阶常微分方程。这种结构确保了存在唯一且稳定的解。\n- **客观性**：该问题使用清晰、精确、标准的数学和物理学术语进行陈述。所有参数（$L, k, q, T_{0}, T_{L}$）都得到了形式化定义。\n- **完备性与一致性**：该问题是自洽的。它提供了推导所需的控制物理定律、域、边界条件和材料属性。没有缺失数据或矛盾约束。\n- **真实性**：这些假设（一维流动、恒定属性、均匀生成）是用于为许多实际情景获得解析解的标准理想化方法，例如埋地电缆或放射性废物罐附近地下的热流。该设置在物理上是合理的。\n\n### 第三步：结论与行动\n该问题是有效的，因为它具有科学依据、适定性、客观性和自洽性。可以并且将会推导出严谨的解。\n\n### 温度场的推导\n\n推导从稳态系统的局部能量守恒原理开始。考虑在域 $x \\in [0,L]$ 内一个长度为 $dx$、横截面积为 $A$ 的微分控制体。在稳态下，能量积累率为零。能量平衡方程为：\n\n（在 $x$ 处传导进入的能量速率） - （在 $x+dx$ 处传导出去的能量速率） + （在控制体内产生的能量速率） = $0$\n\n令 $j(x)$ 为正 $x$ 方向的热通量（单位面积单位时间的能量）。能量平衡可以写成：\n$$A j(x) - A j(x+dx) + q (A \\, dx) = 0$$\n其中 $q$ 是体积生热率。两边同除以体积 $A \\, dx$ 得：\n$$-\\frac{j(x+dx) - j(x)}{dx} + q = 0$$\n取极限 $dx \\to 0$，我们得到一维能量守恒方程的微分形式：\n$$-\\frac{dj}{dx} + q = 0$$\n\n接下来，我们引入傅里叶热传导定律，它将热通量 $j(x)$ 与局部温度梯度 $\\frac{dT}{dx}$ 联系起来：\n$$j(x) = -k \\frac{dT}{dx}$$\n其中 $k$ 是材料的导热系数。负号表示热量沿温度梯度降低的方向流动（从高温到低温）。\n\n将傅里叶定律代入能量守恒方程，得到：\n$$-\\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) + q = 0$$\n$$\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) + q = 0$$\n\n问题陈述中指出导热系数 $k$ 是常数。因此，可以将其从导数中提出：\n$$k \\frac{d^2T}{dx^2} + q = 0$$\n\n这就是控制稳态温度场 $T(x)$ 的二阶常微分方程。我们可以将其重写为：\n$$\\frac{d^2T}{dx^2} = -\\frac{q}{k}$$\n\n为了求得温度分布 $T(x)$，我们将此方程对 $x$ 积分两次。第一次积分得到：\n$$\\frac{dT}{dx} = -\\frac{q}{k}x + C_1$$\n其中 $C_1$ 是第一个积分常数。\n\n第二次积分得到温度场的通解：\n$$T(x) = -\\frac{q}{2k}x^2 + C_1 x + C_2$$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 通过应用给定的边界条件 $T(0) = T_0$ 和 $T(L) = T_L$ 来确定。\n\n在 $x=0$ 处应用第一个边界条件：\n$$T(0) = -\\frac{q}{2k}(0)^2 + C_1(0) + C_2 = T_0$$\n这立即得出 $C_2 = T_0$。\n\n现在解变为：\n$$T(x) = -\\frac{q}{2k}x^2 + C_1 x + T_0$$\n\n在 $x=L$ 处应用第二个边界条件：\n$$T(L) = -\\frac{q}{2k}L^2 + C_1 L + T_0 = T_L$$\n\n现在我们求解常数 $C_1$：\n$$C_1 L = T_L - T_0 + \\frac{qL^2}{2k}$$\n$$C_1 = \\frac{T_L - T_0}{L} + \\frac{qL}{2k}$$\n\n最后，我们将 $C_1$ 和 $C_2$ 的表达式代回 $T(x)$ 的通解中，得到此问题的特解：\n$$T(x) = -\\frac{q}{2k}x^2 + \\left(\\frac{T_L - T_0}{L} + \\frac{qL}{2k}\\right)x + T_0$$\n\n可以重新整理这个表达式以更好地揭示其物理意义。我们可以将不依赖于热生成的项与依赖于热生成的项分开：\n$$T(x) = T_0 + \\left(\\frac{T_L - T_0}{L}\\right)x - \\frac{q}{2k}x^2 + \\frac{qL}{2k}x$$\n将与 $q$ 相关的项组合在一起，得到最终的闭合形式表达式：\n$$T(x) = T_0 + (T_L - T_0)\\frac{x}{L} + \\frac{q}{2k}(Lx - x^2)$$\n该解表明，温度分布是一个线性分布（$q=0$ 时的解）和一个由内部生热引起的抛物线分布的叠加。此推导所需的假设已在问题中明确说明：稳态条件、一维热流和恒定的材料属性（$k$）。", "answer": "$$\\boxed{T_{0} + \\left(T_{L} - T_{0}\\right) \\frac{x}{L} + \\frac{q}{2k} \\left(Lx - x^{2}\\right)}$$", "id": "3525671"}, {"introduction": "真实世界中的材料其属性很少是恒定的。本练习通过考虑导热系数随温度变化的现实情况，引入了关键的真实性层次 [@problem_id:3525681]。你将处理一个非线性边值问题，这需要比线性情况更高级的解析方法。成功推导出该解不仅能提升你的数学技能，还将让你深入洞察材料非线性是如何影响物理响应的。", "problem": "一根长度为 $L$ 的均匀棱柱状岩芯，沿其轴向坐标 $x \\in [0, L]$ 发生一维稳态热传导。岩芯两端保持在固定温度 $T(0) = T_L$ 和 $T(L) = T_R$下，温度单位为开尔文。热导率随温度线性变化，其关系式为 $k(T) = k_0 \\left( 1 + \\beta ( T - T_0 ) \\right)$，其中 $k_0  0$，$\\beta$ 是一个描述材料对温度敏感性的恒定参数，$T_0$ 是一个参考温度。假设没有内部热源，对于 $T_L$ 和 $T_R$ 之间的所有温度，都有 $k(T)  0$，并且 $1 + \\beta ( T_L - T_0 )  0$，以确保稳态温度分布是单调的，且主根是唯一确定的。\n\n从稳态能量守恒和傅里叶热传导定律出发，推导杆内稳态温度分布 $T(x)$ 的闭式解析表达式，该表达式应以 $x$, $L$, $T_L$, $T_R$, $k_0$, $\\beta$ 和 $T_0$ 表示。以单个 $T(x)$ 的解析表达式形式给出最终结果。不要进行任何数值计算或四舍五入。说明为确保表达式在 $x \\in [0, L]$ 上有良好定义所需的任何附加假设。", "solution": "用户希望求解长度为 $L$、热导率随温度变化的一维杆中的稳态温度分布 $T(x)$。\n\n### 步骤 1：问题验证\n\n**提取已知条件：**\n-   **区域：** 长度为 $L$ 的一维杆，轴向坐标 $x \\in [0,L]$。\n-   **状态：** 稳态热传导。\n-   **热源：** 无内部热源。\n-   **边界条件：** $T(0) = T_L$, $T(L) = T_R$。\n-   **材料属性（热导率）：** $k(T) = k_0 \\left( 1 + \\beta ( T - T_0 ) \\right)$，其中 $k_0  0$。\n-   **约束/假设：**\n    1.  对于 $T_L$ 和 $T_R$ 之间的所有温度，均有 $k(T)  0$。\n    2.  $1 + \\beta ( T_L - T_0 )  0$。\n    3.  稳态温度分布是单调的。\n\n**使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题基于热传导的基本原理，即能量守恒和傅里叶热传导定律。热导率随温度线性变化的模型是许多工程和地球科学应用中一种标准且物理上合理的近似。该问题在科学上是合理的。\n-   **适定性：** 该问题是一个带有两个给定狄利克雷边界条件的二阶常微分方程。这构成一个适定的边值问题，预期存在唯一解。所提供的假设，如 $k(T)  0$ 和单调性，确保了解的物理和数学完整性。\n-   **客观性：** 该问题使用精确、无歧义的数学和物理术语进行陈述，不含主观或基于观点的内容。\n\n**结论与行动：**\n该问题是有效的。它是数学物理中的一个标准、适定的问题。我现在开始推导解。\n\n### 步骤 2：解的推导\n\n无内部热源的一维稳态热传导的控制方程源于能量守恒原理，该原理指出热通量 $q$ 沿坐标 $x$ 是恒定的。其微分形式为：\n$$ \\frac{d}{dx}q(x) = 0 $$\n傅里叶热传导定律将热通量与温度梯度联系起来：\n$$ q(x) = -k(T) \\frac{dT}{dx} $$\n结合这两个方程，得到控制常微分方程：\n$$ \\frac{d}{dx} \\left( k(T) \\frac{dT}{dx} \\right) = 0 $$\n对此方程关于 $x$ 积分一次，得到：\n$$ k(T) \\frac{dT}{dx} = C_1 $$\n其中 $C_1$ 是一个积分常数。现在我们可以代入给定的热导率表达式 $k(T) = k_0 \\left( 1 + \\beta ( T - T_0 ) \\right)$：\n$$ k_0 \\left( 1 + \\beta ( T - T_0 ) \\right) \\frac{dT}{dx} = C_1 $$\n这是一个一阶可分离变量微分方程。我们可以分离变量 $T$ 和 $x$：\n$$ k_0 \\left( 1 + \\beta T - \\beta T_0 \\right) dT = C_1 dx $$\n为了求解 $T(x)$，我们对两边进行积分。应用边界条件的一个系统性方法是使用定积分。我们从边界 $x=0$ 积分到任意位置 $x$，这对应于温度从 $T(0)=T_L$ 积分到 $T(x)$：\n$$ \\int_{T_L}^{T(x)} k_0 \\left( 1 + \\beta ( u - T_0 ) \\right) du = \\int_0^x C_1 d\\xi $$\n其中 $u$ 和 $\\xi$ 是积分哑变量。执行积分：\n$$ k_0 \\left[ u + \\beta \\left( \\frac{u^2}{2} - T_0 u \\right) \\right]_{T_L}^{T(x)} = C_1 x $$\n$$ k_0 \\left( \\left[ T(x) + \\frac{\\beta}{2}T(x)^2 - \\beta T_0 T(x) \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] \\right) = C_1 x $$\n为了求出常数 $C_1$，我们在另一个边界 $x=L$ 处（即 $T(L)=T_R$）计算此表达式的值：\n$$ k_0 \\left( \\left[ T_R + \\frac{\\beta}{2}T_R^2 - \\beta T_0 T_R \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] \\right) = C_1 L $$\n求解 $C_1$：\n$$ C_1 = \\frac{k_0}{L} \\left( \\left[ T_R + \\frac{\\beta}{2}T_R^2 - \\beta T_0 T_R \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] \\right) $$\n现在，将此 $C_1$ 的表达式代回到关于一般 $x$ 的方程中，得到：\n$$ k_0 \\left( \\left[ T(x) + \\frac{\\beta}{2}T(x)^2 - \\beta T_0 T(x) \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] \\right) = \\frac{x}{L} k_0 \\left( \\dots \\right) $$\n右边括号中的项与用于定义 $C_1 L$ 的项相同。两边的因子 $k_0$ 消去，剩下：\n$$ \\left[ T(x) + \\frac{\\beta}{2}T(x)^2 - \\beta T_0 T(x) \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] = \\frac{x}{L} \\left( \\left[ T_R + \\frac{\\beta}{2}T_R^2 - \\beta T_0 T_R \\right] - \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] \\right) $$\n这个方程是关于 $T(x)$ 的二次方程。让我们将其整理为标准形式 $aT^2 + bT + c = 0$。\n$$ \\frac{\\beta}{2} T(x)^2 + (1 - \\beta T_0) T(x) - G(x) = 0 $$\n其中 $G(x)$ 是整个右侧加上包含 $T_L$ 的项：\n$$ G(x) = \\left[ T_L + \\frac{\\beta}{2}T_L^2 - \\beta T_0 T_L \\right] + \\frac{x}{L} \\left( \\left[ T_R + \\dots \\right] - \\left[ T_L + \\dots \\right] \\right) $$\n存在一个更优雅的简化方法。让我们重写主方程中括号内的表达式：$T + \\frac{\\beta}{2} T^2 - \\beta T_0 T = \\frac{1}{2\\beta} \\left( 2\\beta T + \\beta^2 T^2 - 2\\beta^2 T_0 T \\right)$。这没有帮助。让我们回到前面。\n表达式 $T + \\frac{\\beta}{2}T^2 - \\beta T_0 T$ 可以与热导率的表达式关联起来。\n$k(T) = k_0(1+\\beta(T-T_0))$。积分 $\\int k(T) dT$ 为 $\\int k_0(1+\\beta(T-T_0))dT = k_0(T + \\frac{\\beta}{2} T^2 - \\beta T_0 T)$。\n我们的方程在 $\\int k(T) dT$ 上是线性的。让我们用一个更简单的表达式来重写方程。\n注意到 $(1+\\beta(T-T_0))^2 = 1 + 2\\beta(T-T_0) + \\beta^2(T-T_0)^2 = 1 + 2\\beta T - 2\\beta T_0 + \\beta^2(T^2-2TT_0+T_0^2)$。这也没有帮助。让我们回到二次方程的形式。\n\n二次方程是：\n$$ \\frac{\\beta}{2} [T(x)]^2 + (1 - \\beta T_0) T(x) - G(x) = 0 $$\n假设 $\\beta \\neq 0$，我们使用二次公式 $T = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $T(x)$：\n$$ T(x) = \\frac{-(1 - \\beta T_0) \\pm \\sqrt{(1 - \\beta T_0)^2 - 4\\left(\\frac{\\beta}{2}\\right)(-G(x))}}{2\\left(\\frac{\\beta}{2}\\right)} $$\n$$ T(x) = \\frac{\\beta T_0 - 1 \\pm \\sqrt{(1 - \\beta T_0)^2 + 2\\beta G(x)}}{\\beta} $$\n让我们分析平方根下的项。定义一个函数 $F(T) = T + \\frac{\\beta}{2}T^2 - \\beta T_0 T$。那么 $G(x) = F(T_L) + \\frac{x}{L}(F(T_R) - F(T_L))$。\n平方根内的宗量是 $S(x) = (1 - \\beta T_0)^2 + 2\\beta G(x)$。\n注意到 $2\\beta F(T) = 2\\beta T + \\beta^2 T^2 - 2\\beta^2 T_0 T$。\n所以，$(1 - \\beta T_0)^2 + 2\\beta F(T) = (1 - 2\\beta T_0 + \\beta^2 T_0^2) + (2\\beta T + \\beta^2 T^2 - 2\\beta^2 T_0 T)$。\n整理后：$(1 + 2\\beta(T-T_0)) + \\beta^2(T^2 - 2TT_0 + T_0^2) = (1+\\beta(T-T_0))^2$。\n这是一个关键的简化。平方根内的宗量不是 $F(T)$ 的线性插值，而是 $(1+\\beta(T-T_0))^2$ 的线性插值。\n$S(x) = (1-\\beta T_0)^2 + 2\\beta\\left[F(T_L)+\\frac{x}{L}(F(T_R)-F(T_L))\\right]$\n$S(x) = \\left[(1-\\beta T_0)^2+2\\beta F(T_L)\\right] + \\frac{x}{L}\\left[((1-\\beta T_0)^2+2\\beta F(T_R)) - ((1-\\beta T_0)^2+2\\beta F(T_L))\\right]$\n$S(x) = (1+\\beta(T_L-T_0))^2 + \\frac{x}{L} \\left[ (1+\\beta(T_R-T_0))^2 - (1+\\beta(T_L-T_0))^2 \\right]$\n因此，$T(x)$ 的表达式为：\n$$ T(x) = \\frac{\\beta T_0 - 1 \\pm \\sqrt{(1+\\beta(T_L-T_0))^2 + \\frac{x}{L} \\left[ (1+\\beta(T_R-T_0))^2 - (1+\\beta(T_L-T_0))^2 \\right]}}{\\beta} $$\n为了选择正确的符号（$\\pm$），我们在一个边界处（例如 $x=0$）检验该解。\n$$ T(0) = \\frac{\\beta T_0 - 1 \\pm \\sqrt{(1+\\beta(T_L-T_0))^2}}{\\beta} = \\frac{\\beta T_0 - 1 \\pm |1+\\beta(T_L-T_0)|}{\\beta} $$\n问题陈述中说明 $1+\\beta(T_L-T_0)0$，所以绝对值可以去掉。\n$$ T(0) = \\frac{\\beta T_0 - 1 \\pm (1+\\beta(T_L-T_0))}{\\beta} $$\n选择“+”号：\n$$ T(0) = \\frac{\\beta T_0 - 1 + 1 + \\beta T_L - \\beta T_0}{\\beta} = \\frac{\\beta T_L}{\\beta} = T_L $$\n这与边界条件相符。“-”号会得出错误的结果。因此，我们必须使用“+”号。\n\n最终表达式在 $\\beta \\neq 0$ 时有效。如果 $\\beta = 0$，$k(T)=k_0$ 为常数。控制方程变为 $k_0 \\frac{d^2T}{dx^2}=0$，其解是众所周知的线性解 $T(x) = T_L + (T_R - T_L)\\frac{x}{L}$。我们推导的表达式在 $\\beta \\to 0$ 的极限下正确地给出了这个结果（这可以通过使用洛必达法则或泰勒级数展开来验证）。\n\n该解不需要超出问题陈述中给出的假设，这些假设足以确保表达式对于所有 $x \\in [0,L]$ 都是实数且良定义的。具体来说，平方根内的宗量是 $x$ 的一个线性函数，在边界处的值为 $(1+\\beta(T_L-T_0))^2 \\ge 0$ 和 $(1+\\beta(T_R-T_0))^2 \\ge 0$。作为两个非负值之间的线性插值，它对于所有 $x \\in [0,L]$ 都是非负的。对于所有中间温度，$k(T)0$ 的假设确保了后一项也为正，因为单调的温度分布意味着 $T(x)$ 总是在 $T_L$ 和 $T_R$ 之间。\n\n最终结果：温度分布 $T(x)$ 由以下表达式给出。", "answer": "$$ \\boxed{ T(x) = T_0 - \\frac{1}{\\beta} + \\frac{1}{\\beta} \\sqrt{ \\left(1 + \\beta(T_L - T_0)\\right)^2 + \\frac{x}{L} \\left[ \\left(1 + \\beta(T_R - T_0)\\right)^2 - \\left(1 + \\beta(T_L - T_0)\\right)^2 \\right] } } $$", "id": "3525681"}, {"introduction": "虽然解析解提供了宝贵的洞察力，但大多数工程问题都需要数值方法。这个综合性实践将指导你开发一个用于求解一般非线性热传导方程的有限元求解器 [@problem_id:3525705]。你将推导隐式牛顿-拉弗森格式的基本要素——残差向量和一致切线刚度矩阵——并在代码中实现它们。此练习是将连续介质力学和数值方法的理论知识转化为强大计算工具的关键一步。", "problem": "考虑一根长度为 $L$ 的一维均匀杆，其空间坐标为 $x \\in [0,L]$。令 $T(x,t)$ 表示以开尔文为单位的绝对温度场。假设遵循以下基本原理：(i) 无机械功输入的连续体中的能量守恒，以及 (ii) Fourier 热传导定律。具体来说，微分控制体的能量平衡意味着内能的变化率等于净传导热流入量加上体积热源。Fourier 定律指出，传导热通量与负温度梯度成正比。在这些假设下，控制方程是具有随温度变化的热导率和比热的非线性热传导方程：\n$$\n\\rho\\,c(T)\\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla\\cdot\\!\\left(k(T)\\,\\nabla T\\right) \\;+\\; Q(x,t)\n$$\n其中 $\\rho$ 是质量密度（单位为 $\\mathrm{kg/m^3}$），$c(T)$ 是比热容（单位为 $\\mathrm{J/(kg\\cdot K)}$），$k(T)$ 是热导率（单位为 $\\mathrm{W/(m\\cdot K)}$），$Q$ 是体积热源（单位为 $\\mathrm{W/m^3}$）。在一维空间中，散度简化为对 $x$ 的偏微分。施加单位为开尔文的 Dirichlet 边界条件 $T(0,t)=T_0$ 和 $T(L,t)=T_L$，并取初始温度场为 $T(x,0)=T^n(x)$。\n\n使用标准的双节点线性有限元基，将域离散为 $N_e$ 个等长单元，得到 $N_n=N_e+1$ 个节点。令 $\\{N_i(x)\\}_{i=1}^{N_n}$ 为全局形函数。使用隐式后向欧拉方法进行时间离散，从时间层 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$，其中 $\\Delta t$ 是以秒为单位的时间步长。将 $t^n$ 时的节点温度表示为 $\\{T_i^n\\}$，$t^{n+1}$ 时的节点温度表示为 $\\{T_i^{n+1}\\}$。推导在 $t^{n+1}$ 时刻进行 Newton 法所需的有限元残差向量 $\\mathbf{R}(\\mathbf{T}^{n+1})$ 和一致雅可比矩阵 $\\mathbf{J}(\\mathbf{T}^{n+1}) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{T}^{n+1}}$。\n\n所需的推导必须从上述控制方程和 Fourier 定律开始，经过弱形式、空间有限元离散化和后向欧拉时间离散化。结果必须明确展示残差分量 $R_i$ 和雅可比矩阵项 $J_{ij}$ 的积分表达式，包括由温度依赖性 $c(T)$ 和 $k(T)$ 通过其对 $T$ 的导数所做的贡献。不要使用简便公式；从所述的基本定律推导每一项。\n\n为进行计算验证，实现一个程序，在初始 Newton 迭代步 $\\mathbf{T}^{n+1,(0)}=\\mathbf{T}^n$ 处，使用每个单元两点高斯求积法，为单个时间步组装残差和一致雅可比矩阵。通过将边界节点的残差替换为 $R_i=T_i^{n+1}-T_{\\text{bc},i}$ 并在这些节点处将雅可比矩阵的对应行替换为单位矩阵的行来施加 Dirichlet 边界条件。然后使用中心差分计算有限差分雅可比矩阵，以数值方式逼近 $\\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{T}^{n+1}}$，并将其与解析组装的一致雅可比矩阵进行比较。\n\n您的程序必须为每个测试案例评估以下三个无量纲指标：\n1. 无量纲残差大小，定义为\n$$\n\\eta_R \\;=\\; \\frac{\\|\\mathbf{R}\\|_2}{\\|\\mathbf{R}\\|_1 + 10^{-16}}\n$$\n2. 无量纲雅可比矩阵大小，定义为\n$$\n\\eta_J \\;=\\; \\frac{\\|\\mathbf{J}\\|_F}{\\|\\mathbf{J}\\|_1 + 10^{-16}}\n$$\n3. 无量纲雅可比矩阵一致性误差，定义为\n$$\n\\delta_J \\;=\\; \\frac{\\max_{i,j}\\left|J^{\\text{cons}}_{ij}-J^{\\text{FD}}_{ij}\\right|}{\\max_{i,j}\\left|J^{\\text{FD}}_{ij}\\right| + 10^{-16}}\n$$\n其中 $\\|\\cdot\\|_2$ 是欧几里得范数，$\\|\\cdot\\|_1$ 是绝对值之和，$\\|\\cdot\\|_F$ 是 Frobenius 范数。\n\n使用以下测试套件，每个套件都带有指定的物理和数值参数。所有规定的温度单位为开尔文，长度单位为米，密度单位为 $\\mathrm{kg/m^3}$，时间单位为秒，热导率单位为 $\\mathrm{W/(m\\cdot K)}$，比热单位为 $\\mathrm{J/(kg\\cdot K)}$，热源单位为 $\\mathrm{W/m^3}$。函数 $c(T)$ 和 $k(T)$ 为：\n$$\nc(T) \\;=\\; c_0 + c_1\\,T \\quad k(T) \\;=\\; k_0\\,\\exp\\!\\left( b \\,(T - T_{\\text{ref}})\\right)\n$$\n其导数为 $c'(T)=c_1$ 和 $k'(T)=b\\,k(T)$。\n\n- 测试案例 A（一般非线性，正常路径）：\n    - $L=1.0$, $N_e=10$, $\\rho=2200$, $c_0=900$, $c_1=0.5$, $k_0=2.0$, $b=0.01$, $T_{\\text{ref}}=300$, $\\Delta t=10.0$,\n    - $T_0=300.0$, $T_L=330.0$, $Q=0.0$,\n    - 初始场 $T^n(x)$ 从 $T_0$ 到 $T_L$ 呈线性分布。\n\n- 测试案例 B（线性材料，边界条件平衡）：\n    - $L=1.0$, $N_e=6$, $\\rho=2000$, $c_0=800$, $c_1=0.0$, $k_0=2.5$, $b=0.0$, $T_{\\text{ref}}=300$, $\\Delta t=5.0$,\n    - $T_0=300.0$, $T_L=300.0$, $Q=0.0$,\n    - 初始场 $T^n(x)=300.0$ 均匀分布。\n\n- 测试案例 C（更强的非线性与内部加热）：\n    - $L=2.0$, $N_e=20$, $\\rho=2500$, $c_0=900$, $c_1=0.3$, $k_0=1.5$, $b=0.02$, $T_{\\text{ref}}=300$, $\\Delta t=0.5$,\n    - $T_0=310.0$, $T_L=390.0$, $Q=5.0\\times 10^{4}$,\n    - 初始场 $T^n(x)$ 从 $T_0$ 到 $T_L$ 呈线性分布。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例按 $[\\eta_R,\\eta_J,\\delta_J]$ 的顺序贡献其三个无量纲指标的列表。例如，输出格式必须如下：\n$$\n[\\,[\\eta_R^{(A)},\\eta_J^{(A)},\\delta_J^{(A)}],\\,[\\eta_R^{(B)},\\eta_J^{(B)},\\delta_J^{(B)}],\\,[\\eta_R^{(C)},\\eta_J^{(C)},\\delta_J^{(C)}]\\,].\n$$\n由于指标在构造上是无量纲的，因此输出中不需要物理单位。", "solution": "用户提供的问题经评估有效。该问题在科学上是合理的、适定的、客观且完整的。它代表了计算传热领域的一个标准问题，要求推导和实现非线性热方程的有限元解。\n\n求解过程包括以下步骤：\n1.  使用 Galerkin 方法推导控制偏微分方程（PDE）的弱形式。\n2.  使用双节点线性有限元进行空间离散化。\n3.  使用隐式后向欧拉方法进行时间离散化，得到一个非线性代数方程组。\n4.  为 Newton-Raphson 迭代求解器构建所需的残差向量 $\\mathbf{R}$ 和一致雅可比矩阵 $\\mathbf{J}$。\n5.  使用高斯求积法对 $\\mathbf{R}$ 和 $\\mathbf{J}$ 的组装进行数值实现，并与雅可比矩阵的有限差分近似进行比较，以验证解析推导。\n\n**步骤 1：弱形式推导**\n\n一维非线性热传导的控制偏微分方程为：\n$$\n\\rho\\,c(T)\\,\\frac{\\partial T}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(k(T)\\,\\frac{\\partial T}{\\partial x}\\right) \\;+\\; Q(x,t)\n$$\n为了推导弱形式，我们将偏微分方程乘以一个任意的测试函数 $w(x)$，并在空间域 $\\Omega = [0, L]$ 上进行积分。测试函数 $w(x)$ 在指定了 Dirichlet 条件的边界上必须为零。\n$$\n\\int_{0}^{L} w(x) \\left[ \\rho\\,c(T)\\,\\frac{\\partial T}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left(k(T)\\,\\frac{\\partial T}{\\partial x}\\right) - Q(x,t) \\right] dx = 0\n$$\n我们对第二项（散度项）应用分部积分，以降低空间导数的阶数：\n$$\n-\\int_{0}^{L} w(x) \\frac{\\partial}{\\partial x}\\!\\left(k(T)\\,\\frac{\\partial T}{\\partial x}\\right) dx = \\int_{0}^{L} \\frac{\\partial w}{\\partial x} k(T)\\,\\frac{\\partial T}{\\partial x} dx - \\left[ w(x) k(T)\\,\\frac{\\partial T}{\\partial x} \\right]_{0}^{L}\n$$\n边界项 $\\left[ w(x) k(T)\\,\\frac{\\partial T}{\\partial x} \\right]_{0}^{L}$ 消失，因为与内部（非 Dirichlet）节点相关联的测试函数 $w(x)$ 在边界 $x=0$ 和 $x=L$ 处为零。对于边界节点本身，相应的方程将被 Dirichlet 条件所取代，因此该项对未知节点温度的最终系统没有贡献。\n\n将其代回，方程的弱形式为：\n$$\n\\int_{0}^{L} w(x) \\rho\\,c(T)\\,\\frac{\\partial T}{\\partial t} dx + \\int_{0}^{L} \\frac{\\partial w}{\\partial x} k(T)\\,\\frac{\\partial T}{\\partial x} dx = \\int_{0}^{L} w(x) Q(x,t) dx\n$$\n此方程必须对所有有效的测试函数 $w(x)$ 成立。\n\n**步骤 2：有限元空间离散化**\n\n域 $[0, L]$ 被离散为 $N_e$ 个单元，得到 $N_n = N_e+1$ 个节点。温度场 $T(x,t)$ 使用有限元基函数 $\\{N_j(x)\\}_{j=1}^{N_n}$ 进行近似：\n$$\nT(x,t) \\approx T_h(x,t) = \\sum_{j=1}^{N_n} T_j(t) N_j(x)\n$$\n其中 $T_j(t)$ 是未知的节点温度。在 Galerkin 方法中，测试函数 $w(x)$ 从同一组基函数中选取，即 $w(x) = N_i(x)$，其中 $i=1, \\dots, N_n$。\n\n将近似解 $T_h(x,t)$ 和 $w(x) = N_i(x)$ 代入弱形式，得到一个常微分方程组：\n$$\n\\sum_{j=1}^{N_n} \\left( \\int_{0}^{L} N_i \\rho c(T_h) N_j dx \\right) \\frac{dT_j}{dt} + \\sum_{j=1}^{N_n} \\left( \\int_{0}^{L} \\frac{dN_i}{dx} k(T_h) \\frac{dN_j}{dx} dx \\right) T_j = \\int_{0}^{L} N_i Q dx\n$$\n对每个 $i=1, \\dots, N_n$。\n\n**步骤 3：后向欧拉时间离散化**\n\n我们从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 进行时间离散化。后向欧拉法将 $t^{n+1}$ 处的时间导数近似为：\n$$\n\\frac{dT_j}{dt} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\n所有其他项也都在时间 $t^{n+1}$ 处进行评估。这导出了一个关于未知节点温度 $\\mathbf{T}^{n+1} = \\{T_j^{n+1}\\}_{j=1}^{N_n}$ 的非线性代数方程组。\n每个节点 $i$ 的离散系统为：\n$$\n\\int_{0}^{L} N_i \\rho c(T_h^{n+1}) \\frac{T_h^{n+1}-T_h^n}{\\Delta t} dx + \\int_{0}^{L} \\frac{dN_i}{dx} k(T_h^{n+1}) \\frac{\\partial T_h^{n+1}}{\\partial x} dx - \\int_{0}^{L} N_i Q^{n+1} dx = 0\n$$\n其中 $T_h^{n+1}(x) = \\sum_j T_j^{n+1} N_j(x)$ 且 $T_h^n(x) = \\sum_j T_j^n N_j(x)$。\n\n**步骤 4：残差和雅可比矩阵推导**\n\n步骤 3 得到的方程组必须使用像 Newton-Raphson 这样的迭代方法求解 $\\mathbf{T}^{n+1}$。这需要定义残差向量 $\\mathbf{R}(\\mathbf{T}^{n+1})$ 和雅可比矩阵 $\\mathbf{J}(\\mathbf{T}^{n+1})$。\n\n残差向量的第 $i$ 个分量 $R_i$ 定义为离散化弱形式的左侧：\n$$\nR_i(\\mathbf{T}^{n+1}) = \\int_{0}^{L} \\!\\! \\left[ N_i \\rho c(T_h^{n+1}) \\frac{T_h^{n+1}-T_h^n}{\\Delta t} + \\frac{dN_i}{dx} k(T_h^{n+1}) \\frac{\\partial T_h^{n+1}}{\\partial x} - N_i Q^{n+1} \\right] dx\n$$\n雅可比矩阵的分量由 $J_{ij} = \\frac{\\partial R_i}{\\partial T_j^{n+1}}$ 定义。我们对 $R_i$ 关于任意节点温度 $T_j^{n+1}$ 求导。注意 $\\frac{\\partial T_h^{n+1}}{\\partial T_j^{n+1}} = N_j(x)$ 以及 $\\frac{\\partial}{\\partial T_j^{n+1}}\\left(\\frac{\\partial T_h^{n+1}}{\\partial x}\\right) = \\frac{dN_j}{dx}$。\n\n让我们逐项对 $R_i$ 进行微分。\n1.  来自瞬态项的贡献：\n    $$\n    \\frac{\\partial}{\\partial T_j^{n+1}} \\int_{0}^{L} N_i \\rho c(T_h^{n+1}) \\frac{T_h^{n+1}-T_h^n}{\\Delta t} dx = \\int_{0}^{L} \\frac{N_i \\rho}{\\Delta t} \\left[ \\frac{\\partial c(T_h^{n+1})}{\\partial T_j^{n+1}}(T_h^{n+1}-T_h^n) + c(T_h^{n+1})\\frac{\\partial T_h^{n+1}}{\\partial T_j^{n+1}} \\right] dx\n    $$\n    使用链式法则，$\\frac{\\partial c(T_h^{n+1})}{\\partial T_j^{n+1}} = c'(T_h^{n+1}) \\frac{\\partial T_h^{n+1}}{\\partial T_j^{n+1}} = c'(T_h^{n+1})N_j$。这得到：\n    $$\n    J_{ij}^{\\text{tran}} = \\int_{0}^{L} \\frac{\\rho}{\\Delta t} N_i N_j \\left[ c(T_h^{n+1}) + c'(T_h^{n+1})(T_h^{n+1}-T_h^n) \\right] dx\n    $$\n\n2.  来自传导项的贡献：\n    $$\n    \\frac{\\partial}{\\partial T_j^{n+1}} \\int_{0}^{L} \\frac{dN_i}{dx} k(T_h^{n+1}) \\frac{\\partial T_h^{n+1}}{\\partial x} dx = \\int_{0}^{L} \\frac{dN_i}{dx} \\left[ \\frac{\\partial k(T_h^{n+1})}{\\partial T_j^{n+1}}\\frac{\\partial T_h^{n+1}}{\\partial x} + k(T_h^{n+1})\\frac{\\partial}{\\partial T_j^{n+1}}\\left(\\frac{\\partial T_h^{n+1}}{\\partial x}\\right) \\right] dx\n    $$\n    使用链式法则，$\\frac{\\partial k(T_h^{n+1})}{\\partial T_j^{n+1}} = k'(T_h^{n+1}) N_j$。这得到：\n    $$\n    J_{ij}^{\\text{cond}} = \\int_{0}^{L} \\frac{dN_i}{dx} \\left[ k'(T_h^{n+1}) N_j \\frac{\\partial T_h^{n+1}}{\\partial x} + k(T_h^{n+1}) \\frac{dN_j}{dx} \\right] dx\n    $$\n\n3.  来自热源项的贡献（假设 $Q$ 与 $T$ 无关）：\n    $$\n    J_{ij}^{\\text{source}} = \\frac{\\partial}{\\partial T_j^{n+1}} \\left( -\\int_0^L N_i Q^{n+1} dx \\right) = 0\n    $$\n\n结合这些贡献，雅可比矩阵项 $J_{ij}$ 的完整表达式为：\n$$\nJ_{ij}(\\mathbf{T}^{n+1}) = \\int_{0}^{L} \\frac{\\rho}{\\Delta t} N_i N_j \\left[ c(T_h^{n+1}) + c'(T_h^{n+1})(T_h^{n+1}-T_h^n) \\right] dx + \\int_{0}^{L} \\left[ \\frac{dN_i}{dx} k(T_h^{n+1}) \\frac{dN_j}{dx} + \\frac{dN_i}{dx} k'(T_h^{n+1}) N_j \\frac{\\partial T_h^{n+1}}{\\partial x} \\right] dx\n$$\n\n**步骤 5：数值实现**\n\n$R_i$ 和 $J_{ij}$ 的积分通过在每个单元上使用两点高斯求积法进行数值计算。该过程包括遍历每个单元，在每个高斯点计算其对全局残差向量和雅可比矩阵的局部贡献，然后将这些贡献组装到全局系统中。对于长度为 $h_e$ 的双节点线性单元，在局部坐标 $\\xi \\in [-1,1]$ 中的形函数为 $N_1(\\xi) = (1-\\xi)/2$ 和 $N_2(\\xi) = (1+\\xi)/2$，它们对 $x$ 的导数为 $\\frac{dN_1}{dx} = -1/h_e$ 和 $\\frac{dN_2}{dx} = 1/h_e$。\n\n在组装完完整的物理残差 $\\mathbf{R}^{\\text{phys}}$ 和雅可比矩阵 $\\mathbf{J}^{\\text{phys}}$ 之后，施加 Dirichlet 边界条件 $T(0,t)=T_0$ 和 $T(L,t)=T_L$。对于边界节点 $i$（例如，$i=1$ 或 $i=N_n$），相应的残差方程被替换为 $R_i = T_i^{n+1} - T_{\\text{bc},i}$，雅可比矩阵的对应行被修改为 $J_{i,j} = \\delta_{ij}$（即，对角线上为 1，其他位置为 0）。\n\n问题要求在第一个 Newton 迭代步进行单次计算，其中状态 $\\mathbf{T}^{n+1}$ 取为初始猜测值 $\\mathbf{T}^{n+1,(0)} = \\mathbf{T}^n$。因此，所有量（$R_i, J_{ij}$）都使用 $T_h^{n+1} = T_h^n$ 进行评估。由于 $T_h^{n+1}-T_h^n = 0$，这简化了雅可比矩阵的项。\n\n为了验证解析雅可比矩阵 $\\mathbf{J}^{\\text{cons}}$，计算了一个有限差分雅可比矩阵 $\\mathbf{J}^{\\text{FD}}$。使用中心差分格式：\n$$\nJ^{\\text{FD}}_{ij} \\approx \\frac{R_i(\\mathbf{T}^n + \\epsilon \\mathbf{e}_j) - R_i(\\mathbf{T}^n - \\epsilon \\mathbf{e}_j)}{2\\epsilon}\n$$\n其中 $\\mathbf{e}_j$ 是一个标准基向量，$\\epsilon$ 是一个小的扰动量。此处使用的残差函数 $R_i(\\cdot)$ 必须包括边界条件施加步骤，以确保与 $\\mathbf{J}^{\\text{cons}}$ 的一致性。下面的代码实现了这一逻辑，以计算所需的无量纲指标。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and print results.\n    \"\"\"\n    \n    test_cases = [\n        {\n            # Test Case A (general nonlinear, happy path)\n            'L': 1.0, 'Ne': 10, 'rho': 2200.0, 'c0': 900.0, 'c1': 0.5,\n            'k0': 2.0, 'b': 0.01, 'T_ref': 300.0, 'Dt': 10.0, 'Q': 0.0,\n            'T0': 300.0, 'TL': 330.0,\n        },\n        {\n            # Test Case B (linear material, boundary condition equilibrium)\n            'L': 1.0, 'Ne': 6, 'rho': 2000.0, 'c0': 800.0, 'c1': 0.0,\n            'k0': 2.5, 'b': 0.0, 'T_ref': 300.0, 'Dt': 5.0, 'Q': 0.0,\n            'T0': 300.0, 'TL': 300.0,\n        },\n        {\n            # Test Case C (stronger nonlinearity and internal heating)\n            'L': 2.0, 'Ne': 20, 'rho': 2500.0, 'c0': 900.0, 'c1': 0.3,\n            'k0': 1.5, 'b': 0.02, 'T_ref': 300.0, 'Dt': 0.5, 'Q': 5.0e4,\n            'T0': 310.0, 'TL': 390.0,\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        # Unpack parameters\n        L, Ne, rho, c0, c1, k0, b, T_ref, Dt, Q, T0, TL = (\n            params['L'], params['Ne'], params['rho'], params['c0'], params['c1'],\n            params['k0'], params['b'], params['T_ref'], params['Dt'], params['Q'],\n            params['T0'], params['TL']\n        )\n\n        # Define material property functions\n        c = lambda T: c0 + c1 * T\n        c_prime = lambda T: c1\n        k = lambda T: k0 * np.exp(b * (T - T_ref))\n        k_prime = lambda T: b * k(T)\n\n        # Setup mesh and initial conditions\n        Nn = Ne + 1\n        nodes = np.linspace(0, L, Nn)\n        \n        # Initial temperature field T^n(x)\n        if np.isclose(T0, TL) and params['b']==0.0 and params['c1']==0.0: # Test case B specific\n            T_n = np.full(Nn, T0)\n        else: # Linear profile for A and C\n            T_n = T0 + (TL - T0) * nodes / L\n\n        # The calculation is for the first Newton step, so T^{n+1,(0)} = T^n\n        T_eval = T_n.copy()\n\n        # Assemble analytical residual and jacobian\n        R_cons, J_cons = assemble_system(T_eval, T_n, Ne, L, rho, Dt, c, c_prime, k, k_prime, Q, T0, TL)\n\n        # Assemble finite-difference jacobian for verification\n        J_fd = assemble_fd_jacobian(T_eval, T_n, Ne, L, rho, Dt, c, c_prime, k, k_prime, Q, T0, TL)\n\n        # Compute dimensionless metrics\n        eps_norm = 1e-16\n        \n        # Metric 1: Residual magnitude\n        norm_R_2 = np.linalg.norm(R_cons, 2)\n        norm_R_1 = np.linalg.norm(R_cons, 1)\n        eta_R = norm_R_2 / (norm_R_1 + eps_norm)\n\n        # Metric 2: Jacobian magnitude\n        norm_J_F = np.linalg.norm(J_cons, 'fro')\n        norm_J_1 = np.sum(np.abs(J_cons))\n        eta_J = norm_J_F / (norm_J_1 + eps_norm)\n\n        # Metric 3: Jacobian consistency error\n        J_diff_abs = np.abs(J_cons - J_fd)\n        J_fd_abs = np.abs(J_fd)\n        delta_J = np.max(J_diff_abs) / (np.max(J_fd_abs) + eps_norm)\n\n        all_results.append(f\"[{eta_R},{eta_J},{delta_J}]\")\n\n    print(f\"[{','.join(all_results)}]\")\n\ndef assemble_system(T_eval, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL):\n    \"\"\"Assembles the consistent Jacobian and residual vector.\"\"\"\n    Nn = Ne + 1\n    h = L / Ne\n    R = np.zeros(Nn)\n    J = np.zeros((Nn, Nn))\n\n    # 2-point Gaussian quadrature\n    gp = 1.0 / np.sqrt(3.0)\n    gauss_points = [-gp, gp]\n    gauss_weights = [1.0, 1.0]\n\n    for e in range(Ne):\n        node_indices = [e, e + 1]\n        T_e_eval = T_eval[node_indices]\n        T_e_n = T_n[node_indices]\n        \n        r_e = np.zeros(2)\n        j_e = np.zeros((2, 2))\n\n        for xi, w in zip(gauss_points, gauss_weights):\n            N = np.array([(1 - xi) / 2, (1 + xi) / 2])\n            B = np.array([-1 / h, 1 / h])\n            \n            T_gp_eval = N @ T_e_eval\n            T_gp_n = N @ T_e_n\n            T_grad_gp_eval = B @ T_e_eval\n            \n            c_val = c_fun(T_gp_eval)\n            cp_val = c_prime_fun(T_gp_eval)\n            k_val = k_fun(T_gp_eval)\n            kp_val = k_prime_fun(T_gp_eval)\n            \n            dV = (h / 2) * w\n\n            # Residual assembly\n            term_tran_R = N * rho * c_val * (T_gp_eval - T_gp_n) / Dt\n            term_cond_R = B * k_val * T_grad_gp_eval\n            term_src_R = -N * Q\n            r_e += (term_tran_R + term_cond_R + term_src_R) * dV\n            \n            # Jacobian assembly\n            # Because T_eval = T_n, (T_gp_eval - T_gp_n) is zero.\n            term_tran_J = (rho / Dt) * np.outer(N, N) * (c_val + cp_val * (T_gp_eval - T_gp_n))\n            term_cond_J1 = k_val * np.outer(B, B)\n            term_cond_J2 = kp_val * T_grad_gp_eval * np.outer(B, N)\n            \n            j_e += (term_tran_J + term_cond_J1 + term_cond_J2) * dV\n        \n        np.add.at(R, node_indices, r_e)\n        J[np.ix_(node_indices, node_indices)] += j_e\n        \n    # Apply Dirichlet boundary conditions\n    # Node 0\n    R[0] = T_eval[0] - T0\n    J[0, :] = 0.0\n    J[0, 0] = 1.0\n\n    # Last Node\n    R[-1] = T_eval[-1] - TL\n    J[-1, :] = 0.0\n    J[-1, -1] = 1.0\n    \n    return R, J\n\ndef get_residual(T, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL):\n    \"\"\"Helper function to compute residual vector for a given temperature vector T.\"\"\"\n    R, _ = assemble_system(T, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL)\n    return R\n\ndef assemble_fd_jacobian(T_eval, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL):\n    \"\"\"Assembles the Jacobian matrix using centered finite differences.\"\"\"\n    Nn = Ne + 1\n    J_fd = np.zeros((Nn, Nn))\n    epsilon = 1e-8\n\n    for j in range(Nn):\n        T_plus = T_eval.copy()\n        T_plus[j] += epsilon\n        \n        T_minus = T_eval.copy()\n        T_minus[j] -= epsilon\n\n        R_plus = get_residual(T_plus, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL)\n        R_minus = get_residual(T_minus, T_n, Ne, L, rho, Dt, c_fun, c_prime_fun, k_fun, k_prime_fun, Q, T0, TL)\n        \n        J_fd[:, j] = (R_plus - R_minus) / (2 * epsilon)\n        \n    return J_fd\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "3525705"}]}