{"hands_on_practices": [{"introduction": "本练习侧重于多孔介质中输运现象的基础分析。通过对能量守恒方程进行无量纲化，我们可以推导出佩克莱数（Péclet number），这是一个关键的无量纲数，它揭示了对流和传导两种热量输运机制之间的竞争关系。掌握这项技能对于预测系统行为以及为模拟选择合适的数值方法至关重要。[@problem_id:3567770]", "problem": "一个长度为 $L$ 的完全饱和、刚性、均质的多孔介质柱，在轴向承受着稳态、均匀的单相流，其渗流（达西）速度大小 $\\|\\boldsymbol{w}\\|$ 为恒定值。孔隙流体是不可压缩的，其密度为 $\\rho_f$，定压比热容为 $c_f$。饱和多孔介质中的热传导由有效导热系数 $\\lambda$ 表征。体积热源可忽略不计，热力学性质恒定不变，机械功和粘性耗散均被忽略。\n\n从饱和多孔介质在一维空间中的能量守恒定律出发，对控制方程进行无量纲化，以获得一个量化对流与传导热输运之比的无量纲数群。然后，使用所提供的数据，计算该多孔介质柱的此无量纲数群的值。最后，基于第一性原理，解释当该数群远小于一和远大于一时，两种极限输运机制的物理和计算意义。将计算值报告为纯数（无量纲）。\n\n使用以下数据：\n- 柱长：$L = 10 \\ \\mathrm{m}$。\n- 渗流（达西）速度大小：$\\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$。\n- 流体密度：$\\rho_f = 1000 \\ \\mathrm{kg/m^3}$。\n- 流体比热容：$c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$。\n- 有效导热系数：$\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$。\n\n将最终数值答案四舍五入至四位有效数字，并以无量纲数（无单位）的形式表示。解释应包含在您的推理过程中，但最终报告的答案必须仅为计算出的数值。", "solution": "题目要求推导和计算控制饱和多孔介质中热输运的无量纲数群，并解释其物理和计算意义。\n\n第一步是基于能量守恒原理建立热输运的控制方程。对于饱和多孔介质，考虑传导和对流引起的热输运，并忽略热源、机械功和粘性耗散，一维空间（我们用 $x$ 表示轴向）中的能量平衡方程为：\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q_c}{\\partial x} - \\frac{\\partial q_a}{\\partial x}\n$$\n其中 $T$ 是温度，$t$ 是时间，$(\\rho c)_m$ 是饱和多孔介质的有效体积热容。$q_c$ 项代表传导热通量，$q_a$ 项代表对流热通量。\n\n传导热通量由傅里叶定律（Fourier's law）描述：\n$$\nq_c = -\\lambda \\frac{\\partial T}{\\partial x}\n$$\n其中 $\\lambda$ 是饱和介质的有效导热系数。\n\n对流热通量是由携带热能的孔隙流体流动引起的。其表达式为：\n$$\nq_a = (\\rho_f c_f T) w_x\n$$\n其中 $\\rho_f$ 是流体密度，$c_f$ 是流体比热容，$w_x$ 是 $x$ 方向的达西（渗流）速度。\n\n将这些通量定义代入守恒方程，得到：\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\lambda \\frac{\\partial T}{\\partial x}\\right) - \\frac{\\partial}{\\partial x}(\\rho_f c_f w_x T)\n$$\n题目指定了稳态流，我们关心的是由稳态温度分布所表征的输运机制。因此，我们将时间导数项设为零，即 $\\frac{\\partial T}{\\partial t} = 0$。性质 $\\lambda$、$\\rho_f$、$c_f$ 和速度 $w_x$ 均被给定为常数。渗流速度大小 $\\|\\boldsymbol{w}\\|$ 已知，并且由于流动是均匀的轴向流，我们有 $w_x = \\|\\boldsymbol{w}\\|$。稳态控制方程简化为：\n$$\n0 = \\lambda \\frac{d^2T}{dx^2} - \\rho_f c_f w_x \\frac{dT}{dx}\n$$\n这是关于温度的一维稳态对流-传导方程。\n\n为确定相关的无量纲数群，我们对此方程进行无量纲化。让我们引入无量纲坐标 $\\xi$ 和无量纲温度 $\\theta$。特征长度的自然选择是柱长 $L$。对于温度，我们可以基于两个参考温度（例如边界温度 $T(x=0) = T_0$ 和 $T(x=L) = T_L$）来定义其无量纲形式。\n$$\n\\xi = \\frac{x}{L}\n$$\n$$\n\\theta(\\xi) = \\frac{T(x) - T_L}{T_0 - T_L}\n$$\n根据链式法则，导数变换如下：\n$$\n\\frac{d T}{d x} = \\frac{d T}{d \\theta} \\frac{d \\theta}{d \\xi} \\frac{d \\xi}{d x} = (T_0 - T_L) \\frac{d\\theta}{d\\xi} \\frac{1}{L}\n$$\n$$\n\\frac{d^2 T}{d x^2} = \\frac{d}{dx}\\left( \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} \\right) = \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2}\n$$\n将这些代入控制方程，得到：\n$$\n\\lambda \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2} - \\rho_f c_f w_x \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} = 0\n$$\n假设存在非零温差（$T_0 \\neq T_L$），我们可以将方程两边同除以 $\\lambda \\frac{T_0 - T_L}{L^2}$ 项：\n$$\n\\frac{d^2\\theta}{d\\xi^2} - \\left(\\frac{\\rho_f c_f w_x L}{\\lambda}\\right) \\frac{d\\theta}{d\\xi} = 0\n$$\n量化对流与传导热输运之比的无量纲数群是一阶导数项的系数。这就是佩克莱特数（Péclet number），$Pe$：\n$$\nPe = \\frac{\\rho_f c_f w_x L}{\\lambda}\n$$\n这个数代表了特征对流热输运速率（$\\sim \\rho_f c_f w_x \\Delta T / L$）与特征传导热输运速率（$\\sim \\lambda \\Delta T / L^2$）之比。\n\n接下来，我们使用所提供的数据计算佩克莱特数的值：\n- 柱长：$L = 10 \\ \\mathrm{m}$\n- 渗流速度大小：$w_x = \\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$\n- 流体密度：$\\rho_f = 1000 \\ \\mathrm{kg/m^3}$\n- 流体比热容：$c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$\n- 有效导热系数：$\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$\n\n将这些值代入 $Pe$ 的表达式中：\n$$\nPe = \\frac{(1000 \\ \\mathrm{kg/m^3}) \\times (4180 \\ \\mathrm{J/(kg \\cdot K)}) \\times (1.0 \\times 10^{-7} \\ \\mathrm{m/s}) \\times (10 \\ \\mathrm{m})}{2.5 \\ \\mathrm{W/(m \\cdot K)}}\n$$\n回顾 $1 \\ \\mathrm{W} = 1 \\ \\mathrm{J/s}$，单位可以消掉，从而证实 $Pe$ 是无量纲的。\n$$\nPe = \\frac{1000 \\times 4180 \\times 1.0 \\times 10^{-7} \\times 10}{2.5} = \\frac{4.180}{2.5} = 1.672\n$$\n按要求四舍五入到四位有效数字，其值为 $1.672$。\n\n最后，我们根据佩克莱特数解释两种极限输运机制的物理和计算意义。\n\n1.  **传导主导机制 ($Pe \\ll 1$)**：\n    *   **物理意义**：当佩克莱特数远小于一时，热传导输运在热输运中占主导地位，超过对流输运。缓慢移动的流体对温度分布的影响可以忽略不计。柱内的温度剖面接近于静止介质中纯热传导所特有的线性剖面。热量通过固体和流体基质有效扩散，迅速抹平温度梯度。\n    *   **计算意义**：在这种机制下，控制微分方程由二阶扩散项（$\\frac{d^2\\theta}{d\\xi^2}$）主导。这类扩散主导的问题在数值上是稳定的，可以使用标准的离散化方法（如有限差分的中心差分格式或有限元的标准伽辽金方法）精确求解。其解是平滑的，相对粗糙的计算网格也能产生准确的结果。\n\n2.  **对流主导机制 ($Pe \\gg 1$)**：\n    *   **物理意义**：当佩克莱特数远大于一时，对流（流体流动）热输运在热输运中占主导地位，超过传导输运。流体有效地沿其流动路径携带热能，只有很少的热量扩散到周围介质中。这会导致形成尖锐的温度锋。温度剖面将在上游边界附近呈现陡峭的梯度，而在下游则相对平坦，因为温度随流动被平流输运。\n    *   **计算意义**：在计算上，这种机制要困难得多。控制方程由一阶对流项（$Pe \\frac{d\\theta}{d\\xi}$）主导，使其类似于双曲型偏微分方程。像中心差分这样的标准数值格式容易产生严重的、非物理性的振荡（数值频散或“摆动”），除非网格非常精细，使得网格佩克莱特数（一个单元级别的等效值，$Pe_m = Pe \\frac{\\Delta x}{L}$）保持在一个临界值（通常约为2）以下。为了在实际的网格上克服这种不稳定性，需要专门的数值技术，如迎风格式（其引入数值扩散以稳定解）、通量限制法或稳定的有限元列式（例如，流线迎风Petrov-Galerkin方法，SUPG）。这些方法对于准确捕捉尖锐锋面而无虚假振荡至关重要。", "answer": "$$\\boxed{1.672}$$", "id": "3567770"}, {"introduction": "多孔彈性理論的本構關係將微觀的流固耦合作用與宏觀的力學響應聯繫起來。本練習將Biot理論中的抽象參數，如Biot係數和Biot模量，與實驗室中可測量的物理量（如排水和不排水體積模量）聯繫起來。通過這個練習，您將鞏固對這些關鍵材料屬性及其如何通過實驗進行表徵的理解。[@problem_id:3567756]", "problem": "一个完全饱和、均质、各向同性的岩石试样在三轴室中于等温条件下进行测试，因此可以忽略热效应。该材料在小应变线性孔隙弹性（Biot 理论）的框架内进行建模。在各向同性总应力增量 $d\\sigma_{m}$ 和孔隙压力增量 $dp$ 的作用下，体积应变增量为 $d\\varepsilon_{v}$。孔隙弹性本构描述引入了排水体积模量 $K_{d}$、Biot 系数 $b$ 和 Biot 模量 $M$。不排水响应由流体含量无变化的条件定义。Skempton 系数 $B$ 定义为在不排水和等温条件下测得的比率 $B = \\left(\\partial p / \\partial \\sigma_{m}\\right)_{d\\zeta = 0,\\, T}$。\n\n根据线性各向同性孔隙弹性的基本平衡和本构关系，推导联系不排水体积模量 $K_{u}$ 和 Skempton 系数 $B$ 与排水体积模量 $K_{d}$、Biot 系数 $b$ 及 Biot 模量 $M$ 的表达式。然后，使用测量值 $K_d = 5.0$ GPa、$K_u = 15.0$ GPa、$B = 0.70$ 和流体体积模量 $K_f = 2.20$ GPa，计算 $b$ 和 $M$ 的闭合形式表达式，并进行数值评估。将 $M$ 的最终值以吉帕斯卡（GPa）表示。将 $b$ 和 $M$ 的值均四舍五入至四位有效数字。\n\n这些测量值具有如下的单标准差不确定度：$K_d$ 为 $\\pm 0.10$ GPa，$K_u$ 为 $\\pm 0.20$ GPa，$B$ 为 $\\pm 0.02$，$K_f$ 为 $\\pm 0.05$ GPa。请简要评论在给定假设下，实验不确定度如何传播到 $b$ 和 $M$ 中，指出哪些测量值主导了 $b$ 和 $M$ 的不确定度，以及 $K_f$ 的不确定度是否通过这些关系影响了计算出的 $b$ 和 $M$。", "solution": "### 孔隙弹性关系的推导\n我们从线性、各向同性孔隙弹性材料在等温条件下的本构关系出发。采用地质力学中的标准符号约定（压应力和压应变为正），体积应变增量 $d\\varepsilon_v$ 和孔隙压力增量 $dp$ 的关系式如下：\n$$ d\\sigma_m = K_d d\\varepsilon_v + b dp \\quad (1) $$\n$$ d\\zeta = b d\\varepsilon_v + \\frac{1}{M} dp \\quad (2) $$\n其中 $d\\sigma_m$ 是各向同性总应力增量，$d\\zeta$ 是流体含量增量，$K_d$ 是排水体积模量，$b$ 是 Biot 系数，$M$ 是 Biot 模量。\n\n**不排水体积模量, $K_u$**\n不排水体积模量 $K_u$ 定义为在不排水条件下（$d\\zeta = 0$）各向同性总应力变化量与体积应变变化量之比：\n$$ K_u \\equiv \\left(\\frac{\\partial \\sigma_m}{\\partial \\varepsilon_v}\\right)_{d\\zeta=0} $$\n在方程 $(2)$ 中令 $d\\zeta = 0$，得到孔隙压力变化与体积应变的关系：\n$$ dp = M b d\\varepsilon_v \\quad (3) $$\n将此表达式代入方程 $(1)$：\n$$ d\\sigma_m = K_d d\\varepsilon_v + b (M b d\\varepsilon_v) = (K_d + b^2 M) d\\varepsilon_v $$\n根据 $K_u$ 的定义，我们得到第一个所需的关系式：\n$$ K_u = K_d + b^2 M $$\n\n**Skempton 系数, $B$**\nSkempton 系数 $B$ 定义为在不排水条件下（$d\\zeta = 0$）孔隙压力变化量与各向同性总应力变化量之比：\n$$ B \\equiv \\left(\\frac{\\partial p}{\\partial \\sigma_m}\\right)_{d\\zeta=0} $$\n利用不排水条件下 $dp = M b d\\varepsilon_v$ 和 $d\\sigma_m = K_u d\\varepsilon_v$ 的关系，取二者之比：\n$$ B = \\frac{dp}{d\\sigma_m} = \\frac{M b d\\varepsilon_v}{K_u d\\varepsilon_v} $$\n这给出了第二个所需的关系式：\n$$ B = \\frac{b M}{K_u} $$\n\n### $b$ 和 $M$ 的计算\n我们现在有一个包含两个未知数 $b$ 和 $M$ 的二元方程组：\n$$ K_u = K_d + b^2 M \\quad (I) $$\n$$ B = \\frac{b M}{K_u} \\quad (II) $$\n从方程 $(I)$，我们有 $b^2 M = K_u - K_d$。从方程 $(II)$，我们有 $bM = B K_u$。将后者代入前者，得到 $b (B K_u) = K_u - K_d$。\n求解 $b$ 得到其闭合形式表达式：\n$$ b = \\frac{K_u - K_d}{B K_u} $$\n将 $b$ 的表达式代回关系式 $M = BK_u/b$ 来求得 $M$：\n$$ M = \\frac{B K_u}{\\frac{K_u - K_d}{B K_u}} = \\frac{(B K_u)^2}{K_u - K_d} $$\n\n**数值计算**\n给定值：$K_d = 5.0$ GPa, $K_u = 15.0$ GPa, $B = 0.70$。\n$$ b = \\frac{15.0 - 5.0}{0.70 \\times 15.0} = \\frac{10.0}{10.5} \\approx 0.95238... $$\n四舍五入到四位有效数字，$b = 0.9524$。\n\n$$ M = \\frac{(0.70 \\times 15.0)^2}{15.0 - 5.0} = \\frac{(10.5)^2}{10.0} = \\frac{110.25}{10.0} = 11.025 \\text{ GPa} $$\n四舍五入到四位有效数字，$M = 11.03$ GPa。\n\n### 关于不确定度传播的评论\n$b$ 和 $M$ 的计算值依赖于三个实验测量值：$K_u$、$K_d$ 和 $B$。因此，它们的不确定度由这些测量值的不确定度决定。\n\n- 对于 $b = \\frac{K_u - K_d}{B K_u}$，其不确定度主要受 $B$ 的相对不确定度（$\\approx 2.9\\%$）和差值项 $K_u - K_d$ 的影响。在本例中，$B$ 的不确定度是一个主导因素。\n- 对于 $M = \\frac{(B K_u)^2}{K_u - K_d}$，其不确定度同样取决于 $K_u$、$K_d$ 和 $B$。由于 $B K_u$ 项被平方， $B$ 的不确定度被放大，使其成为 $M$ 不确定度的主要来源。\n- 表达式中不包含流体体积模量 $K_f$。因此，在该特定计算路径下，$K_f$ 的测量不确定度不会传播到计算出的 $b$ 和 $M$ 值中。需要注意的是，这并不意味着这些参数在物理上是独立的，只是所选的计算方法不涉及 $K_f$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.9524 & 11.03 \\end{pmatrix}}$$", "id": "3567756"}, {"introduction": "一个稳健的计算模型必须建立在自洽的理论基础之上。本练习为热-水-力（THM）耦合问题的高层热力学公式与底层有限元代码实现之间建立了直接的联系。通过从亥姆霍兹自由能势（Helmholtz free energy potential）推导单元切向矩阵，您将亲眼见证基本的热力学原理如何确保耦合数值系统的对称性，这对理论和数值计算都至关重要。[@problem_id:3567769]", "problem": "考虑一个一维小应变热-水-力（THM）孔隙热弹性杆单元，该单元有两个节点，占据区间 $\\left[0,L\\right]$，并具有恒定的横截面积 $A$。未知场为位移 $u(x)$、孔隙压力 $p(x)$ 和温度 $T(x)$。使用线性形函数 $N_1(x)=1-\\dfrac{x}{L}$ 和 $N_2(x)=\\dfrac{x}{L}$ 来近似所有场，即 $u(x)=N_1(x)u_1+N_2(x)u_2$，$p(x)=N_1(x)p_1+N_2(x)p_2$ 和 $T(x)=N_1(x)T_1+N_2(x)T_2$。设应变为 $\\varepsilon(x)=\\dfrac{du}{dx}$，并定义常数应变-位移算子 $B=\\left[-\\dfrac{1}{L},\\dfrac{1}{L}\\right]$，使得 $\\varepsilon(x)=B\\boldsymbol{u}$，其中 $\\boldsymbol{u}=\\left[u_1,u_2\\right]^T$。\n\n假设线性孔隙热弹性介质单位体积的二次亥姆霍兹自由能（HFE）密度为 $\\psi$，\n$$\n\\psi(\\varepsilon,p,\\theta)=\\dfrac{1}{2}E\\,\\varepsilon^2 - E\\,\\alpha_T\\,\\theta\\,\\varepsilon - b\\,p\\,\\varepsilon - \\dfrac{1}{2}M\\,p^2 - \\beta\\,p\\,\\theta + \\dfrac{1}{2}H\\,\\theta^2,\n$$\n其中 $E$ 是杨氏模量，$b$ 是 Biot 系数，$M$ 是储水模量，$\\alpha_T$ 是线性热膨胀系数，$\\beta$ 是热增压耦合系数，$H$ 是体积热容，$\\theta:=T-T_0$ 是相对于固定参考温度 $T_0$ 的温差。所有系数均为常数。根据热力学共轭关系，应力 $\\sigma$、流体含量 $m$ 和熵 $s$ 可由下式得出\n$$\n\\sigma=\\dfrac{\\partial\\psi}{\\partial\\varepsilon},\\quad m=-\\dfrac{\\partial\\psi}{\\partial p},\\quad s=-\\dfrac{\\partial\\psi}{\\partial T}.\n$$\n\n对于大小为 $\\Delta t$ 的隐式后向欧拉时间增量，定义单个单元的离散增量势泛函为，\n$$\n\\mathcal{F}(\\boldsymbol{u},\\boldsymbol{p},\\boldsymbol{T})=\\int_0^L A\\,\\psi\\big(\\varepsilon(x),p(x),\\theta(x)\\big)\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_T\\,\\left(\\dfrac{dT}{dx}\\right)^2\\,dx,\n$$\n其中 $\\boldsymbol{p}=\\left[p_1,p_2\\right]^T$，$\\boldsymbol{T}=\\left[T_1,T_2\\right]^T$，$\\kappa_p\\ge 0$ 是一个类水力扩散系数，$\\kappa_T\\ge 0$ 是一个类热导率系数。耦合系统的单块切向矩阵块定义为 $\\mathcal{F}$ 关于节点未知量的 Hessian 矩阵，\n$$\n\\boldsymbol{K}_{uu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{u}},\\quad\n\\boldsymbol{K}_{pp}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{TT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{T}},\n$$\n以及非对角耦合项，\n$$\n\\boldsymbol{K}_{up}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{uT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{T}},\\quad\n\\boldsymbol{K}_{pT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{T}},\n$$\n转置关系为 $\\boldsymbol{K}_{pu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{u}}$，$\\boldsymbol{K}_{Tu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{u}}$ 和 $\\boldsymbol{K}_{Tp}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{p}}$。\n\n任务：从上述泛函出发，使用指定的线性形函数和常数 $B$ 组装单个 2 节点单元的所有切向块。然后，通过在标准矩阵欧几里得范数下，检验 $\\boldsymbol{K}_{up}=\\boldsymbol{K}_{pu}^T$、$\\boldsymbol{K}_{uT}=\\boldsymbol{K}_{Tu}^T$ 和 $\\boldsymbol{K}_{pT}=\\boldsymbol{K}_{Tp}^T$ 是否在 $\\varepsilon_{\\text{tol}}=10^{-12}$ 的容差内数值成立，来验证由该势能所隐含的非对角耦合的对称性。为每个检查的等式生成一个布尔值。\n\n单位：$L$ 的单位是米，$A$ 的单位是平方米，$\\Delta t$ 的单位是秒，$E$ 和 $M$ 的单位是帕斯卡，$b$ 是无量纲的，$\\alpha_T$ 的单位是开尔文的倒数，$\\beta$ 的单位是帕斯卡每开尔文，$H$ 的单位是焦耳每立方米每开尔文，$\\kappa_p$ 的单位是米每秒乘以一个压缩性因子，使得 $A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2$ 的单位是能量每单位长度，$\\kappa_T$ 的单位是瓦特每米每开尔文。\n\n测试套件：使用以下三组参数集来测试典型、解耦和符号改变的耦合情况。\n\n- 情况 1（典型）：$L=1.0$，$A=1.0$，$\\Delta t=1.0$，$E=3.0\\times 10^9$，$b=0.6$，$M=2.5\\times 10^8$，$\\alpha_T=1.2\\times 10^{-5}$，$\\beta=1.0\\times 10^6$，$H=2.0\\times 10^6$，$\\kappa_p=1.0\\times 10^{-12}$，$\\kappa_T=10.0$。\n- 情况 2（解耦边缘）：$L=2.0$，$A=0.5$，$\\Delta t=0.1$，$E=1.0\\times 10^9$，$b=0.0$，$M=1.0\\times 10^8$，$\\alpha_T=0.0$，$\\beta=0.0$，$H=1.0\\times 10^6$，$\\kappa_p=5.0\\times 10^{-13}$，$\\kappa_T=1.0$。\n- 情况 3（热增压符号改变）：$L=0.75$，$A=1.5$，$\\Delta t=5.0$，$E=2.2\\times 10^9$，$b=0.95$，$M=5.0\\times 10^8$，$\\alpha_T=2.5\\times 10^{-5}$，$\\beta=-5.0\\times 10^5$，$H=3.5\\times 10^6$，$\\kappa_p=2.0\\times 10^{-12}$，$\\kappa_T=20.0$。\n\n输出规格：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每种情况，按顺序 $\\left[\\boldsymbol{K}_{up}\\stackrel{?}{=}\\boldsymbol{K}_{pu}^T,\\ \\boldsymbol{K}_{uT}\\stackrel{?}{=}\\boldsymbol{K}_{Tu}^T,\\ \\boldsymbol{K}_{pT}\\stackrel{?}{=}\\boldsymbol{K}_{Tp}^T\\right]$ 输出三个对称性检查的布尔值，并将三种情况的结果展平，最终得到一个长度为 9 的列表。", "solution": "该问题的目标是通过计算势泛函 $\\mathcal{F}$ 关于节点未知向量 $\\boldsymbol{u}$、$\\boldsymbol{p}$ 和 $\\boldsymbol{T}$ 的二阶偏导数（Hessian 矩阵），来推导单元的切向刚度矩阵块。由于整个系统源于一个势，其 Hessian 矩阵必然是对称的。本解答将推导出非对角耦合块，并为数值验证提供基础。\n\n首先，我们使用形函数 $\\boldsymbol{N}(x) = [N_1(x), N_2(x)]$ 和应变-位移算子 $\\boldsymbol{B} = [-1/L, 1/L]$ 来表示场变量及其梯度：\n-   $p(x) = \\boldsymbol{N}(x)\\boldsymbol{p}$\n-   $T(x) = \\boldsymbol{N}(x)\\boldsymbol{T}$\n-   $\\varepsilon(x) = \\boldsymbol{B}\\boldsymbol{u}$\n-   $dp/dx = \\boldsymbol{B}\\boldsymbol{p}$\n-   $dT/dx = \\boldsymbol{B}\\boldsymbol{T}$\n\n势泛函 $\\mathcal{F}$ 中的耦合项源于亥姆霍兹自由能 $\\psi$ 中的乘积项。我们可以通过对 $\\mathcal{F}$ 求二次偏导来推导出切向矩阵的非对角块。这需要计算一些在单元长度 $L$ 上的标准积分矩阵：\n-   $\\boldsymbol{M}_{NN} = \\int_0^L \\boldsymbol{N}^T(x) \\boldsymbol{N}(x) \\,dx = \\dfrac{L}{6}\\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$\n-   $\\boldsymbol{M}_{BN} = \\int_0^L \\boldsymbol{B}^T \\boldsymbol{N}(x) \\,dx = \\int_0^L \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix}[1-x/L, x/L] dx = \\begin{bmatrix} -1/2 & -1/2 \\\\ 1/2 & 1/2 \\end{bmatrix}$\n\n利用这些积分矩阵，我们可以写出 $\\mathcal{F}$ 中与耦合相关的部分，并推导其二阶导数：\n\n1.  **力学-水力耦合 ($\\boldsymbol{u}-\\boldsymbol{p}$)**：\n    $\\mathcal{F}$ 中包含的项为 $\\int_0^L -A b\\,p\\,\\varepsilon\\,dx = -A b \\int_0^L (\\boldsymbol{N}\\boldsymbol{p})(\\boldsymbol{B}\\boldsymbol{u})\\,dx = -A b\\, \\boldsymbol{p}^T \\boldsymbol{M}_{BN}^T \\boldsymbol{u}$。\n    -   $\\boldsymbol{K}_{up} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u} \\partial \\boldsymbol{p}} = -A b\\, \\boldsymbol{M}_{BN}$\n    -   $\\boldsymbol{K}_{pu} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p} \\partial \\boldsymbol{u}} = -A b\\, \\boldsymbol{M}_{BN}^T$\n    对称性 $\\boldsymbol{K}_{up} = \\boldsymbol{K}_{pu}^T$ 成立。\n\n2.  **热-力耦合 ($\\boldsymbol{u}-\\boldsymbol{T}$)**：\n    $\\mathcal{F}$ 中包含的项为 $\\int_0^L -A E \\alpha_T\\,\\theta\\,\\varepsilon\\,dx = -A E \\alpha_T \\int_0^L (\\boldsymbol{N}\\boldsymbol{T})(\\boldsymbol{B}\\boldsymbol{u})\\,dx = -A E \\alpha_T \\boldsymbol{T}^T \\boldsymbol{M}_{BN}^T \\boldsymbol{u}$。\n    -   $\\boldsymbol{K}_{uT} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u} \\partial \\boldsymbol{T}} = -A E \\alpha_T \\boldsymbol{M}_{BN}$\n    -   $\\boldsymbol{K}_{Tu} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T} \\partial \\boldsymbol{u}} = -A E \\alpha_T \\boldsymbol{M}_{BN}^T$\n    对称性 $\\boldsymbol{K}_{uT} = \\boldsymbol{K}_{Tu}^T$ 成立。\n\n3.  **热-水耦合 ($\\boldsymbol{p}-\\boldsymbol{T}$)**：\n    $\\mathcal{F}$ 中包含的项为 $\\int_0^L -A \\beta\\,p\\,\\theta\\,dx = -A \\beta \\int_0^L (\\boldsymbol{N}\\boldsymbol{p})(\\boldsymbol{N}\\boldsymbol{T})\\,dx = -A \\beta\\, \\boldsymbol{p}^T \\boldsymbol{M}_{NN} \\boldsymbol{T}$。\n    -   $\\boldsymbol{K}_{pT} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p} \\partial \\boldsymbol{T}} = -A \\beta\\, \\boldsymbol{M}_{NN}$\n    -   $\\boldsymbol{K}_{Tp} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T} \\partial \\boldsymbol{p}} = -A \\beta\\, \\boldsymbol{M}_{NN}^T$\n    由于 $\\boldsymbol{M}_{NN}$ 是对称的，$\\boldsymbol{M}_{NN} = \\boldsymbol{M}_{NN}^T$，因此对称性 $\\boldsymbol{K}_{pT} = \\boldsymbol{K}_{Tp}^T$ 成立。\n\n这些推导从解析上证明了由亥姆霍兹自由能势导出的切向矩阵的对称性。数值实现将通过计算这些矩阵并比较它们的转置来验证这一点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the THM tangent matrix blocks and verifies the symmetry\n    of the off-diagonal coupling blocks.\n    \"\"\"\n\n    # Test cases parameters in the order:\n    # L, A, dt, E, b, M, alpha_T, beta, H, kappa_p, kappa_T\n    test_cases = [\n        # Case 1 (typical)\n        (\n            1.0, 1.0, 1.0, 3.0e9, 0.6, 2.5e8,\n            1.2e-5, 1.0e6, 2.0e6,\n            1.0e-12, 10.0\n        ),\n        # Case 2 (decoupled edge)\n        (\n            2.0, 0.5, 0.1, 1.0e9, 0.0, 1.0e8,\n            0.0, 0.0, 1.0e6,\n            5.0e-13, 1.0\n        ),\n        # Case 3 (sign-changed thermal pressurization)\n        (\n            0.75, 1.5, 5.0, 2.2e9, 0.95, 5.0e8,\n            2.5e-5, -5.0e5, 3.5e6,\n            2.0e-12, 20.0\n        ),\n    ]\n\n    tol = 1e-12\n    all_results = []\n\n    for case in test_cases:\n        L, A, dt, E, b, M, alpha_T, beta, H, kappa_p, kappa_T = case\n        \n        # Integral matrices based on linear shape functions for a 2-node element\n        # M_BN = integral(B^T * N) dx from 0 to L\n        M_BN = np.array([[-0.5, -0.5], [0.5, 0.5]])\n        \n        # M_NN = integral(N^T * N) dx from 0 to L\n        M_NN = (L / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n\n        # The Hessian of a potential is always symmetric, so K_XY = (K_YX)^T.\n        # This is what we will verify. The derivations are based on the second\n        # partial derivatives of the potential functional F.\n\n        # 1. Mechanical-Hydraulic Coupling (u-p)\n        # Term: -A*b * u^T * M_BN * p\n        # From derivation: K_up = -A*b*M_BN and K_pu = -A*b*M_BN^T\n        \n        K_up = -A * b * M_BN\n        K_pu = -A * b * M_BN.T\n\n        # 2. Thermo-Mechanical Coupling (u-T)\n        # Term: -A*E*alpha_T * u^T * M_BN * T\n        # From derivation: K_uT = -A*E*alpha_T*M_BN and K_Tu = -A*E*alpha_T*M_BN^T\n\n        K_uT = -A * E * alpha_T * M_BN\n        K_Tu = -A * E * alpha_T * M_BN.T\n        \n        # 3. Thermo-Hydraulic Coupling (p-T)\n        # Term: -A*beta * p^T * M_NN * T\n        # From derivation: K_pT = -A*beta*M_NN and K_Tp = -A*beta*M_NN^T\n\n        K_pT = -A * beta * M_NN\n        K_Tp = -A * beta * M_NN.T\n\n        # Perform symmetry checks using the Frobenius norm of the difference\n        check_up_pu = np.linalg.norm(K_up - K_pu.T)  tol\n        check_uT_Tu = np.linalg.norm(K_uT - K_Tu.T)  tol\n        check_pT_Tp = np.linalg.norm(K_pT - K_Tp.T)  tol\n        \n        all_results.extend([check_up_pu, check_uT_Tu, check_pT_Tp])\n\n    # Final print statement in the exact required format.\n    # Note: The problem asks for K_up =? K_pu^T, etc. The derivation shows\n    # K_up = -A*b*M_BN and K_pu = -A*b*M_BN^T, so K_pu^T = -A*b*(M_BN^T)^T = -A*b*M_BN = K_up.\n    # The code implements the check correctly.\n    print(f\"[{','.join(str(res).lower() for res in all_results)}]\")\n\nsolve()\n```", "id": "3567769"}]}