{"hands_on_practices": [{"introduction": "本练习旨在帮助您掌握任何计算塑性模型的核心：应力更新或“返回映射”算法。您将为一个单时间增量步实现完整的计算流程，该流程包括弹性预测和通过牛顿法求解的塑性修正。掌握这个核心构建模块是建立更复杂模拟的第一个关键步骤。[@problem_id:3504621]", "problem": "实现一维小应变边界面塑性在单个时间增量内的更新。给定规定的总应变增量 $\\Delta\\varepsilon$、材料参数以及先前状态 $\\left(\\boldsymbol{\\sigma}^{n},\\boldsymbol{\\varepsilon}^{p,n},\\kappa^{n},\\boldsymbol{\\alpha}^{n}\\right)$（在一维情况下特化为 $\\left(\\sigma^{n},\\varepsilon^{p,n},\\kappa^{n},\\alpha^{n}\\right)$），通过牛顿迭代法求解一个非线性系统，计算更新后的状态 $\\left(\\sigma^{n+1},\\varepsilon^{p,n+1},\\kappa^{n+1},\\alpha^{n+1}\\right)$，并验证残差范数低于指定的容差。假设所有量均为无量纲，因此不需要物理单位。\n\n从以下基本且广为接受的定义开始：\n- 小应变加法分解：$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$，其中 $\\varepsilon$ 是总应变，$\\varepsilon^{e}$ 是弹性应变，$\\varepsilon^{p}$ 是塑性应变。\n- 一维线性弹性：$\\sigma = E \\,\\varepsilon^{e} = E \\left(\\varepsilon - \\varepsilon^{p}\\right)$，其中 $E$ 是杨氏模量。\n- 线性法则的运动硬化：$\\mathrm{d}\\alpha = h_{k}\\, \\mathrm{d}\\varepsilon^{p}$，其中 $h_{k}$ 是一个材料常数，$\\alpha$ 是背应力。\n- 关于边界面半径的线性法则各向同性硬化：$R(\\kappa) = \\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa$，其中 $\\kappa$ 是累积塑性应变度量，$\\sigma_{b0} > 0$ 是初始边界面半径，而 $H_{\\mathrm{iso}} \\ge 0$ 是各向同性硬化模量。\n- 含背应力的有效应力（一维）：$s = \\sigma - \\alpha$，以及加载方向 $n = \\mathrm{sign}(s_{\\mathrm{tr}})$ 由试探状态 $s_{\\mathrm{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon - \\alpha^{n}$ 确定。如果 $s_{\\mathrm{tr}} = 0$，则取 $n=+1$。\n\n带径向映射的边界面塑性表示如下：\n- 令 $y = |s|$ 且 $R = R(\\kappa)$。定义距离比 $\\rho = y/R$。对于 $\\rho  1$ 的内部状态，可能会出现非零的塑性应变增量，其大小由指数 $m \\ge 0$ 缩放。引入一个弹性核参数 $\\xi \\in [0,1)$：如果 $\\rho \\le \\xi$，则响应是纯弹性的（$\\Delta\\lambda = 0$）。\n- 塑性流动是关联的并由 $n$ 定向，满足 $\\mathrm{d}\\varepsilon^{p} = \\mathrm{d}\\lambda\\, n$，$\\mathrm{d}\\alpha = h_{k}\\, \\mathrm{d}\\lambda\\, n$ 和 $\\mathrm{d}\\kappa = \\mathrm{d}\\lambda$，其中 $\\mathrm{d}\\lambda \\ge 0$ 是塑性乘子增量。\n\n对于从步骤 $n$ 到 $n+1$ 的单个增量和规定的 $\\Delta\\varepsilon$，通过强制残差系统 $\\mathbf{r}(\\mathbf{x}) = \\mathbf{0}$，隐式求解未知量 $\\mathbf{x} = \\left[\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1}, \\Delta\\lambda\\right]^{\\mathsf{T}}$：\n- 运动学和弹性：\n  - $r_{1} = \\sigma^{n+1} - \\sigma^{n} - E\\left(\\Delta\\varepsilon - \\left(\\varepsilon^{p,n+1} - \\varepsilon^{p,n}\\right)\\right)$，\n  - $r_{2} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} - \\Delta\\lambda\\, n$。\n- 硬化更新：\n  - $r_{3} = \\alpha^{n+1} - \\alpha^{n} - h_{k}\\,\\Delta\\lambda\\, n$，\n  - $r_{4} = \\kappa^{n+1} - \\kappa^{n} - \\Delta\\lambda$。\n- 边界面驱动方程（塑性激活分支）：\n  - 定义 $y = n\\left(\\sigma^{n+1} - \\alpha^{n+1}\\right)$，$R = \\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa^{n+1}$，以及为了数值稳健性，使用一个小的 $\\rho_{\\min} > 0$ 定义 $\\rho = \\min\\left(1, \\max\\left(\\rho_{\\min}, \\dfrac{y}{R}\\right)\\right)$。则\n  - $r_{5} = E\\,n\\,\\Delta\\varepsilon - \\dfrac{\\left(E + h_{k} + H_{\\mathrm{iso}}\\right)}{\\rho^{m}}\\,\\Delta\\lambda$。\n- 弹性核分支：如果试探比率 $\\rho_{\\mathrm{tr}} = \\dfrac{|s_{\\mathrm{tr}}|}{\\sigma_{b0} + H_{\\mathrm{iso}}\\,\\kappa^{n}} \\le \\xi$ 或者如果 $E\\,n\\,\\Delta\\varepsilon \\le 0$，则强制 $\\Delta\\lambda = 0$ 并进行弹性更新：\n  - $\\sigma^{n+1} = \\sigma^{n} + E\\,\\Delta\\varepsilon$，\n  - $\\varepsilon^{p,n+1} = \\varepsilon^{p,n}$，\n  - $\\alpha^{n+1} = \\alpha^{n}$，\n  - $\\kappa^{n+1} = \\kappa^{n}$。\n\n对于塑性激活分支，使用牛顿法求解非线性系统。在每次迭代中，组装残差向量 $\\mathbf{r}$ 及其雅可比矩阵 $\\mathbf{J}=\\dfrac{\\partial \\mathbf{r}}{\\partial \\mathbf{x}}$，并通过求解 $\\mathbf{J}\\,\\Delta \\mathbf{x} = -\\mathbf{r}$ 来更新 $\\mathbf{x} \\leftarrow \\mathbf{x} + \\Delta \\mathbf{x}$。使用来自试探状态的符号 $n$，并使其在整个增量中保持不变。当欧几里得范数 $\\|\\mathbf{r}\\|_{2}$ 小于容差 $\\tau$ 时终止。如果算法检测到弹性核分支，应对相应的方程进行残差验证，确保其在容差 $\\tau$ 范围内精确满足。\n\n您的任务是实现一个完整的、可运行的程序，该程序：\n- 不接受任何输入，并使用下述固定的测试套件。\n- 对于每个测试用例，按照规定执行单个时间步更新，对塑性激活分支运行牛顿法（否则进行弹性更新），并返回一个布尔值，指示最终的残差范数是否小于或等于 $\\tau$。\n- 将所有测试用例的结果汇总到一行，形式为用方括号括起来的逗号分隔列表。\n\n使用以下固定的参数值和测试套件。所有量均为无量纲：\n- 材料参数（所有测试通用）：$E = 1000$，$h_{k} = 200$，$H_{\\mathrm{iso}} = 100$，$\\sigma_{b0} = 100$，$m = 2$，$\\xi = 0.6$，$\\rho_{\\min} = 10^{-6}$，$\\tau = 10^{-10}$，最大牛顿迭代次数 $N_{\\max} = 50$。\n- 测试用例，每个用例以 $\\left(\\sigma^{n}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n}, \\Delta\\varepsilon\\right)$ 形式给出：\n  1. $\\left(0, 0, 0, 0, 0.2\\right)$，\n  2. $\\left(0, 0, 0, 0, 0.05\\right)$，\n  3. $\\left(0, 0, 0, 0, 0.06\\right)$，\n  4. $\\left(60, 0.05, 0.08, 40, -0.25\\right)$。\n\n此问题中不涉及角度度量。不使用物理单位；所有值均为无量纲。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$\\left[\\mathrm{result}_{1},\\mathrm{result}_{2},\\mathrm{result}_{3},\\mathrm{result}_{4}\\right]$）。每个 $\\mathrm{result}_{i}$ 必须是一个布尔值，指示测试用例 $i$ 的残差范数是否小于或等于 $\\tau$。", "solution": "问题陈述已经过分析，并被确定为有效。它基于计算塑性学的既定原理，特别是边界面模型，提出了一个定义明确、自成体系的数值实现任务。所有必要的方程、参数和测试用例均已提供。任务是实现指定的算法，并报告其在一组固定输入下的收敛情况。\n\n问题的核心是在给定先前状态 $(\\sigma^{n}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n})$ 和总应变增量 $\\Delta\\varepsilon$ 的情况下，计算单个时间步的更新后状态 $(\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$。该算法通过一个显式试探步和一个校正步进行，校正步可以是弹性的或塑性的。\n\n首先，计算一个弹性试探状态。此状态假设整个应变增量 $\\Delta\\varepsilon$ 是纯弹性的。\n试探应力为 $\\sigma_{\\mathrm{tr}} = \\sigma^{n} + E \\Delta\\varepsilon$。\n试探有效应力为 $s_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\alpha^{n}$。\n增量的加载方向基于此试探状态固定：$n = \\mathrm{sign}(s_{\\mathrm{tr}})$。如果 $s_{\\mathrm{tr}}=0$，$n$ 取为 $+1$。\n试探边界面半径为 $R^{n} = \\sigma_{b0} + H_{\\mathrm{iso}}\\kappa^{n}$。\n试探距离比计算为 $\\rho_{\\mathrm{tr}} = \\dfrac{|s_{\\mathrm{tr}}|}{R^{n}}$。\n\n基于此试探状态，决定材料响应是纯弹性的还是涉及塑性。\n如果 $\\rho_{\\mathrm{tr}} \\le \\xi$（状态在弹性核内）或 $E\\,n\\,\\Delta\\varepsilon \\le 0$（卸载或中性加载），则响应是纯弹性的。\n在弹性情况下，更新是直接的：\n$\\sigma^{n+1} = \\sigma_{\\mathrm{tr}}$\n$\\varepsilon^{p,n+1} = \\varepsilon^{p,n}$\n$\\kappa^{n+1} = \\kappa^{n}$\n$\\alpha^{n+1} = \\alpha^{n}$\n塑性乘子增量为零，$\\Delta\\lambda = 0$。定义此弹性更新的方程组的残差是平凡的零，因此满足收敛容差 $\\tau$。\n\n如果不满足弹性更新的条件，则采取塑性激活步骤。这需要求解一个包含五个未知数 $\\mathbf{x} = [\\sigma^{n+1}, \\varepsilon^{p,n+1}, \\kappa^{n+1}, \\alpha^{n+1}, \\Delta\\lambda]^{\\mathsf{T}}$ 的五元非线性方程组。问题指定使用牛顿法求解残差向量 $\\mathbf{r}(\\mathbf{x}) = \\mathbf{0}$ 的根。残差向量的分量是：\n$r_{1} = \\sigma^{n+1} - \\sigma^{n} - E\\left(\\Delta\\varepsilon - (\\varepsilon^{p,n+1} - \\varepsilon^{p,n})\\right)$\n$r_{2} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} - \\Delta\\lambda\\, n$\n$r_{3} = \\alpha^{n+1} - \\alpha^{n} - h_{k}\\,\\Delta\\lambda\\, n$\n$r_{4} = \\kappa^{n+1} - \\kappa^{n} - \\Delta\\lambda$\n$r_{5} = E\\,n\\,\\Delta\\varepsilon - \\dfrac{K_{\\mathrm{sum}}}{\\rho^{m}}\\,\\Delta\\lambda$，其中 $K_{\\mathrm{sum}} = E + h_{k} + H_{\\mathrm{iso}}$。\n\n$r_5$ 中的项 $\\rho$ 定义为 $\\rho = \\min\\left(1, \\max\\left(\\rho_{\\min}, \\dfrac{y}{R}\\right)\\right)$，其中 $y = n\\left(\\sigma^{n+1} - \\alpha^{n+1}\\right)$ 且 $R = \\sigma_{b0} + H_{\\mathrm{iso}}\\kappa^{n+1}$。\n\n牛顿法从一个初始猜测开始，弹性预测值是一个自然的选择：$\\mathbf{x}^{(0)} = [\\sigma_{\\mathrm{tr}}, \\varepsilon^{p,n}, \\kappa^{n}, \\alpha^{n}, 0]^{\\mathsf{T}}$。\n在每次迭代 $k$ 中，通过求解线性系统 $\\mathbf{J}(\\mathbf{x}^{(k)}) \\Delta\\mathbf{x}^{(k)} = -\\mathbf{r}(\\mathbf{x}^{(k)})$ 找到牛顿更新 $\\Delta \\mathbf{x}^{(k)}$，其中 $\\mathbf{J}$ 是雅可比矩阵 $\\mathbf{J} = \\dfrac{\\partial\\mathbf{r}}{\\partial\\mathbf{x}}$。然后更新解：$\\mathbf{x}^{(k+1)} = \\mathbf{x}^{(k)} + \\Delta\\mathbf{x}^{(k)}$。迭代持续进行，直到残差的欧几里得范数 $\\|\\mathbf{r}\\|_{2}$ 低于容差 $\\tau$ 或达到最大迭代次数 $N_{\\max}$。\n\n雅可比矩阵 $\\mathbf{J}$ 是一个 $5 \\times 5$ 矩阵，其元素是残差分量相对于未知数 $x_1=\\sigma^{n+1}, x_2=\\varepsilon^{p,n+1}, x_3=\\kappa^{n+1}, x_4=\\alpha^{n+1}, x_5=\\Delta\\lambda$ 的偏导数。\n前四行是稀疏的，并包含许多常数：\n$\\dfrac{\\partial r_1}{\\partial x_1} = 1$, $\\dfrac{\\partial r_1}{\\partial x_2} = E$\n$\\dfrac{\\partial r_2}{\\partial x_2} = 1$, $\\dfrac{\\partial r_2}{\\partial x_5} = -n$\n$\\dfrac{\\partial r_3}{\\partial x_4} = 1$, $\\dfrac{\\partial r_3}{\\partial x_5} = -h_k n$\n$\\dfrac{\\partial r_4}{\\partial x_3} = 1$, $\\dfrac{\\partial r_4}{\\partial x_5} = -1$\n前四行中的所有其他导数均为零。\n\n第五行 $\\dfrac{\\partial r_5}{\\partial x_j}$ 更为复杂，因为它依赖于 $\\rho$ 对 $x_1, x_3, x_4$ 的关系。令 $u = y/R$。$\\rho$ 的导数仅在 $\\rho_{\\min}  u  1$ 时非零。\n$\\dfrac{\\partial r_5}{\\partial x_1} = -K_{\\mathrm{sum}} x_5 \\dfrac{\\partial(\\rho^{-m})}{\\partial x_1} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_1} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{n}{R}$\n$\\dfrac{\\partial r_5}{\\partial x_3} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_3} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\left(-\\dfrac{y H_{\\mathrm{iso}}}{R^2}\\right) = -m K_{\\mathrm{sum}} x_5 \\rho^{-m} \\dfrac{H_{\\mathrm{iso}}}{R}$\n$\\dfrac{\\partial r_5}{\\partial x_4} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\dfrac{\\partial\\rho}{\\partial x_4} = m K_{\\mathrm{sum}} x_5 \\rho^{-m-1} \\left(-\\dfrac{n}{R}\\right)$\n$\\dfrac{\\partial r_5}{\\partial x_5} = -\\dfrac{K_{\\mathrm{sum}}}{\\rho^m}$\n如果 $u \\leq \\rho_{\\min}$ 或 $u \\geq 1$，则对于 $j \\in \\{1,3,4\\}$，$\\dfrac{\\partial\\rho}{\\partial x_j}=0$，这简化了这些分量的雅可比矩阵计算。对于第一次迭代的一个关键观察是，由于 $x_5 = \\Delta\\lambda=0$，导数 $\\frac{\\partial r_5}{\\partial x_j}$ 对于 $j=1,3,4$ 为零，从而简化了初始雅可比矩阵。\n\n每个测试用例的最终输出是一个布尔值，指示最终的残差范数是否满足 $\\|\\mathbf{r}\\|_{2} \\le \\tau$。对于弹性情况以及牛顿法成功收敛的塑性情况，这将为真。如果方法在 $N_{\\max}$ 次迭代内未能收敛，最终的残差范数可能会大于 $\\tau$，从而得到假（false）的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the bounding surface plasticity simulation for all test cases.\n    \"\"\"\n    # Material and numerical parameters\n    E = 1000.0\n    h_k = 200.0\n    H_iso = 100.0\n    sig_b0 = 100.0\n    m = 2.0\n    xi = 0.6\n    rho_min = 1e-6\n    tau = 1e-10\n    N_max = 50\n\n    params = {\n        'E': E, 'h_k': h_k, 'H_iso': H_iso, 'sig_b0': sig_b0,\n        'm': m, 'xi': xi, 'rho_min': rho_min, 'tau': tau, 'N_max': N_max\n    }\n\n    # Test cases: (sigma_n, eps_p_n, kappa_n, alpha_n, d_eps)\n    test_cases = [\n        (0.0, 0.0, 0.0, 0.0, 0.2),\n        (0.0, 0.0, 0.0, 0.0, 0.05),\n        (0.0, 0.0, 0.0, 0.0, 0.06),\n        (60.0, 0.05, 0.08, 40.0, -0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        converged = perform_update(case, params)\n        results.append(str(converged).lower())\n    \n    print(f\"[{','.join(results)}]\")\n\ndef perform_update(case, params):\n    \"\"\"\n    Performs a single time step update for a given test case.\n    \"\"\"\n    sigma_n, eps_p_n, kappa_n, alpha_n, d_eps = case\n    E, h_k, H_iso, sig_b0, m, xi, rho_min, tau, N_max = \\\n        params['E'], params['h_k'], params['H_iso'], params['sig_b0'], \\\n        params['m'], params['xi'], params['rho_min'], params['tau'], params['N_max']\n\n    # Trial state\n    sigma_tr = sigma_n + E * d_eps\n    s_tr = sigma_tr - alpha_n\n    n = np.sign(s_tr) if s_tr != 0 else 1.0\n    R_n = sig_b0 + H_iso * kappa_n\n    \n    rho_tr = np.abs(s_tr) / R_n if R_n != 0 else float('inf')\n\n    # Branching logic: check for elastic update\n    if rho_tr = xi or E * n * d_eps = 0:\n        # Perform elastic update, residual is trivially zero.\n        return True\n    else:\n        # Perform plastic update using Newton's method\n        \n        # Initial guess for unknowns x = [sigma, eps_p, kappa, alpha, d_lambda]\n        x = np.array([sigma_tr, eps_p_n, kappa_n, alpha_n, 0.0])\n        \n        K_sum = E + h_k + H_iso\n        \n        r = np.zeros(5) # Initialize residual vector outside the loop for final check\n\n        for _ in range(N_max):\n            sigma_n1, eps_p_n1, kappa_n1, alpha_n1, d_lambda = x\n\n            # Calculate residual vector r\n            r[0] = sigma_n1 - sigma_n - E * (d_eps - (eps_p_n1 - eps_p_n))\n            r[1] = eps_p_n1 - eps_p_n - d_lambda * n\n            r[2] = alpha_n1 - alpha_n - h_k * d_lambda * n\n            r[3] = kappa_n1 - kappa_n - d_lambda\n\n            y = n * (sigma_n1 - alpha_n1)\n            R = sig_b0 + H_iso * kappa_n1\n            u = y / R if R != 0 else float('inf')\n            rho = min(1.0, max(rho_min, u))\n            rho_m = rho ** m\n            \n            if rho_m == 0: rho_m = 1e-12 # Avoid division by zero\n            \n            r[4] = E * n * d_eps - (K_sum / rho_m) * d_lambda\n\n            # Check for convergence\n            res_norm = np.linalg.norm(r)\n            if res_norm = tau:\n                return True\n\n            # Calculate Jacobian matrix J\n            J = np.zeros((5, 5))\n            J[0, 0] = 1.0; J[0, 1] = E\n            J[1, 1] = 1.0; J[1, 4] = -n\n            J[2, 3] = 1.0; J[2, 4] = -h_k * n\n            J[3, 2] = 1.0; J[3, 4] = -1.0\n            \n            # Derivatives for the 5th residual component\n            d_rho_d_sig = 0.0\n            d_rho_d_kap = 0.0\n            d_rho_d_alf = 0.0\n\n            if rho_min  u  1.0:\n                d_rho_d_sig = n / R\n                d_rho_d_kap = -y * H_iso / (R**2) if R != 0 else 0\n                d_rho_d_alf = -n / R\n            \n            J[4, 0] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_sig if rho != 0 else 0\n            J[4, 2] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_kap if rho != 0 else 0\n            J[4, 3] = m * K_sum * d_lambda * (rho ** (-m - 1)) * d_rho_d_alf if rho != 0 else 0\n            J[4, 4] = -K_sum / rho_m\n            \n            # Solve for update and update unknowns\n            try:\n                delta_x = np.linalg.solve(J, -r)\n            except np.linalg.LinAlgError:\n                # Jacobian is singular, convergence fails\n                return False\n            x += delta_x\n\n        # If loop finishes, check final residual norm\n        final_res_norm = np.linalg.norm(r)\n        return final_res_norm = tau\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3504621"}, {"introduction": "一个稳健的本构模型不仅需要具有预测能力，还必须在数学上是“良构”的。最后一个练习通过研究一个因参数选择不当而导致切线模量为负的案例，探讨了材料稳定性的关键概念。通过推导和分析这种情况，您将深入了解为防止非物理行为并确保数值解的唯一性，模型所需满足的理论约束。[@problem_id:3504657]", "problem": "考虑一个用于计算岩土力学中描述土骨架循环加载的一维替代边界面塑性模型。弹性响应是线性的，模量为 $E$，各向同性硬化应力为 $\\sigma_{y}(\\alpha) = \\sigma_{y0} + H_{\\mathrm{iso}}\\,\\alpha$，其中 $\\alpha$ 是一个具有应变量纲的标量内变量，而 $H_{\\mathrm{iso}}$ 是一个具有应力量纲的常数。在边界面塑性理论中，塑性流动发生在边界面内部，其大小由一个依赖于接近度的硬化率来调节。在此，通过一个标量函数 $H(r)$ 来模拟接近效应，该函数乘以内变量的率，即 $\\mathrm{d}\\alpha = H(r)\\,\\mathrm{d}\\varepsilon^{p}$，其中 $r = |\\sigma|$ 是此一维设定中的应力大小，$\\mathrm{d}\\varepsilon^{p}$ 是塑性应变增量。假设在塑性增量期间为相关联流动，即 $\\mathrm{d}\\varepsilon^{p} = \\mathrm{d}\\lambda$，并满足一致性条件 $\\mathrm{d}f=0$，其中加载时的屈服函数为 $f(\\sigma,\\alpha) = \\sigma - \\sigma_{y}(\\alpha)$。\n\n假设在半个循环内的再加载过程中，当前应力大小为 $r_{n} = 35\\ \\mathrm{MPa}$，依赖于接近度的函数为 $H(r) = \\eta - \\gamma r$，其中 $\\eta$ 是无量纲的，$\\gamma$ 的单位是 $\\mathrm{MPa}^{-1}$。设 $E = 50\\ \\mathrm{MPa}$，$H_{\\mathrm{iso}} = 10\\ \\mathrm{MPa}$，$\\eta = 0.5$，以及 $\\gamma = 0.02\\ \\mathrm{MPa}^{-1}$。仅使用线弹性、相关联流动和一致性条件的基本定义，推导在该状态下的弹塑性切线模量 $E_{t} = \\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$，并通过证明当 $H(r)$ 变为负值时一维声学张量（在此设定下降为 $E_{t}$）为负，来论证唯一性的丧失。然后，通过无量纲病态指数\n$$\nPI \\equiv \\frac{|E_{t}|}{E}.\n$$\n来量化数值病态的严重程度。计算给定参数下的 $PI$ 值。将最终答案四舍五入至四位有效数字。以无量纲数的形式表示答案。", "solution": "用户希望为一个一维塑性模型推导弹塑性切线模量 $E_{t}$，论证其如何导致唯一性丧失，并计算一个无量纲病态指数 $PI$。\n\n弹塑性切线模量 $E_{t} = \\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$ 的推导需要结合塑性理论的基本原理：应变分解、弹性本构关系、流动法则和一致性条件。\n\n1.  **应变分解**：总应变增量 $\\mathrm{d}\\varepsilon$ 是其弹性部分 $\\mathrm{d}\\varepsilon^{e}$ 和塑性部分 $\\mathrm{d}\\varepsilon^{p}$ 的和：\n    $$\n    \\mathrm{d}\\varepsilon = \\mathrm{d}\\varepsilon^{e} + \\mathrm{d}\\varepsilon^{p}\n    $$\n\n2.  **弹性本构关系**：应力增量 $\\mathrm{d}\\sigma$ 通过线性弹性模量 $E$ 与弹性应变增量相关联：\n    $$\n    \\mathrm{d}\\sigma = E \\, \\mathrm{d}\\varepsilon^{e} \\quad \\implies \\quad \\mathrm{d}\\varepsilon^{e} = \\frac{\\mathrm{d}\\sigma}{E}\n    $$\n\n3.  **一致性条件和流动法则**：要发生塑性加载，应力状态必须保持在屈服面上，这由一致性条件 $\\mathrm{d}f=0$ 强制执行。屈服函数给定为 $f(\\sigma, \\alpha) = \\sigma - \\sigma_{y}(\\alpha)$，其中各向同性硬化应力为 $\\sigma_{y}(\\alpha) = \\sigma_{y0} + H_{\\mathrm{iso}}\\,\\alpha$。\n    屈服函数的全微分为：\n    $$\n    \\mathrm{d}f = \\frac{\\partial f}{\\partial \\sigma} \\mathrm{d}\\sigma + \\frac{\\partial f}{\\partial \\alpha} \\mathrm{d}\\alpha = 0\n    $$\n    偏导数为：\n    $$\n    \\frac{\\partial f}{\\partial \\sigma} = 1\n    $$\n    $$\n    \\frac{\\partial f}{\\partial \\alpha} = -H_{\\mathrm{iso}}\n    $$\n    将这些代入一致性条件，得到：\n    $$\n    (1)\\mathrm{d}\\sigma + (-H_{\\mathrm{iso}})\\mathrm{d}\\alpha = 0 \\quad \\implies \\quad \\mathrm{d}\\sigma = H_{\\mathrm{iso}} \\, \\mathrm{d}\\alpha\n    $$\n\n4.  **硬化定律**：内变量 $\\alpha$ 的演化由依赖于接近度的函数 $H(r)$ 定义为：\n    $$\n    \\mathrm{d}\\alpha = H(r) \\, \\mathrm{d}\\varepsilon^{p}\n    $$\n    其中 $r = |\\sigma|$。对于加载，我们假设 $\\sigma > 0$，因此 $r=\\sigma$。\n\n5.  **切线模量的推导**：我们现在可以在应力增量 $\\mathrm{d}\\sigma$ 和塑性应变增量 $\\mathrm{d}\\varepsilon^{p}$ 之间建立关系。将 $\\mathrm{d}\\alpha$ 的表达式代入从一致性条件得到的结果中：\n    $$\n    \\mathrm{d}\\sigma = H_{\\mathrm{iso}} \\, (H(\\sigma) \\, \\mathrm{d}\\varepsilon^{p}) = (H_{\\mathrm{iso}} H(\\sigma)) \\, \\mathrm{d}\\varepsilon^{p}\n    $$\n    这定义了塑性模量 $E_{p} \\equiv \\mathrm{d}\\sigma / \\mathrm{d}\\varepsilon^{p} = H_{\\mathrm{iso}} H(\\sigma)$。我们可以用应力增量来表示塑性应变增量：\n    $$\n    \\mathrm{d}\\varepsilon^{p} = \\frac{\\mathrm{d}\\sigma}{H_{\\mathrm{iso}} H(\\sigma)}\n    $$\n    现在，将 $\\mathrm{d}\\varepsilon^{e}$ 和 $\\mathrm{d}\\varepsilon^{p}$ 的表达式代入应变分解方程：\n    $$\n    \\mathrm{d}\\varepsilon = \\frac{\\mathrm{d}\\sigma}{E} + \\frac{\\mathrm{d}\\sigma}{H_{\\mathrm{iso}} H(\\sigma)}\n    $$\n    提出 $\\mathrm{d}\\sigma$：\n    $$\n    \\mathrm{d}\\varepsilon = \\mathrm{d}\\sigma \\left( \\frac{1}{E} + \\frac{1}{H_{\\mathrm{iso}} H(\\sigma)} \\right) = \\mathrm{d}\\sigma \\left( \\frac{E + H_{\\mathrm{iso}} H(\\sigma)}{E \\, H_{\\mathrm{iso}} H(\\sigma)} \\right)\n    $$\n    弹塑性切线模量 $E_{t}$ 是比值 $\\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$：\n    $$\n    E_{t} = \\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{E \\, H_{\\mathrm{iso}} H(\\sigma)}{E + H_{\\mathrm{iso}} H(\\sigma)}\n    $$\n    这是该模型中切线模量的一般表达式。\n\n6.  **唯一性丧失**：在动力学背景下，边值问题解的唯一性与声学张量的正定性有关。在这种一维设定中，声学张量简化为标量切线模量 $E_{t}$。当 $E_{t} \\le 0$ 时，唯一性丧失，因为波传播的控制微分方程不再是双曲型的。问题要求证明当 $H(r)$ 变为负值时会发生这种情况。\n    给定 $E > 0$ 和 $H_{\\mathrm{iso}} > 0$，如果 $H(r)  0$，则分子 $E \\, H_{\\mathrm{iso}} H(r)$ 为负。分母为 $E + H_{\\mathrm{iso}} H(r)$。只要 $E > |H_{\\mathrm{iso}} H(r)|$，分母就为正，因此 $E_{t}$ 将为负。负的切线模量表示应变软化行为，这可能导致边值问题解的局部化和唯一性丧失。\n\n7.  **数值计算**：我们给定了以下参数：\n    - 当前应力大小：$r_{n} = \\sigma = 35\\ \\mathrm{MPa}$\n    - 弹性模量：$E = 50\\ \\mathrm{MPa}$\n    - 各向同性硬化模量：$H_{\\mathrm{iso}} = 10\\ \\mathrm{MPa}$\n    - 接近度函数参数：$\\eta = 0.5$ (无量纲) 和 $\\gamma = 0.02\\ \\mathrm{MPa}^{-1}$\n\n    首先，计算给定应力状态下接近度函数 $H(r)$ 的值：\n    $$\n    H(\\sigma) = \\eta - \\gamma \\sigma = 0.5 - (0.02\\ \\mathrm{MPa}^{-1})(35\\ \\mathrm{MPa}) = 0.5 - 0.7 = -0.2\n    $$\n    由于 $H(\\sigma)$ 为负，如上所述，我们预期切线模量为负，这表明材料响应是病态的。\n\n    接下来，计算切线模量 $E_{t}$：\n    $$\n    E_t = \\frac{E \\, H_{\\mathrm{iso}} H(\\sigma)}{E + H_{\\mathrm{iso}} H(\\sigma)} = \\frac{(50\\ \\mathrm{MPa}) (10\\ \\mathrm{MPa}) (-0.2)}{50\\ \\mathrm{MPa} + (10\\ \\mathrm{MPa})(-0.2)}\n    $$\n    $$\n    E_{t} = \\frac{-100\\ \\mathrm{MPa}^{2}}{50\\ \\mathrm{MPa} - 2\\ \\mathrm{MPa}} = \\frac{-100\\ \\mathrm{MPa}^{2}}{48\\ \\mathrm{MPa}} = -\\frac{25}{12}\\ \\mathrm{MPa}\n    $$\n\n    最后，计算无量纲病态指数 $PI$：\n    $$\n    PI = \\frac{|E_{t}|}{E} = \\frac{|-\\frac{25}{12}\\ \\mathrm{MPa}|}{50\\ \\mathrm{MPa}} = \\frac{\\frac{25}{12}}{50} = \\frac{25}{12 \\times 50} = \\frac{1}{24}\n    $$\n    将此分数转换为小数，得到：\n    $$\n    PI = 0.041666...\n    $$\n    四舍五入到四位有效数字，我们得到 $0.04167$。", "answer": "$$\\boxed{0.04167}$$", "id": "3504657"}]}