{"hands_on_practices": [{"introduction": "理解超塑性模型的第一步是将其率定型本构方程与经典的土力学概念联系起来。本练习将指导您在恒定体积应变率的各向同性压缩条件下，推导出一个简化的超塑性模型中孔隙比 $e$ 和平均有效压力 $p$ 之间的关系。通过这项实践，您将通过解析推导，将抽象的数学方程转化为熟悉的 $e-\\ln p$ 压缩曲线，为后续学习更复杂的数值方法奠定坚实的理论基础 [@problem_id:3531286]。", "problem": "考虑一个初始各向同性的砂土单元，该单元在一个简化的超塑性本构框架的各向同性投影中进行模拟。设平均有效应力定义为 $p = \\tfrac{1}{3} \\operatorname{tr} \\boldsymbol{\\sigma}$，并取压为正。该单元在恒定体积应变率下承受各向同性压缩，即 $\\operatorname{tr} \\mathbf{D} = d_{v}  0$ 为常数，其中 $\\mathbf{D}$ 是速度梯度的对称部分。假设小应变，使得孔隙比 $e$ 遵循饱和颗粒骨架的标准质量守恒运动学，\n$$\n\\dot{e} = - (1 + e)\\, \\operatorname{tr} \\mathbf{D}.\n$$\n采用一种与密度相关的球形超塑性响应，其中平均应力按如下方式演化：\n$$\n\\dot{p} = \\alpha\\,(1 + e)\\, p \\, \\operatorname{tr} \\mathbf{D},\n$$\n其中 $\\alpha  0$ 是一个无量纲的材料参数。在时间 $t = 0$ 时的初始状态由 $p(0) = p_{0}$ 和 $e(0) = e_{0}$ 给出。在施加的恒定各向同性压缩 $\\operatorname{tr} \\mathbf{D} = d_{v}$ 下，单元被压缩，直至其平均应力达到 $p = p_{1}  p_{0}$。\n\n任务：\n- 从上述关于 $e$ 的运动学定律和给定的关于 $p$ 的超塑性演化方程出发，消去时间并进行积分，以获得 $e$ 作为 $p$ 的函数的闭式表达式，并使用 $p_{0}$ 和 $e_{0}$ 作为参考值。您的推导必须从所提供的运动学和本构速率方程开始，并通过符号推理进行。\n- 然后，对于数据 $e_{0} = 0.700$，$p_{0} = 100$ kPa，$p_{1} = 400$ kPa 和 $\\alpha = 10.0$，计算在 $p = p_{1}$ 时的预测孔隙比。将您的答案四舍五入到 $4$ 位有效数字。孔隙比是无量纲的；将最终值报告为一个纯数。", "solution": "该问题要求推导在各向同性压缩下砂土单元的孔隙比 $e$ 和平均有效应力 $p$ 之间的关系，然后进行数值计算。\n\n描述孔隙比 $e$ 和平均应力 $p$ 演化的控制方程已经给出。孔隙比的运动学定律由下式给出：\n$$\n\\dot{e} = - (1 + e) \\operatorname{tr} \\mathbf{D}\n$$\n平均应力的本构定律为：\n$$\n\\dot{p} = \\alpha (1 + e) p \\operatorname{tr} \\mathbf{D}\n$$\n在这些方程中，$\\dot{e} = \\frac{de}{dt}$ 和 $\\dot{p} = \\frac{dp}{dt}$ 表示物质时间导数。问题陈述该单元承受恒定的各向同性压缩，这意味着变形率张量的迹 $\\operatorname{tr} \\mathbf{D}$ 是一个我们记为 $d_v$ 的正常数。\n$$\n\\operatorname{tr} \\mathbf{D} = d_v  0\n$$\n将此代入控制方程，得到：\n$$\n\\frac{de}{dt} = - (1 + e) d_v \\quad (1)\n$$\n$$\n\\frac{dp}{dt} = \\alpha (1 + e) p d_v \\quad (2)\n$$\n为了找到 $e$ 和 $p$ 之间的关系，我们可以消去时间变量 $t$。根据微分的链式法则，我们可以将孔隙比对应力的变化率 $\\frac{de}{dp}$ 表示为其时间导数之比：\n$$\n\\frac{de}{dp} = \\frac{de/dt}{dp/dt}\n$$\n将方程 $(1)$ 和 $(2)$ 代入此表达式，得到：\n$$\n\\frac{de}{dp} = \\frac{- (1 + e) d_v}{\\alpha (1 + e) p d_v}\n$$\n由于 $e  -1$（因为孔隙比在物理上是正值）且 $d_v  0$（如题所给），项 $(1 + e)$ 和 $d_v$ 可以消去。这大大简化了微分方程：\n$$\n\\frac{de}{dp} = - \\frac{1}{\\alpha p}\n$$\n这是一个一阶可分离常微分方程。我们可以通过分离变量 $e$ 和 $p$ 并积分来求解。我们从初始状态 $(p_0, e_0)$ 积分到一般状态 $(p, e)$：\n$$\n\\int_{e_0}^{e} d\\tilde{e} = \\int_{p_0}^{p} - \\frac{1}{\\alpha \\tilde{p}} d\\tilde{p}\n$$\n材料参数 $\\alpha$ 是一个常数，因此可以将其从积分中提出：\n$$\n\\int_{e_0}^{e} d\\tilde{e} = -\\frac{1}{\\alpha} \\int_{p_0}^{p} \\frac{1}{\\tilde{p}} d\\tilde{p}\n$$\n对两边进行积分，得到：\n$$\n[\\tilde{e}]_{e_0}^{e} = -\\frac{1}{\\alpha} [\\ln(\\tilde{p})]_{p_0}^{p}\n$$\n由于应力 $p$ 是一个正量，我们不需要为对数使用绝对值符号。计算定积分，得到：\n$$\ne - e_0 = -\\frac{1}{\\alpha} (\\ln(p) - \\ln(p_0))\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(\\frac{a}{b})$，我们可以写出：\n$$\ne - e_0 = -\\frac{1}{\\alpha} \\ln\\left(\\frac{p}{p_0}\\right)\n$$\n最后，求解 $e$ 作为 $p$ 的函数，得到所需的闭式表达式：\n$$\ne(p) = e_0 - \\frac{1}{\\alpha} \\ln\\left(\\frac{p}{p_0}\\right)\n$$\n这就完成了任务的第一部分。\n\n对于第二部分，我们必须计算在最终应力 $p = p_1$ 时的孔隙比。设此应力下的孔隙比为 $e_1$。我们将 $p=p_1$ 代入推导出的表达式中：\n$$\ne_1 = e_0 - \\frac{1}{\\alpha} \\ln\\left(\\frac{p_1}{p_0}\\right)\n$$\n问题提供了以下数值：$e_0 = 0.700$，$p_0 = 100$ kPa，$p_1 = 400$ kPa，以及 $\\alpha = 10.0$。将这些值代入方程：\n$$\ne_1 = 0.700 - \\frac{1}{10.0} \\ln\\left(\\frac{400}{100}\\right)\n$$\n$$\ne_1 = 0.700 - 0.1 \\ln(4)\n$$\n现在，我们计算数值：\n$$\n\\ln(4) \\approx 1.38629436\n$$\n$$\ne_1 \\approx 0.700 - 0.1 \\times 1.38629436\n$$\n$$\ne_1 \\approx 0.700 - 0.138629436\n$$\n$$\ne_1 \\approx 0.561370564\n$$\n问题要求将答案四舍五入到 $4$ 位有效数字。第五位有效数字是 $7$，所以我们将第四位数字向上取整。\n$$\ne_1 \\approx 0.5614\n$$", "answer": "$$\\boxed{0.5614}$$", "id": "3531286"}, {"introduction": "在掌握了模型的解析基础之后，下一步是将其转化为计算代码。本练习聚焦于计算岩土力学中的一个关键挑战：如何保证模型在低围压条件下始终满足有效应力为正的物理约束。您将亲手编写一个考虑了压力正则化和正应力投影的应力更新算法，这对于开发稳健的数值模拟程序至关重要 [@problem_id:3531387]。", "problem": "实现并评估一个简化的超塑性应力更新算法，该算法用于处理接近零平均有效应力的颗粒材料。本构速率方程由有效柯西应力张量 $\\boldsymbol{\\sigma}^\\prime$（压为正）、变形率张量 $\\mathbf{D}$ 和一个压力正则化的刚度映射 $\\mathbb{h}(\\cdot)$ 表示，该刚度映射在平均有效应力趋于零时会退化。目标是在一个时间增量内对 $\\boldsymbol{\\sigma}^\\prime$ 进行数值更新，同时对更新后的平均有效应力 $p^\\prime$ 施加正定约束，并通过一个有效模量来量化体积响应的退化程度。\n\n从以下核心定义和事实开始：\n1. 有效应力张量 $\\boldsymbol{\\sigma}^\\prime$ 通过 $\\boldsymbol{\\sigma}^\\prime = p^\\prime \\mathbf{I} + \\mathbf{s}$ 分解为体积部分和偏量部分，其中 $p^\\prime = \\tfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}^\\prime)$ 且 $\\mathbf{s} = \\boldsymbol{\\sigma}^\\prime - p^\\prime \\mathbf{I}$。单位张量为 $\\mathbf{I}$，$\\mathrm{tr}(\\cdot)$ 表示迹。\n2. 变形率 $\\mathbf{D}$ 分解为 $\\mathbf{D} = \\mathbf{E} + \\tfrac{1}{3}\\theta \\mathbf{I}$，其中 $\\theta = \\mathrm{tr}(\\mathbf{D})$，偏量部分为 $\\mathbf{E} = \\mathbf{D} - \\tfrac{1}{3}\\theta \\mathbf{I}$。\n3. 弗罗贝尼乌斯范数为 $\\lVert \\mathbf{A} \\rVert = \\sqrt{\\mathbf{A}:\\mathbf{A}}$。\n\n考虑以下简化的各向同性超塑性速率映射，该映射捕捉了压力依赖性和非线性，同时在 $p^\\prime \\to 0$ 附近仍易于实现：\n$$\n\\dot{\\boldsymbol{\\sigma}}^\\prime \\;=\\; a\\,\\big(p_{\\mathrm{reg}}\\big)^{\\alpha}\\,\\mathbf{E} \\;+\\; b\\,\\big(p_{\\mathrm{reg}}\\big)^{\\beta}\\,\\theta\\,\\mathbf{I} \\;+\\; c\\,\\lVert \\mathbf{E} \\rVert\\,\\mathbf{s},\n$$\n其中 $p_{\\mathrm{reg}} = \\max\\{p^\\prime, p_{\\mathrm{floor}}\\}$ 是正则化的平均有效应力，$\\alpha = 0.5$，$\\beta = 0.5$，材料常数为 $a = 100$（采用一致单位），$b = 150$（采用一致单位），$c = 1$（无量纲）。压力下限为 $p_{\\mathrm{floor}} = 0.1\\,\\mathrm{kPa}$。时间积分使用显式前向欧拉格式进行：\n$$\n\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} \\;=\\; \\boldsymbol{\\sigma}^\\prime_n \\;+\\; \\Delta t \\;\\dot{\\boldsymbol{\\sigma}}^\\prime(\\boldsymbol{\\sigma}^\\prime_n,\\mathbf{D}_n),\n$$\n并对更新后的平均有效应力施加正定约束。在形成试探状态后，计算 $p^\\prime_{\\mathrm{trial}} = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}})$ 和 $\\mathbf{s}_{\\mathrm{trial}} = \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} - p^\\prime_{\\mathrm{trial}}\\mathbf{I}$。如果 $p^\\prime_{\\mathrm{trial}} \\le p_{\\min}$，则通过设置为以下值来施加正定性\n$$\n\\boldsymbol{\\sigma}^\\prime_{n+1} \\;=\\; \\mathbf{s}_{\\mathrm{trial}} \\;+\\; p_{\\min}\\,\\mathbf{I},\n$$\n否则设置 $\\boldsymbol{\\sigma}^\\prime_{n+1} = \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}}$。使用 $p_{\\min} = 0.1\\,\\mathrm{kPa}$。\n\n将步初体积响应的退化度量定义为有效超塑性体积模量\n$$\nM_v \\;=\\; \\frac{\\partial \\dot{p}^\\prime}{\\partial \\theta}\\bigg|_{\\mathbf{E}=\\mathbf{0},\\,\\mathbf{s}=\\mathbf{0}} \\;=\\; b\\,(p_{\\mathrm{reg}})^{\\beta},\n$$\n因此，在 $p^\\prime \\to 0$ 附近，并通过正则化 $p_{\\mathrm{reg}} = p_{\\mathrm{floor}}$，可以得到 $M_v \\to b\\,(p_{\\mathrm{floor}})^{1/2}$。\n\n实现一个程序，对于下述每个测试用例，计算更新后的平均有效应力 $p^\\prime_{n+1}$（单位为 $\\mathrm{kPa}$）、正定约束激活标志（如果应用了正定投影则为 $1$，否则为 $0$），以及在步初评估的退化度量 $M_v$（单位为 $\\mathrm{kPa}$）。所有应力量纲均为 $\\mathrm{kPa}$，时间为 $\\mathrm{s}$，应变率为 $\\mathrm{s}^{-1}$。报告的 $p^\\prime_{n+1}$ 和 $M_v$ 值需四舍五入到六位小数。始终使用压为正的符号约定。角度单位不适用。\n\n您的程序将使用的测试套件：\n1. 测试 $1$（近真空各向同性压缩）：初始 $\\boldsymbol{\\sigma}^\\prime_n = p_0 \\mathbf{I}$，其中 $p_0 = 0.5\\,\\mathrm{kPa}$，$\\mathbf{D}_n = \\tfrac{1}{3}\\theta \\mathbf{I}$，其中 $\\theta = 0.01\\,\\mathrm{s}^{-1}$，$\\Delta t = 0.1\\,\\mathrm{s}$。\n2. 测试 $2$（近真空各向同性膨胀，剧烈）：初始 $\\boldsymbol{\\sigma}^\\prime_n = p_0 \\mathbf{I}$，其中 $p_0 = 1.0\\,\\mathrm{kPa}$，$\\mathbf{D}_n = \\tfrac{1}{3}\\theta \\mathbf{I}$，其中 $\\theta = -1.0\\,\\mathrm{s}^{-1}$，$\\Delta t = 0.1\\,\\mathrm{s}$。\n3. 测试 $3$（零压力下的纯剪切）：初始 $\\boldsymbol{\\sigma}^\\prime_n = p_0 \\mathbf{I}$，其中 $p_0 = 0.2\\,\\mathrm{kPa}$，$\\mathbf{D}_n$ 为纯剪切，$\\theta = 0$，$\\mathbf{E}$ 由非对角线分量 $(\\mathbf{D}_n)_{12} = (\\mathbf{D}_n)_{21} = 0.01\\,\\mathrm{s}^{-1}$ 给出，所有其他分量为零，$\\Delta t = 0.2\\,\\mathrm{s}$。\n4. 测试 $4$（含偏应力的一般情况）：初始 $\\boldsymbol{\\sigma}^\\prime_n = p_0 \\mathbf{I} + \\mathbf{s}_0$，其中 $p_0 = 5.0\\,\\mathrm{kPa}$，$\\mathbf{s}_0 = \\mathrm{diag}(1.0,-0.5,-0.5)\\,\\mathrm{kPa}$，$\\mathbf{D}_n$ 由 $\\theta = 0.005\\,\\mathrm{s}^{-1}$ 和与测试 $3$ 中相同的纯剪切偏量部分组成，$\\Delta t = 0.1\\,\\mathrm{s}$。\n5. 测试 $5$（初始压力恰好为零的膨胀情况）：初始 $\\boldsymbol{\\sigma}^\\prime_n = \\mathbf{0}$，$\\mathbf{D}_n = \\tfrac{1}{3}\\theta \\mathbf{I}$，其中 $\\theta = -0.2\\,\\mathrm{s}^{-1}$，$\\Delta t = 0.05\\,\\mathrm{s}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是 $[p^\\prime_{n+1}, \\mathrm{flag}, M_v]$ 形式的列表，其中 $p^\\prime_{n+1}$ 和 $M_v$ 四舍五入到六位小数，标志为整数。例如，包含两个测试用例的输出将如下所示：$[[0.123456,0,45.678900],[\\dots]]$。", "solution": "用户提供的问题被评估为有效。它在科学上基于计算岩土力学的原理，定义和数据清晰完整，问题阐述良好且表述客观。任务是为一个简化的超塑性本构模型实现单步应力更新，这是该领域的标准流程。\n\n解决方案涉及对所提供算法的直接实现。问题的核心在于正确执行张量代数、应用数值积分格式以及强制施加平均有效应力非负的物理约束。下面将给出分步推导，然后是实现逻辑。\n\n该问题要求实现一个数值算法，以在单个时间增量 $\\Delta t$ 内更新颗粒材料的有效应力张量 $\\boldsymbol{\\sigma}^\\prime$。材料行为由一个简化的各向同性超塑性速率方程描述。该模型的一个关键特征是其对平均有效应力 $p^\\prime$ 的依赖性，这导致当 $p^\\prime$ 趋近于零时出现退化（刚度损失）。算法必须通过正则化刚度并对更新后的应力施加正定约束来处理此问题。\n\n首先，我们建立数学框架。有效柯西应力张量 $\\boldsymbol{\\sigma}^\\prime$ 和变形率张量 $\\mathbf{D}$ 被分解为其体积部分和偏量部分。对应力张量：\n$$\n\\boldsymbol{\\sigma}^\\prime = p^\\prime \\mathbf{I} + \\mathbf{s}\n$$\n其中 $p^\\prime = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}^\\prime)$ 是平均有效应力（压为正），$\\mathbf{s}$ 是偏应力张量，$\\mathbf{I}$ 是二阶单位张量。对变形率张量：\n$$\n\\mathbf{D} = \\frac{1}{3}\\theta \\mathbf{I} + \\mathbf{E}\n$$\n其中 $\\theta = \\mathrm{tr}(\\mathbf{D})$ 是体积应变率，$\\mathbf{E}$ 是偏变形率张量。\n\n本构速率方程将应力率 $\\dot{\\boldsymbol{\\sigma}}^\\prime$ 定义为当前应力状态 $(\\boldsymbol{\\sigma}^\\prime)$ 和变形率 $(\\mathbf{D})$ 的函数，其形式为：\n$$\n\\dot{\\boldsymbol{\\sigma}}^\\prime = a\\,\\big(p_{\\mathrm{reg}}\\big)^{\\alpha}\\,\\mathbf{E} + b\\,\\big(p_{\\mathrm{reg}}\\big)^{\\beta}\\,\\theta\\,\\mathbf{I} + c\\,\\lVert \\mathbf{E} \\rVert\\,\\mathbf{s}\n$$\n$p_{\\mathrm{reg}} = \\max\\{p^\\prime, p_{\\mathrm{floor}}\\}$ 项是一个正则化平均应力，它防止当 $p^\\prime$ 非常小时材料刚度完全消失而导致数值问题。模型参数给定为 $a=100$，$b=150$，$c=1$，$\\alpha=0.5$，$\\beta=0.5$，以及 $p_{\\mathrm{floor}} = 0.1\\,\\mathrm{kPa}$。\n\n将应力从时间 $t_n$ 的状态 $n$ 更新到时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $n+1$ 的数值过程是一个两步过程：一个显式预测步，后跟一个校正（或投影）步。\n1.  **预测步（前向欧拉法）**：首先，使用增量开始时的状态，即使用 $\\boldsymbol{\\sigma}^\\prime_n$（给出 $p^\\prime_n$ 和 $\\mathbf{s}_n$）和 $\\mathbf{D}_n$（给出 $\\theta_n$ 和 $\\mathbf{E}_n$），来评估应力率 $\\dot{\\boldsymbol{\\sigma}}^\\prime_n$。然后计算试探应力张量 $\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}}$：\n    $$\n    \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} = \\boldsymbol{\\sigma}^\\prime_n + \\Delta t \\;\\dot{\\boldsymbol{\\sigma}}^\\prime(\\boldsymbol{\\sigma}^\\prime_n, \\mathbf{D}_n)\n    $$\n2.  **校正步（正定投影）**：施加颗粒材料中平均有效应力不能为拉伸的物理约束（即 $p^\\prime \\ge 0$）。在这里，强制执行最小压力 $p_{\\min} = 0.1\\,\\mathrm{kPa}$。算法检查试探状态的平均应力，$p^\\prime_{\\mathrm{trial}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}})$。\n    -   如果 $p^\\prime_{\\mathrm{trial}}  p_{\\min}$，则试探状态是物理上可接受的，我们设置 $\\boldsymbol{\\sigma}^\\prime_{n+1} = \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}}$。正定约束未被激活。\n    -   如果 $p^\\prime_{\\mathrm{trial}} \\le p_{\\min}$，则试探状态违反了正定约束。投影被激活。通过保留试探偏应力 $\\mathbf{s}_{\\mathrm{trial}} = \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} - p^\\prime_{\\mathrm{trial}}\\mathbf{I}$，并将平均应力重置为允许的最小值来计算更新后的应力 $\\boldsymbol{\\sigma}^\\prime_{n+1}$：\n        $$\n        \\boldsymbol{\\sigma}^\\prime_{n+1} = \\mathbf{s}_{\\mathrm{trial}} + p_{\\min}\\,\\mathbf{I}\n        $$\n\n该问题还要求量化在增量开始时材料的体积刚度。这由有效超塑性体积模量 $M_v$ 给出，定义为在无偏变形和无偏应力条件下，平均应力率对体积应变率的偏导数：\n$$\nM_v = \\frac{\\partial \\dot{p}^\\prime}{\\partial \\theta}\\bigg|_{\\mathbf{E}=\\mathbf{0},\\,\\mathbf{s}=\\mathbf{0}}\n$$\n为求 $\\dot{p}^\\prime$，我们取本构方程的迹并除以 $3$：\n$$\n\\dot{p}^\\prime = \\frac{1}{3}\\mathrm{tr}(\\dot{\\boldsymbol{\\sigma}}^\\prime) = \\frac{1}{3} \\mathrm{tr}\\left(a\\,(p_{\\mathrm{reg}})^{\\alpha}\\,\\mathbf{E} + b\\,(p_{\\mathrm{reg}})^{\\beta}\\,\\theta\\,\\mathbf{I} + c\\,\\lVert \\mathbf{E} \\rVert\\,\\mathbf{s}\\right)\n$$\n由于 $\\mathrm{tr}(\\mathbf{E}) = 0$，$\\mathrm{tr}(\\mathbf{I})=3$ 和 $\\mathrm{tr}(\\mathbf{s})=0$，这简化为：\n$$\n\\dot{p}^\\prime = b\\,(p_{\\mathrm{reg}})^{\\beta}\\,\\theta\n$$\n于是对 $\\theta$ 的导数就直接得出，得到了问题陈述中提供的公式：\n$$\nM_v = b\\,(p_{\\mathrm{reg}})^{\\beta} = b\\,(\\max\\{p^\\prime_n, p_{\\mathrm{floor}}\\})^{\\beta}\n$$\n该模量使用时间步开始时的平均应力 $p^\\prime_n$ 进行评估。\n\n在实现中，所有二阶张量（$\\boldsymbol{\\sigma}^\\prime, \\mathbf{s}, \\mathbf{D}, \\mathbf{E}, \\mathbf{I}$）均表示为 $3 \\times 3$ 的 NumPy 数组。迹使用 `np.trace()` 计算，单位张量为 `np.eye(3)`，弗罗贝尼乌斯范数 $\\lVert \\mathbf{A} \\rVert$ 为 `np.linalg.norm(A, 'fro')`。\n\n让我们为测试用例4演示该过程，该用例涉及本构模型的所有项。\n-   **初始状态**：$\\boldsymbol{\\sigma}^\\prime_n = \\mathrm{diag}(6, 4.5, 4.5)\\,\\mathrm{kPa}$，$\\mathbf{D}_n$ 具有 $\\theta_n=0.005\\,\\mathrm{s}^{-1}$ 且 $\\mathbf{E}_n$ 的非零分量为 $(\\mathbf{E}_n)_{12} = (\\mathbf{E}_n)_{21}=0.01\\,\\mathrm{s}^{-1}$。$\\Delta t = 0.1\\,\\mathrm{s}$。\n-   **分解**：$p^\\prime_n = \\frac{1}{3}(6+4.5+4.5) = 5.0\\,\\mathrm{kPa}$。$\\mathbf{s}_n = \\boldsymbol{\\sigma}^\\prime_n - 5.0\\,\\mathbf{I} = \\mathrm{diag}(1.0, -0.5, -0.5)\\,\\mathrm{kPa}$。\n-   **模量 $M_v$**：$p_{\\mathrm{reg}} = \\max\\{5.0, 0.1\\} = 5.0\\,\\mathrm{kPa}$。$M_v = 150 \\times (5.0)^{0.5} \\approx 335.410197\\,\\mathrm{kPa}$。\n-   **应力率 $\\dot{\\boldsymbol{\\sigma}}^\\prime_n$**：\n    -   项 1：$a\\,(p_{\\mathrm{reg}})^{\\alpha}\\,\\mathbf{E}_n = 100 \\times (5.0)^{0.5} \\times \\mathbf{E}_n \\approx 223.6068\\,\\mathbf{E}_n$。\n    -   项 2：$b\\,(p_{\\mathrm{reg}})^{\\beta}\\,\\theta_n\\,\\mathbf{I} = 150 \\times (5.0)^{0.5} \\times 0.005 \\times \\mathbf{I} \\approx 1.677051\\,\\mathbf{I}\\,\\mathrm{kPa/s}$。\n    -   项 3：$c\\,\\lVert \\mathbf{E}_n \\rVert\\,\\mathbf{s}_n$。$\\lVert \\mathbf{E}_n \\rVert = \\sqrt{0.01^2+0.01^2} \\approx 0.014142\\,\\mathrm{s}^{-1}$。该项为 $1 \\times 0.014142 \\times \\mathbf{s}_n$。\n-   **试探应力**：$\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} = \\boldsymbol{\\sigma}^\\prime_n + 0.1 \\times \\dot{\\boldsymbol{\\sigma}}^\\prime_n$。计算得出 $\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}} \\approx \\begin{pmatrix} 6.169119   0.223607   0 \\\\ 0.223607   4.666998   0 \\\\ 0   0   4.666998 \\end{pmatrix}\\,\\mathrm{kPa}$。\n-   **投影**：$p^\\prime_{\\mathrm{trial}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}}) \\approx 5.167705\\,\\mathrm{kPa}$。由于 $5.167705  p_{\\min}=0.1$，无需投影。标志为 $0$。\n-   **最终状态**：$\\boldsymbol{\\sigma}^\\prime_{n+1} = \\boldsymbol{\\sigma}^\\prime_{\\mathrm{trial}}$，所以 $p^\\prime_{n+1} = p^\\prime_{\\mathrm{trial}} \\approx 5.167705\\,\\mathrm{kPa}$。\n此测试用例的最终结果是 `[5.167705, 0, 335.410197]`。对所有其他测试用例应用相同的过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and assesses a simplified hypoplastic stress-update algorithm.\n    \"\"\"\n\n    # --- Material and numerical parameters ---\n    a = 100.0\n    b = 150.0\n    c = 1.0\n    alpha = 0.5\n    beta = 0.5\n    p_floor = 0.1  # kPa\n    p_min = 0.1    # kPa\n\n    # --- Test suite definition ---\n    test_cases = [\n        # Test 1: near-vacuum isotropic compression\n        {\n            \"sigma_n\": np.array([[0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5]]),\n            \"D_n\": np.array([[(1/3)*0.01, 0, 0], [0, (1/3)*0.01, 0], [0, 0, (1/3)*0.01]]),\n            \"dt\": 0.1\n        },\n        # Test 2: near-vacuum isotropic expansion, severe\n        {\n            \"sigma_n\": np.array([[1.0, 0, 0], [0, 1.0, 0], [0, 0, 1.0]]),\n            \"D_n\": np.array([[(1/3)*(-1.0), 0, 0], [0, (1/3)*(-1.0), 0], [0, 0, (1/3)*(-1.0)]]),\n            \"dt\": 0.1\n        },\n        # Test 3: pure shear at vanishing pressure\n        {\n            \"sigma_n\": np.array([[0.2, 0, 0], [0, 0.2, 0], [0, 0, 0.2]]),\n            \"D_n\": np.array([[0, 0.01, 0], [0.01, 0, 0], [0, 0, 0]]),\n            \"dt\": 0.2\n        },\n        # Test 4: general case with deviatoric stress\n        {\n            \"sigma_n\": np.array([[6.0, 0, 0], [0, 4.5, 0], [0, 0, 4.5]]),\n            \"D_n\": np.array([[(1/3)*0.005, 0.01, 0], [0.01, (1/3)*0.005, 0], [0, 0, (1/3)*0.005]]),\n            \"dt\": 0.1\n        },\n        # Test 5: exactly zero initial pressure with expansion\n        {\n            \"sigma_n\": np.zeros((3, 3)),\n            \"D_n\": np.array([[(1/3)*(-0.2), 0, 0], [0, (1/3)*(-0.2), 0], [0, 0, (1/3)*(-0.2)]]),\n            \"dt\": 0.05\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        sigma_n = case[\"sigma_n\"]\n        D_n = case[\"D_n\"]\n        dt = case[\"dt\"]\n        \n        I = np.eye(3)\n\n        # Decompose sigma_n and D_n\n        p_n = (1/3) * np.trace(sigma_n)\n        s_n = sigma_n - p_n * I\n        \n        theta_n = np.trace(D_n)\n        E_n = D_n - (1/3) * theta_n * I\n        norm_E = np.linalg.norm(E_n, 'fro')\n\n        # Regularized pressure\n        p_reg = max(p_n, p_floor)\n\n        # Calculate degeneracy measure M_v at the beginning of the step\n        M_v = b * (p_reg ** beta)\n\n        # Calculate stress rate dot_sigma\n        term1 = a * (p_reg ** alpha) * E_n\n        term2 = b * (p_reg ** beta) * theta_n * I\n        term3 = c * norm_E * s_n\n        dot_sigma = term1 + term2 + term3\n\n        # Forward Euler step for trial stress\n        sigma_trial = sigma_n + dt * dot_sigma\n        \n        # Check positivity constraint\n        p_trial = (1/3) * np.trace(sigma_trial)\n        \n        flag = 0\n        if p_trial = p_min:\n            flag = 1\n            s_trial = sigma_trial - p_trial * I\n            sigma_np1 = s_trial + p_min * I\n        else:\n            sigma_np1 = sigma_trial\n\n        # Final updated mean stress\n        p_np1 = (1/3) * np.trace(sigma_np1)\n        \n        results.append(f\"[{p_np1:.6f},{flag},{M_v:.6f}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3531387"}, {"introduction": "我们在前面的练习中实现了一个简单的显式积分算法，但它的局限性是什么？本练习将深入探讨数值稳定性的核心议题，这是任何时间积分算法的“阿喀琉斯之踵”。通过分析一个简化的超塑性剪切模型，您将学会推导显式欧拉法的最大稳定时间步长，并理解隐式方法无条件稳定性的优势，从而在未来的研究和模拟中能够做出更明智的算法选择 [@problem_id:3531349]。", "problem": "考虑一种超塑性材料（砂土或黏土）在恒定剪应变率大小的快速加载作用下的一维剪应力演化。该率型本构律在物质点层面满足标架无关性和率无关性，其形式为：剪应力率取决于当前状态和应变率大小。假设剪应力 $\\tau$ 遵循简化的超塑性演化规律\n$$\n\\frac{d\\tau}{dt} = - h(e,p)\\, \\|\\dot{\\gamma}\\|\\, \\tau + g(e,p)\\, \\|\\dot{\\gamma}\\|\\, p,\n$$\n其中 $e$ 是孔隙比，$p$ 是平均有效压力，$\\|\\dot{\\gamma}\\|$ 是剪应变率的大小。函数 $h(e,p)$ 捕捉了剪应力的状态相关超塑性阻尼，定义为\n$$\nh(e,p) = h_0\\, \\exp(-\\beta\\, e)\\, \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{\\alpha},\n$$\n其中 $h_0$、$\\beta$ 和 $\\alpha$ 是材料常数，$p_{\\mathrm{ref}}$ 是参考压力。函数 $g(e,p)$ 是一个有界的状态相关系数，构成非齐次项。为了分析时间积分格式的数值稳定性，请关注决定扰动放大的齐次部分。\n\n从围绕当前状态和恒定 $\\|\\dot{\\gamma}\\|$ 对率型本构方程进行线性化的基本概念出发，将演化方程简化为针对齐次部分的线性测试方程。然后，通过分析应用于该线性化齐次方程的显式前向欧拉法和后向欧拉法的稳定性，推导出确保显式积分数值稳定的时间步长条件，并解释后向欧拉法的无条件稳定性特性。所有时间量以秒为单位表示，所有压力以千帕斯卡为单位表示。\n\n实现一个程序，对于每个提供的测试用例，计算：\n- 显式前向欧拉法的最大稳定时间步长，以秒为单位，表示为浮点数，且与为线性化齐次方程推导出的稳定性条件一致。\n- 一个布尔值，根据线性化系数的符号，指示后向欧拉法对于给定的测试用例是否无条件稳定。\n\n使用以下具有科学上合理的参数值和快速加载条件的测试套件。每个测试用例指定 $(e, p, h_0, \\beta, \\alpha, p_{\\mathrm{ref}}, \\|\\dot{\\gamma}\\|, g_0)$，其中 $g_0$ 是 $g(e,p)$ 的一个有界常数，但不影响线性化齐次稳定性：\n1. 典型的密砂在快速剪切作用下：$e = 0.62$, $p = 150\\,\\mathrm{kPa}$, $h_0 = 5.0$, $\\beta = 0.8$, $\\alpha = 0.2$, $p_{\\mathrm{ref}} = 100\\,\\mathrm{kPa}$, $\\|\\dot{\\gamma}\\| = 10\\,\\mathrm{s}^{-1}$, $g_0 = 0.9$。\n2. 较高压力下的极快速加载：$e = 0.70$, $p = 300\\,\\mathrm{kPa}$, $h_0 = 12.0$, $\\beta = 0.5$, $\\alpha = 0.25$, $p_{\\mathrm{ref}} = 100\\,\\mathrm{kPa}$, $\\|\\dot{\\gamma}\\| = 50\\,\\mathrm{s}^{-1}$, $g_0 = 1.2$。\n3. 无加载速率的边界情况：$e = 0.60$, $p = 100\\,\\mathrm{kPa}$, $h_0 = 4.0$, $\\beta = 0.7$, $\\alpha = 0.2$, $p_{\\mathrm{ref}} = 100\\,\\mathrm{kPa}$, $\\|\\dot{\\gamma}\\| = 0\\,\\mathrm{s}^{-1}$, $g_0 = 1.0$。\n4. 低压下具有中等快速剪切的软黏土状状态：$e = 0.90$, $p = 50\\,\\mathrm{kPa}$, $h_0 = 2.0$, $\\beta = 1.2$, $\\alpha = 0.15$, $p_{\\mathrm{ref}} = 100\\,\\mathrm{kPa}$, $\\|\\dot{\\gamma}\\| = 5\\,\\mathrm{s}^{-1}$, $g_0 = 0.7$。\n\n将计算出的最大稳定时间步长以秒为单位表示为浮点数。对于显式前向欧拉法没有稳定正时间步长的情况，返回 $0.0$。对于齐次系数为零的情况，返回浮点数无穷大表示无限稳定。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来、无空格的逗号分隔列表。列表中的每个元素对应一个测试用例，本身也是一个格式为 $[\\Delta t_{\\max},\\mathrm{boolean}]$ 的列表。例如，输出应类似于 $[[0.1,True],[0.02,True],[\\mathrm{inf},True],[0.005,True]]$，但使用从上述测试套件获得的实际值。", "solution": "该问题要求对一个简化的一维超塑性本构律的时间积分格式进行数值稳定性分析。验证和求解过程将严格遵循科学和数学的严谨性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题陈述中给出的已知条件如下：\n- 剪应力演化方程：$\\frac{d\\tau}{dt} = - h(e,p)\\, \\|\\dot{\\gamma}\\|\\, \\tau + g(e,p)\\, \\|\\dot{\\gamma}\\|\\, p$。\n- 超塑性阻尼函数：$h(e,p) = h_0\\, \\exp(-\\beta\\, e)\\, \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{\\alpha}$。\n- 状态变量：$\\tau$（剪应力），$e$（孔隙比），$p$（平均有效压力）。\n- 加载变量：$\\|\\dot{\\gamma}\\|$（剪应变率大小）。\n- 材料常数：$h_0$, $\\beta$, $\\alpha$。\n- 参考压力：$p_{\\mathrm{ref}}$。\n- 一个有界函数 $g(e,p)$。\n- 分析重点是演化方程的齐次部分。\n- 待分析的数值方法：显式前向欧拉法和后向欧拉法。\n- 单位：时间为秒（s），压力为千帕斯卡（kPa）。\n- 测试用例以 $(e, p, h_0, \\beta, \\alpha, p_{\\mathrm{ref}}, \\|\\dot{\\gamma}\\|, g_0)$ 的元组形式提供：\n  1. $(0.62, 150, 5.0, 0.8, 0.2, 100, 10, 0.9)$\n  2. $(0.70, 300, 12.0, 0.5, 0.25, 100, 50, 1.2)$\n  3. $(0.60, 100, 4.0, 0.7, 0.2, 100, 0, 1.0)$\n  4. $(0.90, 50, 2.0, 1.2, 0.15, 100, 5, 0.7)$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于超塑性理论，这是计算岩土力学中用于模拟颗粒材料的公认理论。率型方程是此类模型的标准形式，用于捕捉材料状态的演化。函数 $h(e,p)$ 的结构在物理上是合理的，表示了对密度（通过孔隙比 $e$）和约束（通过压力 $p$）的依赖性。该问题是为了教育或分析目的而进行的有效简化。\n- **适定性**：任务定义明确：使用标准方法为给定的常微分方程 (ODE) 推导数值稳定性条件。每个测试用例都提供了所有必要的参数。\n- **客观性**：问题使用了精确、无偏见的科学术语。\n- **一致性与完整性**：问题是自洽的。忽略包含 $g(e,p)$ 的非齐次项的指令是明確的，並且適用於線性穩定性分析，該分析旨在檢查解的擾動的放大情況。所有必需的數據都已提供。單位在物理上是一致的：$h(e,p)$ 是無量綱的，$\\|\\dot{\\gamma}\\|$ 的單位是 $s^{-1}$，$\\tau$ 的單位是壓力（kPa）。因此，$-h(e,p)\\|\\dot{\\gamma}\\|\\tau$ 項的單位是 $\\text{kPa } s^{-1}$，與左側的 $\\frac{d\\tau}{dt}$ 相匹配。\n\n**步骤 3：结论与行动**\n\n问题在科学和数学上是合理的、适定的和完整的。它被认为是**有效的**。接下来将进行求解推导。\n\n### 稳定性条件的推导\n\n问题的核心在于对线性常微分方程的数值方法进行稳定性分析。\n\n**1. 线性化与测试方程**\n\n给定的本构演化律为：\n$$\n\\frac{d\\tau}{dt} = - h(e,p)\\, \\|\\dot{\\gamma}\\|\\, \\tau + g(e,p)\\, \\|\\dot{\\gamma}\\|\\, p\n$$\n分析仅限于此方程的齐次部分，该部分控制扰动的演化。齐次方程为：\n$$\n\\frac{d\\tau}{dt} = - h(e,p)\\, \\|\\dot{\\gamma}\\|\\, \\tau\n$$\n该方程已经是标准线性测试方程 $\\frac{dy}{dt} = \\lambda y$ 的形式。通过比较，我们确定系数 $\\lambda$ 为：\n$$\n\\lambda = - h(e,p)\\, \\|\\dot{\\gamma}\\|\n$$\n代入 $h(e,p)$ 的定义：\n$$\n\\lambda = - \\left( h_0\\, \\exp(-\\beta\\, e)\\, \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{\\alpha} \\right) \\|\\dot{\\gamma}\\|\n$$\n对于单个时间步的稳定性分析，状态变量（$e$，$p$）和加载速率（$\\|\\dot{\\gamma}\\|$）被视为常数。参数 $h_0$、$\\beta$、$\\alpha$、$p$、$p_{\\mathrm{ref}}$ 和 $\\|\\dot{\\gamma}\\|$ 都是非负的。指数函数产生一个正值。因此，$h(e,p) \\ge 0$，这意味着 $\\lambda$ 始终是一个实数且非正数（$\\lambda \\le 0$）。\n\n**2. 显式前向欧拉法的稳定性**\n\n应用于测试方程 $\\frac{d\\tau}{dt} = \\lambda \\tau$ 的前向欧拉格式为：\n$$\n\\frac{\\tau_{n+1} - \\tau_n}{\\Delta t} = \\lambda \\tau_n\n$$\n其中 $\\tau_n$ 是时刻 $t_n$ 的应力，$\\Delta t$ 是时间步长。更新规则为：\n$$\n\\tau_{n+1} = (1 + \\lambda \\Delta t) \\tau_n\n$$\n为使该方法数值稳定，放大因子 $R = 1 + \\lambda \\Delta t$ 的大小不得超过 $1$：\n$$\n|1 + \\lambda \\Delta t| \\le 1\n$$\n由于我们已经确定 $\\lambda \\le 0$，这个不等式展开为：\n$$\n-1 \\le 1 + \\lambda \\Delta t \\le 1\n$$\n右侧不等式 $1 + \\lambda \\Delta t \\le 1$ 简化为 $\\lambda \\Delta t \\le 0$，这对于 $\\Delta t  0$ 和 $\\lambda \\le 0$ 总是成立。稳定性的关键条件来自左侧不等式：\n$$\n-1 \\le 1 + \\lambda \\Delta t \\implies -2 \\le \\lambda \\Delta t\n$$\n由于 $\\lambda$ 是负数（对于 $\\|\\dot{\\gamma}\\|  0$ 的非平凡情况），除以 $\\lambda$ 会使不等号反向：\n$$\n\\Delta t \\le -\\frac{2}{\\lambda}\n$$\n因此，前向欧拉法的最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = -\\frac{2}{\\lambda} = \\frac{2}{h(e,p)\\, \\|\\dot{\\gamma}\\|} = \\frac{2}{h_0\\, \\exp(-\\beta\\, e)\\, \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{\\alpha} \\|\\dot{\\gamma}\\|}\n$$\n在 $\\|\\dot{\\gamma}\\| = 0$ 的特殊情况下，我们有 $\\lambda=0$。放大因子变为 $R=1$，这对任何 $\\Delta t$ 都是稳定的。因此，$\\Delta t_{\\max} = \\infty$。\n\n**3. 后向欧拉法的稳定性**\n\n应用于测试方程的后向欧拉格式为：\n$$\n\\frac{\\tau_{n+1} - \\tau_n}{\\Delta t} = \\lambda \\tau_{n+1}\n$$\n求解 $\\tau_{n+1}$ 得到更新规则：\n$$\n\\tau_{n+1}(1 - \\lambda \\Delta t) = \\tau_n \\implies \\tau_{n+1} = \\left(\\frac{1}{1 - \\lambda \\Delta t}\\right) \\tau_n\n$$\n放大因子为 $R = \\frac{1}{1 - \\lambda \\Delta t}$。稳定性条件是 $|R| \\le 1$，这等价于 $|1 - \\lambda \\Delta t| \\ge 1$。\n由于 $\\lambda \\le 0$ 且 $\\Delta t  0$，所以 $-\\lambda \\Delta t$ 项是非负的。这意味着 $1 - \\lambda \\Delta t \\ge 1$。因为这个值总是大于或等于 $1$，所以它的大小也总是大于或等于 $1$。\n因此，稳定性条件 $|1 - \\lambda \\Delta t| \\ge 1$ 对于任何时间步长 $\\Delta t  0$ 的选择都成立。由于 $\\lambda \\le 0$，后向欧拉法对于此问题是无条件稳定的。其无条件稳定性的布爾指示符是 `True`。\n\n### 算法实现\n\n对于每个测试用例 $(e, p, h_0, \\beta, \\alpha, p_{\\mathrm{ref}}, \\|\\dot{\\gamma}\\|, g_0)$：\n1. 检查 $\\|\\dot{\\gamma}\\|$ 是否为 0。如果是，则最大稳定时间步长 $\\Delta t_{\\max}$ 为无穷大。此情况的结果是 $[\\infty, \\text{True}]$。\n2. 如果 $\\|\\dot{\\gamma}\\|  0$，计算 $h(e,p) = h_0\\, \\exp(-\\beta\\, e)\\, \\left(p/p_{\\mathrm{ref}}\\right)^{\\alpha}$ 的值。\n3. 计算稳定性限制项 $C = h(e,p) \\times \\|\\dot{\\gamma}\\|$。\n4. 最大稳定时间步长为 $\\Delta t_{\\max} = 2/C$。\n5. 后向欧拉法是无条件稳定的，因为线性化系数 $\\lambda = -C$ 是非正的。\n6. 此情况的结果是 $[\\Delta t_{\\max}, \\text{True}]$。\n7. 问题指出，如果不存在稳定的正时间步长，应返回 $0.0$。这将对应于 $\\lambda  0$ 的情况。然而，根据模型的物理原理，所有构成 $\\lambda$ 大小的参数都是非负的，所以 $\\lambda$ 总是非正的，因此不会遇到这种情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hypoplastic stability problem for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (e, p, h0, beta, alpha, p_ref, shear_rate_mag, g0)\n    test_cases = [\n        # 1. Typical dense sand under rapid shear\n        (0.62, 150.0, 5.0, 0.8, 0.2, 100.0, 10.0, 0.9),\n        # 2. Very rapid loading at higher pressure\n        (0.70, 300.0, 12.0, 0.5, 0.25, 100.0, 50.0, 1.2),\n        # 3. Boundary case with no loading rate\n        (0.60, 100.0, 4.0, 0.7, 0.2, 100.0, 0.0, 1.0),\n        # 4. Soft clay-like state at low pressure with moderate rapid shear\n        (0.90, 50.0, 2.0, 1.2, 0.15, 100.0, 5.0, 0.7),\n    ]\n\n    results = []\n    for case in test_cases:\n        e, p, h0, beta, alpha, p_ref, shear_rate_mag, g0 = case\n\n        # The parameter lambda of the linear test equation dy/dt = lambda*y is\n        # lambda = -h(e, p) * ||gamma_dot||.\n        # Since all physical parameters are non-negative, lambda = 0.\n        # This guarantees that the backward Euler method is unconditionally stable.\n        is_be_unconditionally_stable = True\n\n        # Check for the special case where the shear strain rate is zero.\n        if shear_rate_mag == 0.0:\n            # If ||gamma_dot|| = 0, then lambda = 0. The ODE is d_tau/dt = 0.\n            # The forward Euler update is tau_{n+1} = tau_n, which is stable\n            # for any time step. Hence, dt_max is infinite.\n            dt_max = np.inf\n            results.append([dt_max, is_be_unconditionally_stable])\n            continue\n\n        # Calculate the hypoplastic damping function h(e,p)\n        # h(e,p) = h0 * exp(-beta * e) * (p / p_ref)^alpha\n        h_val = h0 * np.exp(-beta * e) * ((p / p_ref)**alpha)\n\n        # The stability condition for forward Euler for dy/dt = lambda*y is\n        # dt = -2/lambda, for lambda  0.\n        # Here, lambda = -h_val * shear_rate_mag.\n        # So, dt = 2 / (h_val * shear_rate_mag).\n        \n        # This corresponds to the denominator of the dt_max expression.\n        # It is guaranteed to be positive since h_val > 0 and shear_rate_mag > 0.\n        denominator = h_val * shear_rate_mag\n        \n        dt_max = 2.0 / denominator\n        \n        results.append([dt_max, is_be_unconditionally_stable])\n\n    # Format the results into the required string format \"[[dt1,Bool1],[dt2,Bool2],...]\"\n    # np.inf is automatically formatted as 'inf' and boolean as 'True'/'False'.\n    result_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(result_str)\n\nsolve()\n```", "id": "3531349"}]}